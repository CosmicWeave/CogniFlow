const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/StudySession-viKbaa-l.js","assets/MasteryBar-DeT_xrwj.js","assets/ProgressBar-0NsASibu.js","assets/useKeyboardShortcuts-D9PlQdSg.js","assets/ToggleSwitch-B0KlfoDm.js","assets/ReaderSession-_Hx9TbSZ.js","assets/SettingsPage-BY-_7tjp.js","assets/DeckDetailsPage-DyTvTC5U.js","assets/TruncatedText-CkR9_Paq.js","assets/SeriesOverviewPage-konHt6Zv.js","assets/DeckListItem-23PzCa10.js","assets/DashboardPage-BM6LAuBR.js","assets/SeriesListItem-DII6wwxb.js","assets/AllDecksPage-BF09E4SE.js","assets/DeckSortControl-DsyZazq0.js","assets/AllSeriesPage-CqkENJqz.js"])))=>i.map(i=>d[i]);
(function(){const a=document.createElement("link").relList;if(a&&a.supports&&a.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))i(l);new MutationObserver(l=>{for(const c of l)if(c.type==="childList")for(const d of c.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&i(d)}).observe(document,{childList:!0,subtree:!0});function s(l){const c={};return l.integrity&&(c.integrity=l.integrity),l.referrerPolicy&&(c.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?c.credentials="include":l.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function i(l){if(l.ep)return;l.ep=!0;const c=s(l);fetch(l.href,c)}})();var Kc=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function co(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}function i_(n){if(Object.prototype.hasOwnProperty.call(n,"__esModule"))return n;var a=n.default;if(typeof a=="function"){var s=function i(){return this instanceof i?Reflect.construct(a,arguments,this.constructor):a.apply(this,arguments)};s.prototype=a.prototype}else s={};return Object.defineProperty(s,"__esModule",{value:!0}),Object.keys(n).forEach(function(i){var l=Object.getOwnPropertyDescriptor(n,i);Object.defineProperty(s,i,l.get?l:{enumerable:!0,get:function(){return n[i]}})}),s}var $f={exports:{}},rl={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var by;function o_(){if(by)return rl;by=1;var n=Symbol.for("react.transitional.element"),a=Symbol.for("react.fragment");function s(i,l,c){var d=null;if(c!==void 0&&(d=""+c),l.key!==void 0&&(d=""+l.key),"key"in l){c={};for(var m in l)m!=="key"&&(c[m]=l[m])}else c=l;return l=c.ref,{$$typeof:n,type:i,key:d,ref:l!==void 0?l:null,props:c}}return rl.Fragment=a,rl.jsx=s,rl.jsxs=s,rl}var xy;function l_(){return xy||(xy=1,$f.exports=o_()),$f.exports}var u=l_(),Yf={exports:{}},vt={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var _y;function c_(){if(_y)return vt;_y=1;var n=Symbol.for("react.transitional.element"),a=Symbol.for("react.portal"),s=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),l=Symbol.for("react.profiler"),c=Symbol.for("react.consumer"),d=Symbol.for("react.context"),m=Symbol.for("react.forward_ref"),p=Symbol.for("react.suspense"),f=Symbol.for("react.memo"),v=Symbol.for("react.lazy"),_=Symbol.for("react.activity"),T=Symbol.iterator;function x(z){return z===null||typeof z!="object"?null:(z=T&&z[T]||z["@@iterator"],typeof z=="function"?z:null)}var k={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},w=Object.assign,S={};function C(z,I,te){this.props=z,this.context=I,this.refs=S,this.updater=te||k}C.prototype.isReactComponent={},C.prototype.setState=function(z,I){if(typeof z!="object"&&typeof z!="function"&&z!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,z,I,"setState")},C.prototype.forceUpdate=function(z){this.updater.enqueueForceUpdate(this,z,"forceUpdate")};function R(){}R.prototype=C.prototype;function L(z,I,te){this.props=z,this.context=I,this.refs=S,this.updater=te||k}var F=L.prototype=new R;F.constructor=L,w(F,C.prototype),F.isPureReactComponent=!0;var G=Array.isArray;function Q(){}var U={H:null,A:null,T:null,S:null},j=Object.prototype.hasOwnProperty;function O(z,I,te){var ae=te.ref;return{$$typeof:n,type:z,key:I,ref:ae!==void 0?ae:null,props:te}}function q(z,I){return O(z.type,I,z.props)}function ee(z){return typeof z=="object"&&z!==null&&z.$$typeof===n}function M(z){var I={"=":"=0",":":"=2"};return"$"+z.replace(/[=:]/g,function(te){return I[te]})}var J=/\/+/g;function N(z,I){return typeof z=="object"&&z!==null&&z.key!=null?M(""+z.key):I.toString(36)}function se(z){switch(z.status){case"fulfilled":return z.value;case"rejected":throw z.reason;default:switch(typeof z.status=="string"?z.then(Q,Q):(z.status="pending",z.then(function(I){z.status==="pending"&&(z.status="fulfilled",z.value=I)},function(I){z.status==="pending"&&(z.status="rejected",z.reason=I)})),z.status){case"fulfilled":return z.value;case"rejected":throw z.reason}}throw z}function K(z,I,te,ae,$){var ue=typeof z;(ue==="undefined"||ue==="boolean")&&(z=null);var de=!1;if(z===null)de=!0;else switch(ue){case"bigint":case"string":case"number":de=!0;break;case"object":switch(z.$$typeof){case n:case a:de=!0;break;case v:return de=z._init,K(de(z._payload),I,te,ae,$)}}if(de)return $=$(z),de=ae===""?"."+N(z,0):ae,G($)?(te="",de!=null&&(te=de.replace(J,"$&/")+"/"),K($,I,te,"",function(Le){return Le})):$!=null&&(ee($)&&($=q($,te+($.key==null||z&&z.key===$.key?"":(""+$.key).replace(J,"$&/")+"/")+de)),I.push($)),1;de=0;var oe=ae===""?".":ae+":";if(G(z))for(var le=0;le<z.length;le++)ae=z[le],ue=oe+N(ae,le),de+=K(ae,I,te,ue,$);else if(le=x(z),typeof le=="function")for(z=le.call(z),le=0;!(ae=z.next()).done;)ae=ae.value,ue=oe+N(ae,le++),de+=K(ae,I,te,ue,$);else if(ue==="object"){if(typeof z.then=="function")return K(se(z),I,te,ae,$);throw I=String(z),Error("Objects are not valid as a React child (found: "+(I==="[object Object]"?"object with keys {"+Object.keys(z).join(", ")+"}":I)+"). If you meant to render a collection of children, use an array instead.")}return de}function P(z,I,te){if(z==null)return z;var ae=[],$=0;return K(z,ae,"","",function(ue){return I.call(te,ue,$++)}),ae}function ve(z){if(z._status===-1){var I=z._result;I=I(),I.then(function(te){(z._status===0||z._status===-1)&&(z._status=1,z._result=te)},function(te){(z._status===0||z._status===-1)&&(z._status=2,z._result=te)}),z._status===-1&&(z._status=0,z._result=I)}if(z._status===1)return z._result.default;throw z._result}var ce=typeof reportError=="function"?reportError:function(z){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var I=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof z=="object"&&z!==null&&typeof z.message=="string"?String(z.message):String(z),error:z});if(!window.dispatchEvent(I))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",z);return}console.error(z)},Ee={map:P,forEach:function(z,I,te){P(z,function(){I.apply(this,arguments)},te)},count:function(z){var I=0;return P(z,function(){I++}),I},toArray:function(z){return P(z,function(I){return I})||[]},only:function(z){if(!ee(z))throw Error("React.Children.only expected to receive a single React element child.");return z}};return vt.Activity=_,vt.Children=Ee,vt.Component=C,vt.Fragment=s,vt.Profiler=l,vt.PureComponent=L,vt.StrictMode=i,vt.Suspense=p,vt.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=U,vt.__COMPILER_RUNTIME={__proto__:null,c:function(z){return U.H.useMemoCache(z)}},vt.cache=function(z){return function(){return z.apply(null,arguments)}},vt.cacheSignal=function(){return null},vt.cloneElement=function(z,I,te){if(z==null)throw Error("The argument must be a React element, but you passed "+z+".");var ae=w({},z.props),$=z.key;if(I!=null)for(ue in I.key!==void 0&&($=""+I.key),I)!j.call(I,ue)||ue==="key"||ue==="__self"||ue==="__source"||ue==="ref"&&I.ref===void 0||(ae[ue]=I[ue]);var ue=arguments.length-2;if(ue===1)ae.children=te;else if(1<ue){for(var de=Array(ue),oe=0;oe<ue;oe++)de[oe]=arguments[oe+2];ae.children=de}return O(z.type,$,ae)},vt.createContext=function(z){return z={$$typeof:d,_currentValue:z,_currentValue2:z,_threadCount:0,Provider:null,Consumer:null},z.Provider=z,z.Consumer={$$typeof:c,_context:z},z},vt.createElement=function(z,I,te){var ae,$={},ue=null;if(I!=null)for(ae in I.key!==void 0&&(ue=""+I.key),I)j.call(I,ae)&&ae!=="key"&&ae!=="__self"&&ae!=="__source"&&($[ae]=I[ae]);var de=arguments.length-2;if(de===1)$.children=te;else if(1<de){for(var oe=Array(de),le=0;le<de;le++)oe[le]=arguments[le+2];$.children=oe}if(z&&z.defaultProps)for(ae in de=z.defaultProps,de)$[ae]===void 0&&($[ae]=de[ae]);return O(z,ue,$)},vt.createRef=function(){return{current:null}},vt.forwardRef=function(z){return{$$typeof:m,render:z}},vt.isValidElement=ee,vt.lazy=function(z){return{$$typeof:v,_payload:{_status:-1,_result:z},_init:ve}},vt.memo=function(z,I){return{$$typeof:f,type:z,compare:I===void 0?null:I}},vt.startTransition=function(z){var I=U.T,te={};U.T=te;try{var ae=z(),$=U.S;$!==null&&$(te,ae),typeof ae=="object"&&ae!==null&&typeof ae.then=="function"&&ae.then(Q,ce)}catch(ue){ce(ue)}finally{I!==null&&te.types!==null&&(I.types=te.types),U.T=I}},vt.unstable_useCacheRefresh=function(){return U.H.useCacheRefresh()},vt.use=function(z){return U.H.use(z)},vt.useActionState=function(z,I,te){return U.H.useActionState(z,I,te)},vt.useCallback=function(z,I){return U.H.useCallback(z,I)},vt.useContext=function(z){return U.H.useContext(z)},vt.useDebugValue=function(){},vt.useDeferredValue=function(z,I){return U.H.useDeferredValue(z,I)},vt.useEffect=function(z,I){return U.H.useEffect(z,I)},vt.useEffectEvent=function(z){return U.H.useEffectEvent(z)},vt.useId=function(){return U.H.useId()},vt.useImperativeHandle=function(z,I,te){return U.H.useImperativeHandle(z,I,te)},vt.useInsertionEffect=function(z,I){return U.H.useInsertionEffect(z,I)},vt.useLayoutEffect=function(z,I){return U.H.useLayoutEffect(z,I)},vt.useMemo=function(z,I){return U.H.useMemo(z,I)},vt.useOptimistic=function(z,I){return U.H.useOptimistic(z,I)},vt.useReducer=function(z,I,te){return U.H.useReducer(z,I,te)},vt.useRef=function(z){return U.H.useRef(z)},vt.useState=function(z){return U.H.useState(z)},vt.useSyncExternalStore=function(z,I,te){return U.H.useSyncExternalStore(z,I,te)},vt.useTransition=function(){return U.H.useTransition()},vt.version="19.2.3",vt}var Sy;function Il(){return Sy||(Sy=1,Yf.exports=c_()),Yf.exports}var B=Il();const ii=co(B);var Vf={exports:{}},al={},Kf={exports:{}},Zf={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var wy;function u_(){return wy||(wy=1,(function(n){function a(K,P){var ve=K.length;K.push(P);e:for(;0<ve;){var ce=ve-1>>>1,Ee=K[ce];if(0<l(Ee,P))K[ce]=P,K[ve]=Ee,ve=ce;else break e}}function s(K){return K.length===0?null:K[0]}function i(K){if(K.length===0)return null;var P=K[0],ve=K.pop();if(ve!==P){K[0]=ve;e:for(var ce=0,Ee=K.length,z=Ee>>>1;ce<z;){var I=2*(ce+1)-1,te=K[I],ae=I+1,$=K[ae];if(0>l(te,ve))ae<Ee&&0>l($,te)?(K[ce]=$,K[ae]=ve,ce=ae):(K[ce]=te,K[I]=ve,ce=I);else if(ae<Ee&&0>l($,ve))K[ce]=$,K[ae]=ve,ce=ae;else break e}}return P}function l(K,P){var ve=K.sortIndex-P.sortIndex;return ve!==0?ve:K.id-P.id}if(n.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var c=performance;n.unstable_now=function(){return c.now()}}else{var d=Date,m=d.now();n.unstable_now=function(){return d.now()-m}}var p=[],f=[],v=1,_=null,T=3,x=!1,k=!1,w=!1,S=!1,C=typeof setTimeout=="function"?setTimeout:null,R=typeof clearTimeout=="function"?clearTimeout:null,L=typeof setImmediate<"u"?setImmediate:null;function F(K){for(var P=s(f);P!==null;){if(P.callback===null)i(f);else if(P.startTime<=K)i(f),P.sortIndex=P.expirationTime,a(p,P);else break;P=s(f)}}function G(K){if(w=!1,F(K),!k)if(s(p)!==null)k=!0,Q||(Q=!0,M());else{var P=s(f);P!==null&&se(G,P.startTime-K)}}var Q=!1,U=-1,j=5,O=-1;function q(){return S?!0:!(n.unstable_now()-O<j)}function ee(){if(S=!1,Q){var K=n.unstable_now();O=K;var P=!0;try{e:{k=!1,w&&(w=!1,R(U),U=-1),x=!0;var ve=T;try{t:{for(F(K),_=s(p);_!==null&&!(_.expirationTime>K&&q());){var ce=_.callback;if(typeof ce=="function"){_.callback=null,T=_.priorityLevel;var Ee=ce(_.expirationTime<=K);if(K=n.unstable_now(),typeof Ee=="function"){_.callback=Ee,F(K),P=!0;break t}_===s(p)&&i(p),F(K)}else i(p);_=s(p)}if(_!==null)P=!0;else{var z=s(f);z!==null&&se(G,z.startTime-K),P=!1}}break e}finally{_=null,T=ve,x=!1}P=void 0}}finally{P?M():Q=!1}}}var M;if(typeof L=="function")M=function(){L(ee)};else if(typeof MessageChannel<"u"){var J=new MessageChannel,N=J.port2;J.port1.onmessage=ee,M=function(){N.postMessage(null)}}else M=function(){C(ee,0)};function se(K,P){U=C(function(){K(n.unstable_now())},P)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(K){K.callback=null},n.unstable_forceFrameRate=function(K){0>K||125<K?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):j=0<K?Math.floor(1e3/K):5},n.unstable_getCurrentPriorityLevel=function(){return T},n.unstable_next=function(K){switch(T){case 1:case 2:case 3:var P=3;break;default:P=T}var ve=T;T=P;try{return K()}finally{T=ve}},n.unstable_requestPaint=function(){S=!0},n.unstable_runWithPriority=function(K,P){switch(K){case 1:case 2:case 3:case 4:case 5:break;default:K=3}var ve=T;T=K;try{return P()}finally{T=ve}},n.unstable_scheduleCallback=function(K,P,ve){var ce=n.unstable_now();switch(typeof ve=="object"&&ve!==null?(ve=ve.delay,ve=typeof ve=="number"&&0<ve?ce+ve:ce):ve=ce,K){case 1:var Ee=-1;break;case 2:Ee=250;break;case 5:Ee=1073741823;break;case 4:Ee=1e4;break;default:Ee=5e3}return Ee=ve+Ee,K={id:v++,callback:P,priorityLevel:K,startTime:ve,expirationTime:Ee,sortIndex:-1},ve>ce?(K.sortIndex=ve,a(f,K),s(p)===null&&K===s(f)&&(w?(R(U),U=-1):w=!0,se(G,ve-ce))):(K.sortIndex=Ee,a(p,K),k||x||(k=!0,Q||(Q=!0,M()))),K},n.unstable_shouldYield=q,n.unstable_wrapCallback=function(K){var P=T;return function(){var ve=T;T=P;try{return K.apply(this,arguments)}finally{T=ve}}}})(Zf)),Zf}var Ey;function d_(){return Ey||(Ey=1,Kf.exports=u_()),Kf.exports}var Qf={exports:{}},Jn={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ty;function f_(){if(Ty)return Jn;Ty=1;var n=Il();function a(p){var f="https://react.dev/errors/"+p;if(1<arguments.length){f+="?args[]="+encodeURIComponent(arguments[1]);for(var v=2;v<arguments.length;v++)f+="&args[]="+encodeURIComponent(arguments[v])}return"Minified React error #"+p+"; visit "+f+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function s(){}var i={d:{f:s,r:function(){throw Error(a(522))},D:s,C:s,L:s,m:s,X:s,S:s,M:s},p:0,findDOMNode:null},l=Symbol.for("react.portal");function c(p,f,v){var _=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:l,key:_==null?null:""+_,children:p,containerInfo:f,implementation:v}}var d=n.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function m(p,f){if(p==="font")return"";if(typeof f=="string")return f==="use-credentials"?f:""}return Jn.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=i,Jn.createPortal=function(p,f){var v=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!f||f.nodeType!==1&&f.nodeType!==9&&f.nodeType!==11)throw Error(a(299));return c(p,f,null,v)},Jn.flushSync=function(p){var f=d.T,v=i.p;try{if(d.T=null,i.p=2,p)return p()}finally{d.T=f,i.p=v,i.d.f()}},Jn.preconnect=function(p,f){typeof p=="string"&&(f?(f=f.crossOrigin,f=typeof f=="string"?f==="use-credentials"?f:"":void 0):f=null,i.d.C(p,f))},Jn.prefetchDNS=function(p){typeof p=="string"&&i.d.D(p)},Jn.preinit=function(p,f){if(typeof p=="string"&&f&&typeof f.as=="string"){var v=f.as,_=m(v,f.crossOrigin),T=typeof f.integrity=="string"?f.integrity:void 0,x=typeof f.fetchPriority=="string"?f.fetchPriority:void 0;v==="style"?i.d.S(p,typeof f.precedence=="string"?f.precedence:void 0,{crossOrigin:_,integrity:T,fetchPriority:x}):v==="script"&&i.d.X(p,{crossOrigin:_,integrity:T,fetchPriority:x,nonce:typeof f.nonce=="string"?f.nonce:void 0})}},Jn.preinitModule=function(p,f){if(typeof p=="string")if(typeof f=="object"&&f!==null){if(f.as==null||f.as==="script"){var v=m(f.as,f.crossOrigin);i.d.M(p,{crossOrigin:v,integrity:typeof f.integrity=="string"?f.integrity:void 0,nonce:typeof f.nonce=="string"?f.nonce:void 0})}}else f==null&&i.d.M(p)},Jn.preload=function(p,f){if(typeof p=="string"&&typeof f=="object"&&f!==null&&typeof f.as=="string"){var v=f.as,_=m(v,f.crossOrigin);i.d.L(p,v,{crossOrigin:_,integrity:typeof f.integrity=="string"?f.integrity:void 0,nonce:typeof f.nonce=="string"?f.nonce:void 0,type:typeof f.type=="string"?f.type:void 0,fetchPriority:typeof f.fetchPriority=="string"?f.fetchPriority:void 0,referrerPolicy:typeof f.referrerPolicy=="string"?f.referrerPolicy:void 0,imageSrcSet:typeof f.imageSrcSet=="string"?f.imageSrcSet:void 0,imageSizes:typeof f.imageSizes=="string"?f.imageSizes:void 0,media:typeof f.media=="string"?f.media:void 0})}},Jn.preloadModule=function(p,f){if(typeof p=="string")if(f){var v=m(f.as,f.crossOrigin);i.d.m(p,{as:typeof f.as=="string"&&f.as!=="script"?f.as:void 0,crossOrigin:v,integrity:typeof f.integrity=="string"?f.integrity:void 0})}else i.d.m(p)},Jn.requestFormReset=function(p){i.d.r(p)},Jn.unstable_batchedUpdates=function(p,f){return p(f)},Jn.useFormState=function(p,f,v){return d.H.useFormState(p,f,v)},Jn.useFormStatus=function(){return d.H.useHostTransitionStatus()},Jn.version="19.2.3",Jn}var Ay;function h_(){if(Ay)return Qf.exports;Ay=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(a){console.error(a)}}return n(),Qf.exports=f_(),Qf.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ky;function m_(){if(ky)return al;ky=1;var n=d_(),a=Il(),s=h_();function i(e){var t="https://react.dev/errors/"+e;if(1<arguments.length){t+="?args[]="+encodeURIComponent(arguments[1]);for(var r=2;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r])}return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function l(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function c(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,(t.flags&4098)!==0&&(r=t.return),e=t.return;while(e)}return t.tag===3?r:null}function d(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function m(e){if(e.tag===31){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function p(e){if(c(e)!==e)throw Error(i(188))}function f(e){var t=e.alternate;if(!t){if(t=c(e),t===null)throw Error(i(188));return t!==e?null:e}for(var r=e,o=t;;){var h=r.return;if(h===null)break;var g=h.alternate;if(g===null){if(o=h.return,o!==null){r=o;continue}break}if(h.child===g.child){for(g=h.child;g;){if(g===r)return p(h),e;if(g===o)return p(h),t;g=g.sibling}throw Error(i(188))}if(r.return!==o.return)r=h,o=g;else{for(var A=!1,H=h.child;H;){if(H===r){A=!0,r=h,o=g;break}if(H===o){A=!0,o=h,r=g;break}H=H.sibling}if(!A){for(H=g.child;H;){if(H===r){A=!0,r=g,o=h;break}if(H===o){A=!0,o=g,r=h;break}H=H.sibling}if(!A)throw Error(i(189))}}if(r.alternate!==o)throw Error(i(190))}if(r.tag!==3)throw Error(i(188));return r.stateNode.current===r?e:t}function v(e){var t=e.tag;if(t===5||t===26||t===27||t===6)return e;for(e=e.child;e!==null;){if(t=v(e),t!==null)return t;e=e.sibling}return null}var _=Object.assign,T=Symbol.for("react.element"),x=Symbol.for("react.transitional.element"),k=Symbol.for("react.portal"),w=Symbol.for("react.fragment"),S=Symbol.for("react.strict_mode"),C=Symbol.for("react.profiler"),R=Symbol.for("react.consumer"),L=Symbol.for("react.context"),F=Symbol.for("react.forward_ref"),G=Symbol.for("react.suspense"),Q=Symbol.for("react.suspense_list"),U=Symbol.for("react.memo"),j=Symbol.for("react.lazy"),O=Symbol.for("react.activity"),q=Symbol.for("react.memo_cache_sentinel"),ee=Symbol.iterator;function M(e){return e===null||typeof e!="object"?null:(e=ee&&e[ee]||e["@@iterator"],typeof e=="function"?e:null)}var J=Symbol.for("react.client.reference");function N(e){if(e==null)return null;if(typeof e=="function")return e.$$typeof===J?null:e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case w:return"Fragment";case C:return"Profiler";case S:return"StrictMode";case G:return"Suspense";case Q:return"SuspenseList";case O:return"Activity"}if(typeof e=="object")switch(e.$$typeof){case k:return"Portal";case L:return e.displayName||"Context";case R:return(e._context.displayName||"Context")+".Consumer";case F:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case U:return t=e.displayName||null,t!==null?t:N(e.type)||"Memo";case j:t=e._payload,e=e._init;try{return N(e(t))}catch{}}return null}var se=Array.isArray,K=a.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,P=s.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ve={pending:!1,data:null,method:null,action:null},ce=[],Ee=-1;function z(e){return{current:e}}function I(e){0>Ee||(e.current=ce[Ee],ce[Ee]=null,Ee--)}function te(e,t){Ee++,ce[Ee]=e.current,e.current=t}var ae=z(null),$=z(null),ue=z(null),de=z(null);function oe(e,t){switch(te(ue,t),te($,e),te(ae,null),t.nodeType){case 9:case 11:e=(e=t.documentElement)&&(e=e.namespaceURI)?Gg(e):0;break;default:if(e=t.tagName,t=t.namespaceURI)t=Gg(t),e=qg(t,e);else switch(e){case"svg":e=1;break;case"math":e=2;break;default:e=0}}I(ae),te(ae,e)}function le(){I(ae),I($),I(ue)}function Le(e){e.memoizedState!==null&&te(de,e);var t=ae.current,r=qg(t,e.type);t!==r&&(te($,e),te(ae,r))}function De(e){$.current===e&&(I(ae),I($)),de.current===e&&(I(de),Wo._currentValue=ve)}var Se,ne;function E(e){if(Se===void 0)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);Se=t&&t[1]||"",ne=-1<r.stack.indexOf(`
    at`)?" (<anonymous>)":-1<r.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Se+e+ne}var me=!1;function X(e,t){if(!e||me)return"";me=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var o={DetermineComponentFrameRoot:function(){try{if(t){var Ue=function(){throw Error()};if(Object.defineProperty(Ue.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(Ue,[])}catch(Ae){var we=Ae}Reflect.construct(e,[],Ue)}else{try{Ue.call()}catch(Ae){we=Ae}e.call(Ue.prototype)}}else{try{throw Error()}catch(Ae){we=Ae}(Ue=e())&&typeof Ue.catch=="function"&&Ue.catch(function(){})}}catch(Ae){if(Ae&&we&&typeof Ae.stack=="string")return[Ae.stack,we.stack]}return[null,null]}};o.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var h=Object.getOwnPropertyDescriptor(o.DetermineComponentFrameRoot,"name");h&&h.configurable&&Object.defineProperty(o.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var g=o.DetermineComponentFrameRoot(),A=g[0],H=g[1];if(A&&H){var re=A.split(`
`),_e=H.split(`
`);for(h=o=0;o<re.length&&!re[o].includes("DetermineComponentFrameRoot");)o++;for(;h<_e.length&&!_e[h].includes("DetermineComponentFrameRoot");)h++;if(o===re.length||h===_e.length)for(o=re.length-1,h=_e.length-1;1<=o&&0<=h&&re[o]!==_e[h];)h--;for(;1<=o&&0<=h;o--,h--)if(re[o]!==_e[h]){if(o!==1||h!==1)do if(o--,h--,0>h||re[o]!==_e[h]){var Ne=`
`+re[o].replace(" at new "," at ");return e.displayName&&Ne.includes("<anonymous>")&&(Ne=Ne.replace("<anonymous>",e.displayName)),Ne}while(1<=o&&0<=h);break}}}finally{me=!1,Error.prepareStackTrace=r}return(r=e?e.displayName||e.name:"")?E(r):""}function Z(e,t){switch(e.tag){case 26:case 27:case 5:return E(e.type);case 16:return E("Lazy");case 13:return e.child!==t&&t!==null?E("Suspense Fallback"):E("Suspense");case 19:return E("SuspenseList");case 0:case 15:return X(e.type,!1);case 11:return X(e.type.render,!1);case 1:return X(e.type,!0);case 31:return E("Activity");default:return""}}function Y(e){try{var t="",r=null;do t+=Z(e,r),r=e,e=e.return;while(e);return t}catch(o){return`
Error generating stack: `+o.message+`
`+o.stack}}var ie=Object.prototype.hasOwnProperty,ke=n.unstable_scheduleCallback,Ce=n.unstable_cancelCallback,pe=n.unstable_shouldYield,Ie=n.unstable_requestPaint,He=n.unstable_now,Oe=n.unstable_getCurrentPriorityLevel,qe=n.unstable_ImmediatePriority,nt=n.unstable_UserBlockingPriority,We=n.unstable_NormalPriority,Ye=n.unstable_LowPriority,St=n.unstable_IdlePriority,wt=n.log,jt=n.unstable_setDisableYieldValue,mt=null,rt=null;function un(e){if(typeof wt=="function"&&jt(e),rt&&typeof rt.setStrictMode=="function")try{rt.setStrictMode(mt,e)}catch{}}var Mt=Math.clz32?Math.clz32:Jr,cr=Math.log,ut=Math.LN2;function Jr(e){return e>>>=0,e===0?32:31-(cr(e)/ut|0)|0}var Kn=256,qt=262144,tn=4194304;function vn(e){var t=e&42;if(t!==0)return t;switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return e&261888;case 262144:case 524288:case 1048576:case 2097152:return e&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return e&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return e}}function gt(e,t,r){var o=e.pendingLanes;if(o===0)return 0;var h=0,g=e.suspendedLanes,A=e.pingedLanes;e=e.warmLanes;var H=o&134217727;return H!==0?(o=H&~g,o!==0?h=vn(o):(A&=H,A!==0?h=vn(A):r||(r=H&~e,r!==0&&(h=vn(r))))):(H=o&~g,H!==0?h=vn(H):A!==0?h=vn(A):r||(r=o&~e,r!==0&&(h=vn(r)))),h===0?0:t!==0&&t!==h&&(t&g)===0&&(g=h&-h,r=t&-t,g>=r||g===32&&(r&4194048)!==0)?t:h}function pn(e,t){return(e.pendingLanes&~(e.suspendedLanes&~e.pingedLanes)&t)===0}function Pe(e,t){switch(e){case 1:case 2:case 4:case 8:case 64:return t+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function _a(){var e=tn;return tn<<=1,(tn&62914560)===0&&(tn=4194304),e}function Sn(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function yr(e,t){e.pendingLanes|=t,t!==268435456&&(e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0)}function Qa(e,t,r,o,h,g){var A=e.pendingLanes;e.pendingLanes=r,e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0,e.expiredLanes&=r,e.entangledLanes&=r,e.errorRecoveryDisabledLanes&=r,e.shellSuspendCounter=0;var H=e.entanglements,re=e.expirationTimes,_e=e.hiddenUpdates;for(r=A&~r;0<r;){var Ne=31-Mt(r),Ue=1<<Ne;H[Ne]=0,re[Ne]=-1;var we=_e[Ne];if(we!==null)for(_e[Ne]=null,Ne=0;Ne<we.length;Ne++){var Ae=we[Ne];Ae!==null&&(Ae.lane&=-536870913)}r&=~Ue}o!==0&&Ja(e,o,0),g!==0&&h===0&&e.tag!==0&&(e.suspendedLanes|=g&~(A&~t))}function Ja(e,t,r){e.pendingLanes|=t,e.suspendedLanes&=~t;var o=31-Mt(t);e.entangledLanes|=t,e.entanglements[o]=e.entanglements[o]|1073741824|r&261930}function Ir(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var o=31-Mt(r),h=1<<o;h&t|e[o]&t&&(e[o]|=t),r&=~h}}function Fn(e,t){var r=t&-t;return r=(r&42)!==0?1:An(r),(r&(e.suspendedLanes|t))!==0?0:r}function An(e){switch(e){case 2:e=1;break;case 8:e=4;break;case 32:e=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:e=128;break;case 268435456:e=134217728;break;default:e=0}return e}function Sa(e){return e&=-e,2<e?8<e?(e&134217727)!==0?32:268435456:8:2}function Rr(){var e=P.p;return e!==0?e:(e=window.event,e===void 0?32:fy(e.type))}function Ls(e,t){var r=P.p;try{return P.p=e,t()}finally{P.p=r}}var ur=Math.random().toString(36).slice(2),Yt="__reactFiber$"+ur,Bt="__reactProps$"+ur,Mr="__reactContainer$"+ur,Xa="__reactEvents$"+ur,Wa="__reactListeners$"+ur,fi="__reactHandles$"+ur,Xe="__reactResources$"+ur,fe="__reactMarker$"+ur;function Be(e){delete e[Yt],delete e[Bt],delete e[Xa],delete e[Wa],delete e[fi]}function Ke(e){var t=e[Yt];if(t)return t;for(var r=e.parentNode;r;){if(t=r[Mr]||r[Yt]){if(r=t.alternate,t.child!==null||r!==null&&r.child!==null)for(e=Qg(e);e!==null;){if(r=e[Yt])return r;e=Qg(e)}return t}e=r,r=e.parentNode}return null}function ft(e){if(e=e[Yt]||e[Mr]){var t=e.tag;if(t===5||t===6||t===13||t===31||t===26||t===27||t===3)return e}return null}function sn(e){var t=e.tag;if(t===5||t===26||t===27||t===6)return e.stateNode;throw Error(i(33))}function nn(e){var t=e[Xe];return t||(t=e[Xe]={hoistableStyles:new Map,hoistableScripts:new Map}),t}function kt(e){e[fe]=!0}var kn=new Set,vr={};function on(e,t){Zn(e,t),Zn(e+"Capture",t)}function Zn(e,t){for(vr[e]=t,e=0;e<t.length;e++)kn.add(t[e])}var es=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),fo={},ho={};function Ul(e){return ie.call(ho,e)?!0:ie.call(fo,e)?!1:es.test(e)?ho[e]=!0:(fo[e]=!0,!1)}function hi(e,t,r){if(Ul(t))if(r===null)e.removeAttribute(t);else{switch(typeof r){case"undefined":case"function":case"symbol":e.removeAttribute(t);return;case"boolean":var o=t.toLowerCase().slice(0,5);if(o!=="data-"&&o!=="aria-"){e.removeAttribute(t);return}}e.setAttribute(t,""+r)}}function zs(e,t,r){if(r===null)e.removeAttribute(t);else{switch(typeof r){case"undefined":case"function":case"symbol":case"boolean":e.removeAttribute(t);return}e.setAttribute(t,""+r)}}function Ur(e,t,r,o){if(o===null)e.removeAttribute(r);else{switch(typeof o){case"undefined":case"function":case"symbol":case"boolean":e.removeAttribute(r);return}e.setAttributeNS(t,r,""+o)}}function Un(e){switch(typeof e){case"bigint":case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function mo(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function Wt(e,t,r){var o=Object.getOwnPropertyDescriptor(e.constructor.prototype,t);if(!e.hasOwnProperty(t)&&typeof o<"u"&&typeof o.get=="function"&&typeof o.set=="function"){var h=o.get,g=o.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return h.call(this)},set:function(A){r=""+A,g.call(this,A)}}),Object.defineProperty(e,t,{enumerable:o.enumerable}),{getValue:function(){return r},setValue:function(A){r=""+A},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function wa(e){if(!e._valueTracker){var t=mo(e)?"checked":"value";e._valueTracker=Wt(e,t,""+e[t])}}function mi(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),o="";return e&&(o=mo(e)?e.checked?"true":"false":e.value),e=o,e!==r?(t.setValue(e),!0):!1}function Lr(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}var pi=/[\n"\\]/g;function Bn(e){return e.replace(pi,function(t){return"\\"+t.charCodeAt(0).toString(16)+" "})}function ts(e,t,r,o,h,g,A,H){e.name="",A!=null&&typeof A!="function"&&typeof A!="symbol"&&typeof A!="boolean"?e.type=A:e.removeAttribute("type"),t!=null?A==="number"?(t===0&&e.value===""||e.value!=t)&&(e.value=""+Un(t)):e.value!==""+Un(t)&&(e.value=""+Un(t)):A!=="submit"&&A!=="reset"||e.removeAttribute("value"),t!=null?po(e,A,Un(t)):r!=null?po(e,A,Un(r)):o!=null&&e.removeAttribute("value"),h==null&&g!=null&&(e.defaultChecked=!!g),h!=null&&(e.checked=h&&typeof h!="function"&&typeof h!="symbol"),H!=null&&typeof H!="function"&&typeof H!="symbol"&&typeof H!="boolean"?e.name=""+Un(H):e.removeAttribute("name")}function ns(e,t,r,o,h,g,A,H){if(g!=null&&typeof g!="function"&&typeof g!="symbol"&&typeof g!="boolean"&&(e.type=g),t!=null||r!=null){if(!(g!=="submit"&&g!=="reset"||t!=null)){wa(e);return}r=r!=null?""+Un(r):"",t=t!=null?""+Un(t):r,H||t===e.value||(e.value=t),e.defaultValue=t}o=o??h,o=typeof o!="function"&&typeof o!="symbol"&&!!o,e.checked=H?e.checked:!!o,e.defaultChecked=!!o,A!=null&&typeof A!="function"&&typeof A!="symbol"&&typeof A!="boolean"&&(e.name=A),wa(e)}function po(e,t,r){t==="number"&&Lr(e.ownerDocument)===e||e.defaultValue===""+r||(e.defaultValue=""+r)}function rs(e,t,r,o){if(e=e.options,t){t={};for(var h=0;h<r.length;h++)t["$"+r[h]]=!0;for(r=0;r<e.length;r++)h=t.hasOwnProperty("$"+e[r].value),e[r].selected!==h&&(e[r].selected=h),h&&o&&(e[r].defaultSelected=!0)}else{for(r=""+Un(r),t=null,h=0;h<e.length;h++){if(e[h].value===r){e[h].selected=!0,o&&(e[h].defaultSelected=!0);return}t!==null||e[h].disabled||(t=e[h])}t!==null&&(t.selected=!0)}}function go(e,t,r){if(t!=null&&(t=""+Un(t),t!==e.value&&(e.value=t),r==null)){e.defaultValue!==t&&(e.defaultValue=t);return}e.defaultValue=r!=null?""+Un(r):""}function gi(e,t,r,o){if(t==null){if(o!=null){if(r!=null)throw Error(i(92));if(se(o)){if(1<o.length)throw Error(i(93));o=o[0]}r=o}r==null&&(r=""),t=r}r=Un(t),e.defaultValue=r,o=e.textContent,o===r&&o!==""&&o!==null&&(e.value=o),wa(e)}function Ea(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&r.nodeType===3){r.nodeValue=t;return}}e.textContent=t}var yo=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function yi(e,t,r){var o=t.indexOf("--")===0;r==null||typeof r=="boolean"||r===""?o?e.setProperty(t,""):t==="float"?e.cssFloat="":e[t]="":o?e.setProperty(t,r):typeof r!="number"||r===0||yo.has(t)?t==="float"?e.cssFloat=r:e[t]=(""+r).trim():e[t]=r+"px"}function Ll(e,t,r){if(t!=null&&typeof t!="object")throw Error(i(62));if(e=e.style,r!=null){for(var o in r)!r.hasOwnProperty(o)||t!=null&&t.hasOwnProperty(o)||(o.indexOf("--")===0?e.setProperty(o,""):o==="float"?e.cssFloat="":e[o]="");for(var h in t)o=t[h],t.hasOwnProperty(h)&&r[h]!==o&&yi(e,h,o)}else for(var g in t)t.hasOwnProperty(g)&&yi(e,g,t[g])}function as(e){if(e.indexOf("-")===-1)return!1;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var vi=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Ta=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function ss(e){return Ta.test(""+e)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":e}function In(){}var ua=null;function is(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var Aa=null,os=null;function at(e){var t=ft(e);if(t&&(e=t.stateNode)){var r=e[Bt]||null;e:switch(e=t.stateNode,t.type){case"input":if(ts(e,r.value,r.defaultValue,r.defaultValue,r.checked,r.defaultChecked,r.type,r.name),t=r.name,r.type==="radio"&&t!=null){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll('input[name="'+Bn(""+t)+'"][type="radio"]'),t=0;t<r.length;t++){var o=r[t];if(o!==e&&o.form===e.form){var h=o[Bt]||null;if(!h)throw Error(i(90));ts(o,h.value,h.defaultValue,h.defaultValue,h.checked,h.defaultChecked,h.type,h.name)}}for(t=0;t<r.length;t++)o=r[t],o.form===e.form&&mi(o)}break e;case"textarea":go(e,r.value,r.defaultValue);break e;case"select":t=r.value,t!=null&&rs(e,!!r.multiple,t,!1)}}}var bi=!1;function Fs(e,t,r){if(bi)return e(t,r);bi=!0;try{var o=e(t);return o}finally{if(bi=!1,(Aa!==null||os!==null)&&(Ac(),Aa&&(t=Aa,e=os,os=Aa=null,at(t),e)))for(t=0;t<e.length;t++)at(e[t])}}function da(e,t){var r=e.stateNode;if(r===null)return null;var o=r[Bt]||null;if(o===null)return null;r=o[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(o=!o.disabled)||(e=e.type,o=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!o;break e;default:e=!1}if(e)return null;if(r&&typeof r!="function")throw Error(i(231,t,typeof r));return r}var zr=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),ka=!1;if(zr)try{var Xr={};Object.defineProperty(Xr,"passive",{get:function(){ka=!0}}),window.addEventListener("test",Xr,Xr),window.removeEventListener("test",Xr,Xr)}catch{ka=!1}var Hn=null,ls=null,Bs=null;function y(){if(Bs)return Bs;var e,t=ls,r=t.length,o,h="value"in Hn?Hn.value:Hn.textContent,g=h.length;for(e=0;e<r&&t[e]===h[e];e++);var A=r-e;for(o=1;o<=A&&t[r-o]===h[g-o];o++);return Bs=h.slice(e,1<o?1-o:void 0)}function b(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function D(){return!0}function V(){return!1}function W(e){function t(r,o,h,g,A){this._reactName=r,this._targetInst=h,this.type=o,this.nativeEvent=g,this.target=A,this.currentTarget=null;for(var H in e)e.hasOwnProperty(H)&&(r=e[H],this[H]=r?r(g):g[H]);return this.isDefaultPrevented=(g.defaultPrevented!=null?g.defaultPrevented:g.returnValue===!1)?D:V,this.isPropagationStopped=V,this}return _(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=D)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=D)},persist:function(){},isPersistent:D}),t}var Te={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Re=W(Te),ot=_({},Te,{view:0,detail:0}),Ut=W(ot),yt,dn,fn,Hs=_({},ot,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:bo,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==fn&&(fn&&e.type==="mousemove"?(yt=e.screenX-fn.screenX,dn=e.screenY-fn.screenY):dn=yt=0,fn=e),yt)},movementY:function(e){return"movementY"in e?e.movementY:dn}}),zl=W(Hs),Fl=_({},Hs,{dataTransfer:0}),ju=W(Fl),Bl=_({},ot,{relatedTarget:0}),vo=W(Bl),Iu=_({},Te,{animationName:0,elapsedTime:0,pseudoElement:0}),Ru=W(Iu),Mu=_({},Te,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),Uu=W(Mu),Lu=_({},Te,{data:0}),Hl=W(Lu),zu={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Gl={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Fu={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Bu(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=Fu[e])?!!t[e]:!1}function bo(){return Bu}var Hu=_({},ot,{key:function(e){if(e.key){var t=zu[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=b(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?Gl[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:bo,charCode:function(e){return e.type==="keypress"?b(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?b(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),Gu=W(Hu),qu=_({},Hs,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),ql=W(qu),Pl=_({},ot,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:bo}),Pu=W(Pl),$u=_({},Te,{propertyName:0,elapsedTime:0,pseudoElement:0}),Yu=W($u),Vu=_({},Hs,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Ku=W(Vu),Zu=_({},Te,{newState:0,oldState:0}),$l=W(Zu),Qu=[9,13,27,32],xo=zr&&"CompositionEvent"in window,Gs=null;zr&&"documentMode"in document&&(Gs=document.documentMode);var xi=zr&&"TextEvent"in window&&!Gs,_o=zr&&(!xo||Gs&&8<Gs&&11>=Gs),So=" ",be=!1;function Fe(e,t){switch(e){case"keyup":return Qu.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function et(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var lt=!1;function Et(e,t){switch(e){case"compositionend":return et(t);case"keypress":return t.which!==32?null:(be=!0,So);case"textInput":return e=t.data,e===So&&be?null:e;default:return null}}function Zt(e,t){if(lt)return e==="compositionend"||!xo&&Fe(e,t)?(e=y(),Bs=ls=Hn=null,lt=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return _o&&t.locale!=="ko"?null:t.data;default:return null}}var br={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function nr(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!br[e.type]:t==="textarea"}function Qn(e,t,r,o){Aa?os?os.push(o):os=[o]:Aa=o,t=Ic(t,"onChange"),0<t.length&&(r=new Re("onChange","change",null,r,o),e.push({event:r,listeners:t}))}var Gn=null,Ca=null;function Na(e){Ug(e,0)}function _i(e){var t=sn(e);if(mi(t))return e}function tm(e,t){if(e==="change")return t}var nm=!1;if(zr){var Ju;if(zr){var Xu="oninput"in document;if(!Xu){var rm=document.createElement("div");rm.setAttribute("oninput","return;"),Xu=typeof rm.oninput=="function"}Ju=Xu}else Ju=!1;nm=Ju&&(!document.documentMode||9<document.documentMode)}function am(){Gn&&(Gn.detachEvent("onpropertychange",sm),Ca=Gn=null)}function sm(e){if(e.propertyName==="value"&&_i(Ca)){var t=[];Qn(t,Ca,e,is(e)),Fs(Na,t)}}function R0(e,t,r){e==="focusin"?(am(),Gn=t,Ca=r,Gn.attachEvent("onpropertychange",sm)):e==="focusout"&&am()}function M0(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return _i(Ca)}function U0(e,t){if(e==="click")return _i(t)}function L0(e,t){if(e==="input"||e==="change")return _i(t)}function z0(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var xr=typeof Object.is=="function"?Object.is:z0;function wo(e,t){if(xr(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var r=Object.keys(e),o=Object.keys(t);if(r.length!==o.length)return!1;for(o=0;o<r.length;o++){var h=r[o];if(!ie.call(t,h)||!xr(e[h],t[h]))return!1}return!0}function im(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function om(e,t){var r=im(e);e=0;for(var o;r;){if(r.nodeType===3){if(o=e+r.textContent.length,e<=t&&o>=t)return{node:r,offset:t-e};e=o}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=im(r)}}function lm(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?lm(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function cm(e){e=e!=null&&e.ownerDocument!=null&&e.ownerDocument.defaultView!=null?e.ownerDocument.defaultView:window;for(var t=Lr(e.document);t instanceof e.HTMLIFrameElement;){try{var r=typeof t.contentWindow.location.href=="string"}catch{r=!1}if(r)e=t.contentWindow;else break;t=Lr(e.document)}return t}function Wu(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}var F0=zr&&"documentMode"in document&&11>=document.documentMode,Si=null,ed=null,Eo=null,td=!1;function um(e,t,r){var o=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;td||Si==null||Si!==Lr(o)||(o=Si,"selectionStart"in o&&Wu(o)?o={start:o.selectionStart,end:o.selectionEnd}:(o=(o.ownerDocument&&o.ownerDocument.defaultView||window).getSelection(),o={anchorNode:o.anchorNode,anchorOffset:o.anchorOffset,focusNode:o.focusNode,focusOffset:o.focusOffset}),Eo&&wo(Eo,o)||(Eo=o,o=Ic(ed,"onSelect"),0<o.length&&(t=new Re("onSelect","select",null,t,r),e.push({event:t,listeners:o}),t.target=Si)))}function qs(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var wi={animationend:qs("Animation","AnimationEnd"),animationiteration:qs("Animation","AnimationIteration"),animationstart:qs("Animation","AnimationStart"),transitionrun:qs("Transition","TransitionRun"),transitionstart:qs("Transition","TransitionStart"),transitioncancel:qs("Transition","TransitionCancel"),transitionend:qs("Transition","TransitionEnd")},nd={},dm={};zr&&(dm=document.createElement("div").style,"AnimationEvent"in window||(delete wi.animationend.animation,delete wi.animationiteration.animation,delete wi.animationstart.animation),"TransitionEvent"in window||delete wi.transitionend.transition);function Ps(e){if(nd[e])return nd[e];if(!wi[e])return e;var t=wi[e],r;for(r in t)if(t.hasOwnProperty(r)&&r in dm)return nd[e]=t[r];return e}var fm=Ps("animationend"),hm=Ps("animationiteration"),mm=Ps("animationstart"),B0=Ps("transitionrun"),H0=Ps("transitionstart"),G0=Ps("transitioncancel"),pm=Ps("transitionend"),gm=new Map,rd="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");rd.push("scrollEnd");function Wr(e,t){gm.set(e,t),on(t,[e])}var Yl=typeof reportError=="function"?reportError:function(e){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var t=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof e=="object"&&e!==null&&typeof e.message=="string"?String(e.message):String(e),error:e});if(!window.dispatchEvent(t))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",e);return}console.error(e)},Fr=[],Ei=0,ad=0;function Vl(){for(var e=Ei,t=ad=Ei=0;t<e;){var r=Fr[t];Fr[t++]=null;var o=Fr[t];Fr[t++]=null;var h=Fr[t];Fr[t++]=null;var g=Fr[t];if(Fr[t++]=null,o!==null&&h!==null){var A=o.pending;A===null?h.next=h:(h.next=A.next,A.next=h),o.pending=h}g!==0&&ym(r,h,g)}}function Kl(e,t,r,o){Fr[Ei++]=e,Fr[Ei++]=t,Fr[Ei++]=r,Fr[Ei++]=o,ad|=o,e.lanes|=o,e=e.alternate,e!==null&&(e.lanes|=o)}function sd(e,t,r,o){return Kl(e,t,r,o),Zl(e)}function $s(e,t){return Kl(e,null,null,t),Zl(e)}function ym(e,t,r){e.lanes|=r;var o=e.alternate;o!==null&&(o.lanes|=r);for(var h=!1,g=e.return;g!==null;)g.childLanes|=r,o=g.alternate,o!==null&&(o.childLanes|=r),g.tag===22&&(e=g.stateNode,e===null||e._visibility&1||(h=!0)),e=g,g=g.return;return e.tag===3?(g=e.stateNode,h&&t!==null&&(h=31-Mt(r),e=g.hiddenUpdates,o=e[h],o===null?e[h]=[t]:o.push(t),t.lane=r|536870912),g):null}function Zl(e){if(50<Yo)throw Yo=0,pf=null,Error(i(185));for(var t=e.return;t!==null;)e=t,t=e.return;return e.tag===3?e.stateNode:null}var Ti={};function q0(e,t,r,o){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=o,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function _r(e,t,r,o){return new q0(e,t,r,o)}function id(e){return e=e.prototype,!(!e||!e.isReactComponent)}function Da(e,t){var r=e.alternate;return r===null?(r=_r(e.tag,t,e.key,e.mode),r.elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=e.flags&65011712,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r.refCleanup=e.refCleanup,r}function vm(e,t){e.flags&=65011714;var r=e.alternate;return r===null?(e.childLanes=0,e.lanes=t,e.child=null,e.subtreeFlags=0,e.memoizedProps=null,e.memoizedState=null,e.updateQueue=null,e.dependencies=null,e.stateNode=null):(e.childLanes=r.childLanes,e.lanes=r.lanes,e.child=r.child,e.subtreeFlags=0,e.deletions=null,e.memoizedProps=r.memoizedProps,e.memoizedState=r.memoizedState,e.updateQueue=r.updateQueue,e.type=r.type,t=r.dependencies,e.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),e}function Ql(e,t,r,o,h,g){var A=0;if(o=e,typeof e=="function")id(e)&&(A=1);else if(typeof e=="string")A=Kx(e,r,ae.current)?26:e==="html"||e==="head"||e==="body"?27:5;else e:switch(e){case O:return e=_r(31,r,t,h),e.elementType=O,e.lanes=g,e;case w:return Ys(r.children,h,g,t);case S:A=8,h|=24;break;case C:return e=_r(12,r,t,h|2),e.elementType=C,e.lanes=g,e;case G:return e=_r(13,r,t,h),e.elementType=G,e.lanes=g,e;case Q:return e=_r(19,r,t,h),e.elementType=Q,e.lanes=g,e;default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case L:A=10;break e;case R:A=9;break e;case F:A=11;break e;case U:A=14;break e;case j:A=16,o=null;break e}A=29,r=Error(i(130,e===null?"null":typeof e,"")),o=null}return t=_r(A,r,t,h),t.elementType=e,t.type=o,t.lanes=g,t}function Ys(e,t,r,o){return e=_r(7,e,o,t),e.lanes=r,e}function od(e,t,r){return e=_r(6,e,null,t),e.lanes=r,e}function bm(e){var t=_r(18,null,null,0);return t.stateNode=e,t}function ld(e,t,r){return t=_r(4,e.children!==null?e.children:[],e.key,t),t.lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}var xm=new WeakMap;function Br(e,t){if(typeof e=="object"&&e!==null){var r=xm.get(e);return r!==void 0?r:(t={value:e,source:t,stack:Y(t)},xm.set(e,t),t)}return{value:e,source:t,stack:Y(t)}}var Ai=[],ki=0,Jl=null,To=0,Hr=[],Gr=0,cs=null,fa=1,ha="";function Oa(e,t){Ai[ki++]=To,Ai[ki++]=Jl,Jl=e,To=t}function _m(e,t,r){Hr[Gr++]=fa,Hr[Gr++]=ha,Hr[Gr++]=cs,cs=e;var o=fa;e=ha;var h=32-Mt(o)-1;o&=~(1<<h),r+=1;var g=32-Mt(t)+h;if(30<g){var A=h-h%5;g=(o&(1<<A)-1).toString(32),o>>=A,h-=A,fa=1<<32-Mt(t)+h|r<<h|o,ha=g+e}else fa=1<<g|r<<h|o,ha=e}function cd(e){e.return!==null&&(Oa(e,1),_m(e,1,0))}function ud(e){for(;e===Jl;)Jl=Ai[--ki],Ai[ki]=null,To=Ai[--ki],Ai[ki]=null;for(;e===cs;)cs=Hr[--Gr],Hr[Gr]=null,ha=Hr[--Gr],Hr[Gr]=null,fa=Hr[--Gr],Hr[Gr]=null}function Sm(e,t){Hr[Gr++]=fa,Hr[Gr++]=ha,Hr[Gr++]=cs,fa=t.id,ha=t.overflow,cs=e}var qn=null,ln=null,Lt=!1,us=null,qr=!1,dd=Error(i(519));function ds(e){var t=Error(i(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw Ao(Br(t,e)),dd}function wm(e){var t=e.stateNode,r=e.type,o=e.memoizedProps;switch(t[Yt]=e,t[Bt]=o,r){case"dialog":Dt("cancel",t),Dt("close",t);break;case"iframe":case"object":case"embed":Dt("load",t);break;case"video":case"audio":for(r=0;r<Ko.length;r++)Dt(Ko[r],t);break;case"source":Dt("error",t);break;case"img":case"image":case"link":Dt("error",t),Dt("load",t);break;case"details":Dt("toggle",t);break;case"input":Dt("invalid",t),ns(t,o.value,o.defaultValue,o.checked,o.defaultChecked,o.type,o.name,!0);break;case"select":Dt("invalid",t);break;case"textarea":Dt("invalid",t),gi(t,o.value,o.defaultValue,o.children)}r=o.children,typeof r!="string"&&typeof r!="number"&&typeof r!="bigint"||t.textContent===""+r||o.suppressHydrationWarning===!0||Bg(t.textContent,r)?(o.popover!=null&&(Dt("beforetoggle",t),Dt("toggle",t)),o.onScroll!=null&&Dt("scroll",t),o.onScrollEnd!=null&&Dt("scrollend",t),o.onClick!=null&&(t.onclick=In),t=!0):t=!1,t||ds(e,!0)}function Em(e){for(qn=e.return;qn;)switch(qn.tag){case 5:case 31:case 13:qr=!1;return;case 27:case 3:qr=!0;return;default:qn=qn.return}}function Ci(e){if(e!==qn)return!1;if(!Lt)return Em(e),Lt=!0,!1;var t=e.tag,r;if((r=t!==3&&t!==27)&&((r=t===5)&&(r=e.type,r=!(r!=="form"&&r!=="button")||Df(e.type,e.memoizedProps)),r=!r),r&&ln&&ds(e),Em(e),t===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(i(317));ln=Zg(e)}else if(t===31){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(i(317));ln=Zg(e)}else t===27?(t=ln,Ts(e.type)?(e=Mf,Mf=null,ln=e):ln=t):ln=qn?$r(e.stateNode.nextSibling):null;return!0}function Vs(){ln=qn=null,Lt=!1}function fd(){var e=us;return e!==null&&(mr===null?mr=e:mr.push.apply(mr,e),us=null),e}function Ao(e){us===null?us=[e]:us.push(e)}var hd=z(null),Ks=null,ja=null;function fs(e,t,r){te(hd,t._currentValue),t._currentValue=r}function Ia(e){e._currentValue=hd.current,I(hd)}function md(e,t,r){for(;e!==null;){var o=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,o!==null&&(o.childLanes|=t)):o!==null&&(o.childLanes&t)!==t&&(o.childLanes|=t),e===r)break;e=e.return}}function pd(e,t,r,o){var h=e.child;for(h!==null&&(h.return=e);h!==null;){var g=h.dependencies;if(g!==null){var A=h.child;g=g.firstContext;e:for(;g!==null;){var H=g;g=h;for(var re=0;re<t.length;re++)if(H.context===t[re]){g.lanes|=r,H=g.alternate,H!==null&&(H.lanes|=r),md(g.return,r,e),o||(A=null);break e}g=H.next}}else if(h.tag===18){if(A=h.return,A===null)throw Error(i(341));A.lanes|=r,g=A.alternate,g!==null&&(g.lanes|=r),md(A,r,e),A=null}else A=h.child;if(A!==null)A.return=h;else for(A=h;A!==null;){if(A===e){A=null;break}if(h=A.sibling,h!==null){h.return=A.return,A=h;break}A=A.return}h=A}}function Ni(e,t,r,o){e=null;for(var h=t,g=!1;h!==null;){if(!g){if((h.flags&524288)!==0)g=!0;else if((h.flags&262144)!==0)break}if(h.tag===10){var A=h.alternate;if(A===null)throw Error(i(387));if(A=A.memoizedProps,A!==null){var H=h.type;xr(h.pendingProps.value,A.value)||(e!==null?e.push(H):e=[H])}}else if(h===de.current){if(A=h.alternate,A===null)throw Error(i(387));A.memoizedState.memoizedState!==h.memoizedState.memoizedState&&(e!==null?e.push(Wo):e=[Wo])}h=h.return}e!==null&&pd(t,e,r,o),t.flags|=262144}function Xl(e){for(e=e.firstContext;e!==null;){if(!xr(e.context._currentValue,e.memoizedValue))return!0;e=e.next}return!1}function Zs(e){Ks=e,ja=null,e=e.dependencies,e!==null&&(e.firstContext=null)}function Pn(e){return Tm(Ks,e)}function Wl(e,t){return Ks===null&&Zs(e),Tm(e,t)}function Tm(e,t){var r=t._currentValue;if(t={context:t,memoizedValue:r,next:null},ja===null){if(e===null)throw Error(i(308));ja=t,e.dependencies={lanes:0,firstContext:t},e.flags|=524288}else ja=ja.next=t;return r}var P0=typeof AbortController<"u"?AbortController:function(){var e=[],t=this.signal={aborted:!1,addEventListener:function(r,o){e.push(o)}};this.abort=function(){t.aborted=!0,e.forEach(function(r){return r()})}},$0=n.unstable_scheduleCallback,Y0=n.unstable_NormalPriority,Cn={$$typeof:L,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function gd(){return{controller:new P0,data:new Map,refCount:0}}function ko(e){e.refCount--,e.refCount===0&&$0(Y0,function(){e.controller.abort()})}var Co=null,yd=0,Di=0,Oi=null;function V0(e,t){if(Co===null){var r=Co=[];yd=0,Di=_f(),Oi={status:"pending",value:void 0,then:function(o){r.push(o)}}}return yd++,t.then(Am,Am),t}function Am(){if(--yd===0&&Co!==null){Oi!==null&&(Oi.status="fulfilled");var e=Co;Co=null,Di=0,Oi=null;for(var t=0;t<e.length;t++)(0,e[t])()}}function K0(e,t){var r=[],o={status:"pending",value:null,reason:null,then:function(h){r.push(h)}};return e.then(function(){o.status="fulfilled",o.value=t;for(var h=0;h<r.length;h++)(0,r[h])(t)},function(h){for(o.status="rejected",o.reason=h,h=0;h<r.length;h++)(0,r[h])(void 0)}),o}var km=K.S;K.S=function(e,t){ug=He(),typeof t=="object"&&t!==null&&typeof t.then=="function"&&V0(e,t),km!==null&&km(e,t)};var Qs=z(null);function vd(){var e=Qs.current;return e!==null?e:en.pooledCache}function ec(e,t){t===null?te(Qs,Qs.current):te(Qs,t.pool)}function Cm(){var e=vd();return e===null?null:{parent:Cn._currentValue,pool:e}}var ji=Error(i(460)),bd=Error(i(474)),tc=Error(i(542)),nc={then:function(){}};function Nm(e){return e=e.status,e==="fulfilled"||e==="rejected"}function Dm(e,t,r){switch(r=e[r],r===void 0?e.push(t):r!==t&&(t.then(In,In),t=r),t.status){case"fulfilled":return t.value;case"rejected":throw e=t.reason,jm(e),e;default:if(typeof t.status=="string")t.then(In,In);else{if(e=en,e!==null&&100<e.shellSuspendCounter)throw Error(i(482));e=t,e.status="pending",e.then(function(o){if(t.status==="pending"){var h=t;h.status="fulfilled",h.value=o}},function(o){if(t.status==="pending"){var h=t;h.status="rejected",h.reason=o}})}switch(t.status){case"fulfilled":return t.value;case"rejected":throw e=t.reason,jm(e),e}throw Xs=t,ji}}function Js(e){try{var t=e._init;return t(e._payload)}catch(r){throw r!==null&&typeof r=="object"&&typeof r.then=="function"?(Xs=r,ji):r}}var Xs=null;function Om(){if(Xs===null)throw Error(i(459));var e=Xs;return Xs=null,e}function jm(e){if(e===ji||e===tc)throw Error(i(483))}var Ii=null,No=0;function rc(e){var t=No;return No+=1,Ii===null&&(Ii=[]),Dm(Ii,e,t)}function Do(e,t){t=t.props.ref,e.ref=t!==void 0?t:null}function ac(e,t){throw t.$$typeof===T?Error(i(525)):(e=Object.prototype.toString.call(t),Error(i(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)))}function Im(e){function t(ye,he){if(e){var xe=ye.deletions;xe===null?(ye.deletions=[he],ye.flags|=16):xe.push(he)}}function r(ye,he){if(!e)return null;for(;he!==null;)t(ye,he),he=he.sibling;return null}function o(ye){for(var he=new Map;ye!==null;)ye.key!==null?he.set(ye.key,ye):he.set(ye.index,ye),ye=ye.sibling;return he}function h(ye,he){return ye=Da(ye,he),ye.index=0,ye.sibling=null,ye}function g(ye,he,xe){return ye.index=xe,e?(xe=ye.alternate,xe!==null?(xe=xe.index,xe<he?(ye.flags|=67108866,he):xe):(ye.flags|=67108866,he)):(ye.flags|=1048576,he)}function A(ye){return e&&ye.alternate===null&&(ye.flags|=67108866),ye}function H(ye,he,xe,Me){return he===null||he.tag!==6?(he=od(xe,ye.mode,Me),he.return=ye,he):(he=h(he,xe),he.return=ye,he)}function re(ye,he,xe,Me){var it=xe.type;return it===w?Ne(ye,he,xe.props.children,Me,xe.key):he!==null&&(he.elementType===it||typeof it=="object"&&it!==null&&it.$$typeof===j&&Js(it)===he.type)?(he=h(he,xe.props),Do(he,xe),he.return=ye,he):(he=Ql(xe.type,xe.key,xe.props,null,ye.mode,Me),Do(he,xe),he.return=ye,he)}function _e(ye,he,xe,Me){return he===null||he.tag!==4||he.stateNode.containerInfo!==xe.containerInfo||he.stateNode.implementation!==xe.implementation?(he=ld(xe,ye.mode,Me),he.return=ye,he):(he=h(he,xe.children||[]),he.return=ye,he)}function Ne(ye,he,xe,Me,it){return he===null||he.tag!==7?(he=Ys(xe,ye.mode,Me,it),he.return=ye,he):(he=h(he,xe),he.return=ye,he)}function Ue(ye,he,xe){if(typeof he=="string"&&he!==""||typeof he=="number"||typeof he=="bigint")return he=od(""+he,ye.mode,xe),he.return=ye,he;if(typeof he=="object"&&he!==null){switch(he.$$typeof){case x:return xe=Ql(he.type,he.key,he.props,null,ye.mode,xe),Do(xe,he),xe.return=ye,xe;case k:return he=ld(he,ye.mode,xe),he.return=ye,he;case j:return he=Js(he),Ue(ye,he,xe)}if(se(he)||M(he))return he=Ys(he,ye.mode,xe,null),he.return=ye,he;if(typeof he.then=="function")return Ue(ye,rc(he),xe);if(he.$$typeof===L)return Ue(ye,Wl(ye,he),xe);ac(ye,he)}return null}function we(ye,he,xe,Me){var it=he!==null?he.key:null;if(typeof xe=="string"&&xe!==""||typeof xe=="number"||typeof xe=="bigint")return it!==null?null:H(ye,he,""+xe,Me);if(typeof xe=="object"&&xe!==null){switch(xe.$$typeof){case x:return xe.key===it?re(ye,he,xe,Me):null;case k:return xe.key===it?_e(ye,he,xe,Me):null;case j:return xe=Js(xe),we(ye,he,xe,Me)}if(se(xe)||M(xe))return it!==null?null:Ne(ye,he,xe,Me,null);if(typeof xe.then=="function")return we(ye,he,rc(xe),Me);if(xe.$$typeof===L)return we(ye,he,Wl(ye,xe),Me);ac(ye,xe)}return null}function Ae(ye,he,xe,Me,it){if(typeof Me=="string"&&Me!==""||typeof Me=="number"||typeof Me=="bigint")return ye=ye.get(xe)||null,H(he,ye,""+Me,it);if(typeof Me=="object"&&Me!==null){switch(Me.$$typeof){case x:return ye=ye.get(Me.key===null?xe:Me.key)||null,re(he,ye,Me,it);case k:return ye=ye.get(Me.key===null?xe:Me.key)||null,_e(he,ye,Me,it);case j:return Me=Js(Me),Ae(ye,he,xe,Me,it)}if(se(Me)||M(Me))return ye=ye.get(xe)||null,Ne(he,ye,Me,it,null);if(typeof Me.then=="function")return Ae(ye,he,xe,rc(Me),it);if(Me.$$typeof===L)return Ae(ye,he,xe,Wl(he,Me),it);ac(he,Me)}return null}function Je(ye,he,xe,Me){for(var it=null,Ht=null,tt=he,_t=he=0,Rt=null;tt!==null&&_t<xe.length;_t++){tt.index>_t?(Rt=tt,tt=null):Rt=tt.sibling;var Gt=we(ye,tt,xe[_t],Me);if(Gt===null){tt===null&&(tt=Rt);break}e&&tt&&Gt.alternate===null&&t(ye,tt),he=g(Gt,he,_t),Ht===null?it=Gt:Ht.sibling=Gt,Ht=Gt,tt=Rt}if(_t===xe.length)return r(ye,tt),Lt&&Oa(ye,_t),it;if(tt===null){for(;_t<xe.length;_t++)tt=Ue(ye,xe[_t],Me),tt!==null&&(he=g(tt,he,_t),Ht===null?it=tt:Ht.sibling=tt,Ht=tt);return Lt&&Oa(ye,_t),it}for(tt=o(tt);_t<xe.length;_t++)Rt=Ae(tt,ye,_t,xe[_t],Me),Rt!==null&&(e&&Rt.alternate!==null&&tt.delete(Rt.key===null?_t:Rt.key),he=g(Rt,he,_t),Ht===null?it=Rt:Ht.sibling=Rt,Ht=Rt);return e&&tt.forEach(function(Ds){return t(ye,Ds)}),Lt&&Oa(ye,_t),it}function dt(ye,he,xe,Me){if(xe==null)throw Error(i(151));for(var it=null,Ht=null,tt=he,_t=he=0,Rt=null,Gt=xe.next();tt!==null&&!Gt.done;_t++,Gt=xe.next()){tt.index>_t?(Rt=tt,tt=null):Rt=tt.sibling;var Ds=we(ye,tt,Gt.value,Me);if(Ds===null){tt===null&&(tt=Rt);break}e&&tt&&Ds.alternate===null&&t(ye,tt),he=g(Ds,he,_t),Ht===null?it=Ds:Ht.sibling=Ds,Ht=Ds,tt=Rt}if(Gt.done)return r(ye,tt),Lt&&Oa(ye,_t),it;if(tt===null){for(;!Gt.done;_t++,Gt=xe.next())Gt=Ue(ye,Gt.value,Me),Gt!==null&&(he=g(Gt,he,_t),Ht===null?it=Gt:Ht.sibling=Gt,Ht=Gt);return Lt&&Oa(ye,_t),it}for(tt=o(tt);!Gt.done;_t++,Gt=xe.next())Gt=Ae(tt,ye,_t,Gt.value,Me),Gt!==null&&(e&&Gt.alternate!==null&&tt.delete(Gt.key===null?_t:Gt.key),he=g(Gt,he,_t),Ht===null?it=Gt:Ht.sibling=Gt,Ht=Gt);return e&&tt.forEach(function(s_){return t(ye,s_)}),Lt&&Oa(ye,_t),it}function Xt(ye,he,xe,Me){if(typeof xe=="object"&&xe!==null&&xe.type===w&&xe.key===null&&(xe=xe.props.children),typeof xe=="object"&&xe!==null){switch(xe.$$typeof){case x:e:{for(var it=xe.key;he!==null;){if(he.key===it){if(it=xe.type,it===w){if(he.tag===7){r(ye,he.sibling),Me=h(he,xe.props.children),Me.return=ye,ye=Me;break e}}else if(he.elementType===it||typeof it=="object"&&it!==null&&it.$$typeof===j&&Js(it)===he.type){r(ye,he.sibling),Me=h(he,xe.props),Do(Me,xe),Me.return=ye,ye=Me;break e}r(ye,he);break}else t(ye,he);he=he.sibling}xe.type===w?(Me=Ys(xe.props.children,ye.mode,Me,xe.key),Me.return=ye,ye=Me):(Me=Ql(xe.type,xe.key,xe.props,null,ye.mode,Me),Do(Me,xe),Me.return=ye,ye=Me)}return A(ye);case k:e:{for(it=xe.key;he!==null;){if(he.key===it)if(he.tag===4&&he.stateNode.containerInfo===xe.containerInfo&&he.stateNode.implementation===xe.implementation){r(ye,he.sibling),Me=h(he,xe.children||[]),Me.return=ye,ye=Me;break e}else{r(ye,he);break}else t(ye,he);he=he.sibling}Me=ld(xe,ye.mode,Me),Me.return=ye,ye=Me}return A(ye);case j:return xe=Js(xe),Xt(ye,he,xe,Me)}if(se(xe))return Je(ye,he,xe,Me);if(M(xe)){if(it=M(xe),typeof it!="function")throw Error(i(150));return xe=it.call(xe),dt(ye,he,xe,Me)}if(typeof xe.then=="function")return Xt(ye,he,rc(xe),Me);if(xe.$$typeof===L)return Xt(ye,he,Wl(ye,xe),Me);ac(ye,xe)}return typeof xe=="string"&&xe!==""||typeof xe=="number"||typeof xe=="bigint"?(xe=""+xe,he!==null&&he.tag===6?(r(ye,he.sibling),Me=h(he,xe),Me.return=ye,ye=Me):(r(ye,he),Me=od(xe,ye.mode,Me),Me.return=ye,ye=Me),A(ye)):r(ye,he)}return function(ye,he,xe,Me){try{No=0;var it=Xt(ye,he,xe,Me);return Ii=null,it}catch(tt){if(tt===ji||tt===tc)throw tt;var Ht=_r(29,tt,null,ye.mode);return Ht.lanes=Me,Ht.return=ye,Ht}finally{}}}var Ws=Im(!0),Rm=Im(!1),hs=!1;function xd(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function _d(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,callbacks:null})}function ms(e){return{lane:e,tag:0,payload:null,callback:null,next:null}}function ps(e,t,r){var o=e.updateQueue;if(o===null)return null;if(o=o.shared,(Pt&2)!==0){var h=o.pending;return h===null?t.next=t:(t.next=h.next,h.next=t),o.pending=t,t=Zl(e),ym(e,null,r),t}return Kl(e,o,t,r),Zl(e)}function Oo(e,t,r){if(t=t.updateQueue,t!==null&&(t=t.shared,(r&4194048)!==0)){var o=t.lanes;o&=e.pendingLanes,r|=o,t.lanes=r,Ir(e,r)}}function Sd(e,t){var r=e.updateQueue,o=e.alternate;if(o!==null&&(o=o.updateQueue,r===o)){var h=null,g=null;if(r=r.firstBaseUpdate,r!==null){do{var A={lane:r.lane,tag:r.tag,payload:r.payload,callback:null,next:null};g===null?h=g=A:g=g.next=A,r=r.next}while(r!==null);g===null?h=g=t:g=g.next=t}else h=g=t;r={baseState:o.baseState,firstBaseUpdate:h,lastBaseUpdate:g,shared:o.shared,callbacks:o.callbacks},e.updateQueue=r;return}e=r.lastBaseUpdate,e===null?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}var wd=!1;function jo(){if(wd){var e=Oi;if(e!==null)throw e}}function Io(e,t,r,o){wd=!1;var h=e.updateQueue;hs=!1;var g=h.firstBaseUpdate,A=h.lastBaseUpdate,H=h.shared.pending;if(H!==null){h.shared.pending=null;var re=H,_e=re.next;re.next=null,A===null?g=_e:A.next=_e,A=re;var Ne=e.alternate;Ne!==null&&(Ne=Ne.updateQueue,H=Ne.lastBaseUpdate,H!==A&&(H===null?Ne.firstBaseUpdate=_e:H.next=_e,Ne.lastBaseUpdate=re))}if(g!==null){var Ue=h.baseState;A=0,Ne=_e=re=null,H=g;do{var we=H.lane&-536870913,Ae=we!==H.lane;if(Ae?(It&we)===we:(o&we)===we){we!==0&&we===Di&&(wd=!0),Ne!==null&&(Ne=Ne.next={lane:0,tag:H.tag,payload:H.payload,callback:null,next:null});e:{var Je=e,dt=H;we=t;var Xt=r;switch(dt.tag){case 1:if(Je=dt.payload,typeof Je=="function"){Ue=Je.call(Xt,Ue,we);break e}Ue=Je;break e;case 3:Je.flags=Je.flags&-65537|128;case 0:if(Je=dt.payload,we=typeof Je=="function"?Je.call(Xt,Ue,we):Je,we==null)break e;Ue=_({},Ue,we);break e;case 2:hs=!0}}we=H.callback,we!==null&&(e.flags|=64,Ae&&(e.flags|=8192),Ae=h.callbacks,Ae===null?h.callbacks=[we]:Ae.push(we))}else Ae={lane:we,tag:H.tag,payload:H.payload,callback:H.callback,next:null},Ne===null?(_e=Ne=Ae,re=Ue):Ne=Ne.next=Ae,A|=we;if(H=H.next,H===null){if(H=h.shared.pending,H===null)break;Ae=H,H=Ae.next,Ae.next=null,h.lastBaseUpdate=Ae,h.shared.pending=null}}while(!0);Ne===null&&(re=Ue),h.baseState=re,h.firstBaseUpdate=_e,h.lastBaseUpdate=Ne,g===null&&(h.shared.lanes=0),xs|=A,e.lanes=A,e.memoizedState=Ue}}function Mm(e,t){if(typeof e!="function")throw Error(i(191,e));e.call(t)}function Um(e,t){var r=e.callbacks;if(r!==null)for(e.callbacks=null,e=0;e<r.length;e++)Mm(r[e],t)}var Ri=z(null),sc=z(0);function Lm(e,t){e=Ga,te(sc,e),te(Ri,t),Ga=e|t.baseLanes}function Ed(){te(sc,Ga),te(Ri,Ri.current)}function Td(){Ga=sc.current,I(Ri),I(sc)}var Sr=z(null),Pr=null;function gs(e){var t=e.alternate;te(wn,wn.current&1),te(Sr,e),Pr===null&&(t===null||Ri.current!==null||t.memoizedState!==null)&&(Pr=e)}function Ad(e){te(wn,wn.current),te(Sr,e),Pr===null&&(Pr=e)}function zm(e){e.tag===22?(te(wn,wn.current),te(Sr,e),Pr===null&&(Pr=e)):ys()}function ys(){te(wn,wn.current),te(Sr,Sr.current)}function wr(e){I(Sr),Pr===e&&(Pr=null),I(wn)}var wn=z(0);function ic(e){for(var t=e;t!==null;){if(t.tag===13){var r=t.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||If(r)||Rf(r)))return t}else if(t.tag===19&&(t.memoizedProps.revealOrder==="forwards"||t.memoizedProps.revealOrder==="backwards"||t.memoizedProps.revealOrder==="unstable_legacy-backwards"||t.memoizedProps.revealOrder==="together")){if((t.flags&128)!==0)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var Ra=0,bt=null,Qt=null,Nn=null,oc=!1,Mi=!1,ei=!1,lc=0,Ro=0,Ui=null,Z0=0;function bn(){throw Error(i(321))}function kd(e,t){if(t===null)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!xr(e[r],t[r]))return!1;return!0}function Cd(e,t,r,o,h,g){return Ra=g,bt=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,K.H=e===null||e.memoizedState===null?_p:qd,ei=!1,g=r(o,h),ei=!1,Mi&&(g=Bm(t,r,o,h)),Fm(e),g}function Fm(e){K.H=Lo;var t=Qt!==null&&Qt.next!==null;if(Ra=0,Nn=Qt=bt=null,oc=!1,Ro=0,Ui=null,t)throw Error(i(300));e===null||Dn||(e=e.dependencies,e!==null&&Xl(e)&&(Dn=!0))}function Bm(e,t,r,o){bt=e;var h=0;do{if(Mi&&(Ui=null),Ro=0,Mi=!1,25<=h)throw Error(i(301));if(h+=1,Nn=Qt=null,e.updateQueue!=null){var g=e.updateQueue;g.lastEffect=null,g.events=null,g.stores=null,g.memoCache!=null&&(g.memoCache.index=0)}K.H=Sp,g=t(r,o)}while(Mi);return g}function Q0(){var e=K.H,t=e.useState()[0];return t=typeof t.then=="function"?Mo(t):t,e=e.useState()[0],(Qt!==null?Qt.memoizedState:null)!==e&&(bt.flags|=1024),t}function Nd(){var e=lc!==0;return lc=0,e}function Dd(e,t,r){t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~r}function Od(e){if(oc){for(e=e.memoizedState;e!==null;){var t=e.queue;t!==null&&(t.pending=null),e=e.next}oc=!1}Ra=0,Nn=Qt=bt=null,Mi=!1,Ro=lc=0,Ui=null}function rr(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Nn===null?bt.memoizedState=Nn=e:Nn=Nn.next=e,Nn}function En(){if(Qt===null){var e=bt.alternate;e=e!==null?e.memoizedState:null}else e=Qt.next;var t=Nn===null?bt.memoizedState:Nn.next;if(t!==null)Nn=t,Qt=e;else{if(e===null)throw bt.alternate===null?Error(i(467)):Error(i(310));Qt=e,e={memoizedState:Qt.memoizedState,baseState:Qt.baseState,baseQueue:Qt.baseQueue,queue:Qt.queue,next:null},Nn===null?bt.memoizedState=Nn=e:Nn=Nn.next=e}return Nn}function cc(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Mo(e){var t=Ro;return Ro+=1,Ui===null&&(Ui=[]),e=Dm(Ui,e,t),t=bt,(Nn===null?t.memoizedState:Nn.next)===null&&(t=t.alternate,K.H=t===null||t.memoizedState===null?_p:qd),e}function uc(e){if(e!==null&&typeof e=="object"){if(typeof e.then=="function")return Mo(e);if(e.$$typeof===L)return Pn(e)}throw Error(i(438,String(e)))}function jd(e){var t=null,r=bt.updateQueue;if(r!==null&&(t=r.memoCache),t==null){var o=bt.alternate;o!==null&&(o=o.updateQueue,o!==null&&(o=o.memoCache,o!=null&&(t={data:o.data.map(function(h){return h.slice()}),index:0})))}if(t==null&&(t={data:[],index:0}),r===null&&(r=cc(),bt.updateQueue=r),r.memoCache=t,r=t.data[t.index],r===void 0)for(r=t.data[t.index]=Array(e),o=0;o<e;o++)r[o]=q;return t.index++,r}function Ma(e,t){return typeof t=="function"?t(e):t}function dc(e){var t=En();return Id(t,Qt,e)}function Id(e,t,r){var o=e.queue;if(o===null)throw Error(i(311));o.lastRenderedReducer=r;var h=e.baseQueue,g=o.pending;if(g!==null){if(h!==null){var A=h.next;h.next=g.next,g.next=A}t.baseQueue=h=g,o.pending=null}if(g=e.baseState,h===null)e.memoizedState=g;else{t=h.next;var H=A=null,re=null,_e=t,Ne=!1;do{var Ue=_e.lane&-536870913;if(Ue!==_e.lane?(It&Ue)===Ue:(Ra&Ue)===Ue){var we=_e.revertLane;if(we===0)re!==null&&(re=re.next={lane:0,revertLane:0,gesture:null,action:_e.action,hasEagerState:_e.hasEagerState,eagerState:_e.eagerState,next:null}),Ue===Di&&(Ne=!0);else if((Ra&we)===we){_e=_e.next,we===Di&&(Ne=!0);continue}else Ue={lane:0,revertLane:_e.revertLane,gesture:null,action:_e.action,hasEagerState:_e.hasEagerState,eagerState:_e.eagerState,next:null},re===null?(H=re=Ue,A=g):re=re.next=Ue,bt.lanes|=we,xs|=we;Ue=_e.action,ei&&r(g,Ue),g=_e.hasEagerState?_e.eagerState:r(g,Ue)}else we={lane:Ue,revertLane:_e.revertLane,gesture:_e.gesture,action:_e.action,hasEagerState:_e.hasEagerState,eagerState:_e.eagerState,next:null},re===null?(H=re=we,A=g):re=re.next=we,bt.lanes|=Ue,xs|=Ue;_e=_e.next}while(_e!==null&&_e!==t);if(re===null?A=g:re.next=H,!xr(g,e.memoizedState)&&(Dn=!0,Ne&&(r=Oi,r!==null)))throw r;e.memoizedState=g,e.baseState=A,e.baseQueue=re,o.lastRenderedState=g}return h===null&&(o.lanes=0),[e.memoizedState,o.dispatch]}function Rd(e){var t=En(),r=t.queue;if(r===null)throw Error(i(311));r.lastRenderedReducer=e;var o=r.dispatch,h=r.pending,g=t.memoizedState;if(h!==null){r.pending=null;var A=h=h.next;do g=e(g,A.action),A=A.next;while(A!==h);xr(g,t.memoizedState)||(Dn=!0),t.memoizedState=g,t.baseQueue===null&&(t.baseState=g),r.lastRenderedState=g}return[g,o]}function Hm(e,t,r){var o=bt,h=En(),g=Lt;if(g){if(r===void 0)throw Error(i(407));r=r()}else r=t();var A=!xr((Qt||h).memoizedState,r);if(A&&(h.memoizedState=r,Dn=!0),h=h.queue,Ld(Pm.bind(null,o,h,e),[e]),h.getSnapshot!==t||A||Nn!==null&&Nn.memoizedState.tag&1){if(o.flags|=2048,Li(9,{destroy:void 0},qm.bind(null,o,h,r,t),null),en===null)throw Error(i(349));g||(Ra&127)!==0||Gm(o,t,r)}return r}function Gm(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},t=bt.updateQueue,t===null?(t=cc(),bt.updateQueue=t,t.stores=[e]):(r=t.stores,r===null?t.stores=[e]:r.push(e))}function qm(e,t,r,o){t.value=r,t.getSnapshot=o,$m(t)&&Ym(e)}function Pm(e,t,r){return r(function(){$m(t)&&Ym(e)})}function $m(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!xr(e,r)}catch{return!0}}function Ym(e){var t=$s(e,2);t!==null&&pr(t,e,2)}function Md(e){var t=rr();if(typeof e=="function"){var r=e;if(e=r(),ei){un(!0);try{r()}finally{un(!1)}}}return t.memoizedState=t.baseState=e,t.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ma,lastRenderedState:e},t}function Vm(e,t,r,o){return e.baseState=r,Id(e,Qt,typeof o=="function"?o:Ma)}function J0(e,t,r,o,h){if(mc(e))throw Error(i(485));if(e=t.action,e!==null){var g={payload:h,action:e,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(A){g.listeners.push(A)}};K.T!==null?r(!0):g.isTransition=!1,o(g),r=t.pending,r===null?(g.next=t.pending=g,Km(t,g)):(g.next=r.next,t.pending=r.next=g)}}function Km(e,t){var r=t.action,o=t.payload,h=e.state;if(t.isTransition){var g=K.T,A={};K.T=A;try{var H=r(h,o),re=K.S;re!==null&&re(A,H),Zm(e,t,H)}catch(_e){Ud(e,t,_e)}finally{g!==null&&A.types!==null&&(g.types=A.types),K.T=g}}else try{g=r(h,o),Zm(e,t,g)}catch(_e){Ud(e,t,_e)}}function Zm(e,t,r){r!==null&&typeof r=="object"&&typeof r.then=="function"?r.then(function(o){Qm(e,t,o)},function(o){return Ud(e,t,o)}):Qm(e,t,r)}function Qm(e,t,r){t.status="fulfilled",t.value=r,Jm(t),e.state=r,t=e.pending,t!==null&&(r=t.next,r===t?e.pending=null:(r=r.next,t.next=r,Km(e,r)))}function Ud(e,t,r){var o=e.pending;if(e.pending=null,o!==null){o=o.next;do t.status="rejected",t.reason=r,Jm(t),t=t.next;while(t!==o)}e.action=null}function Jm(e){e=e.listeners;for(var t=0;t<e.length;t++)(0,e[t])()}function Xm(e,t){return t}function Wm(e,t){if(Lt){var r=en.formState;if(r!==null){e:{var o=bt;if(Lt){if(ln){t:{for(var h=ln,g=qr;h.nodeType!==8;){if(!g){h=null;break t}if(h=$r(h.nextSibling),h===null){h=null;break t}}g=h.data,h=g==="F!"||g==="F"?h:null}if(h){ln=$r(h.nextSibling),o=h.data==="F!";break e}}ds(o)}o=!1}o&&(t=r[0])}}return r=rr(),r.memoizedState=r.baseState=t,o={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Xm,lastRenderedState:t},r.queue=o,r=vp.bind(null,bt,o),o.dispatch=r,o=Md(!1),g=Gd.bind(null,bt,!1,o.queue),o=rr(),h={state:t,dispatch:null,action:e,pending:null},o.queue=h,r=J0.bind(null,bt,h,g,r),h.dispatch=r,o.memoizedState=e,[t,r,!1]}function ep(e){var t=En();return tp(t,Qt,e)}function tp(e,t,r){if(t=Id(e,t,Xm)[0],e=dc(Ma)[0],typeof t=="object"&&t!==null&&typeof t.then=="function")try{var o=Mo(t)}catch(A){throw A===ji?tc:A}else o=t;t=En();var h=t.queue,g=h.dispatch;return r!==t.memoizedState&&(bt.flags|=2048,Li(9,{destroy:void 0},X0.bind(null,h,r),null)),[o,g,e]}function X0(e,t){e.action=t}function np(e){var t=En(),r=Qt;if(r!==null)return tp(t,r,e);En(),t=t.memoizedState,r=En();var o=r.queue.dispatch;return r.memoizedState=e,[t,o,!1]}function Li(e,t,r,o){return e={tag:e,create:r,deps:o,inst:t,next:null},t=bt.updateQueue,t===null&&(t=cc(),bt.updateQueue=t),r=t.lastEffect,r===null?t.lastEffect=e.next=e:(o=r.next,r.next=e,e.next=o,t.lastEffect=e),e}function rp(){return En().memoizedState}function fc(e,t,r,o){var h=rr();bt.flags|=e,h.memoizedState=Li(1|t,{destroy:void 0},r,o===void 0?null:o)}function hc(e,t,r,o){var h=En();o=o===void 0?null:o;var g=h.memoizedState.inst;Qt!==null&&o!==null&&kd(o,Qt.memoizedState.deps)?h.memoizedState=Li(t,g,r,o):(bt.flags|=e,h.memoizedState=Li(1|t,g,r,o))}function ap(e,t){fc(8390656,8,e,t)}function Ld(e,t){hc(2048,8,e,t)}function W0(e){bt.flags|=4;var t=bt.updateQueue;if(t===null)t=cc(),bt.updateQueue=t,t.events=[e];else{var r=t.events;r===null?t.events=[e]:r.push(e)}}function sp(e){var t=En().memoizedState;return W0({ref:t,nextImpl:e}),function(){if((Pt&2)!==0)throw Error(i(440));return t.impl.apply(void 0,arguments)}}function ip(e,t){return hc(4,2,e,t)}function op(e,t){return hc(4,4,e,t)}function lp(e,t){if(typeof t=="function"){e=e();var r=t(e);return function(){typeof r=="function"?r():t(null)}}if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function cp(e,t,r){r=r!=null?r.concat([e]):null,hc(4,4,lp.bind(null,t,e),r)}function zd(){}function up(e,t){var r=En();t=t===void 0?null:t;var o=r.memoizedState;return t!==null&&kd(t,o[1])?o[0]:(r.memoizedState=[e,t],e)}function dp(e,t){var r=En();t=t===void 0?null:t;var o=r.memoizedState;if(t!==null&&kd(t,o[1]))return o[0];if(o=e(),ei){un(!0);try{e()}finally{un(!1)}}return r.memoizedState=[o,t],o}function Fd(e,t,r){return r===void 0||(Ra&1073741824)!==0&&(It&261930)===0?e.memoizedState=t:(e.memoizedState=r,e=fg(),bt.lanes|=e,xs|=e,r)}function fp(e,t,r,o){return xr(r,t)?r:Ri.current!==null?(e=Fd(e,r,o),xr(e,t)||(Dn=!0),e):(Ra&42)===0||(Ra&1073741824)!==0&&(It&261930)===0?(Dn=!0,e.memoizedState=r):(e=fg(),bt.lanes|=e,xs|=e,t)}function hp(e,t,r,o,h){var g=P.p;P.p=g!==0&&8>g?g:8;var A=K.T,H={};K.T=H,Gd(e,!1,t,r);try{var re=h(),_e=K.S;if(_e!==null&&_e(H,re),re!==null&&typeof re=="object"&&typeof re.then=="function"){var Ne=K0(re,o);Uo(e,t,Ne,Ar(e))}else Uo(e,t,o,Ar(e))}catch(Ue){Uo(e,t,{then:function(){},status:"rejected",reason:Ue},Ar())}finally{P.p=g,A!==null&&H.types!==null&&(A.types=H.types),K.T=A}}function ex(){}function Bd(e,t,r,o){if(e.tag!==5)throw Error(i(476));var h=mp(e).queue;hp(e,h,t,ve,r===null?ex:function(){return pp(e),r(o)})}function mp(e){var t=e.memoizedState;if(t!==null)return t;t={memoizedState:ve,baseState:ve,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ma,lastRenderedState:ve},next:null};var r={};return t.next={memoizedState:r,baseState:r,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ma,lastRenderedState:r},next:null},e.memoizedState=t,e=e.alternate,e!==null&&(e.memoizedState=t),t}function pp(e){var t=mp(e);t.next===null&&(t=e.alternate.memoizedState),Uo(e,t.next.queue,{},Ar())}function Hd(){return Pn(Wo)}function gp(){return En().memoizedState}function yp(){return En().memoizedState}function tx(e){for(var t=e.return;t!==null;){switch(t.tag){case 24:case 3:var r=Ar();e=ms(r);var o=ps(t,e,r);o!==null&&(pr(o,t,r),Oo(o,t,r)),t={cache:gd()},e.payload=t;return}t=t.return}}function nx(e,t,r){var o=Ar();r={lane:o,revertLane:0,gesture:null,action:r,hasEagerState:!1,eagerState:null,next:null},mc(e)?bp(t,r):(r=sd(e,t,r,o),r!==null&&(pr(r,e,o),xp(r,t,o)))}function vp(e,t,r){var o=Ar();Uo(e,t,r,o)}function Uo(e,t,r,o){var h={lane:o,revertLane:0,gesture:null,action:r,hasEagerState:!1,eagerState:null,next:null};if(mc(e))bp(t,h);else{var g=e.alternate;if(e.lanes===0&&(g===null||g.lanes===0)&&(g=t.lastRenderedReducer,g!==null))try{var A=t.lastRenderedState,H=g(A,r);if(h.hasEagerState=!0,h.eagerState=H,xr(H,A))return Kl(e,t,h,0),en===null&&Vl(),!1}catch{}finally{}if(r=sd(e,t,h,o),r!==null)return pr(r,e,o),xp(r,t,o),!0}return!1}function Gd(e,t,r,o){if(o={lane:2,revertLane:_f(),gesture:null,action:o,hasEagerState:!1,eagerState:null,next:null},mc(e)){if(t)throw Error(i(479))}else t=sd(e,r,o,2),t!==null&&pr(t,e,2)}function mc(e){var t=e.alternate;return e===bt||t!==null&&t===bt}function bp(e,t){Mi=oc=!0;var r=e.pending;r===null?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function xp(e,t,r){if((r&4194048)!==0){var o=t.lanes;o&=e.pendingLanes,r|=o,t.lanes=r,Ir(e,r)}}var Lo={readContext:Pn,use:uc,useCallback:bn,useContext:bn,useEffect:bn,useImperativeHandle:bn,useLayoutEffect:bn,useInsertionEffect:bn,useMemo:bn,useReducer:bn,useRef:bn,useState:bn,useDebugValue:bn,useDeferredValue:bn,useTransition:bn,useSyncExternalStore:bn,useId:bn,useHostTransitionStatus:bn,useFormState:bn,useActionState:bn,useOptimistic:bn,useMemoCache:bn,useCacheRefresh:bn};Lo.useEffectEvent=bn;var _p={readContext:Pn,use:uc,useCallback:function(e,t){return rr().memoizedState=[e,t===void 0?null:t],e},useContext:Pn,useEffect:ap,useImperativeHandle:function(e,t,r){r=r!=null?r.concat([e]):null,fc(4194308,4,lp.bind(null,t,e),r)},useLayoutEffect:function(e,t){return fc(4194308,4,e,t)},useInsertionEffect:function(e,t){fc(4,2,e,t)},useMemo:function(e,t){var r=rr();t=t===void 0?null:t;var o=e();if(ei){un(!0);try{e()}finally{un(!1)}}return r.memoizedState=[o,t],o},useReducer:function(e,t,r){var o=rr();if(r!==void 0){var h=r(t);if(ei){un(!0);try{r(t)}finally{un(!1)}}}else h=t;return o.memoizedState=o.baseState=h,e={pending:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:h},o.queue=e,e=e.dispatch=nx.bind(null,bt,e),[o.memoizedState,e]},useRef:function(e){var t=rr();return e={current:e},t.memoizedState=e},useState:function(e){e=Md(e);var t=e.queue,r=vp.bind(null,bt,t);return t.dispatch=r,[e.memoizedState,r]},useDebugValue:zd,useDeferredValue:function(e,t){var r=rr();return Fd(r,e,t)},useTransition:function(){var e=Md(!1);return e=hp.bind(null,bt,e.queue,!0,!1),rr().memoizedState=e,[!1,e]},useSyncExternalStore:function(e,t,r){var o=bt,h=rr();if(Lt){if(r===void 0)throw Error(i(407));r=r()}else{if(r=t(),en===null)throw Error(i(349));(It&127)!==0||Gm(o,t,r)}h.memoizedState=r;var g={value:r,getSnapshot:t};return h.queue=g,ap(Pm.bind(null,o,g,e),[e]),o.flags|=2048,Li(9,{destroy:void 0},qm.bind(null,o,g,r,t),null),r},useId:function(){var e=rr(),t=en.identifierPrefix;if(Lt){var r=ha,o=fa;r=(o&~(1<<32-Mt(o)-1)).toString(32)+r,t="_"+t+"R_"+r,r=lc++,0<r&&(t+="H"+r.toString(32)),t+="_"}else r=Z0++,t="_"+t+"r_"+r.toString(32)+"_";return e.memoizedState=t},useHostTransitionStatus:Hd,useFormState:Wm,useActionState:Wm,useOptimistic:function(e){var t=rr();t.memoizedState=t.baseState=e;var r={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return t.queue=r,t=Gd.bind(null,bt,!0,r),r.dispatch=t,[e,t]},useMemoCache:jd,useCacheRefresh:function(){return rr().memoizedState=tx.bind(null,bt)},useEffectEvent:function(e){var t=rr(),r={impl:e};return t.memoizedState=r,function(){if((Pt&2)!==0)throw Error(i(440));return r.impl.apply(void 0,arguments)}}},qd={readContext:Pn,use:uc,useCallback:up,useContext:Pn,useEffect:Ld,useImperativeHandle:cp,useInsertionEffect:ip,useLayoutEffect:op,useMemo:dp,useReducer:dc,useRef:rp,useState:function(){return dc(Ma)},useDebugValue:zd,useDeferredValue:function(e,t){var r=En();return fp(r,Qt.memoizedState,e,t)},useTransition:function(){var e=dc(Ma)[0],t=En().memoizedState;return[typeof e=="boolean"?e:Mo(e),t]},useSyncExternalStore:Hm,useId:gp,useHostTransitionStatus:Hd,useFormState:ep,useActionState:ep,useOptimistic:function(e,t){var r=En();return Vm(r,Qt,e,t)},useMemoCache:jd,useCacheRefresh:yp};qd.useEffectEvent=sp;var Sp={readContext:Pn,use:uc,useCallback:up,useContext:Pn,useEffect:Ld,useImperativeHandle:cp,useInsertionEffect:ip,useLayoutEffect:op,useMemo:dp,useReducer:Rd,useRef:rp,useState:function(){return Rd(Ma)},useDebugValue:zd,useDeferredValue:function(e,t){var r=En();return Qt===null?Fd(r,e,t):fp(r,Qt.memoizedState,e,t)},useTransition:function(){var e=Rd(Ma)[0],t=En().memoizedState;return[typeof e=="boolean"?e:Mo(e),t]},useSyncExternalStore:Hm,useId:gp,useHostTransitionStatus:Hd,useFormState:np,useActionState:np,useOptimistic:function(e,t){var r=En();return Qt!==null?Vm(r,Qt,e,t):(r.baseState=e,[e,r.queue.dispatch])},useMemoCache:jd,useCacheRefresh:yp};Sp.useEffectEvent=sp;function Pd(e,t,r,o){t=e.memoizedState,r=r(o,t),r=r==null?t:_({},t,r),e.memoizedState=r,e.lanes===0&&(e.updateQueue.baseState=r)}var $d={enqueueSetState:function(e,t,r){e=e._reactInternals;var o=Ar(),h=ms(o);h.payload=t,r!=null&&(h.callback=r),t=ps(e,h,o),t!==null&&(pr(t,e,o),Oo(t,e,o))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var o=Ar(),h=ms(o);h.tag=1,h.payload=t,r!=null&&(h.callback=r),t=ps(e,h,o),t!==null&&(pr(t,e,o),Oo(t,e,o))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=Ar(),o=ms(r);o.tag=2,t!=null&&(o.callback=t),t=ps(e,o,r),t!==null&&(pr(t,e,r),Oo(t,e,r))}};function wp(e,t,r,o,h,g,A){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(o,g,A):t.prototype&&t.prototype.isPureReactComponent?!wo(r,o)||!wo(h,g):!0}function Ep(e,t,r,o){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(r,o),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(r,o),t.state!==e&&$d.enqueueReplaceState(t,t.state,null)}function ti(e,t){var r=t;if("ref"in t){r={};for(var o in t)o!=="ref"&&(r[o]=t[o])}if(e=e.defaultProps){r===t&&(r=_({},r));for(var h in e)r[h]===void 0&&(r[h]=e[h])}return r}function Tp(e){Yl(e)}function Ap(e){console.error(e)}function kp(e){Yl(e)}function pc(e,t){try{var r=e.onUncaughtError;r(t.value,{componentStack:t.stack})}catch(o){setTimeout(function(){throw o})}}function Cp(e,t,r){try{var o=e.onCaughtError;o(r.value,{componentStack:r.stack,errorBoundary:t.tag===1?t.stateNode:null})}catch(h){setTimeout(function(){throw h})}}function Yd(e,t,r){return r=ms(r),r.tag=3,r.payload={element:null},r.callback=function(){pc(e,t)},r}function Np(e){return e=ms(e),e.tag=3,e}function Dp(e,t,r,o){var h=r.type.getDerivedStateFromError;if(typeof h=="function"){var g=o.value;e.payload=function(){return h(g)},e.callback=function(){Cp(t,r,o)}}var A=r.stateNode;A!==null&&typeof A.componentDidCatch=="function"&&(e.callback=function(){Cp(t,r,o),typeof h!="function"&&(_s===null?_s=new Set([this]):_s.add(this));var H=o.stack;this.componentDidCatch(o.value,{componentStack:H!==null?H:""})})}function rx(e,t,r,o,h){if(r.flags|=32768,o!==null&&typeof o=="object"&&typeof o.then=="function"){if(t=r.alternate,t!==null&&Ni(t,r,h,!0),r=Sr.current,r!==null){switch(r.tag){case 31:case 13:return Pr===null?kc():r.alternate===null&&xn===0&&(xn=3),r.flags&=-257,r.flags|=65536,r.lanes=h,o===nc?r.flags|=16384:(t=r.updateQueue,t===null?r.updateQueue=new Set([o]):t.add(o),vf(e,o,h)),!1;case 22:return r.flags|=65536,o===nc?r.flags|=16384:(t=r.updateQueue,t===null?(t={transitions:null,markerInstances:null,retryQueue:new Set([o])},r.updateQueue=t):(r=t.retryQueue,r===null?t.retryQueue=new Set([o]):r.add(o)),vf(e,o,h)),!1}throw Error(i(435,r.tag))}return vf(e,o,h),kc(),!1}if(Lt)return t=Sr.current,t!==null?((t.flags&65536)===0&&(t.flags|=256),t.flags|=65536,t.lanes=h,o!==dd&&(e=Error(i(422),{cause:o}),Ao(Br(e,r)))):(o!==dd&&(t=Error(i(423),{cause:o}),Ao(Br(t,r))),e=e.current.alternate,e.flags|=65536,h&=-h,e.lanes|=h,o=Br(o,r),h=Yd(e.stateNode,o,h),Sd(e,h),xn!==4&&(xn=2)),!1;var g=Error(i(520),{cause:o});if(g=Br(g,r),$o===null?$o=[g]:$o.push(g),xn!==4&&(xn=2),t===null)return!0;o=Br(o,r),r=t;do{switch(r.tag){case 3:return r.flags|=65536,e=h&-h,r.lanes|=e,e=Yd(r.stateNode,o,e),Sd(r,e),!1;case 1:if(t=r.type,g=r.stateNode,(r.flags&128)===0&&(typeof t.getDerivedStateFromError=="function"||g!==null&&typeof g.componentDidCatch=="function"&&(_s===null||!_s.has(g))))return r.flags|=65536,h&=-h,r.lanes|=h,h=Np(h),Dp(h,e,r,o),Sd(r,h),!1}r=r.return}while(r!==null);return!1}var Vd=Error(i(461)),Dn=!1;function $n(e,t,r,o){t.child=e===null?Rm(t,null,r,o):Ws(t,e.child,r,o)}function Op(e,t,r,o,h){r=r.render;var g=t.ref;if("ref"in o){var A={};for(var H in o)H!=="ref"&&(A[H]=o[H])}else A=o;return Zs(t),o=Cd(e,t,r,A,g,h),H=Nd(),e!==null&&!Dn?(Dd(e,t,h),Ua(e,t,h)):(Lt&&H&&cd(t),t.flags|=1,$n(e,t,o,h),t.child)}function jp(e,t,r,o,h){if(e===null){var g=r.type;return typeof g=="function"&&!id(g)&&g.defaultProps===void 0&&r.compare===null?(t.tag=15,t.type=g,Ip(e,t,g,o,h)):(e=Ql(r.type,null,o,t,t.mode,h),e.ref=t.ref,e.return=t,t.child=e)}if(g=e.child,!tf(e,h)){var A=g.memoizedProps;if(r=r.compare,r=r!==null?r:wo,r(A,o)&&e.ref===t.ref)return Ua(e,t,h)}return t.flags|=1,e=Da(g,o),e.ref=t.ref,e.return=t,t.child=e}function Ip(e,t,r,o,h){if(e!==null){var g=e.memoizedProps;if(wo(g,o)&&e.ref===t.ref)if(Dn=!1,t.pendingProps=o=g,tf(e,h))(e.flags&131072)!==0&&(Dn=!0);else return t.lanes=e.lanes,Ua(e,t,h)}return Kd(e,t,r,o,h)}function Rp(e,t,r,o){var h=o.children,g=e!==null?e.memoizedState:null;if(e===null&&t.stateNode===null&&(t.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),o.mode==="hidden"){if((t.flags&128)!==0){if(g=g!==null?g.baseLanes|r:r,e!==null){for(o=t.child=e.child,h=0;o!==null;)h=h|o.lanes|o.childLanes,o=o.sibling;o=h&~g}else o=0,t.child=null;return Mp(e,t,g,r,o)}if((r&536870912)!==0)t.memoizedState={baseLanes:0,cachePool:null},e!==null&&ec(t,g!==null?g.cachePool:null),g!==null?Lm(t,g):Ed(),zm(t);else return o=t.lanes=536870912,Mp(e,t,g!==null?g.baseLanes|r:r,r,o)}else g!==null?(ec(t,g.cachePool),Lm(t,g),ys(),t.memoizedState=null):(e!==null&&ec(t,null),Ed(),ys());return $n(e,t,h,r),t.child}function zo(e,t){return e!==null&&e.tag===22||t.stateNode!==null||(t.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),t.sibling}function Mp(e,t,r,o,h){var g=vd();return g=g===null?null:{parent:Cn._currentValue,pool:g},t.memoizedState={baseLanes:r,cachePool:g},e!==null&&ec(t,null),Ed(),zm(t),e!==null&&Ni(e,t,o,!0),t.childLanes=h,null}function gc(e,t){return t=vc({mode:t.mode,children:t.children},e.mode),t.ref=e.ref,e.child=t,t.return=e,t}function Up(e,t,r){return Ws(t,e.child,null,r),e=gc(t,t.pendingProps),e.flags|=2,wr(t),t.memoizedState=null,e}function ax(e,t,r){var o=t.pendingProps,h=(t.flags&128)!==0;if(t.flags&=-129,e===null){if(Lt){if(o.mode==="hidden")return e=gc(t,o),t.lanes=536870912,zo(null,e);if(Ad(t),(e=ln)?(e=Kg(e,qr),e=e!==null&&e.data==="&"?e:null,e!==null&&(t.memoizedState={dehydrated:e,treeContext:cs!==null?{id:fa,overflow:ha}:null,retryLane:536870912,hydrationErrors:null},r=bm(e),r.return=t,t.child=r,qn=t,ln=null)):e=null,e===null)throw ds(t);return t.lanes=536870912,null}return gc(t,o)}var g=e.memoizedState;if(g!==null){var A=g.dehydrated;if(Ad(t),h)if(t.flags&256)t.flags&=-257,t=Up(e,t,r);else if(t.memoizedState!==null)t.child=e.child,t.flags|=128,t=null;else throw Error(i(558));else if(Dn||Ni(e,t,r,!1),h=(r&e.childLanes)!==0,Dn||h){if(o=en,o!==null&&(A=Fn(o,r),A!==0&&A!==g.retryLane))throw g.retryLane=A,$s(e,A),pr(o,e,A),Vd;kc(),t=Up(e,t,r)}else e=g.treeContext,ln=$r(A.nextSibling),qn=t,Lt=!0,us=null,qr=!1,e!==null&&Sm(t,e),t=gc(t,o),t.flags|=4096;return t}return e=Da(e.child,{mode:o.mode,children:o.children}),e.ref=t.ref,t.child=e,e.return=t,e}function yc(e,t){var r=t.ref;if(r===null)e!==null&&e.ref!==null&&(t.flags|=4194816);else{if(typeof r!="function"&&typeof r!="object")throw Error(i(284));(e===null||e.ref!==r)&&(t.flags|=4194816)}}function Kd(e,t,r,o,h){return Zs(t),r=Cd(e,t,r,o,void 0,h),o=Nd(),e!==null&&!Dn?(Dd(e,t,h),Ua(e,t,h)):(Lt&&o&&cd(t),t.flags|=1,$n(e,t,r,h),t.child)}function Lp(e,t,r,o,h,g){return Zs(t),t.updateQueue=null,r=Bm(t,o,r,h),Fm(e),o=Nd(),e!==null&&!Dn?(Dd(e,t,g),Ua(e,t,g)):(Lt&&o&&cd(t),t.flags|=1,$n(e,t,r,g),t.child)}function zp(e,t,r,o,h){if(Zs(t),t.stateNode===null){var g=Ti,A=r.contextType;typeof A=="object"&&A!==null&&(g=Pn(A)),g=new r(o,g),t.memoizedState=g.state!==null&&g.state!==void 0?g.state:null,g.updater=$d,t.stateNode=g,g._reactInternals=t,g=t.stateNode,g.props=o,g.state=t.memoizedState,g.refs={},xd(t),A=r.contextType,g.context=typeof A=="object"&&A!==null?Pn(A):Ti,g.state=t.memoizedState,A=r.getDerivedStateFromProps,typeof A=="function"&&(Pd(t,r,A,o),g.state=t.memoizedState),typeof r.getDerivedStateFromProps=="function"||typeof g.getSnapshotBeforeUpdate=="function"||typeof g.UNSAFE_componentWillMount!="function"&&typeof g.componentWillMount!="function"||(A=g.state,typeof g.componentWillMount=="function"&&g.componentWillMount(),typeof g.UNSAFE_componentWillMount=="function"&&g.UNSAFE_componentWillMount(),A!==g.state&&$d.enqueueReplaceState(g,g.state,null),Io(t,o,g,h),jo(),g.state=t.memoizedState),typeof g.componentDidMount=="function"&&(t.flags|=4194308),o=!0}else if(e===null){g=t.stateNode;var H=t.memoizedProps,re=ti(r,H);g.props=re;var _e=g.context,Ne=r.contextType;A=Ti,typeof Ne=="object"&&Ne!==null&&(A=Pn(Ne));var Ue=r.getDerivedStateFromProps;Ne=typeof Ue=="function"||typeof g.getSnapshotBeforeUpdate=="function",H=t.pendingProps!==H,Ne||typeof g.UNSAFE_componentWillReceiveProps!="function"&&typeof g.componentWillReceiveProps!="function"||(H||_e!==A)&&Ep(t,g,o,A),hs=!1;var we=t.memoizedState;g.state=we,Io(t,o,g,h),jo(),_e=t.memoizedState,H||we!==_e||hs?(typeof Ue=="function"&&(Pd(t,r,Ue,o),_e=t.memoizedState),(re=hs||wp(t,r,re,o,we,_e,A))?(Ne||typeof g.UNSAFE_componentWillMount!="function"&&typeof g.componentWillMount!="function"||(typeof g.componentWillMount=="function"&&g.componentWillMount(),typeof g.UNSAFE_componentWillMount=="function"&&g.UNSAFE_componentWillMount()),typeof g.componentDidMount=="function"&&(t.flags|=4194308)):(typeof g.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=o,t.memoizedState=_e),g.props=o,g.state=_e,g.context=A,o=re):(typeof g.componentDidMount=="function"&&(t.flags|=4194308),o=!1)}else{g=t.stateNode,_d(e,t),A=t.memoizedProps,Ne=ti(r,A),g.props=Ne,Ue=t.pendingProps,we=g.context,_e=r.contextType,re=Ti,typeof _e=="object"&&_e!==null&&(re=Pn(_e)),H=r.getDerivedStateFromProps,(_e=typeof H=="function"||typeof g.getSnapshotBeforeUpdate=="function")||typeof g.UNSAFE_componentWillReceiveProps!="function"&&typeof g.componentWillReceiveProps!="function"||(A!==Ue||we!==re)&&Ep(t,g,o,re),hs=!1,we=t.memoizedState,g.state=we,Io(t,o,g,h),jo();var Ae=t.memoizedState;A!==Ue||we!==Ae||hs||e!==null&&e.dependencies!==null&&Xl(e.dependencies)?(typeof H=="function"&&(Pd(t,r,H,o),Ae=t.memoizedState),(Ne=hs||wp(t,r,Ne,o,we,Ae,re)||e!==null&&e.dependencies!==null&&Xl(e.dependencies))?(_e||typeof g.UNSAFE_componentWillUpdate!="function"&&typeof g.componentWillUpdate!="function"||(typeof g.componentWillUpdate=="function"&&g.componentWillUpdate(o,Ae,re),typeof g.UNSAFE_componentWillUpdate=="function"&&g.UNSAFE_componentWillUpdate(o,Ae,re)),typeof g.componentDidUpdate=="function"&&(t.flags|=4),typeof g.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof g.componentDidUpdate!="function"||A===e.memoizedProps&&we===e.memoizedState||(t.flags|=4),typeof g.getSnapshotBeforeUpdate!="function"||A===e.memoizedProps&&we===e.memoizedState||(t.flags|=1024),t.memoizedProps=o,t.memoizedState=Ae),g.props=o,g.state=Ae,g.context=re,o=Ne):(typeof g.componentDidUpdate!="function"||A===e.memoizedProps&&we===e.memoizedState||(t.flags|=4),typeof g.getSnapshotBeforeUpdate!="function"||A===e.memoizedProps&&we===e.memoizedState||(t.flags|=1024),o=!1)}return g=o,yc(e,t),o=(t.flags&128)!==0,g||o?(g=t.stateNode,r=o&&typeof r.getDerivedStateFromError!="function"?null:g.render(),t.flags|=1,e!==null&&o?(t.child=Ws(t,e.child,null,h),t.child=Ws(t,null,r,h)):$n(e,t,r,h),t.memoizedState=g.state,e=t.child):e=Ua(e,t,h),e}function Fp(e,t,r,o){return Vs(),t.flags|=256,$n(e,t,r,o),t.child}var Zd={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Qd(e){return{baseLanes:e,cachePool:Cm()}}function Jd(e,t,r){return e=e!==null?e.childLanes&~r:0,t&&(e|=Tr),e}function Bp(e,t,r){var o=t.pendingProps,h=!1,g=(t.flags&128)!==0,A;if((A=g)||(A=e!==null&&e.memoizedState===null?!1:(wn.current&2)!==0),A&&(h=!0,t.flags&=-129),A=(t.flags&32)!==0,t.flags&=-33,e===null){if(Lt){if(h?gs(t):ys(),(e=ln)?(e=Kg(e,qr),e=e!==null&&e.data!=="&"?e:null,e!==null&&(t.memoizedState={dehydrated:e,treeContext:cs!==null?{id:fa,overflow:ha}:null,retryLane:536870912,hydrationErrors:null},r=bm(e),r.return=t,t.child=r,qn=t,ln=null)):e=null,e===null)throw ds(t);return Rf(e)?t.lanes=32:t.lanes=536870912,null}var H=o.children;return o=o.fallback,h?(ys(),h=t.mode,H=vc({mode:"hidden",children:H},h),o=Ys(o,h,r,null),H.return=t,o.return=t,H.sibling=o,t.child=H,o=t.child,o.memoizedState=Qd(r),o.childLanes=Jd(e,A,r),t.memoizedState=Zd,zo(null,o)):(gs(t),Xd(t,H))}var re=e.memoizedState;if(re!==null&&(H=re.dehydrated,H!==null)){if(g)t.flags&256?(gs(t),t.flags&=-257,t=Wd(e,t,r)):t.memoizedState!==null?(ys(),t.child=e.child,t.flags|=128,t=null):(ys(),H=o.fallback,h=t.mode,o=vc({mode:"visible",children:o.children},h),H=Ys(H,h,r,null),H.flags|=2,o.return=t,H.return=t,o.sibling=H,t.child=o,Ws(t,e.child,null,r),o=t.child,o.memoizedState=Qd(r),o.childLanes=Jd(e,A,r),t.memoizedState=Zd,t=zo(null,o));else if(gs(t),Rf(H)){if(A=H.nextSibling&&H.nextSibling.dataset,A)var _e=A.dgst;A=_e,o=Error(i(419)),o.stack="",o.digest=A,Ao({value:o,source:null,stack:null}),t=Wd(e,t,r)}else if(Dn||Ni(e,t,r,!1),A=(r&e.childLanes)!==0,Dn||A){if(A=en,A!==null&&(o=Fn(A,r),o!==0&&o!==re.retryLane))throw re.retryLane=o,$s(e,o),pr(A,e,o),Vd;If(H)||kc(),t=Wd(e,t,r)}else If(H)?(t.flags|=192,t.child=e.child,t=null):(e=re.treeContext,ln=$r(H.nextSibling),qn=t,Lt=!0,us=null,qr=!1,e!==null&&Sm(t,e),t=Xd(t,o.children),t.flags|=4096);return t}return h?(ys(),H=o.fallback,h=t.mode,re=e.child,_e=re.sibling,o=Da(re,{mode:"hidden",children:o.children}),o.subtreeFlags=re.subtreeFlags&65011712,_e!==null?H=Da(_e,H):(H=Ys(H,h,r,null),H.flags|=2),H.return=t,o.return=t,o.sibling=H,t.child=o,zo(null,o),o=t.child,H=e.child.memoizedState,H===null?H=Qd(r):(h=H.cachePool,h!==null?(re=Cn._currentValue,h=h.parent!==re?{parent:re,pool:re}:h):h=Cm(),H={baseLanes:H.baseLanes|r,cachePool:h}),o.memoizedState=H,o.childLanes=Jd(e,A,r),t.memoizedState=Zd,zo(e.child,o)):(gs(t),r=e.child,e=r.sibling,r=Da(r,{mode:"visible",children:o.children}),r.return=t,r.sibling=null,e!==null&&(A=t.deletions,A===null?(t.deletions=[e],t.flags|=16):A.push(e)),t.child=r,t.memoizedState=null,r)}function Xd(e,t){return t=vc({mode:"visible",children:t},e.mode),t.return=e,e.child=t}function vc(e,t){return e=_r(22,e,null,t),e.lanes=0,e}function Wd(e,t,r){return Ws(t,e.child,null,r),e=Xd(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function Hp(e,t,r){e.lanes|=t;var o=e.alternate;o!==null&&(o.lanes|=t),md(e.return,t,r)}function ef(e,t,r,o,h,g){var A=e.memoizedState;A===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:o,tail:r,tailMode:h,treeForkCount:g}:(A.isBackwards=t,A.rendering=null,A.renderingStartTime=0,A.last=o,A.tail=r,A.tailMode=h,A.treeForkCount=g)}function Gp(e,t,r){var o=t.pendingProps,h=o.revealOrder,g=o.tail;o=o.children;var A=wn.current,H=(A&2)!==0;if(H?(A=A&1|2,t.flags|=128):A&=1,te(wn,A),$n(e,t,o,r),o=Lt?To:0,!H&&e!==null&&(e.flags&128)!==0)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&Hp(e,r,t);else if(e.tag===19)Hp(e,r,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}switch(h){case"forwards":for(r=t.child,h=null;r!==null;)e=r.alternate,e!==null&&ic(e)===null&&(h=r),r=r.sibling;r=h,r===null?(h=t.child,t.child=null):(h=r.sibling,r.sibling=null),ef(t,!1,h,r,g,o);break;case"backwards":case"unstable_legacy-backwards":for(r=null,h=t.child,t.child=null;h!==null;){if(e=h.alternate,e!==null&&ic(e)===null){t.child=h;break}e=h.sibling,h.sibling=r,r=h,h=e}ef(t,!0,r,null,g,o);break;case"together":ef(t,!1,null,null,void 0,o);break;default:t.memoizedState=null}return t.child}function Ua(e,t,r){if(e!==null&&(t.dependencies=e.dependencies),xs|=t.lanes,(r&t.childLanes)===0)if(e!==null){if(Ni(e,t,r,!1),(r&t.childLanes)===0)return null}else return null;if(e!==null&&t.child!==e.child)throw Error(i(153));if(t.child!==null){for(e=t.child,r=Da(e,e.pendingProps),t.child=r,r.return=t;e.sibling!==null;)e=e.sibling,r=r.sibling=Da(e,e.pendingProps),r.return=t;r.sibling=null}return t.child}function tf(e,t){return(e.lanes&t)!==0?!0:(e=e.dependencies,!!(e!==null&&Xl(e)))}function sx(e,t,r){switch(t.tag){case 3:oe(t,t.stateNode.containerInfo),fs(t,Cn,e.memoizedState.cache),Vs();break;case 27:case 5:Le(t);break;case 4:oe(t,t.stateNode.containerInfo);break;case 10:fs(t,t.type,t.memoizedProps.value);break;case 31:if(t.memoizedState!==null)return t.flags|=128,Ad(t),null;break;case 13:var o=t.memoizedState;if(o!==null)return o.dehydrated!==null?(gs(t),t.flags|=128,null):(r&t.child.childLanes)!==0?Bp(e,t,r):(gs(t),e=Ua(e,t,r),e!==null?e.sibling:null);gs(t);break;case 19:var h=(e.flags&128)!==0;if(o=(r&t.childLanes)!==0,o||(Ni(e,t,r,!1),o=(r&t.childLanes)!==0),h){if(o)return Gp(e,t,r);t.flags|=128}if(h=t.memoizedState,h!==null&&(h.rendering=null,h.tail=null,h.lastEffect=null),te(wn,wn.current),o)break;return null;case 22:return t.lanes=0,Rp(e,t,r,t.pendingProps);case 24:fs(t,Cn,e.memoizedState.cache)}return Ua(e,t,r)}function qp(e,t,r){if(e!==null)if(e.memoizedProps!==t.pendingProps)Dn=!0;else{if(!tf(e,r)&&(t.flags&128)===0)return Dn=!1,sx(e,t,r);Dn=(e.flags&131072)!==0}else Dn=!1,Lt&&(t.flags&1048576)!==0&&_m(t,To,t.index);switch(t.lanes=0,t.tag){case 16:e:{var o=t.pendingProps;if(e=Js(t.elementType),t.type=e,typeof e=="function")id(e)?(o=ti(e,o),t.tag=1,t=zp(null,t,e,o,r)):(t.tag=0,t=Kd(null,t,e,o,r));else{if(e!=null){var h=e.$$typeof;if(h===F){t.tag=11,t=Op(null,t,e,o,r);break e}else if(h===U){t.tag=14,t=jp(null,t,e,o,r);break e}}throw t=N(e)||e,Error(i(306,t,""))}}return t;case 0:return Kd(e,t,t.type,t.pendingProps,r);case 1:return o=t.type,h=ti(o,t.pendingProps),zp(e,t,o,h,r);case 3:e:{if(oe(t,t.stateNode.containerInfo),e===null)throw Error(i(387));o=t.pendingProps;var g=t.memoizedState;h=g.element,_d(e,t),Io(t,o,null,r);var A=t.memoizedState;if(o=A.cache,fs(t,Cn,o),o!==g.cache&&pd(t,[Cn],r,!0),jo(),o=A.element,g.isDehydrated)if(g={element:o,isDehydrated:!1,cache:A.cache},t.updateQueue.baseState=g,t.memoizedState=g,t.flags&256){t=Fp(e,t,o,r);break e}else if(o!==h){h=Br(Error(i(424)),t),Ao(h),t=Fp(e,t,o,r);break e}else{switch(e=t.stateNode.containerInfo,e.nodeType){case 9:e=e.body;break;default:e=e.nodeName==="HTML"?e.ownerDocument.body:e}for(ln=$r(e.firstChild),qn=t,Lt=!0,us=null,qr=!0,r=Rm(t,null,o,r),t.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling}else{if(Vs(),o===h){t=Ua(e,t,r);break e}$n(e,t,o,r)}t=t.child}return t;case 26:return yc(e,t),e===null?(r=ey(t.type,null,t.pendingProps,null))?t.memoizedState=r:Lt||(r=t.type,e=t.pendingProps,o=Rc(ue.current).createElement(r),o[Yt]=t,o[Bt]=e,Yn(o,r,e),kt(o),t.stateNode=o):t.memoizedState=ey(t.type,e.memoizedProps,t.pendingProps,e.memoizedState),null;case 27:return Le(t),e===null&&Lt&&(o=t.stateNode=Jg(t.type,t.pendingProps,ue.current),qn=t,qr=!0,h=ln,Ts(t.type)?(Mf=h,ln=$r(o.firstChild)):ln=h),$n(e,t,t.pendingProps.children,r),yc(e,t),e===null&&(t.flags|=4194304),t.child;case 5:return e===null&&Lt&&((h=o=ln)&&(o=Mx(o,t.type,t.pendingProps,qr),o!==null?(t.stateNode=o,qn=t,ln=$r(o.firstChild),qr=!1,h=!0):h=!1),h||ds(t)),Le(t),h=t.type,g=t.pendingProps,A=e!==null?e.memoizedProps:null,o=g.children,Df(h,g)?o=null:A!==null&&Df(h,A)&&(t.flags|=32),t.memoizedState!==null&&(h=Cd(e,t,Q0,null,null,r),Wo._currentValue=h),yc(e,t),$n(e,t,o,r),t.child;case 6:return e===null&&Lt&&((e=r=ln)&&(r=Ux(r,t.pendingProps,qr),r!==null?(t.stateNode=r,qn=t,ln=null,e=!0):e=!1),e||ds(t)),null;case 13:return Bp(e,t,r);case 4:return oe(t,t.stateNode.containerInfo),o=t.pendingProps,e===null?t.child=Ws(t,null,o,r):$n(e,t,o,r),t.child;case 11:return Op(e,t,t.type,t.pendingProps,r);case 7:return $n(e,t,t.pendingProps,r),t.child;case 8:return $n(e,t,t.pendingProps.children,r),t.child;case 12:return $n(e,t,t.pendingProps.children,r),t.child;case 10:return o=t.pendingProps,fs(t,t.type,o.value),$n(e,t,o.children,r),t.child;case 9:return h=t.type._context,o=t.pendingProps.children,Zs(t),h=Pn(h),o=o(h),t.flags|=1,$n(e,t,o,r),t.child;case 14:return jp(e,t,t.type,t.pendingProps,r);case 15:return Ip(e,t,t.type,t.pendingProps,r);case 19:return Gp(e,t,r);case 31:return ax(e,t,r);case 22:return Rp(e,t,r,t.pendingProps);case 24:return Zs(t),o=Pn(Cn),e===null?(h=vd(),h===null&&(h=en,g=gd(),h.pooledCache=g,g.refCount++,g!==null&&(h.pooledCacheLanes|=r),h=g),t.memoizedState={parent:o,cache:h},xd(t),fs(t,Cn,h)):((e.lanes&r)!==0&&(_d(e,t),Io(t,null,null,r),jo()),h=e.memoizedState,g=t.memoizedState,h.parent!==o?(h={parent:o,cache:o},t.memoizedState=h,t.lanes===0&&(t.memoizedState=t.updateQueue.baseState=h),fs(t,Cn,o)):(o=g.cache,fs(t,Cn,o),o!==h.cache&&pd(t,[Cn],r,!0))),$n(e,t,t.pendingProps.children,r),t.child;case 29:throw t.pendingProps}throw Error(i(156,t.tag))}function La(e){e.flags|=4}function nf(e,t,r,o,h){if((t=(e.mode&32)!==0)&&(t=!1),t){if(e.flags|=16777216,(h&335544128)===h)if(e.stateNode.complete)e.flags|=8192;else if(gg())e.flags|=8192;else throw Xs=nc,bd}else e.flags&=-16777217}function Pp(e,t){if(t.type!=="stylesheet"||(t.state.loading&4)!==0)e.flags&=-16777217;else if(e.flags|=16777216,!sy(t))if(gg())e.flags|=8192;else throw Xs=nc,bd}function bc(e,t){t!==null&&(e.flags|=4),e.flags&16384&&(t=e.tag!==22?_a():536870912,e.lanes|=t,Hi|=t)}function Fo(e,t){if(!Lt)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var o=null;r!==null;)r.alternate!==null&&(o=r),r=r.sibling;o===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:o.sibling=null}}function cn(e){var t=e.alternate!==null&&e.alternate.child===e.child,r=0,o=0;if(t)for(var h=e.child;h!==null;)r|=h.lanes|h.childLanes,o|=h.subtreeFlags&65011712,o|=h.flags&65011712,h.return=e,h=h.sibling;else for(h=e.child;h!==null;)r|=h.lanes|h.childLanes,o|=h.subtreeFlags,o|=h.flags,h.return=e,h=h.sibling;return e.subtreeFlags|=o,e.childLanes=r,t}function ix(e,t,r){var o=t.pendingProps;switch(ud(t),t.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return cn(t),null;case 1:return cn(t),null;case 3:return r=t.stateNode,o=null,e!==null&&(o=e.memoizedState.cache),t.memoizedState.cache!==o&&(t.flags|=2048),Ia(Cn),le(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(e===null||e.child===null)&&(Ci(t)?La(t):e===null||e.memoizedState.isDehydrated&&(t.flags&256)===0||(t.flags|=1024,fd())),cn(t),null;case 26:var h=t.type,g=t.memoizedState;return e===null?(La(t),g!==null?(cn(t),Pp(t,g)):(cn(t),nf(t,h,null,o,r))):g?g!==e.memoizedState?(La(t),cn(t),Pp(t,g)):(cn(t),t.flags&=-16777217):(e=e.memoizedProps,e!==o&&La(t),cn(t),nf(t,h,e,o,r)),null;case 27:if(De(t),r=ue.current,h=t.type,e!==null&&t.stateNode!=null)e.memoizedProps!==o&&La(t);else{if(!o){if(t.stateNode===null)throw Error(i(166));return cn(t),null}e=ae.current,Ci(t)?wm(t):(e=Jg(h,o,r),t.stateNode=e,La(t))}return cn(t),null;case 5:if(De(t),h=t.type,e!==null&&t.stateNode!=null)e.memoizedProps!==o&&La(t);else{if(!o){if(t.stateNode===null)throw Error(i(166));return cn(t),null}if(g=ae.current,Ci(t))wm(t);else{var A=Rc(ue.current);switch(g){case 1:g=A.createElementNS("http://www.w3.org/2000/svg",h);break;case 2:g=A.createElementNS("http://www.w3.org/1998/Math/MathML",h);break;default:switch(h){case"svg":g=A.createElementNS("http://www.w3.org/2000/svg",h);break;case"math":g=A.createElementNS("http://www.w3.org/1998/Math/MathML",h);break;case"script":g=A.createElement("div"),g.innerHTML="<script><\/script>",g=g.removeChild(g.firstChild);break;case"select":g=typeof o.is=="string"?A.createElement("select",{is:o.is}):A.createElement("select"),o.multiple?g.multiple=!0:o.size&&(g.size=o.size);break;default:g=typeof o.is=="string"?A.createElement(h,{is:o.is}):A.createElement(h)}}g[Yt]=t,g[Bt]=o;e:for(A=t.child;A!==null;){if(A.tag===5||A.tag===6)g.appendChild(A.stateNode);else if(A.tag!==4&&A.tag!==27&&A.child!==null){A.child.return=A,A=A.child;continue}if(A===t)break e;for(;A.sibling===null;){if(A.return===null||A.return===t)break e;A=A.return}A.sibling.return=A.return,A=A.sibling}t.stateNode=g;e:switch(Yn(g,h,o),h){case"button":case"input":case"select":case"textarea":o=!!o.autoFocus;break e;case"img":o=!0;break e;default:o=!1}o&&La(t)}}return cn(t),nf(t,t.type,e===null?null:e.memoizedProps,t.pendingProps,r),null;case 6:if(e&&t.stateNode!=null)e.memoizedProps!==o&&La(t);else{if(typeof o!="string"&&t.stateNode===null)throw Error(i(166));if(e=ue.current,Ci(t)){if(e=t.stateNode,r=t.memoizedProps,o=null,h=qn,h!==null)switch(h.tag){case 27:case 5:o=h.memoizedProps}e[Yt]=t,e=!!(e.nodeValue===r||o!==null&&o.suppressHydrationWarning===!0||Bg(e.nodeValue,r)),e||ds(t,!0)}else e=Rc(e).createTextNode(o),e[Yt]=t,t.stateNode=e}return cn(t),null;case 31:if(r=t.memoizedState,e===null||e.memoizedState!==null){if(o=Ci(t),r!==null){if(e===null){if(!o)throw Error(i(318));if(e=t.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(i(557));e[Yt]=t}else Vs(),(t.flags&128)===0&&(t.memoizedState=null),t.flags|=4;cn(t),e=!1}else r=fd(),e!==null&&e.memoizedState!==null&&(e.memoizedState.hydrationErrors=r),e=!0;if(!e)return t.flags&256?(wr(t),t):(wr(t),null);if((t.flags&128)!==0)throw Error(i(558))}return cn(t),null;case 13:if(o=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(h=Ci(t),o!==null&&o.dehydrated!==null){if(e===null){if(!h)throw Error(i(318));if(h=t.memoizedState,h=h!==null?h.dehydrated:null,!h)throw Error(i(317));h[Yt]=t}else Vs(),(t.flags&128)===0&&(t.memoizedState=null),t.flags|=4;cn(t),h=!1}else h=fd(),e!==null&&e.memoizedState!==null&&(e.memoizedState.hydrationErrors=h),h=!0;if(!h)return t.flags&256?(wr(t),t):(wr(t),null)}return wr(t),(t.flags&128)!==0?(t.lanes=r,t):(r=o!==null,e=e!==null&&e.memoizedState!==null,r&&(o=t.child,h=null,o.alternate!==null&&o.alternate.memoizedState!==null&&o.alternate.memoizedState.cachePool!==null&&(h=o.alternate.memoizedState.cachePool.pool),g=null,o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(g=o.memoizedState.cachePool.pool),g!==h&&(o.flags|=2048)),r!==e&&r&&(t.child.flags|=8192),bc(t,t.updateQueue),cn(t),null);case 4:return le(),e===null&&Tf(t.stateNode.containerInfo),cn(t),null;case 10:return Ia(t.type),cn(t),null;case 19:if(I(wn),o=t.memoizedState,o===null)return cn(t),null;if(h=(t.flags&128)!==0,g=o.rendering,g===null)if(h)Fo(o,!1);else{if(xn!==0||e!==null&&(e.flags&128)!==0)for(e=t.child;e!==null;){if(g=ic(e),g!==null){for(t.flags|=128,Fo(o,!1),e=g.updateQueue,t.updateQueue=e,bc(t,e),t.subtreeFlags=0,e=r,r=t.child;r!==null;)vm(r,e),r=r.sibling;return te(wn,wn.current&1|2),Lt&&Oa(t,o.treeForkCount),t.child}e=e.sibling}o.tail!==null&&He()>Ec&&(t.flags|=128,h=!0,Fo(o,!1),t.lanes=4194304)}else{if(!h)if(e=ic(g),e!==null){if(t.flags|=128,h=!0,e=e.updateQueue,t.updateQueue=e,bc(t,e),Fo(o,!0),o.tail===null&&o.tailMode==="hidden"&&!g.alternate&&!Lt)return cn(t),null}else 2*He()-o.renderingStartTime>Ec&&r!==536870912&&(t.flags|=128,h=!0,Fo(o,!1),t.lanes=4194304);o.isBackwards?(g.sibling=t.child,t.child=g):(e=o.last,e!==null?e.sibling=g:t.child=g,o.last=g)}return o.tail!==null?(e=o.tail,o.rendering=e,o.tail=e.sibling,o.renderingStartTime=He(),e.sibling=null,r=wn.current,te(wn,h?r&1|2:r&1),Lt&&Oa(t,o.treeForkCount),e):(cn(t),null);case 22:case 23:return wr(t),Td(),o=t.memoizedState!==null,e!==null?e.memoizedState!==null!==o&&(t.flags|=8192):o&&(t.flags|=8192),o?(r&536870912)!==0&&(t.flags&128)===0&&(cn(t),t.subtreeFlags&6&&(t.flags|=8192)):cn(t),r=t.updateQueue,r!==null&&bc(t,r.retryQueue),r=null,e!==null&&e.memoizedState!==null&&e.memoizedState.cachePool!==null&&(r=e.memoizedState.cachePool.pool),o=null,t.memoizedState!==null&&t.memoizedState.cachePool!==null&&(o=t.memoizedState.cachePool.pool),o!==r&&(t.flags|=2048),e!==null&&I(Qs),null;case 24:return r=null,e!==null&&(r=e.memoizedState.cache),t.memoizedState.cache!==r&&(t.flags|=2048),Ia(Cn),cn(t),null;case 25:return null;case 30:return null}throw Error(i(156,t.tag))}function ox(e,t){switch(ud(t),t.tag){case 1:return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return Ia(Cn),le(),e=t.flags,(e&65536)!==0&&(e&128)===0?(t.flags=e&-65537|128,t):null;case 26:case 27:case 5:return De(t),null;case 31:if(t.memoizedState!==null){if(wr(t),t.alternate===null)throw Error(i(340));Vs()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 13:if(wr(t),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(i(340));Vs()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return I(wn),null;case 4:return le(),null;case 10:return Ia(t.type),null;case 22:case 23:return wr(t),Td(),e!==null&&I(Qs),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 24:return Ia(Cn),null;case 25:return null;default:return null}}function $p(e,t){switch(ud(t),t.tag){case 3:Ia(Cn),le();break;case 26:case 27:case 5:De(t);break;case 4:le();break;case 31:t.memoizedState!==null&&wr(t);break;case 13:wr(t);break;case 19:I(wn);break;case 10:Ia(t.type);break;case 22:case 23:wr(t),Td(),e!==null&&I(Qs);break;case 24:Ia(Cn)}}function Bo(e,t){try{var r=t.updateQueue,o=r!==null?r.lastEffect:null;if(o!==null){var h=o.next;r=h;do{if((r.tag&e)===e){o=void 0;var g=r.create,A=r.inst;o=g(),A.destroy=o}r=r.next}while(r!==h)}}catch(H){Kt(t,t.return,H)}}function vs(e,t,r){try{var o=t.updateQueue,h=o!==null?o.lastEffect:null;if(h!==null){var g=h.next;o=g;do{if((o.tag&e)===e){var A=o.inst,H=A.destroy;if(H!==void 0){A.destroy=void 0,h=t;var re=r,_e=H;try{_e()}catch(Ne){Kt(h,re,Ne)}}}o=o.next}while(o!==g)}}catch(Ne){Kt(t,t.return,Ne)}}function Yp(e){var t=e.updateQueue;if(t!==null){var r=e.stateNode;try{Um(t,r)}catch(o){Kt(e,e.return,o)}}}function Vp(e,t,r){r.props=ti(e.type,e.memoizedProps),r.state=e.memoizedState;try{r.componentWillUnmount()}catch(o){Kt(e,t,o)}}function Ho(e,t){try{var r=e.ref;if(r!==null){switch(e.tag){case 26:case 27:case 5:var o=e.stateNode;break;case 30:o=e.stateNode;break;default:o=e.stateNode}typeof r=="function"?e.refCleanup=r(o):r.current=o}}catch(h){Kt(e,t,h)}}function ma(e,t){var r=e.ref,o=e.refCleanup;if(r!==null)if(typeof o=="function")try{o()}catch(h){Kt(e,t,h)}finally{e.refCleanup=null,e=e.alternate,e!=null&&(e.refCleanup=null)}else if(typeof r=="function")try{r(null)}catch(h){Kt(e,t,h)}else r.current=null}function Kp(e){var t=e.type,r=e.memoizedProps,o=e.stateNode;try{e:switch(t){case"button":case"input":case"select":case"textarea":r.autoFocus&&o.focus();break e;case"img":r.src?o.src=r.src:r.srcSet&&(o.srcset=r.srcSet)}}catch(h){Kt(e,e.return,h)}}function rf(e,t,r){try{var o=e.stateNode;Nx(o,e.type,r,t),o[Bt]=t}catch(h){Kt(e,e.return,h)}}function Zp(e){return e.tag===5||e.tag===3||e.tag===26||e.tag===27&&Ts(e.type)||e.tag===4}function af(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||Zp(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.tag===27&&Ts(e.type)||e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function sf(e,t,r){var o=e.tag;if(o===5||o===6)e=e.stateNode,t?(r.nodeType===9?r.body:r.nodeName==="HTML"?r.ownerDocument.body:r).insertBefore(e,t):(t=r.nodeType===9?r.body:r.nodeName==="HTML"?r.ownerDocument.body:r,t.appendChild(e),r=r._reactRootContainer,r!=null||t.onclick!==null||(t.onclick=In));else if(o!==4&&(o===27&&Ts(e.type)&&(r=e.stateNode,t=null),e=e.child,e!==null))for(sf(e,t,r),e=e.sibling;e!==null;)sf(e,t,r),e=e.sibling}function xc(e,t,r){var o=e.tag;if(o===5||o===6)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(o!==4&&(o===27&&Ts(e.type)&&(r=e.stateNode),e=e.child,e!==null))for(xc(e,t,r),e=e.sibling;e!==null;)xc(e,t,r),e=e.sibling}function Qp(e){var t=e.stateNode,r=e.memoizedProps;try{for(var o=e.type,h=t.attributes;h.length;)t.removeAttributeNode(h[0]);Yn(t,o,r),t[Yt]=e,t[Bt]=r}catch(g){Kt(e,e.return,g)}}var za=!1,On=!1,of=!1,Jp=typeof WeakSet=="function"?WeakSet:Set,Ln=null;function lx(e,t){if(e=e.containerInfo,Cf=Hc,e=cm(e),Wu(e)){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{r=(r=e.ownerDocument)&&r.defaultView||window;var o=r.getSelection&&r.getSelection();if(o&&o.rangeCount!==0){r=o.anchorNode;var h=o.anchorOffset,g=o.focusNode;o=o.focusOffset;try{r.nodeType,g.nodeType}catch{r=null;break e}var A=0,H=-1,re=-1,_e=0,Ne=0,Ue=e,we=null;t:for(;;){for(var Ae;Ue!==r||h!==0&&Ue.nodeType!==3||(H=A+h),Ue!==g||o!==0&&Ue.nodeType!==3||(re=A+o),Ue.nodeType===3&&(A+=Ue.nodeValue.length),(Ae=Ue.firstChild)!==null;)we=Ue,Ue=Ae;for(;;){if(Ue===e)break t;if(we===r&&++_e===h&&(H=A),we===g&&++Ne===o&&(re=A),(Ae=Ue.nextSibling)!==null)break;Ue=we,we=Ue.parentNode}Ue=Ae}r=H===-1||re===-1?null:{start:H,end:re}}else r=null}r=r||{start:0,end:0}}else r=null;for(Nf={focusedElem:e,selectionRange:r},Hc=!1,Ln=t;Ln!==null;)if(t=Ln,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,Ln=e;else for(;Ln!==null;){switch(t=Ln,g=t.alternate,e=t.flags,t.tag){case 0:if((e&4)!==0&&(e=t.updateQueue,e=e!==null?e.events:null,e!==null))for(r=0;r<e.length;r++)h=e[r],h.ref.impl=h.nextImpl;break;case 11:case 15:break;case 1:if((e&1024)!==0&&g!==null){e=void 0,r=t,h=g.memoizedProps,g=g.memoizedState,o=r.stateNode;try{var Je=ti(r.type,h);e=o.getSnapshotBeforeUpdate(Je,g),o.__reactInternalSnapshotBeforeUpdate=e}catch(dt){Kt(r,r.return,dt)}}break;case 3:if((e&1024)!==0){if(e=t.stateNode.containerInfo,r=e.nodeType,r===9)jf(e);else if(r===1)switch(e.nodeName){case"HEAD":case"HTML":case"BODY":jf(e);break;default:e.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((e&1024)!==0)throw Error(i(163))}if(e=t.sibling,e!==null){e.return=t.return,Ln=e;break}Ln=t.return}}function Xp(e,t,r){var o=r.flags;switch(r.tag){case 0:case 11:case 15:Ba(e,r),o&4&&Bo(5,r);break;case 1:if(Ba(e,r),o&4)if(e=r.stateNode,t===null)try{e.componentDidMount()}catch(A){Kt(r,r.return,A)}else{var h=ti(r.type,t.memoizedProps);t=t.memoizedState;try{e.componentDidUpdate(h,t,e.__reactInternalSnapshotBeforeUpdate)}catch(A){Kt(r,r.return,A)}}o&64&&Yp(r),o&512&&Ho(r,r.return);break;case 3:if(Ba(e,r),o&64&&(e=r.updateQueue,e!==null)){if(t=null,r.child!==null)switch(r.child.tag){case 27:case 5:t=r.child.stateNode;break;case 1:t=r.child.stateNode}try{Um(e,t)}catch(A){Kt(r,r.return,A)}}break;case 27:t===null&&o&4&&Qp(r);case 26:case 5:Ba(e,r),t===null&&o&4&&Kp(r),o&512&&Ho(r,r.return);break;case 12:Ba(e,r);break;case 31:Ba(e,r),o&4&&tg(e,r);break;case 13:Ba(e,r),o&4&&ng(e,r),o&64&&(e=r.memoizedState,e!==null&&(e=e.dehydrated,e!==null&&(r=yx.bind(null,r),Lx(e,r))));break;case 22:if(o=r.memoizedState!==null||za,!o){t=t!==null&&t.memoizedState!==null||On,h=za;var g=On;za=o,(On=t)&&!g?Ha(e,r,(r.subtreeFlags&8772)!==0):Ba(e,r),za=h,On=g}break;case 30:break;default:Ba(e,r)}}function Wp(e){var t=e.alternate;t!==null&&(e.alternate=null,Wp(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&Be(t)),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}var hn=null,dr=!1;function Fa(e,t,r){for(r=r.child;r!==null;)eg(e,t,r),r=r.sibling}function eg(e,t,r){if(rt&&typeof rt.onCommitFiberUnmount=="function")try{rt.onCommitFiberUnmount(mt,r)}catch{}switch(r.tag){case 26:On||ma(r,t),Fa(e,t,r),r.memoizedState?r.memoizedState.count--:r.stateNode&&(r=r.stateNode,r.parentNode.removeChild(r));break;case 27:On||ma(r,t);var o=hn,h=dr;Ts(r.type)&&(hn=r.stateNode,dr=!1),Fa(e,t,r),Qo(r.stateNode),hn=o,dr=h;break;case 5:On||ma(r,t);case 6:if(o=hn,h=dr,hn=null,Fa(e,t,r),hn=o,dr=h,hn!==null)if(dr)try{(hn.nodeType===9?hn.body:hn.nodeName==="HTML"?hn.ownerDocument.body:hn).removeChild(r.stateNode)}catch(g){Kt(r,t,g)}else try{hn.removeChild(r.stateNode)}catch(g){Kt(r,t,g)}break;case 18:hn!==null&&(dr?(e=hn,Yg(e.nodeType===9?e.body:e.nodeName==="HTML"?e.ownerDocument.body:e,r.stateNode),Zi(e)):Yg(hn,r.stateNode));break;case 4:o=hn,h=dr,hn=r.stateNode.containerInfo,dr=!0,Fa(e,t,r),hn=o,dr=h;break;case 0:case 11:case 14:case 15:vs(2,r,t),On||vs(4,r,t),Fa(e,t,r);break;case 1:On||(ma(r,t),o=r.stateNode,typeof o.componentWillUnmount=="function"&&Vp(r,t,o)),Fa(e,t,r);break;case 21:Fa(e,t,r);break;case 22:On=(o=On)||r.memoizedState!==null,Fa(e,t,r),On=o;break;default:Fa(e,t,r)}}function tg(e,t){if(t.memoizedState===null&&(e=t.alternate,e!==null&&(e=e.memoizedState,e!==null))){e=e.dehydrated;try{Zi(e)}catch(r){Kt(t,t.return,r)}}}function ng(e,t){if(t.memoizedState===null&&(e=t.alternate,e!==null&&(e=e.memoizedState,e!==null&&(e=e.dehydrated,e!==null))))try{Zi(e)}catch(r){Kt(t,t.return,r)}}function cx(e){switch(e.tag){case 31:case 13:case 19:var t=e.stateNode;return t===null&&(t=e.stateNode=new Jp),t;case 22:return e=e.stateNode,t=e._retryCache,t===null&&(t=e._retryCache=new Jp),t;default:throw Error(i(435,e.tag))}}function _c(e,t){var r=cx(e);t.forEach(function(o){if(!r.has(o)){r.add(o);var h=vx.bind(null,e,o);o.then(h,h)}})}function fr(e,t){var r=t.deletions;if(r!==null)for(var o=0;o<r.length;o++){var h=r[o],g=e,A=t,H=A;e:for(;H!==null;){switch(H.tag){case 27:if(Ts(H.type)){hn=H.stateNode,dr=!1;break e}break;case 5:hn=H.stateNode,dr=!1;break e;case 3:case 4:hn=H.stateNode.containerInfo,dr=!0;break e}H=H.return}if(hn===null)throw Error(i(160));eg(g,A,h),hn=null,dr=!1,g=h.alternate,g!==null&&(g.return=null),h.return=null}if(t.subtreeFlags&13886)for(t=t.child;t!==null;)rg(t,e),t=t.sibling}var ea=null;function rg(e,t){var r=e.alternate,o=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:fr(t,e),hr(e),o&4&&(vs(3,e,e.return),Bo(3,e),vs(5,e,e.return));break;case 1:fr(t,e),hr(e),o&512&&(On||r===null||ma(r,r.return)),o&64&&za&&(e=e.updateQueue,e!==null&&(o=e.callbacks,o!==null&&(r=e.shared.hiddenCallbacks,e.shared.hiddenCallbacks=r===null?o:r.concat(o))));break;case 26:var h=ea;if(fr(t,e),hr(e),o&512&&(On||r===null||ma(r,r.return)),o&4){var g=r!==null?r.memoizedState:null;if(o=e.memoizedState,r===null)if(o===null)if(e.stateNode===null){e:{o=e.type,r=e.memoizedProps,h=h.ownerDocument||h;t:switch(o){case"title":g=h.getElementsByTagName("title")[0],(!g||g[fe]||g[Yt]||g.namespaceURI==="http://www.w3.org/2000/svg"||g.hasAttribute("itemprop"))&&(g=h.createElement(o),h.head.insertBefore(g,h.querySelector("head > title"))),Yn(g,o,r),g[Yt]=e,kt(g),o=g;break e;case"link":var A=ry("link","href",h).get(o+(r.href||""));if(A){for(var H=0;H<A.length;H++)if(g=A[H],g.getAttribute("href")===(r.href==null||r.href===""?null:r.href)&&g.getAttribute("rel")===(r.rel==null?null:r.rel)&&g.getAttribute("title")===(r.title==null?null:r.title)&&g.getAttribute("crossorigin")===(r.crossOrigin==null?null:r.crossOrigin)){A.splice(H,1);break t}}g=h.createElement(o),Yn(g,o,r),h.head.appendChild(g);break;case"meta":if(A=ry("meta","content",h).get(o+(r.content||""))){for(H=0;H<A.length;H++)if(g=A[H],g.getAttribute("content")===(r.content==null?null:""+r.content)&&g.getAttribute("name")===(r.name==null?null:r.name)&&g.getAttribute("property")===(r.property==null?null:r.property)&&g.getAttribute("http-equiv")===(r.httpEquiv==null?null:r.httpEquiv)&&g.getAttribute("charset")===(r.charSet==null?null:r.charSet)){A.splice(H,1);break t}}g=h.createElement(o),Yn(g,o,r),h.head.appendChild(g);break;default:throw Error(i(468,o))}g[Yt]=e,kt(g),o=g}e.stateNode=o}else ay(h,e.type,e.stateNode);else e.stateNode=ny(h,o,e.memoizedProps);else g!==o?(g===null?r.stateNode!==null&&(r=r.stateNode,r.parentNode.removeChild(r)):g.count--,o===null?ay(h,e.type,e.stateNode):ny(h,o,e.memoizedProps)):o===null&&e.stateNode!==null&&rf(e,e.memoizedProps,r.memoizedProps)}break;case 27:fr(t,e),hr(e),o&512&&(On||r===null||ma(r,r.return)),r!==null&&o&4&&rf(e,e.memoizedProps,r.memoizedProps);break;case 5:if(fr(t,e),hr(e),o&512&&(On||r===null||ma(r,r.return)),e.flags&32){h=e.stateNode;try{Ea(h,"")}catch(Je){Kt(e,e.return,Je)}}o&4&&e.stateNode!=null&&(h=e.memoizedProps,rf(e,h,r!==null?r.memoizedProps:h)),o&1024&&(of=!0);break;case 6:if(fr(t,e),hr(e),o&4){if(e.stateNode===null)throw Error(i(162));o=e.memoizedProps,r=e.stateNode;try{r.nodeValue=o}catch(Je){Kt(e,e.return,Je)}}break;case 3:if(Lc=null,h=ea,ea=Mc(t.containerInfo),fr(t,e),ea=h,hr(e),o&4&&r!==null&&r.memoizedState.isDehydrated)try{Zi(t.containerInfo)}catch(Je){Kt(e,e.return,Je)}of&&(of=!1,ag(e));break;case 4:o=ea,ea=Mc(e.stateNode.containerInfo),fr(t,e),hr(e),ea=o;break;case 12:fr(t,e),hr(e);break;case 31:fr(t,e),hr(e),o&4&&(o=e.updateQueue,o!==null&&(e.updateQueue=null,_c(e,o)));break;case 13:fr(t,e),hr(e),e.child.flags&8192&&e.memoizedState!==null!=(r!==null&&r.memoizedState!==null)&&(wc=He()),o&4&&(o=e.updateQueue,o!==null&&(e.updateQueue=null,_c(e,o)));break;case 22:h=e.memoizedState!==null;var re=r!==null&&r.memoizedState!==null,_e=za,Ne=On;if(za=_e||h,On=Ne||re,fr(t,e),On=Ne,za=_e,hr(e),o&8192)e:for(t=e.stateNode,t._visibility=h?t._visibility&-2:t._visibility|1,h&&(r===null||re||za||On||ni(e)),r=null,t=e;;){if(t.tag===5||t.tag===26){if(r===null){re=r=t;try{if(g=re.stateNode,h)A=g.style,typeof A.setProperty=="function"?A.setProperty("display","none","important"):A.display="none";else{H=re.stateNode;var Ue=re.memoizedProps.style,we=Ue!=null&&Ue.hasOwnProperty("display")?Ue.display:null;H.style.display=we==null||typeof we=="boolean"?"":(""+we).trim()}}catch(Je){Kt(re,re.return,Je)}}}else if(t.tag===6){if(r===null){re=t;try{re.stateNode.nodeValue=h?"":re.memoizedProps}catch(Je){Kt(re,re.return,Je)}}}else if(t.tag===18){if(r===null){re=t;try{var Ae=re.stateNode;h?Vg(Ae,!0):Vg(re.stateNode,!1)}catch(Je){Kt(re,re.return,Je)}}}else if((t.tag!==22&&t.tag!==23||t.memoizedState===null||t===e)&&t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;r===t&&(r=null),t=t.return}r===t&&(r=null),t.sibling.return=t.return,t=t.sibling}o&4&&(o=e.updateQueue,o!==null&&(r=o.retryQueue,r!==null&&(o.retryQueue=null,_c(e,r))));break;case 19:fr(t,e),hr(e),o&4&&(o=e.updateQueue,o!==null&&(e.updateQueue=null,_c(e,o)));break;case 30:break;case 21:break;default:fr(t,e),hr(e)}}function hr(e){var t=e.flags;if(t&2){try{for(var r,o=e.return;o!==null;){if(Zp(o)){r=o;break}o=o.return}if(r==null)throw Error(i(160));switch(r.tag){case 27:var h=r.stateNode,g=af(e);xc(e,g,h);break;case 5:var A=r.stateNode;r.flags&32&&(Ea(A,""),r.flags&=-33);var H=af(e);xc(e,H,A);break;case 3:case 4:var re=r.stateNode.containerInfo,_e=af(e);sf(e,_e,re);break;default:throw Error(i(161))}}catch(Ne){Kt(e,e.return,Ne)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function ag(e){if(e.subtreeFlags&1024)for(e=e.child;e!==null;){var t=e;ag(t),t.tag===5&&t.flags&1024&&t.stateNode.reset(),e=e.sibling}}function Ba(e,t){if(t.subtreeFlags&8772)for(t=t.child;t!==null;)Xp(e,t.alternate,t),t=t.sibling}function ni(e){for(e=e.child;e!==null;){var t=e;switch(t.tag){case 0:case 11:case 14:case 15:vs(4,t,t.return),ni(t);break;case 1:ma(t,t.return);var r=t.stateNode;typeof r.componentWillUnmount=="function"&&Vp(t,t.return,r),ni(t);break;case 27:Qo(t.stateNode);case 26:case 5:ma(t,t.return),ni(t);break;case 22:t.memoizedState===null&&ni(t);break;case 30:ni(t);break;default:ni(t)}e=e.sibling}}function Ha(e,t,r){for(r=r&&(t.subtreeFlags&8772)!==0,t=t.child;t!==null;){var o=t.alternate,h=e,g=t,A=g.flags;switch(g.tag){case 0:case 11:case 15:Ha(h,g,r),Bo(4,g);break;case 1:if(Ha(h,g,r),o=g,h=o.stateNode,typeof h.componentDidMount=="function")try{h.componentDidMount()}catch(_e){Kt(o,o.return,_e)}if(o=g,h=o.updateQueue,h!==null){var H=o.stateNode;try{var re=h.shared.hiddenCallbacks;if(re!==null)for(h.shared.hiddenCallbacks=null,h=0;h<re.length;h++)Mm(re[h],H)}catch(_e){Kt(o,o.return,_e)}}r&&A&64&&Yp(g),Ho(g,g.return);break;case 27:Qp(g);case 26:case 5:Ha(h,g,r),r&&o===null&&A&4&&Kp(g),Ho(g,g.return);break;case 12:Ha(h,g,r);break;case 31:Ha(h,g,r),r&&A&4&&tg(h,g);break;case 13:Ha(h,g,r),r&&A&4&&ng(h,g);break;case 22:g.memoizedState===null&&Ha(h,g,r),Ho(g,g.return);break;case 30:break;default:Ha(h,g,r)}t=t.sibling}}function lf(e,t){var r=null;e!==null&&e.memoizedState!==null&&e.memoizedState.cachePool!==null&&(r=e.memoizedState.cachePool.pool),e=null,t.memoizedState!==null&&t.memoizedState.cachePool!==null&&(e=t.memoizedState.cachePool.pool),e!==r&&(e!=null&&e.refCount++,r!=null&&ko(r))}function cf(e,t){e=null,t.alternate!==null&&(e=t.alternate.memoizedState.cache),t=t.memoizedState.cache,t!==e&&(t.refCount++,e!=null&&ko(e))}function ta(e,t,r,o){if(t.subtreeFlags&10256)for(t=t.child;t!==null;)sg(e,t,r,o),t=t.sibling}function sg(e,t,r,o){var h=t.flags;switch(t.tag){case 0:case 11:case 15:ta(e,t,r,o),h&2048&&Bo(9,t);break;case 1:ta(e,t,r,o);break;case 3:ta(e,t,r,o),h&2048&&(e=null,t.alternate!==null&&(e=t.alternate.memoizedState.cache),t=t.memoizedState.cache,t!==e&&(t.refCount++,e!=null&&ko(e)));break;case 12:if(h&2048){ta(e,t,r,o),e=t.stateNode;try{var g=t.memoizedProps,A=g.id,H=g.onPostCommit;typeof H=="function"&&H(A,t.alternate===null?"mount":"update",e.passiveEffectDuration,-0)}catch(re){Kt(t,t.return,re)}}else ta(e,t,r,o);break;case 31:ta(e,t,r,o);break;case 13:ta(e,t,r,o);break;case 23:break;case 22:g=t.stateNode,A=t.alternate,t.memoizedState!==null?g._visibility&2?ta(e,t,r,o):Go(e,t):g._visibility&2?ta(e,t,r,o):(g._visibility|=2,zi(e,t,r,o,(t.subtreeFlags&10256)!==0||!1)),h&2048&&lf(A,t);break;case 24:ta(e,t,r,o),h&2048&&cf(t.alternate,t);break;default:ta(e,t,r,o)}}function zi(e,t,r,o,h){for(h=h&&((t.subtreeFlags&10256)!==0||!1),t=t.child;t!==null;){var g=e,A=t,H=r,re=o,_e=A.flags;switch(A.tag){case 0:case 11:case 15:zi(g,A,H,re,h),Bo(8,A);break;case 23:break;case 22:var Ne=A.stateNode;A.memoizedState!==null?Ne._visibility&2?zi(g,A,H,re,h):Go(g,A):(Ne._visibility|=2,zi(g,A,H,re,h)),h&&_e&2048&&lf(A.alternate,A);break;case 24:zi(g,A,H,re,h),h&&_e&2048&&cf(A.alternate,A);break;default:zi(g,A,H,re,h)}t=t.sibling}}function Go(e,t){if(t.subtreeFlags&10256)for(t=t.child;t!==null;){var r=e,o=t,h=o.flags;switch(o.tag){case 22:Go(r,o),h&2048&&lf(o.alternate,o);break;case 24:Go(r,o),h&2048&&cf(o.alternate,o);break;default:Go(r,o)}t=t.sibling}}var qo=8192;function Fi(e,t,r){if(e.subtreeFlags&qo)for(e=e.child;e!==null;)ig(e,t,r),e=e.sibling}function ig(e,t,r){switch(e.tag){case 26:Fi(e,t,r),e.flags&qo&&e.memoizedState!==null&&Zx(r,ea,e.memoizedState,e.memoizedProps);break;case 5:Fi(e,t,r);break;case 3:case 4:var o=ea;ea=Mc(e.stateNode.containerInfo),Fi(e,t,r),ea=o;break;case 22:e.memoizedState===null&&(o=e.alternate,o!==null&&o.memoizedState!==null?(o=qo,qo=16777216,Fi(e,t,r),qo=o):Fi(e,t,r));break;default:Fi(e,t,r)}}function og(e){var t=e.alternate;if(t!==null&&(e=t.child,e!==null)){t.child=null;do t=e.sibling,e.sibling=null,e=t;while(e!==null)}}function Po(e){var t=e.deletions;if((e.flags&16)!==0){if(t!==null)for(var r=0;r<t.length;r++){var o=t[r];Ln=o,cg(o,e)}og(e)}if(e.subtreeFlags&10256)for(e=e.child;e!==null;)lg(e),e=e.sibling}function lg(e){switch(e.tag){case 0:case 11:case 15:Po(e),e.flags&2048&&vs(9,e,e.return);break;case 3:Po(e);break;case 12:Po(e);break;case 22:var t=e.stateNode;e.memoizedState!==null&&t._visibility&2&&(e.return===null||e.return.tag!==13)?(t._visibility&=-3,Sc(e)):Po(e);break;default:Po(e)}}function Sc(e){var t=e.deletions;if((e.flags&16)!==0){if(t!==null)for(var r=0;r<t.length;r++){var o=t[r];Ln=o,cg(o,e)}og(e)}for(e=e.child;e!==null;){switch(t=e,t.tag){case 0:case 11:case 15:vs(8,t,t.return),Sc(t);break;case 22:r=t.stateNode,r._visibility&2&&(r._visibility&=-3,Sc(t));break;default:Sc(t)}e=e.sibling}}function cg(e,t){for(;Ln!==null;){var r=Ln;switch(r.tag){case 0:case 11:case 15:vs(8,r,t);break;case 23:case 22:if(r.memoizedState!==null&&r.memoizedState.cachePool!==null){var o=r.memoizedState.cachePool.pool;o!=null&&o.refCount++}break;case 24:ko(r.memoizedState.cache)}if(o=r.child,o!==null)o.return=r,Ln=o;else e:for(r=e;Ln!==null;){o=Ln;var h=o.sibling,g=o.return;if(Wp(o),o===r){Ln=null;break e}if(h!==null){h.return=g,Ln=h;break e}Ln=g}}}var ux={getCacheForType:function(e){var t=Pn(Cn),r=t.data.get(e);return r===void 0&&(r=e(),t.data.set(e,r)),r},cacheSignal:function(){return Pn(Cn).controller.signal}},dx=typeof WeakMap=="function"?WeakMap:Map,Pt=0,en=null,Nt=null,It=0,Vt=0,Er=null,bs=!1,Bi=!1,uf=!1,Ga=0,xn=0,xs=0,ri=0,df=0,Tr=0,Hi=0,$o=null,mr=null,ff=!1,wc=0,ug=0,Ec=1/0,Tc=null,_s=null,Rn=0,Ss=null,Gi=null,qa=0,hf=0,mf=null,dg=null,Yo=0,pf=null;function Ar(){return(Pt&2)!==0&&It!==0?It&-It:K.T!==null?_f():Rr()}function fg(){if(Tr===0)if((It&536870912)===0||Lt){var e=qt;qt<<=1,(qt&3932160)===0&&(qt=262144),Tr=e}else Tr=536870912;return e=Sr.current,e!==null&&(e.flags|=32),Tr}function pr(e,t,r){(e===en&&(Vt===2||Vt===9)||e.cancelPendingCommit!==null)&&(qi(e,0),ws(e,It,Tr,!1)),yr(e,r),((Pt&2)===0||e!==en)&&(e===en&&((Pt&2)===0&&(ri|=r),xn===4&&ws(e,It,Tr,!1)),pa(e))}function hg(e,t,r){if((Pt&6)!==0)throw Error(i(327));var o=!r&&(t&127)===0&&(t&e.expiredLanes)===0||pn(e,t),h=o?mx(e,t):yf(e,t,!0),g=o;do{if(h===0){Bi&&!o&&ws(e,t,0,!1);break}else{if(r=e.current.alternate,g&&!fx(r)){h=yf(e,t,!1),g=!1;continue}if(h===2){if(g=t,e.errorRecoveryDisabledLanes&g)var A=0;else A=e.pendingLanes&-536870913,A=A!==0?A:A&536870912?536870912:0;if(A!==0){t=A;e:{var H=e;h=$o;var re=H.current.memoizedState.isDehydrated;if(re&&(qi(H,A).flags|=256),A=yf(H,A,!1),A!==2){if(uf&&!re){H.errorRecoveryDisabledLanes|=g,ri|=g,h=4;break e}g=mr,mr=h,g!==null&&(mr===null?mr=g:mr.push.apply(mr,g))}h=A}if(g=!1,h!==2)continue}}if(h===1){qi(e,0),ws(e,t,0,!0);break}e:{switch(o=e,g=h,g){case 0:case 1:throw Error(i(345));case 4:if((t&4194048)!==t)break;case 6:ws(o,t,Tr,!bs);break e;case 2:mr=null;break;case 3:case 5:break;default:throw Error(i(329))}if((t&62914560)===t&&(h=wc+300-He(),10<h)){if(ws(o,t,Tr,!bs),gt(o,0,!0)!==0)break e;qa=t,o.timeoutHandle=Pg(mg.bind(null,o,r,mr,Tc,ff,t,Tr,ri,Hi,bs,g,"Throttled",-0,0),h);break e}mg(o,r,mr,Tc,ff,t,Tr,ri,Hi,bs,g,null,-0,0)}}break}while(!0);pa(e)}function mg(e,t,r,o,h,g,A,H,re,_e,Ne,Ue,we,Ae){if(e.timeoutHandle=-1,Ue=t.subtreeFlags,Ue&8192||(Ue&16785408)===16785408){Ue={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:In},ig(t,g,Ue);var Je=(g&62914560)===g?wc-He():(g&4194048)===g?ug-He():0;if(Je=Qx(Ue,Je),Je!==null){qa=g,e.cancelPendingCommit=Je(Sg.bind(null,e,t,g,r,o,h,A,H,re,Ne,Ue,null,we,Ae)),ws(e,g,A,!_e);return}}Sg(e,t,g,r,o,h,A,H,re)}function fx(e){for(var t=e;;){var r=t.tag;if((r===0||r===11||r===15)&&t.flags&16384&&(r=t.updateQueue,r!==null&&(r=r.stores,r!==null)))for(var o=0;o<r.length;o++){var h=r[o],g=h.getSnapshot;h=h.value;try{if(!xr(g(),h))return!1}catch{return!1}}if(r=t.child,t.subtreeFlags&16384&&r!==null)r.return=t,t=r;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function ws(e,t,r,o){t&=~df,t&=~ri,e.suspendedLanes|=t,e.pingedLanes&=~t,o&&(e.warmLanes|=t),o=e.expirationTimes;for(var h=t;0<h;){var g=31-Mt(h),A=1<<g;o[g]=-1,h&=~A}r!==0&&Ja(e,r,t)}function Ac(){return(Pt&6)===0?(Vo(0),!1):!0}function gf(){if(Nt!==null){if(Vt===0)var e=Nt.return;else e=Nt,ja=Ks=null,Od(e),Ii=null,No=0,e=Nt;for(;e!==null;)$p(e.alternate,e),e=e.return;Nt=null}}function qi(e,t){var r=e.timeoutHandle;r!==-1&&(e.timeoutHandle=-1,jx(r)),r=e.cancelPendingCommit,r!==null&&(e.cancelPendingCommit=null,r()),qa=0,gf(),en=e,Nt=r=Da(e.current,null),It=t,Vt=0,Er=null,bs=!1,Bi=pn(e,t),uf=!1,Hi=Tr=df=ri=xs=xn=0,mr=$o=null,ff=!1,(t&8)!==0&&(t|=t&32);var o=e.entangledLanes;if(o!==0)for(e=e.entanglements,o&=t;0<o;){var h=31-Mt(o),g=1<<h;t|=e[h],o&=~g}return Ga=t,Vl(),r}function pg(e,t){bt=null,K.H=Lo,t===ji||t===tc?(t=Om(),Vt=3):t===bd?(t=Om(),Vt=4):Vt=t===Vd?8:t!==null&&typeof t=="object"&&typeof t.then=="function"?6:1,Er=t,Nt===null&&(xn=1,pc(e,Br(t,e.current)))}function gg(){var e=Sr.current;return e===null?!0:(It&4194048)===It?Pr===null:(It&62914560)===It||(It&536870912)!==0?e===Pr:!1}function yg(){var e=K.H;return K.H=Lo,e===null?Lo:e}function vg(){var e=K.A;return K.A=ux,e}function kc(){xn=4,bs||(It&4194048)!==It&&Sr.current!==null||(Bi=!0),(xs&134217727)===0&&(ri&134217727)===0||en===null||ws(en,It,Tr,!1)}function yf(e,t,r){var o=Pt;Pt|=2;var h=yg(),g=vg();(en!==e||It!==t)&&(Tc=null,qi(e,t)),t=!1;var A=xn;e:do try{if(Vt!==0&&Nt!==null){var H=Nt,re=Er;switch(Vt){case 8:gf(),A=6;break e;case 3:case 2:case 9:case 6:Sr.current===null&&(t=!0);var _e=Vt;if(Vt=0,Er=null,Pi(e,H,re,_e),r&&Bi){A=0;break e}break;default:_e=Vt,Vt=0,Er=null,Pi(e,H,re,_e)}}hx(),A=xn;break}catch(Ne){pg(e,Ne)}while(!0);return t&&e.shellSuspendCounter++,ja=Ks=null,Pt=o,K.H=h,K.A=g,Nt===null&&(en=null,It=0,Vl()),A}function hx(){for(;Nt!==null;)bg(Nt)}function mx(e,t){var r=Pt;Pt|=2;var o=yg(),h=vg();en!==e||It!==t?(Tc=null,Ec=He()+500,qi(e,t)):Bi=pn(e,t);e:do try{if(Vt!==0&&Nt!==null){t=Nt;var g=Er;t:switch(Vt){case 1:Vt=0,Er=null,Pi(e,t,g,1);break;case 2:case 9:if(Nm(g)){Vt=0,Er=null,xg(t);break}t=function(){Vt!==2&&Vt!==9||en!==e||(Vt=7),pa(e)},g.then(t,t);break e;case 3:Vt=7;break e;case 4:Vt=5;break e;case 7:Nm(g)?(Vt=0,Er=null,xg(t)):(Vt=0,Er=null,Pi(e,t,g,7));break;case 5:var A=null;switch(Nt.tag){case 26:A=Nt.memoizedState;case 5:case 27:var H=Nt;if(A?sy(A):H.stateNode.complete){Vt=0,Er=null;var re=H.sibling;if(re!==null)Nt=re;else{var _e=H.return;_e!==null?(Nt=_e,Cc(_e)):Nt=null}break t}}Vt=0,Er=null,Pi(e,t,g,5);break;case 6:Vt=0,Er=null,Pi(e,t,g,6);break;case 8:gf(),xn=6;break e;default:throw Error(i(462))}}px();break}catch(Ne){pg(e,Ne)}while(!0);return ja=Ks=null,K.H=o,K.A=h,Pt=r,Nt!==null?0:(en=null,It=0,Vl(),xn)}function px(){for(;Nt!==null&&!pe();)bg(Nt)}function bg(e){var t=qp(e.alternate,e,Ga);e.memoizedProps=e.pendingProps,t===null?Cc(e):Nt=t}function xg(e){var t=e,r=t.alternate;switch(t.tag){case 15:case 0:t=Lp(r,t,t.pendingProps,t.type,void 0,It);break;case 11:t=Lp(r,t,t.pendingProps,t.type.render,t.ref,It);break;case 5:Od(t);default:$p(r,t),t=Nt=vm(t,Ga),t=qp(r,t,Ga)}e.memoizedProps=e.pendingProps,t===null?Cc(e):Nt=t}function Pi(e,t,r,o){ja=Ks=null,Od(t),Ii=null,No=0;var h=t.return;try{if(rx(e,h,t,r,It)){xn=1,pc(e,Br(r,e.current)),Nt=null;return}}catch(g){if(h!==null)throw Nt=h,g;xn=1,pc(e,Br(r,e.current)),Nt=null;return}t.flags&32768?(Lt||o===1?e=!0:Bi||(It&536870912)!==0?e=!1:(bs=e=!0,(o===2||o===9||o===3||o===6)&&(o=Sr.current,o!==null&&o.tag===13&&(o.flags|=16384))),_g(t,e)):Cc(t)}function Cc(e){var t=e;do{if((t.flags&32768)!==0){_g(t,bs);return}e=t.return;var r=ix(t.alternate,t,Ga);if(r!==null){Nt=r;return}if(t=t.sibling,t!==null){Nt=t;return}Nt=t=e}while(t!==null);xn===0&&(xn=5)}function _g(e,t){do{var r=ox(e.alternate,e);if(r!==null){r.flags&=32767,Nt=r;return}if(r=e.return,r!==null&&(r.flags|=32768,r.subtreeFlags=0,r.deletions=null),!t&&(e=e.sibling,e!==null)){Nt=e;return}Nt=e=r}while(e!==null);xn=6,Nt=null}function Sg(e,t,r,o,h,g,A,H,re){e.cancelPendingCommit=null;do Nc();while(Rn!==0);if((Pt&6)!==0)throw Error(i(327));if(t!==null){if(t===e.current)throw Error(i(177));if(g=t.lanes|t.childLanes,g|=ad,Qa(e,r,g,A,H,re),e===en&&(Nt=en=null,It=0),Gi=t,Ss=e,qa=r,hf=g,mf=h,dg=o,(t.subtreeFlags&10256)!==0||(t.flags&10256)!==0?(e.callbackNode=null,e.callbackPriority=0,bx(We,function(){return kg(),null})):(e.callbackNode=null,e.callbackPriority=0),o=(t.flags&13878)!==0,(t.subtreeFlags&13878)!==0||o){o=K.T,K.T=null,h=P.p,P.p=2,A=Pt,Pt|=4;try{lx(e,t,r)}finally{Pt=A,P.p=h,K.T=o}}Rn=1,wg(),Eg(),Tg()}}function wg(){if(Rn===1){Rn=0;var e=Ss,t=Gi,r=(t.flags&13878)!==0;if((t.subtreeFlags&13878)!==0||r){r=K.T,K.T=null;var o=P.p;P.p=2;var h=Pt;Pt|=4;try{rg(t,e);var g=Nf,A=cm(e.containerInfo),H=g.focusedElem,re=g.selectionRange;if(A!==H&&H&&H.ownerDocument&&lm(H.ownerDocument.documentElement,H)){if(re!==null&&Wu(H)){var _e=re.start,Ne=re.end;if(Ne===void 0&&(Ne=_e),"selectionStart"in H)H.selectionStart=_e,H.selectionEnd=Math.min(Ne,H.value.length);else{var Ue=H.ownerDocument||document,we=Ue&&Ue.defaultView||window;if(we.getSelection){var Ae=we.getSelection(),Je=H.textContent.length,dt=Math.min(re.start,Je),Xt=re.end===void 0?dt:Math.min(re.end,Je);!Ae.extend&&dt>Xt&&(A=Xt,Xt=dt,dt=A);var ye=om(H,dt),he=om(H,Xt);if(ye&&he&&(Ae.rangeCount!==1||Ae.anchorNode!==ye.node||Ae.anchorOffset!==ye.offset||Ae.focusNode!==he.node||Ae.focusOffset!==he.offset)){var xe=Ue.createRange();xe.setStart(ye.node,ye.offset),Ae.removeAllRanges(),dt>Xt?(Ae.addRange(xe),Ae.extend(he.node,he.offset)):(xe.setEnd(he.node,he.offset),Ae.addRange(xe))}}}}for(Ue=[],Ae=H;Ae=Ae.parentNode;)Ae.nodeType===1&&Ue.push({element:Ae,left:Ae.scrollLeft,top:Ae.scrollTop});for(typeof H.focus=="function"&&H.focus(),H=0;H<Ue.length;H++){var Me=Ue[H];Me.element.scrollLeft=Me.left,Me.element.scrollTop=Me.top}}Hc=!!Cf,Nf=Cf=null}finally{Pt=h,P.p=o,K.T=r}}e.current=t,Rn=2}}function Eg(){if(Rn===2){Rn=0;var e=Ss,t=Gi,r=(t.flags&8772)!==0;if((t.subtreeFlags&8772)!==0||r){r=K.T,K.T=null;var o=P.p;P.p=2;var h=Pt;Pt|=4;try{Xp(e,t.alternate,t)}finally{Pt=h,P.p=o,K.T=r}}Rn=3}}function Tg(){if(Rn===4||Rn===3){Rn=0,Ie();var e=Ss,t=Gi,r=qa,o=dg;(t.subtreeFlags&10256)!==0||(t.flags&10256)!==0?Rn=5:(Rn=0,Gi=Ss=null,Ag(e,e.pendingLanes));var h=e.pendingLanes;if(h===0&&(_s=null),Sa(r),t=t.stateNode,rt&&typeof rt.onCommitFiberRoot=="function")try{rt.onCommitFiberRoot(mt,t,void 0,(t.current.flags&128)===128)}catch{}if(o!==null){t=K.T,h=P.p,P.p=2,K.T=null;try{for(var g=e.onRecoverableError,A=0;A<o.length;A++){var H=o[A];g(H.value,{componentStack:H.stack})}}finally{K.T=t,P.p=h}}(qa&3)!==0&&Nc(),pa(e),h=e.pendingLanes,(r&261930)!==0&&(h&42)!==0?e===pf?Yo++:(Yo=0,pf=e):Yo=0,Vo(0)}}function Ag(e,t){(e.pooledCacheLanes&=t)===0&&(t=e.pooledCache,t!=null&&(e.pooledCache=null,ko(t)))}function Nc(){return wg(),Eg(),Tg(),kg()}function kg(){if(Rn!==5)return!1;var e=Ss,t=hf;hf=0;var r=Sa(qa),o=K.T,h=P.p;try{P.p=32>r?32:r,K.T=null,r=mf,mf=null;var g=Ss,A=qa;if(Rn=0,Gi=Ss=null,qa=0,(Pt&6)!==0)throw Error(i(331));var H=Pt;if(Pt|=4,lg(g.current),sg(g,g.current,A,r),Pt=H,Vo(0,!1),rt&&typeof rt.onPostCommitFiberRoot=="function")try{rt.onPostCommitFiberRoot(mt,g)}catch{}return!0}finally{P.p=h,K.T=o,Ag(e,t)}}function Cg(e,t,r){t=Br(r,t),t=Yd(e.stateNode,t,2),e=ps(e,t,2),e!==null&&(yr(e,2),pa(e))}function Kt(e,t,r){if(e.tag===3)Cg(e,e,r);else for(;t!==null;){if(t.tag===3){Cg(t,e,r);break}else if(t.tag===1){var o=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof o.componentDidCatch=="function"&&(_s===null||!_s.has(o))){e=Br(r,e),r=Np(2),o=ps(t,r,2),o!==null&&(Dp(r,o,t,e),yr(o,2),pa(o));break}}t=t.return}}function vf(e,t,r){var o=e.pingCache;if(o===null){o=e.pingCache=new dx;var h=new Set;o.set(t,h)}else h=o.get(t),h===void 0&&(h=new Set,o.set(t,h));h.has(r)||(uf=!0,h.add(r),e=gx.bind(null,e,t,r),t.then(e,e))}function gx(e,t,r){var o=e.pingCache;o!==null&&o.delete(t),e.pingedLanes|=e.suspendedLanes&r,e.warmLanes&=~r,en===e&&(It&r)===r&&(xn===4||xn===3&&(It&62914560)===It&&300>He()-wc?(Pt&2)===0&&qi(e,0):df|=r,Hi===It&&(Hi=0)),pa(e)}function Ng(e,t){t===0&&(t=_a()),e=$s(e,t),e!==null&&(yr(e,t),pa(e))}function yx(e){var t=e.memoizedState,r=0;t!==null&&(r=t.retryLane),Ng(e,r)}function vx(e,t){var r=0;switch(e.tag){case 31:case 13:var o=e.stateNode,h=e.memoizedState;h!==null&&(r=h.retryLane);break;case 19:o=e.stateNode;break;case 22:o=e.stateNode._retryCache;break;default:throw Error(i(314))}o!==null&&o.delete(t),Ng(e,r)}function bx(e,t){return ke(e,t)}var Dc=null,$i=null,bf=!1,Oc=!1,xf=!1,Es=0;function pa(e){e!==$i&&e.next===null&&($i===null?Dc=$i=e:$i=$i.next=e),Oc=!0,bf||(bf=!0,_x())}function Vo(e,t){if(!xf&&Oc){xf=!0;do for(var r=!1,o=Dc;o!==null;){if(e!==0){var h=o.pendingLanes;if(h===0)var g=0;else{var A=o.suspendedLanes,H=o.pingedLanes;g=(1<<31-Mt(42|e)+1)-1,g&=h&~(A&~H),g=g&201326741?g&201326741|1:g?g|2:0}g!==0&&(r=!0,Ig(o,g))}else g=It,g=gt(o,o===en?g:0,o.cancelPendingCommit!==null||o.timeoutHandle!==-1),(g&3)===0||pn(o,g)||(r=!0,Ig(o,g));o=o.next}while(r);xf=!1}}function xx(){Dg()}function Dg(){Oc=bf=!1;var e=0;Es!==0&&Ox()&&(e=Es);for(var t=He(),r=null,o=Dc;o!==null;){var h=o.next,g=Og(o,t);g===0?(o.next=null,r===null?Dc=h:r.next=h,h===null&&($i=r)):(r=o,(e!==0||(g&3)!==0)&&(Oc=!0)),o=h}Rn!==0&&Rn!==5||Vo(e),Es!==0&&(Es=0)}function Og(e,t){for(var r=e.suspendedLanes,o=e.pingedLanes,h=e.expirationTimes,g=e.pendingLanes&-62914561;0<g;){var A=31-Mt(g),H=1<<A,re=h[A];re===-1?((H&r)===0||(H&o)!==0)&&(h[A]=Pe(H,t)):re<=t&&(e.expiredLanes|=H),g&=~H}if(t=en,r=It,r=gt(e,e===t?r:0,e.cancelPendingCommit!==null||e.timeoutHandle!==-1),o=e.callbackNode,r===0||e===t&&(Vt===2||Vt===9)||e.cancelPendingCommit!==null)return o!==null&&o!==null&&Ce(o),e.callbackNode=null,e.callbackPriority=0;if((r&3)===0||pn(e,r)){if(t=r&-r,t===e.callbackPriority)return t;switch(o!==null&&Ce(o),Sa(r)){case 2:case 8:r=nt;break;case 32:r=We;break;case 268435456:r=St;break;default:r=We}return o=jg.bind(null,e),r=ke(r,o),e.callbackPriority=t,e.callbackNode=r,t}return o!==null&&o!==null&&Ce(o),e.callbackPriority=2,e.callbackNode=null,2}function jg(e,t){if(Rn!==0&&Rn!==5)return e.callbackNode=null,e.callbackPriority=0,null;var r=e.callbackNode;if(Nc()&&e.callbackNode!==r)return null;var o=It;return o=gt(e,e===en?o:0,e.cancelPendingCommit!==null||e.timeoutHandle!==-1),o===0?null:(hg(e,o,t),Og(e,He()),e.callbackNode!=null&&e.callbackNode===r?jg.bind(null,e):null)}function Ig(e,t){if(Nc())return null;hg(e,t,!0)}function _x(){Ix(function(){(Pt&6)!==0?ke(qe,xx):Dg()})}function _f(){if(Es===0){var e=Di;e===0&&(e=Kn,Kn<<=1,(Kn&261888)===0&&(Kn=256)),Es=e}return Es}function Rg(e){return e==null||typeof e=="symbol"||typeof e=="boolean"?null:typeof e=="function"?e:ss(""+e)}function Mg(e,t){var r=t.ownerDocument.createElement("input");return r.name=t.name,r.value=t.value,e.id&&r.setAttribute("form",e.id),t.parentNode.insertBefore(r,t),e=new FormData(e),r.parentNode.removeChild(r),e}function Sx(e,t,r,o,h){if(t==="submit"&&r&&r.stateNode===h){var g=Rg((h[Bt]||null).action),A=o.submitter;A&&(t=(t=A[Bt]||null)?Rg(t.formAction):A.getAttribute("formAction"),t!==null&&(g=t,A=null));var H=new Re("action","action",null,o,h);e.push({event:H,listeners:[{instance:null,listener:function(){if(o.defaultPrevented){if(Es!==0){var re=A?Mg(h,A):new FormData(h);Bd(r,{pending:!0,data:re,method:h.method,action:g},null,re)}}else typeof g=="function"&&(H.preventDefault(),re=A?Mg(h,A):new FormData(h),Bd(r,{pending:!0,data:re,method:h.method,action:g},g,re))},currentTarget:h}]})}}for(var Sf=0;Sf<rd.length;Sf++){var wf=rd[Sf],wx=wf.toLowerCase(),Ex=wf[0].toUpperCase()+wf.slice(1);Wr(wx,"on"+Ex)}Wr(fm,"onAnimationEnd"),Wr(hm,"onAnimationIteration"),Wr(mm,"onAnimationStart"),Wr("dblclick","onDoubleClick"),Wr("focusin","onFocus"),Wr("focusout","onBlur"),Wr(B0,"onTransitionRun"),Wr(H0,"onTransitionStart"),Wr(G0,"onTransitionCancel"),Wr(pm,"onTransitionEnd"),Zn("onMouseEnter",["mouseout","mouseover"]),Zn("onMouseLeave",["mouseout","mouseover"]),Zn("onPointerEnter",["pointerout","pointerover"]),Zn("onPointerLeave",["pointerout","pointerover"]),on("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),on("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),on("onBeforeInput",["compositionend","keypress","textInput","paste"]),on("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),on("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),on("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ko="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Tx=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Ko));function Ug(e,t){t=(t&4)!==0;for(var r=0;r<e.length;r++){var o=e[r],h=o.event;o=o.listeners;e:{var g=void 0;if(t)for(var A=o.length-1;0<=A;A--){var H=o[A],re=H.instance,_e=H.currentTarget;if(H=H.listener,re!==g&&h.isPropagationStopped())break e;g=H,h.currentTarget=_e;try{g(h)}catch(Ne){Yl(Ne)}h.currentTarget=null,g=re}else for(A=0;A<o.length;A++){if(H=o[A],re=H.instance,_e=H.currentTarget,H=H.listener,re!==g&&h.isPropagationStopped())break e;g=H,h.currentTarget=_e;try{g(h)}catch(Ne){Yl(Ne)}h.currentTarget=null,g=re}}}}function Dt(e,t){var r=t[Xa];r===void 0&&(r=t[Xa]=new Set);var o=e+"__bubble";r.has(o)||(Lg(t,e,2,!1),r.add(o))}function Ef(e,t,r){var o=0;t&&(o|=4),Lg(r,e,o,t)}var jc="_reactListening"+Math.random().toString(36).slice(2);function Tf(e){if(!e[jc]){e[jc]=!0,kn.forEach(function(r){r!=="selectionchange"&&(Tx.has(r)||Ef(r,!1,e),Ef(r,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[jc]||(t[jc]=!0,Ef("selectionchange",!1,t))}}function Lg(e,t,r,o){switch(fy(t)){case 2:var h=Wx;break;case 8:h=e_;break;default:h=Bf}r=h.bind(null,t,r,e),h=void 0,!ka||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(h=!0),o?h!==void 0?e.addEventListener(t,r,{capture:!0,passive:h}):e.addEventListener(t,r,!0):h!==void 0?e.addEventListener(t,r,{passive:h}):e.addEventListener(t,r,!1)}function Af(e,t,r,o,h){var g=o;if((t&1)===0&&(t&2)===0&&o!==null)e:for(;;){if(o===null)return;var A=o.tag;if(A===3||A===4){var H=o.stateNode.containerInfo;if(H===h)break;if(A===4)for(A=o.return;A!==null;){var re=A.tag;if((re===3||re===4)&&A.stateNode.containerInfo===h)return;A=A.return}for(;H!==null;){if(A=Ke(H),A===null)return;if(re=A.tag,re===5||re===6||re===26||re===27){o=g=A;continue e}H=H.parentNode}}o=o.return}Fs(function(){var _e=g,Ne=is(r),Ue=[];e:{var we=gm.get(e);if(we!==void 0){var Ae=Re,Je=e;switch(e){case"keypress":if(b(r)===0)break e;case"keydown":case"keyup":Ae=Gu;break;case"focusin":Je="focus",Ae=vo;break;case"focusout":Je="blur",Ae=vo;break;case"beforeblur":case"afterblur":Ae=vo;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Ae=zl;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Ae=ju;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Ae=Pu;break;case fm:case hm:case mm:Ae=Ru;break;case pm:Ae=Yu;break;case"scroll":case"scrollend":Ae=Ut;break;case"wheel":Ae=Ku;break;case"copy":case"cut":case"paste":Ae=Uu;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Ae=ql;break;case"toggle":case"beforetoggle":Ae=$l}var dt=(t&4)!==0,Xt=!dt&&(e==="scroll"||e==="scrollend"),ye=dt?we!==null?we+"Capture":null:we;dt=[];for(var he=_e,xe;he!==null;){var Me=he;if(xe=Me.stateNode,Me=Me.tag,Me!==5&&Me!==26&&Me!==27||xe===null||ye===null||(Me=da(he,ye),Me!=null&&dt.push(Zo(he,Me,xe))),Xt)break;he=he.return}0<dt.length&&(we=new Ae(we,Je,null,r,Ne),Ue.push({event:we,listeners:dt}))}}if((t&7)===0){e:{if(we=e==="mouseover"||e==="pointerover",Ae=e==="mouseout"||e==="pointerout",we&&r!==ua&&(Je=r.relatedTarget||r.fromElement)&&(Ke(Je)||Je[Mr]))break e;if((Ae||we)&&(we=Ne.window===Ne?Ne:(we=Ne.ownerDocument)?we.defaultView||we.parentWindow:window,Ae?(Je=r.relatedTarget||r.toElement,Ae=_e,Je=Je?Ke(Je):null,Je!==null&&(Xt=c(Je),dt=Je.tag,Je!==Xt||dt!==5&&dt!==27&&dt!==6)&&(Je=null)):(Ae=null,Je=_e),Ae!==Je)){if(dt=zl,Me="onMouseLeave",ye="onMouseEnter",he="mouse",(e==="pointerout"||e==="pointerover")&&(dt=ql,Me="onPointerLeave",ye="onPointerEnter",he="pointer"),Xt=Ae==null?we:sn(Ae),xe=Je==null?we:sn(Je),we=new dt(Me,he+"leave",Ae,r,Ne),we.target=Xt,we.relatedTarget=xe,Me=null,Ke(Ne)===_e&&(dt=new dt(ye,he+"enter",Je,r,Ne),dt.target=xe,dt.relatedTarget=Xt,Me=dt),Xt=Me,Ae&&Je)t:{for(dt=Ax,ye=Ae,he=Je,xe=0,Me=ye;Me;Me=dt(Me))xe++;Me=0;for(var it=he;it;it=dt(it))Me++;for(;0<xe-Me;)ye=dt(ye),xe--;for(;0<Me-xe;)he=dt(he),Me--;for(;xe--;){if(ye===he||he!==null&&ye===he.alternate){dt=ye;break t}ye=dt(ye),he=dt(he)}dt=null}else dt=null;Ae!==null&&zg(Ue,we,Ae,dt,!1),Je!==null&&Xt!==null&&zg(Ue,Xt,Je,dt,!0)}}e:{if(we=_e?sn(_e):window,Ae=we.nodeName&&we.nodeName.toLowerCase(),Ae==="select"||Ae==="input"&&we.type==="file")var Ht=tm;else if(nr(we))if(nm)Ht=L0;else{Ht=M0;var tt=R0}else Ae=we.nodeName,!Ae||Ae.toLowerCase()!=="input"||we.type!=="checkbox"&&we.type!=="radio"?_e&&as(_e.elementType)&&(Ht=tm):Ht=U0;if(Ht&&(Ht=Ht(e,_e))){Qn(Ue,Ht,r,Ne);break e}tt&&tt(e,we,_e),e==="focusout"&&_e&&we.type==="number"&&_e.memoizedProps.value!=null&&po(we,"number",we.value)}switch(tt=_e?sn(_e):window,e){case"focusin":(nr(tt)||tt.contentEditable==="true")&&(Si=tt,ed=_e,Eo=null);break;case"focusout":Eo=ed=Si=null;break;case"mousedown":td=!0;break;case"contextmenu":case"mouseup":case"dragend":td=!1,um(Ue,r,Ne);break;case"selectionchange":if(F0)break;case"keydown":case"keyup":um(Ue,r,Ne)}var _t;if(xo)e:{switch(e){case"compositionstart":var Rt="onCompositionStart";break e;case"compositionend":Rt="onCompositionEnd";break e;case"compositionupdate":Rt="onCompositionUpdate";break e}Rt=void 0}else lt?Fe(e,r)&&(Rt="onCompositionEnd"):e==="keydown"&&r.keyCode===229&&(Rt="onCompositionStart");Rt&&(_o&&r.locale!=="ko"&&(lt||Rt!=="onCompositionStart"?Rt==="onCompositionEnd"&&lt&&(_t=y()):(Hn=Ne,ls="value"in Hn?Hn.value:Hn.textContent,lt=!0)),tt=Ic(_e,Rt),0<tt.length&&(Rt=new Hl(Rt,e,null,r,Ne),Ue.push({event:Rt,listeners:tt}),_t?Rt.data=_t:(_t=et(r),_t!==null&&(Rt.data=_t)))),(_t=xi?Et(e,r):Zt(e,r))&&(Rt=Ic(_e,"onBeforeInput"),0<Rt.length&&(tt=new Hl("onBeforeInput","beforeinput",null,r,Ne),Ue.push({event:tt,listeners:Rt}),tt.data=_t)),Sx(Ue,e,_e,r,Ne)}Ug(Ue,t)})}function Zo(e,t,r){return{instance:e,listener:t,currentTarget:r}}function Ic(e,t){for(var r=t+"Capture",o=[];e!==null;){var h=e,g=h.stateNode;if(h=h.tag,h!==5&&h!==26&&h!==27||g===null||(h=da(e,r),h!=null&&o.unshift(Zo(e,h,g)),h=da(e,t),h!=null&&o.push(Zo(e,h,g))),e.tag===3)return o;e=e.return}return[]}function Ax(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5&&e.tag!==27);return e||null}function zg(e,t,r,o,h){for(var g=t._reactName,A=[];r!==null&&r!==o;){var H=r,re=H.alternate,_e=H.stateNode;if(H=H.tag,re!==null&&re===o)break;H!==5&&H!==26&&H!==27||_e===null||(re=_e,h?(_e=da(r,g),_e!=null&&A.unshift(Zo(r,_e,re))):h||(_e=da(r,g),_e!=null&&A.push(Zo(r,_e,re)))),r=r.return}A.length!==0&&e.push({event:t,listeners:A})}var kx=/\r\n?/g,Cx=/\u0000|\uFFFD/g;function Fg(e){return(typeof e=="string"?e:""+e).replace(kx,`
`).replace(Cx,"")}function Bg(e,t){return t=Fg(t),Fg(e)===t}function Jt(e,t,r,o,h,g){switch(r){case"children":typeof o=="string"?t==="body"||t==="textarea"&&o===""||Ea(e,o):(typeof o=="number"||typeof o=="bigint")&&t!=="body"&&Ea(e,""+o);break;case"className":zs(e,"class",o);break;case"tabIndex":zs(e,"tabindex",o);break;case"dir":case"role":case"viewBox":case"width":case"height":zs(e,r,o);break;case"style":Ll(e,o,g);break;case"data":if(t!=="object"){zs(e,"data",o);break}case"src":case"href":if(o===""&&(t!=="a"||r!=="href")){e.removeAttribute(r);break}if(o==null||typeof o=="function"||typeof o=="symbol"||typeof o=="boolean"){e.removeAttribute(r);break}o=ss(""+o),e.setAttribute(r,o);break;case"action":case"formAction":if(typeof o=="function"){e.setAttribute(r,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof g=="function"&&(r==="formAction"?(t!=="input"&&Jt(e,t,"name",h.name,h,null),Jt(e,t,"formEncType",h.formEncType,h,null),Jt(e,t,"formMethod",h.formMethod,h,null),Jt(e,t,"formTarget",h.formTarget,h,null)):(Jt(e,t,"encType",h.encType,h,null),Jt(e,t,"method",h.method,h,null),Jt(e,t,"target",h.target,h,null)));if(o==null||typeof o=="symbol"||typeof o=="boolean"){e.removeAttribute(r);break}o=ss(""+o),e.setAttribute(r,o);break;case"onClick":o!=null&&(e.onclick=In);break;case"onScroll":o!=null&&Dt("scroll",e);break;case"onScrollEnd":o!=null&&Dt("scrollend",e);break;case"dangerouslySetInnerHTML":if(o!=null){if(typeof o!="object"||!("__html"in o))throw Error(i(61));if(r=o.__html,r!=null){if(h.children!=null)throw Error(i(60));e.innerHTML=r}}break;case"multiple":e.multiple=o&&typeof o!="function"&&typeof o!="symbol";break;case"muted":e.muted=o&&typeof o!="function"&&typeof o!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(o==null||typeof o=="function"||typeof o=="boolean"||typeof o=="symbol"){e.removeAttribute("xlink:href");break}r=ss(""+o),e.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",r);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":o!=null&&typeof o!="function"&&typeof o!="symbol"?e.setAttribute(r,""+o):e.removeAttribute(r);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":o&&typeof o!="function"&&typeof o!="symbol"?e.setAttribute(r,""):e.removeAttribute(r);break;case"capture":case"download":o===!0?e.setAttribute(r,""):o!==!1&&o!=null&&typeof o!="function"&&typeof o!="symbol"?e.setAttribute(r,o):e.removeAttribute(r);break;case"cols":case"rows":case"size":case"span":o!=null&&typeof o!="function"&&typeof o!="symbol"&&!isNaN(o)&&1<=o?e.setAttribute(r,o):e.removeAttribute(r);break;case"rowSpan":case"start":o==null||typeof o=="function"||typeof o=="symbol"||isNaN(o)?e.removeAttribute(r):e.setAttribute(r,o);break;case"popover":Dt("beforetoggle",e),Dt("toggle",e),hi(e,"popover",o);break;case"xlinkActuate":Ur(e,"http://www.w3.org/1999/xlink","xlink:actuate",o);break;case"xlinkArcrole":Ur(e,"http://www.w3.org/1999/xlink","xlink:arcrole",o);break;case"xlinkRole":Ur(e,"http://www.w3.org/1999/xlink","xlink:role",o);break;case"xlinkShow":Ur(e,"http://www.w3.org/1999/xlink","xlink:show",o);break;case"xlinkTitle":Ur(e,"http://www.w3.org/1999/xlink","xlink:title",o);break;case"xlinkType":Ur(e,"http://www.w3.org/1999/xlink","xlink:type",o);break;case"xmlBase":Ur(e,"http://www.w3.org/XML/1998/namespace","xml:base",o);break;case"xmlLang":Ur(e,"http://www.w3.org/XML/1998/namespace","xml:lang",o);break;case"xmlSpace":Ur(e,"http://www.w3.org/XML/1998/namespace","xml:space",o);break;case"is":hi(e,"is",o);break;case"innerText":case"textContent":break;default:(!(2<r.length)||r[0]!=="o"&&r[0]!=="O"||r[1]!=="n"&&r[1]!=="N")&&(r=vi.get(r)||r,hi(e,r,o))}}function kf(e,t,r,o,h,g){switch(r){case"style":Ll(e,o,g);break;case"dangerouslySetInnerHTML":if(o!=null){if(typeof o!="object"||!("__html"in o))throw Error(i(61));if(r=o.__html,r!=null){if(h.children!=null)throw Error(i(60));e.innerHTML=r}}break;case"children":typeof o=="string"?Ea(e,o):(typeof o=="number"||typeof o=="bigint")&&Ea(e,""+o);break;case"onScroll":o!=null&&Dt("scroll",e);break;case"onScrollEnd":o!=null&&Dt("scrollend",e);break;case"onClick":o!=null&&(e.onclick=In);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!vr.hasOwnProperty(r))e:{if(r[0]==="o"&&r[1]==="n"&&(h=r.endsWith("Capture"),t=r.slice(2,h?r.length-7:void 0),g=e[Bt]||null,g=g!=null?g[r]:null,typeof g=="function"&&e.removeEventListener(t,g,h),typeof o=="function")){typeof g!="function"&&g!==null&&(r in e?e[r]=null:e.hasAttribute(r)&&e.removeAttribute(r)),e.addEventListener(t,o,h);break e}r in e?e[r]=o:o===!0?e.setAttribute(r,""):hi(e,r,o)}}}function Yn(e,t,r){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Dt("error",e),Dt("load",e);var o=!1,h=!1,g;for(g in r)if(r.hasOwnProperty(g)){var A=r[g];if(A!=null)switch(g){case"src":o=!0;break;case"srcSet":h=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(i(137,t));default:Jt(e,t,g,A,r,null)}}h&&Jt(e,t,"srcSet",r.srcSet,r,null),o&&Jt(e,t,"src",r.src,r,null);return;case"input":Dt("invalid",e);var H=g=A=h=null,re=null,_e=null;for(o in r)if(r.hasOwnProperty(o)){var Ne=r[o];if(Ne!=null)switch(o){case"name":h=Ne;break;case"type":A=Ne;break;case"checked":re=Ne;break;case"defaultChecked":_e=Ne;break;case"value":g=Ne;break;case"defaultValue":H=Ne;break;case"children":case"dangerouslySetInnerHTML":if(Ne!=null)throw Error(i(137,t));break;default:Jt(e,t,o,Ne,r,null)}}ns(e,g,H,re,_e,A,h,!1);return;case"select":Dt("invalid",e),o=A=g=null;for(h in r)if(r.hasOwnProperty(h)&&(H=r[h],H!=null))switch(h){case"value":g=H;break;case"defaultValue":A=H;break;case"multiple":o=H;default:Jt(e,t,h,H,r,null)}t=g,r=A,e.multiple=!!o,t!=null?rs(e,!!o,t,!1):r!=null&&rs(e,!!o,r,!0);return;case"textarea":Dt("invalid",e),g=h=o=null;for(A in r)if(r.hasOwnProperty(A)&&(H=r[A],H!=null))switch(A){case"value":o=H;break;case"defaultValue":h=H;break;case"children":g=H;break;case"dangerouslySetInnerHTML":if(H!=null)throw Error(i(91));break;default:Jt(e,t,A,H,r,null)}gi(e,o,h,g);return;case"option":for(re in r)if(r.hasOwnProperty(re)&&(o=r[re],o!=null))switch(re){case"selected":e.selected=o&&typeof o!="function"&&typeof o!="symbol";break;default:Jt(e,t,re,o,r,null)}return;case"dialog":Dt("beforetoggle",e),Dt("toggle",e),Dt("cancel",e),Dt("close",e);break;case"iframe":case"object":Dt("load",e);break;case"video":case"audio":for(o=0;o<Ko.length;o++)Dt(Ko[o],e);break;case"image":Dt("error",e),Dt("load",e);break;case"details":Dt("toggle",e);break;case"embed":case"source":case"link":Dt("error",e),Dt("load",e);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(_e in r)if(r.hasOwnProperty(_e)&&(o=r[_e],o!=null))switch(_e){case"children":case"dangerouslySetInnerHTML":throw Error(i(137,t));default:Jt(e,t,_e,o,r,null)}return;default:if(as(t)){for(Ne in r)r.hasOwnProperty(Ne)&&(o=r[Ne],o!==void 0&&kf(e,t,Ne,o,r,void 0));return}}for(H in r)r.hasOwnProperty(H)&&(o=r[H],o!=null&&Jt(e,t,H,o,r,null))}function Nx(e,t,r,o){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var h=null,g=null,A=null,H=null,re=null,_e=null,Ne=null;for(Ae in r){var Ue=r[Ae];if(r.hasOwnProperty(Ae)&&Ue!=null)switch(Ae){case"checked":break;case"value":break;case"defaultValue":re=Ue;default:o.hasOwnProperty(Ae)||Jt(e,t,Ae,null,o,Ue)}}for(var we in o){var Ae=o[we];if(Ue=r[we],o.hasOwnProperty(we)&&(Ae!=null||Ue!=null))switch(we){case"type":g=Ae;break;case"name":h=Ae;break;case"checked":_e=Ae;break;case"defaultChecked":Ne=Ae;break;case"value":A=Ae;break;case"defaultValue":H=Ae;break;case"children":case"dangerouslySetInnerHTML":if(Ae!=null)throw Error(i(137,t));break;default:Ae!==Ue&&Jt(e,t,we,Ae,o,Ue)}}ts(e,A,H,re,_e,Ne,g,h);return;case"select":Ae=A=H=we=null;for(g in r)if(re=r[g],r.hasOwnProperty(g)&&re!=null)switch(g){case"value":break;case"multiple":Ae=re;default:o.hasOwnProperty(g)||Jt(e,t,g,null,o,re)}for(h in o)if(g=o[h],re=r[h],o.hasOwnProperty(h)&&(g!=null||re!=null))switch(h){case"value":we=g;break;case"defaultValue":H=g;break;case"multiple":A=g;default:g!==re&&Jt(e,t,h,g,o,re)}t=H,r=A,o=Ae,we!=null?rs(e,!!r,we,!1):!!o!=!!r&&(t!=null?rs(e,!!r,t,!0):rs(e,!!r,r?[]:"",!1));return;case"textarea":Ae=we=null;for(H in r)if(h=r[H],r.hasOwnProperty(H)&&h!=null&&!o.hasOwnProperty(H))switch(H){case"value":break;case"children":break;default:Jt(e,t,H,null,o,h)}for(A in o)if(h=o[A],g=r[A],o.hasOwnProperty(A)&&(h!=null||g!=null))switch(A){case"value":we=h;break;case"defaultValue":Ae=h;break;case"children":break;case"dangerouslySetInnerHTML":if(h!=null)throw Error(i(91));break;default:h!==g&&Jt(e,t,A,h,o,g)}go(e,we,Ae);return;case"option":for(var Je in r)if(we=r[Je],r.hasOwnProperty(Je)&&we!=null&&!o.hasOwnProperty(Je))switch(Je){case"selected":e.selected=!1;break;default:Jt(e,t,Je,null,o,we)}for(re in o)if(we=o[re],Ae=r[re],o.hasOwnProperty(re)&&we!==Ae&&(we!=null||Ae!=null))switch(re){case"selected":e.selected=we&&typeof we!="function"&&typeof we!="symbol";break;default:Jt(e,t,re,we,o,Ae)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var dt in r)we=r[dt],r.hasOwnProperty(dt)&&we!=null&&!o.hasOwnProperty(dt)&&Jt(e,t,dt,null,o,we);for(_e in o)if(we=o[_e],Ae=r[_e],o.hasOwnProperty(_e)&&we!==Ae&&(we!=null||Ae!=null))switch(_e){case"children":case"dangerouslySetInnerHTML":if(we!=null)throw Error(i(137,t));break;default:Jt(e,t,_e,we,o,Ae)}return;default:if(as(t)){for(var Xt in r)we=r[Xt],r.hasOwnProperty(Xt)&&we!==void 0&&!o.hasOwnProperty(Xt)&&kf(e,t,Xt,void 0,o,we);for(Ne in o)we=o[Ne],Ae=r[Ne],!o.hasOwnProperty(Ne)||we===Ae||we===void 0&&Ae===void 0||kf(e,t,Ne,we,o,Ae);return}}for(var ye in r)we=r[ye],r.hasOwnProperty(ye)&&we!=null&&!o.hasOwnProperty(ye)&&Jt(e,t,ye,null,o,we);for(Ue in o)we=o[Ue],Ae=r[Ue],!o.hasOwnProperty(Ue)||we===Ae||we==null&&Ae==null||Jt(e,t,Ue,we,o,Ae)}function Hg(e){switch(e){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function Dx(){if(typeof performance.getEntriesByType=="function"){for(var e=0,t=0,r=performance.getEntriesByType("resource"),o=0;o<r.length;o++){var h=r[o],g=h.transferSize,A=h.initiatorType,H=h.duration;if(g&&H&&Hg(A)){for(A=0,H=h.responseEnd,o+=1;o<r.length;o++){var re=r[o],_e=re.startTime;if(_e>H)break;var Ne=re.transferSize,Ue=re.initiatorType;Ne&&Hg(Ue)&&(re=re.responseEnd,A+=Ne*(re<H?1:(H-_e)/(re-_e)))}if(--o,t+=8*(g+A)/(h.duration/1e3),e++,10<e)break}}if(0<e)return t/e/1e6}return navigator.connection&&(e=navigator.connection.downlink,typeof e=="number")?e:5}var Cf=null,Nf=null;function Rc(e){return e.nodeType===9?e:e.ownerDocument}function Gg(e){switch(e){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function qg(e,t){if(e===0)switch(t){case"svg":return 1;case"math":return 2;default:return 0}return e===1&&t==="foreignObject"?0:e}function Df(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.children=="bigint"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var Of=null;function Ox(){var e=window.event;return e&&e.type==="popstate"?e===Of?!1:(Of=e,!0):(Of=null,!1)}var Pg=typeof setTimeout=="function"?setTimeout:void 0,jx=typeof clearTimeout=="function"?clearTimeout:void 0,$g=typeof Promise=="function"?Promise:void 0,Ix=typeof queueMicrotask=="function"?queueMicrotask:typeof $g<"u"?function(e){return $g.resolve(null).then(e).catch(Rx)}:Pg;function Rx(e){setTimeout(function(){throw e})}function Ts(e){return e==="head"}function Yg(e,t){var r=t,o=0;do{var h=r.nextSibling;if(e.removeChild(r),h&&h.nodeType===8)if(r=h.data,r==="/$"||r==="/&"){if(o===0){e.removeChild(h),Zi(t);return}o--}else if(r==="$"||r==="$?"||r==="$~"||r==="$!"||r==="&")o++;else if(r==="html")Qo(e.ownerDocument.documentElement);else if(r==="head"){r=e.ownerDocument.head,Qo(r);for(var g=r.firstChild;g;){var A=g.nextSibling,H=g.nodeName;g[fe]||H==="SCRIPT"||H==="STYLE"||H==="LINK"&&g.rel.toLowerCase()==="stylesheet"||r.removeChild(g),g=A}}else r==="body"&&Qo(e.ownerDocument.body);r=h}while(r);Zi(t)}function Vg(e,t){var r=e;e=0;do{var o=r.nextSibling;if(r.nodeType===1?t?(r._stashedDisplay=r.style.display,r.style.display="none"):(r.style.display=r._stashedDisplay||"",r.getAttribute("style")===""&&r.removeAttribute("style")):r.nodeType===3&&(t?(r._stashedText=r.nodeValue,r.nodeValue=""):r.nodeValue=r._stashedText||""),o&&o.nodeType===8)if(r=o.data,r==="/$"){if(e===0)break;e--}else r!=="$"&&r!=="$?"&&r!=="$~"&&r!=="$!"||e++;r=o}while(r)}function jf(e){var t=e.firstChild;for(t&&t.nodeType===10&&(t=t.nextSibling);t;){var r=t;switch(t=t.nextSibling,r.nodeName){case"HTML":case"HEAD":case"BODY":jf(r),Be(r);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(r.rel.toLowerCase()==="stylesheet")continue}e.removeChild(r)}}function Mx(e,t,r,o){for(;e.nodeType===1;){var h=r;if(e.nodeName.toLowerCase()!==t.toLowerCase()){if(!o&&(e.nodeName!=="INPUT"||e.type!=="hidden"))break}else if(o){if(!e[fe])switch(t){case"meta":if(!e.hasAttribute("itemprop"))break;return e;case"link":if(g=e.getAttribute("rel"),g==="stylesheet"&&e.hasAttribute("data-precedence"))break;if(g!==h.rel||e.getAttribute("href")!==(h.href==null||h.href===""?null:h.href)||e.getAttribute("crossorigin")!==(h.crossOrigin==null?null:h.crossOrigin)||e.getAttribute("title")!==(h.title==null?null:h.title))break;return e;case"style":if(e.hasAttribute("data-precedence"))break;return e;case"script":if(g=e.getAttribute("src"),(g!==(h.src==null?null:h.src)||e.getAttribute("type")!==(h.type==null?null:h.type)||e.getAttribute("crossorigin")!==(h.crossOrigin==null?null:h.crossOrigin))&&g&&e.hasAttribute("async")&&!e.hasAttribute("itemprop"))break;return e;default:return e}}else if(t==="input"&&e.type==="hidden"){var g=h.name==null?null:""+h.name;if(h.type==="hidden"&&e.getAttribute("name")===g)return e}else return e;if(e=$r(e.nextSibling),e===null)break}return null}function Ux(e,t,r){if(t==="")return null;for(;e.nodeType!==3;)if((e.nodeType!==1||e.nodeName!=="INPUT"||e.type!=="hidden")&&!r||(e=$r(e.nextSibling),e===null))return null;return e}function Kg(e,t){for(;e.nodeType!==8;)if((e.nodeType!==1||e.nodeName!=="INPUT"||e.type!=="hidden")&&!t||(e=$r(e.nextSibling),e===null))return null;return e}function If(e){return e.data==="$?"||e.data==="$~"}function Rf(e){return e.data==="$!"||e.data==="$?"&&e.ownerDocument.readyState!=="loading"}function Lx(e,t){var r=e.ownerDocument;if(e.data==="$~")e._reactRetry=t;else if(e.data!=="$?"||r.readyState!=="loading")t();else{var o=function(){t(),r.removeEventListener("DOMContentLoaded",o)};r.addEventListener("DOMContentLoaded",o),e._reactRetry=o}}function $r(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?"||t==="$~"||t==="&"||t==="F!"||t==="F")break;if(t==="/$"||t==="/&")return null}}return e}var Mf=null;function Zg(e){e=e.nextSibling;for(var t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="/$"||r==="/&"){if(t===0)return $r(e.nextSibling);t--}else r!=="$"&&r!=="$!"&&r!=="$?"&&r!=="$~"&&r!=="&"||t++}e=e.nextSibling}return null}function Qg(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="$"||r==="$!"||r==="$?"||r==="$~"||r==="&"){if(t===0)return e;t--}else r!=="/$"&&r!=="/&"||t++}e=e.previousSibling}return null}function Jg(e,t,r){switch(t=Rc(r),e){case"html":if(e=t.documentElement,!e)throw Error(i(452));return e;case"head":if(e=t.head,!e)throw Error(i(453));return e;case"body":if(e=t.body,!e)throw Error(i(454));return e;default:throw Error(i(451))}}function Qo(e){for(var t=e.attributes;t.length;)e.removeAttributeNode(t[0]);Be(e)}var Yr=new Map,Xg=new Set;function Mc(e){return typeof e.getRootNode=="function"?e.getRootNode():e.nodeType===9?e:e.ownerDocument}var Pa=P.d;P.d={f:zx,r:Fx,D:Bx,C:Hx,L:Gx,m:qx,X:$x,S:Px,M:Yx};function zx(){var e=Pa.f(),t=Ac();return e||t}function Fx(e){var t=ft(e);t!==null&&t.tag===5&&t.type==="form"?pp(t):Pa.r(e)}var Yi=typeof document>"u"?null:document;function Wg(e,t,r){var o=Yi;if(o&&typeof t=="string"&&t){var h=Bn(t);h='link[rel="'+e+'"][href="'+h+'"]',typeof r=="string"&&(h+='[crossorigin="'+r+'"]'),Xg.has(h)||(Xg.add(h),e={rel:e,crossOrigin:r,href:t},o.querySelector(h)===null&&(t=o.createElement("link"),Yn(t,"link",e),kt(t),o.head.appendChild(t)))}}function Bx(e){Pa.D(e),Wg("dns-prefetch",e,null)}function Hx(e,t){Pa.C(e,t),Wg("preconnect",e,t)}function Gx(e,t,r){Pa.L(e,t,r);var o=Yi;if(o&&e&&t){var h='link[rel="preload"][as="'+Bn(t)+'"]';t==="image"&&r&&r.imageSrcSet?(h+='[imagesrcset="'+Bn(r.imageSrcSet)+'"]',typeof r.imageSizes=="string"&&(h+='[imagesizes="'+Bn(r.imageSizes)+'"]')):h+='[href="'+Bn(e)+'"]';var g=h;switch(t){case"style":g=Vi(e);break;case"script":g=Ki(e)}Yr.has(g)||(e=_({rel:"preload",href:t==="image"&&r&&r.imageSrcSet?void 0:e,as:t},r),Yr.set(g,e),o.querySelector(h)!==null||t==="style"&&o.querySelector(Jo(g))||t==="script"&&o.querySelector(Xo(g))||(t=o.createElement("link"),Yn(t,"link",e),kt(t),o.head.appendChild(t)))}}function qx(e,t){Pa.m(e,t);var r=Yi;if(r&&e){var o=t&&typeof t.as=="string"?t.as:"script",h='link[rel="modulepreload"][as="'+Bn(o)+'"][href="'+Bn(e)+'"]',g=h;switch(o){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":g=Ki(e)}if(!Yr.has(g)&&(e=_({rel:"modulepreload",href:e},t),Yr.set(g,e),r.querySelector(h)===null)){switch(o){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(r.querySelector(Xo(g)))return}o=r.createElement("link"),Yn(o,"link",e),kt(o),r.head.appendChild(o)}}}function Px(e,t,r){Pa.S(e,t,r);var o=Yi;if(o&&e){var h=nn(o).hoistableStyles,g=Vi(e);t=t||"default";var A=h.get(g);if(!A){var H={loading:0,preload:null};if(A=o.querySelector(Jo(g)))H.loading=5;else{e=_({rel:"stylesheet",href:e,"data-precedence":t},r),(r=Yr.get(g))&&Uf(e,r);var re=A=o.createElement("link");kt(re),Yn(re,"link",e),re._p=new Promise(function(_e,Ne){re.onload=_e,re.onerror=Ne}),re.addEventListener("load",function(){H.loading|=1}),re.addEventListener("error",function(){H.loading|=2}),H.loading|=4,Uc(A,t,o)}A={type:"stylesheet",instance:A,count:1,state:H},h.set(g,A)}}}function $x(e,t){Pa.X(e,t);var r=Yi;if(r&&e){var o=nn(r).hoistableScripts,h=Ki(e),g=o.get(h);g||(g=r.querySelector(Xo(h)),g||(e=_({src:e,async:!0},t),(t=Yr.get(h))&&Lf(e,t),g=r.createElement("script"),kt(g),Yn(g,"link",e),r.head.appendChild(g)),g={type:"script",instance:g,count:1,state:null},o.set(h,g))}}function Yx(e,t){Pa.M(e,t);var r=Yi;if(r&&e){var o=nn(r).hoistableScripts,h=Ki(e),g=o.get(h);g||(g=r.querySelector(Xo(h)),g||(e=_({src:e,async:!0,type:"module"},t),(t=Yr.get(h))&&Lf(e,t),g=r.createElement("script"),kt(g),Yn(g,"link",e),r.head.appendChild(g)),g={type:"script",instance:g,count:1,state:null},o.set(h,g))}}function ey(e,t,r,o){var h=(h=ue.current)?Mc(h):null;if(!h)throw Error(i(446));switch(e){case"meta":case"title":return null;case"style":return typeof r.precedence=="string"&&typeof r.href=="string"?(t=Vi(r.href),r=nn(h).hoistableStyles,o=r.get(t),o||(o={type:"style",instance:null,count:0,state:null},r.set(t,o)),o):{type:"void",instance:null,count:0,state:null};case"link":if(r.rel==="stylesheet"&&typeof r.href=="string"&&typeof r.precedence=="string"){e=Vi(r.href);var g=nn(h).hoistableStyles,A=g.get(e);if(A||(h=h.ownerDocument||h,A={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},g.set(e,A),(g=h.querySelector(Jo(e)))&&!g._p&&(A.instance=g,A.state.loading=5),Yr.has(e)||(r={rel:"preload",as:"style",href:r.href,crossOrigin:r.crossOrigin,integrity:r.integrity,media:r.media,hrefLang:r.hrefLang,referrerPolicy:r.referrerPolicy},Yr.set(e,r),g||Vx(h,e,r,A.state))),t&&o===null)throw Error(i(528,""));return A}if(t&&o!==null)throw Error(i(529,""));return null;case"script":return t=r.async,r=r.src,typeof r=="string"&&t&&typeof t!="function"&&typeof t!="symbol"?(t=Ki(r),r=nn(h).hoistableScripts,o=r.get(t),o||(o={type:"script",instance:null,count:0,state:null},r.set(t,o)),o):{type:"void",instance:null,count:0,state:null};default:throw Error(i(444,e))}}function Vi(e){return'href="'+Bn(e)+'"'}function Jo(e){return'link[rel="stylesheet"]['+e+"]"}function ty(e){return _({},e,{"data-precedence":e.precedence,precedence:null})}function Vx(e,t,r,o){e.querySelector('link[rel="preload"][as="style"]['+t+"]")?o.loading=1:(t=e.createElement("link"),o.preload=t,t.addEventListener("load",function(){return o.loading|=1}),t.addEventListener("error",function(){return o.loading|=2}),Yn(t,"link",r),kt(t),e.head.appendChild(t))}function Ki(e){return'[src="'+Bn(e)+'"]'}function Xo(e){return"script[async]"+e}function ny(e,t,r){if(t.count++,t.instance===null)switch(t.type){case"style":var o=e.querySelector('style[data-href~="'+Bn(r.href)+'"]');if(o)return t.instance=o,kt(o),o;var h=_({},r,{"data-href":r.href,"data-precedence":r.precedence,href:null,precedence:null});return o=(e.ownerDocument||e).createElement("style"),kt(o),Yn(o,"style",h),Uc(o,r.precedence,e),t.instance=o;case"stylesheet":h=Vi(r.href);var g=e.querySelector(Jo(h));if(g)return t.state.loading|=4,t.instance=g,kt(g),g;o=ty(r),(h=Yr.get(h))&&Uf(o,h),g=(e.ownerDocument||e).createElement("link"),kt(g);var A=g;return A._p=new Promise(function(H,re){A.onload=H,A.onerror=re}),Yn(g,"link",o),t.state.loading|=4,Uc(g,r.precedence,e),t.instance=g;case"script":return g=Ki(r.src),(h=e.querySelector(Xo(g)))?(t.instance=h,kt(h),h):(o=r,(h=Yr.get(g))&&(o=_({},r),Lf(o,h)),e=e.ownerDocument||e,h=e.createElement("script"),kt(h),Yn(h,"link",o),e.head.appendChild(h),t.instance=h);case"void":return null;default:throw Error(i(443,t.type))}else t.type==="stylesheet"&&(t.state.loading&4)===0&&(o=t.instance,t.state.loading|=4,Uc(o,r.precedence,e));return t.instance}function Uc(e,t,r){for(var o=r.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),h=o.length?o[o.length-1]:null,g=h,A=0;A<o.length;A++){var H=o[A];if(H.dataset.precedence===t)g=H;else if(g!==h)break}g?g.parentNode.insertBefore(e,g.nextSibling):(t=r.nodeType===9?r.head:r,t.insertBefore(e,t.firstChild))}function Uf(e,t){e.crossOrigin==null&&(e.crossOrigin=t.crossOrigin),e.referrerPolicy==null&&(e.referrerPolicy=t.referrerPolicy),e.title==null&&(e.title=t.title)}function Lf(e,t){e.crossOrigin==null&&(e.crossOrigin=t.crossOrigin),e.referrerPolicy==null&&(e.referrerPolicy=t.referrerPolicy),e.integrity==null&&(e.integrity=t.integrity)}var Lc=null;function ry(e,t,r){if(Lc===null){var o=new Map,h=Lc=new Map;h.set(r,o)}else h=Lc,o=h.get(r),o||(o=new Map,h.set(r,o));if(o.has(e))return o;for(o.set(e,null),r=r.getElementsByTagName(e),h=0;h<r.length;h++){var g=r[h];if(!(g[fe]||g[Yt]||e==="link"&&g.getAttribute("rel")==="stylesheet")&&g.namespaceURI!=="http://www.w3.org/2000/svg"){var A=g.getAttribute(t)||"";A=e+A;var H=o.get(A);H?H.push(g):o.set(A,[g])}}return o}function ay(e,t,r){e=e.ownerDocument||e,e.head.insertBefore(r,t==="title"?e.querySelector("head > title"):null)}function Kx(e,t,r){if(r===1||t.itemProp!=null)return!1;switch(e){case"meta":case"title":return!0;case"style":if(typeof t.precedence!="string"||typeof t.href!="string"||t.href==="")break;return!0;case"link":if(typeof t.rel!="string"||typeof t.href!="string"||t.href===""||t.onLoad||t.onError)break;switch(t.rel){case"stylesheet":return e=t.disabled,typeof t.precedence=="string"&&e==null;default:return!0}case"script":if(t.async&&typeof t.async!="function"&&typeof t.async!="symbol"&&!t.onLoad&&!t.onError&&t.src&&typeof t.src=="string")return!0}return!1}function sy(e){return!(e.type==="stylesheet"&&(e.state.loading&3)===0)}function Zx(e,t,r,o){if(r.type==="stylesheet"&&(typeof o.media!="string"||matchMedia(o.media).matches!==!1)&&(r.state.loading&4)===0){if(r.instance===null){var h=Vi(o.href),g=t.querySelector(Jo(h));if(g){t=g._p,t!==null&&typeof t=="object"&&typeof t.then=="function"&&(e.count++,e=zc.bind(e),t.then(e,e)),r.state.loading|=4,r.instance=g,kt(g);return}g=t.ownerDocument||t,o=ty(o),(h=Yr.get(h))&&Uf(o,h),g=g.createElement("link"),kt(g);var A=g;A._p=new Promise(function(H,re){A.onload=H,A.onerror=re}),Yn(g,"link",o),r.instance=g}e.stylesheets===null&&(e.stylesheets=new Map),e.stylesheets.set(r,t),(t=r.state.preload)&&(r.state.loading&3)===0&&(e.count++,r=zc.bind(e),t.addEventListener("load",r),t.addEventListener("error",r))}}var zf=0;function Qx(e,t){return e.stylesheets&&e.count===0&&Bc(e,e.stylesheets),0<e.count||0<e.imgCount?function(r){var o=setTimeout(function(){if(e.stylesheets&&Bc(e,e.stylesheets),e.unsuspend){var g=e.unsuspend;e.unsuspend=null,g()}},6e4+t);0<e.imgBytes&&zf===0&&(zf=62500*Dx());var h=setTimeout(function(){if(e.waitingForImages=!1,e.count===0&&(e.stylesheets&&Bc(e,e.stylesheets),e.unsuspend)){var g=e.unsuspend;e.unsuspend=null,g()}},(e.imgBytes>zf?50:800)+t);return e.unsuspend=r,function(){e.unsuspend=null,clearTimeout(o),clearTimeout(h)}}:null}function zc(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)Bc(this,this.stylesheets);else if(this.unsuspend){var e=this.unsuspend;this.unsuspend=null,e()}}}var Fc=null;function Bc(e,t){e.stylesheets=null,e.unsuspend!==null&&(e.count++,Fc=new Map,t.forEach(Jx,e),Fc=null,zc.call(e))}function Jx(e,t){if(!(t.state.loading&4)){var r=Fc.get(e);if(r)var o=r.get(null);else{r=new Map,Fc.set(e,r);for(var h=e.querySelectorAll("link[data-precedence],style[data-precedence]"),g=0;g<h.length;g++){var A=h[g];(A.nodeName==="LINK"||A.getAttribute("media")!=="not all")&&(r.set(A.dataset.precedence,A),o=A)}o&&r.set(null,o)}h=t.instance,A=h.getAttribute("data-precedence"),g=r.get(A)||o,g===o&&r.set(null,h),r.set(A,h),this.count++,o=zc.bind(this),h.addEventListener("load",o),h.addEventListener("error",o),g?g.parentNode.insertBefore(h,g.nextSibling):(e=e.nodeType===9?e.head:e,e.insertBefore(h,e.firstChild)),t.state.loading|=4}}var Wo={$$typeof:L,Provider:null,Consumer:null,_currentValue:ve,_currentValue2:ve,_threadCount:0};function Xx(e,t,r,o,h,g,A,H,re){this.tag=1,this.containerInfo=e,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Sn(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Sn(0),this.hiddenUpdates=Sn(null),this.identifierPrefix=o,this.onUncaughtError=h,this.onCaughtError=g,this.onRecoverableError=A,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=re,this.incompleteTransitions=new Map}function iy(e,t,r,o,h,g,A,H,re,_e,Ne,Ue){return e=new Xx(e,t,r,A,re,_e,Ne,Ue,H),t=1,g===!0&&(t|=24),g=_r(3,null,null,t),e.current=g,g.stateNode=e,t=gd(),t.refCount++,e.pooledCache=t,t.refCount++,g.memoizedState={element:o,isDehydrated:r,cache:t},xd(g),e}function oy(e){return e?(e=Ti,e):Ti}function ly(e,t,r,o,h,g){h=oy(h),o.context===null?o.context=h:o.pendingContext=h,o=ms(t),o.payload={element:r},g=g===void 0?null:g,g!==null&&(o.callback=g),r=ps(e,o,t),r!==null&&(pr(r,e,t),Oo(r,e,t))}function cy(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var r=e.retryLane;e.retryLane=r!==0&&r<t?r:t}}function Ff(e,t){cy(e,t),(e=e.alternate)&&cy(e,t)}function uy(e){if(e.tag===13||e.tag===31){var t=$s(e,67108864);t!==null&&pr(t,e,67108864),Ff(e,67108864)}}function dy(e){if(e.tag===13||e.tag===31){var t=Ar();t=An(t);var r=$s(e,t);r!==null&&pr(r,e,t),Ff(e,t)}}var Hc=!0;function Wx(e,t,r,o){var h=K.T;K.T=null;var g=P.p;try{P.p=2,Bf(e,t,r,o)}finally{P.p=g,K.T=h}}function e_(e,t,r,o){var h=K.T;K.T=null;var g=P.p;try{P.p=8,Bf(e,t,r,o)}finally{P.p=g,K.T=h}}function Bf(e,t,r,o){if(Hc){var h=Hf(o);if(h===null)Af(e,t,o,Gc,r),hy(e,o);else if(n_(h,e,t,r,o))o.stopPropagation();else if(hy(e,o),t&4&&-1<t_.indexOf(e)){for(;h!==null;){var g=ft(h);if(g!==null)switch(g.tag){case 3:if(g=g.stateNode,g.current.memoizedState.isDehydrated){var A=vn(g.pendingLanes);if(A!==0){var H=g;for(H.pendingLanes|=2,H.entangledLanes|=2;A;){var re=1<<31-Mt(A);H.entanglements[1]|=re,A&=~re}pa(g),(Pt&6)===0&&(Ec=He()+500,Vo(0))}}break;case 31:case 13:H=$s(g,2),H!==null&&pr(H,g,2),Ac(),Ff(g,2)}if(g=Hf(o),g===null&&Af(e,t,o,Gc,r),g===h)break;h=g}h!==null&&o.stopPropagation()}else Af(e,t,o,null,r)}}function Hf(e){return e=is(e),Gf(e)}var Gc=null;function Gf(e){if(Gc=null,e=Ke(e),e!==null){var t=c(e);if(t===null)e=null;else{var r=t.tag;if(r===13){if(e=d(t),e!==null)return e;e=null}else if(r===31){if(e=m(t),e!==null)return e;e=null}else if(r===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null)}}return Gc=e,null}function fy(e){switch(e){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Oe()){case qe:return 2;case nt:return 8;case We:case Ye:return 32;case St:return 268435456;default:return 32}default:return 32}}var qf=!1,As=null,ks=null,Cs=null,el=new Map,tl=new Map,Ns=[],t_="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function hy(e,t){switch(e){case"focusin":case"focusout":As=null;break;case"dragenter":case"dragleave":ks=null;break;case"mouseover":case"mouseout":Cs=null;break;case"pointerover":case"pointerout":el.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":tl.delete(t.pointerId)}}function nl(e,t,r,o,h,g){return e===null||e.nativeEvent!==g?(e={blockedOn:t,domEventName:r,eventSystemFlags:o,nativeEvent:g,targetContainers:[h]},t!==null&&(t=ft(t),t!==null&&uy(t)),e):(e.eventSystemFlags|=o,t=e.targetContainers,h!==null&&t.indexOf(h)===-1&&t.push(h),e)}function n_(e,t,r,o,h){switch(t){case"focusin":return As=nl(As,e,t,r,o,h),!0;case"dragenter":return ks=nl(ks,e,t,r,o,h),!0;case"mouseover":return Cs=nl(Cs,e,t,r,o,h),!0;case"pointerover":var g=h.pointerId;return el.set(g,nl(el.get(g)||null,e,t,r,o,h)),!0;case"gotpointercapture":return g=h.pointerId,tl.set(g,nl(tl.get(g)||null,e,t,r,o,h)),!0}return!1}function my(e){var t=Ke(e.target);if(t!==null){var r=c(t);if(r!==null){if(t=r.tag,t===13){if(t=d(r),t!==null){e.blockedOn=t,Ls(e.priority,function(){dy(r)});return}}else if(t===31){if(t=m(r),t!==null){e.blockedOn=t,Ls(e.priority,function(){dy(r)});return}}else if(t===3&&r.stateNode.current.memoizedState.isDehydrated){e.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}e.blockedOn=null}function qc(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var r=Hf(e.nativeEvent);if(r===null){r=e.nativeEvent;var o=new r.constructor(r.type,r);ua=o,r.target.dispatchEvent(o),ua=null}else return t=ft(r),t!==null&&uy(t),e.blockedOn=r,!1;t.shift()}return!0}function py(e,t,r){qc(e)&&r.delete(t)}function r_(){qf=!1,As!==null&&qc(As)&&(As=null),ks!==null&&qc(ks)&&(ks=null),Cs!==null&&qc(Cs)&&(Cs=null),el.forEach(py),tl.forEach(py)}function Pc(e,t){e.blockedOn===t&&(e.blockedOn=null,qf||(qf=!0,n.unstable_scheduleCallback(n.unstable_NormalPriority,r_)))}var $c=null;function gy(e){$c!==e&&($c=e,n.unstable_scheduleCallback(n.unstable_NormalPriority,function(){$c===e&&($c=null);for(var t=0;t<e.length;t+=3){var r=e[t],o=e[t+1],h=e[t+2];if(typeof o!="function"){if(Gf(o||r)===null)continue;break}var g=ft(r);g!==null&&(e.splice(t,3),t-=3,Bd(g,{pending:!0,data:h,method:r.method,action:o},o,h))}}))}function Zi(e){function t(re){return Pc(re,e)}As!==null&&Pc(As,e),ks!==null&&Pc(ks,e),Cs!==null&&Pc(Cs,e),el.forEach(t),tl.forEach(t);for(var r=0;r<Ns.length;r++){var o=Ns[r];o.blockedOn===e&&(o.blockedOn=null)}for(;0<Ns.length&&(r=Ns[0],r.blockedOn===null);)my(r),r.blockedOn===null&&Ns.shift();if(r=(e.ownerDocument||e).$$reactFormReplay,r!=null)for(o=0;o<r.length;o+=3){var h=r[o],g=r[o+1],A=h[Bt]||null;if(typeof g=="function")A||gy(r);else if(A){var H=null;if(g&&g.hasAttribute("formAction")){if(h=g,A=g[Bt]||null)H=A.formAction;else if(Gf(h)!==null)continue}else H=A.action;typeof H=="function"?r[o+1]=H:(r.splice(o,3),o-=3),gy(r)}}}function yy(){function e(g){g.canIntercept&&g.info==="react-transition"&&g.intercept({handler:function(){return new Promise(function(A){return h=A})},focusReset:"manual",scroll:"manual"})}function t(){h!==null&&(h(),h=null),o||setTimeout(r,20)}function r(){if(!o&&!navigation.transition){var g=navigation.currentEntry;g&&g.url!=null&&navigation.navigate(g.url,{state:g.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var o=!1,h=null;return navigation.addEventListener("navigate",e),navigation.addEventListener("navigatesuccess",t),navigation.addEventListener("navigateerror",t),setTimeout(r,100),function(){o=!0,navigation.removeEventListener("navigate",e),navigation.removeEventListener("navigatesuccess",t),navigation.removeEventListener("navigateerror",t),h!==null&&(h(),h=null)}}}function Pf(e){this._internalRoot=e}Yc.prototype.render=Pf.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(i(409));var r=t.current,o=Ar();ly(r,o,e,t,null,null)},Yc.prototype.unmount=Pf.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;ly(e.current,2,null,e,null,null),Ac(),t[Mr]=null}};function Yc(e){this._internalRoot=e}Yc.prototype.unstable_scheduleHydration=function(e){if(e){var t=Rr();e={blockedOn:null,target:e,priority:t};for(var r=0;r<Ns.length&&t!==0&&t<Ns[r].priority;r++);Ns.splice(r,0,e),r===0&&my(e)}};var vy=a.version;if(vy!=="19.2.3")throw Error(i(527,vy,"19.2.3"));P.findDOMNode=function(e){var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(i(188)):(e=Object.keys(e).join(","),Error(i(268,e)));return e=f(t),e=e!==null?v(e):null,e=e===null?null:e.stateNode,e};var a_={bundleType:0,version:"19.2.3",rendererPackageName:"react-dom",currentDispatcherRef:K,reconcilerVersion:"19.2.3"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Vc=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Vc.isDisabled&&Vc.supportsFiber)try{mt=Vc.inject(a_),rt=Vc}catch{}}return al.createRoot=function(e,t){if(!l(e))throw Error(i(299));var r=!1,o="",h=Tp,g=Ap,A=kp;return t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(o=t.identifierPrefix),t.onUncaughtError!==void 0&&(h=t.onUncaughtError),t.onCaughtError!==void 0&&(g=t.onCaughtError),t.onRecoverableError!==void 0&&(A=t.onRecoverableError)),t=iy(e,1,!1,null,null,r,o,null,h,g,A,yy),e[Mr]=t.current,Tf(e),new Pf(t)},al.hydrateRoot=function(e,t,r){if(!l(e))throw Error(i(299));var o=!1,h="",g=Tp,A=Ap,H=kp,re=null;return r!=null&&(r.unstable_strictMode===!0&&(o=!0),r.identifierPrefix!==void 0&&(h=r.identifierPrefix),r.onUncaughtError!==void 0&&(g=r.onUncaughtError),r.onCaughtError!==void 0&&(A=r.onCaughtError),r.onRecoverableError!==void 0&&(H=r.onRecoverableError),r.formState!==void 0&&(re=r.formState)),t=iy(e,1,!0,t,r??null,o,h,re,g,A,H,yy),t.context=oy(null),r=t.current,o=Ar(),o=An(o),h=ms(o),h.callback=null,ps(r,h,o),r=o,t.current.lanes=r,yr(t,r),pa(t),e[Mr]=t.current,Tf(e),new Yc(t)},al.version="19.2.3",al}var Cy;function p_(){if(Cy)return Vf.exports;Cy=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(a){console.error(a)}}return n(),Vf.exports=m_(),Vf.exports}var g_=p_();const y_=co(g_),v_={},Ny=n=>{let a;const s=new Set,i=(v,_)=>{const T=typeof v=="function"?v(a):v;if(!Object.is(T,a)){const x=a;a=_??(typeof T!="object"||T===null)?T:Object.assign({},a,T),s.forEach(k=>k(a,x))}},l=()=>a,p={setState:i,getState:l,getInitialState:()=>f,subscribe:v=>(s.add(v),()=>s.delete(v)),destroy:()=>{(v_?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),s.clear()}},f=a=n(i,l,p);return p},b_=n=>n?Ny(n):Ny;var Jf={exports:{}},Xf={},Wf={exports:{}},eh={};/**
 * @license React
 * use-sync-external-store-shim.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Dy;function x_(){if(Dy)return eh;Dy=1;var n=Il();function a(_,T){return _===T&&(_!==0||1/_===1/T)||_!==_&&T!==T}var s=typeof Object.is=="function"?Object.is:a,i=n.useState,l=n.useEffect,c=n.useLayoutEffect,d=n.useDebugValue;function m(_,T){var x=T(),k=i({inst:{value:x,getSnapshot:T}}),w=k[0].inst,S=k[1];return c(function(){w.value=x,w.getSnapshot=T,p(w)&&S({inst:w})},[_,x,T]),l(function(){return p(w)&&S({inst:w}),_(function(){p(w)&&S({inst:w})})},[_]),d(x),x}function p(_){var T=_.getSnapshot;_=_.value;try{var x=T();return!s(_,x)}catch{return!0}}function f(_,T){return T()}var v=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?f:m;return eh.useSyncExternalStore=n.useSyncExternalStore!==void 0?n.useSyncExternalStore:v,eh}var Oy;function __(){return Oy||(Oy=1,Wf.exports=x_()),Wf.exports}/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var jy;function S_(){if(jy)return Xf;jy=1;var n=Il(),a=__();function s(f,v){return f===v&&(f!==0||1/f===1/v)||f!==f&&v!==v}var i=typeof Object.is=="function"?Object.is:s,l=a.useSyncExternalStore,c=n.useRef,d=n.useEffect,m=n.useMemo,p=n.useDebugValue;return Xf.useSyncExternalStoreWithSelector=function(f,v,_,T,x){var k=c(null);if(k.current===null){var w={hasValue:!1,value:null};k.current=w}else w=k.current;k=m(function(){function C(Q){if(!R){if(R=!0,L=Q,Q=T(Q),x!==void 0&&w.hasValue){var U=w.value;if(x(U,Q))return F=U}return F=Q}if(U=F,i(L,Q))return U;var j=T(Q);return x!==void 0&&x(U,j)?U:(L=Q,F=j)}var R=!1,L,F,G=_===void 0?null:_;return[function(){return C(v())},G===null?void 0:function(){return C(G())}]},[v,_,T,x]);var S=l(f,k[0],k[1]);return d(function(){w.hasValue=!0,w.value=S},[S]),p(S),S},Xf}var Iy;function w_(){return Iy||(Iy=1,Jf.exports=S_()),Jf.exports}var E_=w_();const T_=co(E_),yb={},{useDebugValue:A_}=ii,{useSyncExternalStoreWithSelector:k_}=T_;let Ry=!1;const C_=n=>n;function N_(n,a=C_,s){(yb?"production":void 0)!=="production"&&s&&!Ry&&(console.warn("[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"),Ry=!0);const i=k_(n.subscribe,n.getState,n.getServerState||n.getInitialState,a,s);return A_(i),i}const D_=n=>{(yb?"production":void 0)!=="production"&&typeof n!="function"&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");const a=typeof n=="function"?b_(n):n,s=(i,l)=>N_(a,i,l);return Object.assign(s,a),s},O_=n=>D_;var je=(n=>(n.Flashcard="flashcard",n.Quiz="quiz",n.Learning="learning",n))(je||{}),kr=(n=>(n[n.Again=1]="Again",n[n.Hard=2]="Hard",n[n.Good=3]="Good",n[n.Easy=4]="Easy",n))(kr||{}),gl=(n=>(n.CREATE_DECK="CREATE_DECK",n.RENAME_DECK="RENAME_DECK",n.DELETE_DECK="DELETE_DECK",n.MOVE_DECK_TO_FOLDER="MOVE_DECK_TO_FOLDER",n.CREATE_FOLDER="CREATE_FOLDER",n.RENAME_FOLDER="RENAME_FOLDER",n.DELETE_FOLDER="DELETE_FOLDER",n.EXPAND_SERIES_ADD_LEVELS="EXPAND_SERIES_ADD_LEVELS",n.EXPAND_SERIES_ADD_DECKS="EXPAND_SERIES_ADD_DECKS",n.GENERATE_QUESTIONS_FOR_DECK="GENERATE_QUESTIONS_FOR_DECK",n.UPGRADE_TO_LEARNING="UPGRADE_TO_LEARNING",n.REWORK_DECK="REWORK_DECK",n.NO_ACTION="NO_ACTION",n))(gl||{});function j_(n,a){var i,l;const s={...n,lastModified:Date.now()};switch(a.type){case"SET_LOADING":return{...n,isLoading:a.payload};case"SET_SERIES_PROGRESS":return{...n,seriesProgress:a.payload};case"SET_LEARNING_PROGRESS":return{...n,learningProgress:a.payload};case"UPDATE_LEARNING_PROGRESS":return{...n,learningProgress:{...n.learningProgress,[a.payload.deckId]:a.payload}};case"LOAD_DATA":{const c={};a.payload.decks.forEach(p=>c[p.id]=p);const d={};a.payload.folders.forEach(p=>d[p.id]=p);const m={};return a.payload.deckSeries.forEach(p=>m[p.id]=p),{...n,decks:c,folders:d,deckSeries:m,isLoading:!1,lastModified:null}}case"SET_AI_GENERATION_STATUS":return{...n,aiGenerationStatus:{...n.aiGenerationStatus,...a.payload}};case"ADD_AI_TASK_TO_QUEUE":{const c=Array.isArray(n.aiGenerationStatus.queue)?n.aiGenerationStatus.queue:[],d=c.findIndex(m=>m.id===a.payload.id);if(d!==-1){const m=[...c];return m[d]=a.payload,{...n,aiGenerationStatus:{...n.aiGenerationStatus,queue:m}}}return{...n,aiGenerationStatus:{...n.aiGenerationStatus,queue:[...c,a.payload]}}}case"START_NEXT_AI_TASK":{const d=(Array.isArray(n.aiGenerationStatus.queue)?n.aiGenerationStatus.queue:[]).slice(1),{task:m,abortController:p}=a.payload;return{...n,aiGenerationStatus:{...n.aiGenerationStatus,queue:d,currentTask:{...m,abortController:p},isGenerating:!0,chapterPhases:{}}}}case"UPDATE_CURRENT_AI_TASK_STATUS":{if(!n.aiGenerationStatus.currentTask)return n;const{statusText:c,deckId:d,seriesId:m,payload:p}=a.payload,f={...n.aiGenerationStatus.currentTask,statusText:c!==void 0?c:n.aiGenerationStatus.currentTask.statusText,deckId:d!==void 0?d:n.aiGenerationStatus.currentTask.deckId,seriesId:m!==void 0?m:n.aiGenerationStatus.currentTask.seriesId,payload:p!==void 0?p:n.aiGenerationStatus.currentTask.payload};return{...n,aiGenerationStatus:{...n.aiGenerationStatus,currentTask:f}}}case"UPDATE_STREAMING_DRAFT":{const{chapterId:c,text:d}=a.payload;return{...n,aiGenerationStatus:{...n.aiGenerationStatus,streamingDrafts:{...n.aiGenerationStatus.streamingDrafts,[c]:d}}}}case"UPDATE_CHAPTER_PHASE":{const{chapterId:c,phase:d}=a.payload;return{...n,aiGenerationStatus:{...n.aiGenerationStatus,chapterPhases:{...n.aiGenerationStatus.chapterPhases,[c]:d}}}}case"CLEAR_STREAMING_DRAFTS":return{...n,aiGenerationStatus:{...n.aiGenerationStatus,streamingDrafts:{},chapterPhases:{}}};case"FINISH_CURRENT_AI_TASK":return{...n,aiGenerationStatus:{...n.aiGenerationStatus,currentTask:null,isGenerating:!1}};case"CANCEL_AI_TASK":if((i=a.payload)!=null&&i.taskId){const c=Array.isArray(n.aiGenerationStatus.queue)?n.aiGenerationStatus.queue:[];return{...n,aiGenerationStatus:{...n.aiGenerationStatus,queue:c.filter(d=>d.id!==a.payload.taskId)}}}else return(l=n.aiGenerationStatus.currentTask)==null||l.abortController.abort(),{...n,aiGenerationStatus:{...n.aiGenerationStatus,currentTask:null,isGenerating:!1}};case"SET_AI_CHAT_HISTORY":return{...n,aiChatHistory:a.payload};case"ADD_DECKS":{const c={...n.decks};return a.payload.forEach(d=>c[d.id]=d),{...s,decks:c}}case"RESTORE_DATA":{const{decks:c,folders:d,deckSeries:m}=a.payload,p={};c.forEach(_=>p[_.id]=_);const f={};d.forEach(_=>f[_.id]=_);const v={};return m.forEach(_=>v[_.id]=_),{...s,decks:p,folders:f,deckSeries:v,isLoading:!1,lastModified:null}}case"DELETE_DECK":{const c={...n.decks};delete c[a.payload];const d={...n.deckSeries};return Object.keys(d).forEach(m=>{const p=d[m];p.levels&&(d[m]={...p,levels:p.levels.map(f=>({...f,deckIds:(f.deckIds||[]).filter(v=>v!==a.payload)}))})}),{...s,decks:c,deckSeries:d}}case"UPDATE_DECK":return{...s,decks:{...n.decks,[a.payload.id]:a.payload}};case"BULK_UPDATE_DECKS":{const c={...n.decks};return a.payload.forEach(d=>c[d.id]=d),{...s,decks:c}}case"ADD_FOLDER":return{...s,folders:{...n.folders,[a.payload.id]:a.payload}};case"ADD_FOLDERS":{const c={...n.folders};return a.payload.forEach(d=>c[d.id]=d),{...s,folders:c}}case"UPDATE_FOLDER":return{...s,folders:{...n.folders,[a.payload.id]:a.payload}};case"DELETE_FOLDER":{const c={...n.folders};delete c[a.payload];const d={...n.decks};return Object.values(d).forEach(m=>{m.folderId===a.payload&&(d[m.id]={...m,folderId:null})}),{...s,folders:c,decks:d}}case"ADD_SERIES":return{...s,deckSeries:{...n.deckSeries,[a.payload.id]:a.payload}};case"ADD_SERIES_WITH_DECKS":{const{series:c,decks:d}=a.payload,m={...n.decks};return d.forEach(p=>m[p.id]=p),{...s,decks:m,deckSeries:{...n.deckSeries,[c.id]:c}}}case"UPDATE_SERIES":return{...s,deckSeries:{...n.deckSeries,[a.payload.id]:a.payload}};case"DELETE_SERIES":{const c={...n.deckSeries};return delete c[a.payload],{...s,deckSeries:c}}default:return n}}const I_={decks:{},folders:{},deckSeries:{},seriesProgress:new Map,learningProgress:{},isLoading:!0,lastModified:null,aiGenerationStatus:{isGenerating:!1,statusText:null,generatingDeckId:null,generatingSeriesId:null,queue:[],currentTask:null,streamingDrafts:{},chapterPhases:{}},aiChatHistory:[]},Ze=O_()(n=>({...I_,dispatch:a=>n(s=>j_(s,a))})),R_=n=>{const a=new Date;a.setHours(23,59,59,999);const s=(n.type===je.Quiz||n.type==="learning"?n.questions:n.cards)||[];return Array.isArray(s)?s.filter(i=>!i.suspended&&new Date(i.dueDate).getTime()<=a.getTime()).length:0},Fh=()=>Ze(n=>Object.values(n.decks)),M_=()=>Ze(n=>Object.values(n.folders)),Bh=()=>Ze(n=>Object.values(n.deckSeries)),U_=()=>Ze(n=>Object.values(n.deckSeries).filter(a=>!a.archived&&!a.deletedAt)),L_=()=>Ze(n=>{const a=new Set;return Object.values(n.deckSeries).forEach(s=>{(s.levels||[]).forEach(i=>((i==null?void 0:i.deckIds)||[]).forEach(l=>a.add(l)))}),Object.values(n.decks).filter(s=>!s.archived&&!s.deletedAt&&!a.has(s.id))}),z_=()=>Ze(n=>{const a=new Set;return Object.values(n.deckSeries).forEach(s=>{var i;if(!s.archived&&!s.deletedAt){const l=((i=n.seriesProgress.get(s.id))==null?void 0:i.size)||0;let c=0;(s.levels||[]).filter(Boolean).forEach(d=>{(d.deckIds||[]).forEach(m=>{c<=l&&a.add(m),c++})})}}),Object.values(n.decks).reduce((s,i)=>{if(i.archived||i.deletedAt)return s;if(i.type===je.Learning){const c=n.learningProgress[i.id];if(c&&c.unlockedQuestionIds){const d=new Set(c.unlockedQuestionIds),p=(i.questions||[]).filter(f=>d.has(f.id)&&!f.suspended&&new Date(f.dueDate).getTime()<=new Date().setHours(23,59,59,999)).length;return s+p}}return(i.type===je.Quiz||i.type===je.Learning)&&Object.values(n.deckSeries).some(c=>(c.levels||[]).some(d=>{var m;return(m=d.deckIds)==null?void 0:m.includes(i.id)}))&&!a.has(i.id)?s:s+R_(i)},0)}),vb=B.createContext(null),uo=()=>{const n=B.useContext(vb);if(!n)throw new Error("useData must be used within a DataManagementProvider");return n},F_=({children:n,value:a})=>u.jsx(vb.Provider,{value:a,children:n}),B_="modulepreload",H_=function(n){return"/CogniFlow/"+n},My={},jr=function(a,s,i){let l=Promise.resolve();if(s&&s.length>0){let d=function(f){return Promise.all(f.map(v=>Promise.resolve(v).then(_=>({status:"fulfilled",value:_}),_=>({status:"rejected",reason:_}))))};document.getElementsByTagName("link");const m=document.querySelector("meta[property=csp-nonce]"),p=(m==null?void 0:m.nonce)||(m==null?void 0:m.getAttribute("nonce"));l=d(s.map(f=>{if(f=H_(f),f in My)return;My[f]=!0;const v=f.endsWith(".css"),_=v?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${f}"]${_}`))return;const T=document.createElement("link");if(T.rel=v?"stylesheet":B_,v||(T.as="script"),T.crossOrigin="",T.href=f,p&&T.setAttribute("nonce",p),document.head.appendChild(T),v)return new Promise((x,k)=>{T.addEventListener("load",x),T.addEventListener("error",()=>k(new Error(`Unable to preload CSS for ${f}`)))})}))}function c(d){const m=new Event("vite:preloadError",{cancelable:!0});if(m.payload=d,window.dispatchEvent(m),!m.defaultPrevented)throw d}return l.then(d=>{for(const m of d||[])m.status==="rejected"&&c(m.reason);return a().catch(c)})},bb=B.createContext(void 0),th=()=>window.location.hash.startsWith("#/")?window.location.hash.substring(1):"/",G_=({children:n})=>{const[a,s]=B.useState(th()),i=B.useRef([th()]),[l,c]=B.useState(1),d=B.useCallback(()=>{const v=th();s(v);const _=i.current,T=_[_.length-1],x=_[_.length-2];let k=_;v===x?k=_.slice(0,-1):v!==T&&(k=[..._,v]),i.current=k,c(k.length)},[]);B.useEffect(()=>(window.addEventListener("hashchange",d),()=>{window.removeEventListener("hashchange",d)}),[d]);const m=B.useCallback((v,_)=>{const T=`#${v}`;if(_!=null&&_.replace){const x=i.current;if(x.length>0){const k=new URL(window.location.href);k.hash=T,window.location.replace(k.toString());const w=[...x];w[w.length-1]=v,i.current=w;return}}window.location.hash=T},[]),p=B.useCallback(()=>{const v=i.current;if(v.length>1){const _=v[v.length-2];window.location.hash=`#${_}`}else m("/")},[m]),f={path:a,navigate:m,goBack:p,canGoBack:l>1};return u.jsx(bb.Provider,{value:f,children:n})},Ka=()=>{const n=B.useContext(bb);if(n===void 0)throw new Error("useRouter must be used within a RouterProvider");return n},xb=B.createContext(void 0),ga=(n,a)=>{if(typeof window>"u")return a;try{const s=window.localStorage.getItem(n);return s?JSON.parse(s):a}catch(s){return console.error(`Error reading ${n} from localStorage`,s),a}},q_=()=>{if(typeof window>"u")return!1;try{const n=window.localStorage.getItem("cogniflow-aiFeaturesEnabled");return n!==null?JSON.parse(n)===!0:!!(window.location.origin.endsWith("aistudio.google.com")||window.location.origin.endsWith("scf.usercontent.goog"))}catch(n){return console.error("Error reading cogniflow-aiFeaturesEnabled from localStorage",n),!1}},P_=({children:n})=>{const[a,s]=B.useState(()=>ga("cogniflow-disableAnimations",!1)),[i,l]=B.useState(()=>ga("cogniflow-hapticsEnabled",!0)),[c,d]=B.useState(q_),[m,p]=B.useState(()=>ga("cogniflow-veoEnabled",!1)),[f,v]=B.useState(()=>ga("cogniflow-groundedImagesEnabled",!1)),[_,T]=B.useState(()=>ga("cogniflow-searchAuditsEnabled",!1)),[x,k]=B.useState(()=>ga("cogniflow-backupEnabled",!0)),[w,S]=B.useState(()=>{try{return window.localStorage.getItem("cogniflow-backupApiKey")||"qRt+gU/57GHKhxTZeRnRi+dfT274iSkKKq2UnTr9Bxs="}catch{return"qRt+gU/57GHKhxTZeRnRi+dfT274iSkKKq2UnTr9Bxs="}}),[C,R]=B.useState(()=>{try{return window.localStorage.getItem("cogniflow-encryptionPassword")||""}catch{return""}}),[L,F]=B.useState(()=>ga("cogniflow-syncOnCellular",!0)),[G,Q]=B.useState(()=>{try{return window.localStorage.getItem("cogniflow-fontFamily")||"sans"}catch{return"sans"}}),[U,j]=B.useState(()=>ga("cogniflow-notificationsEnabled",!1)),[O,q]=B.useState(()=>ga("cogniflow-leechThreshold",8)),[ee,M]=B.useState(()=>ga("cogniflow-leechAction","suspend")),J=B.useCallback(oe=>{s(oe);try{window.localStorage.setItem("cogniflow-disableAnimations",JSON.stringify(oe))}catch(le){console.error("Error writing animation setting to localStorage",le)}},[]),N=B.useCallback(oe=>{l(oe);try{window.localStorage.setItem("cogniflow-hapticsEnabled",JSON.stringify(oe))}catch(le){console.error("Error writing haptics setting to localStorage",le)}},[]),se=B.useCallback(oe=>{d(oe);try{window.localStorage.setItem("cogniflow-aiFeaturesEnabled",JSON.stringify(oe))}catch(le){console.error("Error writing AI features setting to localStorage",le)}},[]),K=B.useCallback(oe=>{p(oe);try{window.localStorage.setItem("cogniflow-veoEnabled",JSON.stringify(oe))}catch(le){console.error("Error writing veo setting to localStorage",le)}},[]),P=B.useCallback(oe=>{v(oe);try{window.localStorage.setItem("cogniflow-groundedImagesEnabled",JSON.stringify(oe))}catch(le){console.error("Error writing groundedImages setting to localStorage",le)}},[]),ve=B.useCallback(oe=>{T(oe);try{window.localStorage.setItem("cogniflow-searchAuditsEnabled",JSON.stringify(oe))}catch(le){console.error("Error writing searchAudits setting to localStorage",le)}},[]),ce=B.useCallback(oe=>{k(oe);try{window.localStorage.setItem("cogniflow-backupEnabled",JSON.stringify(oe))}catch(le){console.error("Error writing backup enabled setting to localStorage",le)}},[]),Ee=B.useCallback(oe=>{S(oe);try{window.localStorage.setItem("cogniflow-backupApiKey",oe)}catch(le){console.error("Error writing backup API key to localStorage",le)}},[]),z=B.useCallback(oe=>{R(oe);try{oe?window.localStorage.setItem("cogniflow-encryptionPassword",oe):window.localStorage.removeItem("cogniflow-encryptionPassword")}catch(le){console.error("Error writing encryption password to localStorage",le)}},[]),I=B.useCallback(oe=>{F(oe);try{window.localStorage.setItem("cogniflow-syncOnCellular",JSON.stringify(oe))}catch(le){console.error("Error writing syncOnCellular setting to localStorage",le)}},[]),te=B.useCallback(oe=>{Q(oe);try{window.localStorage.setItem("cogniflow-fontFamily",oe)}catch(le){console.error("Error writing fontFamily setting to localStorage",le)}},[]),ae=B.useCallback(oe=>{j(oe);try{window.localStorage.setItem("cogniflow-notificationsEnabled",JSON.stringify(oe)),oe&&"Notification"in window&&Notification.permission!=="granted"&&Notification.requestPermission().then(le=>{le!=="granted"&&(j(!1),window.localStorage.setItem("cogniflow-notificationsEnabled",JSON.stringify(!1)))})}catch(le){console.error("Error writing notifications setting to localStorage",le)}},[]),$=B.useCallback(oe=>{q(oe);try{window.localStorage.setItem("cogniflow-leechThreshold",JSON.stringify(oe))}catch(le){console.error("Error writing leechThreshold to localStorage",le)}},[]),ue=B.useCallback(oe=>{M(oe);try{window.localStorage.setItem("cogniflow-leechAction",JSON.stringify(oe))}catch(le){console.error("Error writing leechAction to localStorage",le)}},[]),de={disableAnimations:a,setDisableAnimations:J,hapticsEnabled:i,setHapticsEnabled:N,aiFeaturesEnabled:c,setAiFeaturesEnabled:se,veoEnabled:m,setVeoEnabled:K,groundedImagesEnabled:f,setGroundedImagesEnabled:P,searchAuditsEnabled:_,setSearchAuditsEnabled:ve,backupEnabled:x,setBackupEnabled:ce,backupApiKey:w,setBackupApiKey:Ee,encryptionPassword:C,setEncryptionPassword:z,syncOnCellular:L,setSyncOnCellular:I,fontFamily:G,setFontFamily:te,notificationsEnabled:U,setNotificationsEnabled:ae,leechThreshold:O,setLeechThreshold:$,leechAction:ee,setLeechAction:ue};return u.jsx(xb.Provider,{value:de,children:n})},Za=()=>{const n=B.useContext(xb);if(n===void 0)throw new Error("useSettings must be used within a SettingsProvider");return n},ra=({href:n,children:a,passAs:s,...i})=>{const{navigate:l}=Ka(),c=m=>{m.currentTarget.tagName==="A"&&(m.metaKey||m.ctrlKey)||(m.preventDefault(),i.onClick&&i.onClick(m),l(n))},d=`#${n}`;return s?u.jsx(s,{...i,onClick:c,children:a}):u.jsx("a",{...i,href:d,onClick:c,children:a})},wh={plus:u.jsxs(u.Fragment,{children:[u.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),u.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]}),"upload-cloud":u.jsxs(u.Fragment,{children:[u.jsx("path",{d:"M20 16.58A5 5 0 0 0 18 7h-1.26A8 8 0 1 0 4 15.25"}),u.jsx("polyline",{points:"16 16 12 12 8 16"}),u.jsx("line",{x1:"12",y1:"12",x2:"12",y2:"21"})]}),x:u.jsxs(u.Fragment,{children:[u.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),u.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]}),"chevron-left":u.jsx(u.Fragment,{children:u.jsx("polyline",{points:"15 18 9 12 15 6"})}),"trash-2":u.jsxs(u.Fragment,{children:[u.jsx("polyline",{points:"3 6 5 6 21 6"}),u.jsx("path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"}),u.jsx("line",{x1:"10",y1:"11",x2:"10",y2:"17"}),u.jsx("line",{x1:"14",y1:"11",x2:"14",y2:"17"})]}),"check-circle":u.jsxs(u.Fragment,{children:[u.jsx("path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14"}),u.jsx("polyline",{points:"22 4 12 14.01 9 11.01"})]}),"x-circle":u.jsxs(u.Fragment,{children:[u.jsx("circle",{cx:"12",cy:"12",r:"10"}),u.jsx("line",{x1:"15",y1:"9",x2:"9",y2:"15"}),u.jsx("line",{x1:"9",y1:"9",x2:"15",y2:"15"})]}),download:u.jsxs(u.Fragment,{children:[u.jsx("path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"}),u.jsx("polyline",{points:"7 10 12 15 17 10"}),u.jsx("line",{x1:"12",y1:"15",x2:"12",y2:"3"})]}),laptop:u.jsxs(u.Fragment,{children:[u.jsx("path",{d:"M20 16V7a2 2 0 0 0-2-2H6a2 2 0 0 0-2 2v9h16z"}),u.jsx("rect",{x:"2",y:"17",width:"20",height:"4",rx:"1"})]}),menu:u.jsxs(u.Fragment,{children:[u.jsx("line",{x1:"3",y1:"12",x2:"21",y2:"12"}),u.jsx("line",{x1:"3",y1:"6",x2:"21",y2:"6"}),u.jsx("line",{x1:"3",y1:"18",x2:"21",y2:"18"})]}),edit:u.jsxs(u.Fragment,{children:[u.jsx("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"}),u.jsx("path",{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"})]}),save:u.jsxs(u.Fragment,{children:[u.jsx("path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"}),u.jsx("polyline",{points:"17 21 17 13 7 13 7 21"}),u.jsx("polyline",{points:"7 3 7 8 15 8"})]}),sun:u.jsxs(u.Fragment,{children:[u.jsx("circle",{cx:"12",cy:"12",r:"5"}),u.jsx("line",{x1:"12",y1:"1",x2:"12",y2:"3"}),u.jsx("line",{x1:"12",y1:"21",x2:"12",y2:"23"}),u.jsx("line",{x1:"4.22",y1:"4.22",x2:"5.64",y2:"5.64"}),u.jsx("line",{x1:"18.36",y1:"18.36",x2:"19.78",y2:"19.78"}),u.jsx("line",{x1:"1",y1:"12",x2:"3",y2:"12"}),u.jsx("line",{x1:"21",y1:"12",x2:"23",y2:"12"}),u.jsx("line",{x1:"4.22",y1:"19.78",x2:"5.64",y2:"18.36"}),u.jsx("line",{x1:"18.36",y1:"5.64",x2:"19.78",y2:"4.22"})]}),moon:u.jsx(u.Fragment,{children:u.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})}),code:u.jsxs(u.Fragment,{children:[u.jsx("polyline",{points:"16 18 22 12 16 6"}),u.jsx("polyline",{points:"8 6 2 12 8 18"})]}),"refresh-ccw":u.jsxs(u.Fragment,{children:[u.jsx("polyline",{points:"1 4 1 10 7 10"}),u.jsx("polyline",{points:"23 20 23 14 17 14"}),u.jsx("path",{d:"M20.49 9A9 9 0 0 0 7.2 6.51"}),u.jsx("path",{d:"M3.51 15A9 9 0 0 0 16.8 17.49"})]}),broom:u.jsx(u.Fragment,{children:u.jsx("path",{d:"M9.59 4.59A2 2 0 1 1 11 8H2m10.59 11.41A2 2 0 1 0 14 16H2m15.73-8.27A2.5 2.5 0 1 1 19.5 12H2"})}),settings:u.jsxs(u.Fragment,{children:[u.jsx("circle",{cx:"12",cy:"12",r:"3"}),u.jsx("path",{d:"M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"})]}),info:u.jsxs(u.Fragment,{children:[u.jsx("circle",{cx:"12",cy:"12",r:"10"}),u.jsx("line",{x1:"12",y1:"16",x2:"12",y2:"12"}),u.jsx("line",{x1:"12",y1:"8",x2:"12.01",y2:"8"})]}),"chevron-down":u.jsx(u.Fragment,{children:u.jsx("polyline",{points:"6 9 12 15 18 9"})}),eye:u.jsxs(u.Fragment,{children:[u.jsx("path",{d:"M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"}),u.jsx("circle",{cx:"12",cy:"12",r:"3"})]}),"eye-off":u.jsxs(u.Fragment,{children:[u.jsx("path",{d:"M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24"}),u.jsx("line",{x1:"1",y1:"1",x2:"23",y2:"23"})]}),zap:u.jsx(u.Fragment,{children:u.jsx("polygon",{points:"13 2 3 14 12 14 11 22 21 10 12 10 13 2"})}),"help-circle":u.jsxs(u.Fragment,{children:[u.jsx("circle",{cx:"12",cy:"12",r:"10"}),u.jsx("path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"}),u.jsx("line",{x1:"12",y1:"17",x2:"12.01",y2:"17"})]}),google:u.jsxs(u.Fragment,{children:[u.jsx("path",{d:"M17.64 9.2c0-.63-.06-1.25-.16-1.84H9v3.48h4.84c-.2 1.12-.84 2.08-1.74 2.71v2.26h2.92c1.7-1.56 2.68-3.88 2.68-6.61z"}),u.jsx("path",{d:"M9 18c2.43 0 4.47-.8 5.96-2.18l-2.92-2.26c-.8.54-1.82.86-3.04.86-2.34 0-4.32-1.58-5.04-3.7H1v2.34C2.64 16.32 5.57 18 9 18z"}),u.jsx("path",{d:"M3.96 10.71c-.18-.54-.28-1.12-.28-1.71s.1-1.17.28-1.71V4.96H1c-.64 1.28-1 2.74-1 4.34s.36 3.06 1 4.34l2.96-2.34z"}),u.jsx("path",{d:"M9 3.6c1.32 0 2.52.45 3.44 1.34l2.6-2.6C13.46.8 11.43 0 9 0 5.57 0 2.64 1.68 1 4.34l2.96 2.34C4.68 4.54 6.66 3.6 9 3.6z"})]}),folder:u.jsx(u.Fragment,{children:u.jsx("path",{d:"M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"})}),"folder-plus":u.jsxs(u.Fragment,{children:[u.jsx("path",{d:"M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"}),u.jsx("line",{x1:"12",y1:"11",x2:"12",y2:"17"}),u.jsx("line",{x1:"9",y1:"14",x2:"15",y2:"14"})]}),"folder-edit":u.jsxs(u.Fragment,{children:[u.jsx("path",{d:"M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"}),u.jsx("path",{d:"M14 13.5l2 2-4 4-2-2 4-4zm-1.5 2.5l2-2"})]}),list:u.jsxs(u.Fragment,{children:[u.jsx("line",{x1:"8",y1:"6",x2:"21",y2:"6"}),u.jsx("line",{x1:"8",y1:"12",x2:"21",y2:"12"}),u.jsx("line",{x1:"8",y1:"18",x2:"21",y2:"18"}),u.jsx("line",{x1:"3",y1:"6",x2:"3.01",y2:"6"}),u.jsx("line",{x1:"3",y1:"12",x2:"3.01",y2:"12"}),u.jsx("line",{x1:"3",y1:"18",x2:"3.01",y2:"18"})]}),lock:u.jsxs(u.Fragment,{children:[u.jsx("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"}),u.jsx("path",{d:"M7 11V7a5 5 0 0 1 10 0v4"})]}),unlock:u.jsxs(u.Fragment,{children:[u.jsx("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"}),u.jsx("path",{d:"M7 11V7a5 5 0 0 1 9.9-1"})]}),archive:u.jsxs(u.Fragment,{children:[u.jsx("polyline",{points:"21 8 21 21 3 21 3 8"}),u.jsx("rect",{x:"1",y:"3",width:"22",height:"5"}),u.jsx("line",{x1:"10",y1:"12",x2:"14",y2:"12"})]}),unarchive:u.jsxs(u.Fragment,{children:[u.jsx("polyline",{points:"21 8 21 21 3 21 3 8"}),u.jsx("rect",{x:"1",y:"3",width:"22",height:"5"}),u.jsx("polyline",{points:"10 13 12 11 14 13"}),u.jsx("line",{x1:"12",y1:"11",x2:"12",y2:"17"})]}),"arrow-down":u.jsxs(u.Fragment,{children:[u.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),u.jsx("polyline",{points:"19 12 12 19 5 12"})]}),monitor:u.jsxs(u.Fragment,{children:[u.jsx("rect",{x:"2",y:"3",width:"20",height:"14",rx:"2",ry:"2"}),u.jsx("line",{x1:"8",y1:"21",x2:"16",y2:"21"}),u.jsx("line",{x1:"12",y1:"17",x2:"12",y2:"21"})]}),"more-vertical":u.jsxs(u.Fragment,{children:[u.jsx("circle",{cx:"12",cy:"12",r:"1"}),u.jsx("circle",{cx:"12",cy:"5",r:"1"}),u.jsx("circle",{cx:"12",cy:"19",r:"1"})]}),search:u.jsxs(u.Fragment,{children:[u.jsx("circle",{cx:"11",cy:"11",r:"8"}),u.jsx("line",{x1:"21",y1:"21",x2:"16.65",y2:"16.65"})]}),filter:u.jsx(u.Fragment,{children:u.jsx("polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3"})}),layers:u.jsxs(u.Fragment,{children:[u.jsx("polygon",{points:"12 2 2 7 12 12 22 7 12 2"}),u.jsx("polyline",{points:"2 17 12 22 22 17"}),u.jsx("polyline",{points:"2 12 12 17 22 12"})]}),terminal:u.jsxs(u.Fragment,{children:[u.jsx("polyline",{points:"4 17 10 11 4 5"}),u.jsx("line",{x1:"12",y1:"19",x2:"20",y2:"19"})]}),"trending-up":u.jsxs(u.Fragment,{children:[u.jsx("polyline",{points:"23 6 13.5 15.5 8.5 10.5 1 18"}),u.jsx("polyline",{points:"17 6 23 6 23 12"})]}),"grip-vertical":u.jsxs(u.Fragment,{children:[u.jsx("circle",{cx:"9",cy:"12",r:"1"}),u.jsx("circle",{cx:"9",cy:"5",r:"1"}),u.jsx("circle",{cx:"9",cy:"19",r:"1"}),u.jsx("circle",{cx:"15",cy:"12",r:"1"}),u.jsx("circle",{cx:"15",cy:"5",r:"1"}),u.jsx("circle",{cx:"15",cy:"19",r:"1"})]}),repeat:u.jsxs(u.Fragment,{children:[u.jsx("polyline",{points:"17 1 21 5 17 9"}),u.jsx("path",{d:"M3 11V9a4 4 0 0 1 4-4h14"}),u.jsx("polyline",{points:"7 23 3 19 7 15"}),u.jsx("path",{d:"M21 13v2a4 4 0 0 1-4 4H3"})]}),bot:u.jsxs(u.Fragment,{children:[u.jsx("rect",{x:"5",y:"10",width:"14",height:"10",rx:"2"}),u.jsx("circle",{cx:"8.5",cy:"15",r:"1"}),u.jsx("circle",{cx:"15.5",cy:"15",r:"1"}),u.jsx("path",{d:"M9 10V4m6 6V4"}),u.jsx("line",{x1:"9",y1:"4",x2:"15",y2:"4"})]}),"book-open":u.jsxs(u.Fragment,{children:[u.jsx("path",{d:"M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z"}),u.jsx("path",{d:"M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z"})]}),"wifi-off":u.jsxs(u.Fragment,{children:[u.jsx("line",{x1:"1",y1:"1",x2:"23",y2:"23"}),u.jsx("path",{d:"M16.72 11.06A10.94 10.94 0 0 1 19 12.55"}),u.jsx("path",{d:"M5 12.55a10.94 10.94 0 0 1 5.17-2.39"}),u.jsx("path",{d:"M10.71 5.05A16 16 0 0 1 22.58 9"}),u.jsx("path",{d:"M1.42 9a15.91 15.91 0 0 1 4.7-2.88"}),u.jsx("path",{d:"M8.53 16.11a6 6 0 0 1 6.95 0"}),u.jsx("line",{x1:"12",y1:"20",x2:"12.01",y2:"20"})]}),link:u.jsxs(u.Fragment,{children:[u.jsx("path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.72"}),u.jsx("path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.72-1.72"})]}),"file-text":u.jsxs(u.Fragment,{children:[u.jsx("path",{d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"}),u.jsx("polyline",{points:"14 2 14 8 20 8"}),u.jsx("line",{x1:"16",y1:"13",x2:"8",y2:"13"}),u.jsx("line",{x1:"16",y1:"17",x2:"8",y2:"17"}),u.jsx("polyline",{points:"10 9 9 9 8 9"})]}),"volume-2":u.jsxs(u.Fragment,{children:[u.jsx("polygon",{points:"11 5 6 9 2 9 2 15 6 15 11 19 11 5"}),u.jsx("path",{d:"M19.07 4.93a10 10 0 0 1 0 14.14M15.54 8.46a5 5 0 0 1 0 7.07"})]}),mic:u.jsxs(u.Fragment,{children:[u.jsx("path",{d:"M12 1a3 3 0 0 0-3 3v8a3 3 0 0 0 6 0V4a3 3 0 0 0-3-3z"}),u.jsx("path",{d:"M19 10v2a7 7 0 0 1-14 0v-2"}),u.jsx("line",{x1:"12",y1:"19",x2:"12",y2:"23"}),u.jsx("line",{x1:"8",y1:"23",x2:"16",y2:"23"})]}),keyboard:u.jsxs(u.Fragment,{children:[u.jsx("rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",ry:"2"}),u.jsx("line",{x1:"6",y1:"12",x2:"6",y2:"12"}),u.jsx("line",{x1:"10",y1:"12",x2:"10",y2:"12"}),u.jsx("line",{x1:"14",y1:"12",x2:"14",y2:"12"}),u.jsx("line",{x1:"18",y1:"12",x2:"18",y2:"12"}),u.jsx("line",{x1:"6",y1:"16",x2:"6",y2:"16"}),u.jsx("line",{x1:"10",y1:"16",x2:"10",y2:"16"}),u.jsx("line",{x1:"14",y1:"16",x2:"14",y2:"16"}),u.jsx("line",{x1:"18",y1:"16",x2:"18",y2:"16"}),u.jsx("line",{x1:"6",y1:"8",x2:"6",y2:"8"}),u.jsx("line",{x1:"10",y1:"8",x2:"10",y2:"8"}),u.jsx("line",{x1:"14",y1:"8",x2:"14",y2:"8"}),u.jsx("line",{x1:"18",y1:"8",x2:"18",y2:"8"})]}),type:u.jsxs(u.Fragment,{children:[u.jsx("polyline",{points:"4 7 4 4 20 4 20 7"}),u.jsx("line",{x1:"9",y1:"20",x2:"15",y2:"20"}),u.jsx("line",{x1:"12",y1:"4",x2:"12",y2:"20"})]}),maximize:u.jsx(u.Fragment,{children:u.jsx("path",{d:"M8 3H5a2 2 0 0 0-2 2v3m18 0V5a2 2 0 0 0-2-2h-3m0 18h3a2 2 0 0 0 2-2v-3M3 16v3a2 2 0 0 0 2 2h3"})}),minimize:u.jsx(u.Fragment,{children:u.jsx("path",{d:"M8 3v3a2 2 0 0 1-2 2H3m18 0h-3a2 2 0 0 1-2-2V3m0 18v-3a2 2 0 0 1 2-2h3M3 16h3a2 2 0 0 1 2 2v3"})}),calendar:u.jsxs(u.Fragment,{children:[u.jsx("rect",{x:"3",y:"4",width:"18",height:"18",rx:"2",ry:"2"}),u.jsx("line",{x1:"16",y1:"2",x2:"16",y2:"6"}),u.jsx("line",{x1:"8",y1:"2",x2:"8",y2:"6"}),u.jsx("line",{x1:"3",y1:"10",x2:"21",y2:"10"})]}),printer:u.jsxs(u.Fragment,{children:[u.jsx("polyline",{points:"6 9 6 2 18 2 18 9"}),u.jsx("path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2"}),u.jsx("rect",{x:"6",y:"14",width:"12",height:"8"})]}),columns:u.jsx(u.Fragment,{children:u.jsx("path",{d:"M12 3h7a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-7m0-18H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h7m0-18v18"})})},YT=Object.keys(wh),ze=({name:n,className:a="w-6 h-6",...s})=>u.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:`${a} pointer-events-none`,...s,children:wh[n]||wh["help-circle"]}),Uy=(n,a)=>{if(!n)return"";const s=String(n);return s.length>a?s.substring(0,a)+"...":s},$_=({items:n})=>{if(!n||n.length<=1)return null;const a=s=>u.jsxs(u.Fragment,{children:[u.jsx("span",{className:"sm:hidden",title:s,children:Uy(s,8)}),u.jsx("span",{className:"hidden sm:inline",title:s,children:Uy(s,25)})]});return u.jsx("nav",{"aria-label":"Breadcrumb",className:"mb-4 sm:mb-6",children:u.jsx("ol",{className:"flex items-center space-x-1 sm:space-x-2 text-xs sm:text-sm text-text-muted flex-wrap",children:n.map((s,i)=>{const l=i===n.length-1;return u.jsxs("li",{className:"flex items-center",children:[i>0&&u.jsx(ze,{name:"chevron-left",className:"w-3 h-3 sm:w-4 sm:h-4 rotate-180 mx-1 sm:mx-2 flex-shrink-0"}),l?u.jsx("span",{className:"font-semibold text-text","aria-current":"page",children:a(s.label)}):u.jsx(ra,{href:s.href,className:"hover:underline hover:text-primary whitespace-nowrap",children:a(s.label)})]},i)})})})},Y_=({children:n})=>u.jsx("div",{className:"animate-fade-in-up",children:n}),mn=({className:n="",variant:a="text",width:s,height:i})=>{const l="animate-pulse bg-gray-200 dark:bg-gray-700/50",c={text:"rounded h-4 w-full",circular:"rounded-full",rectangular:"rounded-md"},d={};return s&&(d.width=s),i&&(d.height=i),u.jsx("div",{className:`${l} ${c[a]} ${n}`,style:d,"aria-hidden":"true"})},Ly=()=>u.jsxs("div",{className:"min-h-screen bg-background",children:[u.jsx("div",{className:"bg-surface/80 border-b border-border h-16 fixed top-0 left-0 right-0 z-20",children:u.jsxs("div",{className:"container mx-auto px-4 h-full flex items-center justify-between",children:[u.jsx(mn,{width:120,height:24}),u.jsxs("div",{className:"flex gap-2",children:[u.jsx(mn,{variant:"circular",width:32,height:32}),u.jsx(mn,{variant:"circular",width:32,height:32})]})]})}),u.jsxs("main",{className:"container mx-auto px-4 pt-24 pb-20",children:[u.jsxs("div",{className:"mb-8 flex flex-wrap gap-4",children:[u.jsx(mn,{variant:"rectangular",width:200,height:48,className:"rounded-lg"}),u.jsx(mn,{variant:"rectangular",width:160,height:48,className:"rounded-lg"})]}),u.jsxs("div",{className:"mb-8",children:[u.jsxs("div",{className:"flex justify-between mb-4",children:[u.jsx(mn,{width:150,height:32}),u.jsx(mn,{width:80,height:32})]}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[u.jsxs("div",{className:"bg-surface rounded-lg shadow-md p-4 border border-transparent h-48 flex flex-col justify-between",children:[u.jsxs("div",{className:"flex gap-4",children:[u.jsx(mn,{variant:"rectangular",width:40,height:40}),u.jsxs("div",{className:"flex-1 space-y-2",children:[u.jsx(mn,{width:"70%",height:24}),u.jsx(mn,{width:"90%",height:16}),u.jsx(mn,{width:"60%",height:16})]})]}),u.jsxs("div",{className:"space-y-2 mt-4",children:[u.jsx(mn,{variant:"rectangular",height:8,className:"rounded-full"}),u.jsx(mn,{variant:"rectangular",height:8,className:"rounded-full"})]})]}),u.jsxs("div",{className:"bg-surface rounded-lg shadow-md p-4 border border-transparent h-48 flex flex-col justify-between",children:[u.jsxs("div",{className:"flex gap-4",children:[u.jsx(mn,{variant:"rectangular",width:40,height:40}),u.jsxs("div",{className:"flex-1 space-y-2",children:[u.jsx(mn,{width:"60%",height:24}),u.jsx(mn,{width:"80%",height:16})]})]}),u.jsxs("div",{className:"space-y-2 mt-4",children:[u.jsx(mn,{variant:"rectangular",height:8,className:"rounded-full"}),u.jsx(mn,{variant:"rectangular",height:8,className:"rounded-full"})]})]})]})]}),u.jsxs("div",{className:"space-y-4",children:[u.jsxs("div",{className:"flex justify-between mb-4",children:[u.jsx(mn,{width:150,height:32}),u.jsx(mn,{width:80,height:32})]}),[1,2,3].map(n=>u.jsxs("div",{className:"bg-surface rounded-lg shadow-md p-4 flex justify-between items-center h-24",children:[u.jsxs("div",{className:"flex gap-4 items-center flex-1",children:[u.jsx(mn,{variant:"circular",width:24,height:24}),u.jsxs("div",{className:"space-y-2 flex-1 max-w-md",children:[u.jsx(mn,{width:"50%",height:20}),u.jsx(mn,{width:"80%",height:14})]})]}),u.jsx(mn,{variant:"rectangular",width:80,height:32,className:"rounded-md"})]},n))]})]})]}),$e=({children:n,variant:a="primary",size:s="md",className:i="",...l})=>{const c="inline-flex items-center justify-center rounded-md font-medium transition-colors focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-background disabled:opacity-50 disabled:pointer-events-none",d={primary:"bg-primary text-on-primary hover:bg-primary-hover focus:ring-primary",secondary:"bg-surface text-text border border-border hover:bg-border/20 focus:ring-primary",danger:"bg-red-600 text-white hover:bg-red-700 focus:ring-red-500",ghost:"text-text-muted hover:bg-border/50 hover:text-text focus:ring-primary"},m={sm:"px-2 py-1 text-xs",md:"px-4 py-2 text-sm",lg:"px-6 py-3 text-base"};return u.jsx("button",{className:`${c} ${d[a]} ${m[s]} ${i}`,...l,children:n})},sl=B.lazy(()=>jr(()=>import("./StudySession-viKbaa-l.js"),__vite__mapDeps([0,1,2,3,4]))),V_=B.lazy(()=>jr(()=>import("./ReaderSession-_Hx9TbSZ.js"),__vite__mapDeps([5,3]))),K_=B.lazy(()=>jr(()=>import("./SettingsPage-BY-_7tjp.js"),__vite__mapDeps([6,4])).then(n=>({default:n.SettingsPage}))),Z_=B.lazy(()=>jr(()=>import("./DeckDetailsPage-DyTvTC5U.js"),__vite__mapDeps([7,1,8]))),Q_=B.lazy(()=>jr(()=>import("./JsonInstructionsPage-BcE-ERep.js"),[])),J_=B.lazy(()=>jr(()=>import("./SeriesOverviewPage-konHt6Zv.js"),__vite__mapDeps([9,10,1,8]))),X_=B.lazy(()=>jr(()=>import("./ArchivePage-CNBOhX_Q.js"),[]).then(n=>({default:n.ArchivePage}))),W_=B.lazy(()=>jr(()=>import("./TrashPage-DlqDoAKU.js"),[])),eS=B.lazy(()=>jr(()=>import("./DashboardPage-BM6LAuBR.js"),__vite__mapDeps([11,12,1,2,10]))),tS=B.lazy(()=>jr(()=>import("./AllDecksPage-BF09E4SE.js"),__vite__mapDeps([13,10,1,14]))),nS=B.lazy(()=>jr(()=>import("./AllSeriesPage-CqkENJqz.js"),__vite__mapDeps([15,12,1,2,14]))),rS=B.lazy(()=>jr(()=>import("./ProgressPage-BlmtmydR.js"),[])),aS=B.lazy(()=>jr(()=>import("./DeckPrintView-DYaS0Qdw.js"),[])),sS=()=>{const{path:n,navigate:a}=Ka(),s=uo(),{activeDeck:i,activeSeries:l,generalStudyDeck:c,sessionsToResume:d,isSyncing:m,lastSyncStatus:p,isGapiReady:f,isGapiSignedIn:v,gapiUser:_,sortPreference:T,setSortPreference:x,draggedDeckId:k,setDraggedDeckId:w,openFolderIds:S,onToggleFolder:C}=s,{aiFeaturesEnabled:R}=Za(),[L]=n.split("?"),F=Bh(),G=L_(),Q=U_(),U=z_(),j=B.useMemo(()=>L.startsWith("/study/")||L.endsWith("/study")||L.endsWith("/cram")||L.endsWith("/study-reversed")||L.endsWith("/study-flip")||L.endsWith("/read"),[L]),O=L.endsWith("/print"),q=B.useMemo(()=>{if(O)return[];const M=[{label:"Home",href:"/"}],J=new URLSearchParams(window.location.hash.split("?")[1]);if(L==="/series")M.push({label:"Series"});else if(L.startsWith("/series/")&&l)M.push({label:"Series",href:"/series"}),M.push({label:l.name||"Series"});else if(L==="/decks")M.push({label:"Decks"});else if(L.startsWith("/decks/")&&i){let N=null;const se=J.get("seriesId");se&&(N=F.find(K=>K.id===se)),N||(N=F.find(K=>!K.deletedAt&&(K.levels||[]).some(P=>{var ve;return(ve=P.deckIds)==null?void 0:ve.includes(i.id)}))),N?(M.push({label:"Series",href:"/series"}),M.push({label:N.name||"Series",href:`/series/${N.id}`})):M.push({label:"Decks",href:"/decks"}),M.push({label:i.name||"Deck"})}else L==="/settings"?M.push({label:"Settings"}):L==="/trash"?M.push({label:"Trash"}):L==="/archive"?M.push({label:"Archive"}):L==="/progress"?M.push({label:"Progress"}):L==="/instructions/json"&&M.push({label:"JSON Guide"});return M},[L,i,l,F,O]),ee=()=>{if(L==="/settings")return u.jsx(K_,{onExport:s.handleExportData,onRestore:()=>s.openModal("restore"),onResetProgress:()=>s.openModal("resetProgress"),onFactoryReset:s.handleFactoryReset,onSync:s.handleManualSync,onForceFetch:s.handleForceFetchFromServer,onForceUpload:s.handleForceUploadToServer,isSyncing:m,lastSyncStatus:p,onManageServerBackups:()=>s.openModal("serverBackup"),onCreateServerBackup:s.handleCreateServerBackup,isGapiReady:f,isGapiSignedIn:v,gapiUser:_,onGoogleSignIn:s.handleGoogleSignIn,onGoogleSignOut:s.handleGoogleSignOut,onBackupToDrive:s.handleBackupToDrive,onRestoreFromDrive:s.openRestoreFromDriveModal,onClearAppCache:s.handleClearAppCache,onClearCdnCache:s.handleClearCdnCache,onRevertLastFetch:s.handleRevertLastFetch});if(L==="/trash")return u.jsx(W_,{onRestoreDeck:s.handleRestoreDeck,onRestoreSeries:s.handleRestoreSeries,onDeleteDeckPermanently:s.handleDeleteDeckPermanently,onDeleteSeriesPermanently:s.handleDeleteSeriesPermanently,openConfirmModal:s.openConfirmModal});if(L==="/archive")return u.jsx(X_,{onUpdateDeck:s.handleUpdateDeck,onUpdateSeries:s.handleUpdateSeries,onDeleteDeck:s.handleDeleteDeck,onDeleteSeries:s.handleDeleteSeries,openConfirmModal:s.openConfirmModal});if(L==="/progress")return u.jsx(rS,{});if(L.startsWith("/series/")&&l)return u.jsx(J_,{series:l,sessionsToResume:d,onUpdateSeries:s.handleUpdateSeries,onDeleteSeries:s.handleDeleteSeries,onAddDeckToSeries:s.handleAddDeckToSeries,onUpdateDeck:s.handleUpdateDeck,onStartSeriesStudy:s.handleStartSeriesStudy,onUpdateLastOpened:s.updateLastOpenedSeries,openConfirmModal:s.openConfirmModal,onAiAddLevelsToSeries:s.handleAiAddLevelsToSeries,onAiAddDecksToLevel:s.handleAiAddDecksToLevel,handleGenerateQuestionsForEmptyDecksInSeries:s.handleGenerateQuestionsForEmptyDecksInSeries,handleGenerateQuestionsForDeck:s.handleGenerateQuestionsForDeck,onCancelAIGeneration:s.handleCancelAIGeneration,onExportSeries:s.handleExportSeries,onDeleteDeck:s.handleDeleteDeck,handleGenerateContentForLearningDeck:s.handleGenerateContentForLearningDeck,onGenerateDeckForLevel:s.handleOpenAIGenerationForSeriesLevel,onAutoExpandSeries:s.handleOpenAIAutoExpandSeries},l.id);if(L==="/study/general"){const M=new URLSearchParams(window.location.hash.split("?")[1]).get("seriesId")||void 0;return c&&u.jsx(sl,{deck:c,seriesId:M,onSessionEnd:s.handleSessionEnd,onItemReviewed:s.handleItemReviewed,onUpdateLastOpened:()=>{},onStudyNextDeck:s.handleStudyNextDeckInSeries},"general-study")}if(L.startsWith("/decks/")&&L.endsWith("/cram")){if(!i)return null;const M=new URLSearchParams(window.location.hash.split("?")[1]),J=M.get("sort")||"random",N=M.get("limit")||"all";let se=((i.type===je.Flashcard?i.cards:i.questions)||[]).filter(ve=>!ve.suspended);if(J==="hardest"?se.sort((ve,ce)=>{const Ee=(ce.lapses||0)-(ve.lapses||0);return Ee!==0?Ee:(ve.easeFactor||2.5)-(ce.easeFactor||2.5)}):J==="newest"?se.reverse():J==="oldest"||se.sort(()=>Math.random()-.5),N!=="all"){const ve=parseInt(N,10);isNaN(ve)||(se=se.slice(0,ve))}const K=i.type===je.Flashcard?{...i,name:`${i.name} (Cram)`,cards:se}:{...i,name:`${i.name} (Cram)`,questions:se},P=M.get("seriesId")||void 0;return u.jsx(sl,{deck:K,seriesId:P,onSessionEnd:s.handleSessionEnd,onItemReviewed:s.handleItemReviewed,onUpdateLastOpened:s.updateLastOpened,sessionKeySuffix:"_cram",onStudyNextDeck:s.handleStudyNextDeckInSeries},`${i.id}-cram`)}if(L.startsWith("/decks/")&&L.endsWith("/study-reversed")){if(!i||i.type!=="flashcard")return null;const M={...i,name:`${i.name} (Reversed)`,cards:(i.cards||[]).map(N=>({...N,front:N.back,back:N.front}))},J=new URLSearchParams(window.location.hash.split("?")[1]).get("seriesId")||void 0;return u.jsx(sl,{deck:M,seriesId:J,onSessionEnd:s.handleSessionEnd,onItemReviewed:s.handleItemReviewed,onUpdateLastOpened:s.updateLastOpened,sessionKeySuffix:"_reversed",onStudyNextDeck:s.handleStudyNextDeckInSeries},`${i.id}-reversed`)}if(L.startsWith("/decks/")&&L.endsWith("/study-flip")){if(!i||i.type!=="quiz"&&i.type!=="learning")return null;const M=i,J=(M.questions||[]).filter(K=>!K.suspended).map(K=>{const P=(K.options||[]).find(ce=>ce.id===K.correctAnswerId),ve=`<div class="text-left w-full"><p class="text-xl"><b>Answer:</b> ${(P==null?void 0:P.text)||"N/A"}</p><hr class="my-4"/><div class="prose prose-sm dark:prose-invert max-w-none">${K.detailedExplanation}</div></div>`;return{...K,front:K.questionText,back:ve}}),N={...M,name:`${M.name} (Review)`,type:je.Flashcard,cards:J.sort(()=>Math.random()-.5)},se=new URLSearchParams(window.location.hash.split("?")[1]).get("seriesId")||void 0;return u.jsx(sl,{deck:N,seriesId:se,onSessionEnd:s.handleSessionEnd,onItemReviewed:s.handleItemReviewed,onUpdateLastOpened:s.updateLastOpened,sessionKeySuffix:"_flip",onStudyNextDeck:s.handleStudyNextDeckInSeries},`${i.id}-flip`)}if(L.startsWith("/decks/")&&L.endsWith("/study")){const M=new URLSearchParams(window.location.hash.split("?")[1]).get("seriesId")||void 0;return i&&u.jsx(sl,{deck:i,seriesId:M,onSessionEnd:s.handleSessionEnd,onItemReviewed:s.handleItemReviewed,onUpdateLastOpened:s.updateLastOpened,onStudyNextDeck:s.handleStudyNextDeckInSeries},i.id)}return L.startsWith("/decks/")&&L.endsWith("/read")?!i||i.type!==je.Learning?null:u.jsx(V_,{deck:i,onExit:()=>a(`/decks/${i.id}`),onPractice:()=>a(`/decks/${i.id}/study`)}):L.startsWith("/decks/")&&L.endsWith("/print")?i&&u.jsx(aS,{deck:i}):L.startsWith("/decks/")?i&&u.jsx(Z_,{deck:i,sessionsToResume:d,onUpdateDeck:s.handleUpdateDeck,onDeleteDeck:s.handleDeleteDeck,onUpdateLastOpened:s.updateLastOpened,openConfirmModal:s.openConfirmModal,handleGenerateQuestionsForDeck:s.handleGenerateQuestionsForDeck,handleGenerateContentForLearningDeck:s.handleGenerateContentForLearningDeck,onCancelAIGeneration:s.handleCancelAIGeneration,onSaveLearningBlock:s.handleSaveLearningBlock,onDeleteLearningBlock:s.handleDeleteLearningBlock,onExportDeck:s.handleExportDeck,onRegenerateQuestion:s.handleRegenerateQuestion,onExpandText:s.handleExpandText,onGenerateAI:()=>s.handleOpenAIGenerationForDeck(i)},i.id):L==="/instructions/json"?u.jsx(Q_,{}):L==="/decks"?u.jsx(tS,{sessionsToResume:d,sortPreference:T,onSortChange:x,onUpdateLastOpened:s.updateLastOpened,onDeleteFolder:s.handleDeleteFolder,draggedDeckId:k,onDragStart:w,onDragEnd:()=>w(null),onMoveDeck:s.handleMoveDeck,openFolderIds:S,onToggleFolder:C,onUpdateDeck:s.handleUpdateDeck,onDeleteDeck:s.handleDeleteDeck,openConfirmModal:s.openConfirmModal,onNewFolder:()=>s.openModal("folder",{folder:"new"}),onImportDecks:()=>s.openModal("import"),onCreateSampleDeck:s.handleCreateSampleDeck,handleSaveFolder:s.handleSaveFolder,handleGenerateQuestionsForDeck:s.handleGenerateQuestionsForDeck,handleGenerateContentForLearningDeck:s.handleGenerateContentForLearningDeck,onCancelAIGeneration:s.handleCancelAIGeneration}):L==="/series"?u.jsx(nS,{onStartSeriesStudy:s.handleStartSeriesStudy,onCreateNewSeries:()=>s.openModal("series",{series:"new"}),onCreateSampleSeries:s.handleCreateSampleSeries,onGenerateAI:()=>s.openModal("aiGeneration"),handleGenerateQuestionsForEmptyDecksInSeries:s.handleGenerateQuestionsForEmptyDecksInSeries,onCancelAIGeneration:s.handleCancelAIGeneration}):G.length>0||Q.length>0?u.jsx(eS,{onGenerateAI:()=>s.openModal("aiGeneration"),totalDueQuestions:U,onStartGeneralStudy:s.handleStartGeneralStudy,sessionsToResume:d,onUpdateLastOpened:s.updateLastOpened,onUpdateDeck:s.handleUpdateDeck,onDeleteDeck:s.handleDeleteDeck,openConfirmModal:s.openConfirmModal,seriesProgress:Ze.getState().seriesProgress,onStartSeriesStudy:s.handleStartSeriesStudy,handleGenerateQuestionsForDeck:s.handleGenerateQuestionsForDeck,handleGenerateContentForLearningDeck:s.handleGenerateContentForLearningDeck,handleGenerateQuestionsForEmptyDecksInSeries:s.handleGenerateQuestionsForEmptyDecksInSeries,onCancelAIGeneration:s.handleCancelAIGeneration,onCreateSampleQuizDeck:s.handleCreateSampleQuizDeck,onCreateSampleFlashcardDeck:s.handleCreateSampleFlashcardDeck,onCreateSampleLearningDeck:s.handleCreateSampleLearningDeck,onCreateSampleSeries:s.handleCreateSampleSeries,onCreateSampleCourse:s.onCreateSampleCourse}):u.jsxs("div",{className:"text-center py-20 max-w-4xl mx-auto",children:[u.jsx("h2",{className:"text-3xl font-bold text-gray-600 dark:text-gray-400",children:"Welcome to CogniFlow"}),u.jsx("p",{className:"mt-4 text-gray-500 dark:text-gray-500",children:"Get started by creating or importing content."}),u.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-center gap-4 mt-8 flex-wrap",children:[R&&u.jsxs($e,{onClick:()=>s.openModal("aiGeneration"),variant:"primary",children:[u.jsx(ze,{name:"zap",className:"w-5 h-5 mr-2"}),"Generate with AI"]}),u.jsxs($e,{onClick:()=>s.openModal("import"),children:[u.jsx(ze,{name:"plus",className:"w-5 h-5 mr-2"}),"Create / Import"]}),u.jsxs($e,{onClick:()=>s.openModal("series",{series:"new"}),variant:"secondary",children:[u.jsx(ze,{name:"layers",className:"w-5 h-5 mr-2"}),"New Series"]}),u.jsxs($e,{onClick:()=>s.openModal("restore"),variant:"secondary",children:[u.jsx(ze,{name:"upload-cloud",className:"w-5 h-5 mr-2"}),"Restore Backup"]})]}),u.jsxs("div",{className:"mt-12 border-t border-border pt-8",children:[u.jsx("h3",{className:"text-lg font-semibold text-text-muted mb-4",children:"Or try a sample:"}),u.jsxs("div",{className:"flex flex-wrap justify-center gap-3",children:[u.jsxs($e,{onClick:s.handleCreateSampleQuizDeck,variant:"ghost",size:"sm",children:[u.jsx(ze,{name:"help-circle",className:"w-4 h-4 mr-2"})," Quiz Deck"]}),u.jsxs($e,{onClick:s.handleCreateSampleFlashcardDeck,variant:"ghost",size:"sm",children:[u.jsx(ze,{name:"laptop",className:"w-4 h-4 mr-2"})," Flashcard Deck"]}),u.jsxs($e,{onClick:s.handleCreateSampleLearningDeck,variant:"ghost",size:"sm",children:[u.jsx(ze,{name:"book-open",className:"w-4 h-4 mr-2"})," Learning Deck"]}),u.jsxs($e,{onClick:s.handleCreateSampleSeries,variant:"ghost",size:"sm",children:[u.jsx(ze,{name:"layers",className:"w-4 h-4 mr-2"})," Series"]})]})]})]})};return j||O?u.jsx(B.Suspense,{fallback:u.jsx(Ly,{}),children:ee()}):u.jsxs(u.Fragment,{children:[u.jsx($_,{items:q}),u.jsx(Y_,{children:u.jsx(B.Suspense,{fallback:u.jsx(Ly,{}),children:ee()})},L)]})},iS=({onOpenMenu:n,onOpenCommandPalette:a,activeDeck:s,isVisible:i})=>{const{path:l,goBack:c,canGoBack:d}=Ka(),[m]=l.split("?"),p=m==="/";let f;if(p)f=u.jsx(ra,{href:"/",className:"no-underline",children:u.jsx("h1",{className:"text-2xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-blue-400 to-teal-300",children:"CogniFlow"})});else{let v="Back";s?v=s.name:m==="/study/general"?v="General Study":m==="/settings"&&(v="Settings"),f=u.jsxs($e,{variant:"ghost",onClick:c,className:"flex items-center space-x-2 -ml-3 min-w-0","aria-label":"Go Back",children:[u.jsx(ze,{name:"chevron-left"}),u.jsx("span",{className:"truncate",children:v})]})}return u.jsx("header",{className:`bg-surface/80 backdrop-blur-sm fixed top-0 left-0 right-0 z-20 border-b border-border transition-transform duration-300 ease-in-out ${i?"translate-y-0":"-translate-y-full"}`,children:u.jsxs("nav",{className:"container mx-auto px-4 sm:px-6 lg:px-8 flex items-center justify-between h-16",children:[u.jsx("div",{className:"flex items-center flex-1 min-w-0",children:f}),u.jsxs("div",{className:"flex items-center space-x-1",children:[u.jsx($e,{variant:"ghost",onClick:a,className:"p-1 h-auto","aria-label":"Open command palette",children:u.jsx(ze,{name:"search"})}),u.jsx($e,{variant:"ghost",onClick:n,className:"p-1 h-auto","aria-label":"Open menu",children:u.jsx(ze,{name:"menu"})})]})]})})},oS='a[href], button:not([disabled]), textarea, input, select, [tabindex]:not([tabindex="-1"])',Mn=(n,a)=>{const s=B.useRef([]);B.useEffect(()=>{if(a&&n.current){s.current=Array.from(n.current.querySelectorAll(oS));const i=s.current[0];i&&setTimeout(()=>i.focus(),100);const l=c=>{var p;if(c.key!=="Tab"||!((p=n.current)!=null&&p.contains(document.activeElement)))return;const d=s.current[0],m=s.current[s.current.length-1];c.shiftKey?document.activeElement===d&&(c.preventDefault(),m==null||m.focus()):document.activeElement===m&&(c.preventDefault(),d==null||d.focus())};return document.addEventListener("keydown",l),()=>{document.removeEventListener("keydown",l)}}},[a,n])},lS=({isOpen:n,onClose:a,onImport:s,onCreateSeries:i,onGenerateAI:l,onInstall:c})=>{const d=B.useRef(null),{aiFeaturesEnabled:m}=Za();return Mn(d,n),B.useEffect(()=>{const p=f=>{f.key==="Escape"&&a()};return n&&document.addEventListener("keydown",p),()=>{document.removeEventListener("keydown",p)}},[n,a]),u.jsxs(u.Fragment,{children:[u.jsx("div",{className:`fixed inset-0 bg-black bg-opacity-60 z-50 transition-opacity duration-300 ${n?"opacity-100":"opacity-0 pointer-events-none"}`,onClick:a,"aria-hidden":"true"}),u.jsx("div",{ref:d,className:`fixed top-0 right-0 h-full w-full max-w-xs z-[51] transform transition-transform duration-300 ease-in-out ${n?"translate-x-0":"translate-x-full"}`,role:"dialog","aria-modal":"true","aria-labelledby":"sidebar-title",children:u.jsxs("div",{className:"bg-surface shadow-xl h-full flex flex-col",children:[u.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-border",children:[u.jsx("h2",{id:"sidebar-title",className:"text-xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-blue-400 to-teal-300",children:"Menu"}),u.jsx($e,{variant:"ghost",onClick:a,className:"p-1 h-auto","aria-label":"Close menu",children:u.jsx(ze,{name:"x"})})]}),u.jsxs("nav",{className:"flex-grow p-4 space-y-2",children:[u.jsxs(ra,{href:"/",onClick:a,className:"flex items-center px-3 py-2 text-text rounded-md hover:bg-border/30 text-lg",children:[u.jsx(ze,{name:"laptop",className:"w-6 h-6 mr-3"})," Home"]}),u.jsxs(ra,{href:"/series",onClick:a,className:"flex items-center px-3 py-2 text-text rounded-md hover:bg-border/30 text-lg",children:[u.jsx(ze,{name:"layers",className:"w-6 h-6 mr-3"})," Series"]}),u.jsxs(ra,{href:"/decks",onClick:a,className:"flex items-center px-3 py-2 text-text rounded-md hover:bg-border/30 text-lg",children:[u.jsx(ze,{name:"folder",className:"w-6 h-6 mr-3"})," Decks"]}),u.jsxs(ra,{href:"/progress",onClick:a,className:"flex items-center px-3 py-2 text-text rounded-md hover:bg-border/30 text-lg",children:[u.jsx(ze,{name:"trending-up",className:"w-6 h-6 mr-3"}),"Progress"]}),u.jsxs(ra,{href:"/archive",onClick:a,className:"flex items-center px-3 py-2 text-text rounded-md hover:bg-border/30 text-lg",children:[u.jsx(ze,{name:"archive",className:"w-6 h-6 mr-3"}),"Archive"]}),u.jsxs(ra,{href:"/trash",onClick:a,className:"flex items-center px-3 py-2 text-text rounded-md hover:bg-border/30 text-lg",children:[u.jsx(ze,{name:"trash-2",className:"w-6 h-6 mr-3"}),"Trash"]}),u.jsxs(ra,{href:"/settings",onClick:a,className:"flex items-center px-3 py-2 text-text rounded-md hover:bg-border/30 text-lg",children:[u.jsx(ze,{name:"settings",className:"w-6 h-6 mr-3"}),"Settings"]}),u.jsxs(ra,{href:"/instructions/json",onClick:a,className:"flex items-center px-3 py-2 text-text rounded-md hover:bg-border/30 text-lg",children:[u.jsx(ze,{name:"help-circle",className:"w-6 h-6 mr-3"}),"JSON Guide"]})]}),u.jsxs("div",{className:"p-4 border-t border-border space-y-2",children:[m&&u.jsxs($e,{variant:"primary",onClick:l,className:"w-full",children:[u.jsx(ze,{name:"zap",className:"w-5 h-5 mr-2"}),"Generate with AI"]}),u.jsxs($e,{variant:"secondary",onClick:i,className:"w-full",children:[u.jsx(ze,{name:"layers",className:"w-5 h-5 mr-2"}),"Create New Series"]}),u.jsxs($e,{variant:"secondary",onClick:s,className:"w-full",children:[u.jsx(ze,{name:"plus",className:"w-5 h-5 mr-2"}),"Create / Import Deck"]}),c&&u.jsxs($e,{variant:"secondary",onClick:c,className:"w-full",children:[u.jsx(ze,{name:"download",className:"w-5 h-5 mr-2"}),"Install App"]})]})]})})]})},_b=B.createContext(void 0),Rl=()=>{const n=B.useContext(_b);if(!n)throw new Error("useModal must be used within a ModalProvider");return n},cS=({children:n})=>{const[a,s]=B.useState({type:null,payload:null}),i=B.useRef(null),l=B.useCallback((d,m={})=>{i.current=document.activeElement,s({type:d,payload:m})},[]),c=B.useCallback(()=>{s({type:null,payload:null}),setTimeout(()=>{var d;return(d=i.current)==null?void 0:d.focus()},100)},[]);return u.jsx(_b.Provider,{value:{modalType:a.type,modalPayload:a.payload,openModal:l,closeModal:c},children:n})},Cr=2.5,Eh=1.3,uS=1,dS=1.2,fS=1.3,hS={1:-.2,2:-.15,3:0,4:.15};function Hh(n,a=null){const s={isValid:!1,parsed:null,errors:[],detailedErrors:[],suggestions:[],fixedJSON:null,schemaIssues:[]};if(!n||typeof n!="string"||n.trim()==="")return s.errors.push("Input must be a non-empty string"),s;let i=null;if(a)try{i=JSON.parse(a)}catch{s.schemaIssues.push({type:"error",path:"Template",message:"The provided Schema/Template JSON is itself invalid and cannot be used for comparison."})}let l=n;try{s.parsed=JSON.parse(l),s.isValid=!0,s.fixedJSON=JSON.stringify(s.parsed,null,2)}catch(c){const d=mS(c,l);s.errors.push(c.message),s.detailedErrors.push(d);const m=yS(l);if(m.success){s.fixedJSON=m.fixed,l=m.fixed,s.suggestions=m.suggestions;try{s.parsed=JSON.parse(l),s.isValid=!0}catch{}}else s.suggestions=m.suggestions}return i&&s.parsed&&s.schemaIssues.push(...Th(s.parsed,i)),s}function Th(n,a,s="$"){const i=[];if(Array.isArray(a))return Array.isArray(n)?(a.length>0&&n.length>0&&i.push(...Th(n[0],a[0],`${s}[0]`)),i):(i.push({type:"error",path:s,message:`Type Mismatch: Expected an array but got ${typeof n}.`}),i);if(typeof a=="object"&&a!==null){if(typeof n!="object"||n===null||Array.isArray(n))return i.push({type:"error",path:s,message:`Type Mismatch: Expected an object but got ${Array.isArray(n)?"array":typeof n}.`}),i;const l=Object.keys(a),c=new Set(Object.keys(n));for(const d of l){const m=`${s}.${d}`;if(!c.has(d))i.push({type:"warning",path:m,message:`Missing Key: The key '${d}' is missing.`});else{const p=Array.isArray(a[d])?"array":typeof a[d],f=Array.isArray(n[d])?"array":typeof n[d];p!==f?i.push({type:"error",path:m,message:`Type Mismatch: Expected type '${p}' but got '${f}'.`}):typeof a[d]=="object"&&a[d]!==null&&i.push(...Th(n[d],a[d],m))}}for(const d of Array.from(c))l.includes(d)||i.push({type:"info",path:`${s}.${d}`,message:`Extra Key: The key '${d}' is present but not in the schema.`});return i}return i}function mS(n,a){var x;const s=n.message,i=a.split(`
`);let l=null,c=null,d="Syntax Error",m="",p="",f="",v;const _=s.match(/at position (\d+)/),T=s.match(/at line (\d+) column (\d+)/i);if(_){const k=parseInt(_[1],10),{line:w,column:S}=pS(a,k);l=w,c=S,m=Zc(i,l-1,c-1);const C=a.substring(0,k).trim();s.includes("Expected property name or '}'")?(d="Invalid Object Key or Trailing Comma",C.endsWith(",")?v='A trailing comma was found. JSON does not allow a comma after the last item in an object. For example, `{"key": "value",}` is invalid. Remove the comma.':v='An object key might be missing or invalid. All keys in JSON must be strings enclosed in double quotes (e.g., `"key": "value"`). Check for unquoted keys or a missing comma.'):s.includes("Unexpected token")&&(f=((x=s.match(/Unexpected token (.+?) in JSON/))==null?void 0:x[1])||"",d="Unexpected Token",(f==="}"||f==="]")&&C.endsWith(",")?(d="Trailing Comma",v='A trailing comma was found. JSON format does not allow a comma after the last item in an array or object. For example, `[1, 2,]` and `{"key":"value",}` are invalid. Remove the final comma.'):f==="'"?(d="Invalid String Quote",v="JSON strings must use double quotes (`\"`). Single quotes (`'`) are not permitted. For example, change `'value'` to `\"value\"`."):f==="="?(d="Invalid Assignment",v="JSON uses a colon (`:`) to separate keys from values, not an equals sign (`=`). This may be a typo (e.g., `:=` instead of just `:`) that needs to be corrected."):f.toLowerCase()==="u"&&a.substring(k).startsWith("undefined")?(d="Invalid Value",v="The value `undefined` is not valid in JSON. This is common when converting JavaScript objects. Use `null` instead or remove the key-value pair."):f.match(/^[a-zA-Z]/)?(d="Unquoted String",v='This looks like an unquoted string, key, or value. All strings and object keys in JSON must be enclosed in double quotes. For example, `{ key: "value" }` should be `{ "key": "value" }`.'):v=`An unexpected character '${f}' was found. This is often caused by a missing comma, a missing colon, or a typo. Please check the syntax around this character.`)}else if(T)l=parseInt(T[1],10),c=parseInt(T[2],10),m=Zc(i,l-1,c-1),s.includes("trailing comma")?(d="Trailing Comma",v="A trailing comma was found. JSON format does not allow a comma after the last item in an object or array. For example, `[1, 2,]` is invalid. Remove the final comma."):s.includes("expected property name")?(d="Invalid Object Key",v='An object key is expected here. All keys in JSON must be strings enclosed in double quotes (e.g., `"key": "value"`). Check for missing quotes or a missing comma before this line.'):s.includes("expected a string")?(d="Invalid String",v="This value was expected to be a string, but it isn't. Remember to wrap all strings in double quotes (`\"`). Single quotes are not allowed. For example, use `\"text\"` instead of `'text'` or `text`."):(d="Syntax Error",v="There is a syntax error at this location. Please check for issues like missing commas (,), colons (:), or mismatched brackets/braces ([]/{}).");else if(s.match(/Unterminated string|Unexpected end of JSON input/i)){const k=gS(a);k.line!==null&&k.column!==null?(d="Unterminated String",l=k.line,c=k.column,m=Zc(i,l-1,c-1),v='An unclosed string was detected. All strings in JSON must be enclosed in double quotes. Check for a missing closing quote (`"`) on this line or a previous one.'):(d="Unexpected End of Input",m=Zc(i,i.length-1),v="The JSON ends unexpectedly. This usually means you are missing a closing brace `}` for an object or a closing bracket `]` for an array.")}return v||(v="The JSON structure is invalid. Please check for common syntax errors like missing commas, incorrect quotes, or mismatched brackets and braces."),{type:d,line:l,column:c,expected:p,actual:f,context:m,message:s,friendlyMessage:v}}function pS(n,a){const s=n.substring(0,a).split(`
`);return{line:s.length,column:s[s.length-1].length+1}}function Zc(n,a,s,i=2){const l=Math.max(0,a-i),c=Math.min(n.length,a+i+1),d=n.slice(l,c);if(s!==void 0&&s>=1&&a>=l&&a<c){const m=a-l,p=" ".repeat(s-1)+"^";d.splice(m+1,0,p)}return d.join(`
`)}function gS(n){const a=n.split(`
`);let s=!1,i="",l=!1,c={line:null,column:null};for(let d=0;d<a.length;d++){const m=a[d];for(let p=0;p<m.length;p++){const f=m[p];if(l){l=!1;continue}if(f==="\\"&&s){l=!0;continue}(f==='"'||f==="'")&&!s?(s=!0,i=f,c={line:d+1,column:p+1}):f===i&&s&&(s=!1)}}return s&&c.line!==null?{...c,context:""}:{line:null,column:null,context:""}}function yS(n){let a=n;const s=new Set,i=bS(a);i.fixes.length>0&&(a=i.fixed,i.fixes.forEach(l=>s.add(l)));try{const l=JSON.parse(a);return{success:!0,fixed:JSON.stringify(l,null,2),suggestions:Array.from(s)}}catch(l){let c=Array.from(s);return l.message.includes("Unterminated string")&&c.push("Attempted to fix an unterminated string. Please review the result."),c.length===0&&c.push("Could not automatically fix JSON errors."),{success:!1,fixed:null,suggestions:c}}}function vS(n){return n.replace(/[\u2018\u2019\u201C\u201D]/g,'"')}function bS(n){const a=[];let s=n.trim();const i=s;s=vS(s),i!==s&&a.push("Replaced smart/typographic quotes with standard double quotes");const l=[{regex:/(:\s*)=/g,replacement:"$1",description:"Replaced invalid assignment operator (e.g. `:=`) with a colon"},{regex:/,\s*([}\]])/g,replacement:"$1",description:"Removed trailing commas"},{regex:/([{,]\s*)([a-zA-Z_$][a-zA-Z0-9_$]*)\s*:/g,replacement:'$1"$2":',description:"Added quotes to unquoted keys"},{regex:/:\s*([^",\s\[\{][^,}\]]*?)(?=\s*[,}])/g,replacement:': "$1"',description:"Added quotes to an unquoted string value"},{regex:/:\s*(undefined|NaN|Infinity|-Infinity)/g,replacement:": null",description:"Replaced `undefined`, `NaN`, or `Infinity` with `null`"},{regex:/"(\s*)"(?!\s*[:],}])/g,replacement:'","',description:"Added missing comma between string values"},{regex:/}(\s*)"/g,replacement:'},"$1"',description:"Added missing comma between an object and a following key"},{regex:/\](\s*)"/g,replacement:'],"$1"',description:"Added missing comma between an array and a following key"},{regex:/\](\s*)\{/g,replacement:"], $1{",description:"Added missing comma between an array and an object"}];for(let c=0;c<3;c++)l.forEach(d=>{const m=s;s=s.replace(d.regex,d.replacement),m!==s&&!a.includes(d.description)&&a.push(d.description)});return{fixed:s,fixes:a}}var Ft;(function(n){n.assertEqual=l=>l;function a(l){}n.assertIs=a;function s(l){throw new Error}n.assertNever=s,n.arrayToEnum=l=>{const c={};for(const d of l)c[d]=d;return c},n.getValidEnumValues=l=>{const c=n.objectKeys(l).filter(m=>typeof l[l[m]]!="number"),d={};for(const m of c)d[m]=l[m];return n.objectValues(d)},n.objectValues=l=>n.objectKeys(l).map(function(c){return l[c]}),n.objectKeys=typeof Object.keys=="function"?l=>Object.keys(l):l=>{const c=[];for(const d in l)Object.prototype.hasOwnProperty.call(l,d)&&c.push(d);return c},n.find=(l,c)=>{for(const d of l)if(c(d))return d},n.isInteger=typeof Number.isInteger=="function"?l=>Number.isInteger(l):l=>typeof l=="number"&&isFinite(l)&&Math.floor(l)===l;function i(l,c=" | "){return l.map(d=>typeof d=="string"?`'${d}'`:d).join(c)}n.joinValues=i,n.jsonStringifyReplacer=(l,c)=>typeof c=="bigint"?c.toString():c})(Ft||(Ft={}));var Ah;(function(n){n.mergeShapes=(a,s)=>({...a,...s})})(Ah||(Ah={}));const Qe=Ft.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),Os=n=>{switch(typeof n){case"undefined":return Qe.undefined;case"string":return Qe.string;case"number":return isNaN(n)?Qe.nan:Qe.number;case"boolean":return Qe.boolean;case"function":return Qe.function;case"bigint":return Qe.bigint;case"symbol":return Qe.symbol;case"object":return Array.isArray(n)?Qe.array:n===null?Qe.null:n.then&&typeof n.then=="function"&&n.catch&&typeof n.catch=="function"?Qe.promise:typeof Map<"u"&&n instanceof Map?Qe.map:typeof Set<"u"&&n instanceof Set?Qe.set:typeof Date<"u"&&n instanceof Date?Qe.date:Qe.object;default:return Qe.unknown}},Ge=Ft.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]),xS=n=>JSON.stringify(n,null,2).replace(/"([^"]+)":/g,"$1:");class Nr extends Error{constructor(a){super(),this.issues=[],this.addIssue=i=>{this.issues=[...this.issues,i]},this.addIssues=(i=[])=>{this.issues=[...this.issues,...i]};const s=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,s):this.__proto__=s,this.name="ZodError",this.issues=a}get errors(){return this.issues}format(a){const s=a||function(c){return c.message},i={_errors:[]},l=c=>{for(const d of c.issues)if(d.code==="invalid_union")d.unionErrors.map(l);else if(d.code==="invalid_return_type")l(d.returnTypeError);else if(d.code==="invalid_arguments")l(d.argumentsError);else if(d.path.length===0)i._errors.push(s(d));else{let m=i,p=0;for(;p<d.path.length;){const f=d.path[p];p===d.path.length-1?(m[f]=m[f]||{_errors:[]},m[f]._errors.push(s(d))):m[f]=m[f]||{_errors:[]},m=m[f],p++}}};return l(this),i}static assert(a){if(!(a instanceof Nr))throw new Error(`Not a ZodError: ${a}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,Ft.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(a=s=>s.message){const s={},i=[];for(const l of this.issues)l.path.length>0?(s[l.path[0]]=s[l.path[0]]||[],s[l.path[0]].push(a(l))):i.push(a(l));return{formErrors:i,fieldErrors:s}}get formErrors(){return this.flatten()}}Nr.create=n=>new Nr(n);const io=(n,a)=>{let s;switch(n.code){case Ge.invalid_type:n.received===Qe.undefined?s="Required":s=`Expected ${n.expected}, received ${n.received}`;break;case Ge.invalid_literal:s=`Invalid literal value, expected ${JSON.stringify(n.expected,Ft.jsonStringifyReplacer)}`;break;case Ge.unrecognized_keys:s=`Unrecognized key(s) in object: ${Ft.joinValues(n.keys,", ")}`;break;case Ge.invalid_union:s="Invalid input";break;case Ge.invalid_union_discriminator:s=`Invalid discriminator value. Expected ${Ft.joinValues(n.options)}`;break;case Ge.invalid_enum_value:s=`Invalid enum value. Expected ${Ft.joinValues(n.options)}, received '${n.received}'`;break;case Ge.invalid_arguments:s="Invalid function arguments";break;case Ge.invalid_return_type:s="Invalid function return type";break;case Ge.invalid_date:s="Invalid date";break;case Ge.invalid_string:typeof n.validation=="object"?"includes"in n.validation?(s=`Invalid input: must include "${n.validation.includes}"`,typeof n.validation.position=="number"&&(s=`${s} at one or more positions greater than or equal to ${n.validation.position}`)):"startsWith"in n.validation?s=`Invalid input: must start with "${n.validation.startsWith}"`:"endsWith"in n.validation?s=`Invalid input: must end with "${n.validation.endsWith}"`:Ft.assertNever(n.validation):n.validation!=="regex"?s=`Invalid ${n.validation}`:s="Invalid";break;case Ge.too_small:n.type==="array"?s=`Array must contain ${n.exact?"exactly":n.inclusive?"at least":"more than"} ${n.minimum} element(s)`:n.type==="string"?s=`String must contain ${n.exact?"exactly":n.inclusive?"at least":"over"} ${n.minimum} character(s)`:n.type==="number"?s=`Number must be ${n.exact?"exactly equal to ":n.inclusive?"greater than or equal to ":"greater than "}${n.minimum}`:n.type==="date"?s=`Date must be ${n.exact?"exactly equal to ":n.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(n.minimum))}`:s="Invalid input";break;case Ge.too_big:n.type==="array"?s=`Array must contain ${n.exact?"exactly":n.inclusive?"at most":"less than"} ${n.maximum} element(s)`:n.type==="string"?s=`String must contain ${n.exact?"exactly":n.inclusive?"at most":"under"} ${n.maximum} character(s)`:n.type==="number"?s=`Number must be ${n.exact?"exactly":n.inclusive?"less than or equal to":"less than"} ${n.maximum}`:n.type==="bigint"?s=`BigInt must be ${n.exact?"exactly":n.inclusive?"less than or equal to":"less than"} ${n.maximum}`:n.type==="date"?s=`Date must be ${n.exact?"exactly":n.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(n.maximum))}`:s="Invalid input";break;case Ge.custom:s="Invalid input";break;case Ge.invalid_intersection_types:s="Intersection results could not be merged";break;case Ge.not_multiple_of:s=`Number must be a multiple of ${n.multipleOf}`;break;case Ge.not_finite:s="Number must be finite";break;default:s=a.defaultError,Ft.assertNever(n)}return{message:s}};let Sb=io;function _S(n){Sb=n}function mu(){return Sb}const pu=n=>{const{data:a,path:s,errorMaps:i,issueData:l}=n,c=[...s,...l.path||[]],d={...l,path:c};if(l.message!==void 0)return{...l,path:c,message:l.message};let m="";const p=i.filter(f=>!!f).slice().reverse();for(const f of p)m=f(d,{data:a,defaultError:m}).message;return{...l,path:c,message:m}},SS=[];function Ve(n,a){const s=mu(),i=pu({issueData:a,data:n.data,path:n.path,errorMaps:[n.common.contextualErrorMap,n.schemaErrorMap,s,s===io?void 0:io].filter(l=>!!l)});n.common.issues.push(i)}class tr{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(a,s){const i=[];for(const l of s){if(l.status==="aborted")return pt;l.status==="dirty"&&a.dirty(),i.push(l.value)}return{status:a.value,value:i}}static async mergeObjectAsync(a,s){const i=[];for(const l of s){const c=await l.key,d=await l.value;i.push({key:c,value:d})}return tr.mergeObjectSync(a,i)}static mergeObjectSync(a,s){const i={};for(const l of s){const{key:c,value:d}=l;if(c.status==="aborted"||d.status==="aborted")return pt;c.status==="dirty"&&a.dirty(),d.status==="dirty"&&a.dirty(),c.value!=="__proto__"&&(typeof d.value<"u"||l.alwaysSet)&&(i[c.value]=d.value)}return{status:a.value,value:i}}}const pt=Object.freeze({status:"aborted"}),to=n=>({status:"dirty",value:n}),ir=n=>({status:"valid",value:n}),kh=n=>n.status==="aborted",Ch=n=>n.status==="dirty",bl=n=>n.status==="valid",xl=n=>typeof Promise<"u"&&n instanceof Promise;function gu(n,a,s,i){if(typeof a=="function"?n!==a||!0:!a.has(n))throw new TypeError("Cannot read private member from an object whose class did not declare it");return a.get(n)}function wb(n,a,s,i,l){if(typeof a=="function"?n!==a||!0:!a.has(n))throw new TypeError("Cannot write private member to an object whose class did not declare it");return a.set(n,s),s}var st;(function(n){n.errToObj=a=>typeof a=="string"?{message:a}:a||{},n.toString=a=>typeof a=="string"?a:a==null?void 0:a.message})(st||(st={}));var fl,hl;class ba{constructor(a,s,i,l){this._cachedPath=[],this.parent=a,this.data=s,this._path=i,this._key=l}get path(){return this._cachedPath.length||(this._key instanceof Array?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const zy=(n,a)=>{if(bl(a))return{success:!0,data:a.value};if(!n.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const s=new Nr(n.common.issues);return this._error=s,this._error}}};function xt(n){if(!n)return{};const{errorMap:a,invalid_type_error:s,required_error:i,description:l}=n;if(a&&(s||i))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return a?{errorMap:a,description:l}:{errorMap:(d,m)=>{var p,f;const{message:v}=n;return d.code==="invalid_enum_value"?{message:v??m.defaultError}:typeof m.data>"u"?{message:(p=v??i)!==null&&p!==void 0?p:m.defaultError}:d.code!=="invalid_type"?{message:m.defaultError}:{message:(f=v??s)!==null&&f!==void 0?f:m.defaultError}},description:l}}class Tt{constructor(a){this.spa=this.safeParseAsync,this._def=a,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this)}get description(){return this._def.description}_getType(a){return Os(a.data)}_getOrReturnCtx(a,s){return s||{common:a.parent.common,data:a.data,parsedType:Os(a.data),schemaErrorMap:this._def.errorMap,path:a.path,parent:a.parent}}_processInputParams(a){return{status:new tr,ctx:{common:a.parent.common,data:a.data,parsedType:Os(a.data),schemaErrorMap:this._def.errorMap,path:a.path,parent:a.parent}}}_parseSync(a){const s=this._parse(a);if(xl(s))throw new Error("Synchronous parse encountered promise.");return s}_parseAsync(a){const s=this._parse(a);return Promise.resolve(s)}parse(a,s){const i=this.safeParse(a,s);if(i.success)return i.data;throw i.error}safeParse(a,s){var i;const l={common:{issues:[],async:(i=s==null?void 0:s.async)!==null&&i!==void 0?i:!1,contextualErrorMap:s==null?void 0:s.errorMap},path:(s==null?void 0:s.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:a,parsedType:Os(a)},c=this._parseSync({data:a,path:l.path,parent:l});return zy(l,c)}async parseAsync(a,s){const i=await this.safeParseAsync(a,s);if(i.success)return i.data;throw i.error}async safeParseAsync(a,s){const i={common:{issues:[],contextualErrorMap:s==null?void 0:s.errorMap,async:!0},path:(s==null?void 0:s.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:a,parsedType:Os(a)},l=this._parse({data:a,path:i.path,parent:i}),c=await(xl(l)?l:Promise.resolve(l));return zy(i,c)}refine(a,s){const i=l=>typeof s=="string"||typeof s>"u"?{message:s}:typeof s=="function"?s(l):s;return this._refinement((l,c)=>{const d=a(l),m=()=>c.addIssue({code:Ge.custom,...i(l)});return typeof Promise<"u"&&d instanceof Promise?d.then(p=>p?!0:(m(),!1)):d?!0:(m(),!1)})}refinement(a,s){return this._refinement((i,l)=>a(i)?!0:(l.addIssue(typeof s=="function"?s(i,l):s),!1))}_refinement(a){return new la({schema:this,typeName:ht.ZodEffects,effect:{type:"refinement",refinement:a}})}superRefine(a){return this._refinement(a)}optional(){return va.create(this,this._def)}nullable(){return Us.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return ia.create(this,this._def)}promise(){return lo.create(this,this._def)}or(a){return El.create([this,a],this._def)}and(a){return Tl.create(this,a,this._def)}transform(a){return new la({...xt(this._def),schema:this,typeName:ht.ZodEffects,effect:{type:"transform",transform:a}})}default(a){const s=typeof a=="function"?a:()=>a;return new Dl({...xt(this._def),innerType:this,defaultValue:s,typeName:ht.ZodDefault})}brand(){return new Gh({typeName:ht.ZodBranded,type:this,...xt(this._def)})}catch(a){const s=typeof a=="function"?a:()=>a;return new Ol({...xt(this._def),innerType:this,catchValue:s,typeName:ht.ZodCatch})}describe(a){const s=this.constructor;return new s({...this._def,description:a})}pipe(a){return Ml.create(this,a)}readonly(){return jl.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const wS=/^c[^\s-]{8,}$/i,ES=/^[0-9a-z]+$/,TS=/^[0-9A-HJKMNP-TV-Z]{26}$/,AS=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,kS=/^[a-z0-9_-]{21}$/i,CS=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,NS=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,DS="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";let nh;const OS=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,jS=/^(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))$/,IS=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,Eb="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",RS=new RegExp(`^${Eb}$`);function Tb(n){let a="([01]\\d|2[0-3]):[0-5]\\d:[0-5]\\d";return n.precision?a=`${a}\\.\\d{${n.precision}}`:n.precision==null&&(a=`${a}(\\.\\d+)?`),a}function MS(n){return new RegExp(`^${Tb(n)}$`)}function Ab(n){let a=`${Eb}T${Tb(n)}`;const s=[];return s.push(n.local?"Z?":"Z"),n.offset&&s.push("([+-]\\d{2}:?\\d{2})"),a=`${a}(${s.join("|")})`,new RegExp(`^${a}$`)}function US(n,a){return!!((a==="v4"||!a)&&OS.test(n)||(a==="v6"||!a)&&jS.test(n))}class sa extends Tt{_parse(a){if(this._def.coerce&&(a.data=String(a.data)),this._getType(a)!==Qe.string){const c=this._getOrReturnCtx(a);return Ve(c,{code:Ge.invalid_type,expected:Qe.string,received:c.parsedType}),pt}const i=new tr;let l;for(const c of this._def.checks)if(c.kind==="min")a.data.length<c.value&&(l=this._getOrReturnCtx(a,l),Ve(l,{code:Ge.too_small,minimum:c.value,type:"string",inclusive:!0,exact:!1,message:c.message}),i.dirty());else if(c.kind==="max")a.data.length>c.value&&(l=this._getOrReturnCtx(a,l),Ve(l,{code:Ge.too_big,maximum:c.value,type:"string",inclusive:!0,exact:!1,message:c.message}),i.dirty());else if(c.kind==="length"){const d=a.data.length>c.value,m=a.data.length<c.value;(d||m)&&(l=this._getOrReturnCtx(a,l),d?Ve(l,{code:Ge.too_big,maximum:c.value,type:"string",inclusive:!0,exact:!0,message:c.message}):m&&Ve(l,{code:Ge.too_small,minimum:c.value,type:"string",inclusive:!0,exact:!0,message:c.message}),i.dirty())}else if(c.kind==="email")NS.test(a.data)||(l=this._getOrReturnCtx(a,l),Ve(l,{validation:"email",code:Ge.invalid_string,message:c.message}),i.dirty());else if(c.kind==="emoji")nh||(nh=new RegExp(DS,"u")),nh.test(a.data)||(l=this._getOrReturnCtx(a,l),Ve(l,{validation:"emoji",code:Ge.invalid_string,message:c.message}),i.dirty());else if(c.kind==="uuid")AS.test(a.data)||(l=this._getOrReturnCtx(a,l),Ve(l,{validation:"uuid",code:Ge.invalid_string,message:c.message}),i.dirty());else if(c.kind==="nanoid")kS.test(a.data)||(l=this._getOrReturnCtx(a,l),Ve(l,{validation:"nanoid",code:Ge.invalid_string,message:c.message}),i.dirty());else if(c.kind==="cuid")wS.test(a.data)||(l=this._getOrReturnCtx(a,l),Ve(l,{validation:"cuid",code:Ge.invalid_string,message:c.message}),i.dirty());else if(c.kind==="cuid2")ES.test(a.data)||(l=this._getOrReturnCtx(a,l),Ve(l,{validation:"cuid2",code:Ge.invalid_string,message:c.message}),i.dirty());else if(c.kind==="ulid")TS.test(a.data)||(l=this._getOrReturnCtx(a,l),Ve(l,{validation:"ulid",code:Ge.invalid_string,message:c.message}),i.dirty());else if(c.kind==="url")try{new URL(a.data)}catch{l=this._getOrReturnCtx(a,l),Ve(l,{validation:"url",code:Ge.invalid_string,message:c.message}),i.dirty()}else c.kind==="regex"?(c.regex.lastIndex=0,c.regex.test(a.data)||(l=this._getOrReturnCtx(a,l),Ve(l,{validation:"regex",code:Ge.invalid_string,message:c.message}),i.dirty())):c.kind==="trim"?a.data=a.data.trim():c.kind==="includes"?a.data.includes(c.value,c.position)||(l=this._getOrReturnCtx(a,l),Ve(l,{code:Ge.invalid_string,validation:{includes:c.value,position:c.position},message:c.message}),i.dirty()):c.kind==="toLowerCase"?a.data=a.data.toLowerCase():c.kind==="toUpperCase"?a.data=a.data.toUpperCase():c.kind==="startsWith"?a.data.startsWith(c.value)||(l=this._getOrReturnCtx(a,l),Ve(l,{code:Ge.invalid_string,validation:{startsWith:c.value},message:c.message}),i.dirty()):c.kind==="endsWith"?a.data.endsWith(c.value)||(l=this._getOrReturnCtx(a,l),Ve(l,{code:Ge.invalid_string,validation:{endsWith:c.value},message:c.message}),i.dirty()):c.kind==="datetime"?Ab(c).test(a.data)||(l=this._getOrReturnCtx(a,l),Ve(l,{code:Ge.invalid_string,validation:"datetime",message:c.message}),i.dirty()):c.kind==="date"?RS.test(a.data)||(l=this._getOrReturnCtx(a,l),Ve(l,{code:Ge.invalid_string,validation:"date",message:c.message}),i.dirty()):c.kind==="time"?MS(c).test(a.data)||(l=this._getOrReturnCtx(a,l),Ve(l,{code:Ge.invalid_string,validation:"time",message:c.message}),i.dirty()):c.kind==="duration"?CS.test(a.data)||(l=this._getOrReturnCtx(a,l),Ve(l,{validation:"duration",code:Ge.invalid_string,message:c.message}),i.dirty()):c.kind==="ip"?US(a.data,c.version)||(l=this._getOrReturnCtx(a,l),Ve(l,{validation:"ip",code:Ge.invalid_string,message:c.message}),i.dirty()):c.kind==="base64"?IS.test(a.data)||(l=this._getOrReturnCtx(a,l),Ve(l,{validation:"base64",code:Ge.invalid_string,message:c.message}),i.dirty()):Ft.assertNever(c);return{status:i.value,value:a.data}}_regex(a,s,i){return this.refinement(l=>a.test(l),{validation:s,code:Ge.invalid_string,...st.errToObj(i)})}_addCheck(a){return new sa({...this._def,checks:[...this._def.checks,a]})}email(a){return this._addCheck({kind:"email",...st.errToObj(a)})}url(a){return this._addCheck({kind:"url",...st.errToObj(a)})}emoji(a){return this._addCheck({kind:"emoji",...st.errToObj(a)})}uuid(a){return this._addCheck({kind:"uuid",...st.errToObj(a)})}nanoid(a){return this._addCheck({kind:"nanoid",...st.errToObj(a)})}cuid(a){return this._addCheck({kind:"cuid",...st.errToObj(a)})}cuid2(a){return this._addCheck({kind:"cuid2",...st.errToObj(a)})}ulid(a){return this._addCheck({kind:"ulid",...st.errToObj(a)})}base64(a){return this._addCheck({kind:"base64",...st.errToObj(a)})}ip(a){return this._addCheck({kind:"ip",...st.errToObj(a)})}datetime(a){var s,i;return typeof a=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:a}):this._addCheck({kind:"datetime",precision:typeof(a==null?void 0:a.precision)>"u"?null:a==null?void 0:a.precision,offset:(s=a==null?void 0:a.offset)!==null&&s!==void 0?s:!1,local:(i=a==null?void 0:a.local)!==null&&i!==void 0?i:!1,...st.errToObj(a==null?void 0:a.message)})}date(a){return this._addCheck({kind:"date",message:a})}time(a){return typeof a=="string"?this._addCheck({kind:"time",precision:null,message:a}):this._addCheck({kind:"time",precision:typeof(a==null?void 0:a.precision)>"u"?null:a==null?void 0:a.precision,...st.errToObj(a==null?void 0:a.message)})}duration(a){return this._addCheck({kind:"duration",...st.errToObj(a)})}regex(a,s){return this._addCheck({kind:"regex",regex:a,...st.errToObj(s)})}includes(a,s){return this._addCheck({kind:"includes",value:a,position:s==null?void 0:s.position,...st.errToObj(s==null?void 0:s.message)})}startsWith(a,s){return this._addCheck({kind:"startsWith",value:a,...st.errToObj(s)})}endsWith(a,s){return this._addCheck({kind:"endsWith",value:a,...st.errToObj(s)})}min(a,s){return this._addCheck({kind:"min",value:a,...st.errToObj(s)})}max(a,s){return this._addCheck({kind:"max",value:a,...st.errToObj(s)})}length(a,s){return this._addCheck({kind:"length",value:a,...st.errToObj(s)})}nonempty(a){return this.min(1,st.errToObj(a))}trim(){return new sa({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new sa({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new sa({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(a=>a.kind==="datetime")}get isDate(){return!!this._def.checks.find(a=>a.kind==="date")}get isTime(){return!!this._def.checks.find(a=>a.kind==="time")}get isDuration(){return!!this._def.checks.find(a=>a.kind==="duration")}get isEmail(){return!!this._def.checks.find(a=>a.kind==="email")}get isURL(){return!!this._def.checks.find(a=>a.kind==="url")}get isEmoji(){return!!this._def.checks.find(a=>a.kind==="emoji")}get isUUID(){return!!this._def.checks.find(a=>a.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(a=>a.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(a=>a.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(a=>a.kind==="cuid2")}get isULID(){return!!this._def.checks.find(a=>a.kind==="ulid")}get isIP(){return!!this._def.checks.find(a=>a.kind==="ip")}get isBase64(){return!!this._def.checks.find(a=>a.kind==="base64")}get minLength(){let a=null;for(const s of this._def.checks)s.kind==="min"&&(a===null||s.value>a)&&(a=s.value);return a}get maxLength(){let a=null;for(const s of this._def.checks)s.kind==="max"&&(a===null||s.value<a)&&(a=s.value);return a}}sa.create=n=>{var a;return new sa({checks:[],typeName:ht.ZodString,coerce:(a=n==null?void 0:n.coerce)!==null&&a!==void 0?a:!1,...xt(n)})};function LS(n,a){const s=(n.toString().split(".")[1]||"").length,i=(a.toString().split(".")[1]||"").length,l=s>i?s:i,c=parseInt(n.toFixed(l).replace(".","")),d=parseInt(a.toFixed(l).replace(".",""));return c%d/Math.pow(10,l)}class Is extends Tt{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(a){if(this._def.coerce&&(a.data=Number(a.data)),this._getType(a)!==Qe.number){const c=this._getOrReturnCtx(a);return Ve(c,{code:Ge.invalid_type,expected:Qe.number,received:c.parsedType}),pt}let i;const l=new tr;for(const c of this._def.checks)c.kind==="int"?Ft.isInteger(a.data)||(i=this._getOrReturnCtx(a,i),Ve(i,{code:Ge.invalid_type,expected:"integer",received:"float",message:c.message}),l.dirty()):c.kind==="min"?(c.inclusive?a.data<c.value:a.data<=c.value)&&(i=this._getOrReturnCtx(a,i),Ve(i,{code:Ge.too_small,minimum:c.value,type:"number",inclusive:c.inclusive,exact:!1,message:c.message}),l.dirty()):c.kind==="max"?(c.inclusive?a.data>c.value:a.data>=c.value)&&(i=this._getOrReturnCtx(a,i),Ve(i,{code:Ge.too_big,maximum:c.value,type:"number",inclusive:c.inclusive,exact:!1,message:c.message}),l.dirty()):c.kind==="multipleOf"?LS(a.data,c.value)!==0&&(i=this._getOrReturnCtx(a,i),Ve(i,{code:Ge.not_multiple_of,multipleOf:c.value,message:c.message}),l.dirty()):c.kind==="finite"?Number.isFinite(a.data)||(i=this._getOrReturnCtx(a,i),Ve(i,{code:Ge.not_finite,message:c.message}),l.dirty()):Ft.assertNever(c);return{status:l.value,value:a.data}}gte(a,s){return this.setLimit("min",a,!0,st.toString(s))}gt(a,s){return this.setLimit("min",a,!1,st.toString(s))}lte(a,s){return this.setLimit("max",a,!0,st.toString(s))}lt(a,s){return this.setLimit("max",a,!1,st.toString(s))}setLimit(a,s,i,l){return new Is({...this._def,checks:[...this._def.checks,{kind:a,value:s,inclusive:i,message:st.toString(l)}]})}_addCheck(a){return new Is({...this._def,checks:[...this._def.checks,a]})}int(a){return this._addCheck({kind:"int",message:st.toString(a)})}positive(a){return this._addCheck({kind:"min",value:0,inclusive:!1,message:st.toString(a)})}negative(a){return this._addCheck({kind:"max",value:0,inclusive:!1,message:st.toString(a)})}nonpositive(a){return this._addCheck({kind:"max",value:0,inclusive:!0,message:st.toString(a)})}nonnegative(a){return this._addCheck({kind:"min",value:0,inclusive:!0,message:st.toString(a)})}multipleOf(a,s){return this._addCheck({kind:"multipleOf",value:a,message:st.toString(s)})}finite(a){return this._addCheck({kind:"finite",message:st.toString(a)})}safe(a){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:st.toString(a)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:st.toString(a)})}get minValue(){let a=null;for(const s of this._def.checks)s.kind==="min"&&(a===null||s.value>a)&&(a=s.value);return a}get maxValue(){let a=null;for(const s of this._def.checks)s.kind==="max"&&(a===null||s.value<a)&&(a=s.value);return a}get isInt(){return!!this._def.checks.find(a=>a.kind==="int"||a.kind==="multipleOf"&&Ft.isInteger(a.value))}get isFinite(){let a=null,s=null;for(const i of this._def.checks){if(i.kind==="finite"||i.kind==="int"||i.kind==="multipleOf")return!0;i.kind==="min"?(s===null||i.value>s)&&(s=i.value):i.kind==="max"&&(a===null||i.value<a)&&(a=i.value)}return Number.isFinite(s)&&Number.isFinite(a)}}Is.create=n=>new Is({checks:[],typeName:ht.ZodNumber,coerce:(n==null?void 0:n.coerce)||!1,...xt(n)});class Rs extends Tt{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(a){if(this._def.coerce&&(a.data=BigInt(a.data)),this._getType(a)!==Qe.bigint){const c=this._getOrReturnCtx(a);return Ve(c,{code:Ge.invalid_type,expected:Qe.bigint,received:c.parsedType}),pt}let i;const l=new tr;for(const c of this._def.checks)c.kind==="min"?(c.inclusive?a.data<c.value:a.data<=c.value)&&(i=this._getOrReturnCtx(a,i),Ve(i,{code:Ge.too_small,type:"bigint",minimum:c.value,inclusive:c.inclusive,message:c.message}),l.dirty()):c.kind==="max"?(c.inclusive?a.data>c.value:a.data>=c.value)&&(i=this._getOrReturnCtx(a,i),Ve(i,{code:Ge.too_big,type:"bigint",maximum:c.value,inclusive:c.inclusive,message:c.message}),l.dirty()):c.kind==="multipleOf"?a.data%c.value!==BigInt(0)&&(i=this._getOrReturnCtx(a,i),Ve(i,{code:Ge.not_multiple_of,multipleOf:c.value,message:c.message}),l.dirty()):Ft.assertNever(c);return{status:l.value,value:a.data}}gte(a,s){return this.setLimit("min",a,!0,st.toString(s))}gt(a,s){return this.setLimit("min",a,!1,st.toString(s))}lte(a,s){return this.setLimit("max",a,!0,st.toString(s))}lt(a,s){return this.setLimit("max",a,!1,st.toString(s))}setLimit(a,s,i,l){return new Rs({...this._def,checks:[...this._def.checks,{kind:a,value:s,inclusive:i,message:st.toString(l)}]})}_addCheck(a){return new Rs({...this._def,checks:[...this._def.checks,a]})}positive(a){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:st.toString(a)})}negative(a){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:st.toString(a)})}nonpositive(a){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:st.toString(a)})}nonnegative(a){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:st.toString(a)})}multipleOf(a,s){return this._addCheck({kind:"multipleOf",value:a,message:st.toString(s)})}get minValue(){let a=null;for(const s of this._def.checks)s.kind==="min"&&(a===null||s.value>a)&&(a=s.value);return a}get maxValue(){let a=null;for(const s of this._def.checks)s.kind==="max"&&(a===null||s.value<a)&&(a=s.value);return a}}Rs.create=n=>{var a;return new Rs({checks:[],typeName:ht.ZodBigInt,coerce:(a=n==null?void 0:n.coerce)!==null&&a!==void 0?a:!1,...xt(n)})};class _l extends Tt{_parse(a){if(this._def.coerce&&(a.data=!!a.data),this._getType(a)!==Qe.boolean){const i=this._getOrReturnCtx(a);return Ve(i,{code:Ge.invalid_type,expected:Qe.boolean,received:i.parsedType}),pt}return ir(a.data)}}_l.create=n=>new _l({typeName:ht.ZodBoolean,coerce:(n==null?void 0:n.coerce)||!1,...xt(n)});class li extends Tt{_parse(a){if(this._def.coerce&&(a.data=new Date(a.data)),this._getType(a)!==Qe.date){const c=this._getOrReturnCtx(a);return Ve(c,{code:Ge.invalid_type,expected:Qe.date,received:c.parsedType}),pt}if(isNaN(a.data.getTime())){const c=this._getOrReturnCtx(a);return Ve(c,{code:Ge.invalid_date}),pt}const i=new tr;let l;for(const c of this._def.checks)c.kind==="min"?a.data.getTime()<c.value&&(l=this._getOrReturnCtx(a,l),Ve(l,{code:Ge.too_small,message:c.message,inclusive:!0,exact:!1,minimum:c.value,type:"date"}),i.dirty()):c.kind==="max"?a.data.getTime()>c.value&&(l=this._getOrReturnCtx(a,l),Ve(l,{code:Ge.too_big,message:c.message,inclusive:!0,exact:!1,maximum:c.value,type:"date"}),i.dirty()):Ft.assertNever(c);return{status:i.value,value:new Date(a.data.getTime())}}_addCheck(a){return new li({...this._def,checks:[...this._def.checks,a]})}min(a,s){return this._addCheck({kind:"min",value:a.getTime(),message:st.toString(s)})}max(a,s){return this._addCheck({kind:"max",value:a.getTime(),message:st.toString(s)})}get minDate(){let a=null;for(const s of this._def.checks)s.kind==="min"&&(a===null||s.value>a)&&(a=s.value);return a!=null?new Date(a):null}get maxDate(){let a=null;for(const s of this._def.checks)s.kind==="max"&&(a===null||s.value<a)&&(a=s.value);return a!=null?new Date(a):null}}li.create=n=>new li({checks:[],coerce:(n==null?void 0:n.coerce)||!1,typeName:ht.ZodDate,...xt(n)});class yu extends Tt{_parse(a){if(this._getType(a)!==Qe.symbol){const i=this._getOrReturnCtx(a);return Ve(i,{code:Ge.invalid_type,expected:Qe.symbol,received:i.parsedType}),pt}return ir(a.data)}}yu.create=n=>new yu({typeName:ht.ZodSymbol,...xt(n)});class Sl extends Tt{_parse(a){if(this._getType(a)!==Qe.undefined){const i=this._getOrReturnCtx(a);return Ve(i,{code:Ge.invalid_type,expected:Qe.undefined,received:i.parsedType}),pt}return ir(a.data)}}Sl.create=n=>new Sl({typeName:ht.ZodUndefined,...xt(n)});class wl extends Tt{_parse(a){if(this._getType(a)!==Qe.null){const i=this._getOrReturnCtx(a);return Ve(i,{code:Ge.invalid_type,expected:Qe.null,received:i.parsedType}),pt}return ir(a.data)}}wl.create=n=>new wl({typeName:ht.ZodNull,...xt(n)});class oo extends Tt{constructor(){super(...arguments),this._any=!0}_parse(a){return ir(a.data)}}oo.create=n=>new oo({typeName:ht.ZodAny,...xt(n)});class oi extends Tt{constructor(){super(...arguments),this._unknown=!0}_parse(a){return ir(a.data)}}oi.create=n=>new oi({typeName:ht.ZodUnknown,...xt(n)});class Va extends Tt{_parse(a){const s=this._getOrReturnCtx(a);return Ve(s,{code:Ge.invalid_type,expected:Qe.never,received:s.parsedType}),pt}}Va.create=n=>new Va({typeName:ht.ZodNever,...xt(n)});class vu extends Tt{_parse(a){if(this._getType(a)!==Qe.undefined){const i=this._getOrReturnCtx(a);return Ve(i,{code:Ge.invalid_type,expected:Qe.void,received:i.parsedType}),pt}return ir(a.data)}}vu.create=n=>new vu({typeName:ht.ZodVoid,...xt(n)});class ia extends Tt{_parse(a){const{ctx:s,status:i}=this._processInputParams(a),l=this._def;if(s.parsedType!==Qe.array)return Ve(s,{code:Ge.invalid_type,expected:Qe.array,received:s.parsedType}),pt;if(l.exactLength!==null){const d=s.data.length>l.exactLength.value,m=s.data.length<l.exactLength.value;(d||m)&&(Ve(s,{code:d?Ge.too_big:Ge.too_small,minimum:m?l.exactLength.value:void 0,maximum:d?l.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:l.exactLength.message}),i.dirty())}if(l.minLength!==null&&s.data.length<l.minLength.value&&(Ve(s,{code:Ge.too_small,minimum:l.minLength.value,type:"array",inclusive:!0,exact:!1,message:l.minLength.message}),i.dirty()),l.maxLength!==null&&s.data.length>l.maxLength.value&&(Ve(s,{code:Ge.too_big,maximum:l.maxLength.value,type:"array",inclusive:!0,exact:!1,message:l.maxLength.message}),i.dirty()),s.common.async)return Promise.all([...s.data].map((d,m)=>l.type._parseAsync(new ba(s,d,s.path,m)))).then(d=>tr.mergeArray(i,d));const c=[...s.data].map((d,m)=>l.type._parseSync(new ba(s,d,s.path,m)));return tr.mergeArray(i,c)}get element(){return this._def.type}min(a,s){return new ia({...this._def,minLength:{value:a,message:st.toString(s)}})}max(a,s){return new ia({...this._def,maxLength:{value:a,message:st.toString(s)}})}length(a,s){return new ia({...this._def,exactLength:{value:a,message:st.toString(s)}})}nonempty(a){return this.min(1,a)}}ia.create=(n,a)=>new ia({type:n,minLength:null,maxLength:null,exactLength:null,typeName:ht.ZodArray,...xt(a)});function Ji(n){if(n instanceof yn){const a={};for(const s in n.shape){const i=n.shape[s];a[s]=va.create(Ji(i))}return new yn({...n._def,shape:()=>a})}else return n instanceof ia?new ia({...n._def,type:Ji(n.element)}):n instanceof va?va.create(Ji(n.unwrap())):n instanceof Us?Us.create(Ji(n.unwrap())):n instanceof xa?xa.create(n.items.map(a=>Ji(a))):n}class yn extends Tt{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;const a=this._def.shape(),s=Ft.objectKeys(a);return this._cached={shape:a,keys:s}}_parse(a){if(this._getType(a)!==Qe.object){const f=this._getOrReturnCtx(a);return Ve(f,{code:Ge.invalid_type,expected:Qe.object,received:f.parsedType}),pt}const{status:i,ctx:l}=this._processInputParams(a),{shape:c,keys:d}=this._getCached(),m=[];if(!(this._def.catchall instanceof Va&&this._def.unknownKeys==="strip"))for(const f in l.data)d.includes(f)||m.push(f);const p=[];for(const f of d){const v=c[f],_=l.data[f];p.push({key:{status:"valid",value:f},value:v._parse(new ba(l,_,l.path,f)),alwaysSet:f in l.data})}if(this._def.catchall instanceof Va){const f=this._def.unknownKeys;if(f==="passthrough")for(const v of m)p.push({key:{status:"valid",value:v},value:{status:"valid",value:l.data[v]}});else if(f==="strict")m.length>0&&(Ve(l,{code:Ge.unrecognized_keys,keys:m}),i.dirty());else if(f!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const f=this._def.catchall;for(const v of m){const _=l.data[v];p.push({key:{status:"valid",value:v},value:f._parse(new ba(l,_,l.path,v)),alwaysSet:v in l.data})}}return l.common.async?Promise.resolve().then(async()=>{const f=[];for(const v of p){const _=await v.key,T=await v.value;f.push({key:_,value:T,alwaysSet:v.alwaysSet})}return f}).then(f=>tr.mergeObjectSync(i,f)):tr.mergeObjectSync(i,p)}get shape(){return this._def.shape()}strict(a){return st.errToObj,new yn({...this._def,unknownKeys:"strict",...a!==void 0?{errorMap:(s,i)=>{var l,c,d,m;const p=(d=(c=(l=this._def).errorMap)===null||c===void 0?void 0:c.call(l,s,i).message)!==null&&d!==void 0?d:i.defaultError;return s.code==="unrecognized_keys"?{message:(m=st.errToObj(a).message)!==null&&m!==void 0?m:p}:{message:p}}}:{}})}strip(){return new yn({...this._def,unknownKeys:"strip"})}passthrough(){return new yn({...this._def,unknownKeys:"passthrough"})}extend(a){return new yn({...this._def,shape:()=>({...this._def.shape(),...a})})}merge(a){return new yn({unknownKeys:a._def.unknownKeys,catchall:a._def.catchall,shape:()=>({...this._def.shape(),...a._def.shape()}),typeName:ht.ZodObject})}setKey(a,s){return this.augment({[a]:s})}catchall(a){return new yn({...this._def,catchall:a})}pick(a){const s={};return Ft.objectKeys(a).forEach(i=>{a[i]&&this.shape[i]&&(s[i]=this.shape[i])}),new yn({...this._def,shape:()=>s})}omit(a){const s={};return Ft.objectKeys(this.shape).forEach(i=>{a[i]||(s[i]=this.shape[i])}),new yn({...this._def,shape:()=>s})}deepPartial(){return Ji(this)}partial(a){const s={};return Ft.objectKeys(this.shape).forEach(i=>{const l=this.shape[i];a&&!a[i]?s[i]=l:s[i]=l.optional()}),new yn({...this._def,shape:()=>s})}required(a){const s={};return Ft.objectKeys(this.shape).forEach(i=>{if(a&&!a[i])s[i]=this.shape[i];else{let c=this.shape[i];for(;c instanceof va;)c=c._def.innerType;s[i]=c}}),new yn({...this._def,shape:()=>s})}keyof(){return kb(Ft.objectKeys(this.shape))}}yn.create=(n,a)=>new yn({shape:()=>n,unknownKeys:"strip",catchall:Va.create(),typeName:ht.ZodObject,...xt(a)});yn.strictCreate=(n,a)=>new yn({shape:()=>n,unknownKeys:"strict",catchall:Va.create(),typeName:ht.ZodObject,...xt(a)});yn.lazycreate=(n,a)=>new yn({shape:n,unknownKeys:"strip",catchall:Va.create(),typeName:ht.ZodObject,...xt(a)});class El extends Tt{_parse(a){const{ctx:s}=this._processInputParams(a),i=this._def.options;function l(c){for(const m of c)if(m.result.status==="valid")return m.result;for(const m of c)if(m.result.status==="dirty")return s.common.issues.push(...m.ctx.common.issues),m.result;const d=c.map(m=>new Nr(m.ctx.common.issues));return Ve(s,{code:Ge.invalid_union,unionErrors:d}),pt}if(s.common.async)return Promise.all(i.map(async c=>{const d={...s,common:{...s.common,issues:[]},parent:null};return{result:await c._parseAsync({data:s.data,path:s.path,parent:d}),ctx:d}})).then(l);{let c;const d=[];for(const p of i){const f={...s,common:{...s.common,issues:[]},parent:null},v=p._parseSync({data:s.data,path:s.path,parent:f});if(v.status==="valid")return v;v.status==="dirty"&&!c&&(c={result:v,ctx:f}),f.common.issues.length&&d.push(f.common.issues)}if(c)return s.common.issues.push(...c.ctx.common.issues),c.result;const m=d.map(p=>new Nr(p));return Ve(s,{code:Ge.invalid_union,unionErrors:m}),pt}}get options(){return this._def.options}}El.create=(n,a)=>new El({options:n,typeName:ht.ZodUnion,...xt(a)});const $a=n=>n instanceof kl?$a(n.schema):n instanceof la?$a(n.innerType()):n instanceof Cl?[n.value]:n instanceof Ms?n.options:n instanceof Nl?Ft.objectValues(n.enum):n instanceof Dl?$a(n._def.innerType):n instanceof Sl?[void 0]:n instanceof wl?[null]:n instanceof va?[void 0,...$a(n.unwrap())]:n instanceof Us?[null,...$a(n.unwrap())]:n instanceof Gh||n instanceof jl?$a(n.unwrap()):n instanceof Ol?$a(n._def.innerType):[];class Tu extends Tt{_parse(a){const{ctx:s}=this._processInputParams(a);if(s.parsedType!==Qe.object)return Ve(s,{code:Ge.invalid_type,expected:Qe.object,received:s.parsedType}),pt;const i=this.discriminator,l=s.data[i],c=this.optionsMap.get(l);return c?s.common.async?c._parseAsync({data:s.data,path:s.path,parent:s}):c._parseSync({data:s.data,path:s.path,parent:s}):(Ve(s,{code:Ge.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[i]}),pt)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(a,s,i){const l=new Map;for(const c of s){const d=$a(c.shape[a]);if(!d.length)throw new Error(`A discriminator value for key \`${a}\` could not be extracted from all schema options`);for(const m of d){if(l.has(m))throw new Error(`Discriminator property ${String(a)} has duplicate value ${String(m)}`);l.set(m,c)}}return new Tu({typeName:ht.ZodDiscriminatedUnion,discriminator:a,options:s,optionsMap:l,...xt(i)})}}function Nh(n,a){const s=Os(n),i=Os(a);if(n===a)return{valid:!0,data:n};if(s===Qe.object&&i===Qe.object){const l=Ft.objectKeys(a),c=Ft.objectKeys(n).filter(m=>l.indexOf(m)!==-1),d={...n,...a};for(const m of c){const p=Nh(n[m],a[m]);if(!p.valid)return{valid:!1};d[m]=p.data}return{valid:!0,data:d}}else if(s===Qe.array&&i===Qe.array){if(n.length!==a.length)return{valid:!1};const l=[];for(let c=0;c<n.length;c++){const d=n[c],m=a[c],p=Nh(d,m);if(!p.valid)return{valid:!1};l.push(p.data)}return{valid:!0,data:l}}else return s===Qe.date&&i===Qe.date&&+n==+a?{valid:!0,data:n}:{valid:!1}}class Tl extends Tt{_parse(a){const{status:s,ctx:i}=this._processInputParams(a),l=(c,d)=>{if(kh(c)||kh(d))return pt;const m=Nh(c.value,d.value);return m.valid?((Ch(c)||Ch(d))&&s.dirty(),{status:s.value,value:m.data}):(Ve(i,{code:Ge.invalid_intersection_types}),pt)};return i.common.async?Promise.all([this._def.left._parseAsync({data:i.data,path:i.path,parent:i}),this._def.right._parseAsync({data:i.data,path:i.path,parent:i})]).then(([c,d])=>l(c,d)):l(this._def.left._parseSync({data:i.data,path:i.path,parent:i}),this._def.right._parseSync({data:i.data,path:i.path,parent:i}))}}Tl.create=(n,a,s)=>new Tl({left:n,right:a,typeName:ht.ZodIntersection,...xt(s)});class xa extends Tt{_parse(a){const{status:s,ctx:i}=this._processInputParams(a);if(i.parsedType!==Qe.array)return Ve(i,{code:Ge.invalid_type,expected:Qe.array,received:i.parsedType}),pt;if(i.data.length<this._def.items.length)return Ve(i,{code:Ge.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),pt;!this._def.rest&&i.data.length>this._def.items.length&&(Ve(i,{code:Ge.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),s.dirty());const c=[...i.data].map((d,m)=>{const p=this._def.items[m]||this._def.rest;return p?p._parse(new ba(i,d,i.path,m)):null}).filter(d=>!!d);return i.common.async?Promise.all(c).then(d=>tr.mergeArray(s,d)):tr.mergeArray(s,c)}get items(){return this._def.items}rest(a){return new xa({...this._def,rest:a})}}xa.create=(n,a)=>{if(!Array.isArray(n))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new xa({items:n,typeName:ht.ZodTuple,rest:null,...xt(a)})};class Al extends Tt{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(a){const{status:s,ctx:i}=this._processInputParams(a);if(i.parsedType!==Qe.object)return Ve(i,{code:Ge.invalid_type,expected:Qe.object,received:i.parsedType}),pt;const l=[],c=this._def.keyType,d=this._def.valueType;for(const m in i.data)l.push({key:c._parse(new ba(i,m,i.path,m)),value:d._parse(new ba(i,i.data[m],i.path,m)),alwaysSet:m in i.data});return i.common.async?tr.mergeObjectAsync(s,l):tr.mergeObjectSync(s,l)}get element(){return this._def.valueType}static create(a,s,i){return s instanceof Tt?new Al({keyType:a,valueType:s,typeName:ht.ZodRecord,...xt(i)}):new Al({keyType:sa.create(),valueType:a,typeName:ht.ZodRecord,...xt(s)})}}class bu extends Tt{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(a){const{status:s,ctx:i}=this._processInputParams(a);if(i.parsedType!==Qe.map)return Ve(i,{code:Ge.invalid_type,expected:Qe.map,received:i.parsedType}),pt;const l=this._def.keyType,c=this._def.valueType,d=[...i.data.entries()].map(([m,p],f)=>({key:l._parse(new ba(i,m,i.path,[f,"key"])),value:c._parse(new ba(i,p,i.path,[f,"value"]))}));if(i.common.async){const m=new Map;return Promise.resolve().then(async()=>{for(const p of d){const f=await p.key,v=await p.value;if(f.status==="aborted"||v.status==="aborted")return pt;(f.status==="dirty"||v.status==="dirty")&&s.dirty(),m.set(f.value,v.value)}return{status:s.value,value:m}})}else{const m=new Map;for(const p of d){const f=p.key,v=p.value;if(f.status==="aborted"||v.status==="aborted")return pt;(f.status==="dirty"||v.status==="dirty")&&s.dirty(),m.set(f.value,v.value)}return{status:s.value,value:m}}}}bu.create=(n,a,s)=>new bu({valueType:a,keyType:n,typeName:ht.ZodMap,...xt(s)});class ci extends Tt{_parse(a){const{status:s,ctx:i}=this._processInputParams(a);if(i.parsedType!==Qe.set)return Ve(i,{code:Ge.invalid_type,expected:Qe.set,received:i.parsedType}),pt;const l=this._def;l.minSize!==null&&i.data.size<l.minSize.value&&(Ve(i,{code:Ge.too_small,minimum:l.minSize.value,type:"set",inclusive:!0,exact:!1,message:l.minSize.message}),s.dirty()),l.maxSize!==null&&i.data.size>l.maxSize.value&&(Ve(i,{code:Ge.too_big,maximum:l.maxSize.value,type:"set",inclusive:!0,exact:!1,message:l.maxSize.message}),s.dirty());const c=this._def.valueType;function d(p){const f=new Set;for(const v of p){if(v.status==="aborted")return pt;v.status==="dirty"&&s.dirty(),f.add(v.value)}return{status:s.value,value:f}}const m=[...i.data.values()].map((p,f)=>c._parse(new ba(i,p,i.path,f)));return i.common.async?Promise.all(m).then(p=>d(p)):d(m)}min(a,s){return new ci({...this._def,minSize:{value:a,message:st.toString(s)}})}max(a,s){return new ci({...this._def,maxSize:{value:a,message:st.toString(s)}})}size(a,s){return this.min(a,s).max(a,s)}nonempty(a){return this.min(1,a)}}ci.create=(n,a)=>new ci({valueType:n,minSize:null,maxSize:null,typeName:ht.ZodSet,...xt(a)});class ro extends Tt{constructor(){super(...arguments),this.validate=this.implement}_parse(a){const{ctx:s}=this._processInputParams(a);if(s.parsedType!==Qe.function)return Ve(s,{code:Ge.invalid_type,expected:Qe.function,received:s.parsedType}),pt;function i(m,p){return pu({data:m,path:s.path,errorMaps:[s.common.contextualErrorMap,s.schemaErrorMap,mu(),io].filter(f=>!!f),issueData:{code:Ge.invalid_arguments,argumentsError:p}})}function l(m,p){return pu({data:m,path:s.path,errorMaps:[s.common.contextualErrorMap,s.schemaErrorMap,mu(),io].filter(f=>!!f),issueData:{code:Ge.invalid_return_type,returnTypeError:p}})}const c={errorMap:s.common.contextualErrorMap},d=s.data;if(this._def.returns instanceof lo){const m=this;return ir(async function(...p){const f=new Nr([]),v=await m._def.args.parseAsync(p,c).catch(x=>{throw f.addIssue(i(p,x)),f}),_=await Reflect.apply(d,this,v);return await m._def.returns._def.type.parseAsync(_,c).catch(x=>{throw f.addIssue(l(_,x)),f})})}else{const m=this;return ir(function(...p){const f=m._def.args.safeParse(p,c);if(!f.success)throw new Nr([i(p,f.error)]);const v=Reflect.apply(d,this,f.data),_=m._def.returns.safeParse(v,c);if(!_.success)throw new Nr([l(v,_.error)]);return _.data})}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...a){return new ro({...this._def,args:xa.create(a).rest(oi.create())})}returns(a){return new ro({...this._def,returns:a})}implement(a){return this.parse(a)}strictImplement(a){return this.parse(a)}static create(a,s,i){return new ro({args:a||xa.create([]).rest(oi.create()),returns:s||oi.create(),typeName:ht.ZodFunction,...xt(i)})}}class kl extends Tt{get schema(){return this._def.getter()}_parse(a){const{ctx:s}=this._processInputParams(a);return this._def.getter()._parse({data:s.data,path:s.path,parent:s})}}kl.create=(n,a)=>new kl({getter:n,typeName:ht.ZodLazy,...xt(a)});class Cl extends Tt{_parse(a){if(a.data!==this._def.value){const s=this._getOrReturnCtx(a);return Ve(s,{received:s.data,code:Ge.invalid_literal,expected:this._def.value}),pt}return{status:"valid",value:a.data}}get value(){return this._def.value}}Cl.create=(n,a)=>new Cl({value:n,typeName:ht.ZodLiteral,...xt(a)});function kb(n,a){return new Ms({values:n,typeName:ht.ZodEnum,...xt(a)})}class Ms extends Tt{constructor(){super(...arguments),fl.set(this,void 0)}_parse(a){if(typeof a.data!="string"){const s=this._getOrReturnCtx(a),i=this._def.values;return Ve(s,{expected:Ft.joinValues(i),received:s.parsedType,code:Ge.invalid_type}),pt}if(gu(this,fl)||wb(this,fl,new Set(this._def.values)),!gu(this,fl).has(a.data)){const s=this._getOrReturnCtx(a),i=this._def.values;return Ve(s,{received:s.data,code:Ge.invalid_enum_value,options:i}),pt}return ir(a.data)}get options(){return this._def.values}get enum(){const a={};for(const s of this._def.values)a[s]=s;return a}get Values(){const a={};for(const s of this._def.values)a[s]=s;return a}get Enum(){const a={};for(const s of this._def.values)a[s]=s;return a}extract(a,s=this._def){return Ms.create(a,{...this._def,...s})}exclude(a,s=this._def){return Ms.create(this.options.filter(i=>!a.includes(i)),{...this._def,...s})}}fl=new WeakMap;Ms.create=kb;class Nl extends Tt{constructor(){super(...arguments),hl.set(this,void 0)}_parse(a){const s=Ft.getValidEnumValues(this._def.values),i=this._getOrReturnCtx(a);if(i.parsedType!==Qe.string&&i.parsedType!==Qe.number){const l=Ft.objectValues(s);return Ve(i,{expected:Ft.joinValues(l),received:i.parsedType,code:Ge.invalid_type}),pt}if(gu(this,hl)||wb(this,hl,new Set(Ft.getValidEnumValues(this._def.values))),!gu(this,hl).has(a.data)){const l=Ft.objectValues(s);return Ve(i,{received:i.data,code:Ge.invalid_enum_value,options:l}),pt}return ir(a.data)}get enum(){return this._def.values}}hl=new WeakMap;Nl.create=(n,a)=>new Nl({values:n,typeName:ht.ZodNativeEnum,...xt(a)});class lo extends Tt{unwrap(){return this._def.type}_parse(a){const{ctx:s}=this._processInputParams(a);if(s.parsedType!==Qe.promise&&s.common.async===!1)return Ve(s,{code:Ge.invalid_type,expected:Qe.promise,received:s.parsedType}),pt;const i=s.parsedType===Qe.promise?s.data:Promise.resolve(s.data);return ir(i.then(l=>this._def.type.parseAsync(l,{path:s.path,errorMap:s.common.contextualErrorMap})))}}lo.create=(n,a)=>new lo({type:n,typeName:ht.ZodPromise,...xt(a)});class la extends Tt{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===ht.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(a){const{status:s,ctx:i}=this._processInputParams(a),l=this._def.effect||null,c={addIssue:d=>{Ve(i,d),d.fatal?s.abort():s.dirty()},get path(){return i.path}};if(c.addIssue=c.addIssue.bind(c),l.type==="preprocess"){const d=l.transform(i.data,c);if(i.common.async)return Promise.resolve(d).then(async m=>{if(s.value==="aborted")return pt;const p=await this._def.schema._parseAsync({data:m,path:i.path,parent:i});return p.status==="aborted"?pt:p.status==="dirty"||s.value==="dirty"?to(p.value):p});{if(s.value==="aborted")return pt;const m=this._def.schema._parseSync({data:d,path:i.path,parent:i});return m.status==="aborted"?pt:m.status==="dirty"||s.value==="dirty"?to(m.value):m}}if(l.type==="refinement"){const d=m=>{const p=l.refinement(m,c);if(i.common.async)return Promise.resolve(p);if(p instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return m};if(i.common.async===!1){const m=this._def.schema._parseSync({data:i.data,path:i.path,parent:i});return m.status==="aborted"?pt:(m.status==="dirty"&&s.dirty(),d(m.value),{status:s.value,value:m.value})}else return this._def.schema._parseAsync({data:i.data,path:i.path,parent:i}).then(m=>m.status==="aborted"?pt:(m.status==="dirty"&&s.dirty(),d(m.value).then(()=>({status:s.value,value:m.value}))))}if(l.type==="transform")if(i.common.async===!1){const d=this._def.schema._parseSync({data:i.data,path:i.path,parent:i});if(!bl(d))return d;const m=l.transform(d.value,c);if(m instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:s.value,value:m}}else return this._def.schema._parseAsync({data:i.data,path:i.path,parent:i}).then(d=>bl(d)?Promise.resolve(l.transform(d.value,c)).then(m=>({status:s.value,value:m})):d);Ft.assertNever(l)}}la.create=(n,a,s)=>new la({schema:n,typeName:ht.ZodEffects,effect:a,...xt(s)});la.createWithPreprocess=(n,a,s)=>new la({schema:a,effect:{type:"preprocess",transform:n},typeName:ht.ZodEffects,...xt(s)});class va extends Tt{_parse(a){return this._getType(a)===Qe.undefined?ir(void 0):this._def.innerType._parse(a)}unwrap(){return this._def.innerType}}va.create=(n,a)=>new va({innerType:n,typeName:ht.ZodOptional,...xt(a)});class Us extends Tt{_parse(a){return this._getType(a)===Qe.null?ir(null):this._def.innerType._parse(a)}unwrap(){return this._def.innerType}}Us.create=(n,a)=>new Us({innerType:n,typeName:ht.ZodNullable,...xt(a)});class Dl extends Tt{_parse(a){const{ctx:s}=this._processInputParams(a);let i=s.data;return s.parsedType===Qe.undefined&&(i=this._def.defaultValue()),this._def.innerType._parse({data:i,path:s.path,parent:s})}removeDefault(){return this._def.innerType}}Dl.create=(n,a)=>new Dl({innerType:n,typeName:ht.ZodDefault,defaultValue:typeof a.default=="function"?a.default:()=>a.default,...xt(a)});class Ol extends Tt{_parse(a){const{ctx:s}=this._processInputParams(a),i={...s,common:{...s.common,issues:[]}},l=this._def.innerType._parse({data:i.data,path:i.path,parent:{...i}});return xl(l)?l.then(c=>({status:"valid",value:c.status==="valid"?c.value:this._def.catchValue({get error(){return new Nr(i.common.issues)},input:i.data})})):{status:"valid",value:l.status==="valid"?l.value:this._def.catchValue({get error(){return new Nr(i.common.issues)},input:i.data})}}removeCatch(){return this._def.innerType}}Ol.create=(n,a)=>new Ol({innerType:n,typeName:ht.ZodCatch,catchValue:typeof a.catch=="function"?a.catch:()=>a.catch,...xt(a)});class xu extends Tt{_parse(a){if(this._getType(a)!==Qe.nan){const i=this._getOrReturnCtx(a);return Ve(i,{code:Ge.invalid_type,expected:Qe.nan,received:i.parsedType}),pt}return{status:"valid",value:a.data}}}xu.create=n=>new xu({typeName:ht.ZodNaN,...xt(n)});const zS=Symbol("zod_brand");class Gh extends Tt{_parse(a){const{ctx:s}=this._processInputParams(a),i=s.data;return this._def.type._parse({data:i,path:s.path,parent:s})}unwrap(){return this._def.type}}class Ml extends Tt{_parse(a){const{status:s,ctx:i}=this._processInputParams(a);if(i.common.async)return(async()=>{const c=await this._def.in._parseAsync({data:i.data,path:i.path,parent:i});return c.status==="aborted"?pt:c.status==="dirty"?(s.dirty(),to(c.value)):this._def.out._parseAsync({data:c.value,path:i.path,parent:i})})();{const l=this._def.in._parseSync({data:i.data,path:i.path,parent:i});return l.status==="aborted"?pt:l.status==="dirty"?(s.dirty(),{status:"dirty",value:l.value}):this._def.out._parseSync({data:l.value,path:i.path,parent:i})}}static create(a,s){return new Ml({in:a,out:s,typeName:ht.ZodPipeline})}}class jl extends Tt{_parse(a){const s=this._def.innerType._parse(a),i=l=>(bl(l)&&(l.value=Object.freeze(l.value)),l);return xl(s)?s.then(l=>i(l)):i(s)}unwrap(){return this._def.innerType}}jl.create=(n,a)=>new jl({innerType:n,typeName:ht.ZodReadonly,...xt(a)});function Cb(n,a={},s){return n?oo.create().superRefine((i,l)=>{var c,d;if(!n(i)){const m=typeof a=="function"?a(i):typeof a=="string"?{message:a}:a,p=(d=(c=m.fatal)!==null&&c!==void 0?c:s)!==null&&d!==void 0?d:!0,f=typeof m=="string"?{message:m}:m;l.addIssue({code:"custom",...f,fatal:p})}}):oo.create()}const FS={object:yn.lazycreate};var ht;(function(n){n.ZodString="ZodString",n.ZodNumber="ZodNumber",n.ZodNaN="ZodNaN",n.ZodBigInt="ZodBigInt",n.ZodBoolean="ZodBoolean",n.ZodDate="ZodDate",n.ZodSymbol="ZodSymbol",n.ZodUndefined="ZodUndefined",n.ZodNull="ZodNull",n.ZodAny="ZodAny",n.ZodUnknown="ZodUnknown",n.ZodNever="ZodNever",n.ZodVoid="ZodVoid",n.ZodArray="ZodArray",n.ZodObject="ZodObject",n.ZodUnion="ZodUnion",n.ZodDiscriminatedUnion="ZodDiscriminatedUnion",n.ZodIntersection="ZodIntersection",n.ZodTuple="ZodTuple",n.ZodRecord="ZodRecord",n.ZodMap="ZodMap",n.ZodSet="ZodSet",n.ZodFunction="ZodFunction",n.ZodLazy="ZodLazy",n.ZodLiteral="ZodLiteral",n.ZodEnum="ZodEnum",n.ZodEffects="ZodEffects",n.ZodNativeEnum="ZodNativeEnum",n.ZodOptional="ZodOptional",n.ZodNullable="ZodNullable",n.ZodDefault="ZodDefault",n.ZodCatch="ZodCatch",n.ZodPromise="ZodPromise",n.ZodBranded="ZodBranded",n.ZodPipeline="ZodPipeline",n.ZodReadonly="ZodReadonly"})(ht||(ht={}));const BS=(n,a={message:`Input not instance of ${n.name}`})=>Cb(s=>s instanceof n,a),Nb=sa.create,Db=Is.create,HS=xu.create,GS=Rs.create,Ob=_l.create,qS=li.create,PS=yu.create,$S=Sl.create,YS=wl.create,VS=oo.create,KS=oi.create,ZS=Va.create,QS=vu.create,JS=ia.create,XS=yn.create,WS=yn.strictCreate,ew=El.create,tw=Tu.create,nw=Tl.create,rw=xa.create,aw=Al.create,sw=bu.create,iw=ci.create,ow=ro.create,lw=kl.create,cw=Cl.create,uw=Ms.create,dw=Nl.create,fw=lo.create,Fy=la.create,hw=va.create,mw=Us.create,pw=la.createWithPreprocess,gw=Ml.create,yw=()=>Nb().optional(),vw=()=>Db().optional(),bw=()=>Ob().optional(),xw={string:(n=>sa.create({...n,coerce:!0})),number:(n=>Is.create({...n,coerce:!0})),boolean:(n=>_l.create({...n,coerce:!0})),bigint:(n=>Rs.create({...n,coerce:!0})),date:(n=>li.create({...n,coerce:!0}))},_w=pt;var ge=Object.freeze({__proto__:null,defaultErrorMap:io,setErrorMap:_S,getErrorMap:mu,makeIssue:pu,EMPTY_PATH:SS,addIssueToContext:Ve,ParseStatus:tr,INVALID:pt,DIRTY:to,OK:ir,isAborted:kh,isDirty:Ch,isValid:bl,isAsync:xl,get util(){return Ft},get objectUtil(){return Ah},ZodParsedType:Qe,getParsedType:Os,ZodType:Tt,datetimeRegex:Ab,ZodString:sa,ZodNumber:Is,ZodBigInt:Rs,ZodBoolean:_l,ZodDate:li,ZodSymbol:yu,ZodUndefined:Sl,ZodNull:wl,ZodAny:oo,ZodUnknown:oi,ZodNever:Va,ZodVoid:vu,ZodArray:ia,ZodObject:yn,ZodUnion:El,ZodDiscriminatedUnion:Tu,ZodIntersection:Tl,ZodTuple:xa,ZodRecord:Al,ZodMap:bu,ZodSet:ci,ZodFunction:ro,ZodLazy:kl,ZodLiteral:Cl,ZodEnum:Ms,ZodNativeEnum:Nl,ZodPromise:lo,ZodEffects:la,ZodTransformer:la,ZodOptional:va,ZodNullable:Us,ZodDefault:Dl,ZodCatch:Ol,ZodNaN:xu,BRAND:zS,ZodBranded:Gh,ZodPipeline:Ml,ZodReadonly:jl,custom:Cb,Schema:Tt,ZodSchema:Tt,late:FS,get ZodFirstPartyTypeKind(){return ht},coerce:xw,any:VS,array:JS,bigint:GS,boolean:Ob,date:qS,discriminatedUnion:tw,effect:Fy,enum:uw,function:ow,instanceof:BS,intersection:nw,lazy:lw,literal:cw,map:sw,nan:HS,nativeEnum:dw,never:ZS,null:YS,nullable:mw,number:Db,object:XS,oboolean:bw,onumber:vw,optional:hw,ostring:yw,pipeline:gw,preprocess:pw,promise:fw,record:aw,set:iw,strictObject:WS,string:Nb,symbol:PS,transformer:Fy,tuple:rw,undefined:$S,union:ew,unknown:KS,void:QS,NEVER:_w,ZodIssueCode:Ge,quotelessJson:xS,ZodError:Nr});const jb=ge.object({id:ge.union([ge.string(),ge.number()]).nullable().optional().transform(n=>n?String(n):crypto.randomUUID()),text:ge.preprocess(n=>n??"",ge.string()),explanation:ge.string().nullable().optional().transform(n=>n??"")}),Ib=ge.object({front:ge.preprocess(n=>n??"",ge.string()),back:ge.preprocess(n=>n??"",ge.string())}),Rb=ge.object({id:ge.string().optional(),questionType:ge.preprocess(n=>n??"multipleChoice",ge.string()),questionText:ge.preprocess(n=>n??"",ge.string()),options:ge.preprocess(n=>Array.isArray(n)?n:[],ge.array(jb)),correctAnswerId:ge.preprocess(n=>n?String(n):"",ge.string()),detailedExplanation:ge.string().nullable().optional().transform(n=>n??""),tags:ge.array(ge.string()).optional()}),qh=ge.object({id:ge.coerce.string(),content:ge.string().nullable().optional().transform(n=>n??""),unlocksQuestionIds:ge.array(ge.string()).nullable().optional().transform(n=>n??[])}),Sw=ge.object({name:ge.string(),description:ge.preprocess(n=>n??"",ge.string()),questions:ge.array(ge.any()),type:ge.string().optional(),infoCards:ge.array(ge.any()).optional(),learningMode:ge.string().optional()}),Mb=ge.object({id:ge.coerce.string(),dueDate:ge.string().nullable().optional().transform(n=>n??new Date().toISOString()),interval:ge.number().nullable().optional().transform(n=>n??0),easeFactor:ge.number().nullable().optional().transform(n=>n??Cr),suspended:ge.boolean().nullable().optional().transform(n=>n??!1),masteryLevel:ge.number().nullable().optional().transform(n=>n??0),lastReviewed:ge.string().nullable().optional(),lapses:ge.number().nullable().optional().transform(n=>n??0)}),Ub=Mb.extend({front:ge.string().nullable().optional().transform(n=>n??""),back:ge.string().nullable().optional().transform(n=>n??""),css:ge.string().nullable().optional(),frontAudio:ge.string().nullable().optional(),backAudio:ge.string().nullable().optional(),tags:ge.array(ge.string()).nullable().optional().transform(n=>n??[])}),Ph=Mb.extend({questionType:ge.literal("multipleChoice"),questionText:ge.string().nullable().optional().transform(n=>n??""),options:ge.array(jb).nullable().optional().transform(n=>n??[]),correctAnswerId:ge.string().nullable().optional().transform(n=>n??""),detailedExplanation:ge.string().nullable().optional().transform(n=>n??""),tags:ge.array(ge.string()).nullable().optional().transform(n=>n??[]),infoCardIds:ge.array(ge.string()).nullable().optional().transform(n=>n??[]),userSelectedAnswerId:ge.string().optional()}),$h=ge.object({id:ge.coerce.string(),name:ge.coerce.string(),description:ge.string().nullable().optional().transform(n=>n??""),folderId:ge.string().nullable().optional(),lastOpened:ge.string().nullable().optional(),archived:ge.boolean().nullable().optional(),deletedAt:ge.string().nullable().optional(),lastModified:ge.number().nullable().optional(),locked:ge.boolean().nullable().optional(),icon:ge.string().nullable().optional(),aiGenerationParams:ge.any().optional(),suggestedQuestionCount:ge.number().nullable().optional(),generationStatus:ge.enum(["idle","generating","paused","error","complete"]).optional()}),ww=$h.extend({type:ge.literal(je.Flashcard),cards:ge.array(Ub).nullable().optional().transform(n=>n??[])}),Ew=$h.extend({type:ge.literal(je.Quiz),questions:ge.array(Ph).nullable().optional().transform(n=>n??[])}),Tw=$h.extend({type:ge.literal(je.Learning),infoCards:ge.array(qh).nullable().optional().transform(n=>n??[]),questions:ge.array(Ph).nullable().optional().transform(n=>n??[]),learningMode:ge.enum(["mixed","separate"]).optional().transform(n=>n??"separate"),curriculum:ge.object({name:ge.string(),description:ge.string(),chapters:ge.array(ge.object({title:ge.string(),learningObjectives:ge.array(ge.string()),topics:ge.array(ge.string())}))}).optional()}),Aw=n=>{if(typeof n!="object"||n===null)return{id:crypto.randomUUID(),name:"Corrupted Deck Entry",type:je.Flashcard,cards:[],description:"This deck entry was corrupted in the source file."};const a={...n};a.id||(a.id=crypto.randomUUID()),a.id=String(a.id),(a.name===null||a.name===void 0)&&(a.name="Untitled Deck"),a.name=String(a.name),a.type&&typeof a.type=="string"&&(a.type=a.type.toLowerCase());const s=Object.values(je).map(l=>l.toString());(!a.type||!s.includes(a.type))&&(Array.isArray(a.infoCards)&&a.infoCards.length>0?a.type=je.Learning:Array.isArray(a.questions)&&a.questions.length>0?a.type=je.Quiz:a.type=je.Flashcard),(a.description===null||a.description===void 0)&&(a.description="");const i=l=>!l||typeof l!="object"?null:(l.id||(l.id=crypto.randomUUID()),l.id=String(l.id),a.type===je.Flashcard&&((l.front===null||l.front===void 0)&&(l.front=""),(l.back===null||l.back===void 0)&&(l.back="")),l);return Array.isArray(a.cards)?a.cards=a.cards.map(i).filter(l=>l!==null):a.cards=[],Array.isArray(a.questions)?a.questions=a.questions.map(l=>{const c=i(l);return c?(c.questionType||(c.questionType="multipleChoice"),c):null}).filter(l=>l!==null):a.questions=[],Array.isArray(a.infoCards)?a.infoCards=a.infoCards.map(i).filter(l=>l!==null):a.infoCards=[],a},kw=ge.preprocess(Aw,ge.union([ww,Ew,Tw])),Cw=ge.object({id:ge.coerce.string(),name:ge.coerce.string()}),Nw=ge.object({title:ge.string().nullable().optional().transform(n=>n??"Untitled Level"),deckIds:ge.array(ge.coerce.string()).nullable().optional().transform(n=>n??[])}),Dw=ge.object({id:ge.coerce.string(),type:ge.literal("series"),name:ge.string(),description:ge.string().nullable().optional().transform(n=>n??""),levels:ge.array(Nw).nullable().optional().transform(n=>n??[]),createdAt:ge.string().nullable().optional().transform(n=>n??new Date().toISOString()),lastOpened:ge.string().nullable().optional(),archived:ge.boolean().nullable().optional(),deletedAt:ge.string().nullable().optional(),lastModified:ge.number().nullable().optional(),aiGenerationParams:ge.any().optional(),aiChatHistory:ge.array(ge.any()).optional()}),Ow=ge.object({id:ge.union([ge.string(),ge.number()]).optional(),itemId:ge.coerce.string(),deckId:ge.coerce.string(),seriesId:ge.string().optional(),timestamp:ge.string(),rating:ge.nativeEnum(kr).nullable().optional(),newInterval:ge.number(),easeFactor:ge.number(),masteryLevel:ge.number().nullable().optional().transform(n=>n??0)}),jw=ge.object({id:ge.string(),reviewQueue:ge.array(ge.any()).transform(n=>Array.isArray(n)?n.map(a=>{if(!a||typeof a!="object")return null;if("questionType"in a){const i=Ph.safeParse(a);return i.success?i.data:null}if("content"in a||"unlocksQuestionIds"in a){const i=qh.safeParse(a);return i.success?i.data:null}const s=Ub.safeParse(a);return s.success?s.data:null}).filter(a=>a!==null):[]),currentIndex:ge.number(),itemsCompleted:ge.number().nullable().optional().transform(n=>n??0),readInfoCardIds:ge.array(ge.string()).optional(),unlockedQuestionIds:ge.array(ge.string()).optional()}),Iw=ge.object({id:ge.string(),role:ge.enum(["user","model"]),text:ge.string(),actions:ge.array(ge.any()).optional(),isLoading:ge.boolean().optional()}),Rw=ge.object({deckId:ge.string(),readInfoCardIds:ge.array(ge.string()).nullable().optional().transform(n=>n??[]),unlockedQuestionIds:ge.array(ge.string()).nullable().optional().transform(n=>n??[]),lastReadCardId:ge.string().optional()}),Mw=ge.object({version:ge.number(),decks:ge.array(kw),folders:ge.array(Cw).nullable().optional().transform(n=>n??[]),deckSeries:ge.array(Dw).nullable().optional().transform(n=>n??[]),reviews:ge.array(Ow).nullable().optional().transform(n=>n??[]),sessions:ge.array(jw).nullable().optional().transform(n=>n??[]),seriesProgress:ge.record(ge.string(),ge.array(ge.string())).nullable().optional().transform(n=>n??{}),learningProgress:ge.record(ge.string(),Rw).nullable().optional().transform(n=>n??{}),aiChatHistory:ge.array(Iw).nullable().optional().transform(n=>n??[]),aiOptions:ge.any().optional(),settings:ge.any().optional()}),Uw=ge.object({title:ge.string().nullable().optional().transform(n=>n??"Untitled Level"),decks:ge.array(ge.any())}),Lw=ge.object({seriesName:ge.string(),seriesDescription:ge.preprocess(n=>n??"",ge.string()),levels:ge.array(Uw)});function Qc(n){throw new Error('Could not dynamically require "'+n+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var rh={exports:{}};/*!

JSZip v3.10.1 - A JavaScript class for generating and reading zip files
<http://stuartk.com/jszip>

(c) 2009-2016 Stuart Knightley <stuart [at] stuartk.com>
Dual licenced under the MIT license or GPLv3. See https://raw.github.com/Stuk/jszip/main/LICENSE.markdown.

JSZip uses the library pako released under the MIT license :
https://github.com/nodeca/pako/blob/main/LICENSE
*/var By;function zw(){return By||(By=1,(function(n,a){(function(s){n.exports=s()})(function(){return(function s(i,l,c){function d(f,v){if(!l[f]){if(!i[f]){var _=typeof Qc=="function"&&Qc;if(!v&&_)return _(f,!0);if(m)return m(f,!0);var T=new Error("Cannot find module '"+f+"'");throw T.code="MODULE_NOT_FOUND",T}var x=l[f]={exports:{}};i[f][0].call(x.exports,function(k){var w=i[f][1][k];return d(w||k)},x,x.exports,s,i,l,c)}return l[f].exports}for(var m=typeof Qc=="function"&&Qc,p=0;p<c.length;p++)d(c[p]);return d})({1:[function(s,i,l){var c=s("./utils"),d=s("./support"),m="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";l.encode=function(p){for(var f,v,_,T,x,k,w,S=[],C=0,R=p.length,L=R,F=c.getTypeOf(p)!=="string";C<p.length;)L=R-C,_=F?(f=p[C++],v=C<R?p[C++]:0,C<R?p[C++]:0):(f=p.charCodeAt(C++),v=C<R?p.charCodeAt(C++):0,C<R?p.charCodeAt(C++):0),T=f>>2,x=(3&f)<<4|v>>4,k=1<L?(15&v)<<2|_>>6:64,w=2<L?63&_:64,S.push(m.charAt(T)+m.charAt(x)+m.charAt(k)+m.charAt(w));return S.join("")},l.decode=function(p){var f,v,_,T,x,k,w=0,S=0,C="data:";if(p.substr(0,C.length)===C)throw new Error("Invalid base64 input, it looks like a data url.");var R,L=3*(p=p.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(p.charAt(p.length-1)===m.charAt(64)&&L--,p.charAt(p.length-2)===m.charAt(64)&&L--,L%1!=0)throw new Error("Invalid base64 input, bad content length.");for(R=d.uint8array?new Uint8Array(0|L):new Array(0|L);w<p.length;)f=m.indexOf(p.charAt(w++))<<2|(T=m.indexOf(p.charAt(w++)))>>4,v=(15&T)<<4|(x=m.indexOf(p.charAt(w++)))>>2,_=(3&x)<<6|(k=m.indexOf(p.charAt(w++))),R[S++]=f,x!==64&&(R[S++]=v),k!==64&&(R[S++]=_);return R}},{"./support":30,"./utils":32}],2:[function(s,i,l){var c=s("./external"),d=s("./stream/DataWorker"),m=s("./stream/Crc32Probe"),p=s("./stream/DataLengthProbe");function f(v,_,T,x,k){this.compressedSize=v,this.uncompressedSize=_,this.crc32=T,this.compression=x,this.compressedContent=k}f.prototype={getContentWorker:function(){var v=new d(c.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new p("data_length")),_=this;return v.on("end",function(){if(this.streamInfo.data_length!==_.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),v},getCompressedWorker:function(){return new d(c.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},f.createWorkerFrom=function(v,_,T){return v.pipe(new m).pipe(new p("uncompressedSize")).pipe(_.compressWorker(T)).pipe(new p("compressedSize")).withStreamInfo("compression",_)},i.exports=f},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(s,i,l){var c=s("./stream/GenericWorker");l.STORE={magic:"\0\0",compressWorker:function(){return new c("STORE compression")},uncompressWorker:function(){return new c("STORE decompression")}},l.DEFLATE=s("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(s,i,l){var c=s("./utils"),d=(function(){for(var m,p=[],f=0;f<256;f++){m=f;for(var v=0;v<8;v++)m=1&m?3988292384^m>>>1:m>>>1;p[f]=m}return p})();i.exports=function(m,p){return m!==void 0&&m.length?c.getTypeOf(m)!=="string"?(function(f,v,_,T){var x=d,k=T+_;f^=-1;for(var w=T;w<k;w++)f=f>>>8^x[255&(f^v[w])];return-1^f})(0|p,m,m.length,0):(function(f,v,_,T){var x=d,k=T+_;f^=-1;for(var w=T;w<k;w++)f=f>>>8^x[255&(f^v.charCodeAt(w))];return-1^f})(0|p,m,m.length,0):0}},{"./utils":32}],5:[function(s,i,l){l.base64=!1,l.binary=!1,l.dir=!1,l.createFolders=!0,l.date=null,l.compression=null,l.compressionOptions=null,l.comment=null,l.unixPermissions=null,l.dosPermissions=null},{}],6:[function(s,i,l){var c=null;c=typeof Promise<"u"?Promise:s("lie"),i.exports={Promise:c}},{lie:37}],7:[function(s,i,l){var c=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Uint32Array<"u",d=s("pako"),m=s("./utils"),p=s("./stream/GenericWorker"),f=c?"uint8array":"array";function v(_,T){p.call(this,"FlateWorker/"+_),this._pako=null,this._pakoAction=_,this._pakoOptions=T,this.meta={}}l.magic="\b\0",m.inherits(v,p),v.prototype.processChunk=function(_){this.meta=_.meta,this._pako===null&&this._createPako(),this._pako.push(m.transformTo(f,_.data),!1)},v.prototype.flush=function(){p.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)},v.prototype.cleanUp=function(){p.prototype.cleanUp.call(this),this._pako=null},v.prototype._createPako=function(){this._pako=new d[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var _=this;this._pako.onData=function(T){_.push({data:T,meta:_.meta})}},l.compressWorker=function(_){return new v("Deflate",_)},l.uncompressWorker=function(){return new v("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(s,i,l){function c(x,k){var w,S="";for(w=0;w<k;w++)S+=String.fromCharCode(255&x),x>>>=8;return S}function d(x,k,w,S,C,R){var L,F,G=x.file,Q=x.compression,U=R!==f.utf8encode,j=m.transformTo("string",R(G.name)),O=m.transformTo("string",f.utf8encode(G.name)),q=G.comment,ee=m.transformTo("string",R(q)),M=m.transformTo("string",f.utf8encode(q)),J=O.length!==G.name.length,N=M.length!==q.length,se="",K="",P="",ve=G.dir,ce=G.date,Ee={crc32:0,compressedSize:0,uncompressedSize:0};k&&!w||(Ee.crc32=x.crc32,Ee.compressedSize=x.compressedSize,Ee.uncompressedSize=x.uncompressedSize);var z=0;k&&(z|=8),U||!J&&!N||(z|=2048);var I=0,te=0;ve&&(I|=16),C==="UNIX"?(te=798,I|=(function($,ue){var de=$;return $||(de=ue?16893:33204),(65535&de)<<16})(G.unixPermissions,ve)):(te=20,I|=(function($){return 63&($||0)})(G.dosPermissions)),L=ce.getUTCHours(),L<<=6,L|=ce.getUTCMinutes(),L<<=5,L|=ce.getUTCSeconds()/2,F=ce.getUTCFullYear()-1980,F<<=4,F|=ce.getUTCMonth()+1,F<<=5,F|=ce.getUTCDate(),J&&(K=c(1,1)+c(v(j),4)+O,se+="up"+c(K.length,2)+K),N&&(P=c(1,1)+c(v(ee),4)+M,se+="uc"+c(P.length,2)+P);var ae="";return ae+=`
\0`,ae+=c(z,2),ae+=Q.magic,ae+=c(L,2),ae+=c(F,2),ae+=c(Ee.crc32,4),ae+=c(Ee.compressedSize,4),ae+=c(Ee.uncompressedSize,4),ae+=c(j.length,2),ae+=c(se.length,2),{fileRecord:_.LOCAL_FILE_HEADER+ae+j+se,dirRecord:_.CENTRAL_FILE_HEADER+c(te,2)+ae+c(ee.length,2)+"\0\0\0\0"+c(I,4)+c(S,4)+j+se+ee}}var m=s("../utils"),p=s("../stream/GenericWorker"),f=s("../utf8"),v=s("../crc32"),_=s("../signature");function T(x,k,w,S){p.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=k,this.zipPlatform=w,this.encodeFileName=S,this.streamFiles=x,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}m.inherits(T,p),T.prototype.push=function(x){var k=x.meta.percent||0,w=this.entriesCount,S=this._sources.length;this.accumulate?this.contentBuffer.push(x):(this.bytesWritten+=x.data.length,p.prototype.push.call(this,{data:x.data,meta:{currentFile:this.currentFile,percent:w?(k+100*(w-S-1))/w:100}}))},T.prototype.openedSource=function(x){this.currentSourceOffset=this.bytesWritten,this.currentFile=x.file.name;var k=this.streamFiles&&!x.file.dir;if(k){var w=d(x,k,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:w.fileRecord,meta:{percent:0}})}else this.accumulate=!0},T.prototype.closedSource=function(x){this.accumulate=!1;var k=this.streamFiles&&!x.file.dir,w=d(x,k,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(w.dirRecord),k)this.push({data:(function(S){return _.DATA_DESCRIPTOR+c(S.crc32,4)+c(S.compressedSize,4)+c(S.uncompressedSize,4)})(x),meta:{percent:100}});else for(this.push({data:w.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},T.prototype.flush=function(){for(var x=this.bytesWritten,k=0;k<this.dirRecords.length;k++)this.push({data:this.dirRecords[k],meta:{percent:100}});var w=this.bytesWritten-x,S=(function(C,R,L,F,G){var Q=m.transformTo("string",G(F));return _.CENTRAL_DIRECTORY_END+"\0\0\0\0"+c(C,2)+c(C,2)+c(R,4)+c(L,4)+c(Q.length,2)+Q})(this.dirRecords.length,w,x,this.zipComment,this.encodeFileName);this.push({data:S,meta:{percent:100}})},T.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},T.prototype.registerPrevious=function(x){this._sources.push(x);var k=this;return x.on("data",function(w){k.processChunk(w)}),x.on("end",function(){k.closedSource(k.previous.streamInfo),k._sources.length?k.prepareNextSource():k.end()}),x.on("error",function(w){k.error(w)}),this},T.prototype.resume=function(){return!!p.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},T.prototype.error=function(x){var k=this._sources;if(!p.prototype.error.call(this,x))return!1;for(var w=0;w<k.length;w++)try{k[w].error(x)}catch{}return!0},T.prototype.lock=function(){p.prototype.lock.call(this);for(var x=this._sources,k=0;k<x.length;k++)x[k].lock()},i.exports=T},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(s,i,l){var c=s("../compressions"),d=s("./ZipFileWorker");l.generateWorker=function(m,p,f){var v=new d(p.streamFiles,f,p.platform,p.encodeFileName),_=0;try{m.forEach(function(T,x){_++;var k=(function(R,L){var F=R||L,G=c[F];if(!G)throw new Error(F+" is not a valid compression method !");return G})(x.options.compression,p.compression),w=x.options.compressionOptions||p.compressionOptions||{},S=x.dir,C=x.date;x._compressWorker(k,w).withStreamInfo("file",{name:T,dir:S,date:C,comment:x.comment||"",unixPermissions:x.unixPermissions,dosPermissions:x.dosPermissions}).pipe(v)}),v.entriesCount=_}catch(T){v.error(T)}return v}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(s,i,l){function c(){if(!(this instanceof c))return new c;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var d=new c;for(var m in this)typeof this[m]!="function"&&(d[m]=this[m]);return d}}(c.prototype=s("./object")).loadAsync=s("./load"),c.support=s("./support"),c.defaults=s("./defaults"),c.version="3.10.1",c.loadAsync=function(d,m){return new c().loadAsync(d,m)},c.external=s("./external"),i.exports=c},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(s,i,l){var c=s("./utils"),d=s("./external"),m=s("./utf8"),p=s("./zipEntries"),f=s("./stream/Crc32Probe"),v=s("./nodejsUtils");function _(T){return new d.Promise(function(x,k){var w=T.decompressed.getContentWorker().pipe(new f);w.on("error",function(S){k(S)}).on("end",function(){w.streamInfo.crc32!==T.decompressed.crc32?k(new Error("Corrupted zip : CRC32 mismatch")):x()}).resume()})}i.exports=function(T,x){var k=this;return x=c.extend(x||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:m.utf8decode}),v.isNode&&v.isStream(T)?d.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):c.prepareContent("the loaded zip file",T,!0,x.optimizedBinaryString,x.base64).then(function(w){var S=new p(x);return S.load(w),S}).then(function(w){var S=[d.Promise.resolve(w)],C=w.files;if(x.checkCRC32)for(var R=0;R<C.length;R++)S.push(_(C[R]));return d.Promise.all(S)}).then(function(w){for(var S=w.shift(),C=S.files,R=0;R<C.length;R++){var L=C[R],F=L.fileNameStr,G=c.resolve(L.fileNameStr);k.file(G,L.decompressed,{binary:!0,optimizedBinaryString:!0,date:L.date,dir:L.dir,comment:L.fileCommentStr.length?L.fileCommentStr:null,unixPermissions:L.unixPermissions,dosPermissions:L.dosPermissions,createFolders:x.createFolders}),L.dir||(k.file(G).unsafeOriginalName=F)}return S.zipComment.length&&(k.comment=S.zipComment),k})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(s,i,l){var c=s("../utils"),d=s("../stream/GenericWorker");function m(p,f){d.call(this,"Nodejs stream input adapter for "+p),this._upstreamEnded=!1,this._bindStream(f)}c.inherits(m,d),m.prototype._bindStream=function(p){var f=this;(this._stream=p).pause(),p.on("data",function(v){f.push({data:v,meta:{percent:0}})}).on("error",function(v){f.isPaused?this.generatedError=v:f.error(v)}).on("end",function(){f.isPaused?f._upstreamEnded=!0:f.end()})},m.prototype.pause=function(){return!!d.prototype.pause.call(this)&&(this._stream.pause(),!0)},m.prototype.resume=function(){return!!d.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},i.exports=m},{"../stream/GenericWorker":28,"../utils":32}],13:[function(s,i,l){var c=s("readable-stream").Readable;function d(m,p,f){c.call(this,p),this._helper=m;var v=this;m.on("data",function(_,T){v.push(_)||v._helper.pause(),f&&f(T)}).on("error",function(_){v.emit("error",_)}).on("end",function(){v.push(null)})}s("../utils").inherits(d,c),d.prototype._read=function(){this._helper.resume()},i.exports=d},{"../utils":32,"readable-stream":16}],14:[function(s,i,l){i.exports={isNode:typeof Buffer<"u",newBufferFrom:function(c,d){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(c,d);if(typeof c=="number")throw new Error('The "data" argument must not be a number');return new Buffer(c,d)},allocBuffer:function(c){if(Buffer.alloc)return Buffer.alloc(c);var d=new Buffer(c);return d.fill(0),d},isBuffer:function(c){return Buffer.isBuffer(c)},isStream:function(c){return c&&typeof c.on=="function"&&typeof c.pause=="function"&&typeof c.resume=="function"}}},{}],15:[function(s,i,l){function c(G,Q,U){var j,O=m.getTypeOf(Q),q=m.extend(U||{},v);q.date=q.date||new Date,q.compression!==null&&(q.compression=q.compression.toUpperCase()),typeof q.unixPermissions=="string"&&(q.unixPermissions=parseInt(q.unixPermissions,8)),q.unixPermissions&&16384&q.unixPermissions&&(q.dir=!0),q.dosPermissions&&16&q.dosPermissions&&(q.dir=!0),q.dir&&(G=C(G)),q.createFolders&&(j=S(G))&&R.call(this,j,!0);var ee=O==="string"&&q.binary===!1&&q.base64===!1;U&&U.binary!==void 0||(q.binary=!ee),(Q instanceof _&&Q.uncompressedSize===0||q.dir||!Q||Q.length===0)&&(q.base64=!1,q.binary=!0,Q="",q.compression="STORE",O="string");var M=null;M=Q instanceof _||Q instanceof p?Q:k.isNode&&k.isStream(Q)?new w(G,Q):m.prepareContent(G,Q,q.binary,q.optimizedBinaryString,q.base64);var J=new T(G,M,q);this.files[G]=J}var d=s("./utf8"),m=s("./utils"),p=s("./stream/GenericWorker"),f=s("./stream/StreamHelper"),v=s("./defaults"),_=s("./compressedObject"),T=s("./zipObject"),x=s("./generate"),k=s("./nodejsUtils"),w=s("./nodejs/NodejsStreamInputAdapter"),S=function(G){G.slice(-1)==="/"&&(G=G.substring(0,G.length-1));var Q=G.lastIndexOf("/");return 0<Q?G.substring(0,Q):""},C=function(G){return G.slice(-1)!=="/"&&(G+="/"),G},R=function(G,Q){return Q=Q!==void 0?Q:v.createFolders,G=C(G),this.files[G]||c.call(this,G,null,{dir:!0,createFolders:Q}),this.files[G]};function L(G){return Object.prototype.toString.call(G)==="[object RegExp]"}var F={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(G){var Q,U,j;for(Q in this.files)j=this.files[Q],(U=Q.slice(this.root.length,Q.length))&&Q.slice(0,this.root.length)===this.root&&G(U,j)},filter:function(G){var Q=[];return this.forEach(function(U,j){G(U,j)&&Q.push(j)}),Q},file:function(G,Q,U){if(arguments.length!==1)return G=this.root+G,c.call(this,G,Q,U),this;if(L(G)){var j=G;return this.filter(function(q,ee){return!ee.dir&&j.test(q)})}var O=this.files[this.root+G];return O&&!O.dir?O:null},folder:function(G){if(!G)return this;if(L(G))return this.filter(function(O,q){return q.dir&&G.test(O)});var Q=this.root+G,U=R.call(this,Q),j=this.clone();return j.root=U.name,j},remove:function(G){G=this.root+G;var Q=this.files[G];if(Q||(G.slice(-1)!=="/"&&(G+="/"),Q=this.files[G]),Q&&!Q.dir)delete this.files[G];else for(var U=this.filter(function(O,q){return q.name.slice(0,G.length)===G}),j=0;j<U.length;j++)delete this.files[U[j].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(G){var Q,U={};try{if((U=m.extend(G||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:d.utf8encode})).type=U.type.toLowerCase(),U.compression=U.compression.toUpperCase(),U.type==="binarystring"&&(U.type="string"),!U.type)throw new Error("No output type specified.");m.checkSupport(U.type),U.platform!=="darwin"&&U.platform!=="freebsd"&&U.platform!=="linux"&&U.platform!=="sunos"||(U.platform="UNIX"),U.platform==="win32"&&(U.platform="DOS");var j=U.comment||this.comment||"";Q=x.generateWorker(this,U,j)}catch(O){(Q=new p("error")).error(O)}return new f(Q,U.type||"string",U.mimeType)},generateAsync:function(G,Q){return this.generateInternalStream(G).accumulate(Q)},generateNodeStream:function(G,Q){return(G=G||{}).type||(G.type="nodebuffer"),this.generateInternalStream(G).toNodejsStream(Q)}};i.exports=F},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(s,i,l){i.exports=s("stream")},{stream:void 0}],17:[function(s,i,l){var c=s("./DataReader");function d(m){c.call(this,m);for(var p=0;p<this.data.length;p++)m[p]=255&m[p]}s("../utils").inherits(d,c),d.prototype.byteAt=function(m){return this.data[this.zero+m]},d.prototype.lastIndexOfSignature=function(m){for(var p=m.charCodeAt(0),f=m.charCodeAt(1),v=m.charCodeAt(2),_=m.charCodeAt(3),T=this.length-4;0<=T;--T)if(this.data[T]===p&&this.data[T+1]===f&&this.data[T+2]===v&&this.data[T+3]===_)return T-this.zero;return-1},d.prototype.readAndCheckSignature=function(m){var p=m.charCodeAt(0),f=m.charCodeAt(1),v=m.charCodeAt(2),_=m.charCodeAt(3),T=this.readData(4);return p===T[0]&&f===T[1]&&v===T[2]&&_===T[3]},d.prototype.readData=function(m){if(this.checkOffset(m),m===0)return[];var p=this.data.slice(this.zero+this.index,this.zero+this.index+m);return this.index+=m,p},i.exports=d},{"../utils":32,"./DataReader":18}],18:[function(s,i,l){var c=s("../utils");function d(m){this.data=m,this.length=m.length,this.index=0,this.zero=0}d.prototype={checkOffset:function(m){this.checkIndex(this.index+m)},checkIndex:function(m){if(this.length<this.zero+m||m<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+m+"). Corrupted zip ?")},setIndex:function(m){this.checkIndex(m),this.index=m},skip:function(m){this.setIndex(this.index+m)},byteAt:function(){},readInt:function(m){var p,f=0;for(this.checkOffset(m),p=this.index+m-1;p>=this.index;p--)f=(f<<8)+this.byteAt(p);return this.index+=m,f},readString:function(m){return c.transformTo("string",this.readData(m))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var m=this.readInt(4);return new Date(Date.UTC(1980+(m>>25&127),(m>>21&15)-1,m>>16&31,m>>11&31,m>>5&63,(31&m)<<1))}},i.exports=d},{"../utils":32}],19:[function(s,i,l){var c=s("./Uint8ArrayReader");function d(m){c.call(this,m)}s("../utils").inherits(d,c),d.prototype.readData=function(m){this.checkOffset(m);var p=this.data.slice(this.zero+this.index,this.zero+this.index+m);return this.index+=m,p},i.exports=d},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(s,i,l){var c=s("./DataReader");function d(m){c.call(this,m)}s("../utils").inherits(d,c),d.prototype.byteAt=function(m){return this.data.charCodeAt(this.zero+m)},d.prototype.lastIndexOfSignature=function(m){return this.data.lastIndexOf(m)-this.zero},d.prototype.readAndCheckSignature=function(m){return m===this.readData(4)},d.prototype.readData=function(m){this.checkOffset(m);var p=this.data.slice(this.zero+this.index,this.zero+this.index+m);return this.index+=m,p},i.exports=d},{"../utils":32,"./DataReader":18}],21:[function(s,i,l){var c=s("./ArrayReader");function d(m){c.call(this,m)}s("../utils").inherits(d,c),d.prototype.readData=function(m){if(this.checkOffset(m),m===0)return new Uint8Array(0);var p=this.data.subarray(this.zero+this.index,this.zero+this.index+m);return this.index+=m,p},i.exports=d},{"../utils":32,"./ArrayReader":17}],22:[function(s,i,l){var c=s("../utils"),d=s("../support"),m=s("./ArrayReader"),p=s("./StringReader"),f=s("./NodeBufferReader"),v=s("./Uint8ArrayReader");i.exports=function(_){var T=c.getTypeOf(_);return c.checkSupport(T),T!=="string"||d.uint8array?T==="nodebuffer"?new f(_):d.uint8array?new v(c.transformTo("uint8array",_)):new m(c.transformTo("array",_)):new p(_)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(s,i,l){l.LOCAL_FILE_HEADER="PK",l.CENTRAL_FILE_HEADER="PK",l.CENTRAL_DIRECTORY_END="PK",l.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07",l.ZIP64_CENTRAL_DIRECTORY_END="PK",l.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(s,i,l){var c=s("./GenericWorker"),d=s("../utils");function m(p){c.call(this,"ConvertWorker to "+p),this.destType=p}d.inherits(m,c),m.prototype.processChunk=function(p){this.push({data:d.transformTo(this.destType,p.data),meta:p.meta})},i.exports=m},{"../utils":32,"./GenericWorker":28}],25:[function(s,i,l){var c=s("./GenericWorker"),d=s("../crc32");function m(){c.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}s("../utils").inherits(m,c),m.prototype.processChunk=function(p){this.streamInfo.crc32=d(p.data,this.streamInfo.crc32||0),this.push(p)},i.exports=m},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(s,i,l){var c=s("../utils"),d=s("./GenericWorker");function m(p){d.call(this,"DataLengthProbe for "+p),this.propName=p,this.withStreamInfo(p,0)}c.inherits(m,d),m.prototype.processChunk=function(p){if(p){var f=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=f+p.data.length}d.prototype.processChunk.call(this,p)},i.exports=m},{"../utils":32,"./GenericWorker":28}],27:[function(s,i,l){var c=s("../utils"),d=s("./GenericWorker");function m(p){d.call(this,"DataWorker");var f=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,p.then(function(v){f.dataIsReady=!0,f.data=v,f.max=v&&v.length||0,f.type=c.getTypeOf(v),f.isPaused||f._tickAndRepeat()},function(v){f.error(v)})}c.inherits(m,d),m.prototype.cleanUp=function(){d.prototype.cleanUp.call(this),this.data=null},m.prototype.resume=function(){return!!d.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,c.delay(this._tickAndRepeat,[],this)),!0)},m.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(c.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},m.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var p=null,f=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":p=this.data.substring(this.index,f);break;case"uint8array":p=this.data.subarray(this.index,f);break;case"array":case"nodebuffer":p=this.data.slice(this.index,f)}return this.index=f,this.push({data:p,meta:{percent:this.max?this.index/this.max*100:0}})},i.exports=m},{"../utils":32,"./GenericWorker":28}],28:[function(s,i,l){function c(d){this.name=d||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}c.prototype={push:function(d){this.emit("data",d)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(d){this.emit("error",d)}return!0},error:function(d){return!this.isFinished&&(this.isPaused?this.generatedError=d:(this.isFinished=!0,this.emit("error",d),this.previous&&this.previous.error(d),this.cleanUp()),!0)},on:function(d,m){return this._listeners[d].push(m),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(d,m){if(this._listeners[d])for(var p=0;p<this._listeners[d].length;p++)this._listeners[d][p].call(this,m)},pipe:function(d){return d.registerPrevious(this)},registerPrevious:function(d){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=d.streamInfo,this.mergeStreamInfo(),this.previous=d;var m=this;return d.on("data",function(p){m.processChunk(p)}),d.on("end",function(){m.end()}),d.on("error",function(p){m.error(p)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var d=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),d=!0),this.previous&&this.previous.resume(),!d},flush:function(){},processChunk:function(d){this.push(d)},withStreamInfo:function(d,m){return this.extraStreamInfo[d]=m,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var d in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,d)&&(this.streamInfo[d]=this.extraStreamInfo[d])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var d="Worker "+this.name;return this.previous?this.previous+" -> "+d:d}},i.exports=c},{}],29:[function(s,i,l){var c=s("../utils"),d=s("./ConvertWorker"),m=s("./GenericWorker"),p=s("../base64"),f=s("../support"),v=s("../external"),_=null;if(f.nodestream)try{_=s("../nodejs/NodejsStreamOutputAdapter")}catch{}function T(k,w){return new v.Promise(function(S,C){var R=[],L=k._internalType,F=k._outputType,G=k._mimeType;k.on("data",function(Q,U){R.push(Q),w&&w(U)}).on("error",function(Q){R=[],C(Q)}).on("end",function(){try{var Q=(function(U,j,O){switch(U){case"blob":return c.newBlob(c.transformTo("arraybuffer",j),O);case"base64":return p.encode(j);default:return c.transformTo(U,j)}})(F,(function(U,j){var O,q=0,ee=null,M=0;for(O=0;O<j.length;O++)M+=j[O].length;switch(U){case"string":return j.join("");case"array":return Array.prototype.concat.apply([],j);case"uint8array":for(ee=new Uint8Array(M),O=0;O<j.length;O++)ee.set(j[O],q),q+=j[O].length;return ee;case"nodebuffer":return Buffer.concat(j);default:throw new Error("concat : unsupported type '"+U+"'")}})(L,R),G);S(Q)}catch(U){C(U)}R=[]}).resume()})}function x(k,w,S){var C=w;switch(w){case"blob":case"arraybuffer":C="uint8array";break;case"base64":C="string"}try{this._internalType=C,this._outputType=w,this._mimeType=S,c.checkSupport(C),this._worker=k.pipe(new d(C)),k.lock()}catch(R){this._worker=new m("error"),this._worker.error(R)}}x.prototype={accumulate:function(k){return T(this,k)},on:function(k,w){var S=this;return k==="data"?this._worker.on(k,function(C){w.call(S,C.data,C.meta)}):this._worker.on(k,function(){c.delay(w,arguments,S)}),this},resume:function(){return c.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(k){if(c.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new _(this,{objectMode:this._outputType!=="nodebuffer"},k)}},i.exports=x},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(s,i,l){if(l.base64=!0,l.array=!0,l.string=!0,l.arraybuffer=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u",l.nodebuffer=typeof Buffer<"u",l.uint8array=typeof Uint8Array<"u",typeof ArrayBuffer>"u")l.blob=!1;else{var c=new ArrayBuffer(0);try{l.blob=new Blob([c],{type:"application/zip"}).size===0}catch{try{var d=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);d.append(c),l.blob=d.getBlob("application/zip").size===0}catch{l.blob=!1}}}try{l.nodestream=!!s("readable-stream").Readable}catch{l.nodestream=!1}},{"readable-stream":16}],31:[function(s,i,l){for(var c=s("./utils"),d=s("./support"),m=s("./nodejsUtils"),p=s("./stream/GenericWorker"),f=new Array(256),v=0;v<256;v++)f[v]=252<=v?6:248<=v?5:240<=v?4:224<=v?3:192<=v?2:1;f[254]=f[254]=1;function _(){p.call(this,"utf-8 decode"),this.leftOver=null}function T(){p.call(this,"utf-8 encode")}l.utf8encode=function(x){return d.nodebuffer?m.newBufferFrom(x,"utf-8"):(function(k){var w,S,C,R,L,F=k.length,G=0;for(R=0;R<F;R++)(64512&(S=k.charCodeAt(R)))==55296&&R+1<F&&(64512&(C=k.charCodeAt(R+1)))==56320&&(S=65536+(S-55296<<10)+(C-56320),R++),G+=S<128?1:S<2048?2:S<65536?3:4;for(w=d.uint8array?new Uint8Array(G):new Array(G),R=L=0;L<G;R++)(64512&(S=k.charCodeAt(R)))==55296&&R+1<F&&(64512&(C=k.charCodeAt(R+1)))==56320&&(S=65536+(S-55296<<10)+(C-56320),R++),S<128?w[L++]=S:(S<2048?w[L++]=192|S>>>6:(S<65536?w[L++]=224|S>>>12:(w[L++]=240|S>>>18,w[L++]=128|S>>>12&63),w[L++]=128|S>>>6&63),w[L++]=128|63&S);return w})(x)},l.utf8decode=function(x){return d.nodebuffer?c.transformTo("nodebuffer",x).toString("utf-8"):(function(k){var w,S,C,R,L=k.length,F=new Array(2*L);for(w=S=0;w<L;)if((C=k[w++])<128)F[S++]=C;else if(4<(R=f[C]))F[S++]=65533,w+=R-1;else{for(C&=R===2?31:R===3?15:7;1<R&&w<L;)C=C<<6|63&k[w++],R--;1<R?F[S++]=65533:C<65536?F[S++]=C:(C-=65536,F[S++]=55296|C>>10&1023,F[S++]=56320|1023&C)}return F.length!==S&&(F.subarray?F=F.subarray(0,S):F.length=S),c.applyFromCharCode(F)})(x=c.transformTo(d.uint8array?"uint8array":"array",x))},c.inherits(_,p),_.prototype.processChunk=function(x){var k=c.transformTo(d.uint8array?"uint8array":"array",x.data);if(this.leftOver&&this.leftOver.length){if(d.uint8array){var w=k;(k=new Uint8Array(w.length+this.leftOver.length)).set(this.leftOver,0),k.set(w,this.leftOver.length)}else k=this.leftOver.concat(k);this.leftOver=null}var S=(function(R,L){var F;for((L=L||R.length)>R.length&&(L=R.length),F=L-1;0<=F&&(192&R[F])==128;)F--;return F<0||F===0?L:F+f[R[F]]>L?F:L})(k),C=k;S!==k.length&&(d.uint8array?(C=k.subarray(0,S),this.leftOver=k.subarray(S,k.length)):(C=k.slice(0,S),this.leftOver=k.slice(S,k.length))),this.push({data:l.utf8decode(C),meta:x.meta})},_.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:l.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},l.Utf8DecodeWorker=_,c.inherits(T,p),T.prototype.processChunk=function(x){this.push({data:l.utf8encode(x.data),meta:x.meta})},l.Utf8EncodeWorker=T},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(s,i,l){var c=s("./support"),d=s("./base64"),m=s("./nodejsUtils"),p=s("./external");function f(w){return w}function v(w,S){for(var C=0;C<w.length;++C)S[C]=255&w.charCodeAt(C);return S}s("setimmediate"),l.newBlob=function(w,S){l.checkSupport("blob");try{return new Blob([w],{type:S})}catch{try{var C=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return C.append(w),C.getBlob(S)}catch{throw new Error("Bug : can't construct the Blob.")}}};var _={stringifyByChunk:function(w,S,C){var R=[],L=0,F=w.length;if(F<=C)return String.fromCharCode.apply(null,w);for(;L<F;)S==="array"||S==="nodebuffer"?R.push(String.fromCharCode.apply(null,w.slice(L,Math.min(L+C,F)))):R.push(String.fromCharCode.apply(null,w.subarray(L,Math.min(L+C,F)))),L+=C;return R.join("")},stringifyByChar:function(w){for(var S="",C=0;C<w.length;C++)S+=String.fromCharCode(w[C]);return S},applyCanBeUsed:{uint8array:(function(){try{return c.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch{return!1}})(),nodebuffer:(function(){try{return c.nodebuffer&&String.fromCharCode.apply(null,m.allocBuffer(1)).length===1}catch{return!1}})()}};function T(w){var S=65536,C=l.getTypeOf(w),R=!0;if(C==="uint8array"?R=_.applyCanBeUsed.uint8array:C==="nodebuffer"&&(R=_.applyCanBeUsed.nodebuffer),R)for(;1<S;)try{return _.stringifyByChunk(w,C,S)}catch{S=Math.floor(S/2)}return _.stringifyByChar(w)}function x(w,S){for(var C=0;C<w.length;C++)S[C]=w[C];return S}l.applyFromCharCode=T;var k={};k.string={string:f,array:function(w){return v(w,new Array(w.length))},arraybuffer:function(w){return k.string.uint8array(w).buffer},uint8array:function(w){return v(w,new Uint8Array(w.length))},nodebuffer:function(w){return v(w,m.allocBuffer(w.length))}},k.array={string:T,array:f,arraybuffer:function(w){return new Uint8Array(w).buffer},uint8array:function(w){return new Uint8Array(w)},nodebuffer:function(w){return m.newBufferFrom(w)}},k.arraybuffer={string:function(w){return T(new Uint8Array(w))},array:function(w){return x(new Uint8Array(w),new Array(w.byteLength))},arraybuffer:f,uint8array:function(w){return new Uint8Array(w)},nodebuffer:function(w){return m.newBufferFrom(new Uint8Array(w))}},k.uint8array={string:T,array:function(w){return x(w,new Array(w.length))},arraybuffer:function(w){return w.buffer},uint8array:f,nodebuffer:function(w){return m.newBufferFrom(w)}},k.nodebuffer={string:T,array:function(w){return x(w,new Array(w.length))},arraybuffer:function(w){return k.nodebuffer.uint8array(w).buffer},uint8array:function(w){return x(w,new Uint8Array(w.length))},nodebuffer:f},l.transformTo=function(w,S){if(S=S||"",!w)return S;l.checkSupport(w);var C=l.getTypeOf(S);return k[C][w](S)},l.resolve=function(w){for(var S=w.split("/"),C=[],R=0;R<S.length;R++){var L=S[R];L==="."||L===""&&R!==0&&R!==S.length-1||(L===".."?C.pop():C.push(L))}return C.join("/")},l.getTypeOf=function(w){return typeof w=="string"?"string":Object.prototype.toString.call(w)==="[object Array]"?"array":c.nodebuffer&&m.isBuffer(w)?"nodebuffer":c.uint8array&&w instanceof Uint8Array?"uint8array":c.arraybuffer&&w instanceof ArrayBuffer?"arraybuffer":void 0},l.checkSupport=function(w){if(!c[w.toLowerCase()])throw new Error(w+" is not supported by this platform")},l.MAX_VALUE_16BITS=65535,l.MAX_VALUE_32BITS=-1,l.pretty=function(w){var S,C,R="";for(C=0;C<(w||"").length;C++)R+="\\x"+((S=w.charCodeAt(C))<16?"0":"")+S.toString(16).toUpperCase();return R},l.delay=function(w,S,C){setImmediate(function(){w.apply(C||null,S||[])})},l.inherits=function(w,S){function C(){}C.prototype=S.prototype,w.prototype=new C},l.extend=function(){var w,S,C={};for(w=0;w<arguments.length;w++)for(S in arguments[w])Object.prototype.hasOwnProperty.call(arguments[w],S)&&C[S]===void 0&&(C[S]=arguments[w][S]);return C},l.prepareContent=function(w,S,C,R,L){return p.Promise.resolve(S).then(function(F){return c.blob&&(F instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(F))!==-1)&&typeof FileReader<"u"?new p.Promise(function(G,Q){var U=new FileReader;U.onload=function(j){G(j.target.result)},U.onerror=function(j){Q(j.target.error)},U.readAsArrayBuffer(F)}):F}).then(function(F){var G=l.getTypeOf(F);return G?(G==="arraybuffer"?F=l.transformTo("uint8array",F):G==="string"&&(L?F=d.decode(F):C&&R!==!0&&(F=(function(Q){return v(Q,c.uint8array?new Uint8Array(Q.length):new Array(Q.length))})(F))),F):p.Promise.reject(new Error("Can't read the data of '"+w+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(s,i,l){var c=s("./reader/readerFor"),d=s("./utils"),m=s("./signature"),p=s("./zipEntry"),f=s("./support");function v(_){this.files=[],this.loadOptions=_}v.prototype={checkSignature:function(_){if(!this.reader.readAndCheckSignature(_)){this.reader.index-=4;var T=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+d.pretty(T)+", expected "+d.pretty(_)+")")}},isSignature:function(_,T){var x=this.reader.index;this.reader.setIndex(_);var k=this.reader.readString(4)===T;return this.reader.setIndex(x),k},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var _=this.reader.readData(this.zipCommentLength),T=f.uint8array?"uint8array":"array",x=d.transformTo(T,_);this.zipComment=this.loadOptions.decodeFileName(x)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var _,T,x,k=this.zip64EndOfCentralSize-44;0<k;)_=this.reader.readInt(2),T=this.reader.readInt(4),x=this.reader.readData(T),this.zip64ExtensibleData[_]={id:_,length:T,value:x}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var _,T;for(_=0;_<this.files.length;_++)T=this.files[_],this.reader.setIndex(T.localHeaderOffset),this.checkSignature(m.LOCAL_FILE_HEADER),T.readLocalPart(this.reader),T.handleUTF8(),T.processAttributes()},readCentralDir:function(){var _;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(m.CENTRAL_FILE_HEADER);)(_=new p({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(_);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var _=this.reader.lastIndexOfSignature(m.CENTRAL_DIRECTORY_END);if(_<0)throw this.isSignature(0,m.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(_);var T=_;if(this.checkSignature(m.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===d.MAX_VALUE_16BITS||this.diskWithCentralDirStart===d.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===d.MAX_VALUE_16BITS||this.centralDirRecords===d.MAX_VALUE_16BITS||this.centralDirSize===d.MAX_VALUE_32BITS||this.centralDirOffset===d.MAX_VALUE_32BITS){if(this.zip64=!0,(_=this.reader.lastIndexOfSignature(m.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(_),this.checkSignature(m.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,m.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(m.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(m.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var x=this.centralDirOffset+this.centralDirSize;this.zip64&&(x+=20,x+=12+this.zip64EndOfCentralSize);var k=T-x;if(0<k)this.isSignature(T,m.CENTRAL_FILE_HEADER)||(this.reader.zero=k);else if(k<0)throw new Error("Corrupted zip: missing "+Math.abs(k)+" bytes.")},prepareReader:function(_){this.reader=c(_)},load:function(_){this.prepareReader(_),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},i.exports=v},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(s,i,l){var c=s("./reader/readerFor"),d=s("./utils"),m=s("./compressedObject"),p=s("./crc32"),f=s("./utf8"),v=s("./compressions"),_=s("./support");function T(x,k){this.options=x,this.loadOptions=k}T.prototype={isEncrypted:function(){return(1&this.bitFlag)==1},useUTF8:function(){return(2048&this.bitFlag)==2048},readLocalPart:function(x){var k,w;if(x.skip(22),this.fileNameLength=x.readInt(2),w=x.readInt(2),this.fileName=x.readData(this.fileNameLength),x.skip(w),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if((k=(function(S){for(var C in v)if(Object.prototype.hasOwnProperty.call(v,C)&&v[C].magic===S)return v[C];return null})(this.compressionMethod))===null)throw new Error("Corrupted zip : compression "+d.pretty(this.compressionMethod)+" unknown (inner file : "+d.transformTo("string",this.fileName)+")");this.decompressed=new m(this.compressedSize,this.uncompressedSize,this.crc32,k,x.readData(this.compressedSize))},readCentralPart:function(x){this.versionMadeBy=x.readInt(2),x.skip(2),this.bitFlag=x.readInt(2),this.compressionMethod=x.readString(2),this.date=x.readDate(),this.crc32=x.readInt(4),this.compressedSize=x.readInt(4),this.uncompressedSize=x.readInt(4);var k=x.readInt(2);if(this.extraFieldsLength=x.readInt(2),this.fileCommentLength=x.readInt(2),this.diskNumberStart=x.readInt(2),this.internalFileAttributes=x.readInt(2),this.externalFileAttributes=x.readInt(4),this.localHeaderOffset=x.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");x.skip(k),this.readExtraFields(x),this.parseZIP64ExtraField(x),this.fileComment=x.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var x=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),x==0&&(this.dosPermissions=63&this.externalFileAttributes),x==3&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||this.fileNameStr.slice(-1)!=="/"||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var x=c(this.extraFields[1].value);this.uncompressedSize===d.MAX_VALUE_32BITS&&(this.uncompressedSize=x.readInt(8)),this.compressedSize===d.MAX_VALUE_32BITS&&(this.compressedSize=x.readInt(8)),this.localHeaderOffset===d.MAX_VALUE_32BITS&&(this.localHeaderOffset=x.readInt(8)),this.diskNumberStart===d.MAX_VALUE_32BITS&&(this.diskNumberStart=x.readInt(4))}},readExtraFields:function(x){var k,w,S,C=x.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});x.index+4<C;)k=x.readInt(2),w=x.readInt(2),S=x.readData(w),this.extraFields[k]={id:k,length:w,value:S};x.setIndex(C)},handleUTF8:function(){var x=_.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=f.utf8decode(this.fileName),this.fileCommentStr=f.utf8decode(this.fileComment);else{var k=this.findExtraFieldUnicodePath();if(k!==null)this.fileNameStr=k;else{var w=d.transformTo(x,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(w)}var S=this.findExtraFieldUnicodeComment();if(S!==null)this.fileCommentStr=S;else{var C=d.transformTo(x,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(C)}}},findExtraFieldUnicodePath:function(){var x=this.extraFields[28789];if(x){var k=c(x.value);return k.readInt(1)!==1||p(this.fileName)!==k.readInt(4)?null:f.utf8decode(k.readData(x.length-5))}return null},findExtraFieldUnicodeComment:function(){var x=this.extraFields[25461];if(x){var k=c(x.value);return k.readInt(1)!==1||p(this.fileComment)!==k.readInt(4)?null:f.utf8decode(k.readData(x.length-5))}return null}},i.exports=T},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(s,i,l){function c(k,w,S){this.name=k,this.dir=S.dir,this.date=S.date,this.comment=S.comment,this.unixPermissions=S.unixPermissions,this.dosPermissions=S.dosPermissions,this._data=w,this._dataBinary=S.binary,this.options={compression:S.compression,compressionOptions:S.compressionOptions}}var d=s("./stream/StreamHelper"),m=s("./stream/DataWorker"),p=s("./utf8"),f=s("./compressedObject"),v=s("./stream/GenericWorker");c.prototype={internalStream:function(k){var w=null,S="string";try{if(!k)throw new Error("No output type specified.");var C=(S=k.toLowerCase())==="string"||S==="text";S!=="binarystring"&&S!=="text"||(S="string"),w=this._decompressWorker();var R=!this._dataBinary;R&&!C&&(w=w.pipe(new p.Utf8EncodeWorker)),!R&&C&&(w=w.pipe(new p.Utf8DecodeWorker))}catch(L){(w=new v("error")).error(L)}return new d(w,S,"")},async:function(k,w){return this.internalStream(k).accumulate(w)},nodeStream:function(k,w){return this.internalStream(k||"nodebuffer").toNodejsStream(w)},_compressWorker:function(k,w){if(this._data instanceof f&&this._data.compression.magic===k.magic)return this._data.getCompressedWorker();var S=this._decompressWorker();return this._dataBinary||(S=S.pipe(new p.Utf8EncodeWorker)),f.createWorkerFrom(S,k,w)},_decompressWorker:function(){return this._data instanceof f?this._data.getContentWorker():this._data instanceof v?this._data:new m(this._data)}};for(var _=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],T=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},x=0;x<_.length;x++)c.prototype[_[x]]=T;i.exports=c},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(s,i,l){(function(c){var d,m,p=c.MutationObserver||c.WebKitMutationObserver;if(p){var f=0,v=new p(k),_=c.document.createTextNode("");v.observe(_,{characterData:!0}),d=function(){_.data=f=++f%2}}else if(c.setImmediate||c.MessageChannel===void 0)d="document"in c&&"onreadystatechange"in c.document.createElement("script")?function(){var w=c.document.createElement("script");w.onreadystatechange=function(){k(),w.onreadystatechange=null,w.parentNode.removeChild(w),w=null},c.document.documentElement.appendChild(w)}:function(){setTimeout(k,0)};else{var T=new c.MessageChannel;T.port1.onmessage=k,d=function(){T.port2.postMessage(0)}}var x=[];function k(){var w,S;m=!0;for(var C=x.length;C;){for(S=x,x=[],w=-1;++w<C;)S[w]();C=x.length}m=!1}i.exports=function(w){x.push(w)!==1||m||d()}}).call(this,typeof Kc<"u"?Kc:typeof self<"u"?self:typeof window<"u"?window:{})},{}],37:[function(s,i,l){var c=s("immediate");function d(){}var m={},p=["REJECTED"],f=["FULFILLED"],v=["PENDING"];function _(C){if(typeof C!="function")throw new TypeError("resolver must be a function");this.state=v,this.queue=[],this.outcome=void 0,C!==d&&w(this,C)}function T(C,R,L){this.promise=C,typeof R=="function"&&(this.onFulfilled=R,this.callFulfilled=this.otherCallFulfilled),typeof L=="function"&&(this.onRejected=L,this.callRejected=this.otherCallRejected)}function x(C,R,L){c(function(){var F;try{F=R(L)}catch(G){return m.reject(C,G)}F===C?m.reject(C,new TypeError("Cannot resolve promise with itself")):m.resolve(C,F)})}function k(C){var R=C&&C.then;if(C&&(typeof C=="object"||typeof C=="function")&&typeof R=="function")return function(){R.apply(C,arguments)}}function w(C,R){var L=!1;function F(U){L||(L=!0,m.reject(C,U))}function G(U){L||(L=!0,m.resolve(C,U))}var Q=S(function(){R(G,F)});Q.status==="error"&&F(Q.value)}function S(C,R){var L={};try{L.value=C(R),L.status="success"}catch(F){L.status="error",L.value=F}return L}(i.exports=_).prototype.finally=function(C){if(typeof C!="function")return this;var R=this.constructor;return this.then(function(L){return R.resolve(C()).then(function(){return L})},function(L){return R.resolve(C()).then(function(){throw L})})},_.prototype.catch=function(C){return this.then(null,C)},_.prototype.then=function(C,R){if(typeof C!="function"&&this.state===f||typeof R!="function"&&this.state===p)return this;var L=new this.constructor(d);return this.state!==v?x(L,this.state===f?C:R,this.outcome):this.queue.push(new T(L,C,R)),L},T.prototype.callFulfilled=function(C){m.resolve(this.promise,C)},T.prototype.otherCallFulfilled=function(C){x(this.promise,this.onFulfilled,C)},T.prototype.callRejected=function(C){m.reject(this.promise,C)},T.prototype.otherCallRejected=function(C){x(this.promise,this.onRejected,C)},m.resolve=function(C,R){var L=S(k,R);if(L.status==="error")return m.reject(C,L.value);var F=L.value;if(F)w(C,F);else{C.state=f,C.outcome=R;for(var G=-1,Q=C.queue.length;++G<Q;)C.queue[G].callFulfilled(R)}return C},m.reject=function(C,R){C.state=p,C.outcome=R;for(var L=-1,F=C.queue.length;++L<F;)C.queue[L].callRejected(R);return C},_.resolve=function(C){return C instanceof this?C:m.resolve(new this(d),C)},_.reject=function(C){var R=new this(d);return m.reject(R,C)},_.all=function(C){var R=this;if(Object.prototype.toString.call(C)!=="[object Array]")return this.reject(new TypeError("must be an array"));var L=C.length,F=!1;if(!L)return this.resolve([]);for(var G=new Array(L),Q=0,U=-1,j=new this(d);++U<L;)O(C[U],U);return j;function O(q,ee){R.resolve(q).then(function(M){G[ee]=M,++Q!==L||F||(F=!0,m.resolve(j,G))},function(M){F||(F=!0,m.reject(j,M))})}},_.race=function(C){var R=this;if(Object.prototype.toString.call(C)!=="[object Array]")return this.reject(new TypeError("must be an array"));var L=C.length,F=!1;if(!L)return this.resolve([]);for(var G=-1,Q=new this(d);++G<L;)U=C[G],R.resolve(U).then(function(j){F||(F=!0,m.resolve(Q,j))},function(j){F||(F=!0,m.reject(Q,j))});var U;return Q}},{immediate:36}],38:[function(s,i,l){var c={};(0,s("./lib/utils/common").assign)(c,s("./lib/deflate"),s("./lib/inflate"),s("./lib/zlib/constants")),i.exports=c},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(s,i,l){var c=s("./zlib/deflate"),d=s("./utils/common"),m=s("./utils/strings"),p=s("./zlib/messages"),f=s("./zlib/zstream"),v=Object.prototype.toString,_=0,T=-1,x=0,k=8;function w(C){if(!(this instanceof w))return new w(C);this.options=d.assign({level:T,method:k,chunkSize:16384,windowBits:15,memLevel:8,strategy:x,to:""},C||{});var R=this.options;R.raw&&0<R.windowBits?R.windowBits=-R.windowBits:R.gzip&&0<R.windowBits&&R.windowBits<16&&(R.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new f,this.strm.avail_out=0;var L=c.deflateInit2(this.strm,R.level,R.method,R.windowBits,R.memLevel,R.strategy);if(L!==_)throw new Error(p[L]);if(R.header&&c.deflateSetHeader(this.strm,R.header),R.dictionary){var F;if(F=typeof R.dictionary=="string"?m.string2buf(R.dictionary):v.call(R.dictionary)==="[object ArrayBuffer]"?new Uint8Array(R.dictionary):R.dictionary,(L=c.deflateSetDictionary(this.strm,F))!==_)throw new Error(p[L]);this._dict_set=!0}}function S(C,R){var L=new w(R);if(L.push(C,!0),L.err)throw L.msg||p[L.err];return L.result}w.prototype.push=function(C,R){var L,F,G=this.strm,Q=this.options.chunkSize;if(this.ended)return!1;F=R===~~R?R:R===!0?4:0,typeof C=="string"?G.input=m.string2buf(C):v.call(C)==="[object ArrayBuffer]"?G.input=new Uint8Array(C):G.input=C,G.next_in=0,G.avail_in=G.input.length;do{if(G.avail_out===0&&(G.output=new d.Buf8(Q),G.next_out=0,G.avail_out=Q),(L=c.deflate(G,F))!==1&&L!==_)return this.onEnd(L),!(this.ended=!0);G.avail_out!==0&&(G.avail_in!==0||F!==4&&F!==2)||(this.options.to==="string"?this.onData(m.buf2binstring(d.shrinkBuf(G.output,G.next_out))):this.onData(d.shrinkBuf(G.output,G.next_out)))}while((0<G.avail_in||G.avail_out===0)&&L!==1);return F===4?(L=c.deflateEnd(this.strm),this.onEnd(L),this.ended=!0,L===_):F!==2||(this.onEnd(_),!(G.avail_out=0))},w.prototype.onData=function(C){this.chunks.push(C)},w.prototype.onEnd=function(C){C===_&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=d.flattenChunks(this.chunks)),this.chunks=[],this.err=C,this.msg=this.strm.msg},l.Deflate=w,l.deflate=S,l.deflateRaw=function(C,R){return(R=R||{}).raw=!0,S(C,R)},l.gzip=function(C,R){return(R=R||{}).gzip=!0,S(C,R)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(s,i,l){var c=s("./zlib/inflate"),d=s("./utils/common"),m=s("./utils/strings"),p=s("./zlib/constants"),f=s("./zlib/messages"),v=s("./zlib/zstream"),_=s("./zlib/gzheader"),T=Object.prototype.toString;function x(w){if(!(this instanceof x))return new x(w);this.options=d.assign({chunkSize:16384,windowBits:0,to:""},w||{});var S=this.options;S.raw&&0<=S.windowBits&&S.windowBits<16&&(S.windowBits=-S.windowBits,S.windowBits===0&&(S.windowBits=-15)),!(0<=S.windowBits&&S.windowBits<16)||w&&w.windowBits||(S.windowBits+=32),15<S.windowBits&&S.windowBits<48&&(15&S.windowBits)==0&&(S.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new v,this.strm.avail_out=0;var C=c.inflateInit2(this.strm,S.windowBits);if(C!==p.Z_OK)throw new Error(f[C]);this.header=new _,c.inflateGetHeader(this.strm,this.header)}function k(w,S){var C=new x(S);if(C.push(w,!0),C.err)throw C.msg||f[C.err];return C.result}x.prototype.push=function(w,S){var C,R,L,F,G,Q,U=this.strm,j=this.options.chunkSize,O=this.options.dictionary,q=!1;if(this.ended)return!1;R=S===~~S?S:S===!0?p.Z_FINISH:p.Z_NO_FLUSH,typeof w=="string"?U.input=m.binstring2buf(w):T.call(w)==="[object ArrayBuffer]"?U.input=new Uint8Array(w):U.input=w,U.next_in=0,U.avail_in=U.input.length;do{if(U.avail_out===0&&(U.output=new d.Buf8(j),U.next_out=0,U.avail_out=j),(C=c.inflate(U,p.Z_NO_FLUSH))===p.Z_NEED_DICT&&O&&(Q=typeof O=="string"?m.string2buf(O):T.call(O)==="[object ArrayBuffer]"?new Uint8Array(O):O,C=c.inflateSetDictionary(this.strm,Q)),C===p.Z_BUF_ERROR&&q===!0&&(C=p.Z_OK,q=!1),C!==p.Z_STREAM_END&&C!==p.Z_OK)return this.onEnd(C),!(this.ended=!0);U.next_out&&(U.avail_out!==0&&C!==p.Z_STREAM_END&&(U.avail_in!==0||R!==p.Z_FINISH&&R!==p.Z_SYNC_FLUSH)||(this.options.to==="string"?(L=m.utf8border(U.output,U.next_out),F=U.next_out-L,G=m.buf2string(U.output,L),U.next_out=F,U.avail_out=j-F,F&&d.arraySet(U.output,U.output,L,F,0),this.onData(G)):this.onData(d.shrinkBuf(U.output,U.next_out)))),U.avail_in===0&&U.avail_out===0&&(q=!0)}while((0<U.avail_in||U.avail_out===0)&&C!==p.Z_STREAM_END);return C===p.Z_STREAM_END&&(R=p.Z_FINISH),R===p.Z_FINISH?(C=c.inflateEnd(this.strm),this.onEnd(C),this.ended=!0,C===p.Z_OK):R!==p.Z_SYNC_FLUSH||(this.onEnd(p.Z_OK),!(U.avail_out=0))},x.prototype.onData=function(w){this.chunks.push(w)},x.prototype.onEnd=function(w){w===p.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=d.flattenChunks(this.chunks)),this.chunks=[],this.err=w,this.msg=this.strm.msg},l.Inflate=x,l.inflate=k,l.inflateRaw=function(w,S){return(S=S||{}).raw=!0,k(w,S)},l.ungzip=k},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(s,i,l){var c=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";l.assign=function(p){for(var f=Array.prototype.slice.call(arguments,1);f.length;){var v=f.shift();if(v){if(typeof v!="object")throw new TypeError(v+"must be non-object");for(var _ in v)v.hasOwnProperty(_)&&(p[_]=v[_])}}return p},l.shrinkBuf=function(p,f){return p.length===f?p:p.subarray?p.subarray(0,f):(p.length=f,p)};var d={arraySet:function(p,f,v,_,T){if(f.subarray&&p.subarray)p.set(f.subarray(v,v+_),T);else for(var x=0;x<_;x++)p[T+x]=f[v+x]},flattenChunks:function(p){var f,v,_,T,x,k;for(f=_=0,v=p.length;f<v;f++)_+=p[f].length;for(k=new Uint8Array(_),f=T=0,v=p.length;f<v;f++)x=p[f],k.set(x,T),T+=x.length;return k}},m={arraySet:function(p,f,v,_,T){for(var x=0;x<_;x++)p[T+x]=f[v+x]},flattenChunks:function(p){return[].concat.apply([],p)}};l.setTyped=function(p){p?(l.Buf8=Uint8Array,l.Buf16=Uint16Array,l.Buf32=Int32Array,l.assign(l,d)):(l.Buf8=Array,l.Buf16=Array,l.Buf32=Array,l.assign(l,m))},l.setTyped(c)},{}],42:[function(s,i,l){var c=s("./common"),d=!0,m=!0;try{String.fromCharCode.apply(null,[0])}catch{d=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{m=!1}for(var p=new c.Buf8(256),f=0;f<256;f++)p[f]=252<=f?6:248<=f?5:240<=f?4:224<=f?3:192<=f?2:1;function v(_,T){if(T<65537&&(_.subarray&&m||!_.subarray&&d))return String.fromCharCode.apply(null,c.shrinkBuf(_,T));for(var x="",k=0;k<T;k++)x+=String.fromCharCode(_[k]);return x}p[254]=p[254]=1,l.string2buf=function(_){var T,x,k,w,S,C=_.length,R=0;for(w=0;w<C;w++)(64512&(x=_.charCodeAt(w)))==55296&&w+1<C&&(64512&(k=_.charCodeAt(w+1)))==56320&&(x=65536+(x-55296<<10)+(k-56320),w++),R+=x<128?1:x<2048?2:x<65536?3:4;for(T=new c.Buf8(R),w=S=0;S<R;w++)(64512&(x=_.charCodeAt(w)))==55296&&w+1<C&&(64512&(k=_.charCodeAt(w+1)))==56320&&(x=65536+(x-55296<<10)+(k-56320),w++),x<128?T[S++]=x:(x<2048?T[S++]=192|x>>>6:(x<65536?T[S++]=224|x>>>12:(T[S++]=240|x>>>18,T[S++]=128|x>>>12&63),T[S++]=128|x>>>6&63),T[S++]=128|63&x);return T},l.buf2binstring=function(_){return v(_,_.length)},l.binstring2buf=function(_){for(var T=new c.Buf8(_.length),x=0,k=T.length;x<k;x++)T[x]=_.charCodeAt(x);return T},l.buf2string=function(_,T){var x,k,w,S,C=T||_.length,R=new Array(2*C);for(x=k=0;x<C;)if((w=_[x++])<128)R[k++]=w;else if(4<(S=p[w]))R[k++]=65533,x+=S-1;else{for(w&=S===2?31:S===3?15:7;1<S&&x<C;)w=w<<6|63&_[x++],S--;1<S?R[k++]=65533:w<65536?R[k++]=w:(w-=65536,R[k++]=55296|w>>10&1023,R[k++]=56320|1023&w)}return v(R,k)},l.utf8border=function(_,T){var x;for((T=T||_.length)>_.length&&(T=_.length),x=T-1;0<=x&&(192&_[x])==128;)x--;return x<0||x===0?T:x+p[_[x]]>T?x:T}},{"./common":41}],43:[function(s,i,l){i.exports=function(c,d,m,p){for(var f=65535&c|0,v=c>>>16&65535|0,_=0;m!==0;){for(m-=_=2e3<m?2e3:m;v=v+(f=f+d[p++]|0)|0,--_;);f%=65521,v%=65521}return f|v<<16|0}},{}],44:[function(s,i,l){i.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(s,i,l){var c=(function(){for(var d,m=[],p=0;p<256;p++){d=p;for(var f=0;f<8;f++)d=1&d?3988292384^d>>>1:d>>>1;m[p]=d}return m})();i.exports=function(d,m,p,f){var v=c,_=f+p;d^=-1;for(var T=f;T<_;T++)d=d>>>8^v[255&(d^m[T])];return-1^d}},{}],46:[function(s,i,l){var c,d=s("../utils/common"),m=s("./trees"),p=s("./adler32"),f=s("./crc32"),v=s("./messages"),_=0,T=4,x=0,k=-2,w=-1,S=4,C=2,R=8,L=9,F=286,G=30,Q=19,U=2*F+1,j=15,O=3,q=258,ee=q+O+1,M=42,J=113,N=1,se=2,K=3,P=4;function ve(E,me){return E.msg=v[me],me}function ce(E){return(E<<1)-(4<E?9:0)}function Ee(E){for(var me=E.length;0<=--me;)E[me]=0}function z(E){var me=E.state,X=me.pending;X>E.avail_out&&(X=E.avail_out),X!==0&&(d.arraySet(E.output,me.pending_buf,me.pending_out,X,E.next_out),E.next_out+=X,me.pending_out+=X,E.total_out+=X,E.avail_out-=X,me.pending-=X,me.pending===0&&(me.pending_out=0))}function I(E,me){m._tr_flush_block(E,0<=E.block_start?E.block_start:-1,E.strstart-E.block_start,me),E.block_start=E.strstart,z(E.strm)}function te(E,me){E.pending_buf[E.pending++]=me}function ae(E,me){E.pending_buf[E.pending++]=me>>>8&255,E.pending_buf[E.pending++]=255&me}function $(E,me){var X,Z,Y=E.max_chain_length,ie=E.strstart,ke=E.prev_length,Ce=E.nice_match,pe=E.strstart>E.w_size-ee?E.strstart-(E.w_size-ee):0,Ie=E.window,He=E.w_mask,Oe=E.prev,qe=E.strstart+q,nt=Ie[ie+ke-1],We=Ie[ie+ke];E.prev_length>=E.good_match&&(Y>>=2),Ce>E.lookahead&&(Ce=E.lookahead);do if(Ie[(X=me)+ke]===We&&Ie[X+ke-1]===nt&&Ie[X]===Ie[ie]&&Ie[++X]===Ie[ie+1]){ie+=2,X++;do;while(Ie[++ie]===Ie[++X]&&Ie[++ie]===Ie[++X]&&Ie[++ie]===Ie[++X]&&Ie[++ie]===Ie[++X]&&Ie[++ie]===Ie[++X]&&Ie[++ie]===Ie[++X]&&Ie[++ie]===Ie[++X]&&Ie[++ie]===Ie[++X]&&ie<qe);if(Z=q-(qe-ie),ie=qe-q,ke<Z){if(E.match_start=me,Ce<=(ke=Z))break;nt=Ie[ie+ke-1],We=Ie[ie+ke]}}while((me=Oe[me&He])>pe&&--Y!=0);return ke<=E.lookahead?ke:E.lookahead}function ue(E){var me,X,Z,Y,ie,ke,Ce,pe,Ie,He,Oe=E.w_size;do{if(Y=E.window_size-E.lookahead-E.strstart,E.strstart>=Oe+(Oe-ee)){for(d.arraySet(E.window,E.window,Oe,Oe,0),E.match_start-=Oe,E.strstart-=Oe,E.block_start-=Oe,me=X=E.hash_size;Z=E.head[--me],E.head[me]=Oe<=Z?Z-Oe:0,--X;);for(me=X=Oe;Z=E.prev[--me],E.prev[me]=Oe<=Z?Z-Oe:0,--X;);Y+=Oe}if(E.strm.avail_in===0)break;if(ke=E.strm,Ce=E.window,pe=E.strstart+E.lookahead,Ie=Y,He=void 0,He=ke.avail_in,Ie<He&&(He=Ie),X=He===0?0:(ke.avail_in-=He,d.arraySet(Ce,ke.input,ke.next_in,He,pe),ke.state.wrap===1?ke.adler=p(ke.adler,Ce,He,pe):ke.state.wrap===2&&(ke.adler=f(ke.adler,Ce,He,pe)),ke.next_in+=He,ke.total_in+=He,He),E.lookahead+=X,E.lookahead+E.insert>=O)for(ie=E.strstart-E.insert,E.ins_h=E.window[ie],E.ins_h=(E.ins_h<<E.hash_shift^E.window[ie+1])&E.hash_mask;E.insert&&(E.ins_h=(E.ins_h<<E.hash_shift^E.window[ie+O-1])&E.hash_mask,E.prev[ie&E.w_mask]=E.head[E.ins_h],E.head[E.ins_h]=ie,ie++,E.insert--,!(E.lookahead+E.insert<O)););}while(E.lookahead<ee&&E.strm.avail_in!==0)}function de(E,me){for(var X,Z;;){if(E.lookahead<ee){if(ue(E),E.lookahead<ee&&me===_)return N;if(E.lookahead===0)break}if(X=0,E.lookahead>=O&&(E.ins_h=(E.ins_h<<E.hash_shift^E.window[E.strstart+O-1])&E.hash_mask,X=E.prev[E.strstart&E.w_mask]=E.head[E.ins_h],E.head[E.ins_h]=E.strstart),X!==0&&E.strstart-X<=E.w_size-ee&&(E.match_length=$(E,X)),E.match_length>=O)if(Z=m._tr_tally(E,E.strstart-E.match_start,E.match_length-O),E.lookahead-=E.match_length,E.match_length<=E.max_lazy_match&&E.lookahead>=O){for(E.match_length--;E.strstart++,E.ins_h=(E.ins_h<<E.hash_shift^E.window[E.strstart+O-1])&E.hash_mask,X=E.prev[E.strstart&E.w_mask]=E.head[E.ins_h],E.head[E.ins_h]=E.strstart,--E.match_length!=0;);E.strstart++}else E.strstart+=E.match_length,E.match_length=0,E.ins_h=E.window[E.strstart],E.ins_h=(E.ins_h<<E.hash_shift^E.window[E.strstart+1])&E.hash_mask;else Z=m._tr_tally(E,0,E.window[E.strstart]),E.lookahead--,E.strstart++;if(Z&&(I(E,!1),E.strm.avail_out===0))return N}return E.insert=E.strstart<O-1?E.strstart:O-1,me===T?(I(E,!0),E.strm.avail_out===0?K:P):E.last_lit&&(I(E,!1),E.strm.avail_out===0)?N:se}function oe(E,me){for(var X,Z,Y;;){if(E.lookahead<ee){if(ue(E),E.lookahead<ee&&me===_)return N;if(E.lookahead===0)break}if(X=0,E.lookahead>=O&&(E.ins_h=(E.ins_h<<E.hash_shift^E.window[E.strstart+O-1])&E.hash_mask,X=E.prev[E.strstart&E.w_mask]=E.head[E.ins_h],E.head[E.ins_h]=E.strstart),E.prev_length=E.match_length,E.prev_match=E.match_start,E.match_length=O-1,X!==0&&E.prev_length<E.max_lazy_match&&E.strstart-X<=E.w_size-ee&&(E.match_length=$(E,X),E.match_length<=5&&(E.strategy===1||E.match_length===O&&4096<E.strstart-E.match_start)&&(E.match_length=O-1)),E.prev_length>=O&&E.match_length<=E.prev_length){for(Y=E.strstart+E.lookahead-O,Z=m._tr_tally(E,E.strstart-1-E.prev_match,E.prev_length-O),E.lookahead-=E.prev_length-1,E.prev_length-=2;++E.strstart<=Y&&(E.ins_h=(E.ins_h<<E.hash_shift^E.window[E.strstart+O-1])&E.hash_mask,X=E.prev[E.strstart&E.w_mask]=E.head[E.ins_h],E.head[E.ins_h]=E.strstart),--E.prev_length!=0;);if(E.match_available=0,E.match_length=O-1,E.strstart++,Z&&(I(E,!1),E.strm.avail_out===0))return N}else if(E.match_available){if((Z=m._tr_tally(E,0,E.window[E.strstart-1]))&&I(E,!1),E.strstart++,E.lookahead--,E.strm.avail_out===0)return N}else E.match_available=1,E.strstart++,E.lookahead--}return E.match_available&&(Z=m._tr_tally(E,0,E.window[E.strstart-1]),E.match_available=0),E.insert=E.strstart<O-1?E.strstart:O-1,me===T?(I(E,!0),E.strm.avail_out===0?K:P):E.last_lit&&(I(E,!1),E.strm.avail_out===0)?N:se}function le(E,me,X,Z,Y){this.good_length=E,this.max_lazy=me,this.nice_length=X,this.max_chain=Z,this.func=Y}function Le(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=R,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new d.Buf16(2*U),this.dyn_dtree=new d.Buf16(2*(2*G+1)),this.bl_tree=new d.Buf16(2*(2*Q+1)),Ee(this.dyn_ltree),Ee(this.dyn_dtree),Ee(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new d.Buf16(j+1),this.heap=new d.Buf16(2*F+1),Ee(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new d.Buf16(2*F+1),Ee(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function De(E){var me;return E&&E.state?(E.total_in=E.total_out=0,E.data_type=C,(me=E.state).pending=0,me.pending_out=0,me.wrap<0&&(me.wrap=-me.wrap),me.status=me.wrap?M:J,E.adler=me.wrap===2?0:1,me.last_flush=_,m._tr_init(me),x):ve(E,k)}function Se(E){var me=De(E);return me===x&&(function(X){X.window_size=2*X.w_size,Ee(X.head),X.max_lazy_match=c[X.level].max_lazy,X.good_match=c[X.level].good_length,X.nice_match=c[X.level].nice_length,X.max_chain_length=c[X.level].max_chain,X.strstart=0,X.block_start=0,X.lookahead=0,X.insert=0,X.match_length=X.prev_length=O-1,X.match_available=0,X.ins_h=0})(E.state),me}function ne(E,me,X,Z,Y,ie){if(!E)return k;var ke=1;if(me===w&&(me=6),Z<0?(ke=0,Z=-Z):15<Z&&(ke=2,Z-=16),Y<1||L<Y||X!==R||Z<8||15<Z||me<0||9<me||ie<0||S<ie)return ve(E,k);Z===8&&(Z=9);var Ce=new Le;return(E.state=Ce).strm=E,Ce.wrap=ke,Ce.gzhead=null,Ce.w_bits=Z,Ce.w_size=1<<Ce.w_bits,Ce.w_mask=Ce.w_size-1,Ce.hash_bits=Y+7,Ce.hash_size=1<<Ce.hash_bits,Ce.hash_mask=Ce.hash_size-1,Ce.hash_shift=~~((Ce.hash_bits+O-1)/O),Ce.window=new d.Buf8(2*Ce.w_size),Ce.head=new d.Buf16(Ce.hash_size),Ce.prev=new d.Buf16(Ce.w_size),Ce.lit_bufsize=1<<Y+6,Ce.pending_buf_size=4*Ce.lit_bufsize,Ce.pending_buf=new d.Buf8(Ce.pending_buf_size),Ce.d_buf=1*Ce.lit_bufsize,Ce.l_buf=3*Ce.lit_bufsize,Ce.level=me,Ce.strategy=ie,Ce.method=X,Se(E)}c=[new le(0,0,0,0,function(E,me){var X=65535;for(X>E.pending_buf_size-5&&(X=E.pending_buf_size-5);;){if(E.lookahead<=1){if(ue(E),E.lookahead===0&&me===_)return N;if(E.lookahead===0)break}E.strstart+=E.lookahead,E.lookahead=0;var Z=E.block_start+X;if((E.strstart===0||E.strstart>=Z)&&(E.lookahead=E.strstart-Z,E.strstart=Z,I(E,!1),E.strm.avail_out===0)||E.strstart-E.block_start>=E.w_size-ee&&(I(E,!1),E.strm.avail_out===0))return N}return E.insert=0,me===T?(I(E,!0),E.strm.avail_out===0?K:P):(E.strstart>E.block_start&&(I(E,!1),E.strm.avail_out),N)}),new le(4,4,8,4,de),new le(4,5,16,8,de),new le(4,6,32,32,de),new le(4,4,16,16,oe),new le(8,16,32,32,oe),new le(8,16,128,128,oe),new le(8,32,128,256,oe),new le(32,128,258,1024,oe),new le(32,258,258,4096,oe)],l.deflateInit=function(E,me){return ne(E,me,R,15,8,0)},l.deflateInit2=ne,l.deflateReset=Se,l.deflateResetKeep=De,l.deflateSetHeader=function(E,me){return E&&E.state?E.state.wrap!==2?k:(E.state.gzhead=me,x):k},l.deflate=function(E,me){var X,Z,Y,ie;if(!E||!E.state||5<me||me<0)return E?ve(E,k):k;if(Z=E.state,!E.output||!E.input&&E.avail_in!==0||Z.status===666&&me!==T)return ve(E,E.avail_out===0?-5:k);if(Z.strm=E,X=Z.last_flush,Z.last_flush=me,Z.status===M)if(Z.wrap===2)E.adler=0,te(Z,31),te(Z,139),te(Z,8),Z.gzhead?(te(Z,(Z.gzhead.text?1:0)+(Z.gzhead.hcrc?2:0)+(Z.gzhead.extra?4:0)+(Z.gzhead.name?8:0)+(Z.gzhead.comment?16:0)),te(Z,255&Z.gzhead.time),te(Z,Z.gzhead.time>>8&255),te(Z,Z.gzhead.time>>16&255),te(Z,Z.gzhead.time>>24&255),te(Z,Z.level===9?2:2<=Z.strategy||Z.level<2?4:0),te(Z,255&Z.gzhead.os),Z.gzhead.extra&&Z.gzhead.extra.length&&(te(Z,255&Z.gzhead.extra.length),te(Z,Z.gzhead.extra.length>>8&255)),Z.gzhead.hcrc&&(E.adler=f(E.adler,Z.pending_buf,Z.pending,0)),Z.gzindex=0,Z.status=69):(te(Z,0),te(Z,0),te(Z,0),te(Z,0),te(Z,0),te(Z,Z.level===9?2:2<=Z.strategy||Z.level<2?4:0),te(Z,3),Z.status=J);else{var ke=R+(Z.w_bits-8<<4)<<8;ke|=(2<=Z.strategy||Z.level<2?0:Z.level<6?1:Z.level===6?2:3)<<6,Z.strstart!==0&&(ke|=32),ke+=31-ke%31,Z.status=J,ae(Z,ke),Z.strstart!==0&&(ae(Z,E.adler>>>16),ae(Z,65535&E.adler)),E.adler=1}if(Z.status===69)if(Z.gzhead.extra){for(Y=Z.pending;Z.gzindex<(65535&Z.gzhead.extra.length)&&(Z.pending!==Z.pending_buf_size||(Z.gzhead.hcrc&&Z.pending>Y&&(E.adler=f(E.adler,Z.pending_buf,Z.pending-Y,Y)),z(E),Y=Z.pending,Z.pending!==Z.pending_buf_size));)te(Z,255&Z.gzhead.extra[Z.gzindex]),Z.gzindex++;Z.gzhead.hcrc&&Z.pending>Y&&(E.adler=f(E.adler,Z.pending_buf,Z.pending-Y,Y)),Z.gzindex===Z.gzhead.extra.length&&(Z.gzindex=0,Z.status=73)}else Z.status=73;if(Z.status===73)if(Z.gzhead.name){Y=Z.pending;do{if(Z.pending===Z.pending_buf_size&&(Z.gzhead.hcrc&&Z.pending>Y&&(E.adler=f(E.adler,Z.pending_buf,Z.pending-Y,Y)),z(E),Y=Z.pending,Z.pending===Z.pending_buf_size)){ie=1;break}ie=Z.gzindex<Z.gzhead.name.length?255&Z.gzhead.name.charCodeAt(Z.gzindex++):0,te(Z,ie)}while(ie!==0);Z.gzhead.hcrc&&Z.pending>Y&&(E.adler=f(E.adler,Z.pending_buf,Z.pending-Y,Y)),ie===0&&(Z.gzindex=0,Z.status=91)}else Z.status=91;if(Z.status===91)if(Z.gzhead.comment){Y=Z.pending;do{if(Z.pending===Z.pending_buf_size&&(Z.gzhead.hcrc&&Z.pending>Y&&(E.adler=f(E.adler,Z.pending_buf,Z.pending-Y,Y)),z(E),Y=Z.pending,Z.pending===Z.pending_buf_size)){ie=1;break}ie=Z.gzindex<Z.gzhead.comment.length?255&Z.gzhead.comment.charCodeAt(Z.gzindex++):0,te(Z,ie)}while(ie!==0);Z.gzhead.hcrc&&Z.pending>Y&&(E.adler=f(E.adler,Z.pending_buf,Z.pending-Y,Y)),ie===0&&(Z.status=103)}else Z.status=103;if(Z.status===103&&(Z.gzhead.hcrc?(Z.pending+2>Z.pending_buf_size&&z(E),Z.pending+2<=Z.pending_buf_size&&(te(Z,255&E.adler),te(Z,E.adler>>8&255),E.adler=0,Z.status=J)):Z.status=J),Z.pending!==0){if(z(E),E.avail_out===0)return Z.last_flush=-1,x}else if(E.avail_in===0&&ce(me)<=ce(X)&&me!==T)return ve(E,-5);if(Z.status===666&&E.avail_in!==0)return ve(E,-5);if(E.avail_in!==0||Z.lookahead!==0||me!==_&&Z.status!==666){var Ce=Z.strategy===2?(function(pe,Ie){for(var He;;){if(pe.lookahead===0&&(ue(pe),pe.lookahead===0)){if(Ie===_)return N;break}if(pe.match_length=0,He=m._tr_tally(pe,0,pe.window[pe.strstart]),pe.lookahead--,pe.strstart++,He&&(I(pe,!1),pe.strm.avail_out===0))return N}return pe.insert=0,Ie===T?(I(pe,!0),pe.strm.avail_out===0?K:P):pe.last_lit&&(I(pe,!1),pe.strm.avail_out===0)?N:se})(Z,me):Z.strategy===3?(function(pe,Ie){for(var He,Oe,qe,nt,We=pe.window;;){if(pe.lookahead<=q){if(ue(pe),pe.lookahead<=q&&Ie===_)return N;if(pe.lookahead===0)break}if(pe.match_length=0,pe.lookahead>=O&&0<pe.strstart&&(Oe=We[qe=pe.strstart-1])===We[++qe]&&Oe===We[++qe]&&Oe===We[++qe]){nt=pe.strstart+q;do;while(Oe===We[++qe]&&Oe===We[++qe]&&Oe===We[++qe]&&Oe===We[++qe]&&Oe===We[++qe]&&Oe===We[++qe]&&Oe===We[++qe]&&Oe===We[++qe]&&qe<nt);pe.match_length=q-(nt-qe),pe.match_length>pe.lookahead&&(pe.match_length=pe.lookahead)}if(pe.match_length>=O?(He=m._tr_tally(pe,1,pe.match_length-O),pe.lookahead-=pe.match_length,pe.strstart+=pe.match_length,pe.match_length=0):(He=m._tr_tally(pe,0,pe.window[pe.strstart]),pe.lookahead--,pe.strstart++),He&&(I(pe,!1),pe.strm.avail_out===0))return N}return pe.insert=0,Ie===T?(I(pe,!0),pe.strm.avail_out===0?K:P):pe.last_lit&&(I(pe,!1),pe.strm.avail_out===0)?N:se})(Z,me):c[Z.level].func(Z,me);if(Ce!==K&&Ce!==P||(Z.status=666),Ce===N||Ce===K)return E.avail_out===0&&(Z.last_flush=-1),x;if(Ce===se&&(me===1?m._tr_align(Z):me!==5&&(m._tr_stored_block(Z,0,0,!1),me===3&&(Ee(Z.head),Z.lookahead===0&&(Z.strstart=0,Z.block_start=0,Z.insert=0))),z(E),E.avail_out===0))return Z.last_flush=-1,x}return me!==T?x:Z.wrap<=0?1:(Z.wrap===2?(te(Z,255&E.adler),te(Z,E.adler>>8&255),te(Z,E.adler>>16&255),te(Z,E.adler>>24&255),te(Z,255&E.total_in),te(Z,E.total_in>>8&255),te(Z,E.total_in>>16&255),te(Z,E.total_in>>24&255)):(ae(Z,E.adler>>>16),ae(Z,65535&E.adler)),z(E),0<Z.wrap&&(Z.wrap=-Z.wrap),Z.pending!==0?x:1)},l.deflateEnd=function(E){var me;return E&&E.state?(me=E.state.status)!==M&&me!==69&&me!==73&&me!==91&&me!==103&&me!==J&&me!==666?ve(E,k):(E.state=null,me===J?ve(E,-3):x):k},l.deflateSetDictionary=function(E,me){var X,Z,Y,ie,ke,Ce,pe,Ie,He=me.length;if(!E||!E.state||(ie=(X=E.state).wrap)===2||ie===1&&X.status!==M||X.lookahead)return k;for(ie===1&&(E.adler=p(E.adler,me,He,0)),X.wrap=0,He>=X.w_size&&(ie===0&&(Ee(X.head),X.strstart=0,X.block_start=0,X.insert=0),Ie=new d.Buf8(X.w_size),d.arraySet(Ie,me,He-X.w_size,X.w_size,0),me=Ie,He=X.w_size),ke=E.avail_in,Ce=E.next_in,pe=E.input,E.avail_in=He,E.next_in=0,E.input=me,ue(X);X.lookahead>=O;){for(Z=X.strstart,Y=X.lookahead-(O-1);X.ins_h=(X.ins_h<<X.hash_shift^X.window[Z+O-1])&X.hash_mask,X.prev[Z&X.w_mask]=X.head[X.ins_h],X.head[X.ins_h]=Z,Z++,--Y;);X.strstart=Z,X.lookahead=O-1,ue(X)}return X.strstart+=X.lookahead,X.block_start=X.strstart,X.insert=X.lookahead,X.lookahead=0,X.match_length=X.prev_length=O-1,X.match_available=0,E.next_in=Ce,E.input=pe,E.avail_in=ke,X.wrap=ie,x},l.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(s,i,l){i.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(s,i,l){i.exports=function(c,d){var m,p,f,v,_,T,x,k,w,S,C,R,L,F,G,Q,U,j,O,q,ee,M,J,N,se;m=c.state,p=c.next_in,N=c.input,f=p+(c.avail_in-5),v=c.next_out,se=c.output,_=v-(d-c.avail_out),T=v+(c.avail_out-257),x=m.dmax,k=m.wsize,w=m.whave,S=m.wnext,C=m.window,R=m.hold,L=m.bits,F=m.lencode,G=m.distcode,Q=(1<<m.lenbits)-1,U=(1<<m.distbits)-1;e:do{L<15&&(R+=N[p++]<<L,L+=8,R+=N[p++]<<L,L+=8),j=F[R&Q];t:for(;;){if(R>>>=O=j>>>24,L-=O,(O=j>>>16&255)===0)se[v++]=65535&j;else{if(!(16&O)){if((64&O)==0){j=F[(65535&j)+(R&(1<<O)-1)];continue t}if(32&O){m.mode=12;break e}c.msg="invalid literal/length code",m.mode=30;break e}q=65535&j,(O&=15)&&(L<O&&(R+=N[p++]<<L,L+=8),q+=R&(1<<O)-1,R>>>=O,L-=O),L<15&&(R+=N[p++]<<L,L+=8,R+=N[p++]<<L,L+=8),j=G[R&U];n:for(;;){if(R>>>=O=j>>>24,L-=O,!(16&(O=j>>>16&255))){if((64&O)==0){j=G[(65535&j)+(R&(1<<O)-1)];continue n}c.msg="invalid distance code",m.mode=30;break e}if(ee=65535&j,L<(O&=15)&&(R+=N[p++]<<L,(L+=8)<O&&(R+=N[p++]<<L,L+=8)),x<(ee+=R&(1<<O)-1)){c.msg="invalid distance too far back",m.mode=30;break e}if(R>>>=O,L-=O,(O=v-_)<ee){if(w<(O=ee-O)&&m.sane){c.msg="invalid distance too far back",m.mode=30;break e}if(J=C,(M=0)===S){if(M+=k-O,O<q){for(q-=O;se[v++]=C[M++],--O;);M=v-ee,J=se}}else if(S<O){if(M+=k+S-O,(O-=S)<q){for(q-=O;se[v++]=C[M++],--O;);if(M=0,S<q){for(q-=O=S;se[v++]=C[M++],--O;);M=v-ee,J=se}}}else if(M+=S-O,O<q){for(q-=O;se[v++]=C[M++],--O;);M=v-ee,J=se}for(;2<q;)se[v++]=J[M++],se[v++]=J[M++],se[v++]=J[M++],q-=3;q&&(se[v++]=J[M++],1<q&&(se[v++]=J[M++]))}else{for(M=v-ee;se[v++]=se[M++],se[v++]=se[M++],se[v++]=se[M++],2<(q-=3););q&&(se[v++]=se[M++],1<q&&(se[v++]=se[M++]))}break}}break}}while(p<f&&v<T);p-=q=L>>3,R&=(1<<(L-=q<<3))-1,c.next_in=p,c.next_out=v,c.avail_in=p<f?f-p+5:5-(p-f),c.avail_out=v<T?T-v+257:257-(v-T),m.hold=R,m.bits=L}},{}],49:[function(s,i,l){var c=s("../utils/common"),d=s("./adler32"),m=s("./crc32"),p=s("./inffast"),f=s("./inftrees"),v=1,_=2,T=0,x=-2,k=1,w=852,S=592;function C(M){return(M>>>24&255)+(M>>>8&65280)+((65280&M)<<8)+((255&M)<<24)}function R(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new c.Buf16(320),this.work=new c.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function L(M){var J;return M&&M.state?(J=M.state,M.total_in=M.total_out=J.total=0,M.msg="",J.wrap&&(M.adler=1&J.wrap),J.mode=k,J.last=0,J.havedict=0,J.dmax=32768,J.head=null,J.hold=0,J.bits=0,J.lencode=J.lendyn=new c.Buf32(w),J.distcode=J.distdyn=new c.Buf32(S),J.sane=1,J.back=-1,T):x}function F(M){var J;return M&&M.state?((J=M.state).wsize=0,J.whave=0,J.wnext=0,L(M)):x}function G(M,J){var N,se;return M&&M.state?(se=M.state,J<0?(N=0,J=-J):(N=1+(J>>4),J<48&&(J&=15)),J&&(J<8||15<J)?x:(se.window!==null&&se.wbits!==J&&(se.window=null),se.wrap=N,se.wbits=J,F(M))):x}function Q(M,J){var N,se;return M?(se=new R,(M.state=se).window=null,(N=G(M,J))!==T&&(M.state=null),N):x}var U,j,O=!0;function q(M){if(O){var J;for(U=new c.Buf32(512),j=new c.Buf32(32),J=0;J<144;)M.lens[J++]=8;for(;J<256;)M.lens[J++]=9;for(;J<280;)M.lens[J++]=7;for(;J<288;)M.lens[J++]=8;for(f(v,M.lens,0,288,U,0,M.work,{bits:9}),J=0;J<32;)M.lens[J++]=5;f(_,M.lens,0,32,j,0,M.work,{bits:5}),O=!1}M.lencode=U,M.lenbits=9,M.distcode=j,M.distbits=5}function ee(M,J,N,se){var K,P=M.state;return P.window===null&&(P.wsize=1<<P.wbits,P.wnext=0,P.whave=0,P.window=new c.Buf8(P.wsize)),se>=P.wsize?(c.arraySet(P.window,J,N-P.wsize,P.wsize,0),P.wnext=0,P.whave=P.wsize):(se<(K=P.wsize-P.wnext)&&(K=se),c.arraySet(P.window,J,N-se,K,P.wnext),(se-=K)?(c.arraySet(P.window,J,N-se,se,0),P.wnext=se,P.whave=P.wsize):(P.wnext+=K,P.wnext===P.wsize&&(P.wnext=0),P.whave<P.wsize&&(P.whave+=K))),0}l.inflateReset=F,l.inflateReset2=G,l.inflateResetKeep=L,l.inflateInit=function(M){return Q(M,15)},l.inflateInit2=Q,l.inflate=function(M,J){var N,se,K,P,ve,ce,Ee,z,I,te,ae,$,ue,de,oe,le,Le,De,Se,ne,E,me,X,Z,Y=0,ie=new c.Buf8(4),ke=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!M||!M.state||!M.output||!M.input&&M.avail_in!==0)return x;(N=M.state).mode===12&&(N.mode=13),ve=M.next_out,K=M.output,Ee=M.avail_out,P=M.next_in,se=M.input,ce=M.avail_in,z=N.hold,I=N.bits,te=ce,ae=Ee,me=T;e:for(;;)switch(N.mode){case k:if(N.wrap===0){N.mode=13;break}for(;I<16;){if(ce===0)break e;ce--,z+=se[P++]<<I,I+=8}if(2&N.wrap&&z===35615){ie[N.check=0]=255&z,ie[1]=z>>>8&255,N.check=m(N.check,ie,2,0),I=z=0,N.mode=2;break}if(N.flags=0,N.head&&(N.head.done=!1),!(1&N.wrap)||(((255&z)<<8)+(z>>8))%31){M.msg="incorrect header check",N.mode=30;break}if((15&z)!=8){M.msg="unknown compression method",N.mode=30;break}if(I-=4,E=8+(15&(z>>>=4)),N.wbits===0)N.wbits=E;else if(E>N.wbits){M.msg="invalid window size",N.mode=30;break}N.dmax=1<<E,M.adler=N.check=1,N.mode=512&z?10:12,I=z=0;break;case 2:for(;I<16;){if(ce===0)break e;ce--,z+=se[P++]<<I,I+=8}if(N.flags=z,(255&N.flags)!=8){M.msg="unknown compression method",N.mode=30;break}if(57344&N.flags){M.msg="unknown header flags set",N.mode=30;break}N.head&&(N.head.text=z>>8&1),512&N.flags&&(ie[0]=255&z,ie[1]=z>>>8&255,N.check=m(N.check,ie,2,0)),I=z=0,N.mode=3;case 3:for(;I<32;){if(ce===0)break e;ce--,z+=se[P++]<<I,I+=8}N.head&&(N.head.time=z),512&N.flags&&(ie[0]=255&z,ie[1]=z>>>8&255,ie[2]=z>>>16&255,ie[3]=z>>>24&255,N.check=m(N.check,ie,4,0)),I=z=0,N.mode=4;case 4:for(;I<16;){if(ce===0)break e;ce--,z+=se[P++]<<I,I+=8}N.head&&(N.head.xflags=255&z,N.head.os=z>>8),512&N.flags&&(ie[0]=255&z,ie[1]=z>>>8&255,N.check=m(N.check,ie,2,0)),I=z=0,N.mode=5;case 5:if(1024&N.flags){for(;I<16;){if(ce===0)break e;ce--,z+=se[P++]<<I,I+=8}N.length=z,N.head&&(N.head.extra_len=z),512&N.flags&&(ie[0]=255&z,ie[1]=z>>>8&255,N.check=m(N.check,ie,2,0)),I=z=0}else N.head&&(N.head.extra=null);N.mode=6;case 6:if(1024&N.flags&&(ce<($=N.length)&&($=ce),$&&(N.head&&(E=N.head.extra_len-N.length,N.head.extra||(N.head.extra=new Array(N.head.extra_len)),c.arraySet(N.head.extra,se,P,$,E)),512&N.flags&&(N.check=m(N.check,se,$,P)),ce-=$,P+=$,N.length-=$),N.length))break e;N.length=0,N.mode=7;case 7:if(2048&N.flags){if(ce===0)break e;for($=0;E=se[P+$++],N.head&&E&&N.length<65536&&(N.head.name+=String.fromCharCode(E)),E&&$<ce;);if(512&N.flags&&(N.check=m(N.check,se,$,P)),ce-=$,P+=$,E)break e}else N.head&&(N.head.name=null);N.length=0,N.mode=8;case 8:if(4096&N.flags){if(ce===0)break e;for($=0;E=se[P+$++],N.head&&E&&N.length<65536&&(N.head.comment+=String.fromCharCode(E)),E&&$<ce;);if(512&N.flags&&(N.check=m(N.check,se,$,P)),ce-=$,P+=$,E)break e}else N.head&&(N.head.comment=null);N.mode=9;case 9:if(512&N.flags){for(;I<16;){if(ce===0)break e;ce--,z+=se[P++]<<I,I+=8}if(z!==(65535&N.check)){M.msg="header crc mismatch",N.mode=30;break}I=z=0}N.head&&(N.head.hcrc=N.flags>>9&1,N.head.done=!0),M.adler=N.check=0,N.mode=12;break;case 10:for(;I<32;){if(ce===0)break e;ce--,z+=se[P++]<<I,I+=8}M.adler=N.check=C(z),I=z=0,N.mode=11;case 11:if(N.havedict===0)return M.next_out=ve,M.avail_out=Ee,M.next_in=P,M.avail_in=ce,N.hold=z,N.bits=I,2;M.adler=N.check=1,N.mode=12;case 12:if(J===5||J===6)break e;case 13:if(N.last){z>>>=7&I,I-=7&I,N.mode=27;break}for(;I<3;){if(ce===0)break e;ce--,z+=se[P++]<<I,I+=8}switch(N.last=1&z,I-=1,3&(z>>>=1)){case 0:N.mode=14;break;case 1:if(q(N),N.mode=20,J!==6)break;z>>>=2,I-=2;break e;case 2:N.mode=17;break;case 3:M.msg="invalid block type",N.mode=30}z>>>=2,I-=2;break;case 14:for(z>>>=7&I,I-=7&I;I<32;){if(ce===0)break e;ce--,z+=se[P++]<<I,I+=8}if((65535&z)!=(z>>>16^65535)){M.msg="invalid stored block lengths",N.mode=30;break}if(N.length=65535&z,I=z=0,N.mode=15,J===6)break e;case 15:N.mode=16;case 16:if($=N.length){if(ce<$&&($=ce),Ee<$&&($=Ee),$===0)break e;c.arraySet(K,se,P,$,ve),ce-=$,P+=$,Ee-=$,ve+=$,N.length-=$;break}N.mode=12;break;case 17:for(;I<14;){if(ce===0)break e;ce--,z+=se[P++]<<I,I+=8}if(N.nlen=257+(31&z),z>>>=5,I-=5,N.ndist=1+(31&z),z>>>=5,I-=5,N.ncode=4+(15&z),z>>>=4,I-=4,286<N.nlen||30<N.ndist){M.msg="too many length or distance symbols",N.mode=30;break}N.have=0,N.mode=18;case 18:for(;N.have<N.ncode;){for(;I<3;){if(ce===0)break e;ce--,z+=se[P++]<<I,I+=8}N.lens[ke[N.have++]]=7&z,z>>>=3,I-=3}for(;N.have<19;)N.lens[ke[N.have++]]=0;if(N.lencode=N.lendyn,N.lenbits=7,X={bits:N.lenbits},me=f(0,N.lens,0,19,N.lencode,0,N.work,X),N.lenbits=X.bits,me){M.msg="invalid code lengths set",N.mode=30;break}N.have=0,N.mode=19;case 19:for(;N.have<N.nlen+N.ndist;){for(;le=(Y=N.lencode[z&(1<<N.lenbits)-1])>>>16&255,Le=65535&Y,!((oe=Y>>>24)<=I);){if(ce===0)break e;ce--,z+=se[P++]<<I,I+=8}if(Le<16)z>>>=oe,I-=oe,N.lens[N.have++]=Le;else{if(Le===16){for(Z=oe+2;I<Z;){if(ce===0)break e;ce--,z+=se[P++]<<I,I+=8}if(z>>>=oe,I-=oe,N.have===0){M.msg="invalid bit length repeat",N.mode=30;break}E=N.lens[N.have-1],$=3+(3&z),z>>>=2,I-=2}else if(Le===17){for(Z=oe+3;I<Z;){if(ce===0)break e;ce--,z+=se[P++]<<I,I+=8}I-=oe,E=0,$=3+(7&(z>>>=oe)),z>>>=3,I-=3}else{for(Z=oe+7;I<Z;){if(ce===0)break e;ce--,z+=se[P++]<<I,I+=8}I-=oe,E=0,$=11+(127&(z>>>=oe)),z>>>=7,I-=7}if(N.have+$>N.nlen+N.ndist){M.msg="invalid bit length repeat",N.mode=30;break}for(;$--;)N.lens[N.have++]=E}}if(N.mode===30)break;if(N.lens[256]===0){M.msg="invalid code -- missing end-of-block",N.mode=30;break}if(N.lenbits=9,X={bits:N.lenbits},me=f(v,N.lens,0,N.nlen,N.lencode,0,N.work,X),N.lenbits=X.bits,me){M.msg="invalid literal/lengths set",N.mode=30;break}if(N.distbits=6,N.distcode=N.distdyn,X={bits:N.distbits},me=f(_,N.lens,N.nlen,N.ndist,N.distcode,0,N.work,X),N.distbits=X.bits,me){M.msg="invalid distances set",N.mode=30;break}if(N.mode=20,J===6)break e;case 20:N.mode=21;case 21:if(6<=ce&&258<=Ee){M.next_out=ve,M.avail_out=Ee,M.next_in=P,M.avail_in=ce,N.hold=z,N.bits=I,p(M,ae),ve=M.next_out,K=M.output,Ee=M.avail_out,P=M.next_in,se=M.input,ce=M.avail_in,z=N.hold,I=N.bits,N.mode===12&&(N.back=-1);break}for(N.back=0;le=(Y=N.lencode[z&(1<<N.lenbits)-1])>>>16&255,Le=65535&Y,!((oe=Y>>>24)<=I);){if(ce===0)break e;ce--,z+=se[P++]<<I,I+=8}if(le&&(240&le)==0){for(De=oe,Se=le,ne=Le;le=(Y=N.lencode[ne+((z&(1<<De+Se)-1)>>De)])>>>16&255,Le=65535&Y,!(De+(oe=Y>>>24)<=I);){if(ce===0)break e;ce--,z+=se[P++]<<I,I+=8}z>>>=De,I-=De,N.back+=De}if(z>>>=oe,I-=oe,N.back+=oe,N.length=Le,le===0){N.mode=26;break}if(32&le){N.back=-1,N.mode=12;break}if(64&le){M.msg="invalid literal/length code",N.mode=30;break}N.extra=15&le,N.mode=22;case 22:if(N.extra){for(Z=N.extra;I<Z;){if(ce===0)break e;ce--,z+=se[P++]<<I,I+=8}N.length+=z&(1<<N.extra)-1,z>>>=N.extra,I-=N.extra,N.back+=N.extra}N.was=N.length,N.mode=23;case 23:for(;le=(Y=N.distcode[z&(1<<N.distbits)-1])>>>16&255,Le=65535&Y,!((oe=Y>>>24)<=I);){if(ce===0)break e;ce--,z+=se[P++]<<I,I+=8}if((240&le)==0){for(De=oe,Se=le,ne=Le;le=(Y=N.distcode[ne+((z&(1<<De+Se)-1)>>De)])>>>16&255,Le=65535&Y,!(De+(oe=Y>>>24)<=I);){if(ce===0)break e;ce--,z+=se[P++]<<I,I+=8}z>>>=De,I-=De,N.back+=De}if(z>>>=oe,I-=oe,N.back+=oe,64&le){M.msg="invalid distance code",N.mode=30;break}N.offset=Le,N.extra=15&le,N.mode=24;case 24:if(N.extra){for(Z=N.extra;I<Z;){if(ce===0)break e;ce--,z+=se[P++]<<I,I+=8}N.offset+=z&(1<<N.extra)-1,z>>>=N.extra,I-=N.extra,N.back+=N.extra}if(N.offset>N.dmax){M.msg="invalid distance too far back",N.mode=30;break}N.mode=25;case 25:if(Ee===0)break e;if($=ae-Ee,N.offset>$){if(($=N.offset-$)>N.whave&&N.sane){M.msg="invalid distance too far back",N.mode=30;break}ue=$>N.wnext?($-=N.wnext,N.wsize-$):N.wnext-$,$>N.length&&($=N.length),de=N.window}else de=K,ue=ve-N.offset,$=N.length;for(Ee<$&&($=Ee),Ee-=$,N.length-=$;K[ve++]=de[ue++],--$;);N.length===0&&(N.mode=21);break;case 26:if(Ee===0)break e;K[ve++]=N.length,Ee--,N.mode=21;break;case 27:if(N.wrap){for(;I<32;){if(ce===0)break e;ce--,z|=se[P++]<<I,I+=8}if(ae-=Ee,M.total_out+=ae,N.total+=ae,ae&&(M.adler=N.check=N.flags?m(N.check,K,ae,ve-ae):d(N.check,K,ae,ve-ae)),ae=Ee,(N.flags?z:C(z))!==N.check){M.msg="incorrect data check",N.mode=30;break}I=z=0}N.mode=28;case 28:if(N.wrap&&N.flags){for(;I<32;){if(ce===0)break e;ce--,z+=se[P++]<<I,I+=8}if(z!==(4294967295&N.total)){M.msg="incorrect length check",N.mode=30;break}I=z=0}N.mode=29;case 29:me=1;break e;case 30:me=-3;break e;case 31:return-4;case 32:default:return x}return M.next_out=ve,M.avail_out=Ee,M.next_in=P,M.avail_in=ce,N.hold=z,N.bits=I,(N.wsize||ae!==M.avail_out&&N.mode<30&&(N.mode<27||J!==4))&&ee(M,M.output,M.next_out,ae-M.avail_out)?(N.mode=31,-4):(te-=M.avail_in,ae-=M.avail_out,M.total_in+=te,M.total_out+=ae,N.total+=ae,N.wrap&&ae&&(M.adler=N.check=N.flags?m(N.check,K,ae,M.next_out-ae):d(N.check,K,ae,M.next_out-ae)),M.data_type=N.bits+(N.last?64:0)+(N.mode===12?128:0)+(N.mode===20||N.mode===15?256:0),(te==0&&ae===0||J===4)&&me===T&&(me=-5),me)},l.inflateEnd=function(M){if(!M||!M.state)return x;var J=M.state;return J.window&&(J.window=null),M.state=null,T},l.inflateGetHeader=function(M,J){var N;return M&&M.state?(2&(N=M.state).wrap)==0?x:((N.head=J).done=!1,T):x},l.inflateSetDictionary=function(M,J){var N,se=J.length;return M&&M.state?(N=M.state).wrap!==0&&N.mode!==11?x:N.mode===11&&d(1,J,se,0)!==N.check?-3:ee(M,J,se,se)?(N.mode=31,-4):(N.havedict=1,T):x},l.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(s,i,l){var c=s("../utils/common"),d=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],m=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],p=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],f=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];i.exports=function(v,_,T,x,k,w,S,C){var R,L,F,G,Q,U,j,O,q,ee=C.bits,M=0,J=0,N=0,se=0,K=0,P=0,ve=0,ce=0,Ee=0,z=0,I=null,te=0,ae=new c.Buf16(16),$=new c.Buf16(16),ue=null,de=0;for(M=0;M<=15;M++)ae[M]=0;for(J=0;J<x;J++)ae[_[T+J]]++;for(K=ee,se=15;1<=se&&ae[se]===0;se--);if(se<K&&(K=se),se===0)return k[w++]=20971520,k[w++]=20971520,C.bits=1,0;for(N=1;N<se&&ae[N]===0;N++);for(K<N&&(K=N),M=ce=1;M<=15;M++)if(ce<<=1,(ce-=ae[M])<0)return-1;if(0<ce&&(v===0||se!==1))return-1;for($[1]=0,M=1;M<15;M++)$[M+1]=$[M]+ae[M];for(J=0;J<x;J++)_[T+J]!==0&&(S[$[_[T+J]]++]=J);if(U=v===0?(I=ue=S,19):v===1?(I=d,te-=257,ue=m,de-=257,256):(I=p,ue=f,-1),M=N,Q=w,ve=J=z=0,F=-1,G=(Ee=1<<(P=K))-1,v===1&&852<Ee||v===2&&592<Ee)return 1;for(;;){for(j=M-ve,q=S[J]<U?(O=0,S[J]):S[J]>U?(O=ue[de+S[J]],I[te+S[J]]):(O=96,0),R=1<<M-ve,N=L=1<<P;k[Q+(z>>ve)+(L-=R)]=j<<24|O<<16|q|0,L!==0;);for(R=1<<M-1;z&R;)R>>=1;if(R!==0?(z&=R-1,z+=R):z=0,J++,--ae[M]==0){if(M===se)break;M=_[T+S[J]]}if(K<M&&(z&G)!==F){for(ve===0&&(ve=K),Q+=N,ce=1<<(P=M-ve);P+ve<se&&!((ce-=ae[P+ve])<=0);)P++,ce<<=1;if(Ee+=1<<P,v===1&&852<Ee||v===2&&592<Ee)return 1;k[F=z&G]=K<<24|P<<16|Q-w|0}}return z!==0&&(k[Q+z]=M-ve<<24|64<<16|0),C.bits=K,0}},{"../utils/common":41}],51:[function(s,i,l){i.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(s,i,l){var c=s("../utils/common"),d=0,m=1;function p(Y){for(var ie=Y.length;0<=--ie;)Y[ie]=0}var f=0,v=29,_=256,T=_+1+v,x=30,k=19,w=2*T+1,S=15,C=16,R=7,L=256,F=16,G=17,Q=18,U=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],j=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],O=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],q=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],ee=new Array(2*(T+2));p(ee);var M=new Array(2*x);p(M);var J=new Array(512);p(J);var N=new Array(256);p(N);var se=new Array(v);p(se);var K,P,ve,ce=new Array(x);function Ee(Y,ie,ke,Ce,pe){this.static_tree=Y,this.extra_bits=ie,this.extra_base=ke,this.elems=Ce,this.max_length=pe,this.has_stree=Y&&Y.length}function z(Y,ie){this.dyn_tree=Y,this.max_code=0,this.stat_desc=ie}function I(Y){return Y<256?J[Y]:J[256+(Y>>>7)]}function te(Y,ie){Y.pending_buf[Y.pending++]=255&ie,Y.pending_buf[Y.pending++]=ie>>>8&255}function ae(Y,ie,ke){Y.bi_valid>C-ke?(Y.bi_buf|=ie<<Y.bi_valid&65535,te(Y,Y.bi_buf),Y.bi_buf=ie>>C-Y.bi_valid,Y.bi_valid+=ke-C):(Y.bi_buf|=ie<<Y.bi_valid&65535,Y.bi_valid+=ke)}function $(Y,ie,ke){ae(Y,ke[2*ie],ke[2*ie+1])}function ue(Y,ie){for(var ke=0;ke|=1&Y,Y>>>=1,ke<<=1,0<--ie;);return ke>>>1}function de(Y,ie,ke){var Ce,pe,Ie=new Array(S+1),He=0;for(Ce=1;Ce<=S;Ce++)Ie[Ce]=He=He+ke[Ce-1]<<1;for(pe=0;pe<=ie;pe++){var Oe=Y[2*pe+1];Oe!==0&&(Y[2*pe]=ue(Ie[Oe]++,Oe))}}function oe(Y){var ie;for(ie=0;ie<T;ie++)Y.dyn_ltree[2*ie]=0;for(ie=0;ie<x;ie++)Y.dyn_dtree[2*ie]=0;for(ie=0;ie<k;ie++)Y.bl_tree[2*ie]=0;Y.dyn_ltree[2*L]=1,Y.opt_len=Y.static_len=0,Y.last_lit=Y.matches=0}function le(Y){8<Y.bi_valid?te(Y,Y.bi_buf):0<Y.bi_valid&&(Y.pending_buf[Y.pending++]=Y.bi_buf),Y.bi_buf=0,Y.bi_valid=0}function Le(Y,ie,ke,Ce){var pe=2*ie,Ie=2*ke;return Y[pe]<Y[Ie]||Y[pe]===Y[Ie]&&Ce[ie]<=Ce[ke]}function De(Y,ie,ke){for(var Ce=Y.heap[ke],pe=ke<<1;pe<=Y.heap_len&&(pe<Y.heap_len&&Le(ie,Y.heap[pe+1],Y.heap[pe],Y.depth)&&pe++,!Le(ie,Ce,Y.heap[pe],Y.depth));)Y.heap[ke]=Y.heap[pe],ke=pe,pe<<=1;Y.heap[ke]=Ce}function Se(Y,ie,ke){var Ce,pe,Ie,He,Oe=0;if(Y.last_lit!==0)for(;Ce=Y.pending_buf[Y.d_buf+2*Oe]<<8|Y.pending_buf[Y.d_buf+2*Oe+1],pe=Y.pending_buf[Y.l_buf+Oe],Oe++,Ce===0?$(Y,pe,ie):($(Y,(Ie=N[pe])+_+1,ie),(He=U[Ie])!==0&&ae(Y,pe-=se[Ie],He),$(Y,Ie=I(--Ce),ke),(He=j[Ie])!==0&&ae(Y,Ce-=ce[Ie],He)),Oe<Y.last_lit;);$(Y,L,ie)}function ne(Y,ie){var ke,Ce,pe,Ie=ie.dyn_tree,He=ie.stat_desc.static_tree,Oe=ie.stat_desc.has_stree,qe=ie.stat_desc.elems,nt=-1;for(Y.heap_len=0,Y.heap_max=w,ke=0;ke<qe;ke++)Ie[2*ke]!==0?(Y.heap[++Y.heap_len]=nt=ke,Y.depth[ke]=0):Ie[2*ke+1]=0;for(;Y.heap_len<2;)Ie[2*(pe=Y.heap[++Y.heap_len]=nt<2?++nt:0)]=1,Y.depth[pe]=0,Y.opt_len--,Oe&&(Y.static_len-=He[2*pe+1]);for(ie.max_code=nt,ke=Y.heap_len>>1;1<=ke;ke--)De(Y,Ie,ke);for(pe=qe;ke=Y.heap[1],Y.heap[1]=Y.heap[Y.heap_len--],De(Y,Ie,1),Ce=Y.heap[1],Y.heap[--Y.heap_max]=ke,Y.heap[--Y.heap_max]=Ce,Ie[2*pe]=Ie[2*ke]+Ie[2*Ce],Y.depth[pe]=(Y.depth[ke]>=Y.depth[Ce]?Y.depth[ke]:Y.depth[Ce])+1,Ie[2*ke+1]=Ie[2*Ce+1]=pe,Y.heap[1]=pe++,De(Y,Ie,1),2<=Y.heap_len;);Y.heap[--Y.heap_max]=Y.heap[1],(function(We,Ye){var St,wt,jt,mt,rt,un,Mt=Ye.dyn_tree,cr=Ye.max_code,ut=Ye.stat_desc.static_tree,Jr=Ye.stat_desc.has_stree,Kn=Ye.stat_desc.extra_bits,qt=Ye.stat_desc.extra_base,tn=Ye.stat_desc.max_length,vn=0;for(mt=0;mt<=S;mt++)We.bl_count[mt]=0;for(Mt[2*We.heap[We.heap_max]+1]=0,St=We.heap_max+1;St<w;St++)tn<(mt=Mt[2*Mt[2*(wt=We.heap[St])+1]+1]+1)&&(mt=tn,vn++),Mt[2*wt+1]=mt,cr<wt||(We.bl_count[mt]++,rt=0,qt<=wt&&(rt=Kn[wt-qt]),un=Mt[2*wt],We.opt_len+=un*(mt+rt),Jr&&(We.static_len+=un*(ut[2*wt+1]+rt)));if(vn!==0){do{for(mt=tn-1;We.bl_count[mt]===0;)mt--;We.bl_count[mt]--,We.bl_count[mt+1]+=2,We.bl_count[tn]--,vn-=2}while(0<vn);for(mt=tn;mt!==0;mt--)for(wt=We.bl_count[mt];wt!==0;)cr<(jt=We.heap[--St])||(Mt[2*jt+1]!==mt&&(We.opt_len+=(mt-Mt[2*jt+1])*Mt[2*jt],Mt[2*jt+1]=mt),wt--)}})(Y,ie),de(Ie,nt,Y.bl_count)}function E(Y,ie,ke){var Ce,pe,Ie=-1,He=ie[1],Oe=0,qe=7,nt=4;for(He===0&&(qe=138,nt=3),ie[2*(ke+1)+1]=65535,Ce=0;Ce<=ke;Ce++)pe=He,He=ie[2*(Ce+1)+1],++Oe<qe&&pe===He||(Oe<nt?Y.bl_tree[2*pe]+=Oe:pe!==0?(pe!==Ie&&Y.bl_tree[2*pe]++,Y.bl_tree[2*F]++):Oe<=10?Y.bl_tree[2*G]++:Y.bl_tree[2*Q]++,Ie=pe,nt=(Oe=0)===He?(qe=138,3):pe===He?(qe=6,3):(qe=7,4))}function me(Y,ie,ke){var Ce,pe,Ie=-1,He=ie[1],Oe=0,qe=7,nt=4;for(He===0&&(qe=138,nt=3),Ce=0;Ce<=ke;Ce++)if(pe=He,He=ie[2*(Ce+1)+1],!(++Oe<qe&&pe===He)){if(Oe<nt)for(;$(Y,pe,Y.bl_tree),--Oe!=0;);else pe!==0?(pe!==Ie&&($(Y,pe,Y.bl_tree),Oe--),$(Y,F,Y.bl_tree),ae(Y,Oe-3,2)):Oe<=10?($(Y,G,Y.bl_tree),ae(Y,Oe-3,3)):($(Y,Q,Y.bl_tree),ae(Y,Oe-11,7));Ie=pe,nt=(Oe=0)===He?(qe=138,3):pe===He?(qe=6,3):(qe=7,4)}}p(ce);var X=!1;function Z(Y,ie,ke,Ce){ae(Y,(f<<1)+(Ce?1:0),3),(function(pe,Ie,He,Oe){le(pe),te(pe,He),te(pe,~He),c.arraySet(pe.pending_buf,pe.window,Ie,He,pe.pending),pe.pending+=He})(Y,ie,ke)}l._tr_init=function(Y){X||((function(){var ie,ke,Ce,pe,Ie,He=new Array(S+1);for(pe=Ce=0;pe<v-1;pe++)for(se[pe]=Ce,ie=0;ie<1<<U[pe];ie++)N[Ce++]=pe;for(N[Ce-1]=pe,pe=Ie=0;pe<16;pe++)for(ce[pe]=Ie,ie=0;ie<1<<j[pe];ie++)J[Ie++]=pe;for(Ie>>=7;pe<x;pe++)for(ce[pe]=Ie<<7,ie=0;ie<1<<j[pe]-7;ie++)J[256+Ie++]=pe;for(ke=0;ke<=S;ke++)He[ke]=0;for(ie=0;ie<=143;)ee[2*ie+1]=8,ie++,He[8]++;for(;ie<=255;)ee[2*ie+1]=9,ie++,He[9]++;for(;ie<=279;)ee[2*ie+1]=7,ie++,He[7]++;for(;ie<=287;)ee[2*ie+1]=8,ie++,He[8]++;for(de(ee,T+1,He),ie=0;ie<x;ie++)M[2*ie+1]=5,M[2*ie]=ue(ie,5);K=new Ee(ee,U,_+1,T,S),P=new Ee(M,j,0,x,S),ve=new Ee(new Array(0),O,0,k,R)})(),X=!0),Y.l_desc=new z(Y.dyn_ltree,K),Y.d_desc=new z(Y.dyn_dtree,P),Y.bl_desc=new z(Y.bl_tree,ve),Y.bi_buf=0,Y.bi_valid=0,oe(Y)},l._tr_stored_block=Z,l._tr_flush_block=function(Y,ie,ke,Ce){var pe,Ie,He=0;0<Y.level?(Y.strm.data_type===2&&(Y.strm.data_type=(function(Oe){var qe,nt=4093624447;for(qe=0;qe<=31;qe++,nt>>>=1)if(1&nt&&Oe.dyn_ltree[2*qe]!==0)return d;if(Oe.dyn_ltree[18]!==0||Oe.dyn_ltree[20]!==0||Oe.dyn_ltree[26]!==0)return m;for(qe=32;qe<_;qe++)if(Oe.dyn_ltree[2*qe]!==0)return m;return d})(Y)),ne(Y,Y.l_desc),ne(Y,Y.d_desc),He=(function(Oe){var qe;for(E(Oe,Oe.dyn_ltree,Oe.l_desc.max_code),E(Oe,Oe.dyn_dtree,Oe.d_desc.max_code),ne(Oe,Oe.bl_desc),qe=k-1;3<=qe&&Oe.bl_tree[2*q[qe]+1]===0;qe--);return Oe.opt_len+=3*(qe+1)+5+5+4,qe})(Y),pe=Y.opt_len+3+7>>>3,(Ie=Y.static_len+3+7>>>3)<=pe&&(pe=Ie)):pe=Ie=ke+5,ke+4<=pe&&ie!==-1?Z(Y,ie,ke,Ce):Y.strategy===4||Ie===pe?(ae(Y,2+(Ce?1:0),3),Se(Y,ee,M)):(ae(Y,4+(Ce?1:0),3),(function(Oe,qe,nt,We){var Ye;for(ae(Oe,qe-257,5),ae(Oe,nt-1,5),ae(Oe,We-4,4),Ye=0;Ye<We;Ye++)ae(Oe,Oe.bl_tree[2*q[Ye]+1],3);me(Oe,Oe.dyn_ltree,qe-1),me(Oe,Oe.dyn_dtree,nt-1)})(Y,Y.l_desc.max_code+1,Y.d_desc.max_code+1,He+1),Se(Y,Y.dyn_ltree,Y.dyn_dtree)),oe(Y),Ce&&le(Y)},l._tr_tally=function(Y,ie,ke){return Y.pending_buf[Y.d_buf+2*Y.last_lit]=ie>>>8&255,Y.pending_buf[Y.d_buf+2*Y.last_lit+1]=255&ie,Y.pending_buf[Y.l_buf+Y.last_lit]=255&ke,Y.last_lit++,ie===0?Y.dyn_ltree[2*ke]++:(Y.matches++,ie--,Y.dyn_ltree[2*(N[ke]+_+1)]++,Y.dyn_dtree[2*I(ie)]++),Y.last_lit===Y.lit_bufsize-1},l._tr_align=function(Y){ae(Y,2,3),$(Y,L,ee),(function(ie){ie.bi_valid===16?(te(ie,ie.bi_buf),ie.bi_buf=0,ie.bi_valid=0):8<=ie.bi_valid&&(ie.pending_buf[ie.pending++]=255&ie.bi_buf,ie.bi_buf>>=8,ie.bi_valid-=8)})(Y)}},{"../utils/common":41}],53:[function(s,i,l){i.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(s,i,l){(function(c){(function(d,m){if(!d.setImmediate){var p,f,v,_,T=1,x={},k=!1,w=d.document,S=Object.getPrototypeOf&&Object.getPrototypeOf(d);S=S&&S.setTimeout?S:d,p={}.toString.call(d.process)==="[object process]"?function(F){process.nextTick(function(){R(F)})}:(function(){if(d.postMessage&&!d.importScripts){var F=!0,G=d.onmessage;return d.onmessage=function(){F=!1},d.postMessage("","*"),d.onmessage=G,F}})()?(_="setImmediate$"+Math.random()+"$",d.addEventListener?d.addEventListener("message",L,!1):d.attachEvent("onmessage",L),function(F){d.postMessage(_+F,"*")}):d.MessageChannel?((v=new MessageChannel).port1.onmessage=function(F){R(F.data)},function(F){v.port2.postMessage(F)}):w&&"onreadystatechange"in w.createElement("script")?(f=w.documentElement,function(F){var G=w.createElement("script");G.onreadystatechange=function(){R(F),G.onreadystatechange=null,f.removeChild(G),G=null},f.appendChild(G)}):function(F){setTimeout(R,0,F)},S.setImmediate=function(F){typeof F!="function"&&(F=new Function(""+F));for(var G=new Array(arguments.length-1),Q=0;Q<G.length;Q++)G[Q]=arguments[Q+1];var U={callback:F,args:G};return x[T]=U,p(T),T++},S.clearImmediate=C}function C(F){delete x[F]}function R(F){if(k)setTimeout(R,0,F);else{var G=x[F];if(G){k=!0;try{(function(Q){var U=Q.callback,j=Q.args;switch(j.length){case 0:U();break;case 1:U(j[0]);break;case 2:U(j[0],j[1]);break;case 3:U(j[0],j[1],j[2]);break;default:U.apply(m,j)}})(G)}finally{C(F),k=!1}}}}function L(F){F.source===d&&typeof F.data=="string"&&F.data.indexOf(_)===0&&R(+F.data.slice(_.length))}})(typeof self>"u"?c===void 0?this:c:self)}).call(this,typeof Kc<"u"?Kc:typeof self<"u"?self:typeof window<"u"?window:{})},{}]},{},[10])(10)})})(rh)),rh.exports}var Fw=zw();const Yh=co(Fw);var uu={exports:{}};/* @license
Papa Parse
v5.4.1
https://github.com/mholt/PapaParse
License: MIT
*/var Bw=uu.exports,Hy;function Hw(){return Hy||(Hy=1,(function(n,a){(function(s,i){n.exports=i()})(Bw,function s(){var i=typeof self<"u"?self:typeof window<"u"?window:i!==void 0?i:{},l=!i.document&&!!i.postMessage,c=i.IS_PAPA_WORKER||!1,d={},m=0,p={parse:function(j,O){var q=(O=O||{}).dynamicTyping||!1;if(U(q)&&(O.dynamicTypingFunction=q,q={}),O.dynamicTyping=q,O.transform=!!U(O.transform)&&O.transform,O.worker&&p.WORKERS_SUPPORTED){var ee=(function(){if(!p.WORKERS_SUPPORTED)return!1;var J=(se=i.URL||i.webkitURL||null,K=s.toString(),p.BLOB_URL||(p.BLOB_URL=se.createObjectURL(new Blob(["var global = (function() { if (typeof self !== 'undefined') { return self; } if (typeof window !== 'undefined') { return window; } if (typeof global !== 'undefined') { return global; } return {}; })(); global.IS_PAPA_WORKER=true; ","(",K,")();"],{type:"text/javascript"})))),N=new i.Worker(J),se,K;return N.onmessage=R,N.id=m++,d[N.id]=N})();return ee.userStep=O.step,ee.userChunk=O.chunk,ee.userComplete=O.complete,ee.userError=O.error,O.step=U(O.step),O.chunk=U(O.chunk),O.complete=U(O.complete),O.error=U(O.error),delete O.worker,void ee.postMessage({input:j,config:O,workerId:ee.id})}var M=null;return p.NODE_STREAM_INPUT,typeof j=="string"?(j=(function(J){return J.charCodeAt(0)===65279?J.slice(1):J})(j),M=O.download?new _(O):new x(O)):j.readable===!0&&U(j.read)&&U(j.on)?M=new k(O):(i.File&&j instanceof File||j instanceof Object)&&(M=new T(O)),M.stream(j)},unparse:function(j,O){var q=!1,ee=!0,M=",",J=`\r
`,N='"',se=N+N,K=!1,P=null,ve=!1;(function(){if(typeof O=="object"){if(typeof O.delimiter!="string"||p.BAD_DELIMITERS.filter(function(I){return O.delimiter.indexOf(I)!==-1}).length||(M=O.delimiter),(typeof O.quotes=="boolean"||typeof O.quotes=="function"||Array.isArray(O.quotes))&&(q=O.quotes),typeof O.skipEmptyLines!="boolean"&&typeof O.skipEmptyLines!="string"||(K=O.skipEmptyLines),typeof O.newline=="string"&&(J=O.newline),typeof O.quoteChar=="string"&&(N=O.quoteChar),typeof O.header=="boolean"&&(ee=O.header),Array.isArray(O.columns)){if(O.columns.length===0)throw new Error("Option columns is empty");P=O.columns}O.escapeChar!==void 0&&(se=O.escapeChar+N),(typeof O.escapeFormulae=="boolean"||O.escapeFormulae instanceof RegExp)&&(ve=O.escapeFormulae instanceof RegExp?O.escapeFormulae:/^[=+\-@\t\r].*$/)}})();var ce=new RegExp(S(N),"g");if(typeof j=="string"&&(j=JSON.parse(j)),Array.isArray(j)){if(!j.length||Array.isArray(j[0]))return Ee(null,j,K);if(typeof j[0]=="object")return Ee(P||Object.keys(j[0]),j,K)}else if(typeof j=="object")return typeof j.data=="string"&&(j.data=JSON.parse(j.data)),Array.isArray(j.data)&&(j.fields||(j.fields=j.meta&&j.meta.fields||P),j.fields||(j.fields=Array.isArray(j.data[0])?j.fields:typeof j.data[0]=="object"?Object.keys(j.data[0]):[]),Array.isArray(j.data[0])||typeof j.data[0]=="object"||(j.data=[j.data])),Ee(j.fields||[],j.data||[],K);throw new Error("Unable to serialize unrecognized input");function Ee(I,te,ae){var $="";typeof I=="string"&&(I=JSON.parse(I)),typeof te=="string"&&(te=JSON.parse(te));var ue=Array.isArray(I)&&0<I.length,de=!Array.isArray(te[0]);if(ue&&ee){for(var oe=0;oe<I.length;oe++)0<oe&&($+=M),$+=z(I[oe],oe);0<te.length&&($+=J)}for(var le=0;le<te.length;le++){var Le=ue?I.length:te[le].length,De=!1,Se=ue?Object.keys(te[le]).length===0:te[le].length===0;if(ae&&!ue&&(De=ae==="greedy"?te[le].join("").trim()==="":te[le].length===1&&te[le][0].length===0),ae==="greedy"&&ue){for(var ne=[],E=0;E<Le;E++){var me=de?I[E]:E;ne.push(te[le][me])}De=ne.join("").trim()===""}if(!De){for(var X=0;X<Le;X++){0<X&&!Se&&($+=M);var Z=ue&&de?I[X]:X;$+=z(te[le][Z],X)}le<te.length-1&&(!ae||0<Le&&!Se)&&($+=J)}}return $}function z(I,te){if(I==null)return"";if(I.constructor===Date)return JSON.stringify(I).slice(1,25);var ae=!1;ve&&typeof I=="string"&&ve.test(I)&&(I="'"+I,ae=!0);var $=I.toString().replace(ce,se);return(ae=ae||q===!0||typeof q=="function"&&q(I,te)||Array.isArray(q)&&q[te]||(function(ue,de){for(var oe=0;oe<de.length;oe++)if(-1<ue.indexOf(de[oe]))return!0;return!1})($,p.BAD_DELIMITERS)||-1<$.indexOf(M)||$.charAt(0)===" "||$.charAt($.length-1)===" ")?N+$+N:$}}};if(p.RECORD_SEP="",p.UNIT_SEP="",p.BYTE_ORDER_MARK="\uFEFF",p.BAD_DELIMITERS=["\r",`
`,'"',p.BYTE_ORDER_MARK],p.WORKERS_SUPPORTED=!l&&!!i.Worker,p.NODE_STREAM_INPUT=1,p.LocalChunkSize=10485760,p.RemoteChunkSize=5242880,p.DefaultDelimiter=",",p.Parser=C,p.ParserHandle=w,p.NetworkStreamer=_,p.FileStreamer=T,p.StringStreamer=x,p.ReadableStreamStreamer=k,i.jQuery){var f=i.jQuery;f.fn.parse=function(j){var O=j.config||{},q=[];return this.each(function(J){if(!(f(this).prop("tagName").toUpperCase()==="INPUT"&&f(this).attr("type").toLowerCase()==="file"&&i.FileReader)||!this.files||this.files.length===0)return!0;for(var N=0;N<this.files.length;N++)q.push({file:this.files[N],inputElem:this,instanceConfig:f.extend({},O)})}),ee(),this;function ee(){if(q.length!==0){var J,N,se,K,P=q[0];if(U(j.before)){var ve=j.before(P.file,P.inputElem);if(typeof ve=="object"){if(ve.action==="abort")return J="AbortError",N=P.file,se=P.inputElem,K=ve.reason,void(U(j.error)&&j.error({name:J},N,se,K));if(ve.action==="skip")return void M();typeof ve.config=="object"&&(P.instanceConfig=f.extend(P.instanceConfig,ve.config))}else if(ve==="skip")return void M()}var ce=P.instanceConfig.complete;P.instanceConfig.complete=function(Ee){U(ce)&&ce(Ee,P.file,P.inputElem),M()},p.parse(P.file,P.instanceConfig)}else U(j.complete)&&j.complete()}function M(){q.splice(0,1),ee()}}}function v(j){this._handle=null,this._finished=!1,this._completed=!1,this._halted=!1,this._input=null,this._baseIndex=0,this._partialLine="",this._rowCount=0,this._start=0,this._nextChunk=null,this.isFirstChunk=!0,this._completeResults={data:[],errors:[],meta:{}},(function(O){var q=G(O);q.chunkSize=parseInt(q.chunkSize),O.step||O.chunk||(q.chunkSize=null),this._handle=new w(q),(this._handle.streamer=this)._config=q}).call(this,j),this.parseChunk=function(O,q){if(this.isFirstChunk&&U(this._config.beforeFirstChunk)){var ee=this._config.beforeFirstChunk(O);ee!==void 0&&(O=ee)}this.isFirstChunk=!1,this._halted=!1;var M=this._partialLine+O;this._partialLine="";var J=this._handle.parse(M,this._baseIndex,!this._finished);if(!this._handle.paused()&&!this._handle.aborted()){var N=J.meta.cursor;this._finished||(this._partialLine=M.substring(N-this._baseIndex),this._baseIndex=N),J&&J.data&&(this._rowCount+=J.data.length);var se=this._finished||this._config.preview&&this._rowCount>=this._config.preview;if(c)i.postMessage({results:J,workerId:p.WORKER_ID,finished:se});else if(U(this._config.chunk)&&!q){if(this._config.chunk(J,this._handle),this._handle.paused()||this._handle.aborted())return void(this._halted=!0);J=void 0,this._completeResults=void 0}return this._config.step||this._config.chunk||(this._completeResults.data=this._completeResults.data.concat(J.data),this._completeResults.errors=this._completeResults.errors.concat(J.errors),this._completeResults.meta=J.meta),this._completed||!se||!U(this._config.complete)||J&&J.meta.aborted||(this._config.complete(this._completeResults,this._input),this._completed=!0),se||J&&J.meta.paused||this._nextChunk(),J}this._halted=!0},this._sendError=function(O){U(this._config.error)?this._config.error(O):c&&this._config.error&&i.postMessage({workerId:p.WORKER_ID,error:O,finished:!1})}}function _(j){var O;(j=j||{}).chunkSize||(j.chunkSize=p.RemoteChunkSize),v.call(this,j),this._nextChunk=l?function(){this._readChunk(),this._chunkLoaded()}:function(){this._readChunk()},this.stream=function(q){this._input=q,this._nextChunk()},this._readChunk=function(){if(this._finished)this._chunkLoaded();else{if(O=new XMLHttpRequest,this._config.withCredentials&&(O.withCredentials=this._config.withCredentials),l||(O.onload=Q(this._chunkLoaded,this),O.onerror=Q(this._chunkError,this)),O.open(this._config.downloadRequestBody?"POST":"GET",this._input,!l),this._config.downloadRequestHeaders){var q=this._config.downloadRequestHeaders;for(var ee in q)O.setRequestHeader(ee,q[ee])}if(this._config.chunkSize){var M=this._start+this._config.chunkSize-1;O.setRequestHeader("Range","bytes="+this._start+"-"+M)}try{O.send(this._config.downloadRequestBody)}catch(J){this._chunkError(J.message)}l&&O.status===0&&this._chunkError()}},this._chunkLoaded=function(){O.readyState===4&&(O.status<200||400<=O.status?this._chunkError():(this._start+=this._config.chunkSize?this._config.chunkSize:O.responseText.length,this._finished=!this._config.chunkSize||this._start>=(function(q){var ee=q.getResponseHeader("Content-Range");return ee===null?-1:parseInt(ee.substring(ee.lastIndexOf("/")+1))})(O),this.parseChunk(O.responseText)))},this._chunkError=function(q){var ee=O.statusText||q;this._sendError(new Error(ee))}}function T(j){var O,q;(j=j||{}).chunkSize||(j.chunkSize=p.LocalChunkSize),v.call(this,j);var ee=typeof FileReader<"u";this.stream=function(M){this._input=M,q=M.slice||M.webkitSlice||M.mozSlice,ee?((O=new FileReader).onload=Q(this._chunkLoaded,this),O.onerror=Q(this._chunkError,this)):O=new FileReaderSync,this._nextChunk()},this._nextChunk=function(){this._finished||this._config.preview&&!(this._rowCount<this._config.preview)||this._readChunk()},this._readChunk=function(){var M=this._input;if(this._config.chunkSize){var J=Math.min(this._start+this._config.chunkSize,this._input.size);M=q.call(M,this._start,J)}var N=O.readAsText(M,this._config.encoding);ee||this._chunkLoaded({target:{result:N}})},this._chunkLoaded=function(M){this._start+=this._config.chunkSize,this._finished=!this._config.chunkSize||this._start>=this._input.size,this.parseChunk(M.target.result)},this._chunkError=function(){this._sendError(O.error)}}function x(j){var O;v.call(this,j=j||{}),this.stream=function(q){return O=q,this._nextChunk()},this._nextChunk=function(){if(!this._finished){var q,ee=this._config.chunkSize;return ee?(q=O.substring(0,ee),O=O.substring(ee)):(q=O,O=""),this._finished=!O,this.parseChunk(q)}}}function k(j){v.call(this,j=j||{});var O=[],q=!0,ee=!1;this.pause=function(){v.prototype.pause.apply(this,arguments),this._input.pause()},this.resume=function(){v.prototype.resume.apply(this,arguments),this._input.resume()},this.stream=function(M){this._input=M,this._input.on("data",this._streamData),this._input.on("end",this._streamEnd),this._input.on("error",this._streamError)},this._checkIsFinished=function(){ee&&O.length===1&&(this._finished=!0)},this._nextChunk=function(){this._checkIsFinished(),O.length?this.parseChunk(O.shift()):q=!0},this._streamData=Q(function(M){try{O.push(typeof M=="string"?M:M.toString(this._config.encoding)),q&&(q=!1,this._checkIsFinished(),this.parseChunk(O.shift()))}catch(J){this._streamError(J)}},this),this._streamError=Q(function(M){this._streamCleanUp(),this._sendError(M)},this),this._streamEnd=Q(function(){this._streamCleanUp(),ee=!0,this._streamData("")},this),this._streamCleanUp=Q(function(){this._input.removeListener("data",this._streamData),this._input.removeListener("end",this._streamEnd),this._input.removeListener("error",this._streamError)},this)}function w(j){var O,q,ee,M=Math.pow(2,53),J=-M,N=/^\s*-?(\d+\.?|\.\d+|\d+\.\d+)([eE][-+]?\d+)?\s*$/,se=/^((\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z)))$/,K=this,P=0,ve=0,ce=!1,Ee=!1,z=[],I={data:[],errors:[],meta:{}};if(U(j.step)){var te=j.step;j.step=function(le){if(I=le,ue())$();else{if($(),I.data.length===0)return;P+=le.data.length,j.preview&&P>j.preview?q.abort():(I.data=I.data[0],te(I,K))}}}function ae(le){return j.skipEmptyLines==="greedy"?le.join("").trim()==="":le.length===1&&le[0].length===0}function $(){return I&&ee&&(oe("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to '"+p.DefaultDelimiter+"'"),ee=!1),j.skipEmptyLines&&(I.data=I.data.filter(function(le){return!ae(le)})),ue()&&(function(){if(!I)return;function le(De,Se){U(j.transformHeader)&&(De=j.transformHeader(De,Se)),z.push(De)}if(Array.isArray(I.data[0])){for(var Le=0;ue()&&Le<I.data.length;Le++)I.data[Le].forEach(le);I.data.splice(0,1)}else I.data.forEach(le)})(),(function(){if(!I||!j.header&&!j.dynamicTyping&&!j.transform)return I;function le(De,Se){var ne,E=j.header?{}:[];for(ne=0;ne<De.length;ne++){var me=ne,X=De[ne];j.header&&(me=ne>=z.length?"__parsed_extra":z[ne]),j.transform&&(X=j.transform(X,me)),X=de(me,X),me==="__parsed_extra"?(E[me]=E[me]||[],E[me].push(X)):E[me]=X}return j.header&&(ne>z.length?oe("FieldMismatch","TooManyFields","Too many fields: expected "+z.length+" fields but parsed "+ne,ve+Se):ne<z.length&&oe("FieldMismatch","TooFewFields","Too few fields: expected "+z.length+" fields but parsed "+ne,ve+Se)),E}var Le=1;return!I.data.length||Array.isArray(I.data[0])?(I.data=I.data.map(le),Le=I.data.length):I.data=le(I.data,0),j.header&&I.meta&&(I.meta.fields=z),ve+=Le,I})()}function ue(){return j.header&&z.length===0}function de(le,Le){return De=le,j.dynamicTypingFunction&&j.dynamicTyping[De]===void 0&&(j.dynamicTyping[De]=j.dynamicTypingFunction(De)),(j.dynamicTyping[De]||j.dynamicTyping)===!0?Le==="true"||Le==="TRUE"||Le!=="false"&&Le!=="FALSE"&&((function(Se){if(N.test(Se)){var ne=parseFloat(Se);if(J<ne&&ne<M)return!0}return!1})(Le)?parseFloat(Le):se.test(Le)?new Date(Le):Le===""?null:Le):Le;var De}function oe(le,Le,De,Se){var ne={type:le,code:Le,message:De};Se!==void 0&&(ne.row=Se),I.errors.push(ne)}this.parse=function(le,Le,De){var Se=j.quoteChar||'"';if(j.newline||(j.newline=(function(me,X){me=me.substring(0,1048576);var Z=new RegExp(S(X)+"([^]*?)"+S(X),"gm"),Y=(me=me.replace(Z,"")).split("\r"),ie=me.split(`
`),ke=1<ie.length&&ie[0].length<Y[0].length;if(Y.length===1||ke)return`
`;for(var Ce=0,pe=0;pe<Y.length;pe++)Y[pe][0]===`
`&&Ce++;return Ce>=Y.length/2?`\r
`:"\r"})(le,Se)),ee=!1,j.delimiter)U(j.delimiter)&&(j.delimiter=j.delimiter(le),I.meta.delimiter=j.delimiter);else{var ne=(function(me,X,Z,Y,ie){var ke,Ce,pe,Ie;ie=ie||[",","	","|",";",p.RECORD_SEP,p.UNIT_SEP];for(var He=0;He<ie.length;He++){var Oe=ie[He],qe=0,nt=0,We=0;pe=void 0;for(var Ye=new C({comments:Y,delimiter:Oe,newline:X,preview:10}).parse(me),St=0;St<Ye.data.length;St++)if(Z&&ae(Ye.data[St]))We++;else{var wt=Ye.data[St].length;nt+=wt,pe!==void 0?0<wt&&(qe+=Math.abs(wt-pe),pe=wt):pe=wt}0<Ye.data.length&&(nt/=Ye.data.length-We),(Ce===void 0||qe<=Ce)&&(Ie===void 0||Ie<nt)&&1.99<nt&&(Ce=qe,ke=Oe,Ie=nt)}return{successful:!!(j.delimiter=ke),bestDelimiter:ke}})(le,j.newline,j.skipEmptyLines,j.comments,j.delimitersToGuess);ne.successful?j.delimiter=ne.bestDelimiter:(ee=!0,j.delimiter=p.DefaultDelimiter),I.meta.delimiter=j.delimiter}var E=G(j);return j.preview&&j.header&&E.preview++,O=le,q=new C(E),I=q.parse(O,Le,De),$(),ce?{meta:{paused:!0}}:I||{meta:{paused:!1}}},this.paused=function(){return ce},this.pause=function(){ce=!0,q.abort(),O=U(j.chunk)?"":O.substring(q.getCharIndex())},this.resume=function(){K.streamer._halted?(ce=!1,K.streamer.parseChunk(O,!0)):setTimeout(K.resume,3)},this.aborted=function(){return Ee},this.abort=function(){Ee=!0,q.abort(),I.meta.aborted=!0,U(j.complete)&&j.complete(I),O=""}}function S(j){return j.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function C(j){var O,q=(j=j||{}).delimiter,ee=j.newline,M=j.comments,J=j.step,N=j.preview,se=j.fastMode,K=O=j.quoteChar===void 0||j.quoteChar===null?'"':j.quoteChar;if(j.escapeChar!==void 0&&(K=j.escapeChar),(typeof q!="string"||-1<p.BAD_DELIMITERS.indexOf(q))&&(q=","),M===q)throw new Error("Comment character same as delimiter");M===!0?M="#":(typeof M!="string"||-1<p.BAD_DELIMITERS.indexOf(M))&&(M=!1),ee!==`
`&&ee!=="\r"&&ee!==`\r
`&&(ee=`
`);var P=0,ve=!1;this.parse=function(ce,Ee,z){if(typeof ce!="string")throw new Error("Input must be a string");var I=ce.length,te=q.length,ae=ee.length,$=M.length,ue=U(J),de=[],oe=[],le=[],Le=P=0;if(!ce)return jt();if(j.header&&!Ee){var De=ce.split(ee)[0].split(q),Se=[],ne={},E=!1;for(var me in De){var X=De[me];U(j.transformHeader)&&(X=j.transformHeader(X,me));var Z=X,Y=ne[X]||0;for(0<Y&&(E=!0,Z=X+"_"+Y),ne[X]=Y+1;Se.includes(Z);)Z=Z+"_"+Y;Se.push(Z)}if(E){var ie=ce.split(ee);ie[0]=Se.join(q),ce=ie.join(ee)}}if(se||se!==!1&&ce.indexOf(O)===-1){for(var ke=ce.split(ee),Ce=0;Ce<ke.length;Ce++){if(le=ke[Ce],P+=le.length,Ce!==ke.length-1)P+=ee.length;else if(z)return jt();if(!M||le.substring(0,$)!==M){if(ue){if(de=[],We(le.split(q)),mt(),ve)return jt()}else We(le.split(q));if(N&&N<=Ce)return de=de.slice(0,N),jt(!0)}}return jt()}for(var pe=ce.indexOf(q,P),Ie=ce.indexOf(ee,P),He=new RegExp(S(K)+S(O),"g"),Oe=ce.indexOf(O,P);;)if(ce[P]!==O)if(M&&le.length===0&&ce.substring(P,P+$)===M){if(Ie===-1)return jt();P=Ie+ae,Ie=ce.indexOf(ee,P),pe=ce.indexOf(q,P)}else if(pe!==-1&&(pe<Ie||Ie===-1))le.push(ce.substring(P,pe)),P=pe+te,pe=ce.indexOf(q,P);else{if(Ie===-1)break;if(le.push(ce.substring(P,Ie)),wt(Ie+ae),ue&&(mt(),ve))return jt();if(N&&de.length>=N)return jt(!0)}else for(Oe=P,P++;;){if((Oe=ce.indexOf(O,Oe+1))===-1)return z||oe.push({type:"Quotes",code:"MissingQuotes",message:"Quoted field unterminated",row:de.length,index:P}),St();if(Oe===I-1)return St(ce.substring(P,Oe).replace(He,O));if(O!==K||ce[Oe+1]!==K){if(O===K||Oe===0||ce[Oe-1]!==K){pe!==-1&&pe<Oe+1&&(pe=ce.indexOf(q,Oe+1)),Ie!==-1&&Ie<Oe+1&&(Ie=ce.indexOf(ee,Oe+1));var qe=Ye(Ie===-1?pe:Math.min(pe,Ie));if(ce.substr(Oe+1+qe,te)===q){le.push(ce.substring(P,Oe).replace(He,O)),ce[P=Oe+1+qe+te]!==O&&(Oe=ce.indexOf(O,P)),pe=ce.indexOf(q,P),Ie=ce.indexOf(ee,P);break}var nt=Ye(Ie);if(ce.substring(Oe+1+nt,Oe+1+nt+ae)===ee){if(le.push(ce.substring(P,Oe).replace(He,O)),wt(Oe+1+nt+ae),pe=ce.indexOf(q,P),Oe=ce.indexOf(O,P),ue&&(mt(),ve))return jt();if(N&&de.length>=N)return jt(!0);break}oe.push({type:"Quotes",code:"InvalidQuotes",message:"Trailing quote on quoted field is malformed",row:de.length,index:P}),Oe++}}else Oe++}return St();function We(rt){de.push(rt),Le=P}function Ye(rt){var un=0;if(rt!==-1){var Mt=ce.substring(Oe+1,rt);Mt&&Mt.trim()===""&&(un=Mt.length)}return un}function St(rt){return z||(rt===void 0&&(rt=ce.substring(P)),le.push(rt),P=I,We(le),ue&&mt()),jt()}function wt(rt){P=rt,We(le),le=[],Ie=ce.indexOf(ee,P)}function jt(rt){return{data:de,errors:oe,meta:{delimiter:q,linebreak:ee,aborted:ve,truncated:!!rt,cursor:Le+(Ee||0)}}}function mt(){J(jt()),de=[],oe=[]}},this.abort=function(){ve=!0},this.getCharIndex=function(){return P}}function R(j){var O=j.data,q=d[O.workerId],ee=!1;if(O.error)q.userError(O.error,O.file);else if(O.results&&O.results.data){var M={abort:function(){ee=!0,L(O.workerId,{data:[],errors:[],meta:{aborted:!0}})},pause:F,resume:F};if(U(q.userStep)){for(var J=0;J<O.results.data.length&&(q.userStep({data:O.results.data[J],errors:O.results.errors,meta:O.results.meta},M),!ee);J++);delete O.results}else U(q.userChunk)&&(q.userChunk(O.results,M,O.file),delete O.results)}O.finished&&!ee&&L(O.workerId,O.results)}function L(j,O){var q=d[j];U(q.userComplete)&&q.userComplete(O),q.terminate(),delete d[j]}function F(){throw new Error("Not implemented.")}function G(j){if(typeof j!="object"||j===null)return j;var O=Array.isArray(j)?[]:{};for(var q in j)O[q]=G(j[q]);return O}function Q(j,O){return function(){j.apply(O,arguments)}}function U(j){return typeof j=="function"}return c&&(i.onmessage=function(j){var O=j.data;if(p.WORKER_ID===void 0&&O&&(p.WORKER_ID=O.workerId),typeof O.input=="string")i.postMessage({workerId:p.WORKER_ID,results:p.parse(O.input,O.config),finished:!0});else if(i.File&&O.input instanceof File||O.input instanceof Object){var q=p.parse(O.input,O.config);q&&i.postMessage({workerId:p.WORKER_ID,results:q,finished:!0})}}),(_.prototype=Object.create(v.prototype)).constructor=_,(T.prototype=Object.create(v.prototype)).constructor=T,(x.prototype=Object.create(x.prototype)).constructor=x,(k.prototype=Object.create(v.prototype)).constructor=k,p})})(uu)),uu.exports}var Gw=Hw();const Lb=co(Gw),qw=n=>{if(Array.isArray(n))return{version:9,decks:n.filter(Boolean).map(s=>(s.type||(s.type=Array.isArray(s.cards)?je.Flashcard:je.Quiz),s.type===je.Flashcard?s.cards=(s.cards||[]).filter(Boolean):s.type===je.Quiz&&(s.questions=(s.questions||[]).filter(Boolean)),s.id=String(s.id||crypto.randomUUID()),s.name||(s.name="Untitled Deck"),s)).filter(s=>s&&s.name),folders:[],deckSeries:[],reviews:[],sessions:[],seriesProgress:{},learningProgress:{},aiChatHistory:[]};if(typeof n=="object"&&n!==null){const a={...n};return a.version||(a.version=2),a.decks||(a.decks=[]),a.folders||(a.folders=[]),a.deckSeries||(a.deckSeries=[]),a.reviews||(a.reviews=[]),a.sessions||(a.sessions=[]),a.seriesProgress||(a.seriesProgress={}),a.learningProgress||(a.learningProgress={}),a.aiChatHistory||(a.aiChatHistory=[]),a.decks=a.decks.map(s=>{if(!s)return null;s.id?s.id=String(s.id):s.id=crypto.randomUUID(),s.type||(s.cards&&s.cards.length>0?s.type="flashcard":s.infoCards&&s.infoCards.length>0?s.type="learning":s.type="quiz"),s.cards||(s.cards=[]),s.questions||(s.questions=[]),s.infoCards||(s.infoCards=[]);const i=l=>l?(l.id=String(l.id||crypto.randomUUID()),(l.interval===void 0||l.interval===null)&&(l.interval=0),(l.easeFactor===void 0||l.easeFactor===null)&&(l.easeFactor=2.5),(l.lapses===void 0||l.lapses===null)&&(l.lapses=0),(l.masteryLevel===void 0||l.masteryLevel===null)&&(l.masteryLevel=0),l.dueDate||(l.dueDate=new Date().toISOString()),l):null;return s.type==="flashcard"?s.cards=s.cards.map(i).filter(Boolean):(s.questions=s.questions.map(l=>{const c=i(l);return c?(c.questionType||(c.questionType="multipleChoice"),c.options||(c.options=[]),c.options=c.options.map(d=>({...d,id:String(d.id||crypto.randomUUID())})),c):null}).filter(Boolean),s.type==="learning"&&(s.infoCards=s.infoCards.map(l=>l?(l.id=String(l.id||crypto.randomUUID()),l.unlocksQuestionIds||(l.unlocksQuestionIds=[]),l):null).filter(Boolean))),s}).filter(Boolean),a.deckSeries=a.deckSeries.map(s=>(s.id=String(s.id),s.levels||(s.levels=[]),s)),a.reviews=a.reviews.map(s=>(s.itemId=String(s.itemId),s.deckId=String(s.deckId),s)),a.sessions=a.sessions.map(s=>s?((s.itemsCompleted===void 0||s.itemsCompleted===null)&&(s.itemsCompleted=s.currentIndex||0),s):null).filter(Boolean),a.version=9,a}return n},Au=async n=>{let a;try{a=JSON.parse(n)}catch{const i=Hh(n);if(!i.isValid&&!i.fixedJSON)throw new Error("Failed to parse backup file.");a=i.parsed||JSON.parse(i.fixedJSON)}if(!a)throw new Error("The backup file appears to be empty or invalid.");if(typeof a=="string"&&(a=JSON.parse(a)),typeof a=="object"&&a!==null&&a.dataType==="cogniflow-compressed-backup-v1"&&typeof a.content=="string"){const i=(await Yh.loadAsync(a.content,{base64:!0})).file("backup.json");if(i){const l=await i.async("string");a=JSON.parse(l)}}if(typeof a=="object"&&a!==null&&!("version"in a)&&!Array.isArray(a)&&("data"in a&&typeof a.data=="object"?a=a.data:"content"in a&&typeof a.content=="object"&&(a=a.content)),a=qw(a),typeof a=="object"&&a!==null&&"version"in a){if(a.version>9)throw new Error(`Unsupported backup version: ${a.version}.`);const s=Mw.safeParse(a);if(!s.success)throw new Error(`Invalid backup data at ${s.error.issues[0].path.join(".")}`);return s.data}throw new Error("The file is not a valid CogniFlow backup file.")},_u=n=>{if(!n.trim())throw new Error("Pasted content is empty.");const a=Hh(n);if(!a.isValid)throw new Error("Invalid JSON.");const s=a.parsed,i=Lw.safeParse(s);if(i.success)return{type:"series",data:i.data};const l=ge.array(Ib).safeParse(s);if(l.success)return{type:je.Flashcard,data:l.data};const c=Sw.safeParse(s);if(c.success){const d=ge.array(Rb).safeParse(s.questions),m=ge.array(qh).optional().safeParse(s.infoCards);d.success||console.warn("Questions failed deep validation:",d.error);const p={...c.data,questions:d.success?d.data:s.questions,infoCards:m.success?m.data:s.infoCards};if(p.type==="learning"||Array.isArray(p.infoCards)&&p.infoCards.length>0){const f=p.questions||[];return(p.infoCards||[]).forEach(_=>{Array.isArray(_.unlocksQuestionIds)&&_.unlocksQuestionIds.forEach(T=>{const x=f.find(k=>k.id===T);x&&(x.infoCardIds||(x.infoCardIds=[]),x.infoCardIds.includes(_.id)||x.infoCardIds.push(_.id))})}),{type:je.Learning,data:p}}return{type:je.Quiz,data:p}}throw new Error("Unsupported JSON structure.")},VT=(n,a)=>{if(!n.trim())throw new Error("Pasted content is empty.");const s=Hh(n);if(!s.isValid)throw new Error("Invalid JSON.");const i=s.parsed;if(!Array.isArray(i))throw new Error("JSON must be an array of items.");if(i.length===0)return[];if(a===je.Flashcard){const l=ge.array(Ib).safeParse(i);if(!l.success)throw new Error("Invalid flashcard format.");return l.data}else{const l=ge.array(Rb).safeParse(i);if(!l.success)throw new Error(`Invalid question format: ${l.error.issues[0].message}`);return l.data}},Ya=n=>{const a=new Date;return a.setHours(0,0,0,0),n.map(s=>({id:crypto.randomUUID(),front:s.front,back:s.back,dueDate:a.toISOString(),interval:0,easeFactor:Cr,masteryLevel:0,lapses:0}))},aa=n=>{const a=new Date;return a.setHours(0,0,0,0),n.map(s=>{const i=s.correctAnswerId,l=(s.options||[]).map(d=>({...d,id:d.id||crypto.randomUUID(),text:d.text||"",explanation:d.explanation||""}));let c="";if(i){const d=l.find(m=>m.id===i);d&&(c=d.id)}if(!c){const d=l.find(m=>{var p,f,v;return((p=m.explanation)==null?void 0:p.toLowerCase().includes("correct"))||((f=m.text)==null?void 0:f.toLowerCase().startsWith("correct"))||((v=m.explanation)==null?void 0:v.toLowerCase().startsWith("correct"))});d&&(c=d.id)}return!c&&l.length>0&&(c=l[0].id),{...s,id:s.id||crypto.randomUUID(),questionType:"multipleChoice",dueDate:a.toISOString(),interval:0,easeFactor:Cr,masteryLevel:0,lapses:0,detailedExplanation:s.detailedExplanation||"",correctAnswerId:c,options:l}})},Pw=n=>{const{data:a,errors:s}=Lb.parse(n,{header:!0,skipEmptyLines:!0,transformHeader:l=>l.trim().toLowerCase()});if(s.length>0)throw new Error(`CSV Parsing Error: ${s[0].message}`);const i=a.map(l=>{const c=l.front||l.question||l.term||l.en||Object.values(l)[0],d=l.back||l.answer||l.definition||l.translation||Object.values(l)[1];return!c||!d?null:{front:String(c).trim(),back:String(d).trim()}}).filter(l=>l!==null);if(i.length===0)throw new Error("No valid cards found in CSV.");return i},zb=async n=>{const a=n.name.toLowerCase();if(a.endsWith(".apkg")||a.endsWith(".zip"))return{type:"anki",data:{name:n.name},file:n,fileName:n.name};if(a.match(/\.(png|jpg|jpeg|webp|gif)$/))return{type:"image",data:{name:n.name,mimeType:n.type},file:n,fileName:n.name};if(a.endsWith(".csv"))try{const s=await n.text();return{type:"flashcard",data:Pw(s),fileName:n.name}}catch(s){console.error("Failed to parse CSV",s)}try{const s=await n.text(),i=s.trim();if(i.startsWith("{")||i.startsWith("[")){try{const l=_u(s);return{type:l.type,data:l.data,fileName:n.name}}catch(l){console.debug("JSON: Not a standard import format, checking if backup...",l)}try{return{type:"backup",data:await Au(s),fileName:n.name}}catch(l){console.debug("JSON: Not a valid backup format.",l)}}}catch(s){console.error("Failed to read file text for JSON check",s)}return null};var $w={};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var Gy;(function(n){n.OUTCOME_UNSPECIFIED="OUTCOME_UNSPECIFIED",n.OUTCOME_OK="OUTCOME_OK",n.OUTCOME_FAILED="OUTCOME_FAILED",n.OUTCOME_DEADLINE_EXCEEDED="OUTCOME_DEADLINE_EXCEEDED"})(Gy||(Gy={}));var qy;(function(n){n.LANGUAGE_UNSPECIFIED="LANGUAGE_UNSPECIFIED",n.PYTHON="PYTHON"})(qy||(qy={}));var Py;(function(n){n.SCHEDULING_UNSPECIFIED="SCHEDULING_UNSPECIFIED",n.SILENT="SILENT",n.WHEN_IDLE="WHEN_IDLE",n.INTERRUPT="INTERRUPT"})(Py||(Py={}));var Xn;(function(n){n.TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",n.STRING="STRING",n.NUMBER="NUMBER",n.INTEGER="INTEGER",n.BOOLEAN="BOOLEAN",n.ARRAY="ARRAY",n.OBJECT="OBJECT",n.NULL="NULL"})(Xn||(Xn={}));var $y;(function(n){n.MODE_UNSPECIFIED="MODE_UNSPECIFIED",n.MODE_DYNAMIC="MODE_DYNAMIC"})($y||($y={}));var Yy;(function(n){n.API_SPEC_UNSPECIFIED="API_SPEC_UNSPECIFIED",n.SIMPLE_SEARCH="SIMPLE_SEARCH",n.ELASTIC_SEARCH="ELASTIC_SEARCH"})(Yy||(Yy={}));var Vy;(function(n){n.AUTH_TYPE_UNSPECIFIED="AUTH_TYPE_UNSPECIFIED",n.NO_AUTH="NO_AUTH",n.API_KEY_AUTH="API_KEY_AUTH",n.HTTP_BASIC_AUTH="HTTP_BASIC_AUTH",n.GOOGLE_SERVICE_ACCOUNT_AUTH="GOOGLE_SERVICE_ACCOUNT_AUTH",n.OAUTH="OAUTH",n.OIDC_AUTH="OIDC_AUTH"})(Vy||(Vy={}));var Ky;(function(n){n.HTTP_IN_UNSPECIFIED="HTTP_IN_UNSPECIFIED",n.HTTP_IN_QUERY="HTTP_IN_QUERY",n.HTTP_IN_HEADER="HTTP_IN_HEADER",n.HTTP_IN_PATH="HTTP_IN_PATH",n.HTTP_IN_BODY="HTTP_IN_BODY",n.HTTP_IN_COOKIE="HTTP_IN_COOKIE"})(Ky||(Ky={}));var Zy;(function(n){n.PHISH_BLOCK_THRESHOLD_UNSPECIFIED="PHISH_BLOCK_THRESHOLD_UNSPECIFIED",n.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",n.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",n.BLOCK_HIGH_AND_ABOVE="BLOCK_HIGH_AND_ABOVE",n.BLOCK_HIGHER_AND_ABOVE="BLOCK_HIGHER_AND_ABOVE",n.BLOCK_VERY_HIGH_AND_ABOVE="BLOCK_VERY_HIGH_AND_ABOVE",n.BLOCK_ONLY_EXTREMELY_HIGH="BLOCK_ONLY_EXTREMELY_HIGH"})(Zy||(Zy={}));var Qy;(function(n){n.THINKING_LEVEL_UNSPECIFIED="THINKING_LEVEL_UNSPECIFIED",n.LOW="LOW",n.MEDIUM="MEDIUM",n.HIGH="HIGH",n.MINIMAL="MINIMAL"})(Qy||(Qy={}));var Jy;(function(n){n.HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",n.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",n.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",n.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",n.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",n.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY",n.HARM_CATEGORY_IMAGE_HATE="HARM_CATEGORY_IMAGE_HATE",n.HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT="HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT",n.HARM_CATEGORY_IMAGE_HARASSMENT="HARM_CATEGORY_IMAGE_HARASSMENT",n.HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT="HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT",n.HARM_CATEGORY_JAILBREAK="HARM_CATEGORY_JAILBREAK"})(Jy||(Jy={}));var Xy;(function(n){n.HARM_BLOCK_METHOD_UNSPECIFIED="HARM_BLOCK_METHOD_UNSPECIFIED",n.SEVERITY="SEVERITY",n.PROBABILITY="PROBABILITY"})(Xy||(Xy={}));var Wy;(function(n){n.HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",n.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",n.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",n.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",n.BLOCK_NONE="BLOCK_NONE",n.OFF="OFF"})(Wy||(Wy={}));var ev;(function(n){n.FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",n.STOP="STOP",n.MAX_TOKENS="MAX_TOKENS",n.SAFETY="SAFETY",n.RECITATION="RECITATION",n.LANGUAGE="LANGUAGE",n.OTHER="OTHER",n.BLOCKLIST="BLOCKLIST",n.PROHIBITED_CONTENT="PROHIBITED_CONTENT",n.SPII="SPII",n.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",n.IMAGE_SAFETY="IMAGE_SAFETY",n.UNEXPECTED_TOOL_CALL="UNEXPECTED_TOOL_CALL",n.IMAGE_PROHIBITED_CONTENT="IMAGE_PROHIBITED_CONTENT",n.NO_IMAGE="NO_IMAGE",n.IMAGE_RECITATION="IMAGE_RECITATION",n.IMAGE_OTHER="IMAGE_OTHER"})(ev||(ev={}));var tv;(function(n){n.HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",n.NEGLIGIBLE="NEGLIGIBLE",n.LOW="LOW",n.MEDIUM="MEDIUM",n.HIGH="HIGH"})(tv||(tv={}));var nv;(function(n){n.HARM_SEVERITY_UNSPECIFIED="HARM_SEVERITY_UNSPECIFIED",n.HARM_SEVERITY_NEGLIGIBLE="HARM_SEVERITY_NEGLIGIBLE",n.HARM_SEVERITY_LOW="HARM_SEVERITY_LOW",n.HARM_SEVERITY_MEDIUM="HARM_SEVERITY_MEDIUM",n.HARM_SEVERITY_HIGH="HARM_SEVERITY_HIGH"})(nv||(nv={}));var rv;(function(n){n.URL_RETRIEVAL_STATUS_UNSPECIFIED="URL_RETRIEVAL_STATUS_UNSPECIFIED",n.URL_RETRIEVAL_STATUS_SUCCESS="URL_RETRIEVAL_STATUS_SUCCESS",n.URL_RETRIEVAL_STATUS_ERROR="URL_RETRIEVAL_STATUS_ERROR",n.URL_RETRIEVAL_STATUS_PAYWALL="URL_RETRIEVAL_STATUS_PAYWALL",n.URL_RETRIEVAL_STATUS_UNSAFE="URL_RETRIEVAL_STATUS_UNSAFE"})(rv||(rv={}));var av;(function(n){n.BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",n.SAFETY="SAFETY",n.OTHER="OTHER",n.BLOCKLIST="BLOCKLIST",n.PROHIBITED_CONTENT="PROHIBITED_CONTENT",n.IMAGE_SAFETY="IMAGE_SAFETY",n.MODEL_ARMOR="MODEL_ARMOR",n.JAILBREAK="JAILBREAK"})(av||(av={}));var sv;(function(n){n.TRAFFIC_TYPE_UNSPECIFIED="TRAFFIC_TYPE_UNSPECIFIED",n.ON_DEMAND="ON_DEMAND",n.PROVISIONED_THROUGHPUT="PROVISIONED_THROUGHPUT"})(sv||(sv={}));var Dh;(function(n){n.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",n.TEXT="TEXT",n.IMAGE="IMAGE",n.AUDIO="AUDIO"})(Dh||(Dh={}));var iv;(function(n){n.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",n.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",n.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",n.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH"})(iv||(iv={}));var ov;(function(n){n.TUNING_MODE_UNSPECIFIED="TUNING_MODE_UNSPECIFIED",n.TUNING_MODE_FULL="TUNING_MODE_FULL",n.TUNING_MODE_PEFT_ADAPTER="TUNING_MODE_PEFT_ADAPTER"})(ov||(ov={}));var lv;(function(n){n.ADAPTER_SIZE_UNSPECIFIED="ADAPTER_SIZE_UNSPECIFIED",n.ADAPTER_SIZE_ONE="ADAPTER_SIZE_ONE",n.ADAPTER_SIZE_TWO="ADAPTER_SIZE_TWO",n.ADAPTER_SIZE_FOUR="ADAPTER_SIZE_FOUR",n.ADAPTER_SIZE_EIGHT="ADAPTER_SIZE_EIGHT",n.ADAPTER_SIZE_SIXTEEN="ADAPTER_SIZE_SIXTEEN",n.ADAPTER_SIZE_THIRTY_TWO="ADAPTER_SIZE_THIRTY_TWO"})(lv||(lv={}));var cv;(function(n){n.JOB_STATE_UNSPECIFIED="JOB_STATE_UNSPECIFIED",n.JOB_STATE_QUEUED="JOB_STATE_QUEUED",n.JOB_STATE_PENDING="JOB_STATE_PENDING",n.JOB_STATE_RUNNING="JOB_STATE_RUNNING",n.JOB_STATE_SUCCEEDED="JOB_STATE_SUCCEEDED",n.JOB_STATE_FAILED="JOB_STATE_FAILED",n.JOB_STATE_CANCELLING="JOB_STATE_CANCELLING",n.JOB_STATE_CANCELLED="JOB_STATE_CANCELLED",n.JOB_STATE_PAUSED="JOB_STATE_PAUSED",n.JOB_STATE_EXPIRED="JOB_STATE_EXPIRED",n.JOB_STATE_UPDATING="JOB_STATE_UPDATING",n.JOB_STATE_PARTIALLY_SUCCEEDED="JOB_STATE_PARTIALLY_SUCCEEDED"})(cv||(cv={}));var uv;(function(n){n.TUNING_TASK_UNSPECIFIED="TUNING_TASK_UNSPECIFIED",n.TUNING_TASK_I2V="TUNING_TASK_I2V",n.TUNING_TASK_T2V="TUNING_TASK_T2V",n.TUNING_TASK_R2V="TUNING_TASK_R2V"})(uv||(uv={}));var dv;(function(n){n.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",n.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",n.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",n.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH",n.MEDIA_RESOLUTION_ULTRA_HIGH="MEDIA_RESOLUTION_ULTRA_HIGH"})(dv||(dv={}));var fv;(function(n){n.FEATURE_SELECTION_PREFERENCE_UNSPECIFIED="FEATURE_SELECTION_PREFERENCE_UNSPECIFIED",n.PRIORITIZE_QUALITY="PRIORITIZE_QUALITY",n.BALANCED="BALANCED",n.PRIORITIZE_COST="PRIORITIZE_COST"})(fv||(fv={}));var hv;(function(n){n.UNSPECIFIED="UNSPECIFIED",n.BLOCKING="BLOCKING",n.NON_BLOCKING="NON_BLOCKING"})(hv||(hv={}));var mv;(function(n){n.MODE_UNSPECIFIED="MODE_UNSPECIFIED",n.MODE_DYNAMIC="MODE_DYNAMIC"})(mv||(mv={}));var pv;(function(n){n.ENVIRONMENT_UNSPECIFIED="ENVIRONMENT_UNSPECIFIED",n.ENVIRONMENT_BROWSER="ENVIRONMENT_BROWSER"})(pv||(pv={}));var gv;(function(n){n.MODE_UNSPECIFIED="MODE_UNSPECIFIED",n.AUTO="AUTO",n.ANY="ANY",n.NONE="NONE",n.VALIDATED="VALIDATED"})(gv||(gv={}));var yv;(function(n){n.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",n.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",n.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",n.BLOCK_NONE="BLOCK_NONE"})(yv||(yv={}));var vv;(function(n){n.DONT_ALLOW="DONT_ALLOW",n.ALLOW_ADULT="ALLOW_ADULT",n.ALLOW_ALL="ALLOW_ALL"})(vv||(vv={}));var bv;(function(n){n.auto="auto",n.en="en",n.ja="ja",n.ko="ko",n.hi="hi",n.zh="zh",n.pt="pt",n.es="es"})(bv||(bv={}));var xv;(function(n){n.MASK_MODE_DEFAULT="MASK_MODE_DEFAULT",n.MASK_MODE_USER_PROVIDED="MASK_MODE_USER_PROVIDED",n.MASK_MODE_BACKGROUND="MASK_MODE_BACKGROUND",n.MASK_MODE_FOREGROUND="MASK_MODE_FOREGROUND",n.MASK_MODE_SEMANTIC="MASK_MODE_SEMANTIC"})(xv||(xv={}));var _v;(function(n){n.CONTROL_TYPE_DEFAULT="CONTROL_TYPE_DEFAULT",n.CONTROL_TYPE_CANNY="CONTROL_TYPE_CANNY",n.CONTROL_TYPE_SCRIBBLE="CONTROL_TYPE_SCRIBBLE",n.CONTROL_TYPE_FACE_MESH="CONTROL_TYPE_FACE_MESH"})(_v||(_v={}));var Sv;(function(n){n.SUBJECT_TYPE_DEFAULT="SUBJECT_TYPE_DEFAULT",n.SUBJECT_TYPE_PERSON="SUBJECT_TYPE_PERSON",n.SUBJECT_TYPE_ANIMAL="SUBJECT_TYPE_ANIMAL",n.SUBJECT_TYPE_PRODUCT="SUBJECT_TYPE_PRODUCT"})(Sv||(Sv={}));var wv;(function(n){n.EDIT_MODE_DEFAULT="EDIT_MODE_DEFAULT",n.EDIT_MODE_INPAINT_REMOVAL="EDIT_MODE_INPAINT_REMOVAL",n.EDIT_MODE_INPAINT_INSERTION="EDIT_MODE_INPAINT_INSERTION",n.EDIT_MODE_OUTPAINT="EDIT_MODE_OUTPAINT",n.EDIT_MODE_CONTROLLED_EDITING="EDIT_MODE_CONTROLLED_EDITING",n.EDIT_MODE_STYLE="EDIT_MODE_STYLE",n.EDIT_MODE_BGSWAP="EDIT_MODE_BGSWAP",n.EDIT_MODE_PRODUCT_IMAGE="EDIT_MODE_PRODUCT_IMAGE"})(wv||(wv={}));var Ev;(function(n){n.FOREGROUND="FOREGROUND",n.BACKGROUND="BACKGROUND",n.PROMPT="PROMPT",n.SEMANTIC="SEMANTIC",n.INTERACTIVE="INTERACTIVE"})(Ev||(Ev={}));var Tv;(function(n){n.ASSET="ASSET",n.STYLE="STYLE"})(Tv||(Tv={}));var Av;(function(n){n.INSERT="INSERT",n.REMOVE="REMOVE",n.REMOVE_STATIC="REMOVE_STATIC",n.OUTPAINT="OUTPAINT"})(Av||(Av={}));var kv;(function(n){n.OPTIMIZED="OPTIMIZED",n.LOSSLESS="LOSSLESS"})(kv||(kv={}));var Cv;(function(n){n.SUPERVISED_FINE_TUNING="SUPERVISED_FINE_TUNING",n.PREFERENCE_TUNING="PREFERENCE_TUNING"})(Cv||(Cv={}));var Nv;(function(n){n.STATE_UNSPECIFIED="STATE_UNSPECIFIED",n.STATE_PENDING="STATE_PENDING",n.STATE_ACTIVE="STATE_ACTIVE",n.STATE_FAILED="STATE_FAILED"})(Nv||(Nv={}));var Dv;(function(n){n.STATE_UNSPECIFIED="STATE_UNSPECIFIED",n.PROCESSING="PROCESSING",n.ACTIVE="ACTIVE",n.FAILED="FAILED"})(Dv||(Dv={}));var Ov;(function(n){n.SOURCE_UNSPECIFIED="SOURCE_UNSPECIFIED",n.UPLOADED="UPLOADED",n.GENERATED="GENERATED"})(Ov||(Ov={}));var jv;(function(n){n.TURN_COMPLETE_REASON_UNSPECIFIED="TURN_COMPLETE_REASON_UNSPECIFIED",n.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",n.RESPONSE_REJECTED="RESPONSE_REJECTED",n.NEED_MORE_INPUT="NEED_MORE_INPUT"})(jv||(jv={}));var Iv;(function(n){n.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",n.TEXT="TEXT",n.IMAGE="IMAGE",n.VIDEO="VIDEO",n.AUDIO="AUDIO",n.DOCUMENT="DOCUMENT"})(Iv||(Iv={}));var Rv;(function(n){n.VAD_SIGNAL_TYPE_UNSPECIFIED="VAD_SIGNAL_TYPE_UNSPECIFIED",n.VAD_SIGNAL_TYPE_SOS="VAD_SIGNAL_TYPE_SOS",n.VAD_SIGNAL_TYPE_EOS="VAD_SIGNAL_TYPE_EOS"})(Rv||(Rv={}));var Mv;(function(n){n.START_SENSITIVITY_UNSPECIFIED="START_SENSITIVITY_UNSPECIFIED",n.START_SENSITIVITY_HIGH="START_SENSITIVITY_HIGH",n.START_SENSITIVITY_LOW="START_SENSITIVITY_LOW"})(Mv||(Mv={}));var Uv;(function(n){n.END_SENSITIVITY_UNSPECIFIED="END_SENSITIVITY_UNSPECIFIED",n.END_SENSITIVITY_HIGH="END_SENSITIVITY_HIGH",n.END_SENSITIVITY_LOW="END_SENSITIVITY_LOW"})(Uv||(Uv={}));var Lv;(function(n){n.ACTIVITY_HANDLING_UNSPECIFIED="ACTIVITY_HANDLING_UNSPECIFIED",n.START_OF_ACTIVITY_INTERRUPTS="START_OF_ACTIVITY_INTERRUPTS",n.NO_INTERRUPTION="NO_INTERRUPTION"})(Lv||(Lv={}));var zv;(function(n){n.TURN_COVERAGE_UNSPECIFIED="TURN_COVERAGE_UNSPECIFIED",n.TURN_INCLUDES_ONLY_ACTIVITY="TURN_INCLUDES_ONLY_ACTIVITY",n.TURN_INCLUDES_ALL_INPUT="TURN_INCLUDES_ALL_INPUT"})(zv||(zv={}));var Fv;(function(n){n.SCALE_UNSPECIFIED="SCALE_UNSPECIFIED",n.C_MAJOR_A_MINOR="C_MAJOR_A_MINOR",n.D_FLAT_MAJOR_B_FLAT_MINOR="D_FLAT_MAJOR_B_FLAT_MINOR",n.D_MAJOR_B_MINOR="D_MAJOR_B_MINOR",n.E_FLAT_MAJOR_C_MINOR="E_FLAT_MAJOR_C_MINOR",n.E_MAJOR_D_FLAT_MINOR="E_MAJOR_D_FLAT_MINOR",n.F_MAJOR_D_MINOR="F_MAJOR_D_MINOR",n.G_FLAT_MAJOR_E_FLAT_MINOR="G_FLAT_MAJOR_E_FLAT_MINOR",n.G_MAJOR_E_MINOR="G_MAJOR_E_MINOR",n.A_FLAT_MAJOR_F_MINOR="A_FLAT_MAJOR_F_MINOR",n.A_MAJOR_G_FLAT_MINOR="A_MAJOR_G_FLAT_MINOR",n.B_FLAT_MAJOR_G_MINOR="B_FLAT_MAJOR_G_MINOR",n.B_MAJOR_A_FLAT_MINOR="B_MAJOR_A_FLAT_MINOR"})(Fv||(Fv={}));var Bv;(function(n){n.MUSIC_GENERATION_MODE_UNSPECIFIED="MUSIC_GENERATION_MODE_UNSPECIFIED",n.QUALITY="QUALITY",n.DIVERSITY="DIVERSITY",n.VOCALIZATION="VOCALIZATION"})(Bv||(Bv={}));var Hv;(function(n){n.PLAYBACK_CONTROL_UNSPECIFIED="PLAYBACK_CONTROL_UNSPECIFIED",n.PLAY="PLAY",n.PAUSE="PAUSE",n.STOP="STOP",n.RESET_CONTEXT="RESET_CONTEXT"})(Hv||(Hv={}));/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var Gv;(function(n){n.PAGED_ITEM_BATCH_JOBS="batchJobs",n.PAGED_ITEM_MODELS="models",n.PAGED_ITEM_TUNING_JOBS="tuningJobs",n.PAGED_ITEM_FILES="files",n.PAGED_ITEM_CACHED_CONTENTS="cachedContents",n.PAGED_ITEM_FILE_SEARCH_STORES="fileSearchStores",n.PAGED_ITEM_DOCUMENTS="documents"})(Gv||(Gv={}));function Su(n,a){var s={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&a.indexOf(i)<0&&(s[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var l=0,i=Object.getOwnPropertySymbols(n);l<i.length;l++)a.indexOf(i[l])<0&&Object.prototype.propertyIsEnumerable.call(n,i[l])&&(s[i[l]]=n[i[l]]);return s}function qv(n){var a=typeof Symbol=="function"&&Symbol.iterator,s=a&&n[a],i=0;if(s)return s.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&i>=n.length&&(n=void 0),{value:n&&n[i++],done:!n}}};throw new TypeError(a?"Object is not iterable.":"Symbol.iterator is not defined.")}function gn(n){return this instanceof gn?(this.v=n,this):new gn(n)}function yl(n,a,s){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i=s.apply(n,a||[]),l,c=[];return l=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),m("next"),m("throw"),m("return",d),l[Symbol.asyncIterator]=function(){return this},l;function d(x){return function(k){return Promise.resolve(k).then(x,_)}}function m(x,k){i[x]&&(l[x]=function(w){return new Promise(function(S,C){c.push([x,w,S,C])>1||p(x,w)})},k&&(l[x]=k(l[x])))}function p(x,k){try{f(i[x](k))}catch(w){T(c[0][3],w)}}function f(x){x.value instanceof gn?Promise.resolve(x.value.v).then(v,_):T(c[0][2],x)}function v(x){p("next",x)}function _(x){p("throw",x)}function T(x,k){x(k),c.shift(),c.length&&p(c[0][0],c[0][1])}}function ao(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var a=n[Symbol.asyncIterator],s;return a?a.call(n):(n=typeof qv=="function"?qv(n):n[Symbol.iterator](),s={},i("next"),i("throw"),i("return"),s[Symbol.asyncIterator]=function(){return this},s);function i(c){s[c]=n[c]&&function(d){return new Promise(function(m,p){d=n[c](d),l(m,p,d.done,d.value)})}}function l(c,d,m,p){Promise.resolve(p).then(function(f){c({value:f,done:m})},d)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */let Fb=function(){const{crypto:n}=globalThis;if(n!=null&&n.randomUUID)return Fb=n.randomUUID.bind(n),n.randomUUID();const a=new Uint8Array(1),s=n?()=>n.getRandomValues(a)[0]:()=>Math.random()*255&255;return"10000000-1000-4000-8000-100000000000".replace(/[018]/g,i=>(+i^s()&15>>+i/4).toString(16))};const Yw=()=>Fb();/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Oh(n){return typeof n=="object"&&n!==null&&("name"in n&&n.name==="AbortError"||"message"in n&&String(n.message).includes("FetchRequestCanceledException"))}const jh=n=>{if(n instanceof Error)return n;if(typeof n=="object"&&n!==null){try{if(Object.prototype.toString.call(n)==="[object Error]"){const a=new Error(n.message,n.cause?{cause:n.cause}:{});return n.stack&&(a.stack=n.stack),n.cause&&!a.cause&&(a.cause=n.cause),n.name&&(a.name=n.name),a}}catch{}try{return new Error(JSON.stringify(n))}catch{}}return new Error(n)};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Kr extends Error{}class or extends Kr{constructor(a,s,i,l){super(`${or.makeMessage(a,s,i)}`),this.status=a,this.headers=l,this.error=s}static makeMessage(a,s,i){const l=s!=null&&s.message?typeof s.message=="string"?s.message:JSON.stringify(s.message):s?JSON.stringify(s):i;return a&&l?`${a} ${l}`:a?`${a} status code (no body)`:l||"(no status code or body)"}static generate(a,s,i,l){if(!a||!l)return new ku({message:i,cause:jh(s)});const c=s;return a===400?new Hb(a,c,i,l):a===401?new Gb(a,c,i,l):a===403?new qb(a,c,i,l):a===404?new Pb(a,c,i,l):a===409?new $b(a,c,i,l):a===422?new Yb(a,c,i,l):a===429?new Vb(a,c,i,l):a>=500?new Kb(a,c,i,l):new or(a,c,i,l)}}class Ih extends or{constructor({message:a}={}){super(void 0,void 0,a||"Request was aborted.",void 0)}}class ku extends or{constructor({message:a,cause:s}){super(void 0,void 0,a||"Connection error.",void 0),s&&(this.cause=s)}}class Bb extends ku{constructor({message:a}={}){super({message:a??"Request timed out."})}}class Hb extends or{}class Gb extends or{}class qb extends or{}class Pb extends or{}class $b extends or{}class Yb extends or{}class Vb extends or{}class Kb extends or{}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Vw=/^[a-z][a-z0-9+.-]*:/i,Kw=n=>Vw.test(n);let Rh=n=>(Rh=Array.isArray,Rh(n));const Zw=Rh;let Qw=Zw;const Pv=Qw;function Jw(n){if(!n)return!0;for(const a in n)return!1;return!0}function Xw(n,a){return Object.prototype.hasOwnProperty.call(n,a)}const Ww=(n,a)=>{if(typeof a!="number"||!Number.isInteger(a))throw new Kr(`${n} must be an integer`);if(a<0)throw new Kr(`${n} must be a positive integer`);return a},eE=n=>{try{return JSON.parse(n)}catch{return}};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const tE=n=>new Promise(a=>setTimeout(a,n));/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Xi="0.0.1";/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function nE(){return typeof Deno<"u"&&Deno.build!=null?"deno":typeof EdgeRuntime<"u"?"edge":Object.prototype.toString.call(typeof globalThis.process<"u"?globalThis.process:0)==="[object process]"?"node":"unknown"}const rE=()=>{var n,a,s,i,l;const c=nE();if(c==="deno")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Xi,"X-Stainless-OS":Yv(Deno.build.os),"X-Stainless-Arch":$v(Deno.build.arch),"X-Stainless-Runtime":"deno","X-Stainless-Runtime-Version":typeof Deno.version=="string"?Deno.version:(a=(n=Deno.version)===null||n===void 0?void 0:n.deno)!==null&&a!==void 0?a:"unknown"};if(typeof EdgeRuntime<"u")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Xi,"X-Stainless-OS":"Unknown","X-Stainless-Arch":`other:${EdgeRuntime}`,"X-Stainless-Runtime":"edge","X-Stainless-Runtime-Version":globalThis.process.version};if(c==="node")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Xi,"X-Stainless-OS":Yv((s=globalThis.process.platform)!==null&&s!==void 0?s:"unknown"),"X-Stainless-Arch":$v((i=globalThis.process.arch)!==null&&i!==void 0?i:"unknown"),"X-Stainless-Runtime":"node","X-Stainless-Runtime-Version":(l=globalThis.process.version)!==null&&l!==void 0?l:"unknown"};const d=aE();return d?{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Xi,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":`browser:${d.browser}`,"X-Stainless-Runtime-Version":d.version}:{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Xi,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":"unknown","X-Stainless-Runtime-Version":"unknown"}};function aE(){if(typeof navigator>"u"||!navigator)return null;const n=[{key:"edge",pattern:/Edge(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/MSIE(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/Trident(?:.*rv\:(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"chrome",pattern:/Chrome(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"firefox",pattern:/Firefox(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"safari",pattern:/(?:Version\W+(\d+)\.(\d+)(?:\.(\d+))?)?(?:\W+Mobile\S*)?\W+Safari/}];for(const{key:a,pattern:s}of n){const i=s.exec(navigator.userAgent);if(i){const l=i[1]||0,c=i[2]||0,d=i[3]||0;return{browser:a,version:`${l}.${c}.${d}`}}}return null}const $v=n=>n==="x32"?"x32":n==="x86_64"||n==="x64"?"x64":n==="arm"?"arm":n==="aarch64"||n==="arm64"?"arm64":n?`other:${n}`:"unknown",Yv=n=>(n=n.toLowerCase(),n.includes("ios")?"iOS":n==="android"?"Android":n==="darwin"?"MacOS":n==="win32"?"Windows":n==="freebsd"?"FreeBSD":n==="openbsd"?"OpenBSD":n==="linux"?"Linux":n?`Other:${n}`:"Unknown");let Jc;const sE=()=>Jc??(Jc=rE());/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function iE(){if(typeof fetch<"u")return fetch;throw new Error("`fetch` is not defined as a global; Either pass `fetch` to the client, `new GeminiNextGenAPIClient({ fetch })` or polyfill the global, `globalThis.fetch = fetch`")}function Zb(...n){const a=globalThis.ReadableStream;if(typeof a>"u")throw new Error("`ReadableStream` is not defined as a global; You will need to polyfill it, `globalThis.ReadableStream = ReadableStream`");return new a(...n)}function oE(n){let a=Symbol.asyncIterator in n?n[Symbol.asyncIterator]():n[Symbol.iterator]();return Zb({start(){},async pull(s){const{done:i,value:l}=await a.next();i?s.close():s.enqueue(l)},async cancel(){var s;await((s=a.return)===null||s===void 0?void 0:s.call(a))}})}function Qb(n){if(n[Symbol.asyncIterator])return n;const a=n.getReader();return{async next(){try{const s=await a.read();return s!=null&&s.done&&a.releaseLock(),s}catch(s){throw a.releaseLock(),s}},async return(){const s=a.cancel();return a.releaseLock(),await s,{done:!0,value:void 0}},[Symbol.asyncIterator](){return this}}}async function lE(n){var a,s;if(n===null||typeof n!="object")return;if(n[Symbol.asyncIterator]){await((s=(a=n[Symbol.asyncIterator]()).return)===null||s===void 0?void 0:s.call(a));return}const i=n.getReader(),l=i.cancel();i.releaseLock(),await l}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const cE=({headers:n,body:a})=>({bodyHeaders:{"content-type":"application/json"},body:JSON.stringify(a)});/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Jb=()=>{var n;if(typeof File>"u"){const{process:a}=globalThis,s=typeof((n=a==null?void 0:a.versions)===null||n===void 0?void 0:n.node)=="string"&&parseInt(a.versions.node.split("."))<20;throw new Error("`File` is not defined as a global, which is required for file uploads."+(s?" Update to Node 20 LTS or newer, or set `globalThis.File` to `import('node:buffer').File`.":""))}};function ah(n,a,s){return Jb(),new File(n,a??"unknown_file",s)}function uE(n){return(typeof n=="object"&&n!==null&&("name"in n&&n.name&&String(n.name)||"url"in n&&n.url&&String(n.url)||"filename"in n&&n.filename&&String(n.filename)||"path"in n&&n.path&&String(n.path))||"").split(/[\\/]/).pop()||void 0}const dE=n=>n!=null&&typeof n=="object"&&typeof n[Symbol.asyncIterator]=="function";/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Xb=n=>n!=null&&typeof n=="object"&&typeof n.size=="number"&&typeof n.type=="string"&&typeof n.text=="function"&&typeof n.slice=="function"&&typeof n.arrayBuffer=="function",fE=n=>n!=null&&typeof n=="object"&&typeof n.name=="string"&&typeof n.lastModified=="number"&&Xb(n),hE=n=>n!=null&&typeof n=="object"&&typeof n.url=="string"&&typeof n.blob=="function";async function mE(n,a,s){if(Jb(),n=await n,fE(n))return n instanceof File?n:ah([await n.arrayBuffer()],n.name);if(hE(n)){const l=await n.blob();return a||(a=new URL(n.url).pathname.split(/[\\/]/).pop()),ah(await Mh(l),a,s)}const i=await Mh(n);if(a||(a=uE(n)),!(s!=null&&s.type)){const l=i.find(c=>typeof c=="object"&&"type"in c&&c.type);typeof l=="string"&&(s=Object.assign(Object.assign({},s),{type:l}))}return ah(i,a,s)}async function Mh(n){var a,s,i,l,c;let d=[];if(typeof n=="string"||ArrayBuffer.isView(n)||n instanceof ArrayBuffer)d.push(n);else if(Xb(n))d.push(n instanceof Blob?n:await n.arrayBuffer());else if(dE(n))try{for(var m=!0,p=ao(n),f;f=await p.next(),a=f.done,!a;m=!0){l=f.value,m=!1;const v=l;d.push(...await Mh(v))}}catch(v){s={error:v}}finally{try{!m&&!a&&(i=p.return)&&await i.call(p)}finally{if(s)throw s.error}}else{const v=(c=n==null?void 0:n.constructor)===null||c===void 0?void 0:c.name;throw new Error(`Unexpected data type: ${typeof n}${v?`; constructor: ${v}`:""}${pE(n)}`)}return d}function pE(n){return typeof n!="object"||n===null?"":`; props: [${Object.getOwnPropertyNames(n).map(s=>`"${s}"`).join(", ")}]`}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Wb{constructor(a){this._client=a}}Wb._key=[];/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function e0(n){return n.replace(/[^A-Za-z0-9\-._~!$&'()*+,;=:@]+/g,encodeURIComponent)}const Vv=Object.freeze(Object.create(null)),gE=(n=e0)=>(function(s,...i){if(s.length===1)return s[0];let l=!1;const c=[],d=s.reduce((v,_,T)=>{var x,k,w;/[?#]/.test(_)&&(l=!0);const S=i[T];let C=(l?encodeURIComponent:n)(""+S);return T!==i.length&&(S==null||typeof S=="object"&&S.toString===((w=Object.getPrototypeOf((k=Object.getPrototypeOf((x=S.hasOwnProperty)!==null&&x!==void 0?x:Vv))!==null&&k!==void 0?k:Vv))===null||w===void 0?void 0:w.toString))&&(C=S+"",c.push({start:v.length+_.length,length:C.length,error:`Value of type ${Object.prototype.toString.call(S).slice(8,-1)} is not a valid path parameter`})),v+_+(T===i.length?"":C)},""),m=d.split(/[?#]/,1)[0],p=new RegExp("(?<=^|\\/)(?:\\.|%2e){1,2}(?=\\/|$)","gi");let f;for(;(f=p.exec(m))!==null;)c.push({start:f.index,length:f[0].length,error:`Value "${f[0]}" can't be safely passed as a path parameter`});if(c.sort((v,_)=>v.start-_.start),c.length>0){let v=0;const _=c.reduce((T,x)=>{const k=" ".repeat(x.start-v),w="^".repeat(x.length);return v=x.start+x.length,T+k+w},"");throw new Kr(`Path parameters result in path with invalid segments:
${c.map(T=>T.error).join(`
`)}
${d}
${_}`)}return d}),Xc=gE(e0);/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class t0 extends Wb{create(a,s){var i;const{api_version:l=this._client.apiVersion}=a,c=Su(a,["api_version"]);if("model"in c&&"agent_config"in c)throw new Kr("Invalid request: specified `model` and `agent_config`. If specifying `model`, use `generation_config`.");if("agent"in c&&"generation_config"in c)throw new Kr("Invalid request: specified `agent` and `generation_config`. If specifying `agent`, use `agent_config`.");return this._client.post(Xc`/${l}/interactions`,Object.assign(Object.assign({body:c},s),{stream:(i=a.stream)!==null&&i!==void 0?i:!1}))}delete(a,s={},i){const{api_version:l=this._client.apiVersion}=s??{};return this._client.delete(Xc`/${l}/interactions/${a}`,i)}cancel(a,s={},i){const{api_version:l=this._client.apiVersion}=s??{};return this._client.post(Xc`/${l}/interactions/${a}/cancel`,i)}get(a,s={},i){var l;const c=s??{},{api_version:d=this._client.apiVersion}=c,m=Su(c,["api_version"]);return this._client.get(Xc`/${d}/interactions/${a}`,Object.assign(Object.assign({query:m},i),{stream:(l=s==null?void 0:s.stream)!==null&&l!==void 0?l:!1}))}}t0._key=Object.freeze(["interactions"]);class n0 extends t0{}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function yE(n){let a=0;for(const l of n)a+=l.length;const s=new Uint8Array(a);let i=0;for(const l of n)s.set(l,i),i+=l.length;return s}let Wc;function Vh(n){let a;return(Wc??(a=new globalThis.TextEncoder,Wc=a.encode.bind(a)))(n)}let eu;function Kv(n){let a;return(eu??(a=new globalThis.TextDecoder,eu=a.decode.bind(a)))(n)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Cu{constructor(){this.buffer=new Uint8Array,this.carriageReturnIndex=null}decode(a){if(a==null)return[];const s=a instanceof ArrayBuffer?new Uint8Array(a):typeof a=="string"?Vh(a):a;this.buffer=yE([this.buffer,s]);const i=[];let l;for(;(l=vE(this.buffer,this.carriageReturnIndex))!=null;){if(l.carriage&&this.carriageReturnIndex==null){this.carriageReturnIndex=l.index;continue}if(this.carriageReturnIndex!=null&&(l.index!==this.carriageReturnIndex+1||l.carriage)){i.push(Kv(this.buffer.subarray(0,this.carriageReturnIndex-1))),this.buffer=this.buffer.subarray(this.carriageReturnIndex),this.carriageReturnIndex=null;continue}const c=this.carriageReturnIndex!==null?l.preceding-1:l.preceding,d=Kv(this.buffer.subarray(0,c));i.push(d),this.buffer=this.buffer.subarray(l.index),this.carriageReturnIndex=null}return i}flush(){return this.buffer.length?this.decode(`
`):[]}}Cu.NEWLINE_CHARS=new Set([`
`,"\r"]);Cu.NEWLINE_REGEXP=/\r\n|[\n\r]/g;function vE(n,a){for(let l=a??0;l<n.length;l++){if(n[l]===10)return{preceding:l,index:l+1,carriage:!1};if(n[l]===13)return{preceding:l,index:l+1,carriage:!0}}return null}function bE(n){for(let i=0;i<n.length-1;i++){if(n[i]===10&&n[i+1]===10||n[i]===13&&n[i+1]===13)return i+2;if(n[i]===13&&n[i+1]===10&&i+3<n.length&&n[i+2]===13&&n[i+3]===10)return i+4}return-1}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const wu={off:0,error:200,warn:300,info:400,debug:500},Zv=(n,a,s)=>{if(n){if(Xw(wu,n))return n;ar(s).warn(`${a} was set to ${JSON.stringify(n)}, expected one of ${JSON.stringify(Object.keys(wu))}`)}};function ml(){}function tu(n,a,s){return!a||wu[n]>wu[s]?ml:a[n].bind(a)}const xE={error:ml,warn:ml,info:ml,debug:ml};let Qv=new WeakMap;function ar(n){var a;const s=n.logger,i=(a=n.logLevel)!==null&&a!==void 0?a:"off";if(!s)return xE;const l=Qv.get(s);if(l&&l[0]===i)return l[1];const c={error:tu("error",s,i),warn:tu("warn",s,i),info:tu("info",s,i),debug:tu("debug",s,i)};return Qv.set(s,[i,c]),c}const ai=n=>(n.options&&(n.options=Object.assign({},n.options),delete n.options.headers),n.headers&&(n.headers=Object.fromEntries((n.headers instanceof Headers?[...n.headers]:Object.entries(n.headers)).map(([a,s])=>[a,a.toLowerCase()==="x-goog-api-key"||a.toLowerCase()==="authorization"||a.toLowerCase()==="cookie"||a.toLowerCase()==="set-cookie"?"***":s]))),"retryOfRequestLogID"in n&&(n.retryOfRequestLogID&&(n.retryOf=n.retryOfRequestLogID),delete n.retryOfRequestLogID),n);/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class no{constructor(a,s,i){this.iterator=a,this.controller=s,this.client=i}static fromSSEResponse(a,s,i){let l=!1;const c=i?ar(i):console;function d(){return yl(this,arguments,function*(){var p,f,v,_;if(l)throw new Kr("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");l=!0;let T=!1;try{try{for(var x=!0,k=ao(_E(a,s)),w;w=yield gn(k.next()),p=w.done,!p;x=!0){_=w.value,x=!1;const S=_;if(!T)if(S.data.startsWith("[DONE]")){T=!0;continue}else try{yield yield gn(JSON.parse(S.data))}catch(C){throw c.error("Could not parse message into JSON:",S.data),c.error("From chunk:",S.raw),C}}}catch(S){f={error:S}}finally{try{!x&&!p&&(v=k.return)&&(yield gn(v.call(k)))}finally{if(f)throw f.error}}T=!0}catch(S){if(Oh(S))return yield gn(void 0);throw S}finally{T||s.abort()}})}return new no(d,s,i)}static fromReadableStream(a,s,i){let l=!1;function c(){return yl(this,arguments,function*(){var p,f,v,_;const T=new Cu,x=Qb(a);try{for(var k=!0,w=ao(x),S;S=yield gn(w.next()),p=S.done,!p;k=!0){_=S.value,k=!1;const C=_;for(const R of T.decode(C))yield yield gn(R)}}catch(C){f={error:C}}finally{try{!k&&!p&&(v=w.return)&&(yield gn(v.call(w)))}finally{if(f)throw f.error}}for(const C of T.flush())yield yield gn(C)})}function d(){return yl(this,arguments,function*(){var p,f,v,_;if(l)throw new Kr("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");l=!0;let T=!1;try{try{for(var x=!0,k=ao(c()),w;w=yield gn(k.next()),p=w.done,!p;x=!0){_=w.value,x=!1;const S=_;T||S&&(yield yield gn(JSON.parse(S)))}}catch(S){f={error:S}}finally{try{!x&&!p&&(v=k.return)&&(yield gn(v.call(k)))}finally{if(f)throw f.error}}T=!0}catch(S){if(Oh(S))return yield gn(void 0);throw S}finally{T||s.abort()}})}return new no(d,s,i)}[Symbol.asyncIterator](){return this.iterator()}tee(){const a=[],s=[],i=this.iterator(),l=c=>({next:()=>{if(c.length===0){const d=i.next();a.push(d),s.push(d)}return c.shift()}});return[new no(()=>l(a),this.controller,this.client),new no(()=>l(s),this.controller,this.client)]}toReadableStream(){const a=this;let s;return Zb({async start(){s=a[Symbol.asyncIterator]()},async pull(i){try{const{value:l,done:c}=await s.next();if(c)return i.close();const d=Vh(JSON.stringify(l)+`
`);i.enqueue(d)}catch(l){i.error(l)}},async cancel(){var i;await((i=s.return)===null||i===void 0?void 0:i.call(s))}})}}function _E(n,a){return yl(this,arguments,function*(){var i,l,c,d;if(!n.body)throw a.abort(),typeof globalThis.navigator<"u"&&globalThis.navigator.product==="ReactNative"?new Kr("The default react-native fetch implementation does not support streaming. Please use expo/fetch: https://docs.expo.dev/versions/latest/sdk/expo/#expofetch-api"):new Kr("Attempted to iterate over a response with no body");const m=new wE,p=new Cu,f=Qb(n.body);try{for(var v=!0,_=ao(SE(f)),T;T=yield gn(_.next()),i=T.done,!i;v=!0){d=T.value,v=!1;const x=d;for(const k of p.decode(x)){const w=m.decode(k);w&&(yield yield gn(w))}}}catch(x){l={error:x}}finally{try{!v&&!i&&(c=_.return)&&(yield gn(c.call(_)))}finally{if(l)throw l.error}}for(const x of p.flush()){const k=m.decode(x);k&&(yield yield gn(k))}})}function SE(n){return yl(this,arguments,function*(){var s,i,l,c;let d=new Uint8Array;try{for(var m=!0,p=ao(n),f;f=yield gn(p.next()),s=f.done,!s;m=!0){c=f.value,m=!1;const v=c;if(v==null)continue;const _=v instanceof ArrayBuffer?new Uint8Array(v):typeof v=="string"?Vh(v):v;let T=new Uint8Array(d.length+_.length);T.set(d),T.set(_,d.length),d=T;let x;for(;(x=bE(d))!==-1;)yield yield gn(d.slice(0,x)),d=d.slice(x)}}catch(v){i={error:v}}finally{try{!m&&!s&&(l=p.return)&&(yield gn(l.call(p)))}finally{if(i)throw i.error}}d.length>0&&(yield yield gn(d))})}class wE{constructor(){this.event=null,this.data=[],this.chunks=[]}decode(a){if(a.endsWith("\r")&&(a=a.substring(0,a.length-1)),!a){if(!this.event&&!this.data.length)return null;const c={event:this.event,data:this.data.join(`
`),raw:this.chunks};return this.event=null,this.data=[],this.chunks=[],c}if(this.chunks.push(a),a.startsWith(":"))return null;let[s,i,l]=EE(a,":");return l.startsWith(" ")&&(l=l.substring(1)),s==="event"?this.event=l:s==="data"&&this.data.push(l),null}}function EE(n,a){const s=n.indexOf(a);return s!==-1?[n.substring(0,s),a,n.substring(s+a.length)]:[n,"",""]}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */async function TE(n,a){const{response:s,requestLogID:i,retryOfRequestLogID:l,startTime:c}=a,d=await(async()=>{var m;if(a.options.stream)return ar(n).debug("response",s.status,s.url,s.headers,s.body),a.options.__streamClass?a.options.__streamClass.fromSSEResponse(s,a.controller,n):no.fromSSEResponse(s,a.controller,n);if(s.status===204)return null;if(a.options.__binaryResponse)return s;const p=s.headers.get("content-type"),f=(m=p==null?void 0:p.split(";")[0])===null||m===void 0?void 0:m.trim();return(f==null?void 0:f.includes("application/json"))||(f==null?void 0:f.endsWith("+json"))?await s.json():await s.text()})();return ar(n).debug(`[${i}] response parsed`,ai({retryOfRequestLogID:l,url:s.url,status:s.status,body:d,durationMs:Date.now()-c})),d}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Kh extends Promise{constructor(a,s,i=TE){super(l=>{l(null)}),this.responsePromise=s,this.parseResponse=i,this.client=a}_thenUnwrap(a){return new Kh(this.client,this.responsePromise,async(s,i)=>a(await this.parseResponse(s,i),i))}asResponse(){return this.responsePromise.then(a=>a.response)}async withResponse(){const[a,s]=await Promise.all([this.parse(),this.asResponse()]);return{data:a,response:s}}parse(){return this.parsedPromise||(this.parsedPromise=this.responsePromise.then(a=>this.parseResponse(this.client,a))),this.parsedPromise}then(a,s){return this.parse().then(a,s)}catch(a){return this.parse().catch(a)}finally(a){return this.parse().finally(a)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const r0=Symbol("brand.privateNullableHeaders");function*AE(n){if(!n)return;if(r0 in n){const{values:i,nulls:l}=n;yield*i.entries();for(const c of l)yield[c,null];return}let a=!1,s;n instanceof Headers?s=n.entries():Pv(n)?s=n:(a=!0,s=Object.entries(n??{}));for(let i of s){const l=i[0];if(typeof l!="string")throw new TypeError("expected header name to be a string");const c=Pv(i[1])?i[1]:[i[1]];let d=!1;for(const m of c)m!==void 0&&(a&&!d&&(d=!0,yield[l,null]),yield[l,m])}}const il=n=>{const a=new Headers,s=new Set;for(const i of n){const l=new Set;for(const[c,d]of AE(i)){const m=c.toLowerCase();l.has(m)||(a.delete(c),l.add(m)),d===null?(a.delete(c),s.add(m)):(a.append(c,d),s.delete(m))}}return{[r0]:!0,values:a,nulls:s}};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const sh=n=>{var a,s,i,l,c,d;if(typeof globalThis.process<"u")return(i=(s=(a=$w)===null||a===void 0?void 0:a[n])===null||s===void 0?void 0:s.trim())!==null&&i!==void 0?i:void 0;if(typeof globalThis.Deno<"u")return(d=(c=(l=globalThis.Deno.env)===null||l===void 0?void 0:l.get)===null||c===void 0?void 0:c.call(l,n))===null||d===void 0?void 0:d.trim()};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var a0;class Nu{constructor(a){var s,i,l,c,d,m,p,{baseURL:f=sh("GEMINI_NEXT_GEN_API_BASE_URL"),apiKey:v=(s=sh("GEMINI_API_KEY"))!==null&&s!==void 0?s:null,apiVersion:_="v1beta"}=a,T=Su(a,["baseURL","apiKey","apiVersion"]);const x=Object.assign(Object.assign({apiKey:v,apiVersion:_},T),{baseURL:f||"https://generativelanguage.googleapis.com"});this.baseURL=x.baseURL,this.timeout=(i=x.timeout)!==null&&i!==void 0?i:Nu.DEFAULT_TIMEOUT,this.logger=(l=x.logger)!==null&&l!==void 0?l:console;const k="warn";this.logLevel=k,this.logLevel=(d=(c=Zv(x.logLevel,"ClientOptions.logLevel",this))!==null&&c!==void 0?c:Zv(sh("GEMINI_NEXT_GEN_API_LOG"),"process.env['GEMINI_NEXT_GEN_API_LOG']",this))!==null&&d!==void 0?d:k,this.fetchOptions=x.fetchOptions,this.maxRetries=(m=x.maxRetries)!==null&&m!==void 0?m:2,this.fetch=(p=x.fetch)!==null&&p!==void 0?p:iE(),this.encoder=cE,this._options=x,this.apiKey=v,this.apiVersion=_,this.clientAdapter=x.clientAdapter}withOptions(a){return new this.constructor(Object.assign(Object.assign(Object.assign({},this._options),{baseURL:this.baseURL,maxRetries:this.maxRetries,timeout:this.timeout,logger:this.logger,logLevel:this.logLevel,fetch:this.fetch,fetchOptions:this.fetchOptions,apiKey:this.apiKey,apiVersion:this.apiVersion}),a))}baseURLOverridden(){return this.baseURL!=="https://generativelanguage.googleapis.com"}defaultQuery(){return this._options.defaultQuery}validateHeaders({values:a,nulls:s}){if(!(a.has("authorization")||a.has("x-goog-api-key"))&&!(this.apiKey&&a.get("x-goog-api-key"))&&!s.has("x-goog-api-key"))throw new Error('Could not resolve authentication method. Expected the apiKey to be set. Or for the "x-goog-api-key" headers to be explicitly omitted')}async authHeaders(a){const s=il([a.headers]);if(!(s.values.has("authorization")||s.values.has("x-goog-api-key"))){if(this.apiKey)return il([{"x-goog-api-key":this.apiKey}]);if(this.clientAdapter.isVertexAI())return il([await this.clientAdapter.getAuthHeaders()])}}stringifyQuery(a){return Object.entries(a).filter(([s,i])=>typeof i<"u").map(([s,i])=>{if(typeof i=="string"||typeof i=="number"||typeof i=="boolean")return`${encodeURIComponent(s)}=${encodeURIComponent(i)}`;if(i===null)return`${encodeURIComponent(s)}=`;throw new Kr(`Cannot stringify type ${typeof i}; Expected string, number, boolean, or null. If you need to pass nested query parameters, you can manually encode them, e.g. { query: { 'foo[key1]': value1, 'foo[key2]': value2 } }, and please open a GitHub issue requesting better support for your use case.`)}).join("&")}getUserAgent(){return`${this.constructor.name}/JS ${Xi}`}defaultIdempotencyKey(){return`stainless-node-retry-${Yw()}`}makeStatusError(a,s,i,l){return or.generate(a,s,i,l)}buildURL(a,s,i){const l=!this.baseURLOverridden()&&i||this.baseURL,c=Kw(a)?new URL(a):new URL(l+(l.endsWith("/")&&a.startsWith("/")?a.slice(1):a)),d=this.defaultQuery();return Jw(d)||(s=Object.assign(Object.assign({},d),s)),typeof s=="object"&&s&&!Array.isArray(s)&&(c.search=this.stringifyQuery(s)),c.toString()}async prepareOptions(a){if(this.clientAdapter&&this.clientAdapter.isVertexAI()&&!a.path.startsWith(`/${this.apiVersion}/projects/`)){const s=a.path.slice(this.apiVersion.length+1);a.path=`/${this.apiVersion}/projects/${this.clientAdapter.getProject()}/locations/${this.clientAdapter.getLocation()}${s}`}}async prepareRequest(a,{url:s,options:i}){}get(a,s){return this.methodRequest("get",a,s)}post(a,s){return this.methodRequest("post",a,s)}patch(a,s){return this.methodRequest("patch",a,s)}put(a,s){return this.methodRequest("put",a,s)}delete(a,s){return this.methodRequest("delete",a,s)}methodRequest(a,s,i){return this.request(Promise.resolve(i).then(l=>Object.assign({method:a,path:s},l)))}request(a,s=null){return new Kh(this,this.makeRequest(a,s,void 0))}async makeRequest(a,s,i){var l,c,d;const m=await a,p=(l=m.maxRetries)!==null&&l!==void 0?l:this.maxRetries;s==null&&(s=p),await this.prepareOptions(m);const{req:f,url:v,timeout:_}=await this.buildRequest(m,{retryCount:p-s});await this.prepareRequest(f,{url:v,options:m});const T="log_"+(Math.random()*(1<<24)|0).toString(16).padStart(6,"0"),x=i===void 0?"":`, retryOf: ${i}`,k=Date.now();if(ar(this).debug(`[${T}] sending request`,ai({retryOfRequestLogID:i,method:m.method,url:v,options:m,headers:f.headers})),!((c=m.signal)===null||c===void 0)&&c.aborted)throw new Ih;const w=new AbortController,S=await this.fetchWithTimeout(v,f,_,w).catch(jh),C=Date.now();if(S instanceof globalThis.Error){const L=`retrying, ${s} attempts remaining`;if(!((d=m.signal)===null||d===void 0)&&d.aborted)throw new Ih;const F=Oh(S)||/timed? ?out/i.test(String(S)+("cause"in S?String(S.cause):""));if(s)return ar(this).info(`[${T}] connection ${F?"timed out":"failed"} - ${L}`),ar(this).debug(`[${T}] connection ${F?"timed out":"failed"} (${L})`,ai({retryOfRequestLogID:i,url:v,durationMs:C-k,message:S.message})),this.retryRequest(m,s,i??T);throw ar(this).info(`[${T}] connection ${F?"timed out":"failed"} - error; no more retries left`),ar(this).debug(`[${T}] connection ${F?"timed out":"failed"} (error; no more retries left)`,ai({retryOfRequestLogID:i,url:v,durationMs:C-k,message:S.message})),F?new Bb:new ku({cause:S})}const R=`[${T}${x}] ${f.method} ${v} ${S.ok?"succeeded":"failed"} with status ${S.status} in ${C-k}ms`;if(!S.ok){const L=await this.shouldRetry(S);if(s&&L){const O=`retrying, ${s} attempts remaining`;return await lE(S.body),ar(this).info(`${R} - ${O}`),ar(this).debug(`[${T}] response error (${O})`,ai({retryOfRequestLogID:i,url:S.url,status:S.status,headers:S.headers,durationMs:C-k})),this.retryRequest(m,s,i??T,S.headers)}const F=L?"error; no more retries left":"error; not retryable";ar(this).info(`${R} - ${F}`);const G=await S.text().catch(O=>jh(O).message),Q=eE(G),U=Q?void 0:G;throw ar(this).debug(`[${T}] response error (${F})`,ai({retryOfRequestLogID:i,url:S.url,status:S.status,headers:S.headers,message:U,durationMs:Date.now()-k})),this.makeStatusError(S.status,Q,U,S.headers)}return ar(this).info(R),ar(this).debug(`[${T}] response start`,ai({retryOfRequestLogID:i,url:S.url,status:S.status,headers:S.headers,durationMs:C-k})),{response:S,options:m,controller:w,requestLogID:T,retryOfRequestLogID:i,startTime:k}}async fetchWithTimeout(a,s,i,l){const c=s||{},{signal:d,method:m}=c,p=Su(c,["signal","method"]);d&&d.addEventListener("abort",()=>l.abort());const f=setTimeout(()=>l.abort(),i),v=globalThis.ReadableStream&&p.body instanceof globalThis.ReadableStream||typeof p.body=="object"&&p.body!==null&&Symbol.asyncIterator in p.body,_=Object.assign(Object.assign(Object.assign({signal:l.signal},v?{duplex:"half"}:{}),{method:"GET"}),p);m&&(_.method=m.toUpperCase());try{return await this.fetch.call(void 0,a,_)}finally{clearTimeout(f)}}async shouldRetry(a){const s=a.headers.get("x-should-retry");return s==="true"?!0:s==="false"?!1:a.status===408||a.status===409||a.status===429||a.status>=500}async retryRequest(a,s,i,l){var c;let d;const m=l==null?void 0:l.get("retry-after-ms");if(m){const f=parseFloat(m);Number.isNaN(f)||(d=f)}const p=l==null?void 0:l.get("retry-after");if(p&&!d){const f=parseFloat(p);Number.isNaN(f)?d=Date.parse(p)-Date.now():d=f*1e3}if(!(d&&0<=d&&d<60*1e3)){const f=(c=a.maxRetries)!==null&&c!==void 0?c:this.maxRetries;d=this.calculateDefaultRetryTimeoutMillis(s,f)}return await tE(d),this.makeRequest(a,s-1,i)}calculateDefaultRetryTimeoutMillis(a,s){const c=s-a,d=Math.min(.5*Math.pow(2,c),8),m=1-Math.random()*.25;return d*m*1e3}async buildRequest(a,{retryCount:s=0}={}){var i,l,c;const d=Object.assign({},a),{method:m,path:p,query:f,defaultBaseURL:v}=d,_=this.buildURL(p,f,v);"timeout"in d&&Ww("timeout",d.timeout),d.timeout=(i=d.timeout)!==null&&i!==void 0?i:this.timeout;const{bodyHeaders:T,body:x}=this.buildBody({options:d}),k=await this.buildHeaders({options:a,method:m,bodyHeaders:T,retryCount:s});return{req:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({method:m,headers:k},d.signal&&{signal:d.signal}),globalThis.ReadableStream&&x instanceof globalThis.ReadableStream&&{duplex:"half"}),x&&{body:x}),(l=this.fetchOptions)!==null&&l!==void 0?l:{}),(c=d.fetchOptions)!==null&&c!==void 0?c:{}),url:_,timeout:d.timeout}}async buildHeaders({options:a,method:s,bodyHeaders:i,retryCount:l}){let c={};this.idempotencyHeader&&s!=="get"&&(a.idempotencyKey||(a.idempotencyKey=this.defaultIdempotencyKey()),c[this.idempotencyHeader]=a.idempotencyKey);const d=await this.authHeaders(a);let m=il([c,Object.assign(Object.assign({Accept:"application/json","User-Agent":this.getUserAgent(),"X-Stainless-Retry-Count":String(l)},a.timeout?{"X-Stainless-Timeout":String(Math.trunc(a.timeout/1e3))}:{}),sE()),this._options.defaultHeaders,i,a.headers,d]);return this.validateHeaders(m),m.values}buildBody({options:{body:a,headers:s}}){if(!a)return{bodyHeaders:void 0,body:void 0};const i=il([s]);return ArrayBuffer.isView(a)||a instanceof ArrayBuffer||a instanceof DataView||typeof a=="string"&&i.values.has("content-type")||globalThis.Blob&&a instanceof globalThis.Blob||a instanceof FormData||a instanceof URLSearchParams||globalThis.ReadableStream&&a instanceof globalThis.ReadableStream?{bodyHeaders:void 0,body:a}:typeof a=="object"&&(Symbol.asyncIterator in a||Symbol.iterator in a&&"next"in a&&typeof a.next=="function")?{bodyHeaders:void 0,body:oE(a)}:this.encoder({body:a,headers:i})}}Nu.DEFAULT_TIMEOUT=6e4;class Vn extends Nu{constructor(){super(...arguments),this.interactions=new n0(this)}}a0=Vn;Vn.GeminiNextGenAPIClient=a0;Vn.GeminiNextGenAPIClientError=Kr;Vn.APIError=or;Vn.APIConnectionError=ku;Vn.APIConnectionTimeoutError=Bb;Vn.APIUserAbortError=Ih;Vn.NotFoundError=Pb;Vn.ConflictError=$b;Vn.RateLimitError=Vb;Vn.BadRequestError=Hb;Vn.AuthenticationError=Gb;Vn.InternalServerError=Kb;Vn.PermissionDeniedError=qb;Vn.UnprocessableEntityError=Yb;Vn.toFile=mE;Vn.Interactions=n0;const Ct=()=>{throw new Error("API Key missing from environment (process.env.API_KEY)")},KT=async()=>{try{return(await Ct().models.generateContent({model:"gemini-3-flash-preview",contents:"ping",config:{maxOutputTokens:5,thinkingConfig:{thinkingBudget:0}}})).text?{status:"ok",message:"Connection established successfully."}:{status:"error",message:"Received empty response from AI."}}catch(n){return console.error("AI Connectivity Test Failed:",n),{status:"error",message:n.message||"Unknown error occurred."}}},an=n=>{if(!n)return null;const a=n.replace(/```json/g,"").replace(/```/g,"").trim();try{return JSON.parse(a)}catch{const i=n.indexOf("{"),l=n.indexOf("[");let c=-1,d="";if(i!==-1&&(l===-1||i<l)?(c=i,d="}"):l!==-1&&(c=l,d="]"),c!==-1){const p=n.lastIndexOf(d);if(p>c){const f=n.substring(c,p+1);try{return JSON.parse(f)}catch(v){console.error("JSON repair extraction failed:",v);const _=new Error("Malformed JSON response from AI.");throw _.jsonString=n,_}}}const m=new Error("No JSON structure found in AI response.");throw m.jsonString=n,m}},ZT=async(n,a)=>{const s=Ct(),i=`
        Analyze the following educational content and suggest a high-quality name and a detailed, engaging HTML description.
        
        CONTENT:
        ${n}
        
        TASK:
        1. Suggest a concise, descriptive name (e.g., "Level 1.1: Introduction to X").
        2. Suggest a 2-4 sentence description using HTML tags like <b> and <i> for emphasis. Focus on what the user will learn.
        
        JSON SCHEMA:
        {
            "name": "string",
            "description": "string (HTML)"
        }
        
        ONLY return raw JSON.
    `,l=await s.models.generateContent({model:"gemini-3-flash-preview",contents:i,config:{responseMimeType:"application/json"}});return an(l.text||"{}")},kE=async(n,a)=>{const s=Ct(),i=`
        You are a world-class instructional designer. Create a detailed curriculum for a deep-dive Hyper-Course on: "${n.topic}".
        Target Level: ${n.understanding}
        Persona: ${a.instruction}
        Target length: Approximately ${n.chapterCount||12} chapters.
        
        TASK:
        1. Generate a professional name and a 3-5 sentence HTML summary.
        2. Design a sequence of ${n.chapterCount||12} chapters (InfoCards).
        3. For each chapter, provide a unique 'id' (e.g., 'chap-intro'), a title, and a detailed bulleted list of sub-topics.
        4. Define prerequisites using 'prerequisiteChapterIds'.
        5. CRITICAL: Generate a "sharedDictionary" of 10-20 core technical terms and their canonical definitions for this course. This serves as a "Terminology Lock" to ensure consistency across chapters.
        
        JSON SCHEMA:
        {
            "name": "Course Title",
            "description": "Full course summary (HTML)",
            "sharedDictionary": { "TermA": "Definition A", "TermB": "Definition B" },
            "chapters": [
                {
                    "id": "chap-1",
                    "title": "Chapter Title",
                    "learningObjectives": ["Obj 1", "Obj 2"],
                    "topics": ["Topic A", "Topic B"],
                    "prerequisiteChapterIds": []
                }
            ]
        }
    `,l=await s.models.generateContent({model:"gemini-3-flash-preview",contents:i,config:{responseMimeType:"application/json"}});return an(l.text||"{}")},CE=async(n,a,s)=>{const i=Ct(),l=`
        You are an Educational Archivist. Review the following summaries of chapters already completed in a course on "${n}".
        
        SHARED TERMINOLOGY LOCK:
        ${JSON.stringify(s)}
        
        CHAPTER SUMMARIES:
        ${a.join(`

`)}
        
        TASK:
        Generate a concise "Logical State Vector". This is a dense summary of:
        1. Core concepts already defined.
        2. Prerequisites established.
        3. Specific narrative threads or case studies introduced.
        
        This vector will be fed into the next chapter's generation agent to prevent redundant introductions and ensure narrative flow.
        
        OUTPUT: Return only the plain text summary (max 500 words).
    `;return(await i.models.generateContent({model:"gemini-3-flash-preview",contents:l})).text||""};async function*NE(n,a,s,i,l,c,d,m){const p=Ct(),f=`
        Act as an expert subject matter expert and the following persona: ${l.name}.
        Persona Instructions: ${l.instruction}
        
        COURSE TOPIC: "${n}"
        CHAPTER ${i+1}/${s}: "${a.title}"
        LEARNING OBJECTIVES: ${a.learningObjectives.join(", ")}
        TOPICS TO COVER: ${a.topics.join(", ")}
        
        TERMINOLOGY LOCK (You MUST adhere to these definitions):
        ${JSON.stringify(d)}
        
        COURSE PROGRESS STATE (What has already been covered):
        ${m}
        
        TASK:
        Generate the full, detailed text for this chapter. 
        Target word count: ${c} words.
        
        REQUIREMENTS:
        1. Use aggressive HTML formatting (h2, h3 headers, bolding for key terms, blockquotes for important quotes/principles).
        2. The text MUST be dense, informative, and flow like a high-quality textbook. 
        3. Include historical context, theoretical foundations, and practical edge-cases.
        
        OUTPUT FORMAT: Return raw HTML content. Do NOT wrap in JSON for this stream.
    `,v=await p.models.generateContentStream({model:"gemini-3-pro-preview",contents:f,config:{thinkingConfig:{thinkingBudget:32768}}});for await(const _ of v)_.text&&(yield _.text)}const DE=async(n,a,s,i,l,c,d,m)=>{const p=Ct(),f=`
        Act as an expert subject matter expert and the following persona: ${l.name}.
        Persona Instructions: ${l.instruction}
        
        COURSE TOPIC: "${n}"
        CHAPTER ${i+1}/${s}: "${a.title}"
        LEARNING OBJECTIVES: ${a.learningObjectives.join(", ")}
        TOPICS TO COVER: ${a.topics.join(", ")}
        
        TERMINOLOGY LOCK (You MUST adhere to these definitions):
        ${JSON.stringify(d)}
        
        COURSE PROGRESS STATE (What has already been covered):
        ${m}
        
        TASK:
        Generate the full, detailed text for this chapter. 
        Target word count: ${c} words.
        
        REQUIREMENTS:
        1. Use aggressive HTML formatting (h2, h3 headers, bolding for key terms, blockquotes for important quotes/principles).
        2. The text MUST be dense, informative, and flow like a high-quality textbook. 
        3. Do not re-introduce concepts summarized in the COURSE PROGRESS STATE unless deepening the explanation.
        4. Include historical context, theoretical foundations, practical edge-cases, and deep-dive technical nuances.
        
        OUTPUT: Return only the HTML content string inside a JSON object.
        {
            "content": "Full HTML Content Here...",
            "summaryForArchivist": "A 1-paragraph summary of what was covered for the next chapter's state vector."
        }
    `,v=await p.models.generateContent({model:"gemini-3-pro-preview",contents:f,config:{responseMimeType:"application/json",thinkingConfig:{thinkingBudget:32768}}});return an(v.text||"{}")},OE=async(n,a,s)=>{const i=Ct(),l=`
        You are a Fact-Checker (Agent B). Analyze this chapter about "${a}" in a course on "${n}".
        
        CONTENT:
        ${s}
        
        TASK:
        1. Use Google Search to verify every technical, historical, and scientific claim.
        2. Identify any inaccuracies, oversimplifications, or hallucinations.
        3. Provide a detailed list of required corrections with citations if possible.
        
        JSON SCHEMA:
        {
            "isAccurate": boolean,
            "corrections": [
                { "originalClaim": "...", "correction": "...", "source": "..." }
            ],
            "overallQualityScore": number (1-10)
        }
    `,c=await i.models.generateContent({model:"gemini-3-pro-preview",contents:l,config:{tools:[{googleSearch:{}}],responseMimeType:"application/json"}});return an(c.text||"{}")},jE=async(n,a,s)=>{const i=Ct(),l=`
        Refine the following educational content about "${n}" by applying the verified corrections provided.
        
        ORIGINAL CONTENT:
        ${a}
        
        CORRECTIONS TO APPLY:
        ${JSON.stringify(s)}
        
        TASK:
        Rewrite the content to be 100% factually accurate while maintaining the original tone and formatting.
        
        JSON SCHEMA:
        {
            "refinedContent": "Full HTML..."
        }
    `,c=await i.models.generateContent({model:"gemini-3-pro-preview",contents:l,config:{responseMimeType:"application/json",thinkingConfig:{thinkingBudget:16384}}});return an(c.text||"{}")},IE=async(n,a)=>{const s=Ct(),i=`
        Based on the following educational content about "${n}", identify ONE complex process, structure, or system that needs a visual aid.
        
        CONTENT:
        ${a}
        
        TASK:
        1. Design a factual, clean, and pedagogical SVG diagram (e.g., a process flow, a structural diagram, or a timeline).
        2. The diagram MUST be factually accurate and use standard conventions.
        3. **CRITICAL (Animated Kinetics)**: Include CSS <style> block inside the SVG using @keyframes to animate motion (e.g., arrows moving along a path, pulse effects on key nodes, spinning orbits). The animations should be slow and educational.
        4. **CRITICAL (Explorable Visuals)**: Assign unique, descriptive \`id\` attributes to every major component, group (\`<g>\`), or node in the SVG (e.g., \`id="vascular-bundle"\`, \`id="electron-transport-chain"\`).
        5. Use professional, modern design with clear labels. 
        6. Return the SVG code embedded in a JSON object.
        
        JSON SCHEMA:
        {
            "hasDiagram": boolean,
            "svgCode": "<svg ...>...</svg>",
            "caption": "Factual description of the diagram"
        }
    `,l=await s.models.generateContent({model:"gemini-3-pro-preview",contents:i,config:{responseMimeType:"application/json",thinkingConfig:{thinkingBudget:32768}}});return an(l.text||"{}")},RE=async(n,a)=>{var v,_,T,x;const s=Ct(),i=await s.models.generateContent({model:"gemini-3-flash-preview",contents:`Analyze this educational text about "${n}". Identify ONE highly complex dynamic transformation or microscopic process that is difficult to visualize with a static image but would be perfect for a 5-second educational video loop.
        
        TEXT:
        ${a}
        
        If found, provide a detailed, cinematic video prompt for Veo 3.1.
        
        JSON SCHEMA:
        {
            "isHighComplexity": boolean,
            "videoPrompt": "Cinematic 3D render of [process]...",
            "educationalReasoning": "How this video helps the learner..."
        }`,config:{responseMimeType:"application/json"}}),l=an(i.text);if(!(l!=null&&l.isHighComplexity)||!l.videoPrompt)return null;let c=await s.models.generateVideos({model:"veo-3.1-fast-generate-preview",prompt:`Educational scientific animation: ${l.videoPrompt}. High fidelity, 4K render style, slow motion, detailed textures, clear visualization.`,config:{numberOfVideos:1,resolution:"720p",aspectRatio:"16:9"}});for(;!c.done;)await new Promise(k=>setTimeout(k,1e4)),c=await s.operations.getVideosOperation({operation:c});const d=(x=(T=(_=(v=c.response)==null?void 0:v.generatedVideos)==null?void 0:_[0])==null?void 0:T.video)==null?void 0:x.uri,f=await(await fetch(`${d}&key=${typeof process<"u"?void 0:""}`)).blob();return new Promise((k,w)=>{const S=new FileReader;S.onloadend=()=>k({dataUrl:S.result,caption:l.educationalReasoning}),S.onerror=w,S.readAsDataURL(f)})},ME=async(n,a,s,i)=>{const l=Ct(),c=s.map((p,f)=>`Chapter ${f+1}: ${p.content.substring(0,300)}...`).join(`

`),d=`
        You are a Master Epistemic Auditor. Review the following synthesized course on "${n}".
        
        COURSE NAME: "${a}"
        TERMINOLOGY LOCK: ${JSON.stringify(i)}
        
        CHAPTER SUMMARIES:
        ${c}
        
        TASK:
        1. Ensure consistent use of Technical Terminology throughout all chapters.
        2. Identify any logical contradictions between Chapter 1 and subsequent chapters.
        3. Check for thematic cohesion and narrative flow.
        4. If issues are found, provide a list of refinement suggestions for specific chapters.
        
        JSON SCHEMA:
        {
            "isConsistent": boolean,
            "suggestions": [
                { "chapterId": "string", "issue": "string", "fix": "string" }
            ],
            "finalSummary": "Final verdict on course quality."
        }
    `,m=await l.models.generateContent({model:"gemini-3-pro-preview",contents:d,config:{responseMimeType:"application/json",thinkingConfig:{thinkingBudget:16384}}});return an(m.text||"{}")},UE=async(n,a,s)=>{const i=Ct(),l=`
        Refine the following educational text about "${n}" based on a Global Consistency Audit suggestion.
        
        ORIGINAL TEXT:
        ${a}
        
        AUDIT ISSUE: ${s.issue}
        REQUIRED FIX: ${s.fix}
        
        TASK:
        Rewrite the text to resolve the issue while maintaining style, formatting, and all pedagogical elements (diagrams, etc).
        
        JSON SCHEMA:
        {
            "refinedContent": "Full HTML..."
        }
    `,c=await i.models.generateContent({model:"gemini-3-pro-preview",contents:l,config:{responseMimeType:"application/json",thinkingConfig:{thinkingBudget:16384}}});return an(c.text||"{}")},LE=async(n,a)=>{const s=Ct(),i=`
        Based on the following educational text about "${n}", identify a key historical figure, artifact, scientific entity, or landscape that would benefit from a high-fidelity photographic or realistic illustration.
        
        TEXT:
        ${a}
        
        TASK:
        1. Use Google Search to research the AUTHENTIC visual appearance of this entity (e.g., correct clothing for the period, correct biological colors, specific geological features).
        2. Generate a high-fidelity, realistic image of this entity. 
        3. The image MUST be scientifically or historically accurate based on your search findings.
        4. Provide a text explanation of the factual details included.
    `,l=await s.models.generateContent({model:"gemini-3-pro-image-preview",contents:i,config:{tools:[{googleSearch:{}}],imageConfig:{aspectRatio:"16:9",imageSize:"1K"}}});let c=null,d="";for(const m of l.candidates[0].content.parts)m.inlineData?c=`data:image/png;base64,${m.inlineData.data}`:m.text&&(d=m.text);return{imageUrl:c,description:d}},zE=async(n,a,s)=>{const i=Ct(),l=`
        You are a pedagogical auditor. Analyze the following chapter from a course on "${n}".
        CHAPTER TITLE: "${a}"
        CONTENT: 
        ${s}
        
        TASK 1: GENERATE QUESTIONS
        Generate 3-5 challenging, high-quality multiple-choice questions that specifically test the deep nuances presented in the text.
        CRITICAL: Classify each question using Bloom's Taxonomy: 'Recall', 'Comprehension', 'Application', 'Analysis', 'Synthesis', or 'Evaluation'. Ensure a mix of levels.
        
        TASK 2: QUALITY AUDIT
        Refine the provided HTML content to ensure maximum pedagogical clarity. Ensure key terms are consistently bolded and headers are logically nested.
        
        JSON SCHEMA:
        {
            "refinedContent": "...",
            "questions": [
                {
                    "questionText": "...",
                    "bloomsLevel": "Recall | Comprehension | Application | Analysis | Synthesis | Evaluation",
                    "options": [{ "id": "o1", "text": "...", "explanation": "..." }],
                    "correctAnswerId": "o1",
                    "detailedExplanation": "Thorough explanation citing the chapter's specific details."
                }
            ]
        }
    `,c=await i.models.generateContent({model:"gemini-3-pro-preview",contents:l,config:{responseMimeType:"application/json",thinkingConfig:{thinkingBudget:16384}}});return an(c.text||"{}")},FE=async(n,a,s)=>{const i=Ct(),l=`Generate a learning outline for ${n.topic} at ${n.understanding} level. ${n.generationType.includes("learning")?`Requested comprehensiveness: ${n.comprehensiveness}.`:""} ${n.generationType==="rework-deck"?`USER REWORK INSTRUCTIONS: ${n.reworkInstructions}`:""}`;return{outline:(await i.models.generateContent({model:"gemini-3-flash-preview",contents:l})).text||"",metadata:{name:n.topic}}},BE=async(n,a,s)=>(await Ct().models.generateContent({model:"gemini-3-flash-preview",contents:"Refine this outline based on feedback."})).text||"",HE=async(n,a)=>{const i=await Ct().models.generateContent({model:"gemini-3-pro-preview",contents:`Generate questions based on this outline: ${n}`,config:{responseMimeType:"application/json"}});return an(i.text||"{}")},GE=async(n,a)=>{const i=await Ct().models.generateContent({model:"gemini-3-flash-preview",contents:`Generate a series scaffold from this outline: ${n}`,config:{responseMimeType:"application/json"}});return an(i.text||"{}")},qE=async(n,a)=>{const s=Ct(),i=`
        Create a high-quality flashcard deck for the topic: "${n.topic}".
        Persona: ${a.instruction}
        Target Level: ${n.understanding}
        
        TASK:
        1. Generate a compelling name and HTML description for the deck.
        2. Generate ${n.count||15} cards.
        
        JSON SCHEMA:
        {
            "name": "...",
            "description": "...",
            "cards": [{ "front": "...", "back": "..." }]
        }
        
        ONLY return raw JSON.
    `,l=await s.models.generateContent({model:"gemini-3-pro-preview",contents:i,config:{responseMimeType:"application/json"}});return an(l.text||"{}")},ih=async(n,a="Standard",s)=>{const i=Ct();let l="Generate 8-12 instructional chapters (InfoCards).",c="Each InfoCard should be detailed and educational.";a==="Exhaustive"?(l="Generate a TRULY EXHAUSTIVE and MASTER-LEVEL curriculum. You MUST provide at least 20 detailed instructional chapters (InfoCards).",c="CRITICAL: Each InfoCard (chapter) MUST be extremely thorough and lengthy. A single chapter should feel like many pages of high-quality textbook material. Use multiple headers (h2, h3), deep-dive into nuances, include historical context, edge cases, and practical examples. Word count for each card should be substantial (500-1000 words)."):a==="Quick Overview"?l="Generate 3-5 concise instructional chapters (InfoCards).":a==="Comprehensive"&&(l="Generate 15-20 detailed instructional chapters (InfoCards).",c="Each InfoCard should be a substantial read, covering topics in significant depth with rich detail.");const d=`
        Act as a world-class subject matter expert and instructional designer. Create a ${s?"deep-dive structured course":"comprehensive learning guide"} for the topic: "${n}".
        
        ${l}
        ${c}
        
        REQUIREMENTS:
        1. Each InfoCard MUST use rich HTML formatting (h2, h3 headers, bolding, lists, blockquotes).
        2. For EACH InfoCard, generate 1 to 4 multiple-choice questions that specifically test the nuanced content introduced in that card.
        3. Ensure a logical progression from foundational concepts to advanced applications.
        4. Every question must have high-quality, pedagogical explanations for every option.
        5. Generate a professional name for this course and a detailed HTML description summarizing the learning objectives.
        
        JSON SCHEMA:
        {
            "name": "The Course Title",
            "description": "HTML summary of the course...",
            "infoCards": [
                {
                    "id": "chap-1",
                    "content": "EXTENSIVE HTML instructional text (textbook chapter style)...",
                    "unlocksQuestionIds": ["q-1", "q-2"]
                }
            ],
            "questions": [
                {
                    "id": "q-1",
                    "questionText": "...",
                    "options": [{ "id": "o1", "text": "...", "explanation": "..." }],
                    "correctAnswerId": "o1",
                    "detailedExplanation": "..."
                }
            ]
        }
        
        ONLY return raw JSON.
    `,m=await i.models.generateContent({model:"gemini-3-pro-preview",contents:d,config:{thinkingConfig:{thinkingBudget:32768}}});return an(m.text||"{}")},PE=async(n,a,s,i)=>{const l=Ct(),c=`
        Act as a world-class instructional designer and the following persona: ${s.name}.
        Persona Instructions: ${s.instruction}

        TASK: Rework and improve the following deck titled "${n.name}".
        
        CURRENT DECK TYPE: ${n.type}
        USER REWORK INSTRUCTIONS: "${a.reworkInstructions}"
        COMPREHENSIVENESS: ${a.comprehensiveness}
        TARGET AUDIENCE LEVEL: ${a.understanding}
        
        ${i?`SERIES CONTEXT: This deck is part of a larger series. Related decks/structure:
${i}
`:""}
        
        CRITICAL INSTRUCTIONS:
        1. Fully regenerate the deck content (infoCards, questions, or cards) improving quality according to the instructions and persona.
        2. If the user asks to "expand", significantly increase the depth. InfoCards should become extensive textbook-style chapters (multi-page equivalent).
        3. Maintain original IDs where possible, but feel free to add/remove items to match the requested depth.
        4. Generate a new, improved name and description based on the reworked content.
        
        CURRENT CONTENT:
        ${JSON.stringify(n)}

        JSON SCHEMA (MUST MATCH ORIGINAL TYPE ${n.type}):
        {
          "name": "...",
          "description": "...",
          ${n.type===je.Flashcard?'"cards": [{ "front": "...", "back": "..." }]':n.type===je.Quiz?'"questions": [{ "questionText": "...", "options": [...], "correctAnswerId": "...", "detailedExplanation": "..." }]':'"infoCards": [{ "content": "...", "unlocksQuestionIds": ["..."] }], "questions": [{ "id": "...", "questionText": "...", "options": [...], "correctAnswerId": "...", "detailedExplanation": "..." }]'}
        }
        
        ONLY return raw JSON.
    `,d=await l.models.generateContent({model:"gemini-3-pro-preview",contents:c,config:{responseMimeType:"application/json",thinkingConfig:{thinkingBudget:32768}}});return an(d.text||"{}")},$E=async(n,a,s)=>{const l=await Ct().models.generateContent({model:"gemini-3-pro-preview",contents:`Generate ${a} questions for ${n.name}`,config:{responseMimeType:"application/json"}});return an(l.text||"[]")},YE=async n=>{const a=Ct();let s="";n.type===je.Flashcard?s=n.cards.map(c=>`Card Front: ${c.front}`).join(`
`):n.type===je.Quiz&&(s=n.questions.map(c=>`Question: ${c.questionText}`).join(`
`));const i=`
        Upgrade this deck named "${n.name}" into a comprehensive Learning Deck (Course).
        
        The deck currently contains these items:
        ${s}
        
        TASK:
        1. Analyze the concepts covered in the items.
        2. Generate 3-8 instructional "InfoCards" (chapters) that explain these concepts in a structured way.
        3. For each InfoCard, map existing item IDS to the "unlocksQuestionIds" field.
        
        EXISTING IDS:
        ${(n.type===je.Flashcard?n.cards:n.questions).map(c=>`- ${c.id}: ${"front"in c?c.front:c.questionText}`).join(`
`)}

        JSON SCHEMA:
        {
            "infoCards": [
                {
                    "id": "unique-id",
                    "content": "HTML instructional content...",
                    "unlocksQuestionIds": ["existing-id-1", "existing-id-2"]
                }
            ]
        }
        
        ONLY return raw JSON.
    `,l=await a.models.generateContent({model:"gemini-3-pro-preview",contents:i,config:{responseMimeType:"application/json"}});return an(l.text||"{}")},QT=async(n,a)=>(await Ct().models.generateContent({model:"gemini-3-flash-preview",contents:`Create a mnemonic to remember: ${n} means ${a}`})).text||"",JT=async(n,a)=>(await Ct().models.generateContent({model:"gemini-3-flash-preview",contents:`Explain like I'm 5: ${n}. Context: ${a}`})).text||"",Jv=async n=>{var i,l,c,d,m,p;return((p=(m=(d=(c=(l=(i=(await Ct().models.generateContent({model:"gemini-2.5-flash-preview-tts",contents:[{parts:[{text:n}]}],config:{responseModalities:[Dh.AUDIO],speechConfig:{voiceConfig:{prebuiltVoiceConfig:{voiceName:"Kore"}}}}})).candidates)==null?void 0:i[0])==null?void 0:l.content)==null?void 0:c.parts)==null?void 0:d[0])==null?void 0:m.inlineData)==null?void 0:p.data)||""},VE=async(n,a)=>((await Ct().models.generateContent({model:"gemini-3-flash-preview",contents:`Suggest a single-word icon name from Lucide library for deck: ${n}`})).text||"book").trim(),KE=async n=>{const s=await Ct().models.generateContent({model:"gemini-3-flash-preview",contents:`Generate relevant tags for these questions: ${JSON.stringify(n)}`,config:{responseMimeType:"application/json"}});return an(s.text||"{}")},ZE=async(n,a,s)=>(await Ct().models.generateContent({model:"gemini-3-flash-preview",contents:`Provide 3 concrete usage examples for: ${n} / ${a}. Context: ${s}`})).text||"",Xv=async(n,a,s,i)=>{const c=await Ct().models.generateContent({model:"gemini-3-pro-preview",contents:`Create better distractors for: ${n}. Correct: ${a}. Context: ${i}`,config:{responseMimeType:"application/json"}});return an(c.text||"[]")},QE=async(n,a,s)=>(await Ct().models.generateContent({model:"gemini-3-flash-preview",contents:`Expand on "${s}" in the context of ${n}. Original text: ${a}`})).text||"",Wv=async(n,a,s)=>{const l=await Ct().models.generateContent({model:"gemini-3-flash-preview",contents:`Generate a structured learning path for ${n}. Description: ${a}`,config:{responseMimeType:"application/json"}});return an(l.text||"{}")},JE=async(n,a,s,i)=>{const c=await Ct().models.generateContent({model:"gemini-3-flash-preview",contents:`Suggest new decks for level ${s} in series ${n}`,config:{responseMimeType:"application/json"}});return an(c.text||"[]")},XE=async(n,a)=>{const i=await Ct().models.generateContent({model:"gemini-3-pro-preview",contents:`Regenerate this question for ${a}: ${JSON.stringify(n)}`,config:{responseMimeType:"application/json"}});return an(i.text||"{}")},WE=async n=>{const a=Ct(),s=`
        You are a pedagogical expert analyzing educational content for a spaced repetition app.
        Analyze the following deck named "${n.name}" and provide specific, actionable improvement suggestions.
        
        DECK TYPE: ${n.type}
        DECK DATA:
        ${JSON.stringify(n)}
        
        OUTPUT FORMAT:
        Return an array of suggestion objects with the following schema:
        {
            "id": "unique-slug",
            "title": "Short title of improvement",
            "category": "Instructional Alignment | Accuracy | Formatting | Clarity",
            "description": "What needs to be changed (be specific)",
            "rationale": "Why this change improves the learning experience",
            "targetId": "Optional ID of the specific InfoCard or Question being targeted"
        }
        
        ONLY return raw JSON.
    `,i=await a.models.generateContent({model:"gemini-3-pro-preview",contents:s,config:{responseMimeType:"application/json"}});return an(i.text||"[]")},e1=async(n,a)=>{const s=Ct(),i=`
        You are a content editor. Apply the following pedagogical improvements to the provided deck.
        
        IMPROVEMENTS TO APPLY:
        ${JSON.stringify(a)}
        
        ORIGINAL DECK:
        ${JSON.stringify(n)}
        
        INSTRUCTIONS:
        1. Rewrite or restructure the deck content based on the suggestions.
        2. Ensure the output is a single valid JSON object matching the original deck's schema (${n.type}).
        3. Maintain all existing IDs where possible.
        
        ONLY return the raw JSON for the updated deck.
    `,l=await s.models.generateContent({model:"gemini-3-pro-preview",contents:i,config:{responseMimeType:"application/json"}});return an(l.text||"{}")},s0=async(n,a,s)=>{const l=await Ct().models.generateContent({model:"gemini-2.5-flash-image",contents:{parts:[{inlineData:{data:n,mimeType:a}},{text:`Create a flashcard deck from this image. Topic hint: ${s}`}]}});return an(l.text||"{}")},t1=async n=>{const s=await Ct().models.generateContent({model:"gemini-3-flash-preview",contents:`Suggest related learning topics for: ${JSON.stringify(n)}`,config:{responseMimeType:"application/json"}});return an(s.text||"[]")},n1={success:u.jsx(ze,{name:"check-circle",className:"w-6 h-6 text-green-500"}),error:u.jsx(ze,{name:"x-circle",className:"w-6 h-6 text-red-500"}),info:u.jsx(ze,{name:"info",className:"w-6 h-6 text-blue-500"}),warning:u.jsx(ze,{name:"info",className:"w-6 h-6 text-yellow-500"})},r1=({message:n,onDismiss:a})=>(B.useEffect(()=>{const s=setTimeout(()=>{a(n.id)},5e3);return()=>{clearTimeout(s)}},[n.id,a]),u.jsx("div",{className:"bg-surface shadow-lg rounded-lg pointer-events-auto ring-1 ring-black ring-opacity-5 overflow-hidden animate-fade-in-right",children:u.jsx("div",{className:"p-4",children:u.jsxs("div",{className:"flex items-start",children:[u.jsx("div",{className:"flex-shrink-0",children:n1[n.type]}),u.jsx("div",{className:"ml-3 w-0 flex-1 pt-0.5",children:u.jsx("p",{className:"text-sm font-medium text-text break-words",children:n.message})}),u.jsx("div",{className:"ml-4 flex-shrink-0 flex",children:u.jsxs("button",{onClick:()=>a(n.id),className:"bg-surface rounded-md inline-flex text-text-muted hover:text-text focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-surface focus:ring-primary",children:[u.jsx("span",{className:"sr-only",children:"Close"}),u.jsx(ze,{name:"x",className:"h-5 w-5"})]})})]})})})),i0=B.createContext(void 0),a1=({children:n})=>{const[a,s]=B.useState([]),i=B.useCallback((c,d)=>{const m=crypto.randomUUID();s(p=>[...p,{id:m,message:c,type:d}])},[]),l=B.useCallback(c=>{s(d=>d.filter(m=>m.id!==c))},[]);return u.jsxs(i0.Provider,{value:{addToast:i},children:[n,u.jsx("div",{className:"fixed top-5 right-5 z-[100] w-full max-w-xs space-y-3",children:a.map(c=>u.jsx(r1,{message:c,onDismiss:l},c.id))})]})},jn=()=>{const n=B.useContext(i0);if(n===void 0)throw new Error("useToast must be used within a ToastProvider");return n},Zr=({size:n="md"})=>{const a={sm:"h-6 w-6",md:"h-10 w-10",lg:"h-16 w-16"};return u.jsx("div",{className:"flex justify-center items-center",role:"status","aria-label":"Loading",children:u.jsxs("svg",{className:`animate-spin text-blue-500 dark:text-blue-400 ${a[n]}`,xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[u.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),u.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]})})},o0="Europe/Stockholm",s1=()=>new Date().toLocaleDateString("sv-SE",{timeZone:o0}),Zh=()=>new Date().toLocaleString("sv-SE",{timeZone:o0,year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1}).replace(/ /g,"_").replace(/:/g,"-"),i1=({isOpen:n,onClose:a,onAddDecks:s,onAddSeriesWithDecks:i})=>{const[l,c]=B.useState("create"),[d,m]=B.useState(""),[p,f]=B.useState(""),[v,_]=B.useState(""),[T,x]=B.useState(!1),[k,w]=B.useState(null),[S,C]=B.useState(null),[R,L]=B.useState(""),F=B.useRef(null),G=B.useRef(null),{addToast:Q}=jn(),{aiFeaturesEnabled:U}=Za(),{openModal:j}=Rl(),O=B.useRef(null);Mn(O,n);const q=B.useCallback(()=>{c("create"),m(""),f(""),_(""),x(!1),w(null),C(null),L("")},[]),ee=B.useCallback(()=>{q(),a()},[q,a]),M=B.useCallback(I=>{f(I);try{const te=_u(I);(te==null?void 0:te.type)===je.Quiz?m(te.data.name):(te==null?void 0:te.type)==="series"&&m(te.data.seriesName)}catch{}},[]),J=B.useCallback(async I=>{if(I){_(I.name),x(!0);try{const te=await zb(I);if(!te){Q("Unsupported file type. Please upload a JSON, CSV, Anki package, or Image.","error"),_(""),x(!1);return}if(te.type==="backup"||te.type==="anki"||te.type==="image"){x(!1),j("droppedFile",{analysis:te});return}if(te.type==="flashcard"||te.type==="quiz"||te.type==="series"){const ae=JSON.stringify(te.data,null,2);if(M(ae),x(!1),c("paste"),te.type==="flashcard"&&te.fileName){const $=te.fileName.replace(/\.(csv|json)$/i,"");m($)}Q("File processed. Review content and click Import.","success");return}}catch(te){console.error("Failed to process file:",te),Q(`An error occurred: ${te instanceof Error?te.message:"Unknown error"}`,"error"),q()}}},[Q,M,j,q]),N=I=>{var ae;const te=(ae=I.target.files)==null?void 0:ae[0];if(te){w(te);const $=new FileReader;$.onload=ue=>{var de;C((de=ue.target)==null?void 0:de.result)},$.readAsDataURL(te)}I.target&&(I.target.value="")},se=B.useCallback(I=>{var ae;I.preventDefault();const te=(ae=I.dataTransfer.files)==null?void 0:ae[0];te&&J(te)},[J]),K=B.useCallback(I=>{I.preventDefault()},[]),P=async()=>{if(k){x(!0);try{const I=await new Promise((de,oe)=>{const le=new FileReader;le.onload=()=>{const Le=le.result;de(Le.split(",")[1])},le.onerror=oe,le.readAsDataURL(k)}),{name:te,description:ae,cards:$}=await s0(I,k.type,R),ue={id:crypto.randomUUID(),name:te||`Image Deck - ${k.name}`,description:ae||`Generated from ${k.name}`,type:je.Flashcard,cards:Ya($)};s([ue]),Q(`Deck "${ue.name}" generated successfully.`,"success"),ee()}catch(I){console.error(I),Q(`Image generation failed: ${I.message}`,"error"),x(!1)}}},ve=B.useCallback(()=>{if(l==="image"){P();return}if(l==="create"){if(!d.trim()){Q("Please enter a deck name.","error");return}const I={id:crypto.randomUUID(),name:d.trim(),type:je.Flashcard,cards:[],description:`An empty deck created on ${s1()}`};s([I]),Q(`Deck "${I.name}" created.`,"success"),ee();return}if(!p){Q("Please paste content or upload a file.","error");return}try{const I=_u(p);if(!I)return;if(I.type==="series"){const{seriesName:ae,seriesDescription:$,levels:ue}=I.data,de=[],oe=ue.map(Le=>{const De=Le.decks.map(Se=>Se.type===je.Quiz?{id:crypto.randomUUID(),name:Se.name,description:Se.description,type:je.Quiz,questions:aa(Se.questions||[])}:Se.type===je.Flashcard?{id:crypto.randomUUID(),name:Se.name,description:Se.description,type:je.Flashcard,cards:Ya(Se.cards||[])}:null).filter(Se=>Se!==null);return de.push(...De),{title:Le.title,deckIds:De.map(Se=>Se.id)}}),le={id:crypto.randomUUID(),type:"series",name:ae,description:$,levels:oe,archived:!1,createdAt:new Date().toISOString()};i(le,de),ee();return}if(!d.trim()){Q("Please enter a deck name.","error");return}let te;if(I.type===je.Flashcard){const ae=Ya(I.data);te={id:crypto.randomUUID(),name:d.trim(),type:je.Flashcard,cards:ae,description:`${ae.length} imported flashcard${ae.length===1?"":"s"}.`}}else{const ae=aa(I.data.questions);te={id:crypto.randomUUID(),name:d.trim(),description:I.data.description,type:je.Quiz,questions:ae}}s([te]),Q(`Deck "${te.name}" imported successfully.`,"success"),ee()}catch(I){Q(I instanceof Error?I.message:"Invalid JSON content.","error")}},[d,l,p,s,ee,Q,i,P]),ce=I=>{var ae;const te=(ae=I.target.files)==null?void 0:ae[0];te&&J(te),I.target&&(I.target.value="")};if(!n)return null;const Ee=()=>{switch(l){case"image":return u.jsxs("div",{className:"space-y-4",children:[u.jsxs("div",{className:"flex flex-col items-center justify-center w-full h-48 border-2 border-dashed border-border rounded-lg cursor-pointer hover:bg-background transition-colors relative overflow-hidden",children:[S?u.jsxs("div",{className:"relative w-full h-full group",children:[u.jsx("img",{src:S,alt:"Preview",className:"w-full h-full object-contain"}),u.jsx("div",{className:"absolute inset-0 bg-black/50 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center",children:u.jsx($e,{variant:"danger",size:"sm",onClick:I=>{I.stopPropagation(),w(null),C(null)},children:"Remove Image"})})]}):u.jsxs("label",{className:"flex flex-col items-center justify-center w-full h-full cursor-pointer",onClick:I=>{var te;I.preventDefault(),(te=G.current)==null||te.click()},children:[u.jsx(ze,{name:"upload-cloud",className:"w-10 h-10 text-text-muted mb-2"}),u.jsx("p",{className:"text-sm text-text-muted",children:u.jsx("span",{className:"font-semibold text-primary",children:"Click to upload image"})}),u.jsx("p",{className:"text-xs text-text-muted/70",children:"PNG, JPG, WEBP"})]}),u.jsx("input",{type:"file",ref:G,className:"hidden",accept:"image/*",onChange:N})]}),u.jsxs("div",{children:[u.jsx("label",{htmlFor:"image-hint",className:"block text-sm font-medium text-text-muted mb-1",children:"Topic / Hint (Optional)"}),u.jsx("input",{type:"text",id:"image-hint",value:R,onChange:I=>L(I.target.value),className:"w-full p-2 bg-background border border-border rounded-md focus:ring-2 focus:ring-primary focus:outline-none",placeholder:"e.g., Focus on the dates in the timeline"}),u.jsx("p",{className:"text-xs text-text-muted mt-1",children:"Guide the AI to extract specific information."})]})]});case"paste":return u.jsxs("div",{children:[u.jsx("textarea",{className:"w-full h-48 p-2 bg-background border border-border rounded-md focus:ring-2 focus:ring-primary focus:outline-none text-text",placeholder:'Paste JSON here... e.g., [{"front": "Q1", "back": "A1"}] or a Quiz/Series object.',value:p,onChange:I=>M(I.target.value)}),u.jsxs(ra,{href:"/instructions/json",onClick:a,className:"text-sm text-primary hover:underline mt-2 inline-flex items-center gap-1",children:[u.jsx(ze,{name:"help-circle",className:"w-4 h-4"}),"View JSON format guide"]})]});case"upload":return u.jsxs(u.Fragment,{children:[u.jsx("input",{type:"file",ref:F,className:"hidden",accept:".json, .csv, .apkg, .zip, image/*",onChange:ce}),u.jsxs("label",{onDrop:se,onDragOver:K,className:"flex flex-col items-center justify-center w-full h-48 border-2 border-dashed border-border rounded-lg cursor-pointer hover:bg-background transition-colors",children:[u.jsx(ze,{name:"upload-cloud",className:"w-10 h-10 text-text-muted mb-2"}),u.jsxs("p",{className:"text-sm text-text-muted",children:[u.jsx("span",{className:"font-semibold text-primary",onClick:I=>{var te;I.preventDefault(),(te=F.current)==null||te.click()},children:"Click to upload"})," or drag and drop anywhere"]}),u.jsx("p",{className:"text-xs text-text-muted/70",children:"JSON, CSV, Anki (.apkg), Backup, or Image"}),v&&u.jsx("p",{className:"text-sm text-green-500 dark:text-green-400 mt-2 truncate",title:v,children:v})]})]});case"create":default:return u.jsx("p",{className:"text-text-muted text-center py-12",children:"Create an empty flashcard deck."})}},z=l!=="image"&&l!=="upload";return u.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-[60] p-4",children:u.jsxs("div",{ref:O,className:"bg-surface rounded-lg shadow-xl w-full max-w-lg overflow-hidden transform transition-all relative",children:[T&&u.jsxs("div",{className:"absolute inset-0 bg-surface/80 flex flex-col items-center justify-center z-20",children:[u.jsx(Zr,{}),u.jsx("p",{className:"text-lg text-text mt-4",children:l==="image"?"Analyzing image...":"Processing file..."})]}),u.jsxs("div",{className:"flex justify-between items-center p-4 border-b border-border",children:[u.jsx("h2",{className:"text-xl font-bold text-text",children:"Create / Import"}),u.jsx($e,{variant:"ghost",onClick:ee,className:"p-1 h-auto",children:u.jsx(ze,{name:"x"})})]}),u.jsxs("div",{className:"p-6 space-y-4",children:[z&&u.jsxs("div",{children:[u.jsx("label",{htmlFor:"deck-name",className:"block text-sm font-medium text-text-muted mb-1",children:"Deck / Series Name"}),u.jsx("input",{type:"text",id:"deck-name",value:d,onChange:I=>m(I.target.value),className:"w-full p-2 bg-background border border-border rounded-md focus:ring-2 focus:ring-primary focus:outline-none",placeholder:"e.g. Japanese Vocabulary"}),u.jsx("p",{className:"text-xs text-text-muted mt-1",children:"For single deck or new deck creation. This is auto-filled when pasting a Series object."})]}),u.jsx("div",{className:"flex border-b border-border overflow-x-auto",children:["create","paste","upload",...U?["image"]:[]].map(I=>u.jsx("button",{onClick:()=>c(I),className:`capitalize px-4 py-2 text-sm font-medium transition-colors whitespace-nowrap ${l===I?"border-b-2 border-primary text-text":"text-text-muted hover:text-text"}`,children:I==="create"?"Create Empty":I},I))}),u.jsx("div",{className:"mt-4",children:Ee()})]}),u.jsxs("div",{className:"flex justify-end p-4 bg-background/50 border-t border-border",children:[u.jsx($e,{variant:"secondary",onClick:ee,className:"mr-2",children:"Cancel"}),u.jsx($e,{variant:"primary",onClick:ve,disabled:T||l==="create"&&!d.trim()||l==="paste"&&!p||l==="upload"&&!v||l==="image"&&!k,children:l==="create"?"Create Deck":l==="image"?"Generate Deck":"Import"})]})]})})},l0=B.createContext(null),c0=()=>{const n=B.useContext(l0);if(!n)throw new Error("Accordion components must be used within an <Accordion> component.");return n},u0=B.createContext(null),d0=()=>{const n=B.useContext(u0);if(!n)throw new Error("AccordionTrigger/Content must be used within an <AccordionItem> component.");return n},o1=({children:n,type:a="single",defaultValue:s,className:i=""})=>{const[l,c]=B.useState(s||(a==="multiple"?[]:"")),d=m=>{c(a==="multiple"?p=>{const f=Array.isArray(p)?p:[];return f.includes(m)?f.filter(v=>v!==m):[...f,m]}:p=>p===m?"":m)};return B.useEffect(()=>{c(s===void 0?a==="multiple"?[]:"":s)},[s,a]),u.jsx(l0.Provider,{value:{value:l,onValueChange:d,type:a},children:u.jsx("div",{className:i,children:n})})},nu=({children:n,value:a,className:s=""})=>{const{value:i,type:l}=c0(),c=l==="multiple"?Array.isArray(i)&&i.includes(a):i===a;return u.jsx(u0.Provider,{value:{value:a,isOpen:c},children:u.jsx("div",{className:s,children:n})})},ru=({children:n,className:a="",...s})=>{const{onValueChange:i}=c0(),{value:l,isOpen:c}=d0(),d=`accordion-content-${l}`,m=`accordion-header-${l}`;return u.jsx("h3",{id:m,className:"m-0 font-medium",children:u.jsxs("button",{type:"button",onClick:()=>i(l),"aria-expanded":c,"aria-controls":d,className:`w-full flex justify-between items-center text-left p-4 bg-surface hover:bg-border/20 transition-colors ${a}`,...s,children:[n,u.jsx(ze,{name:"chevron-down",className:`w-5 h-5 transition-transform duration-300 ${c?"rotate-180":""} text-text-muted`})]})})},au=({children:n,className:a=""})=>{const{value:s,isOpen:i}=d0(),l=`accordion-content-${s}`,c=`accordion-header-${s}`;return i?u.jsx("div",{id:l,role:"region","aria-labelledby":c,className:`animate-fade-in ${a}`,children:n}):null},ol=({label:n,localValue:a,backupValue:s,hasChanged:i})=>i?u.jsxs("div",{className:"text-xs",children:[u.jsxs("span",{className:"font-semibold",children:[n,": "]}),u.jsx("span",{className:"text-text-muted",children:a}),u.jsx(ze,{name:"arrow-down",className:"inline w-3 h-3 mx-1 rotate-[-90deg]"}),u.jsx("span",{className:"text-primary font-semibold",children:s})]}):null,l1=({isOpen:n,onClose:a,onCompare:s,onRestoreSelected:i,onFullRestore:l,openConfirmModal:c,file:d})=>{const[m,p]=B.useState("upload"),[f,v]=B.useState(""),[_,T]=B.useState(null),[x,k]=B.useState(null),[w,S]=B.useState(new Set),C=B.useRef(null),{addToast:R}=jn(),L=B.useRef(null);Mn(L,n);const{seriesProgress:F}=Ze();B.useEffect(()=>{d&&n&&Q(d)},[d,n]);const G=()=>{p("upload"),v(""),T(null),k(null),S(new Set),a()},Q=async se=>{if(se){p("loading"),v(se.name);try{const K=await se.text(),P=await Au(K);T(P);const ve=s(P);k(ve);const ce=[...ve.newSeries.map(Ee=>Ee.id),...ve.newDecks.map(Ee=>Ee.id),...ve.changedSeries.map(Ee=>Ee.backup.id),...ve.changedDecks.map(Ee=>Ee.backup.id)];S(new Set(ce)),p("compare")}catch(K){R(`Restore failed: ${K instanceof Error?K.message:"Unknown error"}`,"error"),G()}}},U=se=>{var P;if(m==="loading")return;const K=(P=se.target.files)==null?void 0:P[0];K&&Q(K),se.target&&(se.target.value="")},j=se=>{var P;if(se.preventDefault(),m==="loading")return;const K=(P=se.dataTransfer.files)==null?void 0:P[0];K&&Q(K)},O=se=>se.preventDefault(),q=async()=>{_&&(p("loading"),await i({selectedIds:w,backupData:_}),G())},ee=()=>{_&&(a(),c({title:"Confirm Full Restore",message:"This will completely overwrite all your local data with the contents of the backup file. This action cannot be undone.",confirmText:"overwrite everything",onConfirm:()=>l(_)}))},M=se=>{S(K=>{const P=new Set(K);return P.has(se)?P.delete(se):P.add(se),P})};if(!n)return null;const J=se=>{var K,P;return se.type===je.Flashcard?((K=se.cards)==null?void 0:K.length)||0:((P=se.questions)==null?void 0:P.length)||0},N=()=>{if(m==="loading")return u.jsxs("div",{className:"absolute inset-0 bg-surface/80 flex flex-col items-center justify-center z-20",children:[u.jsx(Zr,{}),u.jsx("p",{className:"text-lg text-text mt-4",children:"Analyzing backup..."})]});if(m==="compare"&&x){const{newSeries:se,newDecks:K,changedSeries:P,changedDecks:ve,dueCounts:ce,masteryLevels:Ee}=x,z=new Set(se.flatMap(ue=>(ue.levels||[]).flatMap(de=>de.deckIds||[]))),I=K.filter(ue=>!z.has(ue.id)),te=se.length>0||I.length>0,ae=P.length>0||ve.length>0,$=[];return se.length>0&&$.push("new-series"),I.length>0&&$.push("new-decks"),P.length>0&&$.push("changed-series"),ve.length>0&&$.push("changed-decks"),u.jsx("div",{className:"p-6 space-y-4 max-h-[60vh] overflow-y-auto",children:!te&&!ae?u.jsxs("div",{className:"text-center py-8 text-text-muted",children:[u.jsx(ze,{name:"check-circle",className:"w-12 h-12 mx-auto text-green-500"}),u.jsx("p",{className:"mt-2 font-medium",children:"Everything is up-to-date!"}),u.jsx("p",{className:"text-sm",children:"Your local data already matches the contents of this backup file."})]}):u.jsxs(o1,{type:"multiple",defaultValue:$,children:[se.length>0&&u.jsxs(nu,{value:"new-series",className:"border-b",children:[u.jsxs(ru,{children:["New Series (",se.length,")"]}),u.jsx(au,{className:"p-2 space-y-2",children:se.map(ue=>u.jsx("div",{className:"p-3 bg-background rounded-md border border-border",children:u.jsxs("label",{className:"flex items-start gap-3 cursor-pointer",children:[u.jsx("input",{type:"checkbox",checked:w.has(ue.id),onChange:()=>M(ue.id),className:"mt-1 h-4 w-4 rounded border-gray-300 text-primary focus:ring-primary"}),u.jsxs("div",{className:"flex-grow",children:[u.jsx("p",{className:"font-semibold text-text",children:ue.name}),u.jsxs("p",{className:"text-xs text-text-muted",children:[(ue.levels||[]).reduce((de,oe)=>{var le;return de+(((le=oe.deckIds)==null?void 0:le.length)||0)},0)," deck(s)"]})]})]})},ue.id))})]}),P.length>0&&u.jsxs(nu,{value:"changed-series",className:"border-b",children:[u.jsxs(ru,{children:["Changed Series (",P.length,")"]}),u.jsx(au,{className:"p-2 space-y-2",children:P.map(({local:ue,backup:de,diff:oe})=>{var ne,E;const le=`${((ne=F.get(ue.id))==null?void 0:ne.size)||0}/${(ue.levels||[]).reduce((me,X)=>{var Z;return me+(((Z=X.deckIds)==null?void 0:Z.length)||0)},0)}`,Le=`${((E=((_==null?void 0:_.seriesProgress)||{})[de.id])==null?void 0:E.length)||0}/${(de.levels||[]).reduce((me,X)=>{var Z;return me+(((Z=X.deckIds)==null?void 0:Z.length)||0)},0)}`,De=Math.round((Ee.get(`local-${ue.id}`)||0)*100),Se=Math.round((Ee.get(de.id)||0)*100);return u.jsx("div",{className:"p-3 bg-background rounded-md border border-border",children:u.jsxs("label",{className:"flex items-start gap-3 cursor-pointer",children:[u.jsx("input",{type:"checkbox",checked:w.has(de.id),onChange:()=>M(de.id),className:"mt-1 h-4 w-4 rounded border-gray-300 text-primary focus:ring-primary"}),u.jsxs("div",{className:"flex-grow space-y-1",children:[u.jsx("p",{className:"font-semibold text-text",children:de.name}),u.jsx(ol,{label:"Completion",localValue:le,backupValue:Le,hasChanged:oe.completion}),u.jsx(ol,{label:"Mastery",localValue:`${De}%`,backupValue:`${Se}%`,hasChanged:oe.mastery}),oe.structure&&u.jsx("p",{className:"text-xs font-semibold text-primary",children:"Content/Structure updated"})]})]})},de.id)})})]}),I.length>0&&u.jsxs(nu,{value:"new-decks",className:"border-b",children:[u.jsxs(ru,{children:["New Standalone Decks (",I.length,")"]}),u.jsx(au,{className:"p-2 space-y-2",children:I.map(ue=>u.jsx("div",{className:"p-3 bg-background rounded-md border border-border",children:u.jsxs("label",{className:"flex items-start gap-3 cursor-pointer",children:[u.jsx("input",{type:"checkbox",checked:w.has(ue.id),onChange:()=>M(ue.id),className:"mt-1 h-4 w-4 rounded border-gray-300 text-primary focus:ring-primary"}),u.jsxs("div",{className:"flex-grow",children:[u.jsx("p",{className:"font-semibold text-text",children:ue.name}),u.jsxs("p",{className:"text-xs text-text-muted",children:[J(ue)," item(s)  ",ce.get(ue.id)||0," due"]})]})]})},ue.id))})]}),ve.length>0&&u.jsxs(nu,{value:"changed-decks",className:"border-b",children:[u.jsxs(ru,{children:["Changed Decks (",ve.length,")"]}),u.jsx(au,{className:"p-2 space-y-2",children:ve.map(({local:ue,backup:de,diff:oe})=>{const le=Math.round((Ee.get(`local-${ue.id}`)||0)*100),Le=Math.round((Ee.get(de.id)||0)*100);return u.jsx("div",{className:"p-3 bg-background rounded-md border border-border",children:u.jsxs("label",{className:"flex items-start gap-3 cursor-pointer",children:[u.jsx("input",{type:"checkbox",checked:w.has(de.id),onChange:()=>M(de.id),className:"mt-1 h-4 w-4 rounded border-gray-300 text-primary focus:ring-primary"}),u.jsxs("div",{className:"flex-grow space-y-1",children:[u.jsx("p",{className:"font-semibold text-text",children:de.name}),u.jsx(ol,{label:"Items",localValue:J(ue),backupValue:J(de),hasChanged:oe.content}),u.jsx(ol,{label:"Due",localValue:ce.get(`local-${ue.id}`),backupValue:ce.get(de.id),hasChanged:oe.dueCount}),u.jsx(ol,{label:"Mastery",localValue:`${le}%`,backupValue:`${Le}%`,hasChanged:oe.mastery}),oe.content&&u.jsx("p",{className:"text-xs font-semibold text-primary",children:"Content updated"})]})]})},de.id)})})]})]})})}return u.jsxs("div",{className:"p-6 space-y-4",children:[u.jsx("input",{type:"file",ref:C,className:"hidden",accept:".json,application/json,.zip",onChange:U}),u.jsxs("label",{onDragOver:O,onDrop:j,className:"flex flex-col items-center justify-center w-full h-48 border-2 border-dashed border-border rounded-lg cursor-pointer hover:bg-background",children:[u.jsx(ze,{name:"upload-cloud",className:"w-10 h-10 text-text-muted mb-2"}),u.jsxs("p",{className:"text-sm text-text-muted",children:[u.jsx("span",{className:"font-semibold text-primary",onClick:se=>{var K;se.preventDefault(),(K=C.current)==null||K.click()},children:"Click to upload"})," or drag and drop"]}),u.jsx("p",{className:"text-xs text-text-muted/70",children:"CogniFlow Backup JSON file"})]})]})};return u.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-[60] p-4",children:u.jsxs("div",{ref:L,className:"bg-surface rounded-lg shadow-xl w-full max-w-lg overflow-hidden transform transition-all relative",children:[u.jsxs("div",{className:"flex justify-between items-center p-4 border-b border-border",children:[u.jsx("h2",{className:"text-xl font-bold",children:"Restore from Backup"}),u.jsx($e,{variant:"ghost",onClick:G,className:"p-1 h-auto",disabled:m==="loading",children:u.jsx(ze,{name:"x"})})]}),N(),u.jsxs("div",{className:"flex justify-between items-center p-4 bg-background/50 border-t border-border",children:[u.jsx("div",{children:m==="compare"&&u.jsx($e,{variant:"danger",onClick:ee,children:"Full Restore"})}),u.jsxs("div",{className:"flex gap-2",children:[u.jsx($e,{variant:"secondary",onClick:G,disabled:m==="loading",children:"Cancel"}),m==="compare"&&u.jsxs($e,{variant:"primary",onClick:q,disabled:w.size===0,children:["Add/Update Selected (",w.size,")"]})]})]})]})})},c1=({isOpen:n,onClose:a,onReset:s,decks:i})=>{const[l,c]=B.useState(""),{addToast:d}=jn(),m=B.useRef(null);Mn(m,n);const f=!!B.useMemo(()=>i.find(T=>T.id===l),[i,l]),v=()=>{if(!f){d("Please select a deck to reset.","error");return}s(l),a()},_=()=>{c(""),a()};return n?u.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-[60] p-4",children:u.jsxs("div",{ref:m,className:"bg-surface rounded-lg shadow-xl w-full max-w-lg transform transition-all relative",children:[u.jsxs("div",{className:"flex justify-between items-center p-4 border-b border-border",children:[u.jsx("h2",{className:"text-xl font-bold",children:"Reset Deck Progress"}),u.jsx($e,{type:"button",variant:"ghost",onClick:_,className:"p-1 h-auto",children:u.jsx(ze,{name:"x"})})]}),u.jsxs("div",{className:"p-6 space-y-4",children:[u.jsx("div",{className:"bg-red-900/20 border border-red-500/30 rounded-lg p-4 text-sm text-red-700 dark:text-red-200",children:u.jsxs("p",{children:[u.jsx("strong",{className:"font-bold",children:"Warning:"})," This will reset all spaced repetition data (due dates, intervals) for the selected deck. The cards themselves will not be deleted. This action cannot be undone."]})}),u.jsxs("div",{children:[u.jsx("label",{htmlFor:"deck-select",className:"block text-sm font-medium text-text-muted mb-1",children:"Select Deck"}),u.jsxs("select",{id:"deck-select",value:l,onChange:T=>{c(T.target.value)},className:"w-full p-2 bg-background border border-border rounded-md focus:ring-2 focus:ring-primary focus:outline-none",children:[u.jsx("option",{value:"",disabled:!0,children:"-- Select a deck --"}),i.map(T=>u.jsx("option",{value:T.id,children:T.name},T.id))]})]})]}),u.jsxs("div",{className:"flex justify-end p-4 bg-background/50 border-t border-border",children:[u.jsx($e,{type:"button",variant:"secondary",onClick:_,className:"mr-2",children:"Cancel"}),u.jsxs($e,{type:"button",variant:"danger",onClick:v,disabled:!f,children:[u.jsx(ze,{name:"refresh-ccw",className:"w-5 h-5 mr-2"}),"Reset Progress"]})]})]})}):null},u1=({isOpen:n,onClose:a,onConfirm:s,title:i,message:l,confirmText:c})=>{const[d,m]=B.useState(!1),p=B.useRef(null);Mn(p,n),B.useEffect(()=>{n&&m(!1)},[n]);const f=async()=>{m(!0);try{await Promise.resolve(s()),p.current&&a()}catch(v){console.error("Confirmation action failed:",v)}finally{p.current&&m(!1)}};return n?u.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-[60] p-4",children:u.jsxs("div",{ref:p,className:"bg-surface rounded-lg shadow-xl w-full max-w-md transform transition-all relative",role:"alertdialog","aria-modal":"true","aria-labelledby":"confirm-title","aria-describedby":"confirm-message",children:[u.jsxs("div",{className:"flex justify-between items-center p-4 border-b border-border",children:[u.jsx("h2",{id:"confirm-title",className:"text-xl font-bold text-text",children:i}),u.jsx($e,{type:"button",variant:"ghost",onClick:a,className:"p-1 h-auto","aria-label":"Close",disabled:d,children:u.jsx(ze,{name:"x"})})]}),u.jsx("div",{className:"p-6 space-y-4",children:u.jsx("p",{id:"confirm-message",className:"text-text-muted",children:l})}),u.jsxs("div",{className:"flex justify-end p-4 bg-background/50 border-t border-border",children:[u.jsx($e,{type:"button",variant:"secondary",onClick:a,className:"mr-2",disabled:d,children:"Cancel"}),u.jsx($e,{type:"button",variant:"danger",onClick:f,disabled:d,children:d?u.jsx(Zr,{size:"sm"}):c||"Confirm"})]})]})}):null},d1=({folder:n,isOpen:a,onClose:s,onSave:i})=>{const[l,c]=B.useState(""),{addToast:d}=jn(),m=B.useRef(null);Mn(m,a),B.useEffect(()=>{c(n?n.name:"")},[n]);const p=f=>{if(f.preventDefault(),!l.trim()){d("Folder name cannot be empty.","error");return}i({id:(n==null?void 0:n.id)||null,name:l.trim()}),s()};return a?u.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-[60] p-4",children:u.jsx("div",{ref:m,className:"bg-surface rounded-lg shadow-xl w-full max-w-md transform transition-all relative",children:u.jsxs("form",{onSubmit:p,children:[u.jsxs("div",{className:"flex justify-between items-center p-4 border-b border-border",children:[u.jsx("h2",{className:"text-xl font-bold",children:n?"Edit Folder":"Create New Folder"}),u.jsx($e,{type:"button",variant:"ghost",onClick:s,className:"p-1 h-auto",children:u.jsx(ze,{name:"x"})})]}),u.jsx("div",{className:"p-6 space-y-4",children:u.jsxs("div",{children:[u.jsx("label",{htmlFor:"folder-name",className:"block text-sm font-medium text-text-muted mb-1",children:"Folder Name"}),u.jsx("input",{id:"folder-name",type:"text",value:l,onChange:f=>c(f.target.value),className:"w-full p-2 bg-background border border-border rounded-md focus:ring-2 focus:ring-primary focus:outline-none",placeholder:"e.g., University Courses",autoFocus:!0})]})}),u.jsxs("div",{className:"flex justify-end p-4 bg-background/50 border-t border-border",children:[u.jsx($e,{type:"button",variant:"secondary",onClick:s,className:"mr-2",children:"Cancel"}),u.jsxs($e,{type:"submit",variant:"primary",children:[u.jsx(ze,{name:"save",className:"w-4 h-4 mr-2"}),n?"Save Changes":"Create Folder"]})]})]})})}):null},f1=({series:n,isOpen:a,onClose:s,onSave:i})=>{const[l,c]=B.useState(""),[d,m]=B.useState(""),[p,f]=B.useState(null),{addToast:v}=jn(),_=B.useRef(null);Mn(_,a);const T=n===null;B.useEffect(()=>{n?(c(n.name),m(n.description),f(null)):(c(""),m(""),f(null))},[n]);const x=w=>{if(!T)return;const S=w.clipboardData.getData("text");if(S.trim().startsWith("{"))try{const C=JSON.parse(S);typeof C.seriesName=="string"&&typeof C.seriesDescription=="string"&&Array.isArray(C.levels)&&(w.preventDefault(),c(C.seriesName),m(C.seriesDescription),f(C),v("Series details and structure populated from JSON scaffold!","success"))}catch{}},k=w=>{if(w.preventDefault(),!l.trim()){v("Series name cannot be empty.","error");return}i({id:T?null:n.id,name:l.trim(),description:d.trim(),scaffold:T?p:null}),s()};return a?u.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-[60] p-4",children:u.jsx("div",{ref:_,className:"bg-surface rounded-lg shadow-xl w-full max-w-lg transform transition-all relative",children:u.jsxs("form",{onSubmit:k,children:[u.jsxs("div",{className:"flex justify-between items-center p-4 border-b border-border",children:[u.jsx("h2",{className:"text-xl font-bold",children:T?"Create New Series":"Edit Series"}),u.jsx($e,{type:"button",variant:"ghost",onClick:s,className:"p-1 h-auto",children:u.jsx(ze,{name:"x"})})]}),u.jsxs("div",{className:"p-6 space-y-4",children:[u.jsxs("div",{children:[u.jsx("label",{htmlFor:"series-name",className:"block text-sm font-medium text-text-muted mb-1",children:"Series Name"}),u.jsx("input",{id:"series-name",type:"text",value:l,onChange:w=>c(w.target.value),onPaste:x,className:"w-full p-2 bg-background border border-border rounded-md focus:ring-2 focus:ring-primary focus:outline-none",placeholder:"e.g., Introduction to Algebra",autoFocus:!0}),T&&u.jsx("p",{className:"text-xs text-text-muted mt-1",children:"You can paste a full JSON scaffold object here to auto-populate."})]}),u.jsxs("div",{children:[u.jsx("label",{htmlFor:"series-description",className:"block text-sm font-medium text-text-muted mb-1",children:"Description"}),u.jsx("textarea",{id:"series-description",value:d,onChange:w=>m(w.target.value),onPaste:x,rows:3,className:"w-full p-2 bg-background border border-border rounded-md focus:ring-2 focus:ring-primary focus:outline-none",placeholder:"A collection of decks covering core concepts."})]}),T&&p&&u.jsxs("div",{className:"space-y-2 animate-fade-in",children:[u.jsx("h4",{className:"text-sm font-semibold text-text-muted",children:"Structure Preview"}),u.jsx("div",{className:"bg-background border border-border rounded-md p-3 max-h-48 overflow-y-auto text-sm",children:u.jsx("ul",{className:"space-y-3",children:(p.levels||[]).filter(w=>!!w).map((w,S)=>{const C=w.decks||[];return u.jsxs("li",{children:[u.jsxs("div",{className:"flex items-center gap-2 font-medium text-text",children:[u.jsx(ze,{name:"layers",className:"w-4 h-4 text-purple-500 flex-shrink-0"}),u.jsx("span",{className:"font-semibold",children:w.title})]}),u.jsxs("ul",{className:"pl-6 mt-1 space-y-1",children:[C.map((R,L)=>u.jsxs("li",{className:"flex items-center gap-2 text-text-muted",children:[u.jsx(ze,{name:"help-circle",className:"w-3.5 h-3.5 flex-shrink-0"}),u.jsx("span",{children:R.name})]},L)),C.length===0&&u.jsx("li",{className:"flex items-center gap-2 text-xs text-text-muted/70 italic",children:"(No decks in this level)"})]})]},S)})})})]})]}),u.jsxs("div",{className:"flex justify-end p-4 bg-background/50 border-t border-border",children:[u.jsx($e,{type:"button",variant:"secondary",onClick:s,className:"mr-2",children:"Cancel"}),u.jsxs($e,{type:"submit",variant:"primary",children:[u.jsx(ze,{name:"save",className:"w-4 h-4 mr-2"}),T?"Create Series":"Save Changes"]})]})]})})}):null},f0="cogniflow-ai-options",su={understandingLevels:["Auto","Novice","Beginner","Intermediate","Advanced","Expert"],comprehensivenessLevels:["Quick Overview","Standard","Comprehensive","Exhaustive"],learningGoalOptions:["Auto","Master a subject","Learn for the sake of curiosity","Explore a new interest","Become more informed","Understand a complex topic","Practically learn the topic"],learningStyleOptions:["Auto","Conceptual Understanding (Why & How)","Factual Recall (What, Who, When)","Practical Application & Scenarios"],languageOptions:["Auto","English","Swedish","Spanish","French","German","Japanese","Mandarin","Russian"],toneOptions:["Auto","Neutral","Formal","Casual","Academic","Enthusiastic","Humorous"],personas:[{id:"default",name:"Default Assistant",instruction:"You are a helpful and neutral AI assistant."},{id:"tutor",name:"Friendly Tutor",instruction:"You are a friendly and encouraging tutor. You use analogies and explain complex topics in a simple, easy-to-understand way."},{id:"professor",name:"University Professor",instruction:"You are an expert professor. Your tone is formal, academic, and you provide in-depth, precise information."},{id:"author",name:"Technical Author",instruction:"You are a technical author. Your style is concise, precise, and fact-focused. You avoid fluff and get straight to the point."},{id:"lindstrom",name:"Fredrik Lindstrm",instruction:'You are Fredrik Lindstrm. You explain topics with a focus on linguistics, history, and cultural nuances. You are witty, slightly dry, and love to find the "human" element in dry facts. You make connections between language, culture, and history that others miss.'},{id:"bryson",name:"Bill Bryson",instruction:'You are Bill Bryson. You write with an infectious sense of wonder, finding the "extraordinary in the ordinary." Your prose is conversational, witty, and avoids academic jargon. You use dry, self-deprecating humor and focus on the bizarre anecdotes and hidden history that textbooks leave out.'},{id:"feynman",name:"Richard Feynman",instruction:'You are Richard Feynman. You hate jargon and pseudo-intellectualism. Your goal is to explain complex topics using simple, physical analogies and plain language. You focus on the "why" and "how," not just the names of things. You are enthusiastic and radically curious.'},{id:"roach",name:"Mary Roach",instruction:"You are Mary Roach. You are intensely curious about the practical, slightly gross, or bizarre aspects of the topic. You focus on the human side of science and historythe sweat, the mistakes, and the awkward details. You are funny, fearless, and relatable."},{id:"great_teacher",name:"The Great Teacher",instruction:`You are "The Great Teacher." Your teaching style is built on narrative, humor, and relatability. You model "Radical Curiosity" and awe for the subject. You use storytelling to make facts stick, and you constantly relate the material back to the learner's life.`},{id:"the_master",name:"The Master",instruction:`You are "The Master," the ultimate educational companion. 
      
      CORE PHILOSOPHY: Facts are useless without context. Understanding requires "Radical Curiosity."
      
      YOUR 5 PILLARS OF TEACHING:
      1. THE STYLIST: Write with rhythm. Combine short, punchy sentences with lyrical descriptions. Avoid dry academic tone. You are a mentor, not a manual.
      2. THE STORYTELLER: Find the human struggle behind the fact. Gravity isn't just a force; it's Newton's obsession.
      3. THE ANALOGY ARCHITECT: Never explain a complex abstract concept without a concrete physical analogy. (e.g., "Voltage is water pressure").
      4. THE PROVOCATEUR (Keating Mode): Occasionally ask the user a question that has no right answer. Challenge their assumptions. Remind them that learning is an act of rebellion.
      5. THE FORMATTER: Use HTML tags (<b>, <i>, <br>) aggressively to structure your text. Key terms must be bold. Use italics for emphasis.
      
      When generating content, you must embody this persona completely.`}],customFields:[]},h1=()=>{try{const n=localStorage.getItem(f0);if(n){const a=JSON.parse(n),s=[...su.personas,...(a.personas||[]).filter(i=>!su.personas.some(l=>l.id===i.id))];return{...su,...a,personas:s}}}catch(n){console.error("Failed to parse AI options from localStorage",n)}return su},Du=()=>{const[n,a]=B.useState(h1),s=l=>{try{localStorage.setItem(f0,JSON.stringify(l)),a(l)}catch(c){console.error("Failed to save AI options to localStorage",c)}},i=B.useCallback((l,c)=>{a(d=>{const m={...d,[l]:c};return s(m),m})},[]);return{options:n,updateCategory:i}},Qi=({title:n,category:a})=>{const{options:s,updateCategory:i}=Du(),[l,c]=B.useState(s[a]),[d,m]=B.useState(""),p=()=>{if(d.trim()){const v=[...l,d.trim()];c(v),i(a,v),m("")}},f=v=>{const _=l.filter((T,x)=>x!==v);c(_),i(a,_)};return u.jsxs("div",{className:"p-4 bg-background border border-border rounded-lg",children:[u.jsx("h4",{className:"font-semibold text-text mb-2",children:n}),u.jsx("ul",{className:"space-y-2",children:l.map((v,_)=>u.jsxs("li",{className:"flex items-center justify-between p-2 bg-surface rounded-md border border-border/50",children:[u.jsx("span",{className:"text-sm",children:v}),u.jsx($e,{variant:"ghost",size:"sm",className:"p-1 h-auto",onClick:()=>f(_),children:u.jsx(ze,{name:"trash-2",className:"w-4 h-4 text-red-500"})})]},_))}),u.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[u.jsx("input",{type:"text",value:d,onChange:v=>m(v.target.value),onKeyDown:v=>{v.key==="Enter"&&(v.preventDefault(),p())},placeholder:"Add...",className:"flex-grow p-1.5 text-sm bg-surface border border-border rounded-md"}),u.jsx($e,{variant:"secondary",size:"sm",onClick:p,children:"Add"})]})]})},m1=()=>{const{options:n,updateCategory:a}=Du(),[s,i]=B.useState(()=>JSON.parse(JSON.stringify(n.personas))),{addToast:l}=jn(),c=(f,v,_)=>{const T=[...s];T[f]={...T[f],[v]:_},i(T)},d=()=>{i([...s,{id:crypto.randomUUID(),name:"",instruction:""}])},m=f=>{s[f].id!=="default"&&i(s.filter((v,_)=>_!==f))},p=()=>{a("personas",s.filter(f=>f.name.trim()&&f.instruction.trim())),l("Personas saved!","success")};return u.jsxs("div",{className:"space-y-4",children:[u.jsxs("div",{className:"flex justify-between items-center",children:[u.jsx("h4",{className:"font-semibold text-text",children:"AI Personas"}),u.jsx($e,{variant:"secondary",size:"sm",onClick:p,children:"Save Personas"})]}),s.map((f,v)=>u.jsxs("div",{className:"space-y-2 p-3 bg-background border border-border rounded-md",children:[u.jsx("input",{type:"text",placeholder:"Persona Name (e.g., Cheerful Tutor)",value:f.name,onChange:_=>c(v,"name",_.target.value),className:"w-full p-2 text-sm bg-surface border border-border rounded-md",disabled:f.id==="default"}),u.jsx("textarea",{placeholder:"System instruction for this persona...",value:f.instruction,onChange:_=>c(v,"instruction",_.target.value),rows:3,className:"w-full p-2 text-sm bg-surface border border-border rounded-md"}),f.id!=="default"&&u.jsxs($e,{variant:"ghost",size:"sm",onClick:()=>m(v),className:"text-red-500",children:[u.jsx(ze,{name:"trash-2",className:"w-4 h-4 mr-2"})," Remove Persona"]})]},f.id)),u.jsxs($e,{variant:"ghost",size:"sm",onClick:d,children:[u.jsx(ze,{name:"plus",className:"w-4 h-4 mr-2"})," Add Persona"]})]})},p1=({onBack:n})=>u.jsxs("div",{className:"flex flex-col h-full overflow-hidden",children:[u.jsx("header",{className:"flex-shrink-0 flex justify-between items-center p-4 border-b border-border",children:u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx($e,{variant:"ghost",onClick:n,className:"p-1 h-auto",children:u.jsx(ze,{name:"chevron-left"})}),u.jsx("h2",{className:"text-xl font-bold",children:"Manage AI Options"})]})}),u.jsxs("main",{className:"flex-grow p-6 overflow-y-auto space-y-6 no-scrollbar",children:[u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[u.jsx(Qi,{title:"Understanding Levels",category:"understandingLevels"}),u.jsx(Qi,{title:"Comprehensiveness Levels",category:"comprehensivenessLevels"}),u.jsx(Qi,{title:"Learning Goals",category:"learningGoalOptions"}),u.jsx(Qi,{title:"Learning Styles",category:"learningStyleOptions"}),u.jsx(Qi,{title:"Languages",category:"languageOptions"}),u.jsx(Qi,{title:"Tones",category:"toneOptions"})]}),u.jsx("div",{className:"border-t border-border pt-6 pb-4",children:u.jsx(m1,{})})]})]}),g1=({isOpen:n,onClose:a,onStartAIGeneration:s,initialTopic:i,initialGenerationType:l,context:c})=>{const[d,m]=B.useState("main"),[p,f]=B.useState(i||(c==null?void 0:c.deckName)||""),[v,_]=B.useState(""),[T,x]=B.useState(c!=null&&c.seriesId?"series":"deck"),[k,w]=B.useState("quiz"),[S,C]=B.useState(10),[R,L]=B.useState(12),[F,G]=B.useState(1e4),[Q,U]=B.useState("none"),[j,O]=B.useState("default"),[q,ee]=B.useState("Auto"),[M,J]=B.useState("Standard"),{options:N}=Du(),{veoEnabled:se,groundedImagesEnabled:K,searchAuditsEnabled:P}=Za(),ve=B.useRef(null);Mn(ve,n);const{addToast:ce}=jn(),Ee=uo(),[z,I]=B.useState([]),[te,ae]=B.useState(!1),$=(c==null?void 0:c.mode)||"generate";B.useEffect(()=>{c!=null&&c.deckType&&(c.deckType===je.Flashcard?w("flashcard"):c.deckType===je.Learning?w("learning"):w("quiz"))},[c]),B.useEffect(()=>{i?f(i):c!=null&&c.deckName&&f(c.deckName)},[i,c]);const ue=!!(c!=null&&c.deckId),de=B.useMemo(()=>T==="deck"?[{value:"quiz",label:"Interactive Quiz",icon:"help-circle"},{value:"flashcard",label:"Flashcards",icon:"laptop"},{value:"vocab",label:"Vocabulary Builder",icon:"book-open"},{value:"atomic",label:"Atomic Concepts",icon:"zap"},{value:"blooms",label:"Bloom's Taxonomy Quiz",icon:"trending-up"},{value:"learning",label:"Learning Deck",icon:"layers"},{value:"course",label:"Course / Guide (Reader)",icon:"file-text"}]:[{value:"quiz",label:"Interactive Quizzes",icon:"help-circle"},{value:"flashcard",label:"Flashcards",icon:"laptop"},{value:"vocab",label:"Vocabulary Builder",icon:"book-open"},{value:"course",label:"Course / Guide (Reader)",icon:"file-text"}],[T]);B.useEffect(()=>{!ue&&!de.some(ne=>ne.value===k)&&w(de[0].value)},[T,de,k,ue]);const oe=async()=>{if(!(!(c!=null&&c.deckName)&&!(c!=null&&c.seriesName))){ae(!0);try{const ne=await t1({name:c.deckName||c.seriesName||"",description:c.seriesDescription,type:c.seriesId?"series":"deck"});I(ne)}catch{ce("Failed to get suggestions.","error")}finally{ae(!1)}}},le=()=>$==="rework"?"rework-deck":T==="deep-course"?"deep-course":T==="series"?k==="flashcard"?"series-flashcard":k==="vocab"?"series-vocab":k==="course"?"series-course":"series-quiz":k==="quiz"?"single-deck-quiz":k==="flashcard"?"deck-flashcard":k==="vocab"?"deck-vocab":k==="atomic"?"deck-atomic":k==="blooms"?"quiz-blooms":k==="learning"?"single-deck-learning":k==="course"?"deck-course":"single-deck-quiz",Le=()=>({generationType:le(),topic:p,persona:j,understanding:q,comprehensiveness:M,count:S,imageStyle:k==="flashcard"||k==="vocab"||k==="atomic"?Q:void 0,seriesId:c==null?void 0:c.seriesId,levelIndex:c==null?void 0:c.levelIndex,deckId:c==null?void 0:c.deckId,reworkInstructions:v.trim(),chapterCount:T==="deep-course"?R:void 0,targetWordCount:T==="deep-course"?F:void 0}),De=()=>{p.trim()&&s(Le())},Se=()=>{p.trim()&&Ee!=null&&Ee.handleImmediateAIGeneration&&(Ee.handleImmediateAIGeneration(Le()),a())};return n?u.jsx("div",{className:"fixed inset-0 bg-black/75 flex items-center justify-center z-[60] p-4",children:u.jsx("div",{ref:ve,className:"bg-surface rounded-lg shadow-xl w-full max-w-2xl transform transition-all relative h-full max-h-[90vh] overflow-hidden flex flex-col",children:d==="main"?u.jsxs("div",{className:"flex flex-col h-full overflow-hidden",children:[u.jsxs("header",{className:"flex-shrink-0 flex justify-between items-center p-4 border-b border-border",children:[u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx(ze,{name:$==="rework"?"refresh-ccw":T==="deep-course"?"book-open":"bot",className:"w-6 h-6 text-primary"}),u.jsx("h2",{className:"text-xl font-bold",children:$==="rework"?`Rework "${c==null?void 0:c.deckName}"`:c!=null&&c.deckId?`Expand "${c.deckName}"`:"Generate with AI"})]}),u.jsx($e,{type:"button",variant:"ghost",onClick:a,className:"p-1 h-auto",children:u.jsx(ze,{name:"x"})})]}),u.jsxs("main",{className:"flex-grow p-6 space-y-6 overflow-y-auto no-scrollbar",children:[!ue&&!(c!=null&&c.seriesId)&&u.jsxs("div",{className:"flex bg-background rounded-lg p-1 border border-border",children:[u.jsx("button",{type:"button",onClick:()=>x("deck"),className:`flex-1 py-2 rounded-md text-sm font-medium transition-colors ${T==="deck"?"bg-primary text-on-primary shadow-sm":"text-text-muted hover:text-text"}`,children:"Single Deck"}),u.jsx("button",{type:"button",onClick:()=>x("series"),className:`flex-1 py-2 rounded-md text-sm font-medium transition-colors ${T==="series"?"bg-primary text-on-primary shadow-sm":"text-text-muted hover:text-text"}`,children:"Full Series"}),u.jsx("button",{type:"button",onClick:()=>x("deep-course"),className:`flex-1 py-2 rounded-md text-sm font-medium transition-colors ${T==="deep-course"?"bg-indigo-600 text-on-primary shadow-sm":"text-text-muted hover:text-text"}`,children:"Deep Course "})]}),u.jsxs("div",{children:[u.jsxs("div",{className:"flex justify-between items-end mb-1",children:[u.jsx("label",{htmlFor:"topic",className:"block text-sm font-medium text-text-muted",children:$==="rework"?"Base Topic (Derived from Deck)":c!=null&&c.deckId?"Additional Topic / Context":"Topic"}),((c==null?void 0:c.deckName)||(c==null?void 0:c.seriesName))&&$!=="rework"&&u.jsxs("button",{type:"button",onClick:oe,disabled:te,className:"text-xs text-primary hover:underline flex items-center gap-1",children:[te?u.jsx(Zr,{size:"sm"}):u.jsx(ze,{name:"zap",className:"w-3 h-3"}),z.length>0?"Refresh Suggestions":"Get Suggestions"]})]}),u.jsx("input",{id:"topic",type:"text",value:p,onChange:ne=>f(ne.target.value),className:"w-full p-2 bg-background border border-border rounded-md focus:ring-2 focus:ring-primary focus:outline-none",placeholder:"e.g., The History of Ancient Rome",autoFocus:$!=="rework"}),z.length>0&&$!=="rework"&&u.jsx("div",{className:"flex flex-wrap gap-2 mt-2 animate-fade-in",children:z.map((ne,E)=>u.jsx("button",{type:"button",onClick:()=>f(ne),className:"text-xs px-2 py-1 bg-primary/10 text-primary rounded-full hover:bg-primary/20 transition-colors border border-primary/20",children:ne},E))})]}),$==="rework"&&u.jsxs("div",{className:"animate-fade-in",children:[u.jsx("label",{htmlFor:"rework-instructions",className:"block text-sm font-medium text-text-muted mb-1",children:"Focus for Rework"}),u.jsx("textarea",{id:"rework-instructions",value:v,onChange:ne=>_(ne.target.value),rows:3,className:"w-full p-2 bg-background border border-border rounded-md focus:ring-2 focus:ring-primary focus:outline-none text-sm",placeholder:"e.g., Make the questions much harder, add more practical examples, or simplify the language for a child.",autoFocus:!0})]}),T==="deep-course"&&u.jsxs("div",{className:"space-y-4 p-4 bg-indigo-50 dark:bg-indigo-950/20 rounded-lg border border-indigo-200 dark:border-indigo-800 animate-fade-in",children:[u.jsxs("h3",{className:"text-xs font-bold text-indigo-600 dark:text-indigo-400 uppercase tracking-widest flex items-center gap-2",children:[u.jsx(ze,{name:"settings",className:"w-3 h-3"})," Course Architect Settings"]}),u.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[u.jsxs("div",{children:[u.jsxs("label",{className:"block text-sm font-medium text-text-muted mb-2 flex justify-between",children:[u.jsx("span",{children:"Chapters"}),u.jsx("span",{className:"font-bold text-indigo-600",children:R})]}),u.jsx("input",{type:"range",min:"5",max:"30",step:"1",value:R,onChange:ne=>L(Number(ne.target.value)),className:"w-full accent-indigo-600"})]}),u.jsxs("div",{children:[u.jsxs("label",{className:"block text-sm font-medium text-text-muted mb-2 flex justify-between",children:[u.jsx("span",{children:"Target Word Count"}),u.jsxs("span",{className:"font-bold text-indigo-600",children:[(F/1e3).toFixed(1),"k"]})]}),u.jsx("input",{type:"range",min:"3000",max:"30000",step:"1000",value:F,onChange:ne=>G(Number(ne.target.value)),className:"w-full accent-indigo-600"})]})]}),u.jsx("p",{className:"text-[10px] text-text-muted italic",children:"This mode uses a multi-stage generation process to create a complete course book. It may take several minutes to complete."})]}),!ue&&T!=="deep-course"&&u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-text-muted mb-2",children:"Content Style"}),u.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2",children:de.map(ne=>u.jsxs("button",{type:"button",onClick:()=>w(ne.value),className:`flex items-center gap-3 p-3 rounded-lg border text-left transition-all ${k===ne.value?"border-primary bg-primary/5 ring-1 ring-primary":"border-border bg-background hover:border-primary/50"}`,children:[u.jsx("div",{className:`p-2 rounded-full ${k===ne.value?"bg-primary text-on-primary":"bg-surface text-text-muted"}`,children:u.jsx(ze,{name:ne.icon,className:"w-4 h-4"})}),u.jsx("span",{className:`text-sm font-medium ${k===ne.value?"text-primary":"text-text"}`,children:ne.label})]},ne.value))})]}),T==="deck"&&u.jsx("div",{className:"space-y-4",children:k==="learning"||k==="course"?u.jsxs("div",{children:[u.jsx("label",{htmlFor:"comprehensiveness",className:"block text-sm font-medium text-text-muted mb-1",children:"Depth of Content"}),u.jsx("select",{id:"comprehensiveness",value:M,onChange:ne=>J(ne.target.value),className:"w-full p-2 bg-background border border-border rounded-md focus:ring-2 focus:ring-primary focus:outline-none",children:N.comprehensivenessLevels.map(ne=>u.jsxs("option",{value:ne,children:[ne," ",ne==="Exhaustive"?"(Min 20 Chapters)":""]},ne))})]}):u.jsxs("div",{children:[u.jsxs("label",{className:"block text-sm font-medium text-text-muted mb-3 flex justify-between",children:[u.jsxs("span",{children:["Number of items ",$==="rework"?"to maintain":"to generate"]}),u.jsx("span",{className:"font-bold text-primary",children:S})]}),u.jsxs("div",{className:"flex items-center gap-4",children:[u.jsx("input",{type:"range",min:"5",max:"50",step:"5",value:S,onChange:ne=>C(Number(ne.target.value)),className:"flex-grow accent-primary"}),u.jsx("div",{className:"flex gap-1",children:[5,10,20,50].map(ne=>u.jsx("button",{type:"button",onClick:()=>C(ne),className:`px-2 py-1 text-[10px] font-bold rounded border transition-colors ${S===ne?"bg-primary text-on-primary border-primary":"border-border text-text-muted hover:border-primary"}`,children:ne},ne))})]})]})}),u.jsxs("div",{className:"space-y-4 pt-4 border-t border-border",children:[(k==="flashcard"||k==="vocab"||k==="atomic")&&T!=="deep-course"&&u.jsxs("div",{className:"animate-fade-in",children:[u.jsx("label",{htmlFor:"image-style",className:"block text-sm font-medium text-text-muted mb-1",children:"Image Generation"}),u.jsxs("select",{id:"image-style",value:Q,onChange:ne=>U(ne.target.value),className:"w-full p-2 bg-background border border-border rounded-md focus:ring-2 focus:ring-primary focus:outline-none",children:[u.jsx("option",{value:"none",children:"No Images"}),u.jsx("option",{value:"realistic",children:"Find Realistic Images"}),u.jsx("option",{value:"creative",children:"Generate Creative Images"})]})]}),u.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[u.jsxs("div",{children:[u.jsx("label",{htmlFor:"persona",className:"block text-sm font-medium text-text-muted mb-1",children:"AI Persona"}),u.jsx("select",{id:"persona",value:j,onChange:ne=>O(ne.target.value),className:"w-full p-2 bg-background border border-border rounded-md focus:ring-2 focus:ring-primary focus:outline-none",children:N.personas.map(ne=>u.jsx("option",{value:ne.id,children:ne.name},ne.id))})]}),u.jsxs("div",{children:[u.jsx("label",{htmlFor:"understanding",className:"block text-sm font-medium text-text-muted mb-1",children:"My Current Level Is"}),u.jsx("select",{id:"understanding",value:q,onChange:ne=>ee(ne.target.value),className:"w-full p-2 bg-background border border-border rounded-md focus:ring-2 focus:ring-primary focus:outline-none",children:N.understandingLevels.map(ne=>u.jsx("option",{value:ne,children:ne},ne))})]})]}),!(k==="learning"||k==="course"||T==="deep-course")&&u.jsxs("div",{children:[u.jsx("label",{htmlFor:"comprehensiveness-shared",className:"block text-sm font-medium text-text-muted mb-1",children:"Desired Comprehensiveness"}),u.jsx("select",{id:"comprehensiveness-shared",value:M,onChange:ne=>J(ne.target.value),className:"w-full p-2 bg-background border border-border rounded-md focus:ring-2 focus:ring-primary focus:outline-none",children:N.comprehensivenessLevels.map(ne=>u.jsx("option",{value:ne,children:ne},ne))})]})]})]}),u.jsxs("footer",{className:"flex-shrink-0 flex flex-wrap justify-between items-center p-4 bg-background/50 border-t border-border gap-2",children:[u.jsx($e,{type:"button",variant:"ghost",onClick:()=>m("options"),children:"Options"}),u.jsxs("div",{className:"flex gap-2",children:[u.jsxs($e,{type:"button",variant:"secondary",onClick:De,disabled:!p.trim()||$==="rework"&&!v.trim(),children:[u.jsx(ze,{name:"bot",className:"w-4 h-4 mr-2"}),"Chat & Refine"]}),u.jsxs($e,{type:"button",variant:"primary",onClick:Se,disabled:!p.trim()||$==="rework"&&!v.trim(),children:[u.jsx(ze,{name:"zap",className:"w-5 h-5 mr-2"}),"Generate Now"]})]})]})]}):u.jsx("div",{className:"flex flex-col h-full overflow-hidden",children:u.jsx(p1,{onBack:()=>m("main")})})})}):null},y1=({isOpen:n,onClose:a,onCancel:s})=>{const{currentTask:i,queue:l,streamingDrafts:c,chapterPhases:d}=Ze(x=>x.aiGenerationStatus),m=Ze(x=>x.decks),p=B.useRef(null);Mn(p,n);const f=()=>{s()},v=x=>{s(x)},_=B.useMemo(()=>{if((i==null?void 0:i.type)!=="generateDeepCourse"||!i.deckId)return null;const x=m[i.deckId];return!x||!x.curriculum?null:x.curriculum.chapters.map(w=>({...w,phase:d[w.id]||"queued"}))},[i,m,d]);if(!n)return null;const T=x=>{switch(x){case"complete":return"bg-green-500 shadow-[0_0_8px_rgba(34,197,94,0.4)]";case"drafting":return"bg-blue-400 animate-pulse";case"auditing":return"bg-amber-400 animate-pulse";case"illustrating":return"bg-purple-400 animate-pulse";case"finalizing":return"bg-primary animate-pulse";case"failed":return"bg-red-500";default:return"bg-border"}};return u.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-[60] p-4",children:u.jsxs("div",{ref:p,className:"bg-surface rounded-lg shadow-xl w-full max-w-xl transform transition-all relative max-h-[85vh] flex flex-col",role:"dialog","aria-modal":"true","aria-labelledby":"ai-status-title",children:[u.jsxs("div",{className:"flex-shrink-0 flex justify-between items-center p-4 border-b border-border",children:[u.jsxs("h2",{id:"ai-status-title",className:"text-xl font-bold text-text flex items-center gap-2",children:[u.jsx(ze,{name:"bot",className:"text-primary w-6 h-6"}),"AI Pipeline"]}),u.jsx($e,{type:"button",variant:"ghost",onClick:a,className:"p-1 h-auto","aria-label":"Close",children:u.jsx(ze,{name:"x"})})]}),u.jsxs("div",{className:"p-6 overflow-y-auto space-y-8 no-scrollbar",children:[u.jsxs("section",{children:[u.jsxs("div",{className:"flex items-center justify-between mb-4",children:[u.jsx("h3",{className:"text-xs font-bold uppercase tracking-widest text-text-muted",children:"Active Process"}),i&&u.jsx("span",{className:"text-[10px] bg-primary/10 text-primary px-2 py-0.5 rounded-full font-bold animate-pulse",children:"AGENT RUNNING"})]}),u.jsx("div",{className:"bg-background/50 border border-border rounded-xl p-5 shadow-inner",children:i?u.jsxs("div",{className:"space-y-4",children:[u.jsxs("div",{className:"flex items-start gap-4",children:[u.jsx("div",{className:"p-3 bg-primary/10 rounded-full",children:u.jsx(Zr,{size:"sm"})}),u.jsxs("div",{className:"flex-grow min-w-0",children:[u.jsx("p",{className:"text-sm font-bold text-text truncate mb-1",children:i.type==="generateDeepCourse"?"Synthesizing Hyper-Course":"Standard Generation"}),u.jsx("p",{className:"text-xs text-text-muted leading-relaxed",children:i.statusText||"Executing instructional logic..."})]}),u.jsx($e,{variant:"danger",size:"sm",onClick:f,className:"flex-shrink-0",children:"Abort"})]}),_&&u.jsxs("div",{className:"pt-4 border-t border-border/50",children:[u.jsx("p",{className:"text-[10px] font-bold text-text-muted uppercase mb-3",children:"Project Blueprint"}),u.jsx("div",{className:"grid grid-cols-5 gap-2",children:_.map((x,k)=>u.jsx("div",{title:`${k+1}. ${x.title} (${x.phase})`,className:`h-2.5 rounded-full transition-all duration-500 ${T(x.phase)}`},x.id))}),u.jsxs("div",{className:"flex justify-between mt-3 text-[9px] text-text-muted font-mono uppercase",children:[u.jsxs("div",{className:"flex items-center gap-1",children:[u.jsx("span",{className:"w-2 h-2 rounded-full bg-blue-400"})," Draft"]}),u.jsxs("div",{className:"flex items-center gap-1",children:[u.jsx("span",{className:"w-2 h-2 rounded-full bg-amber-400"})," Audit"]}),u.jsxs("div",{className:"flex items-center gap-1",children:[u.jsx("span",{className:"w-2 h-2 rounded-full bg-purple-400"})," Visual"]}),u.jsxs("div",{className:"flex items-center gap-1",children:[u.jsx("span",{className:"w-2 h-2 rounded-full bg-green-500"})," Done"]})]})]})]}):u.jsxs("div",{className:"text-center py-6",children:[u.jsx(ze,{name:"check-circle",className:"w-10 h-10 text-text-muted/30 mx-auto mb-2"}),u.jsx("p",{className:"text-sm text-text-muted",children:"No active background processes."})]})})]}),l&&l.length>0&&u.jsxs("section",{children:[u.jsxs("h3",{className:"text-xs font-bold uppercase tracking-widest text-text-muted mb-3",children:["Waitlist (",l.length,")"]}),u.jsx("ul",{className:"space-y-2",children:l.map(x=>u.jsxs("li",{className:"bg-background border border-border p-3 rounded-lg flex items-center justify-between gap-4 group transition-colors hover:border-primary/30",children:[u.jsxs("div",{className:"flex items-center gap-3 min-w-0",children:[u.jsx(ze,{name:"layers",className:"w-4 h-4 text-text-muted/50"}),u.jsx("p",{className:"text-text text-xs font-medium truncate",children:x.statusText})]}),u.jsx("button",{onClick:()=>v(x.id),className:"text-text-muted hover:text-red-500 opacity-0 group-hover:opacity-100 transition-all p-1","aria-label":"Remove from queue",children:u.jsx(ze,{name:"x-circle",className:"w-4 h-4"})})]},x.id))})]}),u.jsx("div",{className:"bg-primary/5 rounded-lg p-4 border border-primary/10",children:u.jsxs("div",{className:"flex gap-3",children:[u.jsx(ze,{name:"info",className:"w-5 h-5 text-primary flex-shrink-0"}),u.jsxs("p",{className:"text-xs text-text-muted leading-relaxed",children:["The ",u.jsx("b",{children:"Hyper-Course Engine"})," uses multiple agent passes. First, it architects a curriculum, then parallel agents draft chapters, followed by search-grounded audits and visual enrichment. Closing this modal will not stop the process."]})]})})]}),u.jsx("div",{className:"flex-shrink-0 flex justify-end p-4 bg-background/50 border-t border-border",children:u.jsx($e,{type:"button",variant:"primary",onClick:a,className:"px-8",children:"Done"})})]})})},v1="cogniflow-sync";let oh=null;const h0=()=>(oh||(oh=new BroadcastChannel(v1)),oh),ca=()=>{h0().postMessage({type:"data-changed"})},b1=n=>{const a=h0(),s=()=>{n()};return a.addEventListener("message",s),()=>{a.removeEventListener("message",s)}},Uh="CogniFlowDB",lh=9,Wn="decks",zn="folders",er="deckSeries",Tn="sessions",_n="reviews",oa="ai_chat",sr="seriesProgress",Dr="learningProgress",x1=(n,a=20,s=5e3)=>{let i=0,l=Date.now(),c=!1;const d=(m,...p)=>{const f=Date.now();if(f-l>s&&(i=0,l=f,c&&console.warn(`[${n}] Logger is now unmuted after timeout.`),c=!1),!c){if(i++,i>a){console.error(`[${n}] Logger muted: Too many logs in a short time window (${a} logs in <${s}ms). This may indicate a serious issue like a data corruption loop or a repeated failed operation. Further logs from this source will be suppressed for a short time to prevent app overload.`),c=!0;return}console[m](`[${n}]`,...p)}};return{log:(...m)=>d("log",...m),warn:(...m)=>d("warn",...m),error:(...m)=>d("error",...m)}},ct=x1("DB");let ya=null;function At(){return ya||(ya=new Promise((n,a)=>{ct.log(`Initializing IndexedDB: ${Uh} v${lh}...`);const s=typeof indexedDB<"u"?indexedDB:typeof window<"u"?window.indexedDB:void 0;if(!s){const l="IndexedDB is not supported in this environment.";return ct.warn(`${l}`),a(new Error(l))}const i=s.open(Uh,lh);i.onblocked=l=>{const c="Database upgrade is required, but it is blocked by another open tab. Please close other tabs and reload.";ct.warn("IndexedDB open request blocked.",l),a(new Error(c))},i.onerror=l=>{l&&typeof l.preventDefault=="function"&&l.preventDefault();const c=i.error,d=c?c.message:"Unknown error";ct.warn(`IndexedDB failed to open: ${d}. Falling back to localStorage.`),ya=null,a(new Error(`Could not open the database: ${d}`))},i.onsuccess=()=>{const l=i.result;l.onversionchange=()=>{l.close(),ya=null,console.warn("Database version changed in another tab. Closing connection.")},ct.log("IndexedDB connection successful."),l.onclose=()=>{ya=null,ct.warn("Database connection closed.")},n(l)},i.onupgradeneeded=l=>{var m;const c=l.target.result,d=l.target.transaction;if(ct.log(`Upgrading database from version ${l.oldVersion} to ${lh}`),!d){ct.error("Upgrade transaction is not available, aborting upgrade."),l.target&&((m=l.target.transaction)==null||m.abort());return}switch(l.oldVersion){case 0:c.objectStoreNames.contains(Wn)||c.createObjectStore(Wn,{keyPath:"id"}),c.objectStoreNames.contains(zn)||c.createObjectStore(zn,{keyPath:"id"});case 1:case 2:c.objectStoreNames.contains(er)||c.createObjectStore(er,{keyPath:"id"});case 3:c.objectStoreNames.contains(Tn)||c.createObjectStore(Tn,{keyPath:"id"});case 4:c.objectStoreNames.contains(_n)||c.createObjectStore(_n,{autoIncrement:!0}).createIndex("timestamp","timestamp",{unique:!1});case 5:const p=d.objectStore(_n);p.indexNames.contains("deckId")||p.createIndex("deckId","deckId",{unique:!1});case 6:c.objectStoreNames.contains(oa)||c.createObjectStore(oa,{keyPath:"id"});case 7:c.objectStoreNames.contains(sr)||c.createObjectStore(sr,{keyPath:"id"});case 8:c.objectStoreNames.contains(Dr)||c.createObjectStore(Dr,{keyPath:"deckId"});default:ct.log("Database upgrade sequence complete.")}}}),ya)}async function m0(){const n=await At();return new Promise((a,s)=>{const c=n.transaction(Wn,"readonly").objectStore(Wn).getAll();c.onerror=()=>{ct.error("DB Error fetching all decks:",c.error),s(new Error("Error fetching decks from the database."))},c.onsuccess=()=>{const d=c.result,m=Array.isArray(d)?d:[];a(m)}})}async function p0(n){if(n.length===0)return;const a=await At();return new Promise((s,i)=>{const l=a.transaction(Wn,"readwrite"),c=l.objectStore(Wn);l.oncomplete=()=>{ca(),s()},l.onerror=()=>{ct.error("Transaction error adding/updating decks",l.error),i(new Error("Transaction error adding/updating decks."))},n.forEach(d=>{const m=c.put(d);m.onerror=()=>{ct.error(`Error putting deck ${d.name}`,m.error)}})})}async function _1(n){await p0(n)}async function S1(n){const a=await At();return new Promise((s,i)=>{const l=a.transaction(Wn,"readwrite");l.oncomplete=()=>{ca(),s()},l.onerror=()=>{ct.error("Transaction error deleting deck",l.error),i(new Error("Transaction error deleting deck."))},l.objectStore(Wn).delete(n)})}async function w1(n){const a=await At();return new Promise((s,i)=>{const l=a.transaction(Wn,"readwrite");l.oncomplete=()=>{ca(),s()},l.onerror=()=>{ct.error("Transaction error updating deck",l.error),i(new Error("Transaction error updating deck."))},l.objectStore(Wn).put(n)})}async function E1(){const n=await At();return new Promise((a,s)=>{const c=n.transaction(zn,"readonly").objectStore(zn).getAll();c.onerror=()=>{ct.error("DB Error fetching all folders:",c.error),s(new Error("Error fetching folders from the database."))},c.onsuccess=()=>{const d=c.result,m=Array.isArray(d)?d:[];a(m)}})}async function T1(n){const a=await At();return new Promise((s,i)=>{const l=a.transaction(zn,"readwrite");l.oncomplete=()=>{ca(),s()},l.onerror=()=>{ct.error("Transaction error adding folder",l.error),i(new Error("Transaction error adding folder."))},l.objectStore(zn).add(n)})}async function A1(n){if(n.length===0)return;const a=await At();return new Promise((s,i)=>{const l=a.transaction(zn,"readwrite");l.oncomplete=()=>{ca(),s()},l.onerror=()=>{ct.error("Transaction error adding/updating folders",l.error),i(new Error("Transaction error adding/updating folders."))};const c=l.objectStore(zn);n.forEach(d=>{const m=c.put(d);m.onerror=()=>{ct.error(`Error putting folder ${d.name}`,m.error)}})})}async function k1(n){const a=await At();return new Promise((s,i)=>{const l=a.transaction(zn,"readwrite");l.oncomplete=()=>{ca(),s()},l.onerror=()=>{ct.error("Transaction error updating folder",l.error),i(new Error("Transaction error updating folder."))},l.objectStore(zn).put(n)})}async function C1(n){const a=await At();return new Promise((s,i)=>{const l=a.transaction(zn,"readwrite");l.oncomplete=()=>{ca(),s()},l.onerror=()=>{ct.error("Transaction error deleting folder",l.error),i(new Error("Transaction error deleting folder."))},l.objectStore(zn).delete(n)})}async function N1(){const n=await At();return new Promise((a,s)=>{const c=n.transaction(er,"readonly").objectStore(er).getAll();c.onerror=()=>{ct.error("DB Error fetching all series:",c.error),s(new Error("Error fetching deck series from the database."))},c.onsuccess=()=>{const d=c.result,m=Array.isArray(d)?d:[];a(m)}})}async function D1(n){if(n.length===0)return;const a=await At();return new Promise((s,i)=>{const l=a.transaction(er,"readwrite");l.oncomplete=()=>{ca(),s()},l.onerror=()=>{ct.error("Transaction error adding deck series",l.error),i(new Error("Transaction error adding deck series."))};const c=l.objectStore(er);n.forEach(d=>c.put(d))})}async function O1(n){const a=await At();return new Promise((s,i)=>{const l=a.transaction(er,"readwrite");l.oncomplete=()=>{ca(),s()},l.onerror=()=>{ct.error("Transaction error updating deck series",l.error),i(new Error("Error updating deck series."))},l.objectStore(er).put(n)})}async function j1(n){const a=await At();return new Promise((s,i)=>{const l=a.transaction(er,"readwrite");l.oncomplete=()=>{ca(),s()},l.onerror=()=>{ct.error("Transaction error deleting deck series",l.error),i(new Error("Error deleting deck series."))},l.objectStore(er).delete(n)})}async function I1(n,a){const s=await At();return new Promise((i,l)=>{const c=s.transaction(Tn,"readwrite");c.oncomplete=()=>i(),c.onerror=()=>{ct.error("Transaction error saving session state",c.error),l(new Error("Transaction error saving session state."))},c.objectStore(Tn).put({id:n,...a})})}async function R1(n){const a=await At();return new Promise((s,i)=>{const d=a.transaction(Tn,"readonly").objectStore(Tn).get(n);d.onerror=()=>{ct.error("DB Error fetching session state",d.error),i(new Error("Error fetching session state."))},d.onsuccess=()=>s(d.result||null)})}async function M1(){const n=await At();return new Promise((a,s)=>{const c=n.transaction(Tn,"readonly").objectStore(Tn).getAll();c.onsuccess=()=>{const d=c.result,m=Array.isArray(d)?d:[];a(m)},c.onerror=()=>{ct.error("Failed to get all sessions.",c.error),s(new Error("Failed to get all sessions."))}})}async function U1(){const n=await At();return new Promise((a,s)=>{const c=n.transaction(Tn,"readwrite").objectStore(Tn).clear();c.onsuccess=()=>a(),c.onerror=()=>{ct.error("Failed to clear sessions.",c.error),s(new Error("Failed to clear sessions."))}})}async function L1(n){if(n.length===0)return;const a=await At();return new Promise((s,i)=>{const l=a.transaction(Tn,"readwrite"),c=l.objectStore(Tn);l.oncomplete=()=>s(),l.onerror=()=>{ct.error("Transaction error adding sessions.",l.error),i(new Error("Transaction error adding sessions."))},n.forEach(d=>c.put(d))})}async function z1(n){const a=await At();return new Promise((s,i)=>{const l=a.transaction(Tn,"readwrite");l.oncomplete=()=>s(),l.onerror=()=>{ct.error("Transaction error deleting session state",l.error),i(new Error("Transaction error deleting session state."))},l.objectStore(Tn).delete(n)})}async function F1(){const n=await At();return new Promise((a,s)=>{const c=n.transaction(Tn,"readonly").objectStore(Tn).getAllKeys();c.onerror=()=>{ct.error("DB Error fetching session keys",c.error),s(new Error("Error fetching session keys."))},c.onsuccess=()=>a(c.result)})}async function Qh(n){const a=await At();return new Promise((s,i)=>{const d=a.transaction(n,"readwrite").objectStore(n).clear();d.onsuccess=()=>s(),d.onerror=()=>{ct.error(`Failed to clear object store: ${n}`,d.error),i(new Error(`Failed to clear object store: ${n}.`))}})}const B1=()=>Qh(Wn),H1=()=>Qh(zn),G1=()=>Qh(er);async function q1(n){const a=await At();return new Promise((s,i)=>{const d=a.transaction(Dr,"readwrite").objectStore(Dr).put(n);d.onsuccess=()=>s(),d.onerror=()=>{ct.error("Failed to save learning progress.",d.error),i(new Error("Failed to save learning progress."))}})}async function P1(){const n=await At();return new Promise((a,s)=>{const c=n.transaction(Dr,"readonly").objectStore(Dr).getAll();c.onsuccess=()=>{const d={};(Array.isArray(c.result)?c.result:[]).forEach(p=>{d[p.deckId]=p}),a(d)},c.onerror=()=>{ct.error("Failed to get learning progress.",c.error),s(new Error("Failed to get learning progress."))}})}async function $1(n){if(Object.keys(n).length===0)return;const a=await At();return new Promise((s,i)=>{const l=a.transaction(Dr,"readwrite"),c=l.objectStore(Dr);l.oncomplete=()=>s(),l.onerror=()=>{ct.error("Transaction error adding learning progress.",l.error),i(new Error("Transaction error adding learning progress."))},Object.values(n).forEach(d=>{c.put(d)})})}async function js(){const n=await At();return new Promise((a,s)=>{const i=[Wn,zn,er,_n,Tn,sr,Dr],l=n.transaction(i,"readonly"),c={decks:l.objectStore(Wn).getAll(),folders:l.objectStore(zn).getAll(),deckSeries:l.objectStore(er).getAll(),reviews:l.objectStore(_n).getAll(),sessions:l.objectStore(Tn).getAll(),seriesProgress:l.objectStore(sr).getAll(),learningProgress:l.objectStore(Dr).getAll()};l.oncomplete=()=>{const d={};(Array.isArray(c.seriesProgress.result)?c.seriesProgress.result:[]).forEach(v=>{d[v.id]=v.completedDeckIds});const p={};(Array.isArray(c.learningProgress.result)?c.learningProgress.result:[]).forEach(v=>{p[v.deckId]=v}),a({decks:Array.isArray(c.decks.result)?c.decks.result:[],folders:Array.isArray(c.folders.result)?c.folders.result:[],deckSeries:Array.isArray(c.deckSeries.result)?c.deckSeries.result:[],reviews:Array.isArray(c.reviews.result)?c.reviews.result:[],sessions:Array.isArray(c.sessions.result)?c.sessions.result:[],seriesProgress:d,learningProgress:p})},l.onerror=()=>{ct.error("Transaction error in getAllDataForBackup",l.error),s(new Error("Database transaction failed while gathering backup data."))}})}async function Y1(n){const a=await At();return new Promise((s,i)=>{const l=a.transaction(_n,"readwrite");l.oncomplete=()=>s(),l.onerror=()=>{ct.error("Transaction error adding review log",l.error),i(new Error("Transaction error adding review log."))},l.objectStore(_n).add(n)})}async function V1(n){const a=await At();return new Promise((s,i)=>{const d=a.transaction(_n,"readonly").objectStore(_n).index("timestamp"),m=IDBKeyRange.lowerBound(n.toISOString()),p=d.getAll(m);p.onerror=()=>{ct.error("DB Error fetching review logs",p.error),i(new Error("Error fetching review logs."))},p.onsuccess=()=>s(p.result)})}async function K1(){const n=await At();return new Promise((a,s)=>{const c=n.transaction(_n,"readonly").objectStore(_n).getAll();c.onerror=()=>{ct.error("DB Error fetching all reviews:",c.error),s(new Error("Error fetching all reviews from the database."))},c.onsuccess=()=>{const d=c.result,m=Array.isArray(d)?d:[];a(m)}})}async function Z1(){const n=await At();return new Promise((a,s)=>{const c=n.transaction(_n,"readwrite").objectStore(_n).clear();c.onsuccess=()=>a(),c.onerror=d=>{ct.error("Failed to clear review logs",c.error),s(new Error("Failed to clear review logs."))}})}async function Q1(n){if(n.length===0)return;const a=await At();return new Promise((s,i)=>{const l=a.transaction(_n,"readwrite"),d=l.objectStore(_n).index("deckId"),m=new Set(n),p=d.openCursor();p.onsuccess=()=>{const f=p.result;f&&(m.has(String(f.value.deckId))&&f.delete(),f.continue())},l.oncomplete=()=>s(),l.onerror=()=>{ct.error("Transaction error deleting reviews for decks",l.error),i(new Error("Failed to delete review logs."))}})}async function J1(n){if(n.length===0)return;const a=await At();return new Promise((s,i)=>{const l=a.transaction(_n,"readwrite"),c=l.objectStore(_n);l.oncomplete=()=>s(),l.onerror=()=>{ct.error("Transaction error adding review logs",l.error),i(new Error("Transaction error adding review logs."))},n.forEach(d=>{const{id:m,...p}=d;c.add(p)})})}async function X1(n){const a=await At();return new Promise((s,i)=>{const m=a.transaction(_n,"readonly").objectStore(_n).index("deckId").getAll(n);m.onerror=()=>{ct.error(`DB Error fetching reviews for deck ${n}`,m.error),i(new Error(`Error fetching reviews for deck ${n}.`))},m.onsuccess=()=>s(m.result)})}async function g0(n){const a=await At();return new Promise((s,i)=>{const d=a.transaction(oa,"readwrite").objectStore(oa).put({id:"global_history",history:n});d.onsuccess=()=>s(),d.onerror=()=>{ct.error("Failed to save AI chat history.",d.error),i(new Error("Failed to save AI chat history."))}})}async function Ou(){const n=await At();return new Promise((a,s)=>{const c=n.transaction(oa,"readonly").objectStore(oa).get("global_history");c.onsuccess=()=>{var d;a(((d=c.result)==null?void 0:d.history)||[])},c.onerror=()=>{ct.error("Failed to get AI chat history.",c.error),s(new Error("Failed to get AI chat history."))}})}async function W1(){const n=await At();return new Promise((a,s)=>{const c=n.transaction(oa,"readwrite").objectStore(oa).clear();c.onsuccess=()=>a(),c.onerror=()=>{ct.error("Failed to clear AI chat history.",c.error),s(new Error("Failed to clear AI chat history."))}})}async function e2(n,a){const s=await At();return new Promise((i,l)=>{const m=s.transaction(sr,"readwrite").objectStore(sr).put({id:n,completedDeckIds:Array.from(a)});m.onsuccess=()=>i(),m.onerror=()=>{ct.error("Failed to save series progress.",m.error),l(new Error("Failed to save series progress."))}})}async function t2(){const n=await At();return new Promise((a,s)=>{const c=n.transaction(sr,"readonly").objectStore(sr).getAll();c.onsuccess=()=>{const d={};(Array.isArray(c.result)?c.result:[]).forEach(p=>{d[p.id]=p.completedDeckIds}),a(d)},c.onerror=()=>{ct.error("Failed to get all series progress.",c.error),s(new Error("Failed to get all series progress."))}})}async function n2(){const n=await At();return new Promise((a,s)=>{const c=n.transaction(sr,"readwrite").objectStore(sr).clear();c.onsuccess=()=>a(),c.onerror=()=>{ct.error("Failed to clear series progress.",c.error),s(new Error("Failed to clear series progress."))}})}async function r2(n){if(Object.keys(n).length===0)return;const a=await At();return new Promise((s,i)=>{const l=a.transaction(sr,"readwrite"),c=l.objectStore(sr);l.oncomplete=()=>s(),l.onerror=()=>{ct.error("Transaction error adding series progress.",l.error),i(new Error("Transaction error adding series progress."))},Object.entries(n).forEach(([d,m])=>{c.put({id:d,completedDeckIds:m})})})}async function y0(){if(typeof window>"u")return null;const{decks:n,folders:a,deckSeries:s,reviews:i,sessions:l,seriesProgress:c,learningProgress:d}=await js();if(n.length===0&&a.length===0&&s.length===0)throw new Error("There is no data to export.");const m=localStorage.getItem("cogniflow-ai-options"),p=m?JSON.parse(m):void 0,f=await Ou(),v={};Object.entries({themeId:"cogniflow-themeId",disableAnimations:"cogniflow-disableAnimations",hapticsEnabled:"cogniflow-hapticsEnabled",aiFeaturesEnabled:"cogniflow-aiFeaturesEnabled",veoEnabled:"cogniflow-veoEnabled",groundedImagesEnabled:"cogniflow-groundedImagesEnabled",searchAuditsEnabled:"cogniflow-searchAuditsEnabled",backupEnabled:"cogniflow-backupEnabled",backupApiKey:"cogniflow-backupApiKey",syncOnCellular:"cogniflow-syncOnCellular",notificationsEnabled:"cogniflow-notificationsEnabled",leechThreshold:"cogniflow-leechThreshold",leechAction:"cogniflow-leechAction",fontFamily:"cogniflow-fontFamily",encryptionPassword:"cogniflow-encryptionPassword"}).forEach(([R,L])=>{const F=localStorage.getItem(L);if(F!==null)try{["disableAnimations","hapticsEnabled","aiFeaturesEnabled","veoEnabled","groundedImagesEnabled","searchAuditsEnabled","backupEnabled","syncOnCellular","notificationsEnabled"].includes(R)?v[R]=JSON.parse(F):["leechThreshold"].includes(R)?v[R]=Number(F):v[R]=F}catch{v[R]=F}});const T={version:9,decks:n,folders:a,deckSeries:s,reviews:i,sessions:l,aiChatHistory:f,seriesProgress:c,learningProgress:d,settings:v};p&&(T.aiOptions=p);const x=JSON.stringify(T,null,2),k=new Blob([x],{type:"application/json"}),w=URL.createObjectURL(k),S=document.createElement("a");S.style.display="none",S.href=w;const C=Zh();return S.download=`cogniflow-backup-${C}.json`,document.body.appendChild(S),S.click(),window.URL.revokeObjectURL(w),document.body.removeChild(S),S.download}async function pl(n){const a=await At();return new Promise((s,i)=>{ct.log("Starting atomic restore.");const l=[Wn,zn,er,_n,Tn,oa,sr,Dr],c=a.transaction(l,"readwrite");c.oncomplete=()=>{ca(),s()},c.onerror=()=>{ct.error("Atomic restore transaction failed:",c.error),i(new Error("Database transaction failed during restore."))};try{c.objectStore(Wn).clear(),c.objectStore(zn).clear(),c.objectStore(er).clear(),c.objectStore(_n).clear(),c.objectStore(Tn).clear(),c.objectStore(oa).clear(),c.objectStore(sr).clear(),c.objectStore(Dr).clear(),(n.decks||[]).forEach(d=>c.objectStore(Wn).put(d)),(n.folders||[]).forEach(d=>c.objectStore(zn).put(d)),(n.deckSeries||[]).forEach(d=>c.objectStore(er).put(d)),(n.reviews||[]).forEach(d=>{const{id:m,...p}=d;c.objectStore(_n).add(p)}),(n.sessions||[]).forEach(d=>c.objectStore(Tn).put(d)),n.aiChatHistory&&n.aiChatHistory.length>0&&c.objectStore(oa).put({id:"global_history",history:n.aiChatHistory}),Object.entries(n.seriesProgress||{}).forEach(([d,m])=>{c.objectStore(sr).put({id:d,completedDeckIds:m})}),Object.values(n.learningProgress||{}).forEach(d=>{c.objectStore(Dr).put(d)})}catch(d){c.abort(),i(d)}})}async function a2(){if(ya){try{(await ya).close()}catch{}ya=null}return new Promise((n,a)=>{const s=indexedDB.deleteDatabase(Uh);s.onerror=()=>a(new Error("Error deleting database.")),s.onsuccess=()=>n(),s.onblocked=()=>a(new Error("Deletion blocked. Please close other tabs."))})}const s2=Object.freeze(Object.defineProperty({__proto__:null,addDeckSeries:D1,addDecks:p0,addFolder:T1,addFolders:A1,addReviewLog:Y1,bulkAddLearningProgress:$1,bulkAddReviews:J1,bulkAddSeriesProgress:r2,bulkAddSessions:L1,bulkUpdateDecks:_1,clearAIChatHistory:W1,clearDecks:B1,clearFolders:H1,clearReviews:Z1,clearSeries:G1,clearSeriesProgress:n2,clearSessions:U1,deleteDeck:S1,deleteDeckSeries:j1,deleteFolder:C1,deleteReviewsForDecks:Q1,deleteSessionState:z1,exportAllData:y0,factoryReset:a2,getAIChatHistory:Ou,getAllDataForBackup:js,getAllDeckSeries:N1,getAllDecks:m0,getAllFolders:E1,getAllLearningProgress:P1,getAllReviews:K1,getAllSeriesProgress:t2,getAllSessionKeys:F1,getAllSessions:M1,getReviewsForDeck:X1,getReviewsSince:V1,getSessionState:R1,performAtomicRestore:pl,saveAIChatHistory:g0,saveLearningProgress:q1,saveSeriesProgress:e2,saveSessionState:I1,updateDeck:w1,updateDeckSeries:O1,updateFolder:k1},Symbol.toStringTag,{value:"Module"})),Jh="AES-GCM",Wi=16,du=12;async function v0(n,a,s){const i=new TextEncoder,l=await window.crypto.subtle.importKey("raw",i.encode(n),{name:"PBKDF2"},!1,["deriveKey"]);return window.crypto.subtle.deriveKey({name:"PBKDF2",salt:a,iterations:1e5,hash:"SHA-256"},l,{name:Jh,length:256},!1,s)}async function b0(n,a){const s=window.crypto.getRandomValues(new Uint8Array(Wi)),i=window.crypto.getRandomValues(new Uint8Array(du)),l=await v0(a,s,["encrypt"]),c=new TextEncoder,d=await window.crypto.subtle.encrypt({name:Jh,iv:i},l,c.encode(n)),m=new Uint8Array(s.byteLength+i.byteLength+d.byteLength);m.set(s,0),m.set(i,s.byteLength),m.set(new Uint8Array(d),s.byteLength+i.byteLength);let p="";for(let f=0;f<m.byteLength;f++)p+=String.fromCharCode(m[f]);return btoa(p)}async function i2(n,a){const s=atob(n),i=new Uint8Array(s.length);for(let p=0;p<s.length;p++)i[p]=s.charCodeAt(p);if(i.byteLength<Wi+du)throw new Error("Invalid encrypted data.");const l=i.slice(0,Wi),c=i.slice(Wi,Wi+du),d=i.slice(Wi+du),m=await v0(a,l,["decrypt"]);try{const p=await window.crypto.subtle.decrypt({name:Jh,iv:c},m,d);return new TextDecoder().decode(p)}catch{throw new Error("Decryption failed. Wrong password or corrupted data.")}}const o2="https://www.greenyogafestival.org/backup-api/api/v1",ui="cogniflow-data",Eu="cogniflow-data.json",l2=()=>localStorage.getItem("cogniflow-backupApiKey")||"qRt+gU/57GHKhxTZeRnRi+dfT274iSkKKq2UnTr9Bxs=",x0=n=>localStorage.setItem("cogniflow-lastSyncEtag",n),_0=()=>localStorage.getItem("cogniflow-lastSyncEtag");async function di(n,a={}){const s=`${o2}/${n}`,i=l2(),l=new Headers(a.headers||{});l.set("X-API-Key",i),a.body instanceof FormData&&l.delete("Content-Type");const c={...a,headers:l};console.log(`[BackupService] Requesting: ${a.method||"GET"} ${s}`,{headers:Object.fromEntries(l.entries())});const d=3,m=1e3;for(let p=1;p<=d;p++)try{const f=await window.fetch(s,c);if(console.log(`[BackupService] Response from ${a.method||"GET"} ${s}: ${f.status}`),!f.ok&&![304,404].includes(f.status)){let v;try{v=await f.json()}catch{v={error:`HTTP error! status: ${f.status}`}}console.error("[BackupService] API request failed:",v);const _=(v==null?void 0:v.error)||(v==null?void 0:v.message)||`Request failed with status ${f.status}`,T=new Error(_);throw T.status=f.status,T}return f}catch(f){if(f instanceof TypeError&&f.message.toLowerCase().includes("failed to fetch"))if(p<d){const v=m*Math.pow(2,p-1);console.warn(`[BackupService] Attempt ${p} failed. Retrying in ${v}ms...`,f),await new Promise(_=>setTimeout(_,v));continue}else{console.error("[BackupService] All network attempts failed. This may be a network or CORS issue.",f);const v=new Error("Network error: Could not connect to the backup server. Please check your internet connection and any browser extensions (like ad-blockers) that may be interfering.");throw v.isNetworkError=!0,v}throw f}throw new Error("An unexpected error occurred in the request function.")}async function S0(n){const a=new Yh;return a.file("backup.json",JSON.stringify(n)),{dataType:"cogniflow-compressed-backup-v1",content:await a.generateAsync({type:"base64",compression:"DEFLATE",compressionOptions:{level:6}})}}async function ch(n,a=!1){console.log("[BackupService] Starting syncDataToServer...");let s;if(n)s=n;else{const{decks:_,folders:T,deckSeries:x,reviews:k,sessions:w,seriesProgress:S,learningProgress:C}=await js(),R=await Ou(),L=localStorage.getItem("cogniflow-ai-options"),F=L?JSON.parse(L):void 0;s={version:9,decks:_,folders:T,deckSeries:x,reviews:k,sessions:w,seriesProgress:S,learningProgress:C,aiOptions:F,aiChatHistory:R}}const i=await S0(s);let l=JSON.stringify(i);const c=localStorage.getItem("cogniflow-encryptionPassword");if(c){const _=await b0(l,c);l=JSON.stringify({dataType:"cogniflow-encrypted-v1",content:_}),console.log("[BackupService] Payload encrypted.")}const d={"Content-Type":"application/json"},m=_0();m&&!a&&(d["If-Match"]=m),console.log(`[BackupService] PUT ${Eu}`,{headers:d,bodySize:l.length});const p=await di(`apps/${ui}/backups/${Eu}`,{method:"PUT",headers:d,body:l});if(!p.ok){let _;try{_=await p.json()}catch{_={error:`HTTP error! status: ${p.status}`}}const T=(_==null?void 0:_.error)||(_==null?void 0:_.message)||`Request failed with status ${p.status}`,x=new Error(T);throw x.status=p.status,x}const f=p.headers.get("ETag");f&&x0(f);const v=await p.json();return console.log("[BackupService] syncDataToServer successful:",v),{timestamp:v.modified,etag:f||""}}async function uh(){console.log("[BackupService] Starting syncDataFromServer...");const n=await di(`apps/${ui}/backups/${Eu}`);if(n.status===404)throw new Error("No sync file found on the server.");const a=n.headers.get("ETag");a&&x0(a);let s=await n.text();try{const l=JSON.parse(s);if(l&&l.dataType==="cogniflow-encrypted-v1"){const c=localStorage.getItem("cogniflow-encryptionPassword");if(!c)throw new Error("Sync data is encrypted but no password is set on this device. Please set it in Settings.");s=await i2(l.content,c),console.log("[BackupService] Payload decrypted.")}}catch(l){if(l instanceof Error&&(l.message.includes("Decryption failed")||l.message.includes("password is set")))throw l}const i=await Au(s);return console.log("[BackupService] syncDataFromServer successful."),i}async function c2(){console.log("[BackupService] Starting getSyncDataMetadata...");const n={},a=_0();a&&(n["If-None-Match"]=a);const s=await di(`apps/${ui}/backups/${Eu}/meta`,{headers:n});if(s.status===304||s.status===404)return console.log(`[BackupService] getSyncDataMetadata finished with status: ${s.status}`),{metadata:null,isNotModified:s.status===304};const i=await s.json();return console.log("[BackupService] getSyncDataMetadata successful:",i),{metadata:i,isNotModified:!1}}async function u2(){var s;console.log("[BackupService] Starting listServerBackups...");const a=await(await di(`apps/${ui}/backups/list`)).json();return console.log(`[BackupService] Found ${((s=a.backups)==null?void 0:s.length)||0} backups.`),a.backups||[]}async function d2(){console.log("[BackupService] Starting createServerBackup...");const{decks:n,folders:a,deckSeries:s,reviews:i,sessions:l,seriesProgress:c,learningProgress:d}=await js(),m=localStorage.getItem("cogniflow-ai-options"),p=m?JSON.parse(m):void 0,f=await Ou(),_=await S0({version:9,decks:n,folders:a,deckSeries:s,reviews:i,sessions:l,seriesProgress:c,learningProgress:d,aiOptions:p,aiChatHistory:f});let T=JSON.stringify(_);const x=localStorage.getItem("cogniflow-encryptionPassword");if(x){const L=await b0(T,x);T=JSON.stringify({dataType:"cogniflow-encrypted-v1",content:L}),console.log("[BackupService] Backup payload encrypted.")}const k=new Blob([T],{type:"application/json"}),w=`backup-${Zh()}.json`,S=new FormData;S.append("file",k,w);const R=await(await di(`apps/${ui}/backups`,{method:"POST",body:S})).json();return console.log("[BackupService] createServerBackup successful:",R),R}async function f2(n){console.log(`[BackupService] Restoring live sync from manual backup: ${n}...`);const s=await(await di(`apps/${ui}/backups/${n}/restore`,{method:"POST"})).json();return console.log(`[BackupService] Restore from ${n} successful:`,s),s}async function h2(n){console.log(`[BackupService] Deleting manual backup: ${n}...`),await di(`apps/${ui}/backups/${n}`,{method:"DELETE"}),console.log(`[BackupService] Deleted ${n} successfully.`)}const m2=({isOpen:n,onClose:a,onRestore:s,onDelete:i})=>{const[l,c]=B.useState([]),[d,m]=B.useState(!1),[p,f]=B.useState(null),[v,_]=B.useState(null),{addToast:T}=jn(),x=B.useRef(null);Mn(x,n),B.useEffect(()=>{n&&(async()=>{m(!0),f(null),_("Loading sync file info...");try{const[C,{metadata:R}]=await Promise.all([u2(),c2()]),L=C.sort((F,G)=>new Date(G.modified).getTime()-new Date(F.modified).getTime());if(c(L),R){const F=new Date(R.modified),G=(R.size/1024).toFixed(1);_(`Live sync file: ${F.toLocaleString()} (${G} KB)`)}else _("No live sync file found on server.")}catch(C){const R=C instanceof Error?C.message:"Failed to load backups.";f(R),_("Could not retrieve live sync file info.")}finally{m(!1)}})()},[n]);const k=S=>{s(S),a()},w=async S=>{try{await i(S),c(C=>C.filter(R=>R.filename!==S)),T(`Deleted backup: ${S}`,"success")}catch{}};return u.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-[60] p-4",children:u.jsxs("div",{ref:x,className:"bg-surface rounded-lg shadow-xl w-full max-w-2xl transform transition-all relative max-h-[90vh] flex flex-col",children:[u.jsxs("div",{className:"flex-shrink-0 flex justify-between items-center p-4 border-b border-border",children:[u.jsx("h2",{className:"text-xl font-bold",children:"Manage Server Backups"}),u.jsx($e,{type:"button",variant:"ghost",onClick:a,className:"p-1 h-auto",children:u.jsx(ze,{name:"x"})})]}),u.jsxs("div",{className:"p-6 overflow-y-auto",children:[u.jsx("p",{className:"text-text-muted mb-2",children:"Select a backup to restore your live sync data from, or delete old backups. Restoring will overwrite the current sync file on the server."}),v&&u.jsx("p",{className:"text-sm text-text-muted mb-4 p-2 bg-background rounded-md",children:v}),d?u.jsx("div",{className:"text-center py-8",children:u.jsx(Zr,{})}):p?u.jsx("div",{className:"text-center py-8 text-red-500",children:p}):l.length>0?u.jsx("div",{className:"space-y-2 border border-border rounded-md",children:l.map(S=>u.jsxs("div",{className:"flex items-center justify-between p-3 hover:bg-background border-b border-border last:border-b-0",children:[u.jsxs("div",{className:"text-sm min-w-0",children:[u.jsx("p",{className:"font-medium text-text truncate",children:S.filename}),u.jsxs("p",{className:"text-text-muted",children:[new Date(S.modified).toLocaleString()," - ",(S.size/1024).toFixed(2)," KB"]})]}),u.jsxs("div",{className:"flex-shrink-0 flex items-center gap-1",children:[u.jsx($e,{variant:"secondary",size:"sm",onClick:()=>k(S.filename),children:"Restore"}),u.jsx($e,{variant:"danger",size:"sm",onClick:()=>w(S.filename),children:"Delete"})]})]},S.filename))}):u.jsx("div",{className:"text-center py-8 text-text-muted",children:u.jsx("p",{children:"No server backups found."})})]}),u.jsx("div",{className:"flex-shrink-0 flex justify-end p-4 bg-background/50 border-t border-border",children:u.jsx($e,{type:"button",variant:"primary",onClick:a,children:"Close"})})]})})},p2=({isOpen:n,onClose:a,onConfirm:s,analysis:i})=>{const[l,c]=B.useState(""),[d,m]=B.useState(""),[p,f]=B.useState(null),v=B.useRef(null);Mn(v,n),B.useEffect(()=>{if((i.type==="quiz"||i.type==="learning")&&i.data.name?c(i.data.name):c(""),i.type==="image"&&i.file){const S=new FileReader;S.readAsDataURL(i.file),S.onload=C=>{var R;f((R=C.target)==null?void 0:R.result)}}else f(null);m("")},[i]);const{title:_,message:T,confirmText:x}=B.useMemo(()=>{switch(i.type){case"backup":return{title:"Restore from Backup",message:`You dropped the backup file "${i.fileName}". Restoring will merge its content with your current data. Do you want to continue?`,confirmText:"Restore"};case"series":return{title:"Import Series",message:`You dropped a file containing the series "${i.data.seriesName}". Would you like to import it?`,confirmText:"Import Series"};case"quiz":return{title:"Import Quiz Deck",message:`You dropped a file for the quiz deck "${i.data.name}". Would you like to import it?`,confirmText:"Import Deck"};case"learning":return{title:"Import Learning Deck",message:`You dropped a file for the course "${i.data.name}". It includes instructional cards and associated questions.`,confirmText:"Import Course"};case"flashcard":return{title:"Import Flashcard Deck",message:`You dropped a file with ${i.data.length} flashcard(s). Please provide a name for the new deck.`,confirmText:"Import Deck"};case"anki":return{title:"Import Anki Package",message:`You dropped the Anki package "${i.fileName}". This may contain multiple decks and media.`,confirmText:"Import Anki Package"};case"image":return{title:"Generate Deck from Image",message:"Analyze this image with AI to create a flashcard deck.",confirmText:"Generate Deck"};default:return{title:"Confirm Import",message:"Unknown file type.",confirmText:"Confirm"}}},[i]),k=i.type==="flashcard"&&!l.trim(),w=()=>{s(i,{deckName:l.trim(),imageHint:d.trim()})};return n?u.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-[60] p-4",children:u.jsxs("div",{ref:v,className:"bg-surface rounded-lg shadow-xl w-full max-w-lg transform transition-all relative flex flex-col max-h-[90vh]",children:[u.jsxs("div",{className:"flex-shrink-0 flex justify-between items-center p-4 border-b border-border",children:[u.jsx("h2",{className:"text-xl font-bold text-text",children:_}),u.jsx($e,{type:"button",variant:"ghost",onClick:a,className:"p-1 h-auto","aria-label":"Close",children:u.jsx(ze,{name:"x"})})]}),u.jsxs("div",{className:"p-6 space-y-4 overflow-y-auto",children:[u.jsx("p",{className:"text-text-muted",children:T}),(i.type==="flashcard"||i.type==="quiz"||i.type==="learning")&&u.jsxs("div",{children:[u.jsx("label",{htmlFor:"deck-name-input",className:"block text-sm font-medium text-text-muted mb-1",children:"Deck Name"}),u.jsx("input",{id:"deck-name-input",type:"text",value:l,onChange:S=>c(S.target.value),className:"w-full p-2 bg-background border border-border rounded-md focus:ring-2 focus:ring-primary focus:outline-none",placeholder:"Enter a name for the new deck",autoFocus:!0})]}),i.type==="image"&&u.jsxs("div",{className:"space-y-4",children:[p&&u.jsx("div",{className:"rounded-lg overflow-hidden border border-border max-h-48 flex justify-center bg-black/5",children:u.jsx("img",{src:p,alt:"Preview",className:"h-full object-contain"})}),u.jsxs("div",{children:[u.jsx("label",{htmlFor:"image-hint",className:"block text-sm font-medium text-text-muted mb-1",children:"Topic / Hint (Optional)"}),u.jsx("input",{type:"text",id:"image-hint",value:d,onChange:S=>m(S.target.value),className:"w-full p-2 bg-background border border-border rounded-md focus:ring-2 focus:ring-primary focus:outline-none",placeholder:"e.g., Focus on dates or biological terms"}),u.jsx("p",{className:"text-xs text-text-muted mt-1",children:"Guide the AI to extract specific information."})]})]})]}),u.jsxs("div",{className:"flex-shrink-0 flex justify-end p-4 bg-background/50 border-t border-border",children:[u.jsx($e,{type:"button",variant:"secondary",onClick:a,className:"mr-2",children:"Cancel"}),u.jsx($e,{type:"button",variant:"primary",onClick:w,disabled:k,children:x})]})]})}):null};/*! @license DOMPurify 3.1.2 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/3.1.2/LICENSE */const{entries:w0,setPrototypeOf:eb,isFrozen:g2,getPrototypeOf:y2,getOwnPropertyDescriptor:v2}=Object;let{freeze:lr,seal:Qr,create:E0}=Object,{apply:Lh,construct:zh}=typeof Reflect<"u"&&Reflect;lr||(lr=function(a){return a});Qr||(Qr=function(a){return a});Lh||(Lh=function(a,s,i){return a.apply(s,i)});zh||(zh=function(a,s){return new a(...s)});const iu=Or(Array.prototype.forEach),tb=Or(Array.prototype.pop),ll=Or(Array.prototype.push),fu=Or(String.prototype.toLowerCase),dh=Or(String.prototype.toString),nb=Or(String.prototype.match),cl=Or(String.prototype.replace),b2=Or(String.prototype.indexOf),x2=Or(String.prototype.trim),na=Or(Object.prototype.hasOwnProperty),gr=Or(RegExp.prototype.test),ul=_2(TypeError);function Or(n){return function(a){for(var s=arguments.length,i=new Array(s>1?s-1:0),l=1;l<s;l++)i[l-1]=arguments[l];return Lh(n,a,i)}}function _2(n){return function(){for(var a=arguments.length,s=new Array(a),i=0;i<a;i++)s[i]=arguments[i];return zh(n,s)}}function Ot(n,a){let s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:fu;eb&&eb(n,null);let i=a.length;for(;i--;){let l=a[i];if(typeof l=="string"){const c=s(l);c!==l&&(g2(a)||(a[i]=c),l=c)}n[l]=!0}return n}function S2(n){for(let a=0;a<n.length;a++)na(n,a)||(n[a]=null);return n}function si(n){const a=E0(null);for(const[s,i]of w0(n))na(n,s)&&(Array.isArray(i)?a[s]=S2(i):i&&typeof i=="object"&&i.constructor===Object?a[s]=si(i):a[s]=i);return a}function ou(n,a){for(;n!==null;){const i=v2(n,a);if(i){if(i.get)return Or(i.get);if(typeof i.value=="function")return Or(i.value)}n=y2(n)}function s(){return null}return s}const rb=lr(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),fh=lr(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),hh=lr(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),w2=lr(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),mh=lr(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),E2=lr(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),ab=lr(["#text"]),sb=lr(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),ph=lr(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),ib=lr(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),lu=lr(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),T2=Qr(/\{\{[\w\W]*|[\w\W]*\}\}/gm),A2=Qr(/<%[\w\W]*|[\w\W]*%>/gm),k2=Qr(/\${[\w\W]*}/gm),C2=Qr(/^data-[\-\w.\u00B7-\uFFFF]/),N2=Qr(/^aria-[\-\w]+$/),T0=Qr(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),D2=Qr(/^(?:\w+script|data):/i),O2=Qr(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),A0=Qr(/^html$/i),j2=Qr(/^[a-z][.\w]*(-[.\w]+)+$/i);var ob=Object.freeze({__proto__:null,MUSTACHE_EXPR:T2,ERB_EXPR:A2,TMPLIT_EXPR:k2,DATA_ATTR:C2,ARIA_ATTR:N2,IS_ALLOWED_URI:T0,IS_SCRIPT_OR_DATA:D2,ATTR_WHITESPACE:O2,DOCTYPE_NAME:A0,CUSTOM_ELEMENT:j2});const I2=function(){return typeof window>"u"?null:window},R2=function(a,s){if(typeof a!="object"||typeof a.createPolicy!="function")return null;let i=null;const l="data-tt-policy-suffix";s&&s.hasAttribute(l)&&(i=s.getAttribute(l));const c="dompurify"+(i?"#"+i:"");try{return a.createPolicy(c,{createHTML(d){return d},createScriptURL(d){return d}})}catch{return console.warn("TrustedTypes policy "+c+" could not be created."),null}};function k0(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:I2();const a=Xe=>k0(Xe);if(a.version="3.1.2",a.removed=[],!n||!n.document||n.document.nodeType!==9)return a.isSupported=!1,a;let{document:s}=n;const i=s,l=i.currentScript,{DocumentFragment:c,HTMLTemplateElement:d,Node:m,Element:p,NodeFilter:f,NamedNodeMap:v=n.NamedNodeMap||n.MozNamedAttrMap,HTMLFormElement:_,DOMParser:T,trustedTypes:x}=n,k=p.prototype,w=ou(k,"cloneNode"),S=ou(k,"nextSibling"),C=ou(k,"childNodes"),R=ou(k,"parentNode");if(typeof d=="function"){const Xe=s.createElement("template");Xe.content&&Xe.content.ownerDocument&&(s=Xe.content.ownerDocument)}let L,F="";const{implementation:G,createNodeIterator:Q,createDocumentFragment:U,getElementsByTagName:j}=s,{importNode:O}=i;let q={};a.isSupported=typeof w0=="function"&&typeof R=="function"&&G&&G.createHTMLDocument!==void 0;const{MUSTACHE_EXPR:ee,ERB_EXPR:M,TMPLIT_EXPR:J,DATA_ATTR:N,ARIA_ATTR:se,IS_SCRIPT_OR_DATA:K,ATTR_WHITESPACE:P,CUSTOM_ELEMENT:ve}=ob;let{IS_ALLOWED_URI:ce}=ob,Ee=null;const z=Ot({},[...rb,...fh,...hh,...mh,...ab]);let I=null;const te=Ot({},[...sb,...ph,...ib,...lu]);let ae=Object.seal(E0(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),$=null,ue=null,de=!0,oe=!0,le=!1,Le=!0,De=!1,Se=!0,ne=!1,E=!1,me=!1,X=!1,Z=!1,Y=!1,ie=!0,ke=!1;const Ce="user-content-";let pe=!0,Ie=!1,He={},Oe=null;const qe=Ot({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let nt=null;const We=Ot({},["audio","video","img","source","image","track"]);let Ye=null;const St=Ot({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),wt="http://www.w3.org/1998/Math/MathML",jt="http://www.w3.org/2000/svg",mt="http://www.w3.org/1999/xhtml";let rt=mt,un=!1,Mt=null;const cr=Ot({},[wt,jt,mt],dh);let ut=null;const Jr=["application/xhtml+xml","text/html"],Kn="text/html";let qt=null,tn=null;const vn=255,gt=s.createElement("form"),pn=function(fe){return fe instanceof RegExp||fe instanceof Function},Pe=function(){let fe=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!(tn&&tn===fe)){if((!fe||typeof fe!="object")&&(fe={}),fe=si(fe),ut=Jr.indexOf(fe.PARSER_MEDIA_TYPE)===-1?Kn:fe.PARSER_MEDIA_TYPE,qt=ut==="application/xhtml+xml"?dh:fu,Ee=na(fe,"ALLOWED_TAGS")?Ot({},fe.ALLOWED_TAGS,qt):z,I=na(fe,"ALLOWED_ATTR")?Ot({},fe.ALLOWED_ATTR,qt):te,Mt=na(fe,"ALLOWED_NAMESPACES")?Ot({},fe.ALLOWED_NAMESPACES,dh):cr,Ye=na(fe,"ADD_URI_SAFE_ATTR")?Ot(si(St),fe.ADD_URI_SAFE_ATTR,qt):St,nt=na(fe,"ADD_DATA_URI_TAGS")?Ot(si(We),fe.ADD_DATA_URI_TAGS,qt):We,Oe=na(fe,"FORBID_CONTENTS")?Ot({},fe.FORBID_CONTENTS,qt):qe,$=na(fe,"FORBID_TAGS")?Ot({},fe.FORBID_TAGS,qt):{},ue=na(fe,"FORBID_ATTR")?Ot({},fe.FORBID_ATTR,qt):{},He=na(fe,"USE_PROFILES")?fe.USE_PROFILES:!1,de=fe.ALLOW_ARIA_ATTR!==!1,oe=fe.ALLOW_DATA_ATTR!==!1,le=fe.ALLOW_UNKNOWN_PROTOCOLS||!1,Le=fe.ALLOW_SELF_CLOSE_IN_ATTR!==!1,De=fe.SAFE_FOR_TEMPLATES||!1,Se=fe.SAFE_FOR_XML!==!1,ne=fe.WHOLE_DOCUMENT||!1,X=fe.RETURN_DOM||!1,Z=fe.RETURN_DOM_FRAGMENT||!1,Y=fe.RETURN_TRUSTED_TYPE||!1,me=fe.FORCE_BODY||!1,ie=fe.SANITIZE_DOM!==!1,ke=fe.SANITIZE_NAMED_PROPS||!1,pe=fe.KEEP_CONTENT!==!1,Ie=fe.IN_PLACE||!1,ce=fe.ALLOWED_URI_REGEXP||T0,rt=fe.NAMESPACE||mt,ae=fe.CUSTOM_ELEMENT_HANDLING||{},fe.CUSTOM_ELEMENT_HANDLING&&pn(fe.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(ae.tagNameCheck=fe.CUSTOM_ELEMENT_HANDLING.tagNameCheck),fe.CUSTOM_ELEMENT_HANDLING&&pn(fe.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(ae.attributeNameCheck=fe.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),fe.CUSTOM_ELEMENT_HANDLING&&typeof fe.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(ae.allowCustomizedBuiltInElements=fe.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),De&&(oe=!1),Z&&(X=!0),He&&(Ee=Ot({},ab),I=[],He.html===!0&&(Ot(Ee,rb),Ot(I,sb)),He.svg===!0&&(Ot(Ee,fh),Ot(I,ph),Ot(I,lu)),He.svgFilters===!0&&(Ot(Ee,hh),Ot(I,ph),Ot(I,lu)),He.mathMl===!0&&(Ot(Ee,mh),Ot(I,ib),Ot(I,lu))),fe.ADD_TAGS&&(Ee===z&&(Ee=si(Ee)),Ot(Ee,fe.ADD_TAGS,qt)),fe.ADD_ATTR&&(I===te&&(I=si(I)),Ot(I,fe.ADD_ATTR,qt)),fe.ADD_URI_SAFE_ATTR&&Ot(Ye,fe.ADD_URI_SAFE_ATTR,qt),fe.FORBID_CONTENTS&&(Oe===qe&&(Oe=si(Oe)),Ot(Oe,fe.FORBID_CONTENTS,qt)),pe&&(Ee["#text"]=!0),ne&&Ot(Ee,["html","head","body"]),Ee.table&&(Ot(Ee,["tbody"]),delete $.tbody),fe.TRUSTED_TYPES_POLICY){if(typeof fe.TRUSTED_TYPES_POLICY.createHTML!="function")throw ul('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if(typeof fe.TRUSTED_TYPES_POLICY.createScriptURL!="function")throw ul('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');L=fe.TRUSTED_TYPES_POLICY,F=L.createHTML("")}else L===void 0&&(L=R2(x,l)),L!==null&&typeof F=="string"&&(F=L.createHTML(""));lr&&lr(fe),tn=fe}},_a=Ot({},["mi","mo","mn","ms","mtext"]),Sn=Ot({},["foreignobject","annotation-xml"]),yr=Ot({},["title","style","font","a","script"]),Qa=Ot({},[...fh,...hh,...w2]),Ja=Ot({},[...mh,...E2]),Ir=function(fe){let Be=R(fe);(!Be||!Be.tagName)&&(Be={namespaceURI:rt,tagName:"template"});const Ke=fu(fe.tagName),ft=fu(Be.tagName);return Mt[fe.namespaceURI]?fe.namespaceURI===jt?Be.namespaceURI===mt?Ke==="svg":Be.namespaceURI===wt?Ke==="svg"&&(ft==="annotation-xml"||_a[ft]):!!Qa[Ke]:fe.namespaceURI===wt?Be.namespaceURI===mt?Ke==="math":Be.namespaceURI===jt?Ke==="math"&&Sn[ft]:!!Ja[Ke]:fe.namespaceURI===mt?Be.namespaceURI===jt&&!Sn[ft]||Be.namespaceURI===wt&&!_a[ft]?!1:!Ja[Ke]&&(yr[Ke]||!Qa[Ke]):!!(ut==="application/xhtml+xml"&&Mt[fe.namespaceURI]):!1},Fn=function(fe){ll(a.removed,{element:fe});try{fe.parentNode.removeChild(fe)}catch{fe.remove()}},An=function(fe,Be){try{ll(a.removed,{attribute:Be.getAttributeNode(fe),from:Be})}catch{ll(a.removed,{attribute:null,from:Be})}if(Be.removeAttribute(fe),fe==="is"&&!I[fe])if(X||Z)try{Fn(Be)}catch{}else try{Be.setAttribute(fe,"")}catch{}},Sa=function(fe){let Be=null,Ke=null;if(me)fe="<remove></remove>"+fe;else{const nn=nb(fe,/^[\r\n\t ]+/);Ke=nn&&nn[0]}ut==="application/xhtml+xml"&&rt===mt&&(fe='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+fe+"</body></html>");const ft=L?L.createHTML(fe):fe;if(rt===mt)try{Be=new T().parseFromString(ft,ut)}catch{}if(!Be||!Be.documentElement){Be=G.createDocument(rt,"template",null);try{Be.documentElement.innerHTML=un?F:ft}catch{}}const sn=Be.body||Be.documentElement;return fe&&Ke&&sn.insertBefore(s.createTextNode(Ke),sn.childNodes[0]||null),rt===mt?j.call(Be,ne?"html":"body")[0]:ne?Be.documentElement:sn},Rr=function(fe){return Q.call(fe.ownerDocument||fe,fe,f.SHOW_ELEMENT|f.SHOW_COMMENT|f.SHOW_TEXT|f.SHOW_PROCESSING_INSTRUCTION|f.SHOW_CDATA_SECTION,null)},Ls=function(fe){return fe instanceof _&&(typeof fe.__depth<"u"&&typeof fe.__depth!="number"||typeof fe.__removalCount<"u"&&typeof fe.__removalCount!="number"||typeof fe.nodeName!="string"||typeof fe.textContent!="string"||typeof fe.removeChild!="function"||!(fe.attributes instanceof v)||typeof fe.removeAttribute!="function"||typeof fe.setAttribute!="function"||typeof fe.namespaceURI!="string"||typeof fe.insertBefore!="function"||typeof fe.hasChildNodes!="function")},ur=function(fe){return typeof m=="function"&&fe instanceof m},Yt=function(fe,Be,Ke){q[fe]&&iu(q[fe],ft=>{ft.call(a,Be,Ke,tn)})},Bt=function(fe){let Be=null;if(Yt("beforeSanitizeElements",fe,null),Ls(fe))return Fn(fe),!0;const Ke=qt(fe.nodeName);if(Yt("uponSanitizeElement",fe,{tagName:Ke,allowedTags:Ee}),fe.hasChildNodes()&&!ur(fe.firstElementChild)&&gr(/<[/\w]/g,fe.innerHTML)&&gr(/<[/\w]/g,fe.textContent)||fe.nodeType===7||Se&&fe.nodeType===8&&gr(/<[/\w]/g,fe.data))return Fn(fe),!0;if(!Ee[Ke]||$[Ke]){if(!$[Ke]&&Xa(Ke)&&(ae.tagNameCheck instanceof RegExp&&gr(ae.tagNameCheck,Ke)||ae.tagNameCheck instanceof Function&&ae.tagNameCheck(Ke)))return!1;if(pe&&!Oe[Ke]){const ft=R(fe)||fe.parentNode,sn=C(fe)||fe.childNodes;if(sn&&ft){const nn=sn.length;for(let kt=nn-1;kt>=0;--kt){const kn=w(sn[kt],!0);kn.__removalCount=(fe.__removalCount||0)+1,ft.insertBefore(kn,S(fe))}}}return Fn(fe),!0}return fe instanceof p&&!Ir(fe)||(Ke==="noscript"||Ke==="noembed"||Ke==="noframes")&&gr(/<\/no(script|embed|frames)/i,fe.innerHTML)?(Fn(fe),!0):(De&&fe.nodeType===3&&(Be=fe.textContent,iu([ee,M,J],ft=>{Be=cl(Be,ft," ")}),fe.textContent!==Be&&(ll(a.removed,{element:fe.cloneNode()}),fe.textContent=Be)),Yt("afterSanitizeElements",fe,null),!1)},Mr=function(fe,Be,Ke){if(ie&&(Be==="id"||Be==="name")&&(Ke in s||Ke in gt))return!1;if(!(oe&&!ue[Be]&&gr(N,Be))){if(!(de&&gr(se,Be))){if(!I[Be]||ue[Be]){if(!(Xa(fe)&&(ae.tagNameCheck instanceof RegExp&&gr(ae.tagNameCheck,fe)||ae.tagNameCheck instanceof Function&&ae.tagNameCheck(fe))&&(ae.attributeNameCheck instanceof RegExp&&gr(ae.attributeNameCheck,Be)||ae.attributeNameCheck instanceof Function&&ae.attributeNameCheck(Be))||Be==="is"&&ae.allowCustomizedBuiltInElements&&(ae.tagNameCheck instanceof RegExp&&gr(ae.tagNameCheck,Ke)||ae.tagNameCheck instanceof Function&&ae.tagNameCheck(Ke))))return!1}else if(!Ye[Be]){if(!gr(ce,cl(Ke,P,""))){if(!((Be==="src"||Be==="xlink:href"||Be==="href")&&fe!=="script"&&b2(Ke,"data:")===0&&nt[fe])){if(!(le&&!gr(K,cl(Ke,P,"")))){if(Ke)return!1}}}}}}return!0},Xa=function(fe){return fe!=="annotation-xml"&&nb(fe,ve)},Wa=function(fe){Yt("beforeSanitizeAttributes",fe,null);const{attributes:Be}=fe;if(!Be)return;const Ke={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:I};let ft=Be.length;for(;ft--;){const sn=Be[ft],{name:nn,namespaceURI:kt,value:kn}=sn,vr=qt(nn);let on=nn==="value"?kn:x2(kn);if(Ke.attrName=vr,Ke.attrValue=on,Ke.keepAttr=!0,Ke.forceKeepAttr=void 0,Yt("uponSanitizeAttribute",fe,Ke),on=Ke.attrValue,Ke.forceKeepAttr||(An(nn,fe),!Ke.keepAttr))continue;if(!Le&&gr(/\/>/i,on)){An(nn,fe);continue}De&&iu([ee,M,J],es=>{on=cl(on,es," ")});const Zn=qt(fe.nodeName);if(Mr(Zn,vr,on)){if(ke&&(vr==="id"||vr==="name")&&(An(nn,fe),on=Ce+on),L&&typeof x=="object"&&typeof x.getAttributeType=="function"&&!kt)switch(x.getAttributeType(Zn,vr)){case"TrustedHTML":{on=L.createHTML(on);break}case"TrustedScriptURL":{on=L.createScriptURL(on);break}}try{kt?fe.setAttributeNS(kt,nn,on):fe.setAttribute(nn,on),tb(a.removed)}catch{}}}Yt("afterSanitizeAttributes",fe,null)},fi=function Xe(fe){let Be=null;const Ke=Rr(fe);for(Yt("beforeSanitizeShadowDOM",fe,null);Be=Ke.nextNode();){if(Yt("uponSanitizeShadowNode",Be,null),Bt(Be))continue;const ft=R(Be);Be.nodeType===1&&(ft&&ft.__depth?Be.__depth=(Be.__removalCount||0)+ft.__depth+1:Be.__depth=1),Be.__depth>=vn&&Fn(Be),Be.content instanceof c&&(Be.content.__depth=Be.__depth,Xe(Be.content)),Wa(Be)}Yt("afterSanitizeShadowDOM",fe,null)};return a.sanitize=function(Xe){let fe=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},Be=null,Ke=null,ft=null,sn=null;if(un=!Xe,un&&(Xe="<!-->"),typeof Xe!="string"&&!ur(Xe))if(typeof Xe.toString=="function"){if(Xe=Xe.toString(),typeof Xe!="string")throw ul("dirty is not a string, aborting")}else throw ul("toString is not a function");if(!a.isSupported)return Xe;if(E||Pe(fe),a.removed=[],typeof Xe=="string"&&(Ie=!1),Ie){if(Xe.nodeName){const kn=qt(Xe.nodeName);if(!Ee[kn]||$[kn])throw ul("root node is forbidden and cannot be sanitized in-place")}}else if(Xe instanceof m)Be=Sa("<!---->"),Ke=Be.ownerDocument.importNode(Xe,!0),Ke.nodeType===1&&Ke.nodeName==="BODY"||Ke.nodeName==="HTML"?Be=Ke:Be.appendChild(Ke);else{if(!X&&!De&&!ne&&Xe.indexOf("<")===-1)return L&&Y?L.createHTML(Xe):Xe;if(Be=Sa(Xe),!Be)return X?null:Y?F:""}Be&&me&&Fn(Be.firstChild);const nn=Rr(Ie?Xe:Be);for(;ft=nn.nextNode();){if(Bt(ft))continue;const kn=R(ft);ft.nodeType===1&&(kn&&kn.__depth?ft.__depth=(ft.__removalCount||0)+kn.__depth+1:ft.__depth=1),ft.__depth>=vn&&Fn(ft),ft.content instanceof c&&(ft.content.__depth=ft.__depth,fi(ft.content)),Wa(ft)}if(Ie)return Xe;if(X){if(Z)for(sn=U.call(Be.ownerDocument);Be.firstChild;)sn.appendChild(Be.firstChild);else sn=Be;return(I.shadowroot||I.shadowrootmode)&&(sn=O.call(i,sn,!0)),sn}let kt=ne?Be.outerHTML:Be.innerHTML;return ne&&Ee["!doctype"]&&Be.ownerDocument&&Be.ownerDocument.doctype&&Be.ownerDocument.doctype.name&&gr(A0,Be.ownerDocument.doctype.name)&&(kt="<!DOCTYPE "+Be.ownerDocument.doctype.name+`>
`+kt),De&&iu([ee,M,J],kn=>{kt=cl(kt,kn," ")}),L&&Y?L.createHTML(kt):kt},a.setConfig=function(){let Xe=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Pe(Xe),E=!0},a.clearConfig=function(){tn=null,E=!1},a.isValidAttribute=function(Xe,fe,Be){tn||Pe({});const Ke=qt(Xe),ft=qt(fe);return Mr(Ke,ft,Be)},a.addHook=function(Xe,fe){typeof fe=="function"&&(q[Xe]=q[Xe]||[],ll(q[Xe],fe))},a.removeHook=function(Xe){if(q[Xe])return tb(q[Xe])},a.removeHooks=function(Xe){q[Xe]&&(q[Xe]=[])},a.removeAllHooks=function(){q={}},a}var M2=k0();const C0=({html:n,className:a,as:s="div"})=>{const i=`html-container-${ii.useId()}`,l=ii.useMemo(()=>M2.sanitize(n,{ADD_TAGS:["script","style","iframe","video","audio","source","track","img"],ADD_ATTR:["allow","allowfullscreen","frameborder","scrolling","target","src","data-src","type","controls","autoplay","loop","muted","poster","preload","class","id","style"],FORCE_BODY:!0}),[n]);return ii.useEffect(()=>{const c=document.getElementById(i);if(!c)return;Array.from(c.getElementsByTagName("img")).forEach(f=>{f.hasAttribute("loading")||f.setAttribute("loading","lazy"),f.hasAttribute("decoding")||f.setAttribute("decoding","async")});const m=Array.from(c.getElementsByTagName("script")),p=[];return m.forEach(f=>{const v=document.createElement("script");Array.from(f.attributes).forEach(_=>{v.setAttribute(_.name,_.value)}),f.text&&!f.src?v.text=`try { ${f.text} } catch (e) { console.error('Error in custom card script:', e); }`:v.text=f.text,document.body.appendChild(v),p.push(v)}),()=>{p.forEach(f=>{document.body.contains(f)&&document.body.removeChild(f)})}},[l,i]),u.jsx(s,{id:i,className:a,dangerouslySetInnerHTML:{__html:l}})},U2=()=>{throw new Error("AI features are disabled. A Google Gemini API key is required.")},L2={type:Xn.ARRAY,description:"An array of one or more actions the user wants to perform. If the user is just chatting, return an array with a single NO_ACTION.",items:{type:Xn.OBJECT,properties:{action:{type:Xn.STRING,enum:Object.values(gl),description:"The specific action the user wants to perform. Use NO_ACTION for conversational replies."},payload:{type:Xn.OBJECT,description:"The data needed to perform the action. Include only necessary fields.",properties:{deckId:{type:Xn.STRING,description:"The ID of the target deck."},folderId:{type:Xn.STRING,description:"The ID of the target folder. Use null to move a deck out of a folder."},name:{type:Xn.STRING,description:"The name for a new deck or folder."},newName:{type:Xn.STRING,description:"The new name for a deck or folder being renamed."},seriesId:{type:Xn.STRING,description:"The ID of the target series for expansion."},levelIndex:{type:Xn.NUMBER,description:"The 0-based index of the level within the series to add decks to."},count:{type:Xn.NUMBER,description:"The number of questions to generate for a deck."},reworkInstructions:{type:Xn.STRING,description:"Detailed instructions for reworking the deck content (e.g. 'Expand info cards')."},persona:{type:Xn.STRING,description:"The ID of the persona to use for rework (e.g. 'the_master', 'feynman'). Default to 'default' if not specified."}}},confirmationMessage:{type:Xn.STRING,description:"A friendly message to the user asking them to confirm the action. For a NO_ACTION, this should be the AI's conversational reply."}},required:["action","payload","confirmationMessage"]}},z2=async(n,a)=>{var m,p;const s=U2();a.decks.map(f=>`- Deck: "${f.name}" (id: ${f.id}, folderId: ${f.folderId||"none"})`).join(`
`);const i=a.folders.map(f=>`- Folder: "${f.name}" (id: ${f.id})`).join(`
`);let l="",c="";if((m=a.activeContext)!=null&&m.deck){const f=a.activeContext.deck;if(l=`
--- START ACTIVE DECK CONTENT ---
CURRENT OPEN DECK: "${f.name}" (ID: ${f.id})
TYPE: ${f.type}
`,f.type===je.Flashcard){const v=f;l+=`CARDS (${v.cards.length}):
`+v.cards.map(_=>`- Front: ${_.front}
  Back: ${_.back}`).join(`
`)}else{const v=f;if(f.type===je.Learning){const _=f;l+=`INFO CARDS (${_.infoCards.length}):
`+_.infoCards.map(T=>`- Content: ${T.content}`).join(`
`)}l+=`QUESTIONS (${v.questions.length}):
`+v.questions.map(_=>{var T;return`- Question: ${_.questionText}
  Correct Answer: ${(T=_.options.find(x=>x.id===_.correctAnswerId))==null?void 0:T.text}`}).join(`
`)}l+=`
--- END ACTIVE DECK CONTENT ---
`}if((p=a.activeContext)!=null&&p.series){const f=a.activeContext.series;c=`
--- START ACTIVE SERIES CONTEXT ---
CURRENT OPEN SERIES: "${f.name}" (ID: ${f.id})
`,c+=`Levels:
`+f.levels.map((v,_)=>{const T=v.deckIds.map(x=>a.decks.find(k=>k.id===x)).filter(Boolean);return`Level ${_}: ${v.title}
`+T.map(x=>`  - Deck: "${x==null?void 0:x.name}" (${x==null?void 0:x.description})`).join(`
`)}).join(`
`),c+=`
--- END ACTIVE SERIES CONTEXT ---
`}const d=`
        You are an AI assistant for 'CogniFlow', a spaced repetition app. Your goal is to help users manage their decks and folders.

        **PERSONAS**
        Users can request content generation using specific personas. Available personas:
        - 'default': Helpful and neutral assistant.
        - 'tutor': Friendly, uses analogies, simple language.
        - 'professor': Formal, academic, in-depth, precise.
        - 'author': Concise, fact-focused, no fluff.
        - 'lindstrom': Linguistic, cultural, witty, slightly dry.
        - 'bryson': Sense of wonder, conversational, avoids jargon, dry humor.
        - 'feynman': Simplicity, physical analogies, "why" and "how" focused.
        - 'roach': Intense curiosity, human side of science, funny,Relatable.
        - 'great_teacher': Storytelling, modeling radical curiosity.
        - 'the_master': Ultimate mentor. 5 pillars: Stylist (rhythm), Storyteller (human struggle), Analogy Architect, Provocateur (challenge assumptions), Formatter (aggressive HTML use).

        **CRITICAL: REFERENCING CONTEXT (@)**
        Users may use "@" or "this" to refer to the current deck or series they are viewing.
        ${l}
        ${c}

        You MUST respond with a JSON array of actions.

        **Capabilities:**
        - Create/rename/move/delete decks & folders.
        - Expand learning series.
        - Generate unique questions for decks using HTML formatting.
        - REWORK content: If a user asks to "improve", "expand", or "rewrite" an existing deck (using a persona or not), use REWORK_DECK.
        - Answer general questions about study materials if context is provided.

        **Instructions:**
        1. Analyze user request. Use active context (marked above) if the user says "@" or "this".
        2. For content rework (e.g. "Expand info cards using the Master persona"), identify the target deck ID, extract any requested persona ID (if requested), and provide the specific instructions.
        3. For conversational replies, use 'NO_ACTION'.
        4. For data modifications, use a clear 'confirmationMessage'.

        **State Summary:**
        Folders: ${i||"None"}
        Series: ${a.series.map(f=>f.name).join(", ")||"None"}
    `;try{const v=(await s.models.generateContent({model:"gemini-2.5-pro",contents:n,config:{systemInstruction:d,responseMimeType:"application/json",responseSchema:L2,thinkingConfig:{thinkingBudget:32768}}})).text.trim(),_=JSON.parse(v);if(!Array.isArray(_))throw new Error("AI response was not a valid array of actions.");return _}catch(f){throw console.error("Error getting AI response:",f),f instanceof Error&&f.message.includes("SAFETY")?new Error("Blocked by safety settings."):new Error("Sorry, I had trouble with that. Try rephrasing?")}},F2=({isOpen:n,onClose:a,onExecuteAction:s,history:i})=>{const{dispatch:l}=Ze(),c=uo(),d=Fh(),m=M_(),p=Bh(),[f,v]=B.useState(""),[_,T]=B.useState(!1),[x,k]=B.useState(""),w=B.useRef(null),S=B.useRef(null),C=c==null?void 0:c.activeDeck,R=c==null?void 0:c.activeSeries;B.useEffect(()=>{var O;(O=w.current)==null||O.scrollIntoView({behavior:"smooth"})},[i]),B.useEffect(()=>{n&&g0(i)},[i,n]);const L=B.useMemo(()=>{const O=[];return C&&O.push({id:C.id,name:`this deck (${C.name})`,type:"deck"}),R&&O.push({id:R.id,name:`this series (${R.name})`,type:"series"}),m.forEach(q=>O.push({id:q.id,name:q.name,type:"folder"})),d.filter(q=>!q.deletedAt&&!q.archived).forEach(q=>O.push({id:q.id,name:q.name,type:"deck"})),O.filter(q=>q.name.toLowerCase().includes(x.toLowerCase()))},[d,m,C,R,x]),F=O=>{const q=O.target.value;v(q);const ee=q.lastIndexOf("@");ee!==-1&&ee>=q.length-15?(T(!0),k(q.substring(ee+1))):T(!1)},G=O=>{var M;const q=f.lastIndexOf("@"),ee=f.substring(0,q)+`@${O.name} `;v(ee),T(!1),(M=S.current)==null||M.focus()},Q=async O=>{var N;O.preventDefault();const q=f.trim();if(!q)return;v(""),T(!1);const ee={id:crypto.randomUUID(),role:"user",text:q},M={id:crypto.randomUUID(),role:"model",text:"",isLoading:!0},J=[...i,ee,M];l({type:"SET_AI_CHAT_HISTORY",payload:J});try{const se=await z2(q,{decks:d,folders:m,series:p,activeContext:{deck:C||void 0,series:R||void 0}}),K={id:crypto.randomUUID(),role:"model",text:((N=se.find(P=>P.confirmationMessage))==null?void 0:N.confirmationMessage)||"I've processed your request.",actions:se};l({type:"SET_AI_CHAT_HISTORY",payload:[...i,ee,K]})}catch(se){const K={id:crypto.randomUUID(),role:"model",text:se instanceof Error?se.message:"An unknown error occurred."};l({type:"SET_AI_CHAT_HISTORY",payload:[...i,ee,K]})}},U=O=>{s(O),a()},j=O=>O.replace(/\*\*(.*?)\*\*/g,"<b>$1</b>").replace(/\*(.*?)\*/g,"<i>$1</i>").replace(/```([\s\S]*?)```/g,'<pre class="bg-gray-800 text-white p-2 rounded my-2 overflow-x-auto text-xs"><code>$1</code></pre>').replace(/`([^`]+)`/g,'<code class="bg-gray-200 dark:bg-gray-700 px-1 rounded text-sm font-mono">$1</code>').replace(/\n/g,"<br />");return n?u.jsxs("div",{className:"fixed inset-0 bg-black/50 z-[60] flex flex-col items-center justify-end",onClick:a,children:[u.jsxs("div",{className:"bg-surface w-full max-w-2xl h-[70vh] max-h-[600px] rounded-t-2xl shadow-2xl flex flex-col transform transition-transform duration-300 animate-fade-in relative",style:{animationName:"slideUp",animationDuration:"0.3s"},onClick:O=>O.stopPropagation(),children:[u.jsxs("header",{className:"flex-shrink-0 flex items-center justify-between p-4 border-b border-border",children:[u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx(ze,{name:"bot",className:"w-6 h-6 text-primary"}),u.jsx("h2",{className:"text-xl font-bold text-text",children:"AI Assistant"})]}),u.jsx($e,{variant:"ghost",onClick:a,className:"p-1 h-auto",children:u.jsx(ze,{name:"x"})})]}),u.jsx("main",{className:"flex-grow p-4 overflow-y-auto",children:u.jsxs("div",{className:"space-y-4",children:[i.map(O=>u.jsxs("div",{className:`flex gap-3 ${O.role==="user"?"justify-end":"justify-start"}`,children:[O.role==="model"&&u.jsx(ze,{name:"bot",className:"w-6 h-6 text-primary flex-shrink-0 mt-1"}),u.jsxs("div",{className:`max-w-md p-3 rounded-2xl ${O.role==="user"?"bg-primary text-on-primary rounded-br-lg":"bg-background rounded-bl-lg"}`,children:[O.isLoading?u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx(Zr,{size:"sm"}),u.jsx("span",{className:"text-text-muted",children:"Thinking..."})]}):u.jsx(C0,{html:j(O.text),className:"prose dark:prose-invert max-w-none text-sm"}),O.actions&&O.actions.length>0&&u.jsx("div",{className:"mt-3 pt-3 border-t border-border/50 flex flex-wrap gap-2",children:O.actions.map((q,ee)=>q.action!=="NO_ACTION"&&u.jsx($e,{size:"sm",variant:"secondary",onClick:()=>U(q),children:q.confirmationMessage},ee))})]})]},O.id)),u.jsx("div",{ref:w})]})}),u.jsxs("footer",{className:"flex-shrink-0 p-4 border-t border-border relative",children:[_&&L.length>0&&u.jsxs("div",{className:"absolute bottom-full left-4 right-4 mb-2 bg-surface border border-border rounded-lg shadow-2xl max-h-48 overflow-y-auto z-10 animate-fade-in",children:[u.jsx("div",{className:"p-2 text-xs font-bold text-text-muted uppercase border-b border-border",children:"Reference Content"}),L.map(O=>u.jsxs("button",{className:"w-full text-left px-4 py-2 hover:bg-primary/10 flex items-center gap-2 text-sm transition-colors",onClick:()=>G(O),children:[u.jsx(ze,{name:O.type==="deck"?"laptop":O.type==="series"?"layers":"folder",className:"w-4 h-4 text-text-muted"}),u.jsx("span",{className:"truncate",children:O.name})]},`${O.type}-${O.id}`))]}),u.jsxs("form",{onSubmit:Q,className:"flex items-center gap-2",children:[u.jsx("input",{ref:S,type:"text",value:f,onChange:F,placeholder:"Ask a question or type @ to reference...",className:"flex-grow p-2 bg-background border border-border rounded-full focus:ring-2 focus:ring-primary focus:outline-none px-4",autoFocus:!0}),u.jsx($e,{type:"submit",variant:"primary",className:"rounded-full w-10 h-10 p-0","aria-label":"Send message",children:u.jsx(ze,{name:"arrow-down",className:"w-5 h-5 -rotate-90"})})]})]})]}),u.jsx("style",{children:`
              @keyframes slideUp {
                from { transform: translateY(100%); }
                to { transform: translateY(0); }
              }
            `})]}):null},B2=({isOpen:n,onClose:a,onRestore:s,files:i})=>{const[l,c]=B.useState(""),d=B.useRef(null);Mn(d,n);const m=()=>{l&&s(l)};return n?u.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-[60] p-4",children:u.jsxs("div",{ref:d,className:"bg-white dark:bg-gray-800 rounded-lg shadow-xl w-full max-w-lg transform transition-all relative max-h-[90vh] flex flex-col",children:[u.jsxs("div",{className:"flex-shrink-0 flex justify-between items-center p-4 border-b border-gray-200 dark:border-gray-700",children:[u.jsx("h2",{className:"text-xl font-bold",children:"Restore from Google Drive"}),u.jsx($e,{type:"button",variant:"ghost",onClick:a,className:"p-1 h-auto",children:u.jsx(ze,{name:"x"})})]}),u.jsxs("div",{className:"p-6 overflow-y-auto",children:[u.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-4",children:"Select a backup file to restore. Restoring will overwrite decks with the same ID."}),i.length>0?u.jsx("div",{className:"space-y-2 border border-gray-200 dark:border-gray-700 rounded-md",children:i.map(p=>u.jsxs("label",{className:"flex items-center p-3 hover:bg-gray-100 dark:hover:bg-gray-700/50 cursor-pointer border-b border-gray-200 dark:border-gray-700 last:border-b-0",children:[u.jsx("input",{type:"radio",name:"backup-file",value:p.id,checked:l===p.id,onChange:()=>c(p.id),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 dark:border-gray-600 dark:bg-gray-900"}),u.jsxs("div",{className:"ml-3 text-sm",children:[u.jsx("p",{className:"font-medium text-gray-900 dark:text-gray-100",children:p.name}),u.jsxs("p",{className:"text-gray-500 dark:text-gray-400",children:["Last modified: ",new Date(p.modifiedTime).toLocaleString()]})]})]},p.id))}):u.jsx("div",{className:"text-center py-8 text-gray-500 dark:text-gray-400",children:u.jsx("p",{children:"No backup files found in your Google Drive application folder."})})]}),u.jsxs("div",{className:"flex-shrink-0 flex justify-end p-4 bg-gray-100/50 dark:bg-gray-900/50 border-t border-gray-200 dark:border-gray-700",children:[u.jsx($e,{type:"button",variant:"secondary",onClick:a,className:"mr-2",children:"Cancel"}),u.jsx($e,{type:"button",variant:"danger",onClick:m,disabled:!l,children:"Restore Selected"})]})]})}):null},lb=n=>{var a,s;return n.type===je.Flashcard?((a=n.cards)==null?void 0:a.length)||0:((s=n.questions)==null?void 0:s.length)||0},gh=({label:n,localValue:a,remoteValue:s})=>u.jsxs("div",{className:"text-sm",children:[u.jsxs("span",{className:"font-semibold",children:[n,": "]}),u.jsx("span",{className:"text-text-muted",children:a}),u.jsx(ze,{name:"arrow-down",className:"inline w-3 h-3 mx-1 rotate-[-90deg]"}),u.jsx("span",{className:"text-primary font-semibold",children:s})]}),H2=({isOpen:n,onClose:a,onResolve:s,comparison:i,remoteData:l})=>{const c=B.useRef(null);Mn(c,n);const{seriesProgress:d}=Ze(),[m,p]=B.useState({decks:{},series:{}}),[f,v]=B.useState(null);B.useMemo(()=>{const k={decks:{},series:{}};i.changedDecks.forEach(w=>k.decks[w.local.id]="remote"),i.changedSeries.forEach(w=>k.series[w.local.id]="remote"),p(k)},[i]);const _=(k,w)=>{p(S=>({...S,[k]:{...S[k],[w]:S[k][w]==="local"?"remote":"local"}})),v("mixed")},T=k=>{const w={decks:{},series:{}};i.changedDecks.forEach(S=>w.decks[S.local.id]=k),i.changedSeries.forEach(S=>w.series[S.local.id]=k),p(w),v(k)},x=()=>{s(m,l)};return n?u.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-[60] p-4",children:u.jsxs("div",{ref:c,className:"bg-surface rounded-lg shadow-xl w-full max-w-2xl transform transition-all relative max-h-[90vh] flex flex-col",role:"alertdialog","aria-modal":"true","aria-labelledby":"conflict-title",children:[u.jsx("div",{className:"flex-shrink-0 flex justify-between items-center p-4 border-b border-border",children:u.jsx("h2",{id:"conflict-title",className:"text-xl font-bold text-yellow-600 dark:text-yellow-400",children:"Sync Conflict"})}),u.jsxs("div",{className:"p-6 overflow-y-auto space-y-4",children:[u.jsx("p",{className:"text-text-muted",children:"Both your local data and the server data have changed since the last sync. Please choose which version to keep for each item."}),u.jsxs("div",{className:"flex gap-2 mb-4",children:[u.jsx($e,{variant:f==="local"?"primary":"secondary",size:"sm",onClick:()=>T("local"),children:"Keep All Local"}),u.jsx($e,{variant:f==="remote"?"primary":"secondary",size:"sm",onClick:()=>T("remote"),children:"Take All Remote"})]}),u.jsxs("div",{className:"space-y-6",children:[(i.newSeries.length>0||i.newDecks.length>0)&&u.jsxs("div",{children:[u.jsxs("h3",{className:"font-semibold text-text mb-2 flex items-center gap-2",children:[u.jsx(ze,{name:"plus",className:"w-4 h-4 text-green-500"}),"New Items on Server (Will be added)"]}),u.jsxs("ul",{className:"text-sm list-disc list-inside text-text-muted bg-background p-3 rounded-md border border-border",children:[i.newSeries.map(k=>u.jsxs("li",{children:['Series: "',k.name,'"']},k.id)),i.newDecks.map(k=>u.jsxs("li",{children:['Deck: "',k.name,'"']},k.id))]})]}),i.changedSeries.length>0&&u.jsxs("div",{children:[u.jsx("h3",{className:"font-semibold text-text mb-2",children:"Changed Series"}),u.jsx("div",{className:"space-y-3",children:i.changedSeries.map(({local:k,backup:w})=>{var G,Q;const S=(k.levels||[]).reduce((U,j)=>{var O;return U+(((O=j.deckIds)==null?void 0:O.length)||0)},0),C=(w.levels||[]).reduce((U,j)=>{var O;return U+(((O=j.deckIds)==null?void 0:O.length)||0)},0),R=((G=d.get(k.id))==null?void 0:G.size)||0,L=(((Q=l.seriesProgress)==null?void 0:Q[w.id])||[]).length,F=m.series[k.id]==="local";return u.jsxs("div",{className:`p-3 rounded-md border transition-colors cursor-pointer ${F?"bg-blue-50 dark:bg-blue-900/20 border-blue-200 dark:border-blue-800":"bg-green-50 dark:bg-green-900/20 border-green-200 dark:border-green-800"}`,onClick:()=>_("series",k.id),children:[u.jsxs("div",{className:"flex justify-between items-center mb-2",children:[u.jsx("p",{className:"font-bold",children:k.name}),u.jsx("span",{className:`text-xs font-semibold px-2 py-1 rounded ${F?"bg-blue-100 text-blue-700":"bg-green-100 text-green-700"}`,children:F?"Keeping Local":"Taking Server"})]}),u.jsx(gh,{label:"Progress",localValue:`${R}/${S}`,remoteValue:`${L}/${C}`}),u.jsx("p",{className:"text-xs text-text-muted mt-2 text-right",children:"Tap to toggle"})]},k.id)})})]}),i.changedDecks.length>0&&u.jsxs("div",{children:[u.jsx("h3",{className:"font-semibold text-text mb-2",children:"Changed Decks"}),u.jsx("div",{className:"space-y-3",children:i.changedDecks.map(({local:k,backup:w})=>{const S=i.dueCounts.get(`local-${k.id}`)||0,C=i.dueCounts.get(w.id)||0,R=m.decks[k.id]==="local";return u.jsxs("div",{className:`p-3 rounded-md border transition-colors cursor-pointer ${R?"bg-blue-50 dark:bg-blue-900/20 border-blue-200 dark:border-blue-800":"bg-green-50 dark:bg-green-900/20 border-green-200 dark:border-green-800"}`,onClick:()=>_("decks",k.id),children:[u.jsxs("div",{className:"flex justify-between items-center mb-2",children:[u.jsx("p",{className:"font-bold",children:k.name}),u.jsx("span",{className:`text-xs font-semibold px-2 py-1 rounded ${R?"bg-blue-100 text-blue-700":"bg-green-100 text-green-700"}`,children:R?"Keeping Local":"Taking Server"})]}),u.jsx(gh,{label:"Items",localValue:lb(k),remoteValue:lb(w)}),u.jsx(gh,{label:"Due",localValue:S,remoteValue:C}),u.jsx("p",{className:"text-xs text-text-muted mt-2 text-right",children:"Tap to toggle"})]},k.id)})})]})]})]}),u.jsxs("div",{className:"flex-shrink-0 flex justify-between items-center p-4 bg-background/50 border-t border-border",children:[u.jsx($e,{type:"button",variant:"danger",onClick:a,children:"Cancel Sync"}),u.jsxs($e,{variant:"primary",onClick:x,children:[u.jsx(ze,{name:"check-circle",className:"mr-2"}),"Resolve & Merge"]})]})]})}):null},vl=n=>{if(!n)return"";try{return new DOMParser().parseFromString(n,"text/html").body.textContent||""}catch{return String(n).replace(/<[^>]+>/g,"")}},XT=async(n,a=24e3)=>{const s=atob(n),i=s.length,l=new Uint8Array(i);for(let T=0;T<i;T++)l[T]=s.charCodeAt(T);const c=window.AudioContext||window.webkitAudioContext,d=new c({sampleRate:a}),m=new Int16Array(l.buffer),p=1,f=m.length/p,v=d.createBuffer(p,f,a);for(let T=0;T<p;T++){const x=v.getChannelData(T);for(let k=0;k<f;k++)x[k]=m[k*p+T]/32768}const _=d.createBufferSource();return _.buffer=v,_.connect(d.destination),_.start(),new Promise(T=>{_.onended=()=>{d.close(),T()}})},G2=({isOpen:n,onClose:a,actions:s})=>{const[i,l]=B.useState(""),[c,d]=B.useState(0),m=B.useRef(null),p=B.useRef(null),{navigate:f}=Ka(),v=Fh(),_=Bh();Mn(m,n);const T=B.useMemo(()=>{const F=[];return s.forEach(G=>F.push({type:"action",id:G.id,label:G.label,icon:G.icon,run:G.action,keywords:G.keywords,searchableOnly:G.searchableOnly})),v.filter(G=>!G.archived&&!G.deletedAt).forEach(G=>F.push({type:"deck",id:G.id,name:G.name,itemType:G.type})),_.filter(G=>!G.archived&&!G.deletedAt).forEach(G=>F.push({type:"series",id:G.id,name:G.name})),v.filter(G=>!G.archived&&!G.deletedAt).forEach(G=>{G.type==="flashcard"?(G.cards||[]).forEach(Q=>F.push({type:"card",id:Q.id,deckId:G.id,deckName:G.name,front:Q.front})):(G.questions||[]).forEach(Q=>F.push({type:"question",id:Q.id,deckId:G.id,deckName:G.name,text:Q.questionText}))}),F},[s,v,_]),x=B.useMemo(()=>{if(!i.trim())return T.filter(Q=>Q.type==="action"&&!Q.searchableOnly);const F=i.toLowerCase();return T.filter(Q=>{switch(Q.type){case"action":{const U=Q,j=U.label.toLowerCase().includes(F),O=(U.keywords||[]).some(q=>q.toLowerCase().includes(F));return j||O}case"deck":return Q.name.toLowerCase().includes(F);case"series":return Q.name.toLowerCase().includes(F);case"card":return vl(Q.front).toLowerCase().includes(F);case"question":return Q.text.toLowerCase().includes(F);default:return!1}}).slice(0,50)},[i,T]),k=B.useMemo(()=>{const F={Actions:[],Series:[],Decks:[],Cards:[]};return x.forEach(G=>{G.type==="action"?F.Actions.push(G):G.type==="series"?F.Series.push(G):G.type==="deck"?F.Decks.push(G):(G.type==="card"||G.type==="question")&&F.Cards.push(G)}),Object.entries(F).filter(([,G])=>G.length>0)},[x]),w=B.useMemo(()=>k.flatMap(([,F])=>F),[k]),S=B.useCallback(F=>{switch(F.type){case"action":F.run();break;case"deck":f(`/decks/${F.id}`);break;case"series":f(`/series/${F.id}`);break;case"card":case"question":f(`/decks/${F.deckId}`);break}a()},[f,a]);B.useEffect(()=>{const F=G=>{if(n)if(G.key==="ArrowDown")G.preventDefault(),d(Q=>(Q+1)%(w.length||1));else if(G.key==="ArrowUp")G.preventDefault(),d(Q=>(Q-1+(w.length||1))%(w.length||1));else if(G.key==="Enter"){G.preventDefault();const Q=w[c];Q&&S(Q)}else G.key==="Escape"&&a()};return window.addEventListener("keydown",F),()=>window.removeEventListener("keydown",F)},[n,c,w,S,a]),B.useEffect(()=>{n&&(l(""),d(0))},[n]),B.useEffect(()=>{d(0)},[i]),B.useEffect(()=>{var F;(F=document.getElementById(`cmdk-item-${c}`))==null||F.scrollIntoView({block:"nearest"})},[c]);const C=F=>{F.target===F.currentTarget&&a()};if(!n)return null;const R=(F,G)=>{let Q,U="",j;switch(F.type){case"action":Q=F.icon,U=F.label;break;case"deck":Q="help-circle",F.itemType===je.Flashcard?Q="laptop":F.itemType===je.Learning&&(Q="layers"),U=F.name;break;case"series":Q="layers",U=F.name;break;case"card":Q="laptop",U=vl(F.front),j=`In: ${F.deckName}`;break;case"question":Q="help-circle",U=F.text,j=`In: ${F.deckName}`;break}return u.jsxs("li",{id:`cmdk-item-${G}`,role:"option","aria-selected":c===G,onClick:()=>S(F),className:`flex items-center gap-4 px-4 py-3 cursor-pointer rounded-md ${c===G?"bg-primary/10":"hover:bg-border/30"}`,children:[u.jsx(ze,{name:Q,className:"w-5 h-5 text-text-muted flex-shrink-0"}),u.jsxs("div",{className:"flex-grow min-w-0",children:[u.jsx("p",{className:`font-medium truncate ${c===G?"text-primary":"text-text"}`,children:U}),j&&u.jsx("p",{className:`text-sm truncate ${c===G?"text-primary/80":"text-text-muted"}`,children:j})]})]},F.id)};let L=0;return u.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-70 flex justify-center items-start pt-4 sm:pt-[15vh] z-[60] p-4",onClick:C,children:u.jsxs("div",{ref:m,role:"dialog","aria-modal":"true",className:"bg-surface rounded-lg shadow-xl w-full max-w-2xl transform transition-all relative max-h-[70vh] flex flex-col",children:[u.jsxs("div",{className:"flex items-center gap-2 p-4 border-b border-border",children:[u.jsx(ze,{name:"search",className:"w-5 h-5 text-text-muted"}),u.jsx("input",{type:"text",value:i,onChange:F=>l(F.target.value),placeholder:"Search for anything or type a command...",className:"w-full bg-transparent focus:outline-none text-lg placeholder:text-text-muted",autoFocus:!0}),u.jsx("div",{className:"hidden sm:block text-xs text-text-muted border border-border rounded px-1.5 py-0.5",children:"ESC"})]}),u.jsx("div",{className:"flex-grow overflow-y-auto p-2",children:w.length>0?u.jsx("ul",{ref:p,role:"listbox",children:k.map(([F,G])=>u.jsxs("li",{children:[u.jsx("p",{className:"px-4 py-2 text-xs font-semibold text-text-muted uppercase tracking-wider",children:F}),u.jsx("ul",{className:"space-y-1",children:G.map(Q=>R(Q,L++))})]},F))}):u.jsx("div",{className:"text-center py-10 px-4",children:u.jsxs("p",{className:"text-text-muted",children:['No results found for "',i,'".']})})}),u.jsx("div",{className:"hidden sm:flex flex-shrink-0 justify-end items-center p-2 border-t border-border",children:u.jsxs("span",{className:"text-sm text-text-muted",children:[u.jsx(ze,{name:"terminal",className:"inline-block w-4 h-4 mr-2"}),u.jsx("kbd",{className:"font-sans",children:"Cmd+K"})," to toggle"]})})]})})},q2=({isOpen:n,onClose:a,onAddDeck:s})=>{const[i,l]=B.useState(""),{addToast:c}=jn(),d=B.useRef(null);Mn(d,n);const m=`{
  "name": "New Quiz Deck Name",
  "description": "A description for the new deck.",
  "questions": [
    {
      "questionText": "What is 2+2?",
      "options": [{"id":"1","text":"4"}, {"id":"2","text":"3"}],
      "correctAnswerId": "1",
      "detailedExplanation": "It's basic math.",
      "tags": []
    }
  ]
}`,p=v=>{if(v.preventDefault(),!i.trim()){c("JSON content cannot be empty.","error");return}try{const _=_u(i);if(_.type!==je.Quiz){c("The provided JSON is not a valid Quiz Deck format.","error");return}const T={id:crypto.randomUUID(),name:_.data.name,description:_.data.description,type:je.Quiz,questions:_.data.questions.map(x=>({...x,id:crypto.randomUUID(),questionType:"multipleChoice",dueDate:new Date().toISOString(),interval:0,easeFactor:2.5,suspended:!1,lapses:0,masteryLevel:0,detailedExplanation:x.detailedExplanation||"",options:x.options.map(k=>({id:k.id||crypto.randomUUID(),text:k.text,explanation:k.explanation}))}))};s(T),c(`Successfully created and added deck: "${T.name}"`,"success"),a()}catch(_){c(_ instanceof Error?_.message:"Invalid JSON format.","error")}},f=v=>{if(v.key==="Tab"){v.preventDefault();const _=v.target,T=_.selectionStart,x=_.selectionEnd;_.value=_.value.substring(0,T)+"  "+_.value.substring(x),_.selectionStart=_.selectionEnd=T+2}};return n?u.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-[60] p-4",children:u.jsx("div",{ref:d,className:"bg-surface rounded-lg shadow-xl w-full max-w-2xl transform transition-all relative",children:u.jsxs("form",{onSubmit:p,children:[u.jsxs("div",{className:"flex justify-between items-center p-4 border-b border-border",children:[u.jsx("h2",{className:"text-xl font-bold",children:"Add New Deck to Series"}),u.jsx($e,{type:"button",variant:"ghost",onClick:a,className:"p-1 h-auto",children:u.jsx(ze,{name:"x"})})]}),u.jsxs("div",{className:"p-6",children:[u.jsx("label",{htmlFor:"json-content",className:"block text-sm font-medium text-text-muted mb-1",children:"Paste a complete quiz deck object in JSON format."}),u.jsx("textarea",{id:"json-content",value:i,onChange:v=>l(v.target.value),onKeyDown:f,rows:15,className:"w-full p-2 bg-background border border-border rounded-md focus:ring-2 focus:ring-primary focus:outline-none font-mono text-sm",placeholder:m})]}),u.jsxs("div",{className:"flex justify-end p-4 bg-background/50 border-t border-border",children:[u.jsx($e,{type:"button",variant:"secondary",onClick:a,className:"mr-2",children:"Cancel"}),u.jsx($e,{type:"submit",variant:"primary",children:"Create & Add Deck"})]})]})})}):null},P2=({isOpen:n,onClose:a,badJson:s,onRetry:i,onCancel:l})=>{const[c,d]=B.useState(s),{addToast:m}=jn(),p=B.useRef(null);Mn(p,n);const f=()=>{try{const T=JSON.parse(c);i(T),a()}catch(T){m(`Still not valid JSON. ${T.message}`,"error")}},v=()=>{l(),a()},_=T=>{if(T.key==="Tab"){T.preventDefault();const x=T.target,k=x.selectionStart,w=x.selectionEnd;x.value=x.value.substring(0,k)+"  "+x.value.substring(w),x.selectionStart=x.selectionEnd=k+2}};return n?u.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-[70] p-4",children:u.jsxs("div",{ref:p,className:"bg-surface rounded-lg shadow-xl w-full max-w-3xl transform transition-all relative max-h-[90vh] flex flex-col",children:[u.jsxs("div",{className:"flex-shrink-0 flex justify-between items-center p-4 border-b border-border",children:[u.jsx("h2",{className:"text-xl font-bold",children:"Fix AI Response"}),u.jsx($e,{type:"button",variant:"ghost",onClick:v,className:"p-1 h-auto",children:u.jsx(ze,{name:"x"})})]}),u.jsxs("div",{className:"flex-grow p-6 space-y-4 overflow-y-auto",children:[u.jsxs("div",{className:"bg-yellow-900/10 border border-yellow-500/30 rounded-lg p-4 text-sm text-yellow-800 dark:text-yellow-200",children:[u.jsxs("p",{children:[u.jsx("strong",{className:"font-bold",children:"Error:"})," The AI returned malformed JSON. This can happen if the response is too long and gets cut off. You can try to fix it manually below."]}),u.jsx("p",{className:"mt-2",children:'Common fixes include adding a missing closing quote (`"`) or bracket/brace (`]` or `}`).'})]}),u.jsxs("div",{children:[u.jsx("label",{htmlFor:"json-fix-content",className:"block text-sm font-medium text-text-muted mb-1",children:"Edit JSON response:"}),u.jsx("textarea",{id:"json-fix-content",value:c,onChange:T=>d(T.target.value),onKeyDown:_,rows:20,className:"w-full p-2 bg-background border border-border rounded-md focus:ring-2 focus:ring-primary focus:outline-none font-mono text-sm"})]})]}),u.jsxs("div",{className:"flex-shrink-0 flex justify-end p-4 bg-background/50 border-t border-border",children:[u.jsx($e,{type:"button",variant:"secondary",onClick:v,className:"mr-2",children:"Cancel"}),u.jsxs($e,{type:"button",variant:"primary",onClick:f,children:[u.jsx(ze,{name:"refresh-ccw",className:"w-4 h-4 mr-2"}),"Retry with Fix"]})]})]})}):null},$2=({isOpen:n,onClose:a,params:s})=>{const[i,l]=B.useState([]),[c,d]=B.useState(!0),[m,p]=B.useState(""),[f,v]=B.useState({}),[_,T]=B.useState(""),{options:x}=Du();uo();const{addToast:k}=jn(),{dispatch:w,deckSeries:S}=Ze(),C=B.useRef(null),R=B.useRef(!1);B.useEffect(()=>{var Q;(Q=C.current)==null||Q.scrollIntoView({behavior:"smooth"})},[i]),B.useEffect(()=>{if(!n){R.current=!1;return}if(R.current)return;R.current=!0,(async()=>{d(!0),l([]);const U=x.personas.find(q=>q.id===s.persona)||x.personas[0],j=s.seriesId?S[s.seriesId]:null,O=j?{name:j.name,description:j.description}:void 0;try{const{outline:q,metadata:ee}=await FE(s,U,O);p(q),v(ee),l([{id:crypto.randomUUID(),role:"model",text:`Here is a draft outline for your ${s.generationType.startsWith("series-")?"series":"deck"} on "${s.topic}":

${q}`}])}catch(q){const ee=q instanceof Error?q.message:"Failed to generate initial outline.";k(ee,"error"),l([{id:crypto.randomUUID(),role:"model",text:`Sorry, I couldn't generate an outline. Error: ${ee}`}])}finally{d(!1)}})()},[n,s,x.personas,k,S]);const L=async Q=>{Q.preventDefault();const U=_.trim();if(!U||c)return;T("");const j={id:crypto.randomUUID(),role:"user",text:U},O=[...i,j];l(O),d(!0);const q=x.personas.find(ee=>ee.id===s.persona)||x.personas[0];try{const ee=await BE(O,s,q);p(ee),l(M=>[...M,{id:crypto.randomUUID(),role:"model",text:`Here is the refined outline:

${ee}`}])}catch(ee){const M=ee instanceof Error?ee.message:"Failed to refine outline.";k(M,"error"),l(J=>[...J,{id:crypto.randomUUID(),role:"model",text:`Sorry, I had trouble with that request. Error: ${M}`}])}finally{d(!1)}},F=async()=>{const Q=crypto.randomUUID(),{generationType:U}=s;if(U.startsWith("series-")){const j={id:Q,type:"generateFullSeriesFromScaffold",payload:{outline:m,generationType:s.generationType},statusText:`Generating series structure for "${s.topic}"`};w({type:"ADD_AI_TASK_TO_QUEUE",payload:j}),k("Series generation started. Check the status indicator below.","info")}else if(["deck-flashcard","deck-vocab","deck-atomic"].includes(U)){const j={id:Q,type:"generateFlashcardDeckWithAI",payload:s,statusText:`Generating flashcards for "${s.topic}"`};w({type:"ADD_AI_TASK_TO_QUEUE",payload:j}),k("Flashcard generation started. Check the status indicator below.","info")}else if(["single-deck-learning","deck-course"].includes(U)){const j={id:Q,type:"generateLearningDeckWithAI",payload:s,statusText:`Generating learning content for "${s.topic}"`};w({type:"ADD_AI_TASK_TO_QUEUE",payload:j}),k("Learning content generation started. Check the status indicator below.","info")}else if(["single-deck-quiz","quiz-blooms"].includes(U)){const j={id:Q,type:"generateDeckFromOutline",payload:{outline:m,metadata:f,seriesId:s.seriesId,levelIndex:s.levelIndex},statusText:`Generating deck content for "${s.topic}"`};w({type:"ADD_AI_TASK_TO_QUEUE",payload:j}),k("Deck generation started. Check the status indicator below.","info")}a()},G=Q=>Q.replace(/^### (.*$)/gim,'<h3 class="text-lg font-bold mt-2">$1</h3>').replace(/^## (.*$)/gim,'<h2 class="text-xl font-bold mt-3 border-b border-border pb-1">$1</h2>').replace(/^# (.*$)/gim,'<h1 class="text-2xl font-bold mt-4 mb-2">$1</h1>').replace(/\*\*(.*?)\*\*/g,"<b>$1</b>").replace(/\*(.*?)\*/g,"<i>$1</i>").replace(/^- (.*$)/gim,'<li class="ml-4">$1</li>').replace(/```([\s\S]*?)```/g,'<pre class="bg-gray-800 text-white p-2 rounded my-2 overflow-x-auto text-xs"><code>$1</code></pre>').replace(/`([^`]+)`/g,'<code class="bg-gray-200 dark:bg-gray-700 px-1 rounded text-sm font-mono">$1</code>').replace(/\n/g,"<br />");return n?u.jsxs("div",{className:"fixed inset-0 bg-black/50 z-[70] flex flex-col items-center justify-end",onClick:a,children:[u.jsxs("div",{className:"bg-surface w-full max-w-3xl h-[85vh] max-h-[800px] rounded-t-2xl shadow-2xl flex flex-col transform transition-transform duration-300 animate-fade-in",style:{animationName:"slideUp",animationDuration:"0.3s"},onClick:Q=>Q.stopPropagation(),children:[u.jsxs("header",{className:"flex-shrink-0 flex items-center justify-between p-4 border-b border-border",children:[u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx(ze,{name:"bot",className:"w-6 h-6 text-primary"}),u.jsx("h2",{className:"text-xl font-bold text-text",children:"AI Content Generation"})]}),u.jsx($e,{variant:"ghost",onClick:a,className:"p-1 h-auto",children:u.jsx(ze,{name:"x"})})]}),u.jsx("main",{className:"flex-grow p-4 overflow-y-auto",children:u.jsxs("div",{className:"space-y-4",children:[i.map(Q=>u.jsxs("div",{className:`flex gap-3 ${Q.role==="user"?"justify-end":"justify-start"}`,children:[Q.role==="model"&&u.jsx(ze,{name:"bot",className:"w-6 h-6 text-primary flex-shrink-0 mt-1"}),u.jsx("div",{className:`max-w-xl p-3 rounded-2xl ${Q.role==="user"?"bg-primary text-on-primary rounded-br-lg":"bg-background rounded-bl-lg"}`,children:u.jsx(C0,{html:G(Q.text),className:"prose dark:prose-invert max-w-none text-sm"})})]},Q.id)),c&&u.jsxs("div",{className:"flex justify-start gap-3",children:[u.jsx(ze,{name:"bot",className:"w-6 h-6 text-primary flex-shrink-0 mt-1"}),u.jsx("div",{className:"max-w-xl p-3 rounded-2xl bg-background rounded-bl-lg",children:u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx(Zr,{size:"sm"}),u.jsx("span",{className:"text-text-muted",children:"Thinking..."})]})})]}),u.jsx("div",{ref:C})]})}),u.jsxs("footer",{className:"flex-shrink-0 p-4 border-t border-border space-y-3",children:[u.jsxs("form",{onSubmit:L,className:"flex items-center gap-2",children:[u.jsx("input",{type:"text",value:_,onChange:Q=>T(Q.target.value),placeholder:"Refine the outline...",className:"flex-grow p-2 bg-background border border-border rounded-full focus:ring-2 focus:ring-primary focus:outline-none px-4",disabled:c}),u.jsx($e,{type:"submit",variant:"secondary",className:"rounded-full w-10 h-10 p-0","aria-label":"Send message",disabled:c,children:u.jsx(ze,{name:"arrow-down",className:"w-5 h-5 -rotate-90"})})]}),u.jsxs("div",{className:"flex justify-end gap-2",children:[u.jsx($e,{variant:"secondary",onClick:a,disabled:c,children:"Cancel"}),u.jsxs($e,{variant:"primary",onClick:F,disabled:c||i.length===0,children:[u.jsx(ze,{name:"zap",className:"w-5 h-5 mr-2"}),`Generate ${s.generationType.startsWith("series-")?"Series":"Deck"}`]})]})]})]}),u.jsx("style",{children:`
              @keyframes slideUp {
                from { transform: translateY(100%); }
                to { transform: translateY(0); }
              }
            `})]}):null},Y2=({isOpen:n,onClose:a,deck:s,onUpdateDeck:i})=>{const[l,c]=B.useState("analyzing"),[d,m]=B.useState([]),[p,f]=B.useState(new Set),{addToast:v}=jn(),_=B.useRef(null);Mn(_,n),B.useEffect(()=>{n&&l==="analyzing"&&(async()=>{try{const C=await WE(s);m(C),f(new Set(C.map(R=>R.id))),c("review")}catch{v("Analysis failed. Please try again.","error"),a()}})()},[n,s,v,a,l]);const T=S=>{const C=new Set(p);C.has(S)?C.delete(S):C.add(S),f(C)},x=async()=>{c("applying");try{const S=d.filter(R=>p.has(R.id)),C=await e1(s,S);i(C,{toastMessage:"Deck improvements applied successfully!"}),a()}catch{v("Failed to apply improvements.","error"),c("review")}},k=B.useMemo(()=>{const S={general:{label:"General Improvements",icon:"zap",items:[]},chapters:{label:"Chapters (InfoCards)",icon:"book-open",items:[]},questions:{label:"Questions & Quizzes",icon:"help-circle",items:[]}};return d.forEach(C=>{if(!C.targetId){S.general.items.push(C);return}if(s.type===je.Learning&&s.infoCards.some(L=>L.id===C.targetId)){S.chapters.items.push(C);return}S.questions.items.push(C)}),Object.entries(S).filter(([C,R])=>R.items.length>0)},[d,s]),w=S=>{var L,F;if(!S)return null;if(s.type===je.Learning){const G=s.infoCards.find(Q=>Q.id===S);if(G)return`Chapter: ${vl(G.content).substring(0,40)}...`}const C=(L=s.questions)==null?void 0:L.find(G=>G.id===S);if(C)return`Question: ${vl(C.questionText).substring(0,40)}...`;const R=(F=s.cards)==null?void 0:F.find(G=>G.id===S);return R?`Card: ${vl(R.front).substring(0,40)}...`:null};return n?u.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-[70] p-4",children:u.jsxs("div",{ref:_,className:"bg-surface rounded-lg shadow-xl w-full max-w-2xl transform transition-all relative flex flex-col max-h-[90vh]",children:[u.jsxs("header",{className:"flex-shrink-0 flex justify-between items-center p-4 border-b border-border",children:[u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx(ze,{name:"zap",className:"w-6 h-6 text-primary"}),u.jsx("h2",{className:"text-xl font-bold text-text",children:"AI Deck Analyzer"})]}),u.jsx($e,{type:"button",variant:"ghost",onClick:a,className:"p-1 h-auto","aria-label":"Close",children:u.jsx(ze,{name:"x"})})]}),u.jsxs("main",{className:"flex-grow p-6 overflow-y-auto no-scrollbar",children:[l==="analyzing"&&u.jsxs("div",{className:"flex flex-col items-center justify-center h-64 text-center",children:[u.jsx(Zr,{size:"lg"}),u.jsx("p",{className:"mt-4 text-lg font-medium text-text",children:"Analyzing deck content..."}),u.jsx("p",{className:"text-sm text-text-muted",children:"Checking for pedagogical alignment, accuracy, and clarity."})]}),l==="applying"&&u.jsxs("div",{className:"flex flex-col items-center justify-center h-64 text-center",children:[u.jsx(Zr,{size:"lg"}),u.jsx("p",{className:"mt-4 text-lg font-medium text-text",children:"Applying improvements..."}),u.jsx("p",{className:"text-sm text-text-muted",children:"Rewriting content and refining instructional flow."})]}),l==="review"&&u.jsxs("div",{className:"space-y-6",children:[u.jsxs("div",{className:"flex justify-between items-center bg-background p-3 rounded-lg border border-border",children:[u.jsxs("p",{className:"text-sm text-text-muted",children:["Pedagogical Review for ",u.jsx("b",{children:s.name})]}),u.jsxs("div",{className:"text-xs space-x-3",children:[u.jsx("button",{onClick:()=>f(new Set(d.map(S=>S.id))),className:"text-primary font-semibold hover:underline",children:"Select All"}),u.jsx("button",{onClick:()=>f(new Set),className:"text-text-muted font-semibold hover:underline",children:"Clear"})]})]}),d.length===0?u.jsxs("div",{className:"text-center py-10 border-2 border-dashed border-border rounded-lg",children:[u.jsx(ze,{name:"check-circle",className:"w-12 h-12 text-green-500 mx-auto mb-2"}),u.jsx("p",{className:"text-text font-medium",children:"No pedagogical issues found!"}),u.jsx("p",{className:"text-text-muted text-sm",children:"Your learning deck is structured perfectly."})]}):u.jsx("div",{className:"space-y-8",children:k.map(([S,C])=>u.jsxs("section",{className:"animate-fade-in",children:[u.jsxs("h3",{className:"text-xs font-bold text-text-muted uppercase tracking-widest mb-3 flex items-center gap-2",children:[u.jsx(ze,{name:C.icon,className:"w-4 h-4"}),C.label]}),u.jsx("ul",{className:"space-y-3",children:C.items.map(R=>{const L=w(R.targetId);return u.jsxs("li",{className:"p-4 bg-background rounded-lg border border-border flex gap-4 transition-all hover:border-primary/50 group",children:[u.jsx("div",{className:"pt-1",children:u.jsx("input",{type:"checkbox",checked:p.has(R.id),onChange:()=>T(R.id),className:"w-5 h-5 text-primary rounded border-gray-300 focus:ring-primary cursor-pointer"})}),u.jsxs("div",{className:"flex-grow min-w-0",children:[u.jsxs("div",{className:"flex justify-between items-start mb-1",children:[u.jsx("h4",{className:"font-bold text-text leading-tight",children:R.title}),u.jsx("span",{className:"text-[10px] px-2 py-0.5 rounded-full bg-surface border border-border font-bold uppercase tracking-tighter text-text-muted whitespace-nowrap ml-2",children:R.category})]}),L&&u.jsx("p",{className:"text-[10px] font-semibold text-primary/80 mb-2 truncate italic",children:L}),u.jsx("p",{className:"text-sm text-text leading-relaxed",children:R.description}),u.jsxs("div",{className:"mt-2 flex items-start gap-1 text-xs text-text-muted bg-primary/5 p-2 rounded italic",children:[u.jsx(ze,{name:"info",className:"w-3.5 h-3.5 flex-shrink-0 mt-0.5 text-primary"}),u.jsx("span",{children:R.rationale})]})]})]},R.id)})})]},S))})]})]}),u.jsx("footer",{className:"flex-shrink-0 p-4 border-t border-border flex justify-end gap-2 bg-background/50",children:l==="review"&&u.jsxs(u.Fragment,{children:[u.jsx($e,{variant:"secondary",onClick:a,children:"Cancel"}),u.jsxs($e,{variant:"primary",onClick:x,disabled:p.size===0,children:["Apply ",p.size," Improvement",p.size!==1?"s":""]})]})})]})}):null},V2=(n,a,s,i)=>{const l=[],c=[];n.forEach(p=>{if(p.suspended)return;const f={id:p.id,dueDate:p.dueDate,interval:p.interval,easeFactor:p.easeFactor,lapses:p.lapses,masteryLevel:p.masteryLevel||0,isNew:p.interval===0};f.isNew?c.push(f):l.push(f)});const d=[],m=new Date;m.setHours(0,0,0,0);for(let p=0;p<a;p++){const f=new Date(m);f.setDate(m.getDate()+p);const v=new Date(f).setHours(23,59,59,999),_=[],T=[];l.forEach(w=>{new Date(w.dueDate).getTime()<=v?_.push(w):T.push(w)});const x=[];_.forEach(w=>{const C=Math.random()<i?kr.Good:kr.Again;let R=0,L=w.easeFactor;C===kr.Again?(R=1,L=Math.max(1.3,w.easeFactor-.2)):(L=w.easeFactor,w.interval===0?R=1:R=Math.ceil(w.interval*w.easeFactor));const F=new Date(f);F.setDate(f.getDate()+R);const G={...w,interval:R,easeFactor:L,dueDate:F.toISOString(),isNew:!1};x.push(G)}),x.forEach(w=>T.push(w)),l.length=0,T.forEach(w=>l.push(w));const k=Math.min(s,c.length);for(let w=0;w<k;w++){const S=c.shift();if(S){const C=new Date(f);C.setDate(f.getDate()+1);const R={...S,interval:1,dueDate:C.toISOString(),isNew:!1};l.push(R)}}d.push({day:p,date:f.toLocaleDateString(void 0,{month:"short",day:"numeric"}),reviewCount:_.length,newCount:k,totalLoad:_.length+k})}return d},K2=({data:n})=>{if(n.length===0)return null;const a=Math.max(...n.map(v=>v.totalLoad),10),s=500,i=250,l={top:20,right:10,bottom:30,left:40},c=s-l.left-l.right,d=i-l.top-l.bottom,m=n,p=Math.max(2,c/m.length-1),f=v=>d-v/a*d;return u.jsxs("svg",{viewBox:`0 0 ${s} ${i}`,className:"w-full h-full overflow-visible",children:[[0,.25,.5,.75,1].map(v=>{const _=Math.round(a*v),T=f(_)+l.top;return u.jsxs("g",{children:[u.jsx("line",{x1:l.left,y1:T,x2:s-l.right,y2:T,className:"stroke-border/50",strokeDasharray:"3,3"}),u.jsx("text",{x:l.left-5,y:T+4,className:"text-[10px] fill-text-muted",textAnchor:"end",children:_})]},v)}),m.map((v,_)=>{const T=l.left+_*(c/m.length),x=f(v.totalLoad)+l.top,k=d-f(v.totalLoad),w=v.newCount/v.totalLoad*k||0,S=k-w,C=x,R=x+w;return u.jsxs("g",{className:"group",children:[u.jsx("title",{children:`${v.date}: ${v.reviewCount} reviews + ${v.newCount} new = ${v.totalLoad} total`}),v.newCount>0&&u.jsx("rect",{x:T,y:C,width:p,height:w,className:"fill-blue-400 dark:fill-blue-500 hover:fill-blue-300 transition-colors"}),v.reviewCount>0&&u.jsx("rect",{x:T,y:R,width:p,height:S,className:"fill-green-500 dark:fill-green-600 hover:fill-green-400 transition-colors"})]},_)}),m.map((v,_)=>_%Math.ceil(m.length/5)===0?u.jsx("text",{x:l.left+_*(c/m.length)+p/2,y:i-10,className:"text-[10px] fill-text-muted",textAnchor:"middle",children:v.date},_):null)]})},Z2=({isOpen:n,onClose:a,items:s})=>{const[i,l]=B.useState(30),[c,d]=B.useState(0),[m,p]=B.useState(90),[f,v]=B.useState(!1),[_,T]=B.useState([]),x=B.useRef(null);Mn(x,n),B.useEffect(()=>{if(!n)return;v(!0);const w=setTimeout(()=>{const S=V2(s,i,c,m/100);T(S),v(!1)},100);return()=>clearTimeout(w)},[i,c,m,s,n]);const k=B.useMemo(()=>{if(_.length===0)return null;const w=Math.max(..._.map(R=>R.totalLoad)),S=Math.round(_.reduce((R,L)=>R+L.totalLoad,0)/_.length),C=_.reduce((R,L)=>R+L.newCount,0);return{maxLoad:w,avgLoad:S,totalNew:C}},[_]);return n?u.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-[60] p-4",children:u.jsxs("div",{ref:x,className:"bg-surface rounded-lg shadow-xl w-full max-w-3xl transform transition-all relative max-h-[90vh] flex flex-col",children:[u.jsxs("div",{className:"flex justify-between items-center p-4 border-b border-border",children:[u.jsxs("h2",{className:"text-xl font-bold text-text flex items-center gap-2",children:[u.jsx(ze,{name:"trending-up",className:"text-primary"})," Workload Simulator"]}),u.jsx($e,{type:"button",variant:"ghost",onClick:a,className:"p-1 h-auto",children:u.jsx(ze,{name:"x"})})]}),u.jsx("div",{className:"p-6 overflow-y-auto flex-grow space-y-6",children:u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[u.jsxs("div",{className:"space-y-4 md:col-span-1 border-b md:border-b-0 md:border-r border-border pb-4 md:pb-0 md:pr-4",children:[u.jsxs("div",{children:[u.jsxs("label",{className:"block text-sm font-medium text-text-muted mb-1",children:["Duration: ",i," days"]}),u.jsx("input",{type:"range",min:"7",max:"180",step:"7",value:i,onChange:w=>l(Number(w.target.value)),className:"w-full accent-primary"})]}),u.jsxs("div",{children:[u.jsxs("label",{className:"block text-sm font-medium text-text-muted mb-1",children:["New Cards / Day: ",c]}),u.jsx("input",{type:"range",min:"0",max:"50",step:"5",value:c,onChange:w=>d(Number(w.target.value)),className:"w-full accent-primary"})]}),u.jsxs("div",{children:[u.jsxs("label",{className:"block text-sm font-medium text-text-muted mb-1",children:["Est. Retention: ",m,"%"]}),u.jsx("input",{type:"range",min:"70",max:"99",step:"1",value:m,onChange:w=>p(Number(w.target.value)),className:"w-full accent-primary"})]}),k&&u.jsxs("div",{className:"bg-background rounded-lg p-3 space-y-2 text-sm border border-border",children:[u.jsxs("div",{className:"flex justify-between",children:[u.jsx("span",{className:"text-text-muted",children:"Peak Load:"}),u.jsx("span",{className:"font-bold text-text",children:k.maxLoad})]}),u.jsxs("div",{className:"flex justify-between",children:[u.jsx("span",{className:"text-text-muted",children:"Average Load:"}),u.jsx("span",{className:"font-bold text-text",children:k.avgLoad})]}),u.jsxs("div",{className:"flex justify-between",children:[u.jsx("span",{className:"text-text-muted",children:"Total New:"}),u.jsx("span",{className:"font-bold text-blue-500",children:k.totalNew})]})]})]}),u.jsxs("div",{className:"md:col-span-2 h-64 md:h-auto flex flex-col",children:[u.jsxs("div",{className:"flex items-center gap-4 text-xs text-text-muted mb-2 justify-end",children:[u.jsxs("div",{className:"flex items-center gap-1",children:[u.jsx("span",{className:"w-3 h-3 bg-blue-400 rounded-sm"})," New Cards"]}),u.jsxs("div",{className:"flex items-center gap-1",children:[u.jsx("span",{className:"w-3 h-3 bg-green-500 rounded-sm"})," Reviews"]})]}),u.jsx("div",{className:"flex-grow relative bg-background/50 rounded-lg border border-border p-2",children:f?u.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-surface/50 backdrop-blur-sm",children:u.jsx(Zr,{size:"lg"})}):u.jsx(K2,{data:_})}),u.jsx("p",{className:"text-xs text-text-muted mt-2 text-center",children:"This is a projection based on the SM-2 algorithm. Actual workload may vary."})]})]})}),u.jsx("div",{className:"flex justify-end p-4 bg-background/50 border-t border-border",children:u.jsx($e,{type:"button",variant:"primary",onClick:a,children:"Done"})})]})}):null},Q2=({isOpen:n,onClose:a,data:s,title:i,filename:l="data.json"})=>{const c=B.useRef(null),{addToast:d}=jn();Mn(c,n);const m=ii.useMemo(()=>JSON.stringify(s,null,2),[s]),p=()=>{navigator.clipboard.writeText(m).then(()=>{d("JSON copied to clipboard!","success")}).catch(v=>{d("Failed to copy JSON.","error")})},f=()=>{const v=new Blob([m],{type:"application/json"}),_=URL.createObjectURL(v),T=document.createElement("a");T.href=_,T.download=l,document.body.appendChild(T),T.click(),document.body.removeChild(T),URL.revokeObjectURL(_),d("Download started.","success")};return n?u.jsx("div",{className:"fixed inset-0 bg-black/75 flex items-center justify-center z-[70] p-4",children:u.jsxs("div",{ref:c,className:"bg-surface rounded-lg shadow-xl w-full max-w-2xl transform transition-all relative max-h-[90vh] flex flex-col",children:[u.jsxs("header",{className:"flex-shrink-0 flex justify-between items-center p-4 border-b border-border",children:[u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx(ze,{name:"code",className:"w-6 h-6 text-primary"}),u.jsx("h2",{className:"text-xl font-bold text-text",children:i})]}),u.jsx($e,{type:"button",variant:"ghost",onClick:a,className:"p-1 h-auto",children:u.jsx(ze,{name:"x"})})]}),u.jsx("main",{className:"flex-grow p-4 overflow-hidden flex flex-col",children:u.jsx("div",{className:"flex-grow bg-background rounded-lg border border-border overflow-auto p-4 font-mono text-xs text-text-muted",children:u.jsx("pre",{children:m})})}),u.jsxs("footer",{className:"flex-shrink-0 p-4 border-t border-border flex justify-end gap-2 bg-background/50",children:[u.jsxs($e,{variant:"secondary",onClick:p,children:[u.jsx(ze,{name:"save",className:"w-4 h-4 mr-2"})," Copy to Clipboard"]}),u.jsxs($e,{variant:"primary",onClick:f,children:[u.jsx(ze,{name:"download",className:"w-4 h-4 mr-2"})," Download .json"]})]})]})}):null},J2=({driveFiles:n})=>{const{modalType:a,modalPayload:s,closeModal:i,openModal:l}=Rl(),c=uo(),{aiChatHistory:d}=Ze(),m=Fh(),{navigate:p}=Ka();if(!a)return null;const f=s||{},v=()=>m.reduce((_,T)=>T.type===je.Flashcard?_.concat(T.cards||[]):_.concat(T.questions||[]),[]);return u.jsxs(u.Fragment,{children:[a==="import"&&u.jsx(i1,{isOpen:!0,onClose:i,onAddDecks:c.handleAddDecks,onAddSeriesWithDecks:c.handleAddSeriesWithDecks}),a==="restore"&&u.jsx(l1,{isOpen:!0,onClose:i,onCompare:c.handleCompareBackup,onRestoreSelected:c.handleRestoreSelectedItems,file:f.file,onFullRestore:c.onRestoreData,openConfirmModal:_=>l("confirm",_)}),a==="resetProgress"&&u.jsx(c1,{isOpen:!0,onClose:i,onReset:c.handleResetDeckProgress,decks:m}),a==="confirm"&&u.jsx(u1,{isOpen:!0,onClose:i,...f}),a==="folder"&&u.jsx(d1,{isOpen:!0,onClose:i,onSave:c.handleSaveFolder,folder:f.folder==="new"?null:f.folder}),a==="series"&&u.jsx(f1,{isOpen:!0,onClose:i,onSave:c.handleSaveSeries,series:f.series==="new"?null:f.series}),a==="aiGeneration"&&u.jsx(g1,{isOpen:!0,onClose:i,onStartAIGeneration:c.handleStartAIGeneration,initialTopic:f.initialTopic,context:f.context}),a==="aiGenerationChat"&&u.jsx($2,{isOpen:!0,onClose:i,params:f.params}),a==="aiStatus"&&u.jsx(y1,{isOpen:!0,onClose:i,onCancel:c.handleCancelAIGeneration}),a==="serverBackup"&&u.jsx(m2,{isOpen:!0,onClose:i,onRestore:c.handleRestoreFromServerBackup,onDelete:c.handleDeleteServerBackup}),a==="droppedFile"&&u.jsx(p2,{isOpen:!0,onClose:i,onConfirm:c.handleDroppedFileConfirm,analysis:f.analysis}),a==="aiChat"&&u.jsx(F2,{isOpen:!0,onClose:i,onExecuteAction:c.handleExecuteAIAction,history:d}),a==="restoreFromDrive"&&u.jsx(B2,{isOpen:!0,onClose:i,onRestore:c.handleRestoreFromDrive,files:n}),a==="addDeckToSeries"&&u.jsx(q2,{isOpen:!0,onClose:i,onAddDeck:_=>c.handleAddDeckToSeries(f.seriesId,_)}),a==="mergeConflict"&&u.jsx(H2,{isOpen:!0,onClose:i,onResolve:c.handleMergeResolution,comparison:f.comparison,remoteData:f.remoteData}),a==="commandPalette"&&u.jsx(G2,{isOpen:!0,onClose:i,actions:[{id:"import",label:"Create / Import Deck",icon:"plus",action:()=>l("import"),keywords:["new","add"]},{id:"settings",label:"Settings",icon:"settings",action:()=>p("/settings")},{id:"trash",label:"View Trash",icon:"trash-2",action:()=>p("/trash")},{id:"archive",label:"View Archive",icon:"archive",action:()=>p("/archive")},{id:"progress",label:"View Progress",icon:"trending-up",action:()=>p("/progress")},{id:"simulate",label:"Simulate Workload",icon:"trending-up",action:()=>l("workloadSimulator")}]}),a==="aiResponseFix"&&u.jsx(P2,{isOpen:!0,onClose:i,...f}),a==="deckAnalysis"&&u.jsx(Y2,{isOpen:!0,onClose:i,deck:f.deck,onUpdateDeck:c.handleUpdateDeck}),a==="workloadSimulator"&&u.jsx(Z2,{isOpen:!0,onClose:i,items:v()}),a==="viewJson"&&u.jsx(Q2,{isOpen:!0,onClose:i,...f})]})},X2=({onOpen:n,onCancel:a})=>{const{currentTask:s,queue:i,streamingDrafts:l}=Ze(x=>x.aiGenerationStatus),{aiFeaturesEnabled:c}=Za(),d=s!==null,m=(i==null?void 0:i.length)||0,p=(d?1:0)+m;if(!c||p===0)return null;const f=(s==null?void 0:s.type)==="generateDeepCourse",v=Object.keys(l).pop(),_=v?l[v].slice(-60):null,T=_?`...${_}`:(s==null?void 0:s.statusText)||`${m} task(s) queued...`;return u.jsxs("div",{className:"fixed bottom-6 left-6 z-40",children:[u.jsxs("button",{onClick:n,className:`bg-surface rounded-lg shadow-lg flex items-center p-2 gap-3 transition-all hover:shadow-xl animate-fade-in border-l-4 ${d?"border-primary":"border-text-muted"} min-w-[240px]`,"aria-label":"View AI generation status",children:[u.jsxs("div",{className:"relative w-10 h-10 flex items-center justify-center flex-shrink-0",children:[u.jsx("svg",{className:"absolute w-full h-full",style:{animation:d?"spin 1.5s linear infinite":"none"},viewBox:"0 0 24 24",children:u.jsx("circle",{cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"2",fill:"none",className:d?"text-primary/50":"text-text-muted/50",strokeDasharray:d?"40 100":"5 15"})}),u.jsx(ze,{name:f?"layers":"bot",className:`w-6 h-6 ${d?"text-primary":"text-text-muted"}`})]}),u.jsxs("div",{className:"flex flex-col text-left pr-2 flex-grow min-w-0",children:[u.jsx("span",{className:"font-semibold text-sm text-text truncate",children:d?f?"Synthesizing Course...":"AI is working...":"AI Queue"}),u.jsx("span",{className:"text-[10px] text-text-muted truncate font-mono italic",title:T,children:T})]}),p>0&&u.jsx("div",{className:"bg-primary text-on-primary text-[10px] font-bold rounded-full h-5 w-5 flex items-center justify-center self-center flex-shrink-0",children:p})]}),u.jsx("style",{children:`
                @keyframes spin {
                    from { transform: rotate(0deg); }
                    to { transform: rotate(360deg); }
                }
            `})]})},W2=()=>{const{openModal:n}=Rl(),{aiFeaturesEnabled:a}=Za(),s=()=>{n("aiChat")};return a?u.jsx("div",{className:"fixed bottom-6 right-6 z-40 animate-fade-in",children:u.jsx($e,{variant:"primary",onClick:s,className:"rounded-full w-16 h-16 shadow-lg flex items-center justify-center","aria-label":"Open AI Assistant",children:u.jsx(ze,{name:"bot",className:"w-8 h-8"})})}):null},eT=()=>{const n=()=>{const i=navigator,l=i.connection;return{isOnline:i.onLine,isMetered:l?l.type==="cellular"||l.saveData===!0:!1}},[a,s]=B.useState(n);return B.useEffect(()=>{const i=()=>s(n()),c=navigator.connection;return window.addEventListener("online",i),window.addEventListener("offline",i),c==null||c.addEventListener("change",i),()=>{window.removeEventListener("online",i),window.removeEventListener("offline",i),c==null||c.removeEventListener("change",i)}},[]),a},tT=()=>{const{isOnline:n}=eT();return n?null:u.jsx("div",{role:"status","aria-live":"assertive",title:"You are currently offline",className:"fixed bottom-6 right-6 z-50 bg-surface rounded-full w-12 h-12 shadow-lg flex items-center justify-center border-2 border-border animate-fade-in",children:u.jsx(ze,{name:"wifi-off",className:"w-6 h-6 text-text-muted"})})},nT=({pullDistance:n,isRefreshing:a,threshold:s})=>{if(a)return u.jsx("div",{className:"fixed top-0 left-0 right-0 h-20 flex items-center justify-center z-50 transition-all duration-300",children:u.jsx(Zr,{size:"md"})});if(n<=0)return null;const i=Math.min(n/s,1),l=i>=1,c=Math.min(.5+i*.5,1),d=20,m=2*Math.PI*d,p=m-i*m;return u.jsx("div",{className:"fixed top-0 left-0 right-0 h-20 flex items-center justify-center z-10 pointer-events-none",style:{transform:`translateY(${Math.min(n,s*1.5)-80}px) scale(${c})`,opacity:Math.min(n/(s/2),1)},children:u.jsxs("div",{className:"relative w-12 h-12 flex items-center justify-center bg-white dark:bg-gray-800 rounded-full shadow-lg transition-transform duration-200",style:{transform:l?"scale(1.1)":"scale(1)"},children:[u.jsxs("svg",{className:"absolute w-full h-full transform -rotate-90",viewBox:"0 0 44 44",children:[u.jsx("circle",{className:"text-gray-300/50 dark:text-gray-600/50",stroke:"currentColor",strokeWidth:"4",fill:"transparent",r:d,cx:"22",cy:"22"}),u.jsx("circle",{className:"text-blue-500",stroke:"currentColor",strokeWidth:"4",strokeLinecap:"round",fill:"transparent",r:d,cx:"22",cy:"22",style:{strokeDasharray:m,strokeDashoffset:p,transition:l?"stroke-dashoffset 0.1s linear":"none"}})]}),u.jsx(ze,{name:l?"refresh-ccw":"arrow-down",className:`w-6 h-6 transition-colors duration-200 ${l?"text-blue-500":"text-gray-500 dark:text-gray-400"}`})]})})},rT=10,aT=()=>{const[n,a]=B.useState(!0),s=B.useRef(0),i=B.useRef(!1),l=B.useCallback(()=>{const c=window.scrollY;c<=0||c<s.current?a(!0):c>s.current&&c>rT&&a(!1),s.current=c},[]);return B.useEffect(()=>{const c=()=>{i.current||(window.requestAnimationFrame(()=>{l(),i.current=!1}),i.current=!0)};return window.addEventListener("scroll",c,{passive:!0}),()=>window.removeEventListener("scroll",c)},[l]),n},cu=120,sT=()=>{const[n,a]=B.useState({startY:0,pullDistance:0,isRefreshing:!1,thresholdMet:!1}),{hapticsEnabled:s}=Za(),i=B.useCallback(d=>{if(d.touches.length===0)return;const m=d.target;window.scrollY===0&&!m.closest('input, textarea, button, a[href], select, [role="button"], [role="switch"]')?a(p=>({...p,startY:d.touches[0].clientY,pullDistance:0,isRefreshing:!1,thresholdMet:!1})):a(p=>({...p,startY:0}))},[]),l=B.useCallback(d=>{if(n.startY===0||d.touches.length===0)return;const m=d.touches[0].clientY-n.startY;m>5&&(d.preventDefault(),m>cu&&!n.thresholdMet&&s&&"vibrate"in navigator&&navigator.vibrate(50),a(f=>({...f,pullDistance:m,thresholdMet:m>cu})))},[n.startY,n.thresholdMet,s]),c=B.useCallback(()=>{n.startY!==0&&(n.pullDistance>cu?(a(d=>({...d,isRefreshing:!0})),setTimeout(()=>{window.location.reload()},500)):a({startY:0,pullDistance:0,isRefreshing:!1,thresholdMet:!1}))},[n.startY,n.pullDistance]);return{pullToRefreshState:n,handleTouchStart:i,handleTouchMove:l,handleTouchEnd:c,REFRESH_THRESHOLD:cu}},iT=()=>{const{dispatch:n,aiGenerationStatus:a,isLoading:s}=Ze(),i=uo(),l=aT(),{pullToRefreshState:c,handleTouchStart:d,handleTouchMove:m,handleTouchEnd:p,REFRESH_THRESHOLD:f}=sT(),[v,_]=B.useState(!1),[T,x]=B.useState([]),[k,w]=B.useState(!1);B.useEffect(()=>{(async()=>{const{currentTask:F,queue:G}=a;if(!F&&G&&G.length>0){const Q=G[0],U=new AbortController;n({type:"START_NEXT_AI_TASK",payload:{task:Q,abortController:U}});try{switch(Q.type){case"generateDeepCourse":await i.onGenerateDeepCourse(Q.payload,U.signal);break;case"generateDeckFromOutline":await i.onGenerateDeckFromOutline(Q.payload.outline,Q.payload.metadata,Q.payload.seriesId,Q.payload.levelIndex,U.signal,Q.deckId);break;case"generateFullSeriesFromScaffold":await i.onGenerateFullSeriesFromScaffold(Q.payload,U.signal);break;case"generateFlashcardDeckWithAI":await i.onGenerateFlashcardDeck(Q.payload,U.signal);break;case"generateLearningDeckWithAI":await i.onGenerateLearningDeckWithAI(Q.payload,U.signal);break;case"autoPopulateSeries":await i.onAutoPopulateSeries(Q.payload,U.signal);break;case"autoPopulateLevel":await i.onAutoPopulateLevel(Q.payload,U.signal);break;case"generateQuestionsForDeck":await i.onGenerateQuestionsForDeck(Q.payload.deck,Q.payload.count,void 0,U.signal);break;case"generateSeriesLearningContentInBatches":await i.onGenerateLearningContentForDeck(Q.payload,U.signal);break;case"generateSeriesQuestionsInBatches":await i.onGenerateSeriesQuestionsInBatches(Q.payload,U.signal);break;case"regenerateQuestion":await i.onRegenerateQuestion(Q.payload,U.signal);break;case"upgradeDeckToLearning":await i.onUpgradeDeckToLearning(Q.payload,U.signal);break;case"hardenAllDistractors":await i.onHardenAllDistractors(Q.payload,U.signal);break;case"generateAudioForAllCards":await i.onGenerateAudioForAllCards(Q.payload,U.signal);break;case"rework-deck":await i.onReworkDeckContent(Q.payload,U.signal);break}}catch(j){j instanceof Error&&j.message!=="Cancelled by user"&&(console.error("AI Task Failed:",j),i.addToast(`Generation failed: ${j.message}`,"error"))}finally{n({type:"FINISH_CURRENT_AI_TASK"})}}})()},[a,n,i]);const S=B.useCallback(L=>{L.preventDefault(),L.stopPropagation(),L.dataTransfer.types.includes("Files")&&w(!0)},[]),C=B.useCallback(L=>{L.preventDefault(),L.stopPropagation(),(L.currentTarget===L.target||!L.currentTarget.contains(L.relatedTarget))&&w(!1)},[]),R=B.useCallback(async L=>{var Q;L.preventDefault(),L.stopPropagation(),w(!1);const F=(Q=L.dataTransfer.files)==null?void 0:Q[0];if(!F)return;const G=await zb(F);G?i.openModal("droppedFile",{analysis:G}):i.addToast("Unrecognized file format. Please drop a JSON, Anki, or Image file.","error")},[i]);return s?null:u.jsxs("div",{className:"min-h-screen bg-background text-text selection:bg-primary selection:text-on-primary transition-colors duration-300 relative",onTouchStart:d,onTouchMove:m,onTouchEnd:p,onDragOver:S,onDragLeave:C,onDrop:R,children:[k&&u.jsxs("div",{className:"fixed inset-0 z-[100] bg-primary/20 backdrop-blur-sm border-4 border-dashed border-primary m-4 rounded-2xl flex flex-col items-center justify-center animate-fade-in pointer-events-none",children:[u.jsx("div",{className:"bg-surface p-8 rounded-full shadow-2xl scale-110 mb-6",children:u.jsx(ze,{name:"upload-cloud",className:"w-16 h-16 text-primary"})}),u.jsx("h2",{className:"text-3xl font-bold text-primary bg-surface/80 px-6 py-2 rounded-lg backdrop-blur-md",children:"Drop to Import"}),u.jsx("p",{className:"text-primary font-medium mt-2",children:"JSON, Anki, CSV, or Image"})]}),u.jsx(nT,{pullDistance:c.pullDistance,isRefreshing:c.isRefreshing,threshold:f}),u.jsx(iS,{onOpenMenu:()=>_(!0),onOpenCommandPalette:()=>i.openModal("commandPalette"),activeDeck:i.activeDeck,isVisible:l}),u.jsx(lS,{isOpen:v,onClose:()=>_(!1),onImport:()=>i.openModal("import"),onCreateSeries:()=>i.openModal("series",{series:"new"}),onGenerateAI:()=>i.openModal("aiGeneration"),onInstall:null}),u.jsx("main",{className:"container mx-auto px-4 pt-24 pb-20 sm:px-6 lg:px-8 max-w-7xl min-h-[calc(100vh-4rem)]",children:u.jsx(sS,{})}),u.jsx(J2,{driveFiles:T}),u.jsx(X2,{onOpen:()=>i.openModal("aiStatus"),onCancel:i.handleCancelAIGeneration}),u.jsx(W2,{}),u.jsx(tT,{})]})};class oT extends ii.Component{constructor(a){super(a),this.handleReload=()=>{window.location.reload()},this.handleCopyReport=()=>{const s=this.state,{error:i,errorInfo:l}=s,c=`
Error Report
Date: ${new Date().toISOString()}
URL: ${window.location.href}
User Agent: ${navigator.userAgent}

Error: ${i==null?void 0:i.toString()}

Stack Trace:
${i==null?void 0:i.stack}

Component Stack:
${l==null?void 0:l.componentStack}
    `.trim();navigator.clipboard.writeText(c).then(()=>{alert("Error report copied to clipboard.")}).catch(d=>{console.error("Failed to copy report:",d),alert("Failed to copy report to clipboard.")})},this.state={hasError:!1,error:null,errorInfo:null}}static getDerivedStateFromError(a){return{hasError:!0,error:a,errorInfo:null}}componentDidCatch(a,s){console.error("Uncaught error:",a,s),this.setState({errorInfo:s})}render(){const a=this.state,s=this.props,{hasError:i,error:l}=a,{children:c}=s;return i?u.jsx("div",{className:"min-h-screen flex items-center justify-center p-4 bg-background",children:u.jsxs("div",{className:"text-center bg-surface p-8 rounded-lg shadow-xl max-w-lg w-full border border-border",children:[u.jsx(ze,{name:"x-circle",className:"w-16 h-16 text-red-500 mx-auto mb-4"}),u.jsx("h1",{className:"text-3xl font-bold text-red-500 mb-4",children:"Something went wrong"}),u.jsx("p",{className:"text-text-muted mb-6",children:"An unexpected error occurred. Please try reloading the page."}),l&&u.jsxs("details",{className:"text-left bg-background p-4 rounded-md mb-6 overflow-auto max-h-64",children:[u.jsx("summary",{className:"cursor-pointer text-sm text-text-muted font-bold",children:"Error Details"}),u.jsx("pre",{className:"mt-2 text-xs text-red-400 whitespace-pre-wrap break-all",children:u.jsx("code",{children:l.toString()})})]}),u.jsxs("div",{className:"flex flex-wrap gap-4 justify-center",children:[u.jsxs($e,{variant:"secondary",onClick:this.handleCopyReport,children:[u.jsx(ze,{name:"file-text",className:"w-4 h-4 mr-2"}),"Copy Report"]}),u.jsxs($e,{variant:"danger",onClick:this.handleReload,children:[u.jsx(ze,{name:"refresh-ccw",className:"w-4 h-4 mr-2"}),"Reload Page"]})]})]})}):c}}const yh="cogniflow-themeId",cb="cogniflow-custom-themes",so=[{id:"system",name:"System",isDark:!1,metaColor:"#f9fafb",metaColorDark:"#111827",palette:{background:"249 250 251",surface:"255 255 255",primary:"37 99 235",text:"17 24 39"},paletteDark:{background:"17 24 39",surface:"31 41 55",primary:"37 99 235",text:"243 244 246"}},{id:"light",name:"Light",isDark:!1,metaColor:"#f9fafb",palette:{background:"249 250 251",surface:"255 255 255",primary:"37 99 235",text:"17 24 39"}},{id:"rose",name:"Rose",isDark:!1,metaColor:"#fff1f2",palette:{background:"255 241 242",surface:"254 226 226",primary:"225 29 72",text:"136 25 55"}},{id:"matcha",name:"Matcha",isDark:!1,metaColor:"#f0fdf4",palette:{background:"240 253 244",surface:"220 252 231",primary:"22 163 74",text:"21 94 53"}},{id:"latte",name:"Latte",isDark:!1,metaColor:"#fffbeb",palette:{background:"255 251 235",surface:"254 243 199",primary:"217 119 6",text:"113 63 18"}},{id:"sky",name:"Sky",isDark:!1,metaColor:"#f0f9ff",palette:{background:"240 249 255",surface:"224 242 254",primary:"14 165 233",text:"7 89 133"}},{id:"sunrise",name:"Sunrise",isDark:!1,metaColor:"#fffbeb",palette:{background:"255 251 235",surface:"254 243 199",primary:"249 115 22",text:"124 45 18"}},{id:"lavender",name:"Lavender",isDark:!1,metaColor:"#f5f3ff",palette:{background:"245 243 255",surface:"237 233 254",primary:"124 58 237",text:"76 29 149"}},{id:"terracotta",name:"Terracotta",isDark:!1,metaColor:"#faf3e8",palette:{background:"250 243 232",surface:"245 233 218",primary:"226 114 91",text:"93 64 55"}},{id:"alabaster",name:"Alabaster",isDark:!1,metaColor:"#fcfcfc",palette:{background:"252 252 252",surface:"255 255 255",primary:"96 165 250",text:"50 50 50"}},{id:"dark",name:"Dark",isDark:!0,metaColor:"#111827",palette:{background:"17 24 39",surface:"31 41 55",primary:"37 99 235",text:"243 244 246"}},{id:"espresso",name:"Espresso",isDark:!0,metaColor:"#211713",palette:{background:"33 23 19",surface:"58 45 39",primary:"196 154 108",text:"224 213 208"}},{id:"midnight",name:"Midnight",isDark:!0,metaColor:"#0c0d11",palette:{background:"12 13 17",surface:"26 27 38",primary:"133 137 230",text:"200 201 215"}}],N0=B.createContext(void 0),ub=(n,a=[])=>{let s=so.find(m=>m.id===n);s||(s=a.find(m=>m.id===n)),s||(s=so[0]);const i=window.document.documentElement,l=document.querySelector('meta[name="theme-color"]');let c,d;if(s.id==="system"?(c=window.matchMedia("(prefers-color-scheme: dark)").matches,d=c?s.metaColorDark:s.metaColor):(c=s.isDark,d=s.metaColor),so.forEach(m=>{m.id!=="system"&&i.classList.remove(`theme-${m.id}`)}),a.forEach(m=>i.classList.remove(`theme-${m.id}`)),i.classList.remove("theme-dark","theme-light"),i.classList.toggle("dark",c),l&&d&&l.setAttribute("content",d),s.isCustom){i.classList.add(`theme-${s.id}`);const m=s.palette;i.style.setProperty("--color-background",m.background),i.style.setProperty("--color-surface",m.surface),i.style.setProperty("--color-primary",m.primary),i.style.setProperty("--color-text",m.text),i.style.setProperty("--color-primary-hover",m.primary),i.style.setProperty("--color-text-muted",m.text),i.style.setProperty("--color-border",m.surface),m.onPrimary?i.style.setProperty("--color-on-primary",m.onPrimary):i.style.setProperty("--color-on-primary","255 255 255")}else i.style.removeProperty("--color-background"),i.style.removeProperty("--color-surface"),i.style.removeProperty("--color-primary"),i.style.removeProperty("--color-text"),i.style.removeProperty("--color-primary-hover"),i.style.removeProperty("--color-text-muted"),i.style.removeProperty("--color-border"),i.style.removeProperty("--color-on-primary"),s.id!=="system"&&i.classList.add(`theme-${s.id}`)},lT=({children:n})=>{const[a,s]=B.useState(()=>{try{const f=localStorage.getItem(cb);return f?JSON.parse(f):[]}catch{return[]}}),[i,l]=B.useState(()=>{try{const f=localStorage.getItem(yh);return so.some(v=>v.id===f)||a.some(v=>v.id===f)?f:"system"}catch(f){return console.error("Could not access localStorage. Defaulting to 'system'.",f),"system"}});B.useEffect(()=>{localStorage.setItem(cb,JSON.stringify(a))},[a]),B.useEffect(()=>{try{localStorage.setItem(yh,i)}catch(f){console.error("Could not set theme in localStorage.",f)}ub(i,a)},[i,a]),B.useEffect(()=>{const f=window.matchMedia("(prefers-color-scheme: dark)"),v=()=>{let _="system";try{_=localStorage.getItem(yh)||"system"}catch{}_==="system"&&ub("system",a)};return f.addEventListener("change",v),()=>f.removeEventListener("change",v)},[a]);const c=B.useCallback(f=>{l(f)},[]),d=B.useCallback(f=>{s(v=>[...v,f]),l(f.id)},[]),m=B.useCallback(f=>{s(v=>v.filter(_=>_.id!==f)),i===f&&l("system")},[i]),p=so.find(f=>f.id===i)||a.find(f=>f.id===i)||so[0];return u.jsx(N0.Provider,{value:{themeId:i,setThemeById:c,currentTheme:p,customThemes:a,addCustomTheme:d,deleteCustomTheme:m},children:n})},WT=()=>{const n=B.useContext(N0);if(n===void 0)throw new Error("useTheme must be used within a ThemeProvider");return n},Xh="cogniflow_v1_",zt=n=>{const a=localStorage.getItem(Xh+n);return a?JSON.parse(a):null},$t=(n,a)=>{localStorage.setItem(Xh+n,JSON.stringify(a))},eo={getAllDecks:async()=>zt("decks")||[],addDecks:async n=>{const a=zt("decks")||[],s=new Map(a.map(i=>[i.id,i]));n.forEach(i=>s.set(i.id,i)),$t("decks",Array.from(s.values()))},updateDeck:async n=>{await eo.addDecks([n])},bulkUpdateDecks:async n=>{await eo.addDecks(n)},deleteDeck:async n=>{const a=zt("decks")||[];$t("decks",a.filter(s=>s.id!==n))},getAllFolders:async()=>zt("folders")||[],addFolder:async n=>{const a=zt("folders")||[];$t("folders",[...a,n])},addFolders:async n=>{const a=zt("folders")||[];$t("folders",[...a,...n])},updateFolder:async n=>{const a=zt("folders")||[],s=a.findIndex(i=>i.id===n.id);s!==-1?(a[s]=n,$t("folders",a)):await eo.addFolder(n)},deleteFolder:async n=>{const a=zt("folders")||[];$t("folders",a.filter(s=>s.id!==n))},getAllDeckSeries:async()=>zt("deckSeries")||[],addDeckSeries:async n=>{const a=zt("deckSeries")||[],s=new Map(a.map(i=>[i.id,i]));n.forEach(i=>s.set(i.id,i)),$t("deckSeries",Array.from(s.values()))},updateDeckSeries:async n=>{await eo.addDeckSeries([n])},deleteDeckSeries:async n=>{const a=zt("deckSeries")||[];$t("deckSeries",a.filter(s=>s.id!==n))},saveSessionState:async(n,a)=>{const s=zt("sessions")||{};s[n]=a,$t("sessions",s)},getSessionState:async n=>(zt("sessions")||{})[n]||null,getAllSessions:async()=>Object.values(zt("sessions")||{}),clearSessions:async()=>$t("sessions",{}),bulkAddSessions:async n=>{const a=zt("sessions")||{};n.forEach(s=>a[s.id]=s),$t("sessions",a)},deleteSessionState:async n=>{const a=zt("sessions")||{};delete a[n],$t("sessions",a)},getAllSessionKeys:async()=>Object.keys(zt("sessions")||{}),addReviewLog:async n=>{const a=zt("reviews")||[];$t("reviews",[...a,n])},getReviewsSince:async n=>(zt("reviews")||[]).filter(s=>new Date(s.timestamp)>=n),getAllReviews:async()=>zt("reviews")||[],clearReviews:async()=>$t("reviews",[]),deleteReviewsForDecks:async n=>{const a=zt("reviews")||[],s=new Set(n);$t("reviews",a.filter(i=>!s.has(i.deckId)))},bulkAddReviews:async n=>{const a=zt("reviews")||[];$t("reviews",[...a,...n])},getReviewsForDeck:async n=>(zt("reviews")||[]).filter(s=>s.deckId===n),saveAIChatHistory:async n=>$t("ai_chat",n),getAIChatHistory:async()=>zt("ai_chat")||[],clearAIChatHistory:async()=>$t("ai_chat",[]),saveSeriesProgress:async(n,a)=>{const s=zt("seriesProgress")||{};s[n]=Array.from(a),$t("seriesProgress",s)},getAllSeriesProgress:async()=>zt("seriesProgress")||{},clearSeriesProgress:async()=>$t("seriesProgress",{}),bulkAddSeriesProgress:async n=>$t("seriesProgress",n),saveLearningProgress:async n=>{const a=zt("learningProgress")||{};a[n.deckId]=n,$t("learningProgress",a)},getAllLearningProgress:async()=>zt("learningProgress")||{},bulkAddLearningProgress:async n=>$t("learningProgress",n),getAllDataForBackup:async()=>{const n=zt("sessions")||{};return{decks:zt("decks")||[],folders:zt("folders")||[],deckSeries:zt("deckSeries")||[],reviews:zt("reviews")||[],sessions:Object.values(n),seriesProgress:zt("seriesProgress")||{},learningProgress:zt("learningProgress")||{}}},exportAllData:async()=>{const n=await eo.getAllDataForBackup();return JSON.stringify(n)},performAtomicRestore:async n=>{$t("decks",n.decks),$t("folders",n.folders),$t("deckSeries",n.deckSeries),$t("reviews",n.reviews);const a=(n.sessions||[]).reduce((s,i)=>(s[i.id]=i,s),{});$t("sessions",a),$t("seriesProgress",n.seriesProgress),$t("learningProgress",n.learningProgress),n.aiChatHistory&&$t("ai_chat",n.aiChatHistory)},factoryReset:async()=>{Object.keys(localStorage).filter(a=>a.startsWith(Xh)).forEach(a=>localStorage.removeItem(a))}},cT=()=>{let n=null,a=null;const s=async()=>n||a||(a=(async()=>{try{if(!(typeof indexedDB<"u"?indexedDB:typeof window<"u"?window.indexedDB:void 0))throw new Error("No IndexedDB support");await m0(),n=s2,console.log("Using IndexedDB for primary storage.")}catch(l){console.warn("IndexedDB initialization failed. Falling back to localStorage.",l),n=eo}return n})(),a),i=l=>async(...c)=>(await s())[l](...c);return{getAllDecks:i("getAllDecks"),addDecks:i("addDecks"),updateDeck:i("updateDeck"),bulkUpdateDecks:i("bulkUpdateDecks"),deleteDeck:i("deleteDeck"),getAllFolders:i("getAllFolders"),addFolder:i("addFolder"),addFolders:i("addFolders"),updateFolder:i("updateFolder"),deleteFolder:i("deleteFolder"),getAllDeckSeries:i("getAllDeckSeries"),addDeckSeries:i("addDeckSeries"),updateDeckSeries:i("updateDeckSeries"),deleteDeckSeries:i("deleteDeckSeries"),saveSessionState:i("saveSessionState"),getSessionState:i("getSessionState"),getAllSessions:i("getAllSessions"),clearSessions:i("clearSessions"),bulkAddSessions:i("bulkAddSessions"),deleteSessionState:i("deleteSessionState"),getAllSessionKeys:i("getAllSessionKeys"),addReviewLog:i("addReviewLog"),getReviewsSince:i("getReviewsSince"),getAllReviews:i("getAllReviews"),clearReviews:i("clearReviews"),deleteReviewsForDecks:i("deleteReviewsForDecks"),bulkAddReviews:i("bulkAddReviews"),getReviewsForDeck:i("getReviewsForDeck"),saveAIChatHistory:i("saveAIChatHistory"),getAIChatHistory:i("getAIChatHistory"),clearAIChatHistory:i("clearAIChatHistory"),saveSeriesProgress:i("saveSeriesProgress"),getAllSeriesProgress:i("getAllSeriesProgress"),clearSeriesProgress:i("clearSeriesProgress"),bulkAddSeriesProgress:i("bulkAddSeriesProgress"),saveLearningProgress:i("saveLearningProgress"),getAllLearningProgress:i("getAllLearningProgress"),bulkAddLearningProgress:i("bulkAddLearningProgress"),getAllDataForBackup:i("getAllDataForBackup"),exportAllData:i("exportAllData"),performAtomicRestore:i("performAtomicRestore"),factoryReset:i("factoryReset")}},rn=cT(),Vr=(n,a,s)=>{const i=new Date;i.setHours(0,0,0,0);const l=a.map(d=>({id:crypto.randomUUID(),text:d.text,explanation:d.explanation})),c=l[a.findIndex(d=>d.correct)];if(!c)throw new Error(`No correct option specified for question: "${n}"`);return{id:crypto.randomUUID(),questionType:"multipleChoice",questionText:n,tags:["nature","sample"],detailedExplanation:s,options:l,correctAnswerId:c.id,dueDate:i.toISOString(),interval:0,easeFactor:Cr,suspended:!1,masteryLevel:0,lastReviewed:void 0,lapses:0}},uT=()=>{const n={id:crypto.randomUUID(),name:"Level 1.1: Simple Addition",description:"Practice basic addition problems.",type:je.Quiz,questions:[Vr("What is 1 + 1?",[{text:"2",correct:!0},{text:"1"},{text:"3"}],"1 plus 1 equals 2."),Vr("What is 2 + 3?",[{text:"5",correct:!0},{text:"4"},{text:"6"}],"2 plus 3 equals 5."),Vr("What is 5 + 4?",[{text:"9",correct:!0},{text:"8"},{text:"10"}],"5 plus 4 equals 9.")]},a={id:crypto.randomUUID(),name:"Level 1.2: Simple Subtraction",description:"Practice basic subtraction problems.",type:je.Quiz,questions:[Vr("What is 5 - 2?",[{text:"3",correct:!0},{text:"2"},{text:"4"}],"5 minus 2 equals 3."),Vr("What is 10 - 4?",[{text:"6",correct:!0},{text:"5"},{text:"7"}],"10 minus 4 equals 6.")]},s={id:crypto.randomUUID(),name:"Level 2.1: Simple Multiplication",description:"Practice basic multiplication problems.",type:je.Quiz,questions:[Vr("What is 2 * 3?",[{text:"6",correct:!0},{text:"5"},{text:"8"}],"2 times 3 is 6."),Vr("What is 4 * 5?",[{text:"20",correct:!0},{text:"15"},{text:"25"}],"4 times 5 is 20.")]},i=[n,a,s];return{series:{id:crypto.randomUUID(),type:"series",name:"Sample: Basic Math Series",description:"A sample series to demonstrate the progressive learning path feature. Complete each deck to unlock the next!",levels:[{title:"Level 1: Fundamentals",deckIds:[n.id,a.id]},{title:"Level 2: Next Steps",deckIds:[s.id]}],createdAt:new Date().toISOString()},decks:i}},db=()=>{const n=[Vr("Which process allows plants to convert light energy into chemical energy?",[{text:"Respiration"},{text:"Photosynthesis",correct:!0},{text:"Transpiration"},{text:"Germination"}],"Photosynthesis is the vital process used by plants, algae, and certain bacteria to harness energy from sunlight and turn it into chemical energy in the form of glucose."),Vr("What is the largest rainforest in the world?",[{text:"The Congo Rainforest"},{text:"The Valdivian Temperate Rainforest"},{text:"The Daintree Rainforest"},{text:"The Amazon Rainforest",correct:!0}],"The Amazon Rainforest is the world's largest tropical rainforest, famed for its biodiversity. It spans across nine countries in South America."),Vr("What type of rock is formed from the cooling and solidification of magma or lava?",[{text:"Igneous Rock",correct:!0},{text:"Sedimentary Rock"},{text:"Metamorphic Rock"},{text:"Sandstone"}],"Igneous rock is formed through the cooling and solidification of magma (molten rock below the surface) or lava (molten rock on the surface). Examples include granite and basalt."),Vr("Which layer of the Earth's atmosphere is closest to the surface?",[{text:"Stratosphere"},{text:"Mesosphere"},{text:"Troposphere",correct:!0},{text:"Thermosphere"}],"The Troposphere is the lowest layer of Earth's atmosphere, and is also where nearly all weather conditions take place. It contains about 75% of the atmosphere's mass."),Vr("What is the name for the process of water movement through a plant and its evaporation from aerial parts, such as leaves, stems and flowers?",[{text:"Condensation"},{text:"Precipitation"},{text:"Transpiration",correct:!0},{text:"Photosynthesis"}],"Transpiration is essentially evaporation of water from plant leaves. It is a key part of the water cycle, and an important process in plant life.")];return{id:crypto.randomUUID(),name:"Sample: Wonders of Nature",description:"A sample quiz deck to introduce you to CogniFlow. Test your knowledge about the natural world!",type:je.Quiz,questions:n,lastOpened:new Date().toISOString()}},dT=()=>({id:crypto.randomUUID(),name:"Sample: Spanish Basics",description:"Common Spanish words and phrases.",type:je.Flashcard,cards:[{id:crypto.randomUUID(),front:"Hola",back:"Hello",dueDate:new Date().toISOString(),interval:0,easeFactor:Cr,masteryLevel:0,lapses:0},{id:crypto.randomUUID(),front:"Gracias",back:"Thank you",dueDate:new Date().toISOString(),interval:0,easeFactor:Cr,masteryLevel:0,lapses:0},{id:crypto.randomUUID(),front:"Por favor",back:"Please",dueDate:new Date().toISOString(),interval:0,easeFactor:Cr,masteryLevel:0,lapses:0},{id:crypto.randomUUID(),front:"Buenos das",back:"Good morning",dueDate:new Date().toISOString(),interval:0,easeFactor:Cr,masteryLevel:0,lapses:0},{id:crypto.randomUUID(),front:"Amigo",back:"Friend",dueDate:new Date().toISOString(),interval:0,easeFactor:Cr,masteryLevel:0,lapses:0}],lastOpened:new Date().toISOString()}),fT=()=>{const n=crypto.randomUUID(),a=crypto.randomUUID(),s=crypto.randomUUID(),i=crypto.randomUUID(),l=[{id:n,content:`<h3>Digital Photography: The Exposure Triangle</h3><p>Exposure is determined by three key elements, often called the "Exposure Triangle":</p><ul><li><b>Aperture:</b> The size of the lens opening (f-stop). Controls depth of field.</li><li><b>Shutter Speed:</b> How long the sensor is exposed to light. Controls motion blur.</li><li><b>ISO:</b> The sensor's sensitivity to light. Controls digital noise.</li></ul><p>Balancing these three is the key to a properly exposed image.</p>`,unlocksQuestionIds:[s]},{id:a,content:"<h3>Digital Photography: Composition</h3><p>Good composition guides the viewer's eye. One of the most fundamental rules is the <b>Rule of Thirds</b>.</p><p>Imagine breaking an image down into thirds (both horizontally and vertically) so that you have 9 parts. The rule suggests that you should place key elements of your scene along these lines or at their intersections.</p>",unlocksQuestionIds:[i]}],c=[{id:s,questionType:"multipleChoice",questionText:"Which element of the exposure triangle primarily controls depth of field (how much of the scene is in focus)?",options:[{id:crypto.randomUUID(),text:"ISO",explanation:"ISO controls sensitivity and noise."},{id:crypto.randomUUID(),text:"Shutter Speed",explanation:"Shutter speed controls motion blur."},{id:crypto.randomUUID(),text:"Aperture",explanation:"Correct! A wide aperture (low f-number) creates a shallow depth of field."}],correctAnswerId:"",detailedExplanation:"Aperture refers to the opening of the lens's diaphragm through which light travels. Large openings (small f-numbers) create a shallow depth of field (blurry background), while small openings (large f-numbers) keep more in focus.",dueDate:new Date().toISOString(),interval:0,easeFactor:Cr,suspended:!1,masteryLevel:0,lapses:0,infoCardIds:[n]},{id:i,questionType:"multipleChoice",questionText:"According to the Rule of Thirds, where is the best place to put your main subject?",options:[{id:crypto.randomUUID(),text:"Dead center",explanation:"Centering is valid but can be static. The Rule of Thirds suggests off-center placement."},{id:crypto.randomUUID(),text:"At the intersections of the grid lines",explanation:'Correct! These "power points" create a more balanced and interesting image.'},{id:crypto.randomUUID(),text:"In the extreme corner",explanation:"This can make the subject feel like it is falling out of the frame."}],correctAnswerId:"",detailedExplanation:"The Rule of Thirds grid creates four intersection points. Placing your subject on one of these points generally creates a more energetic and interesting composition than simply centering the subject.",dueDate:new Date().toISOString(),interval:0,easeFactor:Cr,suspended:!1,masteryLevel:0,lapses:0,infoCardIds:[a]}];return c[0].correctAnswerId=c[0].options[2].id,c[1].correctAnswerId=c[1].options[1].id,{id:crypto.randomUUID(),name:"Sample: Photography Basics",description:"A mini-course covering exposure and composition fundamentals.",type:je.Learning,infoCards:l,questions:c,learningMode:"separate",lastOpened:new Date().toISOString()}};function Wh(n,a,s){const i=new Blob([n],{type:s}),l=URL.createObjectURL(i),c=document.createElement("a");c.style.display="none",c.href=l,c.download=a,document.body.appendChild(c),c.click(),window.URL.revokeObjectURL(l),document.body.removeChild(c)}function em(n){return n.replace(/[^a-z0-9 -]/gi,"_").replace(/\s+/g,"-").toLowerCase().substring(0,30)}const hT=n=>{let a;const s=`cogniflow-deck-${em(n.name)}.json`;if(n.type===je.Flashcard)a=(n.cards||[]).map(d=>({front:d.front,back:d.back}));else if(n.type===je.Quiz||n.type===je.Learning){const l=n,c={name:l.name,description:l.description,type:l.type,questions:(l.questions||[]).map(d=>({questionType:d.questionType,questionText:d.questionText,options:(d.options||[]).map(m=>({id:m.id,text:m.text,explanation:m.explanation})),correctAnswerId:d.correctAnswerId,detailedExplanation:d.detailedExplanation,tags:d.tags}))};if(n.type===je.Learning){const d=n;c.infoCards=d.infoCards,c.learningMode=d.learningMode}a=c}else throw new Error(`Unsupported deck type for export: ${n.type}`);const i=JSON.stringify(a,null,2);Wh(i,s,"application/json")},mT=n=>{if(n.type!==je.Flashcard)throw new Error("CSV export is currently only supported for Flashcard decks.");const s=(n.cards||[]).map(c=>({Front:c.front,Back:c.back})),i=Lb.unparse(s),l=`cogniflow-deck-${em(n.name)}.csv`;Wh(i,l,"text/csv")},pT=(n,a)=>{const s=new Map,i=new Set((n.levels||[]).flatMap(p=>(p==null?void 0:p.deckIds)||[]));a.forEach(p=>{i.has(p.id)&&s.set(p.id,p)});const l=(n.levels||[]).map(p=>{const f=(p.deckIds||[]).map(v=>s.get(v)).filter(v=>!!v).map(v=>{if(v.type===je.Flashcard){const _=v;return{type:je.Flashcard,name:_.name,description:_.description,cards:(_.cards||[]).map(T=>({front:T.front,back:T.back}))}}else if(v.type===je.Quiz||v.type===je.Learning){const _=v,T={type:_.type,name:_.name,description:_.description,questions:(_.questions||[]).map(x=>({questionType:x.questionType,questionText:x.questionText,options:(x.options||[]).map(k=>({id:k.id,text:k.text,explanation:k.explanation})),correctAnswerId:x.correctAnswerId,detailedExplanation:x.detailedExplanation,tags:x.tags}))};if(v.type===je.Learning){const x=v;T.infoCards=x.infoCards,T.learningMode=x.learningMode}return T}return null}).filter(Boolean);return{title:p.title,decks:f}}),c={seriesName:n.name,seriesDescription:n.description,levels:l},d=`cogniflow-series-${em(n.name)}.json`,m=JSON.stringify(c,null,2);Wh(m,d,"application/json")},gT=({triggerSync:n,openConfirmModal:a})=>{const{dispatch:s}=Ze(),{addToast:i}=jn(),l=B.useCallback(async U=>{const j=Object.values(Ze.getState().decks),O=new Set(j.map(ee=>ee.name)),q=U.map(ee=>{let M=ee.name,J=1;for(;O.has(M);)M=`${ee.name} (Copy ${J})`,J++;return O.add(M),{...ee,name:M}});s({type:"ADD_DECKS",payload:q});try{await rn.addDecks(q),n({isManual:!1})}catch(ee){i("Error saving new deck(s).","error"),console.error(ee)}},[s,i,n]),c=B.useCallback(async(U,j)=>{const O={...U,lastModified:Date.now()};s({type:"UPDATE_DECK",payload:O});try{await rn.updateDeck(O),j!=null&&j.silent||(j!=null&&j.toastMessage&&i(j.toastMessage,"success"),n({isManual:!1}))}catch(q){i(`Error updating deck "${U.name}".`,"error"),console.error(q)}},[s,i,n]),d=B.useCallback(async(U,j)=>{const O=U.map(q=>({...q,lastModified:Date.now()}));s({type:"BULK_UPDATE_DECKS",payload:O});try{await rn.bulkUpdateDecks(O),j!=null&&j.silent||n({isManual:!1})}catch{i("Error updating decks.","error")}},[s,n,i]),m=B.useCallback(async(U,j)=>{const O=Ze.getState().decks[U];O&&(await c({...O,folderId:j}),i("Deck moved.","success"))},[c,i]),p=B.useCallback(async U=>{const j=Ze.getState().decks[U];if(j){const O={...j,deletedAt:new Date().toISOString(),archived:!1};await c(O,{toastMessage:`Deck "${j.name}" moved to trash.`})}},[c]),f=B.useCallback(async U=>{const j=Ze.getState().decks[U];j&&await c({...j,deletedAt:null},{toastMessage:`Deck "${j.name}" restored.`})},[c]),v=B.useCallback(async U=>{s({type:"DELETE_DECK",payload:U});try{await rn.deleteDeck(U),i("Deck permanently deleted.","success"),n({isManual:!1})}catch{i("Error deleting deck permanently.","error")}},[s,i,n]),_=B.useCallback(async U=>{if(U.id){const j={id:U.id,name:U.name};s({type:"UPDATE_FOLDER",payload:j});try{await rn.updateFolder(j),i(`Folder renamed to "${j.name}".`,"success"),n({isManual:!1})}catch{i("Error renaming folder.","error")}}else{const j={id:crypto.randomUUID(),name:U.name};s({type:"ADD_FOLDER",payload:j});try{await rn.addFolder(j),i(`Folder "${j.name}" created.`,"success"),n({isManual:!1})}catch{i("Error creating folder.","error")}}},[s,i,n]),T=B.useCallback(async U=>{const j=Ze.getState().folders[U];j&&a({title:"Delete Folder",message:`Are you sure you want to delete the folder "${j.name}"? Decks inside will be moved to the main list.`,onConfirm:async()=>{s({type:"DELETE_FOLDER",payload:U});try{await rn.deleteFolder(U);const O=Object.values(Ze.getState().decks).filter(q=>q.folderId===U);O.length>0&&await rn.bulkUpdateDecks(O.map(q=>({...q,folderId:null}))),i(`Folder "${j.name}" deleted.`,"success"),n({isManual:!1})}catch{i("Error deleting folder.","error")}}})},[s,i,n,a]),x=B.useCallback(U=>{const j=Ze.getState().decks[U];if(j&&j.id!=="general-study-deck"){const O=new Date,q=j.lastOpened?new Date(j.lastOpened):new Date(0);O.getTime()-q.getTime()>5e3&&c({...j,lastOpened:O.toISOString()},{silent:!0})}},[c]),k=B.useCallback(()=>{const U=db();l([U]),i(`Sample quiz "${U.name}" created.`,"success")},[l,i]),w=B.useCallback(()=>{const U=db();l([U]),i(`Sample quiz "${U.name}" created.`,"success")},[l,i]),S=B.useCallback(()=>{const U=dT();l([U]),i(`Sample flashcard deck "${U.name}" created.`,"success")},[l,i]),C=B.useCallback(()=>{const U=fT();l([U]),i(`Sample learning deck "${U.name}" created.`,"success")},[l,i]),R=B.useCallback(async(U,j)=>{const O=Ze.getState().decks[U];if(!O)return;const q=O.infoCards||[],M=q.some(K=>K.id===j.infoCard.id)?q.map(K=>K.id===j.infoCard.id?j.infoCard:K):[...q,j.infoCard],J=O.questions||[],N=new Map(J.map(K=>[K.id,K]));j.questions.forEach(K=>N.set(K.id,K));const se={...O,infoCards:M,questions:Array.from(N.values())};await c(se,{toastMessage:"Learning block saved."})},[c]),L=B.useCallback(async(U,j)=>{var se;const O=Ze.getState().decks[U];if(!O)return;const q=O.infoCards||[],ee=q.filter(K=>K.id!==j),M=new Set(((se=q.find(K=>K.id===j))==null?void 0:se.unlocksQuestionIds)||[]),J=(O.questions||[]).filter(K=>!M.has(K.id)),N={...O,infoCards:ee,questions:J};await c(N,{toastMessage:"Learning block deleted."})},[c]),F=B.useCallback(U=>{try{hT(U),i(`Deck "${U.name}" exported as JSON.`,"success")}catch(j){i(`Failed to export deck: ${j.message}`,"error")}},[i]),G=B.useCallback(U=>{try{mT(U),i(`Deck "${U.name}" exported as CSV.`,"success")}catch(j){i(`Failed to export deck: ${j.message}`,"error")}},[i]),Q=B.useCallback(async U=>{a({title:"Shift Schedule",message:`Are you sure you want to shift all due dates forward by ${U} day(s)? This affects all active cards in all decks.`,confirmText:"Shift Schedule",onConfirm:async()=>{const j=Object.values(Ze.getState().decks),O=[];let q=0;j.forEach(ee=>{let M=!1,J={...ee};if(ee.type===je.Flashcard){const N=ee,se=N.cards.map(K=>{if(!K.suspended&&K.dueDate){const P=new Date(K.dueDate);return P.setDate(P.getDate()+U),q++,M=!0,{...K,dueDate:P.toISOString()}}return K});M&&(J={...N,cards:se})}else{const N=ee,se=N.questions.map(K=>{if(!K.suspended&&K.dueDate){const P=new Date(K.dueDate);return P.setDate(P.getDate()+U),q++,M=!0,{...K,dueDate:P.toISOString()}}return K});M&&(J={...N,questions:se})}M&&O.push(J)}),O.length>0?(await d(O),i(`Schedule shifted! ${q} items moved forward by ${U} days.`,"success")):i("No active items found to shift.","info")}})},[a,d,i]);return B.useMemo(()=>({handleAddDecks:l,handleUpdateDeck:c,handleBulkUpdateDecks:d,handleMoveDeck:m,handleDeleteDeck:p,handleRestoreDeck:f,handleDeleteDeckPermanently:v,handleSaveFolder:_,handleDeleteFolder:T,updateLastOpened:x,handleCreateSampleDeck:k,handleCreateSampleQuizDeck:w,handleCreateSampleFlashcardDeck:S,handleCreateSampleLearningDeck:C,handleSaveLearningBlock:R,handleDeleteLearningBlock:L,handleExportDeck:F,handleExportDeckCSV:G,handleShiftSchedule:Q}),[l,c,d,m,p,f,v,_,T,x,k,w,S,C,R,L,F,G,Q])},yT=({triggerSync:n,handleAddDecks:a,handleUpdateDeck:s})=>{const{dispatch:i}=Ze(),{addToast:l}=jn(),{navigate:c}=Ka(),d=B.useCallback(async(S,C)=>{i({type:"ADD_SERIES_WITH_DECKS",payload:{series:S,decks:C}});try{await rn.addDeckSeries([S]),await rn.addDecks(C),l(`Series "${S.name}" created with ${C.length} deck(s).`,"success"),c(`/series/${S.id}`),n({isManual:!1})}catch{l("Error creating new series.","error")}},[i,l,c,n]),m=B.useCallback(async(S,C)=>{const R={...S,lastModified:Date.now()};i({type:"UPDATE_SERIES",payload:R});try{await rn.updateDeckSeries(R),C!=null&&C.silent||(C!=null&&C.toastMessage&&l(C.toastMessage,"success"),n({isManual:!1}))}catch{l(`Error updating series "${S.name}".`,"error")}},[i,l,n]),p=B.useCallback(async S=>{const C=Ze.getState().deckSeries[S];if(C){const R={...C,deletedAt:new Date().toISOString(),archived:!1};m(R,{toastMessage:`Series "${C.name}" moved to trash.`});const L=new Set((C.levels||[]).flatMap(G=>(G==null?void 0:G.deckIds)||[])),F=Object.values(Ze.getState().decks).filter(G=>L.has(G.id));for(const G of F)s({...G,deletedAt:new Date().toISOString(),archived:!1},{silent:!0})}},[m,s]),f=B.useCallback(async S=>{const C=Ze.getState().deckSeries[S];if(C){m({...C,deletedAt:null},{toastMessage:`Series "${C.name}" restored.`});const R=new Set((C.levels||[]).flatMap(F=>(F==null?void 0:F.deckIds)||[])),L=Object.values(Ze.getState().decks).filter(F=>R.has(F.id));for(const F of L)F.deletedAt&&s({...F,deletedAt:null},{silent:!0})}},[m,s]),v=B.useCallback(async S=>{const C=Ze.getState().deckSeries[S];if(!C)return;const R=new Set((C.levels||[]).flatMap(F=>(F==null?void 0:F.deckIds)||[])),L=Object.values(Ze.getState().decks).filter(F=>R.has(F.id));i({type:"DELETE_SERIES",payload:S});for(const F of L)i({type:"DELETE_DECK",payload:F.id});try{await rn.deleteDeckSeries(S);for(const F of L)await rn.deleteDeck(F.id);l("Series and its decks permanently deleted.","success"),n({isManual:!1})}catch{l("Error deleting series permanently.","error")}},[i,l,n]),_=B.useCallback(async S=>{if(S.id){const C=Ze.getState().deckSeries[S.id];C&&m({...C,name:S.name,description:S.description})}else if(S.scaffold){const{seriesName:C,seriesDescription:R,levels:L}=S.scaffold,F=[],G=(L||[]).map(U=>{const j=(U.decks||[]).map(O=>{const q={id:crypto.randomUUID(),name:O.name,description:O.description};return O.type===je.Quiz?{...q,type:je.Quiz,questions:O.questions||[]}:O.type===je.Learning?{...q,type:je.Learning,questions:O.questions||[],infoCards:O.infoCards||[],learningMode:O.learningMode||"separate"}:O.type===je.Flashcard?{...q,type:je.Flashcard,cards:O.cards||[]}:null}).filter(O=>O!==null);return F.push(...j),{title:U.title,deckIds:j.map(O=>O.id)}}),Q={id:crypto.randomUUID(),type:"series",name:C,description:R,levels:G,archived:!1,createdAt:new Date().toISOString()};await d(Q,F)}else{const C={id:crypto.randomUUID(),type:"series",name:S.name,description:S.description,levels:[],createdAt:new Date().toISOString(),archived:!1};i({type:"ADD_SERIES",payload:C});try{await rn.addDeckSeries([C]),l(`Series "${C.name}" created.`,"success"),c(`/series/${C.id}`)}catch{l("Error saving new series.","error")}}},[i,l,c,m,d]),T=B.useCallback(()=>{const{series:S,decks:C}=uT();d(S,C)},[d]),x=B.useCallback(S=>{const C=Ze.getState().deckSeries[S];if(C){const R=new Date,L=new Date(C.lastOpened||0);R.getTime()-L.getTime()>5e3&&m({...C,lastOpened:R.toISOString()},{silent:!0})}},[m]),k=B.useCallback(async(S,C)=>{const R=Ze.getState().deckSeries[S];if(!R){l("Could not find the series to add the deck to.","error");return}await a([C]);const L=R.levels[R.levels.length-1];if(L){const F={...R,levels:[...R.levels.slice(0,-1),{...L,deckIds:[...L.deckIds,C.id]}]};m(F)}},[a,m,l]),w=B.useCallback(S=>{try{const C=Object.values(Ze.getState().decks);pT(S,C),l(`Series "${S.name}" exported.`,"success")}catch(C){l(`Failed to export series: ${C.message}`,"error")}},[l]);return B.useMemo(()=>({handleAddSeriesWithDecks:d,handleUpdateSeries:m,handleDeleteSeries:p,handleRestoreSeries:f,handleDeleteSeriesPermanently:v,handleSaveSeries:_,handleCreateSampleSeries:T,updateLastOpenedSeries:x,handleAddDeckToSeries:k,handleExportSeries:w}),[d,m,p,f,v,_,T,x,k,w])};function vT(n,a){const s=new Date(n);return s.setDate(s.getDate()+a),s}const eA=(n,a)=>{const s=new Date;s.setHours(0,0,0,0);let i=n.lapses||0;a===kr.Again?i++:i>0&&(i=0);let l=hS[a];a===kr.Again&&i>2&&(l-=(i-2)*.05);let c=n.easeFactor+l;c<Eh&&(c=Eh);let d;if(a===kr.Again)d=uS;else if(n.interval===0)switch(a){case kr.Hard:d=1;break;case kr.Good:d=3;break;case kr.Easy:d=5;break;default:d=1}else{let f=1;a===kr.Hard&&(f=dS),a===kr.Easy&&(f=fS),d=Math.ceil(n.interval*c*f)}const m=vT(s,d),p=Math.min(1,Math.log1p(d)/Math.log1p(90));return{...n,interval:d,easeFactor:c,dueDate:m.toISOString(),lastReviewed:s.toISOString(),masteryLevel:p,lapses:i}},fb=n=>{const a=new Date;return a.setHours(0,0,0,0),{...n,dueDate:a.toISOString(),interval:0,easeFactor:Cr,suspended:!1,masteryLevel:0,lastReviewed:void 0,lapses:0}},bT=n=>{const a=n.masteryLevel||0;if(a===0||!n.lastReviewed||n.suspended)return 0;const s=(n.interval||1)*2,i=new Date(n.lastReviewed),c=Math.max(0,(new Date().getTime()-i.getTime())/(1e3*60*60*24));if(c<=0)return a;const d=Math.pow(.5,c/s);return a*d},dl=n=>{const a=new Date;a.setHours(23,59,59,999);const s=(n.type===je.Quiz||n.type===je.Learning?n.questions:n.cards)||[];return Array.isArray(s)?s.filter(i=>!i.suspended&&new Date(i.dueDate)<=a).length:0},xT=({sessionsToResume:n,setSessionsToResume:a,setGeneralStudyDeck:s,handleUpdateDeck:i})=>{const{navigate:l,path:c}=Ka(),{dispatch:d}=Ze(),{addToast:m}=jn(),p=B.useCallback(async(w,S)=>{const C=`session_deck_${w}`;if(n.has(w)){const R=new Set(n);R.delete(w),a(R)}try{await rn.deleteSessionState(C)}catch(R){console.error(`Failed to clean up session state for ${C} from DB`,R)}w==="general-study-deck"&&s(null),l(S?`/series/${S}`:"/")},[l,n,a,s]),f=B.useCallback(async(w,S,C)=>{const R=`session_deck_${w}`;if(n.has(w)){const L=new Set(n);L.delete(w),a(L)}try{await rn.deleteSessionState(R)}catch(L){console.error(`Failed to clean up session state for ${R} from DB`,L)}w==="general-study-deck"&&s(null),l(`/decks/${C}/study?seriesId=${S}`)},[l,n,a,s]),v=B.useCallback(async(w,S,C,R)=>{const{decks:L,deckSeries:F,seriesProgress:G}=Ze.getState(),Q=L[w];if(!Q)return;let U;const{id:j,dueDate:O,interval:q,easeFactor:ee,suspended:M,masteryLevel:J,lastReviewed:N,lapses:se}=S,K={dueDate:O,interval:q,easeFactor:ee,suspended:M,masteryLevel:J,lastReviewed:N,lapses:se};Q.type===je.Flashcard?U={...Q,cards:(Q.cards||[]).map(P=>P.id===j?{...P,...K}:P)}:Q.type===je.Learning?U={...Q,questions:(Q.questions||[]).map(P=>P.id===j?{...P,...K}:P)}:U={...Q,questions:(Q.questions||[]).map(P=>P.id===j?{...P,...K}:P)},await i(U,{silent:!0});try{const P={itemId:S.id,deckId:w,seriesId:R,timestamp:new Date().toISOString(),rating:C,newInterval:S.interval,easeFactor:S.easeFactor,masteryLevel:S.masteryLevel||0};await rn.addReviewLog(P)}catch(P){console.error("Failed to log review:",P)}if(R){const P=U,ve="cards"in P?P.cards:P.questions,ce=Array.isArray(ve)&&ve.some(z=>!z.suspended&&z.interval===0),Ee=(G.get(R)||new Set).has(w);if(!ce&&!Ee&&(ve==null?void 0:ve.length)>0){const z=new Map(G),I=z.get(R),te=new Set(I instanceof Set?I:[]);te.add(w),z.set(R,te);try{await rn.saveSeriesProgress(R,te);const ae=F[R],$=((ae==null?void 0:ae.levels)||[]).flatMap(de=>(de==null?void 0:de.deckIds)||[]);$.indexOf(w)===$.length-1&&$.length>0?m(`Congratulations! You've completed the series: "${ae==null?void 0:ae.name}"!`,"success"):m(`Deck "${P.name}" completed! Next chapter unlocked.`,"success"),d({type:"SET_SERIES_PROGRESS",payload:z})}catch(ae){console.error("Could not save series progress",ae)}}}},[i,m,d]),_=B.useCallback(async w=>{const S=Ze.getState().decks[w];if(!S)return;let C;S.type===je.Flashcard?C={...S,cards:(S.cards||[]).map(R=>fb(R))}:C={...S,questions:(S.questions||[]).map(R=>fb(R))},await i(C,{toastMessage:`Progress for deck "${C.name}" has been reset.`})},[i]),T=B.useCallback(()=>{const{decks:w,deckSeries:S,seriesProgress:C}=Ze.getState(),R=new Set;Object.values(S).forEach(U=>(U.levels||[]).filter(Boolean).forEach(j=>(j.deckIds||[]).forEach(O=>R.add(O))));const L=new Set;Object.values(S).forEach(U=>{var j;if(!U.archived&&!U.deletedAt){const O=((j=C.get(U.id))==null?void 0:j.size)||0;let q=0;(U.levels||[]).filter(Boolean).forEach(ee=>{(ee.deckIds||[]).forEach(M=>{q<=O&&L.add(M),q++})})}});const F=new Date;F.setHours(23,59,59,999);const G=Object.values(w).filter(U=>!(U.type!==je.Quiz||U.archived||U.deletedAt||R.has(U.id)&&!L.has(U.id))).flatMap(U=>{const j=Object.values(S).find(O=>(O.levels||[]).some(q=>(q.deckIds||[]).includes(U.id)));return(U.questions||[]).filter(O=>!O.suspended&&new Date(O.dueDate)<=F).map(O=>({...O,originalDeckId:U.id,originalDeckName:U.name,originalSeriesName:j==null?void 0:j.name,originalSeriesId:j==null?void 0:j.id}))}).sort(()=>Math.random()-.5),Q={id:"general-study-deck",name:"General Study Session",description:"A mix of all due questions.",type:je.Quiz,questions:G};s(Q),l(`/study/general?from=${encodeURIComponent(c)}`)},[l,s,c]),x=B.useCallback(async w=>{var ee;const{decks:S,deckSeries:C,seriesProgress:R}=Ze.getState(),L=C[w];if(!L)return;const F=new Set,G=((ee=R.get(L.id))==null?void 0:ee.size)||0;let Q=0;(L.levels||[]).filter(Boolean).forEach(M=>{(M.deckIds||[]).forEach(J=>{Q<=G&&F.add(J),Q++})});const U=new Date;U.setHours(23,59,59,999);const O=(L.levels||[]).filter(Boolean).flatMap(M=>M.deckIds||[]).map(M=>S[M]).filter(M=>!!(M&&(M.type===je.Quiz||M.type===je.Learning))).filter(M=>F.has(M.id)).flatMap(M=>(M.questions||[]).filter(J=>!J.suspended&&new Date(J.dueDate)<=U).map(J=>({...J,originalDeckId:M.id,originalDeckName:M.name}))).sort(()=>Math.random()-.5),q={id:"general-study-deck",name:`${L.name} - Study Session`,description:`A study session for due items in the series: ${L.name}`,type:je.Quiz,questions:O};s(q),l(`/study/general?seriesId=${w}&from=${encodeURIComponent(c)}`)},[l,s,c]),k=B.useCallback(async w=>{d({type:"UPDATE_LEARNING_PROGRESS",payload:w});try{await rn.saveLearningProgress(w)}catch(S){console.error("Failed to save learning progress",S)}},[d]);return B.useMemo(()=>({handleSessionEnd:p,handleStudyNextDeckInSeries:f,handleItemReviewed:v,handleResetDeckProgress:_,handleStartGeneralStudy:T,handleStartSeriesStudy:x,handleUpdateLearningProgress:k}),[p,f,v,_,T,x,k])},hb=(n,a,s)=>{var T;const i={...a,decks:[...a.decks],deckSeries:[...a.deckSeries],seriesProgress:{...a.seriesProgress}},l=new Map(a.decks.map(x=>[x.id,x])),c=new Map(n.decks.map(x=>[x.id,x])),d=[];a.decks.forEach(x=>{s.decks[x.id]==="local"&&c.has(x.id)?d.push(c.get(x.id)):d.push(x)}),n.decks.forEach(x=>{l.has(x.id)||d.push(x)}),i.decks=d;const m=new Map(a.deckSeries.map(x=>[x.id,x])),p=new Map(n.deckSeries.map(x=>[x.id,x])),f=[];a.deckSeries.forEach(x=>{s.series[x.id]==="local"&&p.has(x.id)?(f.push(p.get(x.id)),n.seriesProgress&&n.seriesProgress[x.id]&&(i.seriesProgress[x.id]=n.seriesProgress[x.id])):f.push(x)}),n.deckSeries.forEach(x=>{m.has(x.id)||(f.push(x),n.seriesProgress&&n.seriesProgress[x.id]&&(i.seriesProgress[x.id]=n.seriesProgress[x.id]))}),i.deckSeries=f;const v=new Set((T=a.reviews)==null?void 0:T.map(x=>x.timestamp+x.itemId)),_=(n.reviews||[]).filter(x=>!v.has(x.timestamp+x.itemId));return i.reviews=[...i.reviews||[],..._],i.sessions=n.sessions,i},_T=({addToast:n,openModal:a,closeModal:s,dispatch:i,setLastSyncStatus:l,setIsSyncing:c,backupEnabled:d})=>{const m=U=>!U||U.length===0?0:U.reduce((j,O)=>j+bT(O),0)/U.length,p=B.useCallback(U=>{const j=Ze.getState().decks,O=Ze.getState().deckSeries,q=[],ee=[],M=[],J=[],N=new Map,se=new Map;return U.decks.forEach(K=>{const P=j[K.id];if(!P)q.push(K),N.set(K.id,dl(K));else if(P.lastModified!==K.lastModified){const ve=(P.type===je.Flashcard?P.cards:(P.type===je.Learning,P.questions))||[],ce=(K.type===je.Flashcard?K.cards:K.type===je.Learning||K.type===je.Quiz?K.questions:[])||[],Ee={content:ve.length!==ce.length,dueCount:dl(P)!==dl(K),mastery:!1};M.push({local:P,backup:K,diff:Ee}),N.set(`local-${P.id}`,dl(P)),N.set(K.id,dl(K));const z=ve,I=ce,te=m(z),ae=m(I);se.set(`local-${P.id}`,te),se.set(K.id,ae),Ee.mastery=Math.abs(te-ae)>.01}}),U.deckSeries.forEach(K=>{const P=O[K.id];if(!P)ee.push(K);else if(P.lastModified!==K.lastModified){const ve={structure:JSON.stringify(P.levels)!==JSON.stringify(K.levels),completion:!1,mastery:!1};J.push({local:P,backup:K,diff:ve})}}),{newDecks:q,newSeries:ee,changedDecks:M,changedSeries:J,dueCounts:N,masteryLevels:se}},[]),f=B.useCallback(async(U={})=>{if(!d){U.isManual&&n("Backup is disabled in settings.","info");return}c(!0),l("Syncing...");try{const{timestamp:j}=await ch(void 0,U.force),O=new Date(j);l(`Synced: ${O.toLocaleTimeString()}`),U.isManual&&n("Sync successful.","success")}catch(j){if(console.error("Sync failed",j),j.status===412||j.status===409){l("Sync Conflict");try{const O=await uh(),q=p(O);a("mergeConflict",{comparison:q,remoteData:O})}catch{n("Sync failed and could not read server data for resolution.","error")}}else l("Sync Failed"),U.isManual&&n(`Sync failed: ${j.message}`,"error")}finally{c(!1)}},[d,n,c,l,p,a]),v=B.useCallback(async U=>{try{await pl(U),i({type:"RESTORE_DATA",payload:U}),U.aiChatHistory&&i({type:"SET_AI_CHAT_HISTORY",payload:U.aiChatHistory}),n("Data restored successfully.","success"),d&&f({isManual:!1,force:!0})}catch(j){console.error(j),n("Failed to restore data.","error")}},[i,n,f,d]),_=B.useCallback(()=>{f({isManual:!0})},[f]),T=B.useCallback(async()=>{c(!0);try{const U=await js();localStorage.setItem("cogniflow-pre-fetch-backup",JSON.stringify(U));const j=await uh();await pl(j),i({type:"RESTORE_DATA",payload:j}),j.aiChatHistory&&i({type:"SET_AI_CHAT_HISTORY",payload:j.aiChatHistory}),n("Force fetch successful.","success"),l(`Fetched: ${new Date().toLocaleTimeString()}`)}catch(U){n(`Force fetch failed: ${U.message}`,"error")}finally{c(!1)}},[i,c,n,l]),x=B.useCallback(async()=>{const U=localStorage.getItem("cogniflow-pre-fetch-backup");if(!U){n("No backup found to revert to.","error");return}try{const j=JSON.parse(U);await v(j),n("Reverted to state before last fetch.","success")}catch{n("Failed to revert.","error")}},[v,n]),k=B.useCallback(async()=>{c(!0);try{await ch(void 0,!0),n("Force upload successful.","success"),l(`Synced: ${new Date().toLocaleTimeString()}`)}catch(U){n(`Force upload failed: ${U.message}`,"error")}finally{c(!1)}},[c,n,l]),w=B.useCallback(async()=>{c(!0);try{const U=await d2();n(`Backup created: ${U.filename}`,"success")}catch(U){n(`Backup failed: ${U.message}`,"error")}finally{c(!1)}},[c,n]),S=B.useCallback(async U=>{c(!0);try{await f2(U);const j=await uh();await pl(j),i({type:"RESTORE_DATA",payload:j}),j.aiChatHistory&&i({type:"SET_AI_CHAT_HISTORY",payload:j.aiChatHistory}),n("Restored from server backup.","success"),l(`Restored: ${new Date().toLocaleTimeString()}`)}catch(j){n(`Restore failed: ${j.message}`,"error")}finally{c(!1)}},[c,n,i,l]),C=B.useCallback(async U=>{try{await h2(U)}catch(j){throw n(`Delete failed: ${j.message}`,"error"),j}},[n]),R=B.useCallback(async({selectedIds:U,backupData:j})=>{const O=await js(),q={decks:{},series:{}};j.decks.forEach(M=>{U.has(M.id)?q.decks[M.id]="remote":q.decks[M.id]="local"}),j.deckSeries.forEach(M=>{U.has(M.id)?q.series[M.id]="remote":q.series[M.id]="local"});const ee=hb({...O},j,q);await v(ee)},[v]),L=B.useCallback(async(U,j)=>{s();const O=await js(),q=hb({...O},j,U);await pl(q),i({type:"RESTORE_DATA",payload:q}),q.aiChatHistory&&i({type:"SET_AI_CHAT_HISTORY",payload:q.aiChatHistory}),c(!0);try{await ch(q,!0),n("Sync conflict resolved.","success"),l(`Synced: ${new Date().toLocaleTimeString()}`)}catch{n("Failed to push resolved data to server.","error")}finally{c(!1)}},[s,i,n,c,l]),F=B.useCallback(async()=>{try{await y0(),n("Export started.","info")}catch(U){n(`Export failed: ${U.message}`,"error")}},[n]),G=B.useCallback(()=>{"serviceWorker"in navigator&&navigator.serviceWorker.controller?(navigator.serviceWorker.controller.postMessage({type:"CLEAR_APP_CACHE"}),n("App cache cleared. Reloading...","success"),setTimeout(()=>window.location.reload(),1e3)):n("Service worker not active.","error")},[n]),Q=B.useCallback(()=>{"serviceWorker"in navigator&&navigator.serviceWorker.controller?(navigator.serviceWorker.controller.postMessage({type:"CLEAR_CDN_CACHE"}),n("CDN cache cleared.","success")):n("Service worker not active.","error")},[n]);return{triggerSync:f,handleManualSync:_,onRestoreData:v,handleCompareBackup:p,handleRestoreSelectedItems:R,handleForceFetchFromServer:T,handleForceUploadToServer:k,handleCreateServerBackup:w,handleRestoreFromServerBackup:S,handleDeleteServerBackup:C,handleMergeResolution:L,handleExportData:F,handleClearAppCache:G,handleClearCdnCache:Q,handleRevertLastFetch:x}};var ST={};const D0=n=>{try{return typeof process<"u"?ST[n]:void 0}catch{return}};D0("GDRIVE_API_KEY");D0("GDRIVE_CLIENT_ID");let wT=!1,hu=[],vh=[];const ET=(n,a)=>{hu.forEach(s=>s(n,a))},TT=n=>(vh.push(n),n(wT),()=>{vh=vh.filter(a=>a!==n)}),AT=n=>(hu.push(n),()=>{hu=hu.filter(a=>a!==n)}),kT=()=>{{console.error("Google services not ready for sign-in.");return}},CT=()=>{const n=gapi.client.getToken();gapi.client.setToken(null),localStorage.removeItem("gdrive-previously-signed-in"),ET(!1),n!==null&&google.accounts.oauth2.revoke(n.access_token,()=>{console.log("Google token revoked.")})},NT=async()=>{const n=await js();if(n.decks.length===0&&n.folders.length===0&&n.deckSeries.length===0)throw new Error("There is no data to back up.");const a={version:7,...n},s=JSON.stringify(a),c={name:`cogniflow-backup-${Zh()}.json`,parents:["appDataFolder"]},d="-------314159265358979323846",m=`\r
--${d}\r
`,p=`\r
--${d}--`,f=m+`Content-Type: application/json; charset=UTF-8\r
\r
`+JSON.stringify(c)+m+`Content-Type: application/json; charset=UTF-8\r
\r
`+s+p,v=await gapi.client.request({path:"https://www.googleapis.com/upload/drive/v3/files",method:"POST",params:{uploadType:"multipart",fields:"id, name, modifiedTime"},headers:{"Content-Type":`multipart/related; boundary=${d}`},body:f});if(v.status!==200)throw new Error("Failed to upload backup file.");return v.result},DT=async()=>(await gapi.client.drive.files.list({spaces:"appDataFolder",fields:"files(id, name, modifiedTime)",orderBy:"modifiedTime desc"})).result.files,OT=async n=>{const a=await gapi.client.drive.files.get({fileId:n,alt:"media"});if(a.status!==200)throw new Error("Failed to download backup file.");const s=typeof a.body=="string"?a.body:JSON.stringify(a.result);return await Au(s)},jT=({openConfirmModal:n,openRestoreFromDriveModal:a,setDriveFiles:s,onRestoreData:i})=>{const{addToast:l}=jn(),c=B.useCallback(()=>{kT()},[]),d=B.useCallback(()=>{CT(),l("Signed out of Google Drive.","info")},[l]),m=B.useCallback(()=>{n({title:"Backup to Google Drive",message:"This will create a new backup file in a private application folder in your Google Drive. Are you sure?",onConfirm:async()=>{try{const v=await NT();l(`Successfully created backup: ${v.name}`,"success")}catch(v){const _=v instanceof Error?v.message:"Failed to create backup.";l(_,"error")}}})},[l,n]),p=B.useCallback(async()=>{try{const v=await DT();s(v),a()}catch(v){const _=v instanceof Error?v.message:"Failed to list files from Google Drive.";l(_,"error")}},[l,s,a]),f=B.useCallback(async v=>{n({title:"Restore from Google Drive",message:"Restoring will merge and overwrite data. Are you sure?",onConfirm:async()=>{try{const _=await OT(v);await i(_)}catch(_){const T=_ instanceof Error?_.message:"Failed to restore from backup.";l(T,"error")}}})},[l,n,i]);return B.useMemo(()=>({handleGoogleSignIn:c,handleGoogleSignOut:d,handleBackupToDrive:m,handleListDriveFiles:p,handleRestoreFromDrive:f,openRestoreFromDriveModal:p}),[c,d,m,p,f])},IT=3,bh=3;async function O0(n,a=3,s=2e3){try{return await n()}catch(i){if(a<=0)throw i;const l=s*Math.pow(2,3-a);return console.warn(`Operation failed, retrying in ${l}ms...`,i),await new Promise(c=>setTimeout(c,l)),O0(n,a-1,s)}}const RT=({handleUpdateDeck:n,handleBulkUpdateDecks:a,handleAddDecks:s,handleAddSeriesWithDecks:i,handleUpdateSeries:l,openConfirmModal:c,openModal:d,closeModal:m})=>{const{dispatch:p}=Ze(),{addToast:f}=jn(),{veoEnabled:v,groundedImagesEnabled:_,searchAuditsEnabled:T}=Za(),x=B.useCallback(async($,ue)=>{var pe,Ie,He,Oe;const{currentTask:de}=Ze.getState().aiGenerationStatus;if(!de)return;const oe=$.persona||"default",le=localStorage.getItem("cogniflow-ai-options");let Le=[];le&&(Le=JSON.parse(le).personas||[]);const De=Le.find(qe=>qe.id===oe)||{name:"Assistant",instruction:"You are a helpful assistant."};let Se=(pe=$.partialProgress)==null?void 0:pe.curriculum,ne=(Ie=$.partialProgress)==null?void 0:Ie.deckId,E=new Set(((He=$.partialProgress)==null?void 0:He.completedChapterIds)||[]),me=((Oe=$.partialProgress)==null?void 0:Oe.previousSummariesMap)||{},X=new Map;if(!Se){p({type:"UPDATE_CURRENT_AI_TASK_STATUS",payload:{statusText:"Architecting Hyper-Course schema & shared terminology..."}});try{Se=await kE($,De),ne=crypto.randomUUID();const nt={id:ne,name:Se.name||$.topic,description:Se.description||`Generating: ${$.topic}...`,type:je.Learning,infoCards:[],questions:[],learningMode:"separate",curriculum:Se,generationStatus:"generating"};await s([nt]),p({type:"UPDATE_CURRENT_AI_TASK_STATUS",payload:{payload:{...$,partialProgress:{...$.partialProgress,curriculum:Se,deckId:ne,completedChapterIds:[],previousSummariesMap:{}}}}})}catch(qe){if(qe.jsonString){d("aiResponseFix",{badJson:qe.jsonString,onRetry:nt=>{const We={...de,payload:{...$,partialProgress:{curriculum:nt}}};p({type:"CANCEL_AI_TASK"}),p({type:"ADD_AI_TASK_TO_QUEUE",payload:We})},onCancel:()=>p({type:"CANCEL_AI_TASK"})});return}throw qe}}if(ue.aborted)return;const Z=Se.chapters,Y=Z.length,ie=Math.floor(($.targetWordCount||1e4)/Y),ke=Se.sharedDictionary||{},Ce=new Set;for(;E.size<Y&&!ue.aborted;){const qe=Z.filter(Ye=>E.has(Ye.id)||Ce.has(Ye.id)||(X.get(Ye.id)||0)>=bh?!1:(Ye.prerequisiteChapterIds||[]).every(jt=>E.has(jt)));if(qe.length===0&&Ce.size===0){const Ye=Z.filter(St=>!E.has(St.id)&&(X.get(St.id)||0)>=bh);Ye.length>0?(console.error("Hyper-Course stalled due to isolated node failures:",Ye.map(St=>St.title)),f(`Course synthesis partially failed for ${Ye.length} chapters.`,"warning")):console.error("Hyper-Course Deadlock detected in Curriculum DAG.");break}const nt=IT-Ce.size;qe.slice(0,nt).forEach(Ye=>{Ce.add(Ye.id),(async()=>{var St;try{const wt=Z.indexOf(Ye),jt=(Ye.prerequisiteChapterIds||[]).map(gt=>me[gt]).filter(Boolean),mt=await CE($.topic,jt,ke);p({type:"UPDATE_CHAPTER_PHASE",payload:{chapterId:Ye.id,phase:"drafting"}}),p({type:"UPDATE_CURRENT_AI_TASK_STATUS",payload:{statusText:`Streaming Draft: "${Ye.title}"...`}});let rt="";if(await O0(async()=>{const gt=NE($.topic,Ye,Y,wt,De,ie,ke,mt);for await(const pn of gt){if(ue.aborted)return;rt+=pn,p({type:"UPDATE_STREAMING_DRAFT",payload:{chapterId:Ye.id,text:rt}})}},bh),ue.aborted)return;p({type:"UPDATE_CHAPTER_PHASE",payload:{chapterId:Ye.id,phase:"finalizing"}});const un=await DE($.topic,Ye,Y,wt,De,ie,ke,mt);rt=un.content;const Mt=un.summaryForArchivist;if(T){p({type:"UPDATE_CHAPTER_PHASE",payload:{chapterId:Ye.id,phase:"auditing"}}),p({type:"UPDATE_CURRENT_AI_TASK_STATUS",payload:{statusText:`Fact-checking: "${Ye.title}"...`}});let gt=await OE($.topic,Ye.title,rt);gt.corrections&&gt.corrections.length>0&&(p({type:"UPDATE_CURRENT_AI_TASK_STATUS",payload:{statusText:`Refining: "${Ye.title}" (Found ${gt.corrections.length} fixes)...`}}),rt=(await jE($.topic,rt,gt.corrections)).refinedContent)}if(ue.aborted)return;p({type:"UPDATE_CHAPTER_PHASE",payload:{chapterId:Ye.id,phase:"illustrating"}}),p({type:"UPDATE_CURRENT_AI_TASK_STATUS",payload:{statusText:`Illustrating (SVG): "${Ye.title}"...`}});let cr=await IE($.topic,rt);if(cr.hasDiagram&&cr.svgCode){const gt=`<div class="factual-diagram my-8 flex flex-col items-center bg-surface-dark p-4 rounded-xl border border-border shadow-inner"><div class="max-w-full overflow-x-auto">${cr.svgCode}</div><p class="text-xs text-text-muted mt-3 italic text-center max-w-sm">${cr.caption}</p></div>`;rt.match(/<\/h[23]>/)?rt=rt.replace(/(<\/h[23]>)/,`$1
${gt}
`):rt=gt+`
`+rt}if(ue.aborted)return;const ut=await((St=window.aistudio)==null?void 0:St.hasSelectedApiKey());if(ut&&_){p({type:"UPDATE_CHAPTER_PHASE",payload:{chapterId:Ye.id,phase:"illustrating"}}),p({type:"UPDATE_CURRENT_AI_TASK_STATUS",payload:{statusText:`Illustrating (High-Fidelity): "${Ye.title}"...`}});try{let gt=await LE($.topic,rt);if(gt.imageUrl){const pn=`<div class="grounded-image my-10 flex flex-col items-center"><img src="${gt.imageUrl}" class="rounded-xl shadow-2xl max-w-full h-auto border border-border" /><p class="text-xs text-text-muted mt-4 italic text-center max-w-md bg-background/50 p-2 rounded">${gt.description}</p></div>`;rt+=`
${pn}
`}}catch(gt){console.warn("Grounded image synthesis failed",gt)}}if(ut&&v){p({type:"UPDATE_CHAPTER_PHASE",payload:{chapterId:Ye.id,phase:"illustrating"}}),p({type:"UPDATE_CURRENT_AI_TASK_STATUS",payload:{statusText:`Generating process loop (Veo): "${Ye.title}"...`}});try{const gt=await RE($.topic,rt);if(gt){const pn=`<div class="veo-process my-10 flex flex-col items-center"><video src="${gt.dataUrl}" controls loop autoplay muted playsinline class="rounded-xl shadow-2xl border border-border w-full max-w-2xl"></video><p class="text-xs text-text-muted mt-3 italic text-center max-w-sm font-semibold">${gt.caption}</p></div>`;rt+=`
${pn}
`}}catch(gt){console.warn("Veo generation failed",gt)}}p({type:"UPDATE_CHAPTER_PHASE",payload:{chapterId:Ye.id,phase:"finalizing"}}),p({type:"UPDATE_CURRENT_AI_TASK_STATUS",payload:{statusText:`Final Audit: "${Ye.title}"...`}});let Jr=await zE($.topic,Ye.title,rt);if(ue.aborted)return;const Kn=Ye.id||crypto.randomUUID(),qt=new Date().toISOString(),tn=Jr.questions.map(gt=>({...gt,id:gt.id||crypto.randomUUID(),questionType:"multipleChoice",dueDate:qt,interval:0,easeFactor:2.5,lapses:0,masteryLevel:0,suspended:!1,infoCardIds:[Kn],options:(gt.options||[]).map(pn=>({...pn,id:crypto.randomUUID()})),bloomsLevel:gt.bloomsLevel})),vn=Ze.getState().decks[ne];if(vn){const gt={...vn,infoCards:[...vn.infoCards,{id:Kn,content:Jr.refinedContent||rt,unlocksQuestionIds:tn.map(pn=>pn.id),prerequisiteIds:Ye.prerequisiteChapterIds||[]}],questions:[...vn.questions,...tn],lastModified:Date.now()};await n(gt,{silent:!0})}E.add(Ye.id),me[Kn]=Mt,p({type:"UPDATE_CHAPTER_PHASE",payload:{chapterId:Ye.id,phase:"complete"}}),p({type:"UPDATE_CURRENT_AI_TASK_STATUS",payload:{payload:{...$,partialProgress:{...$.partialProgress,completedChapterIds:Array.from(E),previousSummariesMap:me}}}})}catch(wt){console.error(`Task for chapter "${Ye.title}" failed:`,wt),X.set(Ye.id,(X.get(Ye.id)||0)+1),p({type:"UPDATE_CHAPTER_PHASE",payload:{chapterId:Ye.id,phase:"failed"}})}finally{Ce.delete(Ye.id)}})()}),await new Promise(Ye=>setTimeout(Ye,3e3))}if(!ue.aborted){let qe=Ze.getState().decks[ne];if(qe&&qe.infoCards.length>1){if(T){p({type:"UPDATE_CURRENT_AI_TASK_STATUS",payload:{statusText:"Performing Global Consistency Audit..."}});try{const nt=await ME($.topic,qe.name,qe.infoCards,ke);if(nt.suggestions&&nt.suggestions.length>0){p({type:"UPDATE_CURRENT_AI_TASK_STATUS",payload:{statusText:`Self-Correcting ${nt.suggestions.length} Inconsistencies...`}});let We=[...qe.infoCards];for(const Ye of nt.suggestions){const St=We.findIndex(wt=>wt.id===Ye.chapterId);if(St!==-1){const wt=We[St];p({type:"UPDATE_CURRENT_AI_TASK_STATUS",payload:{statusText:`Perfecting Chapter: ${Ye.chapterId}...`}});try{const jt=await UE($.topic,wt.content,Ye);We[St]={...wt,content:jt.refinedContent}}catch(jt){console.warn(`Refinement failed for card ${Ye.chapterId}`,jt)}}}qe={...qe,infoCards:We,lastModified:Date.now()},await n(qe,{silent:!0})}}catch(nt){console.warn("Global consistency audit failed",nt)}}await n({...qe,generationStatus:"complete"},{toastMessage:`Hyper-Course "${qe.name}" successfully constructed!`})}p({type:"CLEAR_STREAMING_DRAFTS"})}},[p,s,n,d,f,v,_,T]),k=B.useCallback(async($,ue)=>{var De;const de=Ze.getState().decks[$.deckId];if(!de||de.type!==je.Quiz&&de.type!==je.Learning)return;const oe=de,le=oe.questions.length,Le=[...oe.questions];for(let Se=0;Se<le;Se++){if(ue.aborted)throw new Error("Cancelled by user");const ne=Le[Se];p({type:"UPDATE_CURRENT_AI_TASK_STATUS",payload:{statusText:`Hardening question ${Se+1}/${le}...`}});try{const E=ne.options.filter(Y=>Y.id!==ne.correctAnswerId).map(Y=>Y.text),me=((De=ne.options.find(Y=>Y.id===ne.correctAnswerId))==null?void 0:De.text)||"",X=await Xv(ne.questionText,me,E,de.name),Z=ne.options.find(Y=>Y.id===ne.correctAnswerId);Le[Se]={...ne,options:[Z,...X.map(Y=>({id:crypto.randomUUID(),text:Y.text,explanation:Y.explanation}))].sort(()=>Math.random()-.5)}}catch(E){console.error(`Failed to harden question ${ne.id}`,E)}}await n({...de,questions:Le}),f(`Hardened distractors for all ${le} questions!`,"success")},[p,n,f]),w=B.useCallback(async($,ue)=>{const de=Ze.getState().decks[$.deckId];if(!de||de.type!==je.Flashcard)return;const oe=de,le=oe.cards.length,Le=[...oe.cards];let De=0;for(let Se=0;Se<le;Se++){if(ue.aborted)throw new Error("Cancelled by user");const ne=Le[Se];if(!ne.frontAudio||!ne.backAudio){p({type:"UPDATE_CURRENT_AI_TASK_STATUS",payload:{statusText:`Generating audio for card ${Se+1}/${le}...`}});try{const E=ne.front.replace(/<[^>]+>/g,"").trim(),me=ne.back.replace(/<[^>]+>/g,"").trim(),[X,Z]=await Promise.all([ne.frontAudio?Promise.resolve(ne.frontAudio):Jv(E),ne.backAudio?Promise.resolve(ne.backAudio):Jv(me)]);Le[Se]={...ne,frontAudio:X,backAudio:Z},De++}catch(E){console.error(`Failed to generate audio for card ${ne.id}`,E)}}}await n({...de,cards:Le}),f(`Audio generated for ${De} card sides!`,"success")},[p,n,f]),S=B.useCallback(async($,ue)=>{const de=Ze.getState().decks[$.deckId];if(!de)return;p({type:"UPDATE_CURRENT_AI_TASK_STATUS",payload:{statusText:"Analyzing concepts..."}});const oe=await YE(de);if(ue.aborted)throw new Error("Cancelled by user");p({type:"UPDATE_CURRENT_AI_TASK_STATUS",payload:{statusText:"Structuring course..."}});let le=[];if(de.type===je.Flashcard){const De=de.cards.map(Se=>({id:Se.id,questionType:"multipleChoice",questionText:Se.front,options:[{id:crypto.randomUUID(),text:Se.back},{id:crypto.randomUUID(),text:"Incorrect Option A"},{id:crypto.randomUUID(),text:"Incorrect Option B"}].sort(()=>Math.random()-.5),correctAnswerId:"",detailedExplanation:`Concept: ${Se.front} is ${Se.back}`,dueDate:Se.dueDate,interval:Se.interval,easeFactor:Se.easeFactor,lapses:Se.lapses,masteryLevel:Se.masteryLevel,suspended:!1,lastReviewed:Se.lastReviewed}));De.forEach(Se=>{const ne=Se.options.find(E=>{var me;return E.text===((me=de.cards.find(X=>X.id===Se.id))==null?void 0:me.back)});Se.correctAnswerId=(ne==null?void 0:ne.id)||Se.options[0].id}),le=De}else le=de.questions;const Le={...de,type:je.Learning,infoCards:oe.infoCards.map(De=>({...De,id:De.id||crypto.randomUUID(),unlocksQuestionIds:De.unlocksQuestionIds||[]})),questions:le,learningMode:"separate"};await n(Le,{toastMessage:`"${de.name}" is now a Learning Deck!`})},[p,n]),C=B.useCallback($=>{d("aiGenerationChat",{params:$})},[d]),R=B.useCallback(async $=>{var le;const ue=crypto.randomUUID(),{generationType:de}=$;if(de==="deep-course"&&(v||_||T)&&!await((le=window.aistudio)==null?void 0:le.hasSelectedApiKey())){c({title:"API Key Required",message:"Deep Course generation uses premium features like Process Visualization Loops (Veo), Grounded Fidelity Images, and Search Audits. Please select your paid Gemini API key from Google AI Studio to continue.",confirmText:"Select API Key",onConfirm:async()=>{var ne;await((ne=window.aistudio)==null?void 0:ne.openSelectKey());const Se={id:ue,type:"generateDeepCourse",payload:$,statusText:`Architecting deep course on "${$.topic}"...`};p({type:"ADD_AI_TASK_TO_QUEUE",payload:Se})}});return}let oe;de==="deep-course"?oe={id:ue,type:"generateDeepCourse",payload:$,statusText:`Architecting deep course on "${$.topic}"...`}:de.startsWith("series-")?oe={id:ue,type:"autoPopulateSeries",payload:{topic:$.topic,comprehensiveness:$.comprehensiveness},statusText:`Generating series structure for "${$.topic}"`}:["deck-flashcard","deck-vocab","deck-atomic"].includes(de)?oe={id:ue,type:"generateFlashcardDeckWithAI",payload:$,statusText:`Generating flashcards for "${$.topic}"`}:["single-deck-learning","deck-course"].includes(de)?oe={id:ue,type:"generateLearningDeckWithAI",payload:$,statusText:`Generating course content for "${$.topic}"`}:de==="rework-deck"?oe={id:ue,type:"rework-deck",payload:$,statusText:`Reworking "${$.topic}"`}:oe={id:ue,type:"generateDeckFromOutline",payload:{immediate:!0,topic:$.topic,understanding:$.understanding,count:$.count},statusText:`Generating quiz for "${$.topic}"`},p({type:"ADD_AI_TASK_TO_QUEUE",payload:oe}),f("Task added to queue.","info")},[p,f,c,v,_,T]),L=B.useCallback(async $=>{try{switch($.action){case gl.CREATE_DECK:await s([{id:crypto.randomUUID(),name:$.payload.name,type:je.Flashcard,cards:[],folderId:$.payload.folderId||null,description:"Created by AI"}]),f(`Deck "${$.payload.name}" created.`,"success");break;case gl.UPGRADE_TO_LEARNING:const ue=Ze.getState().decks[$.payload.deckId];ue&&S({deckId:ue.id},new AbortController().signal);break;case gl.REWORK_DECK:const de=Ze.getState().decks[$.payload.deckId];if(de){const oe={generationType:"rework-deck",topic:de.name,deckId:de.id,reworkInstructions:$.payload.reworkInstructions||"Improve and expand the content.",persona:$.payload.persona||"default",understanding:"Intermediate",comprehensiveness:"Standard"};R(oe)}break;default:console.log("Action not implemented yet:",$.action),f("This action is not fully implemented yet.","info")}}catch(ue){f(`Failed to execute action: ${ue.message}`,"error")}},[s,f,S,R]),F=B.useCallback($=>{p({type:"CANCEL_AI_TASK",payload:{taskId:$}}),f("Generation cancelled.","info")},[p,f]),G=B.useCallback($=>{d("aiGeneration",{context:{deckId:$.id,deckName:$.name,deckType:$.type,mode:"expand"}})},[d]),Q=B.useCallback($=>{d("aiGeneration",{context:{deckId:$.id,deckName:$.name,deckType:$.type,mode:"rework"}})},[d]),U=B.useCallback(($,ue)=>{const de=Ze.getState().deckSeries[$];d("aiGeneration",{initialGenerationType:"single-deck-quiz",context:{seriesId:$,seriesName:de==null?void 0:de.name,seriesDescription:de==null?void 0:de.description,levelIndex:ue}})},[d]),j=B.useCallback($=>{const ue=Ze.getState().deckSeries[$];d("aiGeneration",{initialGenerationType:"series-auto-fill",context:{seriesId:$,seriesName:ue==null?void 0:ue.name,seriesDescription:ue==null?void 0:ue.description}})},[d]),O=B.useCallback(async($,ue)=>{if(!$.deckId)return;const de=Ze.getState(),oe=de.decks[$.deckId];if(!oe)return;const le=$.persona||"default",Le=localStorage.getItem("cogniflow-ai-options");let De=[];Le&&(De=JSON.parse(Le).personas||[]);const Se=De.find(me=>me.id===le)||{name:"Assistant",instruction:"You are a helpful assistant."};let ne="";const E=Object.values(de.deckSeries).find(me=>(me.levels||[]).some(X=>(X.deckIds||[]).includes(oe.id)));E&&(ne=`Parent Series: "${E.name}"
Description: ${E.description}
Decks in this series:
`+(E.levels||[]).map(me=>{const X=(me.deckIds||[]).map(Z=>de.decks[Z]).filter(Boolean);return`Level: ${me.title}
`+X.map(Z=>` - Deck: "${Z.name}" (${Z.description})`).join(`
`)}).join(`
`)),p({type:"UPDATE_CURRENT_AI_TASK_STATUS",payload:{statusText:`Reworking "${oe.name}"...`}});try{const X=await PE(oe,$,Se,ne);if(ue.aborted)throw new Error("Cancelled by user");let Z;oe.type===je.Flashcard?Z={...oe,name:X.name||oe.name,description:X.description||oe.description,cards:Ya(X.cards||[])}:oe.type===je.Quiz?Z={...oe,name:X.name||oe.name,description:X.description||oe.description,questions:aa(X.questions||[])}:Z={...oe,name:X.name||oe.name,description:X.description||oe.description,infoCards:(X.infoCards||[]).map(Y=>({...Y,id:Y.id||crypto.randomUUID()})),questions:aa(X.questions||[])},await n(Z,{toastMessage:`"${oe.name}" reworked successfully!`})}catch(me){console.error("Rework failed:",me),f(`Failed to rework deck: ${me.message}`,"error")}},[p,n,f]),q=B.useCallback(async($,ue)=>{const{seriesId:de,topic:oe,comprehensiveness:le}=$,Le=Ze.getState();let De=null;if(de)De=Le.deckSeries[de]||null;else if(oe){p({type:"UPDATE_CURRENT_AI_TASK_STATUS",payload:{statusText:"Designing full curriculum..."}});const Se=await Wv(oe,`A comprehensive course about ${oe} at ${le} depth.`);if(ue.aborted)return;const ne=[],E=(Se.levels||[]).map(me=>{const X=(me.decks||[]).map(Z=>({id:crypto.randomUUID(),name:Z.name,description:Z.description,type:je.Quiz,questions:[]}));return ne.push(...X),{title:me.title,deckIds:X.map(Z=>Z.id)}});De={id:crypto.randomUUID(),type:"series",name:Se.name||Se.seriesName||oe,description:Se.description||Se.seriesDescription||"",levels:E,createdAt:new Date().toISOString(),archived:!1},await i(De,ne)}if(De&&de){p({type:"UPDATE_CURRENT_AI_TASK_STATUS",payload:{statusText:"Expanding levels..."}}),(De.levels||[]).map(ne=>`${ne.title}: ${(ne.deckIds||[]).length} decks`).join(`
`);const Se=await Wv(De.name,De.description);if(ue.aborted)return;if(Se&&Se.levels&&Array.isArray(Se.levels)&&Se.levels.length>0){const ne=[],E=Se.levels.map(X=>{const Z=(X.decks||[]).map(Y=>({id:crypto.randomUUID(),name:Y.name,description:Y.description,type:je.Quiz,questions:[]}));return ne.push(...Z),{title:X.title,deckIds:Z.map(Y=>Y.id)}}),me={...De,levels:[...De.levels||[],...E]};await i(me,ne)}}},[p,i,s,l]),ee=B.useCallback(async($,ue)=>{const{seriesId:de,levelIndex:oe}=$,le=Ze.getState().deckSeries[de];if(!le||!le.levels[oe])return;const Le=le.levels[oe];Le.deckIds.map(me=>{var X;return(X=Ze.getState().decks[me])==null?void 0:X.name}).filter(Boolean);const Se=await JE(le.name,le.description,Le.title);if(ue.aborted)return;const ne=Se.map(me=>({id:crypto.randomUUID(),name:me.name,description:me.description,type:je.Quiz,questions:[]}));await s(ne);const E={...le,levels:le.levels.map((me,X)=>X===oe?{...me,deckIds:[...me.deckIds,...ne.map(Z=>Z.id)]}:me)};await l(E,{silent:!0})},[s,l]),M=B.useCallback(async($,ue,de,oe)=>{const Le=await $E($,ue||5);if(oe.aborted)return;const De=aa(Le),Se={...$,questions:[...$.questions||[],...De]};await n(Se,{silent:!0})},[n]),J=B.useCallback(async($,ue)=>{const{deck:de,comprehensiveness:oe}=$,le=await ih(de.name,oe||"Standard"),{infoCards:Le,questions:De,name:Se,description:ne}=le;if(ue.aborted)return;const E=new Date().toISOString(),me=(Le||[]).map(Y=>({...Y,id:Y.id||crypto.randomUUID(),unlocksQuestionIds:Y.unlocksQuestionIds||[]})),X=(De||[]).map(Y=>({...Y,id:Y.id||crypto.randomUUID(),questionType:"multipleChoice",dueDate:E,interval:0,easeFactor:2.5,lapses:0,masteryLevel:0,suspended:!1,options:(Y.options||[]).map(ie=>({...ie,id:crypto.randomUUID()}))}));X.forEach(Y=>{(Y.infoCardIds||[]).forEach(ie=>{const ke=me.find(Ce=>Ce.id===ie);ke&&(ke.unlocksQuestionIds=Array.from(new Set([...ke.unlocksQuestionIds||[],Y.id])))})});const Z={...de,name:Se||de.name,description:ne||de.description,infoCards:[...de.infoCards||[],...me],questions:[...de.questions||[],...X]};await n(Z,{silent:!0})},[n]),N=B.useCallback(async($,ue)=>{const{seriesId:de}=$,oe=Ze.getState().deckSeries[de];if(!oe)return;const le=(oe.levels||[]).flatMap(De=>De.deckIds),Le=Ze.getState().decks;for(const De of le){if(ue.aborted)return;const Se=Le[De];Se&&Se.type===je.Quiz&&Se.questions.length===0&&(p({type:"UPDATE_CURRENT_AI_TASK_STATUS",payload:{statusText:`Generating questions for "${Se.name}"...`}}),await M(Se,5,{name:oe.name,description:oe.description},ue))}},[M,p]),se=B.useCallback(async($,ue)=>{const{deckId:de,questionId:oe}=$,le=Ze.getState().decks[de];if(!le)return;const Le=le.questions,De=Le.find(X=>X.id===oe);if(!De)return;const ne=await XE(De,le.name);if(ue.aborted)return;const E={...De,...ne},me={...le,questions:Le.map(X=>X.id===oe?E:X)};await n(me,{silent:!0})},[n]),K=B.useCallback(async($,ue)=>{p({type:"UPDATE_CURRENT_AI_TASK_STATUS",payload:{statusText:"Generating deck content..."}});let de;if($.immediate?de=await ih($.topic,"Standard",!1):de=await HE($.outline,$.metadata),ue.aborted)throw new Error("Cancelled by user");const oe=$.deckId;if(oe){const Se=Ze.getState().decks[oe];if(Se){const ne=aa(de.questions||[]),E={...Se,questions:[...Se.questions||[],...ne]};await n(E,{silent:!0}),f(`Added content to "${Se.name}"!`,"success");return}}const le={id:crypto.randomUUID(),name:de.name||$.topic||"New Quiz",description:de.description||"",type:je.Quiz,questions:aa(de.questions||[])};await s([le]);const{seriesId:Le,levelIndex:De}=$;if(Le&&De!==void 0){const Se=Ze.getState().deckSeries[Le];if(Se&&Se.levels[De]){const ne={...Se,levels:Se.levels.map((E,me)=>me===De?{...E,deckIds:[...E.deckIds,le.id]}:E)};await l(ne,{silent:!0})}}f(`Deck "${le.name}" generated!`,"success")},[p,s,l,f,n]),P=B.useCallback(async($,ue)=>{p({type:"UPDATE_CURRENT_AI_TASK_STATUS",payload:{statusText:"Generating flashcards..."}});const de=$.persona||"default",oe=localStorage.getItem("cogniflow-ai-options");let le=[];oe&&(le=JSON.parse(oe).personas||[]);const Le=le.find(ne=>ne.id===de)||{instruction:"You are a helpful assistant."},De=await qE($,Le);if(ue.aborted)throw new Error("Cancelled by user");if($.deckId){const ne=Ze.getState().decks[$.deckId];if(ne&&ne.type===je.Flashcard){const E=Ya(De.cards||[]),me={...ne,cards:[...ne.cards||[],...E]};await n(me,{silent:!0}),f(`Added cards to "${ne.name}"!`,"success");return}}const Se={id:crypto.randomUUID(),name:De.name||$.topic,description:De.description||"",type:je.Flashcard,cards:Ya(De.cards||[])};await s([Se]),f(`Deck "${Se.name}" generated!`,"success")},[p,s,f,n]),ve=B.useCallback(async($,ue)=>{p({type:"UPDATE_CURRENT_AI_TASK_STATUS",payload:{statusText:"Generating course content..."}});const de=$.generationType==="deck-course"||$.generationType==="single-deck-learning",oe=await ih($.topic,$.comprehensiveness,de),{infoCards:le,questions:Le,name:De,description:Se}=oe;if(ue.aborted)throw new Error("Cancelled by user");const ne=(le||[]).map(X=>({...X,id:X.id||crypto.randomUUID(),unlocksQuestionIds:X.unlocksQuestionIds||[]})),E=aa(Le||[]);if($.deckId){const X=Ze.getState().decks[$.deckId];if(X&&X.type===je.Learning){const Z={...X,infoCards:[...X.infoCards||[],...ne],questions:[...X.questions||[],...E]};await n(Z,{silent:!0}),f(`Added content to "${X.name}"!`,"success");return}}const me={id:crypto.randomUUID(),name:De||$.topic,description:Se||`Generated course on ${$.topic}`,type:je.Learning,infoCards:ne,questions:E,learningMode:"separate"};await s([me]),f("Learning Deck generated!","success")},[p,s,f,n]),ce=B.useCallback(async($,ue)=>{p({type:"UPDATE_CURRENT_AI_TASK_STATUS",payload:{statusText:"Creating series structure..."}});const de=$.generationType.includes("flashcard")?je.Flashcard:je.Quiz,oe=await GE($.outline);if(ue.aborted)throw new Error("Cancelled by user");const le=[],Le=(oe.levels||[]).map(Se=>{const ne=(Se.decks||[]).map(E=>{const me={id:crypto.randomUUID(),name:E.name,description:E.description};return de===je.Flashcard?{...me,type:je.Flashcard,cards:[]}:{...me,type:je.Quiz,questions:[]}});return le.push(...ne),{title:Se.title,deckIds:ne.map(E=>E.id)}}),De={id:crypto.randomUUID(),type:"series",name:oe.seriesName||oe.name||"New Series",description:oe.seriesDescription||oe.description||"",levels:Le,createdAt:new Date().toISOString(),archived:!1};await i(De,le)},[p,i]),Ee=B.useCallback(async $=>{const ue=$.questions.map(de=>({id:de.id,text:de.questionText}));if(ue.length!==0){f("Categorizing questions...","info");try{const de=await KE(ue),oe=$.questions.map(le=>({...le,tags:Array.from(new Set([...le.tags||[],...de[le.id]||[]]))}));await n({...$,questions:oe}),f("Questions tagged successfully!","success")}catch{f("Failed to generate tags.","error")}}},[n,f]),z=B.useCallback(async $=>{try{const ue=await VE($.name,$.description);await n({...$,icon:ue}),f(`Updated icon to: ${ue}`,"success")}catch{f("Failed to suggest icon.","error")}},[n,f]),I=B.useCallback(async($,ue,de)=>{try{return await QE($,ue,de)}catch{return f("Failed to expand text.","error"),null}},[f]),te=B.useCallback(async($,ue,de)=>{try{return await ZE($,ue,de)}catch{return f("Failed to generate examples.","error"),null}},[f]),ae=B.useCallback(async($,ue)=>{var de;try{const oe=$.options.filter(Se=>Se.id!==$.correctAnswerId).map(Se=>Se.text),le=((de=$.options.find(Se=>Se.id===$.correctAnswerId))==null?void 0:de.text)||"",Le=await Xv($.questionText,le,oe,ue);return[$.options.find(Se=>Se.id===$.correctAnswerId),...Le.map(Se=>({id:crypto.randomUUID(),text:Se.text,explanation:Se.explanation}))].sort(()=>Math.random()-.5)}catch{return f("Failed to harden distractors.","error"),null}},[f]);return{onGenerateDeepCourse:x,onHardenAllDistractors:k,onGenerateAudioForAllCards:w,onUpgradeDeckToLearning:S,handleStartAIGeneration:C,handleImmediateAIGeneration:R,handleExecuteAIAction:L,handleCancelAIGeneration:F,handleOpenAIGenerationForDeck:G,handleOpenAIReworkForDeck:Q,handleOpenAIGenerationForSeriesLevel:U,handleOpenAIAutoExpandSeries:j,onReworkDeckContent:O,onAutoPopulateSeries:q,onAutoPopulateLevel:ee,onGenerateQuestionsForDeck:M,onGenerateLearningContentForDeck:J,onGenerateSeriesQuestionsInBatches:N,onRegenerateQuestion:se,onGenerateDeckFromOutline:K,onGenerateFlashcardDeck:P,onGenerateLearningDeckWithAI:ve,onGenerateFullSeriesFromScaffold:ce,handleAutoTagQuestions:Ee,handleSuggestDeckIcon:z,handleExpandText:I,handleGenerateCardExamples:te,handleHardenDistractors:ae}};var xh={exports:{}};const MT={},UT=Object.freeze(Object.defineProperty({__proto__:null,default:MT},Symbol.toStringTag,{value:"Module"})),_h=i_(UT);var mb;function LT(){return mb||(mb=1,(function(n,a){var s=void 0,i=function(l){return s||(s=new Promise(function(c,d){var m=typeof l<"u"?l:{},p=m.onAbort;m.onAbort=function(y){d(new Error(y)),p&&p(y)},m.postRun=m.postRun||[],m.postRun.push(function(){c(m)}),n=void 0;var f;f||(f=typeof m<"u"?m:{}),f.onRuntimeInitialized=function(){function y(be,Fe){switch(typeof Fe){case"boolean":Gs(be,Fe?1:0);break;case"number":Zu(be,Fe);break;case"string":Qu(be,Fe,-1,-1);break;case"object":if(Fe===null)$l(be);else if(Fe.length!=null){var et=vi(Fe,as);xo(be,et,Fe.length,-1),da(et)}else xi(be,"Wrong API use : tried to return a value of an unknown type ("+Fe+").",-1);break;default:$l(be)}}function b(be,Fe){for(var et=[],lt=0;lt<be;lt+=1){var Et=X(Fe+4*lt,"i32"),Zt=Pu(Et);if(Zt===1||Zt===2)Et=Ku(Et);else if(Zt===3)Et=Yu(Et);else if(Zt===4){Zt=Et,Et=$u(Zt),Zt=Vu(Zt);for(var br=new Uint8Array(Et),nr=0;nr<Et;nr+=1)br[nr]=q[Zt+nr];Et=br}else Et=null;et.push(Et)}return et}function D(be,Fe){this.La=be,this.db=Fe,this.Ja=1,this.fb=[]}function V(be,Fe){if(this.db=Fe,Fe=Ye(be)+1,this.Ya=Fs(Fe),this.Ya===null)throw Error("Unable to allocate memory for the SQL string");St(be,ee,this.Ya,Fe),this.eb=this.Ya,this.Ua=this.ib=null}function W(be){if(this.filename="dbfile_"+(4294967295*Math.random()>>>0),be!=null){var Fe=this.filename,et="/",lt=Fe;if(et&&(et=typeof et=="string"?et:yr(et),lt=Fe?pe(et+"/"+Fe):et),Fe=Jr(!0,!0),lt=Xe(lt,(Fe!==void 0?Fe:438)&4095|32768,0),be){if(typeof be=="string"){et=Array(be.length);for(var Et=0,Zt=be.length;Et<Zt;++Et)et[Et]=be.charCodeAt(Et);be=et}vr(lt,Fe|146),et=Zn(lt,577),Ul(et,be,0,be.length,0),es(et),vr(lt,Fe)}}this.handleError(ot(this.filename,Te)),this.db=X(Te,"i32"),So(this.db),this.Za={},this.Na={}}var Te=Hn(4),Re=f.cwrap,ot=Re("sqlite3_open","number",["string","number"]),Ut=Re("sqlite3_close_v2","number",["number"]),yt=Re("sqlite3_exec","number",["number","string","number","number","number"]),dn=Re("sqlite3_changes","number",["number"]),fn=Re("sqlite3_prepare_v2","number",["number","string","number","number","number"]),Hs=Re("sqlite3_sql","string",["number"]),zl=Re("sqlite3_normalized_sql","string",["number"]),Fl=Re("sqlite3_prepare_v2","number",["number","number","number","number","number"]),ju=Re("sqlite3_bind_text","number",["number","number","number","number","number"]),Bl=Re("sqlite3_bind_blob","number",["number","number","number","number","number"]),vo=Re("sqlite3_bind_double","number",["number","number","number"]),Iu=Re("sqlite3_bind_int","number",["number","number","number"]),Ru=Re("sqlite3_bind_parameter_index","number",["number","string"]),Mu=Re("sqlite3_step","number",["number"]),Uu=Re("sqlite3_errmsg","string",["number"]),Lu=Re("sqlite3_column_count","number",["number"]),Hl=Re("sqlite3_data_count","number",["number"]),zu=Re("sqlite3_column_double","number",["number","number"]),Gl=Re("sqlite3_column_text","string",["number","number"]),Fu=Re("sqlite3_column_blob","number",["number","number"]),Bu=Re("sqlite3_column_bytes","number",["number","number"]),bo=Re("sqlite3_column_type","number",["number","number"]),Hu=Re("sqlite3_column_name","string",["number","number"]),Gu=Re("sqlite3_reset","number",["number"]),qu=Re("sqlite3_clear_bindings","number",["number"]),ql=Re("sqlite3_finalize","number",["number"]),Pl=Re("sqlite3_create_function_v2","number","number string number number number number number number number".split(" ")),Pu=Re("sqlite3_value_type","number",["number"]),$u=Re("sqlite3_value_bytes","number",["number"]),Yu=Re("sqlite3_value_text","string",["number"]),Vu=Re("sqlite3_value_blob","number",["number"]),Ku=Re("sqlite3_value_double","number",["number"]),Zu=Re("sqlite3_result_double","",["number","number"]),$l=Re("sqlite3_result_null","",["number"]),Qu=Re("sqlite3_result_text","",["number","string","number","number"]),xo=Re("sqlite3_result_blob","",["number","number","number","number"]),Gs=Re("sqlite3_result_int","",["number","number"]),xi=Re("sqlite3_result_error","",["number","string","number"]),_o=Re("sqlite3_aggregate_context","number",["number","number"]),So=Re("RegisterExtensionFunctions","number",["number"]);D.prototype.bind=function(be){if(!this.La)throw"Statement closed";return this.reset(),Array.isArray(be)?this.wb(be):be!=null&&typeof be=="object"?this.xb(be):!0},D.prototype.step=function(){if(!this.La)throw"Statement closed";this.Ja=1;var be=Mu(this.La);switch(be){case 100:return!0;case 101:return!1;default:throw this.db.handleError(be)}},D.prototype.rb=function(be){return be==null&&(be=this.Ja,this.Ja+=1),zu(this.La,be)},D.prototype.Ab=function(be){if(be==null&&(be=this.Ja,this.Ja+=1),be=Gl(this.La,be),typeof BigInt!="function")throw Error("BigInt is not supported");return BigInt(be)},D.prototype.Bb=function(be){return be==null&&(be=this.Ja,this.Ja+=1),Gl(this.La,be)},D.prototype.getBlob=function(be){be==null&&(be=this.Ja,this.Ja+=1);var Fe=Bu(this.La,be);be=Fu(this.La,be);for(var et=new Uint8Array(Fe),lt=0;lt<Fe;lt+=1)et[lt]=q[be+lt];return et},D.prototype.get=function(be,Fe){Fe=Fe||{},be!=null&&this.bind(be)&&this.step(),be=[];for(var et=Hl(this.La),lt=0;lt<et;lt+=1)switch(bo(this.La,lt)){case 1:var Et=Fe.useBigInt?this.Ab(lt):this.rb(lt);be.push(Et);break;case 2:be.push(this.rb(lt));break;case 3:be.push(this.Bb(lt));break;case 4:be.push(this.getBlob(lt));break;default:be.push(null)}return be},D.prototype.getColumnNames=function(){for(var be=[],Fe=Lu(this.La),et=0;et<Fe;et+=1)be.push(Hu(this.La,et));return be},D.prototype.getAsObject=function(be,Fe){be=this.get(be,Fe),Fe=this.getColumnNames();for(var et={},lt=0;lt<Fe.length;lt+=1)et[Fe[lt]]=be[lt];return et},D.prototype.getSQL=function(){return Hs(this.La)},D.prototype.getNormalizedSQL=function(){return zl(this.La)},D.prototype.run=function(be){return be!=null&&this.bind(be),this.step(),this.reset()},D.prototype.nb=function(be,Fe){Fe==null&&(Fe=this.Ja,this.Ja+=1),be=wt(be);var et=vi(be,as);this.fb.push(et),this.db.handleError(ju(this.La,Fe,et,be.length-1,0))},D.prototype.vb=function(be,Fe){Fe==null&&(Fe=this.Ja,this.Ja+=1);var et=vi(be,as);this.fb.push(et),this.db.handleError(Bl(this.La,Fe,et,be.length,0))},D.prototype.mb=function(be,Fe){Fe==null&&(Fe=this.Ja,this.Ja+=1),this.db.handleError((be===(be|0)?Iu:vo)(this.La,Fe,be))},D.prototype.yb=function(be){be==null&&(be=this.Ja,this.Ja+=1),Bl(this.La,be,0,0,0)},D.prototype.ob=function(be,Fe){switch(Fe==null&&(Fe=this.Ja,this.Ja+=1),typeof be){case"string":this.nb(be,Fe);return;case"number":this.mb(be,Fe);return;case"bigint":this.nb(be.toString(),Fe);return;case"boolean":this.mb(be+0,Fe);return;case"object":if(be===null){this.yb(Fe);return}if(be.length!=null){this.vb(be,Fe);return}}throw"Wrong API use : tried to bind a value of an unknown type ("+be+")."},D.prototype.xb=function(be){var Fe=this;return Object.keys(be).forEach(function(et){var lt=Ru(Fe.La,et);lt!==0&&Fe.ob(be[et],lt)}),!0},D.prototype.wb=function(be){for(var Fe=0;Fe<be.length;Fe+=1)this.ob(be[Fe],Fe+1);return!0},D.prototype.reset=function(){return this.freemem(),qu(this.La)===0&&Gu(this.La)===0},D.prototype.freemem=function(){for(var be;(be=this.fb.pop())!==void 0;)da(be)},D.prototype.free=function(){this.freemem();var be=ql(this.La)===0;return delete this.db.Za[this.La],this.La=0,be},V.prototype.next=function(){if(this.Ya===null)return{done:!0};if(this.Ua!==null&&(this.Ua.free(),this.Ua=null),!this.db.db)throw this.gb(),Error("Database closed");var be=ka(),Fe=Hn(4);Z(Te),Z(Fe);try{this.db.handleError(Fl(this.db.db,this.eb,-1,Te,Fe)),this.eb=X(Fe,"i32");var et=X(Te,"i32");return et===0?(this.gb(),{done:!0}):(this.Ua=new D(et,this.db),this.db.Za[et]=this.Ua,{value:this.Ua,done:!1})}catch(lt){throw this.ib=ke(this.eb),this.gb(),lt}finally{Xr(be)}},V.prototype.gb=function(){da(this.Ya),this.Ya=null},V.prototype.getRemainingSQL=function(){return this.ib!==null?this.ib:ke(this.eb)},typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"&&(V.prototype[Symbol.iterator]=function(){return this}),W.prototype.run=function(be,Fe){if(!this.db)throw"Database closed";if(Fe){be=this.prepare(be,Fe);try{be.step()}finally{be.free()}}else this.handleError(yt(this.db,be,0,0,Te));return this},W.prototype.exec=function(be,Fe,et){if(!this.db)throw"Database closed";var lt=ka(),Et=null;try{var Zt=yi(be),br=Hn(4);for(be=[];X(Zt,"i8")!==0;){Z(Te),Z(br),this.handleError(Fl(this.db,Zt,-1,Te,br));var nr=X(Te,"i32");if(Zt=X(br,"i32"),nr!==0){var Qn=null;for(Et=new D(nr,this),Fe!=null&&Et.bind(Fe);Et.step();)Qn===null&&(Qn={columns:Et.getColumnNames(),values:[]},be.push(Qn)),Qn.values.push(Et.get(null,et));Et.free()}}return be}catch(Gn){throw Et&&Et.free(),Gn}finally{Xr(lt)}},W.prototype.each=function(be,Fe,et,lt,Et){typeof Fe=="function"&&(lt=et,et=Fe,Fe=void 0),be=this.prepare(be,Fe);try{for(;be.step();)et(be.getAsObject(null,Et))}finally{be.free()}if(typeof lt=="function")return lt()},W.prototype.prepare=function(be,Fe){if(Z(Te),this.handleError(fn(this.db,be,-1,Te,0)),be=X(Te,"i32"),be===0)throw"Nothing to prepare";var et=new D(be,this);return Fe!=null&&et.bind(Fe),this.Za[be]=et},W.prototype.iterateStatements=function(be){return new V(be,this)},W.prototype.export=function(){Object.values(this.Za).forEach(function(Fe){Fe.free()}),Object.values(this.Na).forEach(ua),this.Na={},this.handleError(Ut(this.db));var be=hi(this.filename);return this.handleError(ot(this.filename,Te)),this.db=X(Te,"i32"),So(this.db),be},W.prototype.close=function(){this.db!==null&&(Object.values(this.Za).forEach(function(be){be.free()}),Object.values(this.Na).forEach(ua),this.Na={},this.handleError(Ut(this.db)),sn("/"+this.filename),this.db=null)},W.prototype.handleError=function(be){if(be===0)return null;throw be=Uu(this.db),Error(be)},W.prototype.getRowsModified=function(){return dn(this.db)},W.prototype.create_function=function(be,Fe){Object.prototype.hasOwnProperty.call(this.Na,be)&&(ua(this.Na[be]),delete this.Na[be]);var et=is(function(lt,Et,Zt){Et=b(Et,Zt);try{var br=Fe.apply(null,Et)}catch(nr){xi(lt,nr,-1);return}y(lt,br)},"viii");return this.Na[be]=et,this.handleError(Pl(this.db,be,Fe.length,1,0,et,0,0,0)),this},W.prototype.create_aggregate=function(be,Fe){var et=Fe.init||function(){return null},lt=Fe.finalize||function(Qn){return Qn},Et=Fe.step;if(!Et)throw"An aggregate function must have a step function in "+be;var Zt={};Object.hasOwnProperty.call(this.Na,be)&&(ua(this.Na[be]),delete this.Na[be]),Fe=be+"__finalize",Object.hasOwnProperty.call(this.Na,Fe)&&(ua(this.Na[Fe]),delete this.Na[Fe]);var br=is(function(Qn,Gn,Ca){var Na=_o(Qn,1);Object.hasOwnProperty.call(Zt,Na)||(Zt[Na]=et()),Gn=b(Gn,Ca),Gn=[Zt[Na]].concat(Gn);try{Zt[Na]=Et.apply(null,Gn)}catch(_i){delete Zt[Na],xi(Qn,_i,-1)}},"viii"),nr=is(function(Qn){var Gn=_o(Qn,1);try{var Ca=lt(Zt[Gn])}catch(Na){delete Zt[Gn],xi(Qn,Na,-1);return}y(Qn,Ca),delete Zt[Gn]},"vi");return this.Na[be]=br,this.Na[Fe]=nr,this.handleError(Pl(this.db,be,Et.length-1,1,0,0,br,nr,0)),this},f.Database=W};var v=Object.assign({},f),_="./this.program",T=typeof window=="object",x=typeof importScripts=="function",k=typeof process=="object"&&typeof process.versions=="object"&&typeof process.versions.node=="string",w="",S,C,R;if(k){var L=_h,F=_h;w=x?F.dirname(w)+"/":__dirname+"/",S=(y,b)=>(y=ue(y)?new URL(y):F.normalize(y),L.readFileSync(y,b?void 0:"utf8")),R=y=>(y=S(y,!0),y.buffer||(y=new Uint8Array(y)),y),C=(y,b,D,V=!0)=>{y=ue(y)?new URL(y):F.normalize(y),L.readFile(y,V?void 0:"utf8",(W,Te)=>{W?D(W):b(V?Te.buffer:Te)})},!f.thisProgram&&1<process.argv.length&&(_=process.argv[1].replace(/\\/g,"/")),process.argv.slice(2),n.exports=f,f.inspect=()=>"[Emscripten Module object]"}else(T||x)&&(x?w=self.location.href:typeof document<"u"&&document.currentScript&&(w=document.currentScript.src),w=w.indexOf("blob:")!==0?w.substr(0,w.replace(/[?#].*/,"").lastIndexOf("/")+1):"",S=y=>{var b=new XMLHttpRequest;return b.open("GET",y,!1),b.send(null),b.responseText},x&&(R=y=>{var b=new XMLHttpRequest;return b.open("GET",y,!1),b.responseType="arraybuffer",b.send(null),new Uint8Array(b.response)}),C=(y,b,D)=>{var V=new XMLHttpRequest;V.open("GET",y,!0),V.responseType="arraybuffer",V.onload=()=>{V.status==200||V.status==0&&V.response?b(V.response):D()},V.onerror=D,V.send(null)});var G=f.print||console.log.bind(console),Q=f.printErr||console.error.bind(console);Object.assign(f,v),v=null,f.thisProgram&&(_=f.thisProgram);var U;f.wasmBinary&&(U=f.wasmBinary),typeof WebAssembly!="object"&&ae("no native wasm support detected");var j,O=!1,q,ee,M,J,N,se,K;function P(){var y=j.buffer;f.HEAP8=q=new Int8Array(y),f.HEAP16=M=new Int16Array(y),f.HEAPU8=ee=new Uint8Array(y),f.HEAPU16=new Uint16Array(y),f.HEAP32=J=new Int32Array(y),f.HEAPU32=N=new Uint32Array(y),f.HEAPF32=se=new Float32Array(y),f.HEAPF64=K=new Float64Array(y)}var ve=[],ce=[],Ee=[];function z(){var y=f.preRun.shift();ve.unshift(y)}var I=0,te=null;function ae(y){var b;throw(b=f.onAbort)==null||b.call(f,y),y="Aborted("+y+")",Q(y),O=!0,new WebAssembly.RuntimeError(y+". Build with -sASSERTIONS for more info.")}var $=y=>y.startsWith("data:application/octet-stream;base64,"),ue=y=>y.startsWith("file://"),de;if(de="sql-wasm.wasm",!$(de)){var oe=de;de=f.locateFile?f.locateFile(oe,w):w+oe}function le(y){if(y==de&&U)return new Uint8Array(U);if(R)return R(y);throw"both async and sync fetching of the wasm failed"}function Le(y){if(!U&&(T||x)){if(typeof fetch=="function"&&!ue(y))return fetch(y,{credentials:"same-origin"}).then(b=>{if(!b.ok)throw"failed to load wasm binary file at '"+y+"'";return b.arrayBuffer()}).catch(()=>le(y));if(C)return new Promise((b,D)=>{C(y,V=>b(new Uint8Array(V)),D)})}return Promise.resolve().then(()=>le(y))}function De(y,b,D){return Le(y).then(V=>WebAssembly.instantiate(V,b)).then(V=>V).then(D,V=>{Q(`failed to asynchronously prepare wasm: ${V}`),ae(V)})}function Se(y,b){var D=de;U||typeof WebAssembly.instantiateStreaming!="function"||$(D)||ue(D)||k||typeof fetch!="function"?De(D,y,b):fetch(D,{credentials:"same-origin"}).then(V=>WebAssembly.instantiateStreaming(V,y).then(b,function(W){return Q(`wasm streaming compile failed: ${W}`),Q("falling back to ArrayBuffer instantiation"),De(D,y,b)}))}var ne,E,me=y=>{for(;0<y.length;)y.shift()(f)};function X(y,b="i8"){switch(b.endsWith("*")&&(b="*"),b){case"i1":return q[y>>0];case"i8":return q[y>>0];case"i16":return M[y>>1];case"i32":return J[y>>2];case"i64":ae("to do getValue(i64) use WASM_BIGINT");case"float":return se[y>>2];case"double":return K[y>>3];case"*":return N[y>>2];default:ae(`invalid type for getValue: ${b}`)}}function Z(y){var b="i32";switch(b.endsWith("*")&&(b="*"),b){case"i1":q[y>>0]=0;break;case"i8":q[y>>0]=0;break;case"i16":M[y>>1]=0;break;case"i32":J[y>>2]=0;break;case"i64":ae("to do setValue(i64) use WASM_BIGINT");case"float":se[y>>2]=0;break;case"double":K[y>>3]=0;break;case"*":N[y>>2]=0;break;default:ae(`invalid type for setValue: ${b}`)}}var Y=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0,ie=(y,b,D)=>{var V=b+D;for(D=b;y[D]&&!(D>=V);)++D;if(16<D-b&&y.buffer&&Y)return Y.decode(y.subarray(b,D));for(V="";b<D;){var W=y[b++];if(W&128){var Te=y[b++]&63;if((W&224)==192)V+=String.fromCharCode((W&31)<<6|Te);else{var Re=y[b++]&63;W=(W&240)==224?(W&15)<<12|Te<<6|Re:(W&7)<<18|Te<<12|Re<<6|y[b++]&63,65536>W?V+=String.fromCharCode(W):(W-=65536,V+=String.fromCharCode(55296|W>>10,56320|W&1023))}}else V+=String.fromCharCode(W)}return V},ke=(y,b)=>y?ie(ee,y,b):"",Ce=(y,b)=>{for(var D=0,V=y.length-1;0<=V;V--){var W=y[V];W==="."?y.splice(V,1):W===".."?(y.splice(V,1),D++):D&&(y.splice(V,1),D--)}if(b)for(;D;D--)y.unshift("..");return y},pe=y=>{var b=y.charAt(0)==="/",D=y.substr(-1)==="/";return(y=Ce(y.split("/").filter(V=>!!V),!b).join("/"))||b||(y="."),y&&D&&(y+="/"),(b?"/":"")+y},Ie=y=>{var b=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/.exec(y).slice(1);return y=b[0],b=b[1],!y&&!b?".":(b&&(b=b.substr(0,b.length-1)),y+b)},He=y=>{if(y==="/")return"/";y=pe(y),y=y.replace(/\/$/,"");var b=y.lastIndexOf("/");return b===-1?y:y.substr(b+1)},Oe=()=>{if(typeof crypto=="object"&&typeof crypto.getRandomValues=="function")return D=>crypto.getRandomValues(D);if(k)try{var y=_h;if(y.randomFillSync)return D=>y.randomFillSync(D);var b=y.randomBytes;return D=>(D.set(b(D.byteLength)),D)}catch{}ae("initRandomDevice")},qe=y=>(qe=Oe())(y);function nt(){for(var y="",b=!1,D=arguments.length-1;-1<=D&&!b;D--){if(b=0<=D?arguments[D]:"/",typeof b!="string")throw new TypeError("Arguments to path.resolve must be strings");if(!b)return"";y=b+"/"+y,b=b.charAt(0)==="/"}return y=Ce(y.split("/").filter(V=>!!V),!b).join("/"),(b?"/":"")+y||"."}var We=[],Ye=y=>{for(var b=0,D=0;D<y.length;++D){var V=y.charCodeAt(D);127>=V?b++:2047>=V?b+=2:55296<=V&&57343>=V?(b+=4,++D):b+=3}return b},St=(y,b,D,V)=>{if(!(0<V))return 0;var W=D;V=D+V-1;for(var Te=0;Te<y.length;++Te){var Re=y.charCodeAt(Te);if(55296<=Re&&57343>=Re){var ot=y.charCodeAt(++Te);Re=65536+((Re&1023)<<10)|ot&1023}if(127>=Re){if(D>=V)break;b[D++]=Re}else{if(2047>=Re){if(D+1>=V)break;b[D++]=192|Re>>6}else{if(65535>=Re){if(D+2>=V)break;b[D++]=224|Re>>12}else{if(D+3>=V)break;b[D++]=240|Re>>18,b[D++]=128|Re>>12&63}b[D++]=128|Re>>6&63}b[D++]=128|Re&63}}return b[D]=0,D-W};function wt(y,b){var D=Array(Ye(y)+1);return y=St(y,D,0,D.length),b&&(D.length=y),D}var jt=[];function mt(y,b){jt[y]={input:[],output:[],Xa:b},Wa(y,rt)}var rt={open(y){var b=jt[y.node.rdev];if(!b)throw new Pe(43);y.tty=b,y.seekable=!1},close(y){y.tty.Xa.fsync(y.tty)},fsync(y){y.tty.Xa.fsync(y.tty)},read(y,b,D,V){if(!y.tty||!y.tty.Xa.sb)throw new Pe(60);for(var W=0,Te=0;Te<V;Te++){try{var Re=y.tty.Xa.sb(y.tty)}catch{throw new Pe(29)}if(Re===void 0&&W===0)throw new Pe(6);if(Re==null)break;W++,b[D+Te]=Re}return W&&(y.node.timestamp=Date.now()),W},write(y,b,D,V){if(!y.tty||!y.tty.Xa.jb)throw new Pe(60);try{for(var W=0;W<V;W++)y.tty.Xa.jb(y.tty,b[D+W])}catch{throw new Pe(29)}return V&&(y.node.timestamp=Date.now()),W}},un={sb(){e:{if(!We.length){var y=null;if(k){var b=Buffer.alloc(256),D=0,V=process.stdin.fd;try{D=L.readSync(V,b)}catch(W){if(W.toString().includes("EOF"))D=0;else throw W}0<D?y=b.slice(0,D).toString("utf-8"):y=null}else typeof window<"u"&&typeof window.prompt=="function"?(y=window.prompt("Input: "),y!==null&&(y+=`
`)):typeof readline=="function"&&(y=readline(),y!==null&&(y+=`
`));if(!y){y=null;break e}We=wt(y,!0)}y=We.shift()}return y},jb(y,b){b===null||b===10?(G(ie(y.output,0)),y.output=[]):b!=0&&y.output.push(b)},fsync(y){y.output&&0<y.output.length&&(G(ie(y.output,0)),y.output=[])},Mb(){return{Ib:25856,Kb:5,Hb:191,Jb:35387,Gb:[3,28,127,21,4,0,1,0,17,19,26,0,18,15,23,22,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]}},Nb(){return 0},Ob(){return[24,80]}},Mt={jb(y,b){b===null||b===10?(Q(ie(y.output,0)),y.output=[]):b!=0&&y.output.push(b)},fsync(y){y.output&&0<y.output.length&&(Q(ie(y.output,0)),y.output=[])}};function cr(y,b){var D=y.Ia?y.Ia.length:0;D>=b||(b=Math.max(b,D*(1048576>D?2:1.125)>>>0),D!=0&&(b=Math.max(b,256)),D=y.Ia,y.Ia=new Uint8Array(b),0<y.Ma&&y.Ia.set(D.subarray(0,y.Ma),0))}var ut={Qa:null,Ra(){return ut.createNode(null,"/",16895,0)},createNode(y,b,D,V){if((D&61440)===24576||(D&61440)===4096)throw new Pe(63);return ut.Qa||(ut.Qa={dir:{node:{Pa:ut.Ga.Pa,Oa:ut.Ga.Oa,lookup:ut.Ga.lookup,ab:ut.Ga.ab,rename:ut.Ga.rename,unlink:ut.Ga.unlink,rmdir:ut.Ga.rmdir,readdir:ut.Ga.readdir,symlink:ut.Ga.symlink},stream:{Ta:ut.Ha.Ta}},file:{node:{Pa:ut.Ga.Pa,Oa:ut.Ga.Oa},stream:{Ta:ut.Ha.Ta,read:ut.Ha.read,write:ut.Ha.write,lb:ut.Ha.lb,bb:ut.Ha.bb,cb:ut.Ha.cb}},link:{node:{Pa:ut.Ga.Pa,Oa:ut.Ga.Oa,readlink:ut.Ga.readlink},stream:{}},pb:{node:{Pa:ut.Ga.Pa,Oa:ut.Ga.Oa},stream:Xa}}),D=Fn(y,b,D,V),An(D.mode)?(D.Ga=ut.Qa.dir.node,D.Ha=ut.Qa.dir.stream,D.Ia={}):(D.mode&61440)===32768?(D.Ga=ut.Qa.file.node,D.Ha=ut.Qa.file.stream,D.Ma=0,D.Ia=null):(D.mode&61440)===40960?(D.Ga=ut.Qa.link.node,D.Ha=ut.Qa.link.stream):(D.mode&61440)===8192&&(D.Ga=ut.Qa.pb.node,D.Ha=ut.Qa.pb.stream),D.timestamp=Date.now(),y&&(y.Ia[b]=D,y.timestamp=D.timestamp),D},Lb(y){return y.Ia?y.Ia.subarray?y.Ia.subarray(0,y.Ma):new Uint8Array(y.Ia):new Uint8Array(0)},Ga:{Pa(y){var b={};return b.dev=(y.mode&61440)===8192?y.id:1,b.ino=y.id,b.mode=y.mode,b.nlink=1,b.uid=0,b.gid=0,b.rdev=y.rdev,An(y.mode)?b.size=4096:(y.mode&61440)===32768?b.size=y.Ma:(y.mode&61440)===40960?b.size=y.link.length:b.size=0,b.atime=new Date(y.timestamp),b.mtime=new Date(y.timestamp),b.ctime=new Date(y.timestamp),b.zb=4096,b.blocks=Math.ceil(b.size/b.zb),b},Oa(y,b){if(b.mode!==void 0&&(y.mode=b.mode),b.timestamp!==void 0&&(y.timestamp=b.timestamp),b.size!==void 0&&(b=b.size,y.Ma!=b))if(b==0)y.Ia=null,y.Ma=0;else{var D=y.Ia;y.Ia=new Uint8Array(b),D&&y.Ia.set(D.subarray(0,Math.min(b,y.Ma))),y.Ma=b}},lookup(){throw _a[44]},ab(y,b,D,V){return ut.createNode(y,b,D,V)},rename(y,b,D){if(An(y.mode)){try{var V=Ir(b,D)}catch{}if(V)for(var W in V.Ia)throw new Pe(55)}delete y.parent.Ia[y.name],y.parent.timestamp=Date.now(),y.name=D,b.Ia[D]=y,b.timestamp=y.parent.timestamp,y.parent=b},unlink(y,b){delete y.Ia[b],y.timestamp=Date.now()},rmdir(y,b){var D=Ir(y,b),V;for(V in D.Ia)throw new Pe(55);delete y.Ia[b],y.timestamp=Date.now()},readdir(y){var b=[".",".."],D;for(D of Object.keys(y.Ia))b.push(D);return b},symlink(y,b,D){return y=ut.createNode(y,b,41471,0),y.link=D,y},readlink(y){if((y.mode&61440)!==40960)throw new Pe(28);return y.link}},Ha:{read(y,b,D,V,W){var Te=y.node.Ia;if(W>=y.node.Ma)return 0;if(y=Math.min(y.node.Ma-W,V),8<y&&Te.subarray)b.set(Te.subarray(W,W+y),D);else for(V=0;V<y;V++)b[D+V]=Te[W+V];return y},write(y,b,D,V,W,Te){if(b.buffer===q.buffer&&(Te=!1),!V)return 0;if(y=y.node,y.timestamp=Date.now(),b.subarray&&(!y.Ia||y.Ia.subarray)){if(Te)return y.Ia=b.subarray(D,D+V),y.Ma=V;if(y.Ma===0&&W===0)return y.Ia=b.slice(D,D+V),y.Ma=V;if(W+V<=y.Ma)return y.Ia.set(b.subarray(D,D+V),W),V}if(cr(y,W+V),y.Ia.subarray&&b.subarray)y.Ia.set(b.subarray(D,D+V),W);else for(Te=0;Te<V;Te++)y.Ia[W+Te]=b[D+Te];return y.Ma=Math.max(y.Ma,W+V),V},Ta(y,b,D){if(D===1?b+=y.position:D===2&&(y.node.mode&61440)===32768&&(b+=y.node.Ma),0>b)throw new Pe(28);return b},lb(y,b,D){cr(y.node,b+D),y.node.Ma=Math.max(y.node.Ma,b+D)},bb(y,b,D,V,W){if((y.node.mode&61440)!==32768)throw new Pe(43);if(y=y.node.Ia,W&2||y.buffer!==q.buffer){if((0<D||D+b<y.length)&&(y.subarray?y=y.subarray(D,D+b):y=Array.prototype.slice.call(y,D,D+b)),D=!0,b=65536*Math.ceil(b/65536),(W=zr(65536,b))?(ee.fill(0,W,W+b),b=W):b=0,!b)throw new Pe(48);q.set(y,b)}else D=!1,b=y.byteOffset;return{Db:b,ub:D}},cb(y,b,D,V){return ut.Ha.write(y,b,0,V,D,!1),0}}},Jr=(y,b)=>{var D=0;return y&&(D|=365),b&&(D|=146),D},Kn=null,qt={},tn=[],vn=1,gt=null,pn=!0,Pe=null,_a={};function Sn(y,b={}){if(y=nt(y),!y)return{path:"",node:null};if(b=Object.assign({qb:!0,kb:0},b),8<b.kb)throw new Pe(32);y=y.split("/").filter(Re=>!!Re);for(var D=Kn,V="/",W=0;W<y.length;W++){var Te=W===y.length-1;if(Te&&b.parent)break;if(D=Ir(D,y[W]),V=pe(V+"/"+y[W]),D.Va&&(!Te||Te&&b.qb)&&(D=D.Va.root),!Te||b.Sa){for(Te=0;(D.mode&61440)===40960;)if(D=nn(V),V=nt(Ie(V),D),D=Sn(V,{kb:b.kb+1}).node,40<Te++)throw new Pe(32)}}return{path:V,node:D}}function yr(y){for(var b;;){if(y===y.parent)return y=y.Ra.tb,b?y[y.length-1]!=="/"?`${y}/${b}`:y+b:y;b=b?`${y.name}/${b}`:y.name,y=y.parent}}function Qa(y,b){for(var D=0,V=0;V<b.length;V++)D=(D<<5)-D+b.charCodeAt(V)|0;return(y+D>>>0)%gt.length}function Ja(y){var b=Qa(y.parent.id,y.name);if(gt[b]===y)gt[b]=y.Wa;else for(b=gt[b];b;){if(b.Wa===y){b.Wa=y.Wa;break}b=b.Wa}}function Ir(y,b){var D;if(D=(D=Rr(y,"x"))?D:y.Ga.lookup?0:2)throw new Pe(D,y);for(D=gt[Qa(y.id,b)];D;D=D.Wa){var V=D.name;if(D.parent.id===y.id&&V===b)return D}return y.Ga.lookup(y,b)}function Fn(y,b,D,V){return y=new Aa(y,b,D,V),b=Qa(y.parent.id,y.name),y.Wa=gt[b],gt[b]=y}function An(y){return(y&61440)===16384}function Sa(y){var b=["r","w","rw"][y&3];return y&512&&(b+="w"),b}function Rr(y,b){if(pn)return 0;if(!b.includes("r")||y.mode&292){if(b.includes("w")&&!(y.mode&146)||b.includes("x")&&!(y.mode&73))return 2}else return 2;return 0}function Ls(y,b){try{return Ir(y,b),20}catch{}return Rr(y,"wx")}function ur(y,b,D){try{var V=Ir(y,b)}catch(W){return W.Ka}if(y=Rr(y,"wx"))return y;if(D){if(!An(V.mode))return 54;if(V===V.parent||yr(V)==="/")return 10}else if(An(V.mode))return 31;return 0}function Yt(){for(var y=0;4096>=y;y++)if(!tn[y])return y;throw new Pe(33)}function Bt(y){if(y=tn[y],!y)throw new Pe(8);return y}function Mr(y,b=-1){return wa||(wa=function(){this.$a={}},wa.prototype={},Object.defineProperties(wa.prototype,{object:{get(){return this.node},set(D){this.node=D}},flags:{get(){return this.$a.flags},set(D){this.$a.flags=D}},position:{get(){return this.$a.position},set(D){this.$a.position=D}}})),y=Object.assign(new wa,y),b==-1&&(b=Yt()),y.fd=b,tn[b]=y}var Xa={open(y){var b,D;y.Ha=qt[y.node.rdev].Ha,(D=(b=y.Ha).open)==null||D.call(b,y)},Ta(){throw new Pe(70)}};function Wa(y,b){qt[y]={Ha:b}}function fi(y,b){var D=b==="/",V=!b;if(D&&Kn)throw new Pe(10);if(!D&&!V){var W=Sn(b,{qb:!1});if(b=W.path,W=W.node,W.Va)throw new Pe(10);if(!An(W.mode))throw new Pe(54)}b={type:y,Pb:{},tb:b,Cb:[]},y=y.Ra(b),y.Ra=b,b.root=y,D?Kn=y:W&&(W.Va=b,W.Ra&&W.Ra.Cb.push(b))}function Xe(y,b,D){var V=Sn(y,{parent:!0}).node;if(y=He(y),!y||y==="."||y==="..")throw new Pe(28);var W=Ls(V,y);if(W)throw new Pe(W);if(!V.Ga.ab)throw new Pe(63);return V.Ga.ab(V,y,b,D)}function fe(y,b){return Xe(y,(b!==void 0?b:511)&1023|16384,0)}function Be(y,b,D){typeof D>"u"&&(D=b,b=438),Xe(y,b|8192,D)}function Ke(y,b){if(!nt(y))throw new Pe(44);var D=Sn(b,{parent:!0}).node;if(!D)throw new Pe(44);b=He(b);var V=Ls(D,b);if(V)throw new Pe(V);if(!D.Ga.symlink)throw new Pe(63);D.Ga.symlink(D,b,y)}function ft(y){var b=Sn(y,{parent:!0}).node;y=He(y);var D=Ir(b,y),V=ur(b,y,!0);if(V)throw new Pe(V);if(!b.Ga.rmdir)throw new Pe(63);if(D.Va)throw new Pe(10);b.Ga.rmdir(b,y),Ja(D)}function sn(y){var b=Sn(y,{parent:!0}).node;if(!b)throw new Pe(44);y=He(y);var D=Ir(b,y),V=ur(b,y,!1);if(V)throw new Pe(V);if(!b.Ga.unlink)throw new Pe(63);if(D.Va)throw new Pe(10);b.Ga.unlink(b,y),Ja(D)}function nn(y){if(y=Sn(y).node,!y)throw new Pe(44);if(!y.Ga.readlink)throw new Pe(28);return nt(yr(y.parent),y.Ga.readlink(y))}function kt(y,b){if(y=Sn(y,{Sa:!b}).node,!y)throw new Pe(44);if(!y.Ga.Pa)throw new Pe(63);return y.Ga.Pa(y)}function kn(y){return kt(y,!0)}function vr(y,b){if(y=typeof y=="string"?Sn(y,{Sa:!0}).node:y,!y.Ga.Oa)throw new Pe(63);y.Ga.Oa(y,{mode:b&4095|y.mode&-4096,timestamp:Date.now()})}function on(y,b){if(0>b)throw new Pe(28);if(y=typeof y=="string"?Sn(y,{Sa:!0}).node:y,!y.Ga.Oa)throw new Pe(63);if(An(y.mode))throw new Pe(31);if((y.mode&61440)!==32768)throw new Pe(28);var D=Rr(y,"w");if(D)throw new Pe(D);y.Ga.Oa(y,{size:b,timestamp:Date.now()})}function Zn(y,b,D){if(y==="")throw new Pe(44);if(typeof b=="string"){var V={r:0,"r+":2,w:577,"w+":578,a:1089,"a+":1090}[b];if(typeof V>"u")throw Error(`Unknown file open mode: ${b}`);b=V}if(D=b&64?(typeof D>"u"?438:D)&4095|32768:0,typeof y=="object")var W=y;else{y=pe(y);try{W=Sn(y,{Sa:!(b&131072)}).node}catch{}}if(V=!1,b&64)if(W){if(b&128)throw new Pe(20)}else W=Xe(y,D,0),V=!0;if(!W)throw new Pe(44);if((W.mode&61440)===8192&&(b&=-513),b&65536&&!An(W.mode))throw new Pe(54);if(!V&&(D=W?(W.mode&61440)===40960?32:An(W.mode)&&(Sa(b)!=="r"||b&512)?31:Rr(W,Sa(b)):44))throw new Pe(D);return b&512&&!V&&on(W,0),b&=-131713,W=Mr({node:W,path:yr(W),flags:b,seekable:!0,position:0,Ha:W.Ha,Fb:[],error:!1}),W.Ha.open&&W.Ha.open(W),!f.logReadFiles||b&1||(mi||(mi={}),y in mi||(mi[y]=1)),W}function es(y){if(y.fd===null)throw new Pe(8);y.hb&&(y.hb=null);try{y.Ha.close&&y.Ha.close(y)}catch(b){throw b}finally{tn[y.fd]=null}y.fd=null}function fo(y,b,D){if(y.fd===null)throw new Pe(8);if(!y.seekable||!y.Ha.Ta)throw new Pe(70);if(D!=0&&D!=1&&D!=2)throw new Pe(28);y.position=y.Ha.Ta(y,b,D),y.Fb=[]}function ho(y,b,D,V,W){if(0>V||0>W)throw new Pe(28);if(y.fd===null)throw new Pe(8);if((y.flags&2097155)===1)throw new Pe(8);if(An(y.node.mode))throw new Pe(31);if(!y.Ha.read)throw new Pe(28);var Te=typeof W<"u";if(!Te)W=y.position;else if(!y.seekable)throw new Pe(70);return b=y.Ha.read(y,b,D,V,W),Te||(y.position+=b),b}function Ul(y,b,D,V,W){if(0>V||0>W)throw new Pe(28);if(y.fd===null)throw new Pe(8);if((y.flags&2097155)===0)throw new Pe(8);if(An(y.node.mode))throw new Pe(31);if(!y.Ha.write)throw new Pe(28);y.seekable&&y.flags&1024&&fo(y,0,2);var Te=typeof W<"u";if(!Te)W=y.position;else if(!y.seekable)throw new Pe(70);return b=y.Ha.write(y,b,D,V,W,void 0),Te||(y.position+=b),b}function hi(y){var b,D=Zn(y,D||0);y=kt(y).size;var V=new Uint8Array(y);return ho(D,V,0,y,0),b=V,es(D),b}function zs(){Pe||(Pe=function(y,b){this.name="ErrnoError",this.node=b,this.Eb=function(D){this.Ka=D},this.Eb(y),this.message="FS error"},Pe.prototype=Error(),Pe.prototype.constructor=Pe,[44].forEach(y=>{_a[y]=new Pe(y),_a[y].stack="<generic error, no stack>"}))}var Ur;function Un(y,b,D){y=pe("/dev/"+y);var V=Jr(!!b,!!D);mo||(mo=64);var W=mo++<<8|0;Wa(W,{open(Te){Te.seekable=!1},close(){var Te;(Te=D==null?void 0:D.buffer)!=null&&Te.length&&D(10)},read(Te,Re,ot,Ut){for(var yt=0,dn=0;dn<Ut;dn++){try{var fn=b()}catch{throw new Pe(29)}if(fn===void 0&&yt===0)throw new Pe(6);if(fn==null)break;yt++,Re[ot+dn]=fn}return yt&&(Te.node.timestamp=Date.now()),yt},write(Te,Re,ot,Ut){for(var yt=0;yt<Ut;yt++)try{D(Re[ot+yt])}catch{throw new Pe(29)}return Ut&&(Te.node.timestamp=Date.now()),yt}}),Be(y,V,W)}var mo,Wt={},wa,mi;function Lr(y,b,D){if(b.charAt(0)==="/")return b;if(y=y===-100?"/":Bt(y).path,b.length==0){if(!D)throw new Pe(44);return y}return pe(y+"/"+b)}function pi(y,b,D){try{var V=y(b)}catch(Te){if(Te&&Te.node&&pe(b)!==pe(yr(Te.node)))return-54;throw Te}J[D>>2]=V.dev,J[D+4>>2]=V.mode,N[D+8>>2]=V.nlink,J[D+12>>2]=V.uid,J[D+16>>2]=V.gid,J[D+20>>2]=V.rdev,E=[V.size>>>0,(ne=V.size,1<=+Math.abs(ne)?0<ne?+Math.floor(ne/4294967296)>>>0:~~+Math.ceil((ne-+(~~ne>>>0))/4294967296)>>>0:0)],J[D+24>>2]=E[0],J[D+28>>2]=E[1],J[D+32>>2]=4096,J[D+36>>2]=V.blocks,y=V.atime.getTime(),b=V.mtime.getTime();var W=V.ctime.getTime();return E=[Math.floor(y/1e3)>>>0,(ne=Math.floor(y/1e3),1<=+Math.abs(ne)?0<ne?+Math.floor(ne/4294967296)>>>0:~~+Math.ceil((ne-+(~~ne>>>0))/4294967296)>>>0:0)],J[D+40>>2]=E[0],J[D+44>>2]=E[1],N[D+48>>2]=y%1e3*1e3,E=[Math.floor(b/1e3)>>>0,(ne=Math.floor(b/1e3),1<=+Math.abs(ne)?0<ne?+Math.floor(ne/4294967296)>>>0:~~+Math.ceil((ne-+(~~ne>>>0))/4294967296)>>>0:0)],J[D+56>>2]=E[0],J[D+60>>2]=E[1],N[D+64>>2]=b%1e3*1e3,E=[Math.floor(W/1e3)>>>0,(ne=Math.floor(W/1e3),1<=+Math.abs(ne)?0<ne?+Math.floor(ne/4294967296)>>>0:~~+Math.ceil((ne-+(~~ne>>>0))/4294967296)>>>0:0)],J[D+72>>2]=E[0],J[D+76>>2]=E[1],N[D+80>>2]=W%1e3*1e3,E=[V.ino>>>0,(ne=V.ino,1<=+Math.abs(ne)?0<ne?+Math.floor(ne/4294967296)>>>0:~~+Math.ceil((ne-+(~~ne>>>0))/4294967296)>>>0:0)],J[D+88>>2]=E[0],J[D+92>>2]=E[1],0}var Bn=void 0;function ts(){var y=J[+Bn>>2];return Bn+=4,y}var ns=(y,b)=>b+2097152>>>0<4194305-!!y?(y>>>0)+4294967296*b:NaN,po=[0,31,60,91,121,152,182,213,244,274,305,335],rs=[0,31,59,90,120,151,181,212,243,273,304,334],go=y=>{var b=Ye(y)+1,D=Fs(b);return D&&St(y,ee,D,b),D},gi={},Ea=()=>{if(!yo){var y={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:(typeof navigator=="object"&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8",_:_||"./this.program"},b;for(b in gi)gi[b]===void 0?delete y[b]:y[b]=gi[b];var D=[];for(b in y)D.push(`${b}=${y[b]}`);yo=D}return yo},yo,yi=y=>{var b=Ye(y)+1,D=Hn(b);return St(y,ee,D,b),D},Ll=(y,b,D,V)=>{var W={string:yt=>{var dn=0;return yt!=null&&yt!==0&&(dn=yi(yt)),dn},array:yt=>{var dn=Hn(yt.length);return q.set(yt,dn),dn}};y=f["_"+y];var Te=[],Re=0;if(V)for(var ot=0;ot<V.length;ot++){var Ut=W[D[ot]];Ut?(Re===0&&(Re=ka()),Te[ot]=Ut(V[ot])):Te[ot]=V[ot]}return D=y.apply(null,Te),D=(function(yt){return Re!==0&&Xr(Re),b==="string"?yt?ie(ee,yt):"":b==="boolean"?!!yt:yt})(D)},as=0,vi=(y,b)=>(b=b==1?Hn(y.length):Fs(y.length),y.subarray||y.slice||(y=new Uint8Array(y)),ee.set(y,b),b),Ta,ss=[],In,ua=y=>{Ta.delete(In.get(y)),In.set(y,null),ss.push(y)},is=(y,b)=>{if(!Ta){Ta=new WeakMap;var D=In.length;if(Ta)for(var V=0;V<0+D;V++){var W=In.get(V);W&&Ta.set(W,V)}}if(D=Ta.get(y)||0)return D;if(ss.length)D=ss.pop();else{try{In.grow(1)}catch(ot){throw ot instanceof RangeError?"Unable to grow wasm table. Set ALLOW_TABLE_GROWTH.":ot}D=In.length-1}try{In.set(D,y)}catch(ot){if(!(ot instanceof TypeError))throw ot;if(typeof WebAssembly.Function=="function"){V=WebAssembly.Function,W={i:"i32",j:"i64",f:"f32",d:"f64",e:"externref",p:"i32"};for(var Te={parameters:[],results:b[0]=="v"?[]:[W[b[0]]]},Re=1;Re<b.length;++Re)Te.parameters.push(W[b[Re]]);b=new V(Te,y)}else{for(V=[1],W=b.slice(0,1),b=b.slice(1),Te={i:127,p:127,j:126,f:125,d:124,e:111},V.push(96),Re=b.length,128>Re?V.push(Re):V.push(Re%128|128,Re>>7),Re=0;Re<b.length;++Re)V.push(Te[b[Re]]);W=="v"?V.push(0):V.push(1,Te[W]),b=[0,97,115,109,1,0,0,0,1],W=V.length,128>W?b.push(W):b.push(W%128|128,W>>7),b.push.apply(b,V),b.push(2,7,1,1,101,1,102,0,0,7,5,1,1,102,0,0),b=new WebAssembly.Module(new Uint8Array(b)),b=new WebAssembly.Instance(b,{e:{f:y}}).exports.f}In.set(D,b)}return Ta.set(y,D),D};function Aa(y,b,D,V){y||(y=this),this.parent=y,this.Ra=y.Ra,this.Va=null,this.id=vn++,this.name=b,this.mode=D,this.Ga={},this.Ha={},this.rdev=V}Object.defineProperties(Aa.prototype,{read:{get:function(){return(this.mode&365)===365},set:function(y){y?this.mode|=365:this.mode&=-366}},write:{get:function(){return(this.mode&146)===146},set:function(y){y?this.mode|=146:this.mode&=-147}}}),zs(),gt=Array(4096),fi(ut,"/"),fe("/tmp"),fe("/home"),fe("/home/web_user"),(function(){fe("/dev"),Wa(259,{read:()=>0,write:(V,W,Te,Re)=>Re}),Be("/dev/null",259),mt(1280,un),mt(1536,Mt),Be("/dev/tty",1280),Be("/dev/tty1",1536);var y=new Uint8Array(1024),b=0,D=()=>(b===0&&(b=qe(y).byteLength),y[--b]);Un("random",D),Un("urandom",D),fe("/dev/shm"),fe("/dev/shm/tmp")})(),(function(){fe("/proc");var y=fe("/proc/self");fe("/proc/self/fd"),fi({Ra(){var b=Fn(y,"fd",16895,73);return b.Ga={lookup(D,V){var W=Bt(+V);return D={parent:null,Ra:{tb:"fake"},Ga:{readlink:()=>W.path}},D.parent=D}},b}},"/proc/self/fd")})();var os={a:(y,b,D,V)=>{ae(`Assertion failed: ${y?ie(ee,y):""}, at: `+[b?b?ie(ee,b):"":"unknown filename",D,V?V?ie(ee,V):"":"unknown function"])},h:function(y,b){try{return y=y?ie(ee,y):"",vr(y,b),0}catch(D){if(typeof Wt>"u"||D.name!=="ErrnoError")throw D;return-D.Ka}},H:function(y,b,D){try{if(b=b?ie(ee,b):"",b=Lr(y,b),D&-8)return-28;var V=Sn(b,{Sa:!0}).node;return V?(y="",D&4&&(y+="r"),D&2&&(y+="w"),D&1&&(y+="x"),y&&Rr(V,y)?-2:0):-44}catch(W){if(typeof Wt>"u"||W.name!=="ErrnoError")throw W;return-W.Ka}},i:function(y,b){try{var D=Bt(y);return vr(D.node,b),0}catch(V){if(typeof Wt>"u"||V.name!=="ErrnoError")throw V;return-V.Ka}},g:function(y){try{var b=Bt(y).node,D=typeof b=="string"?Sn(b,{Sa:!0}).node:b;if(!D.Ga.Oa)throw new Pe(63);return D.Ga.Oa(D,{timestamp:Date.now()}),0}catch(V){if(typeof Wt>"u"||V.name!=="ErrnoError")throw V;return-V.Ka}},b:function(y,b,D){Bn=D;try{var V=Bt(y);switch(b){case 0:var W=ts();if(0>W)return-28;for(;tn[W];)W++;return Mr(V,W).fd;case 1:case 2:return 0;case 3:return V.flags;case 4:return W=ts(),V.flags|=W,0;case 5:return W=ts(),M[W+0>>1]=2,0;case 6:case 7:return 0;case 16:case 8:return-28;case 9:return J[bi()>>2]=28,-1;default:return-28}}catch(Te){if(typeof Wt>"u"||Te.name!=="ErrnoError")throw Te;return-Te.Ka}},f:function(y,b){try{var D=Bt(y);return pi(kt,D.path,b)}catch(V){if(typeof Wt>"u"||V.name!=="ErrnoError")throw V;return-V.Ka}},n:function(y,b,D){b=ns(b,D);try{if(isNaN(b))return 61;var V=Bt(y);if((V.flags&2097155)===0)throw new Pe(28);return on(V.node,b),0}catch(W){if(typeof Wt>"u"||W.name!=="ErrnoError")throw W;return-W.Ka}},C:function(y,b){try{if(b===0)return-28;var D=Ye("/")+1;return b<D?-68:(St("/",ee,y,b),D)}catch(V){if(typeof Wt>"u"||V.name!=="ErrnoError")throw V;return-V.Ka}},F:function(y,b){try{return y=y?ie(ee,y):"",pi(kn,y,b)}catch(D){if(typeof Wt>"u"||D.name!=="ErrnoError")throw D;return-D.Ka}},z:function(y,b,D){try{return b=b?ie(ee,b):"",b=Lr(y,b),b=pe(b),b[b.length-1]==="/"&&(b=b.substr(0,b.length-1)),fe(b,D),0}catch(V){if(typeof Wt>"u"||V.name!=="ErrnoError")throw V;return-V.Ka}},E:function(y,b,D,V){try{b=b?ie(ee,b):"";var W=V&256;return b=Lr(y,b,V&4096),pi(W?kn:kt,b,D)}catch(Te){if(typeof Wt>"u"||Te.name!=="ErrnoError")throw Te;return-Te.Ka}},y:function(y,b,D,V){Bn=V;try{b=b?ie(ee,b):"",b=Lr(y,b);var W=V?ts():0;return Zn(b,D,W).fd}catch(Te){if(typeof Wt>"u"||Te.name!=="ErrnoError")throw Te;return-Te.Ka}},w:function(y,b,D,V){try{if(b=b?ie(ee,b):"",b=Lr(y,b),0>=V)return-28;var W=nn(b),Te=Math.min(V,Ye(W)),Re=q[D+Te];return St(W,ee,D,V+1),q[D+Te]=Re,Te}catch(ot){if(typeof Wt>"u"||ot.name!=="ErrnoError")throw ot;return-ot.Ka}},v:function(y){try{return y=y?ie(ee,y):"",ft(y),0}catch(b){if(typeof Wt>"u"||b.name!=="ErrnoError")throw b;return-b.Ka}},G:function(y,b){try{return y=y?ie(ee,y):"",pi(kt,y,b)}catch(D){if(typeof Wt>"u"||D.name!=="ErrnoError")throw D;return-D.Ka}},r:function(y,b,D){try{return b=b?ie(ee,b):"",b=Lr(y,b),D===0?sn(b):D===512?ft(b):ae("Invalid flags passed to unlinkat"),0}catch(V){if(typeof Wt>"u"||V.name!=="ErrnoError")throw V;return-V.Ka}},q:function(y,b,D){try{if(b=b?ie(ee,b):"",b=Lr(y,b,!0),D){var V=N[D>>2]+4294967296*J[D+4>>2],W=J[D+8>>2];Te=1e3*V+W/1e6,D+=16,V=N[D>>2]+4294967296*J[D+4>>2],W=J[D+8>>2],Re=1e3*V+W/1e6}else var Te=Date.now(),Re=Te;y=Te;var ot=Sn(b,{Sa:!0}).node;return ot.Ga.Oa(ot,{timestamp:Math.max(y,Re)}),0}catch(Ut){if(typeof Wt>"u"||Ut.name!=="ErrnoError")throw Ut;return-Ut.Ka}},l:function(y,b,D){y=new Date(1e3*ns(y,b)),J[D>>2]=y.getSeconds(),J[D+4>>2]=y.getMinutes(),J[D+8>>2]=y.getHours(),J[D+12>>2]=y.getDate(),J[D+16>>2]=y.getMonth(),J[D+20>>2]=y.getFullYear()-1900,J[D+24>>2]=y.getDay(),b=y.getFullYear(),J[D+28>>2]=(b%4!==0||b%100===0&&b%400!==0?rs:po)[y.getMonth()]+y.getDate()-1|0,J[D+36>>2]=-(60*y.getTimezoneOffset()),b=new Date(y.getFullYear(),6,1).getTimezoneOffset();var V=new Date(y.getFullYear(),0,1).getTimezoneOffset();J[D+32>>2]=(b!=V&&y.getTimezoneOffset()==Math.min(V,b))|0},j:function(y,b,D,V,W,Te,Re,ot){W=ns(W,Te);try{if(isNaN(W))return 61;var Ut=Bt(V);if((b&2)!==0&&(D&2)===0&&(Ut.flags&2097155)!==2)throw new Pe(2);if((Ut.flags&2097155)===1)throw new Pe(2);if(!Ut.Ha.bb)throw new Pe(43);var yt=Ut.Ha.bb(Ut,y,W,b,D),dn=yt.Db;return J[Re>>2]=yt.ub,N[ot>>2]=dn,0}catch(fn){if(typeof Wt>"u"||fn.name!=="ErrnoError")throw fn;return-fn.Ka}},k:function(y,b,D,V,W,Te,Re){Te=ns(Te,Re);try{if(isNaN(Te))return 61;var ot=Bt(W);if(D&2){if((ot.node.mode&61440)!==32768)throw new Pe(43);if(!(V&2)){var Ut=ee.slice(y,y+b);ot.Ha.cb&&ot.Ha.cb(ot,Ut,Te,b,V)}}}catch(yt){if(typeof Wt>"u"||yt.name!=="ErrnoError")throw yt;return-yt.Ka}},s:(y,b,D)=>{function V(Ut){return(Ut=Ut.toTimeString().match(/\(([A-Za-z ]+)\)$/))?Ut[1]:"GMT"}var W=new Date().getFullYear(),Te=new Date(W,0,1),Re=new Date(W,6,1);W=Te.getTimezoneOffset();var ot=Re.getTimezoneOffset();N[y>>2]=60*Math.max(W,ot),J[b>>2]=+(W!=ot),y=V(Te),b=V(Re),y=go(y),b=go(b),ot<W?(N[D>>2]=y,N[D+4>>2]=b):(N[D>>2]=b,N[D+4>>2]=y)},d:()=>Date.now(),t:()=>2147483648,c:()=>performance.now(),o:y=>{var b=ee.length;if(y>>>=0,2147483648<y)return!1;for(var D=1;4>=D;D*=2){var V=b*(1+.2/D);V=Math.min(V,y+100663296);var W=Math;V=Math.max(y,V);e:{W=(W.min.call(W,2147483648,V+(65536-V%65536)%65536)-j.buffer.byteLength+65535)/65536;try{j.grow(W),P();var Te=1;break e}catch{}Te=void 0}if(Te)return!0}return!1},A:(y,b)=>{var D=0;return Ea().forEach((V,W)=>{var Te=b+D;for(W=N[y+4*W>>2]=Te,Te=0;Te<V.length;++Te)q[W++>>0]=V.charCodeAt(Te);q[W>>0]=0,D+=V.length+1}),0},B:(y,b)=>{var D=Ea();N[y>>2]=D.length;var V=0;return D.forEach(W=>V+=W.length+1),N[b>>2]=V,0},e:function(y){try{var b=Bt(y);return es(b),0}catch(D){if(typeof Wt>"u"||D.name!=="ErrnoError")throw D;return D.Ka}},p:function(y,b){try{var D=Bt(y);return q[b>>0]=D.tty?2:An(D.mode)?3:(D.mode&61440)===40960?7:4,M[b+2>>1]=0,E=[0,(ne=0,1<=+Math.abs(ne)?0<ne?+Math.floor(ne/4294967296)>>>0:~~+Math.ceil((ne-+(~~ne>>>0))/4294967296)>>>0:0)],J[b+8>>2]=E[0],J[b+12>>2]=E[1],E=[0,(ne=0,1<=+Math.abs(ne)?0<ne?+Math.floor(ne/4294967296)>>>0:~~+Math.ceil((ne-+(~~ne>>>0))/4294967296)>>>0:0)],J[b+16>>2]=E[0],J[b+20>>2]=E[1],0}catch(V){if(typeof Wt>"u"||V.name!=="ErrnoError")throw V;return V.Ka}},x:function(y,b,D,V){try{e:{var W=Bt(y);y=b;for(var Te,Re=b=0;Re<D;Re++){var ot=N[y>>2],Ut=N[y+4>>2];y+=8;var yt=ho(W,q,ot,Ut,Te);if(0>yt){var dn=-1;break e}if(b+=yt,yt<Ut)break;typeof Te<"u"&&(Te+=yt)}dn=b}return N[V>>2]=dn,0}catch(fn){if(typeof Wt>"u"||fn.name!=="ErrnoError")throw fn;return fn.Ka}},m:function(y,b,D,V,W){b=ns(b,D);try{if(isNaN(b))return 61;var Te=Bt(y);return fo(Te,b,V),E=[Te.position>>>0,(ne=Te.position,1<=+Math.abs(ne)?0<ne?+Math.floor(ne/4294967296)>>>0:~~+Math.ceil((ne-+(~~ne>>>0))/4294967296)>>>0:0)],J[W>>2]=E[0],J[W+4>>2]=E[1],Te.hb&&b===0&&V===0&&(Te.hb=null),0}catch(Re){if(typeof Wt>"u"||Re.name!=="ErrnoError")throw Re;return Re.Ka}},D:function(y){var D;try{var b=Bt(y);return(D=b.Ha)!=null&&D.fsync?b.Ha.fsync(b):0}catch(V){if(typeof Wt>"u"||V.name!=="ErrnoError")throw V;return V.Ka}},u:function(y,b,D,V){try{e:{var W=Bt(y);y=b;for(var Te,Re=b=0;Re<D;Re++){var ot=N[y>>2],Ut=N[y+4>>2];y+=8;var yt=Ul(W,q,ot,Ut,Te);if(0>yt){var dn=-1;break e}b+=yt,typeof Te<"u"&&(Te+=yt)}dn=b}return N[V>>2]=dn,0}catch(fn){if(typeof Wt>"u"||fn.name!=="ErrnoError")throw fn;return fn.Ka}}},at=(function(){var D;function y(V){var W;return at=V.exports,j=at.I,P(),In=at.Aa,ce.unshift(at.J),I--,(W=f.monitorRunDependencies)==null||W.call(f,I),I==0&&te&&(V=te,te=null,V()),at}var b={a:os};if(I++,(D=f.monitorRunDependencies)==null||D.call(f,I),f.instantiateWasm)try{return f.instantiateWasm(b,y)}catch(V){return Q(`Module.instantiateWasm callback failed with error: ${V}`),!1}return Se(b,function(V){y(V.instance)}),{}})();f._sqlite3_free=y=>(f._sqlite3_free=at.K)(y),f._sqlite3_value_text=y=>(f._sqlite3_value_text=at.L)(y);var bi=()=>(bi=at.M)();f._sqlite3_prepare_v2=(y,b,D,V,W)=>(f._sqlite3_prepare_v2=at.N)(y,b,D,V,W),f._sqlite3_step=y=>(f._sqlite3_step=at.O)(y),f._sqlite3_reset=y=>(f._sqlite3_reset=at.P)(y),f._sqlite3_exec=(y,b,D,V,W)=>(f._sqlite3_exec=at.Q)(y,b,D,V,W),f._sqlite3_finalize=y=>(f._sqlite3_finalize=at.R)(y),f._sqlite3_column_name=(y,b)=>(f._sqlite3_column_name=at.S)(y,b),f._sqlite3_column_text=(y,b)=>(f._sqlite3_column_text=at.T)(y,b),f._sqlite3_column_type=(y,b)=>(f._sqlite3_column_type=at.U)(y,b),f._sqlite3_errmsg=y=>(f._sqlite3_errmsg=at.V)(y),f._sqlite3_clear_bindings=y=>(f._sqlite3_clear_bindings=at.W)(y),f._sqlite3_value_blob=y=>(f._sqlite3_value_blob=at.X)(y),f._sqlite3_value_bytes=y=>(f._sqlite3_value_bytes=at.Y)(y),f._sqlite3_value_double=y=>(f._sqlite3_value_double=at.Z)(y),f._sqlite3_value_int=y=>(f._sqlite3_value_int=at._)(y),f._sqlite3_value_type=y=>(f._sqlite3_value_type=at.$)(y),f._sqlite3_result_blob=(y,b,D,V)=>(f._sqlite3_result_blob=at.aa)(y,b,D,V),f._sqlite3_result_double=(y,b)=>(f._sqlite3_result_double=at.ba)(y,b),f._sqlite3_result_error=(y,b,D)=>(f._sqlite3_result_error=at.ca)(y,b,D),f._sqlite3_result_int=(y,b)=>(f._sqlite3_result_int=at.da)(y,b),f._sqlite3_result_int64=(y,b,D)=>(f._sqlite3_result_int64=at.ea)(y,b,D),f._sqlite3_result_null=y=>(f._sqlite3_result_null=at.fa)(y),f._sqlite3_result_text=(y,b,D,V)=>(f._sqlite3_result_text=at.ga)(y,b,D,V),f._sqlite3_aggregate_context=(y,b)=>(f._sqlite3_aggregate_context=at.ha)(y,b),f._sqlite3_column_count=y=>(f._sqlite3_column_count=at.ia)(y),f._sqlite3_data_count=y=>(f._sqlite3_data_count=at.ja)(y),f._sqlite3_column_blob=(y,b)=>(f._sqlite3_column_blob=at.ka)(y,b),f._sqlite3_column_bytes=(y,b)=>(f._sqlite3_column_bytes=at.la)(y,b),f._sqlite3_column_double=(y,b)=>(f._sqlite3_column_double=at.ma)(y,b),f._sqlite3_bind_blob=(y,b,D,V,W)=>(f._sqlite3_bind_blob=at.na)(y,b,D,V,W),f._sqlite3_bind_double=(y,b,D)=>(f._sqlite3_bind_double=at.oa)(y,b,D),f._sqlite3_bind_int=(y,b,D)=>(f._sqlite3_bind_int=at.pa)(y,b,D),f._sqlite3_bind_text=(y,b,D,V,W)=>(f._sqlite3_bind_text=at.qa)(y,b,D,V,W),f._sqlite3_bind_parameter_index=(y,b)=>(f._sqlite3_bind_parameter_index=at.ra)(y,b),f._sqlite3_sql=y=>(f._sqlite3_sql=at.sa)(y),f._sqlite3_normalized_sql=y=>(f._sqlite3_normalized_sql=at.ta)(y),f._sqlite3_changes=y=>(f._sqlite3_changes=at.ua)(y),f._sqlite3_close_v2=y=>(f._sqlite3_close_v2=at.va)(y),f._sqlite3_create_function_v2=(y,b,D,V,W,Te,Re,ot,Ut)=>(f._sqlite3_create_function_v2=at.wa)(y,b,D,V,W,Te,Re,ot,Ut),f._sqlite3_open=(y,b)=>(f._sqlite3_open=at.xa)(y,b);var Fs=f._malloc=y=>(Fs=f._malloc=at.ya)(y),da=f._free=y=>(da=f._free=at.za)(y);f._RegisterExtensionFunctions=y=>(f._RegisterExtensionFunctions=at.Ba)(y);var zr=(y,b)=>(zr=at.Ca)(y,b),ka=()=>(ka=at.Da)(),Xr=y=>(Xr=at.Ea)(y),Hn=y=>(Hn=at.Fa)(y);f.stackAlloc=Hn,f.stackSave=ka,f.stackRestore=Xr,f.cwrap=(y,b,D,V)=>{var W=!D||D.every(Te=>Te==="number"||Te==="boolean");return b!=="string"&&W&&!V?f["_"+y]:function(){return Ll(y,b,D,arguments)}},f.addFunction=is,f.removeFunction=ua,f.UTF8ToString=ke,f.ALLOC_NORMAL=as,f.allocate=vi,f.allocateUTF8OnStack=yi;var ls;te=function y(){ls||Bs(),ls||(te=y)};function Bs(){function y(){if(!ls&&(ls=!0,f.calledRun=!0,!O)){if(f.noFSInit||Ur||(Ur=!0,zs(),f.stdin=f.stdin,f.stdout=f.stdout,f.stderr=f.stderr,f.stdin?Un("stdin",f.stdin):Ke("/dev/tty","/dev/stdin"),f.stdout?Un("stdout",null,f.stdout):Ke("/dev/tty","/dev/stdout"),f.stderr?Un("stderr",null,f.stderr):Ke("/dev/tty1","/dev/stderr"),Zn("/dev/stdin",0),Zn("/dev/stdout",1),Zn("/dev/stderr",1)),pn=!1,me(ce),f.onRuntimeInitialized&&f.onRuntimeInitialized(),f.postRun)for(typeof f.postRun=="function"&&(f.postRun=[f.postRun]);f.postRun.length;){var b=f.postRun.shift();Ee.unshift(b)}me(Ee)}}if(!(0<I)){if(f.preRun)for(typeof f.preRun=="function"&&(f.preRun=[f.preRun]);f.preRun.length;)z();me(ve),0<I||(f.setStatus?(f.setStatus("Running..."),setTimeout(function(){setTimeout(function(){f.setStatus("")},1),y()},1)):y())}}if(f.preInit)for(typeof f.preInit=="function"&&(f.preInit=[f.preInit]);0<f.preInit.length;)f.preInit.pop()();return Bs(),m}),s)};n.exports=i,n.exports.default=i})(xh)),xh.exports}var zT=LT();const FT=co(zT);function BT(n){return new Promise((a,s)=>{const i=new Worker(new URL("/CogniFlow/assets/ankiImport.worker-DXXYc2v4.js",import.meta.url),{type:"module"});i.onmessage=l=>{const{status:c,decks:d,error:m}=l.data;c==="success"?a(d):s(new Error(m)),i.terminate()},i.onerror=l=>{console.error("Worker error:",l);const c=l.message||"The worker script could not be loaded or an unexpected error occurred.";s(new Error(`Anki import worker failed: ${c}`)),i.terminate()},i.postMessage(n,[n])})}let Sh=null;async function HT(){return Sh||(Sh=await FT({locateFile:n=>`https://esm.sh/sql.js@1.10.3/dist/${n}`})),Sh}function pb(n,a){let s=n;return s=s.replace(/<img\s[^>]*?src=(["'])(.*?)\1[^>]*?>/gi,(i,l,c)=>{const d=decodeURIComponent(c),m=a.get(d);if(m){const p=btoa(new Uint8Array(m.data).reduce((v,_)=>v+String.fromCharCode(_),"")),f=`src="data:${m.type};base64,${p}"`;return i.replace(/src=(["']).*?\1/i,f)}return i}),s=s.replace(/\[sound:(.*?)\]/g,(i,l)=>{const c=decodeURIComponent(l.trim()),d=a.get(c);if(d){const m=btoa(new Uint8Array(d.data).reduce((p,f)=>p+String.fromCharCode(f),""));return d.type.startsWith("video/")?`<video controls playsinline src="data:${d.type};base64,${m}"></video>`:`<audio controls src="data:${d.type};base64,${m}"></audio>`}return""}),s}function gb(n,a,s,i,l){let c=n;const d=/{{c(\d+)::(.*?)(?:::(.*?))?}}/gs;c=c.replace(d,(v,_,T,x)=>{const k=parseInt(_,10);return i?k===s+1?`<span class="cloze">[${x||"..."}]</span>`:`<span class="cloze-inactive">${T}</span>`:k===s+1?`<span class="cloze"><b>${T}</b></span>`:`<span class="cloze-inactive">${T}</span>`}),l&&(c=c.replace(/<hr id=answer>/g,"").replace(/{{FrontSide}}/g,l));const m=/{{#([^}]+?)}}(.*?){{\/\1}}/gs;let p;do p=c,c=c.replace(m,(v,_,T)=>{const x=a.get(_.trim());return x&&x.trim()!==""?T:""});while(c!==p);const f=/{{\^([^}]+?)}}(.*?){{\/\1}}/gs;do p=c,c=c.replace(f,(v,_,T)=>{const x=a.get(_.trim());return!x||x.trim()===""?T:""});while(c!==p);return a.forEach((v,_)=>{const T=new RegExp(`{{${_}}}`,"g");c=c.replace(T,v)}),c=c.replace(/{{(.*?)}}/g,""),c}async function GT(n){var F;const a=await HT(),s=await Yh.loadAsync(n),i=s.file(/collection.anki2[1]?/);if(!i||i.length===0)throw new Error("collection.anki2 or .anki21 file not found.");const l=await i[0].async("uint8array"),c=new a.Database(l),d=s.file("media");let m={};if(d)try{m=JSON.parse(await d.async("string"))}catch(G){console.warn("Could not parse media file.",G)}const p=new Map;for(const G in m){const Q=m[G],U=s.file(G);if(U){const j=await U.async("uint8array"),O=((F=Q.split(".").pop())==null?void 0:F.toLowerCase())||"";let q="application/octet-stream";["jpg","jpeg"].includes(O)?q="image/jpeg":O==="png"?q="image/png":O==="gif"?q="image/gif":O==="svg"?q="image/svg+xml":O==="mp3"?q="audio/mpeg":O==="ogg"?q="audio/ogg":O==="wav"?q="audio/wav":O==="m4a"?q="audio/mp4":O==="opus"?q="audio/opus":O==="mp4"?q="video/mp4":O==="webm"?q="video/webm":O==="ogv"&&(q="video/ogg"),p.set(Q,{data:j,type:q})}}const f=c.exec("SELECT models, decks, crt FROM col");if(!f[0])throw new Error("Could not read collection data.");const[v,_,T]=f[0].values[0],x=JSON.parse(v),k=JSON.parse(_),w=c.exec("SELECT id, mid, flds FROM notes"),S=new Map(w[0].values.map(G=>[G[0],{mid:G[1],flds:G[2].split("")}])),R=c.exec("SELECT id, nid, did, ord, due, ivl, factor, type, lapses FROM cards")[0].values,L=new Map;for(const G in k){const Q=k[G];L.set(G,{id:crypto.randomUUID(),name:Q.name,description:Q.desc||"Imported Anki deck.",type:je.Flashcard,cards:[]})}for(const G of R){const[Q,U,j,O,q,ee,M,J,N]=G,se=S.get(U);if(!se)continue;const K=x[se.mid];if(!(K!=null&&K.tmpls))continue;const P=L.get(j.toString());if(!P)continue;const ve=K.tmpls[O];if(!ve)continue;const ce=new Map((K.flds||[]).map(($,ue)=>[$.name,se.flds[ue]||""]));let Ee=gb(ve.qfmt,ce,O,!0),z=gb(ve.afmt,ce,O,!1,Ee);Ee=pb(Ee,p),z=pb(z,p);let I,te;J===2&&ee>0?(I=new Date(T*1e3),I.setDate(I.getDate()+q),te=new Date(I.getTime()),te.setDate(te.getDate()-ee)):(I=new Date,I.setHours(0,0,0,0));const ae=Math.min(1,Math.log1p(ee)/Math.log1p(90));P.cards.push({id:Q.toString(),front:Ee,back:z,css:K.css?`<style>${K.css}</style>`:"",dueDate:I.toISOString(),interval:ee,easeFactor:M?Math.max(M/1e3,Eh):Cr,masteryLevel:ae,lastReviewed:te==null?void 0:te.toISOString(),lapses:N||0})}return c.close(),Array.from(L.values()).filter(G=>G.cards.length>0)}const qT=n=>{const{dispatch:a}=Ze(),{openModal:s,closeModal:i}=Rl(),{addToast:l}=jn(),{navigate:c}=Ka(),d=_T({...n,addToast:l,openModal:s,closeModal:i,dispatch:a}),{triggerSync:m}=d,p=gT({triggerSync:m,openConfirmModal:S=>s("confirm",S)}),f=yT({triggerSync:m,handleAddDecks:p.handleAddDecks,handleUpdateDeck:p.handleUpdateDeck}),v=xT({...n,handleUpdateDeck:p.handleUpdateDeck}),_=jT({...n,openConfirmModal:S=>s("confirm",S),openRestoreFromDriveModal:()=>s("restoreFromDrive"),onRestoreData:d.onRestoreData}),T=RT({handleUpdateDeck:p.handleUpdateDeck,handleAddDecks:p.handleAddDecks,handleAddSeriesWithDecks:f.handleAddSeriesWithDecks,handleUpdateSeries:f.handleUpdateSeries,openConfirmModal:S=>s("confirm",S),openModal:s,closeModal:i}),x=B.useCallback(async(S,C={})=>{if(i(),!S)return;const{deckName:R,imageHint:L}=C;try{if(S.type==="series"){const{seriesName:F,seriesDescription:G,levels:Q}=S.data,U=[],j=(Q||[]).map(q=>{const ee=(q.decks||[]).map(M=>M.type==="quiz"?{id:crypto.randomUUID(),name:M.name,description:M.description,type:je.Quiz,questions:aa(M.questions||[])}:M.type==="flashcard"?{id:crypto.randomUUID(),name:M.name,description:M.description,type:je.Flashcard,cards:Ya(M.cards||[])}:null).filter(M=>M!==null);return U.push(...ee),{title:q.title,deckIds:ee.map(M=>M.id)}}),O={id:crypto.randomUUID(),type:"series",name:F,description:G,levels:j,archived:!1,createdAt:new Date().toISOString()};await f.handleAddSeriesWithDecks(O,U)}else if(S.type==="quiz"){const F={id:crypto.randomUUID(),name:R||S.data.name,description:S.data.description,type:je.Quiz,questions:aa(S.data.questions)};await p.handleAddDecks([F]),l(`Deck "${F.name}" imported successfully.`,"success")}else if(S.type==="learning"){const F={id:crypto.randomUUID(),name:R||S.data.name,description:S.data.description||"",type:je.Learning,infoCards:S.data.infoCards||[],questions:aa(S.data.questions||[]),learningMode:S.data.learningMode||"separate"};await p.handleAddDecks([F]),l(`Learning Deck "${F.name}" imported successfully.`,"success")}else if(S.type==="flashcard"){if(!R){l("Deck name is required for flashcard import.","error");return}const F=Ya(S.data),G={id:crypto.randomUUID(),name:R,type:je.Flashcard,cards:F,description:`${F.length} imported flashcard${F.length===1?"":"s"}.`};await p.handleAddDecks([G]),l(`Deck "${G.name}" imported successfully.`,"success")}else if(S.type==="anki"&&S.file){l("Processing Anki package...","info");const F=await S.file.arrayBuffer();let G=[];try{G=await BT(F)}catch(Q){console.warn("Anki worker failed, trying fallback:",Q);const U=await S.file.arrayBuffer();G=await GT(U)}G.length>0?(await p.handleAddDecks(G),l(`Successfully imported ${G.length} deck(s) from Anki package.`,"success")):l("No valid decks found in the Anki package.","error")}else if(S.type==="image"&&S.file){l("Analyzing image with AI...","info");const F=new FileReader;F.readAsDataURL(S.file),F.onload=async()=>{try{const G=F.result.split(",")[1],{name:Q,description:U,cards:j}=await s0(G,S.file.type,L),O={id:crypto.randomUUID(),name:Q||`Image Deck - ${S.file.name}`,description:U||`Generated from ${S.file.name}`,type:je.Flashcard,cards:Ya(j)};await p.handleAddDecks([O]),l(`Deck "${O.name}" generated successfully.`,"success")}catch(G){console.error(G),l(`Image generation failed: ${G.message}`,"error")}},F.onerror=()=>l("Failed to read image file.","error")}else S.type==="backup"&&S.data&&await d.onRestoreData(S.data)}catch(F){l(F.message,"error")}},[f,p,d,l,i]),k=B.useCallback(S=>{s("viewJson",{title:`View Deck JSON: ${S.name}`,data:S,filename:`deck-${S.id}.json`})},[s]),w=B.useCallback(S=>{const C=Object.values(Ze.getState().decks).filter(R=>S.levels.some(L=>L.deckIds.includes(R.id)));s("viewJson",{title:`View Series JSON: ${S.name}`,data:{series:S,decks:C},filename:`series-${S.id}.json`})},[s]);return B.useMemo(()=>({...n,...p,...f,...v,...d,..._,...T,handleViewDeckJson:k,handleViewSeriesJson:w,openModal:s,closeModal:i,handleDroppedFileConfirm:x,openConfirmModal:S=>s("confirm",S),addToast:l}),[n,p,f,v,d,_,T,k,w,s,i,x,l])},PT=({children:n})=>{const{path:a}=Ka(),{dispatch:s,decks:i,deckSeries:l}=Ze(),{addToast:c}=jn(),{openModal:d}=Rl(),{backupEnabled:m}=Za(),[p,f]=B.useState(!1),[v,_]=B.useState("Not synced"),[T,x]=B.useState(new Set),[k,w]=B.useState(null),[S,C]=B.useState("recent"),[R,L]=B.useState(null),[F,G]=B.useState(new Set),Q=P=>{G(ve=>{const ce=new Set(ve);return ce.has(P)?ce.delete(P):ce.add(P),ce})},[U,j]=B.useState(!1),[O,q]=B.useState(!1),[ee,M]=B.useState(null),J=B.useCallback(async()=>{try{const[P,ve,ce,Ee,z,I,te]=await Promise.all([rn.getAllDecks(),rn.getAllFolders(),rn.getAllDeckSeries(),rn.getAllSeriesProgress(),rn.getAllLearningProgress(),rn.getAIChatHistory(),rn.getAllSessionKeys()]),ae=new Map;Object.entries(Ee).forEach(([ue,de])=>{ae.set(ue,new Set(de))}),s({type:"LOAD_DATA",payload:{decks:P,folders:ve,deckSeries:ce}}),s({type:"SET_SERIES_PROGRESS",payload:ae}),s({type:"SET_LEARNING_PROGRESS",payload:z}),s({type:"SET_AI_CHAT_HISTORY",payload:I});const $=new Set;te.forEach(ue=>{ue.startsWith("session_deck_")&&$.add(ue.replace("session_deck_",""))}),x($)}catch(P){console.error("Critical error during data initialization:",P),c("Failed to load your data. Please check browser permissions and reload.","error")}},[s,c]);B.useEffect(()=>{J();const P=b1(()=>{console.log("Data changed in another tab, reloading..."),J()});return()=>{P()}},[J]),B.useEffect(()=>{const P=TT(j),ve=AT((ce,Ee)=>{q(ce),M(Ee||null)});return()=>{P(),ve()}},[]);const N=B.useMemo(()=>{const P=a.match(/^\/decks\/([^/?]+)/);return P?i[P[1]]:null},[a,i]),se=B.useMemo(()=>{const P=a.match(/^\/series\/([^/?]+)/);return P?l[P[1]]:null},[a,l]),K=qT({activeDeck:N,activeSeries:se,generalStudyDeck:k,setGeneralStudyDeck:w,sessionsToResume:T,setSessionsToResume:x,isSyncing:p,setIsSyncing:f,lastSyncStatus:v,setLastSyncStatus:_,backupEnabled:m,isGapiReady:U,isGapiSignedIn:O,gapiUser:ee,sortPreference:S,setSortPreference:C,draggedDeckId:R,setDraggedDeckId:L,openFolderIds:F,onToggleFolder:Q});return u.jsx(F_,{value:K,children:n})};function j0(n,a,s={}){const i=a instanceof Error;console.groupCollapsed(`%c[${n}] ${i?a.message:"An error occurred"}`,"color: red; font-weight: bold;"),console.error(a),Object.keys(s).length>0&&console.log("Additional Info:",s),i&&a.stack&&console.log("Stack Trace:",a.stack),console.groupEnd()}window.addEventListener("error",n=>{j0("Unhandled Global Error",n.error||n.message,{message:n.message,filename:n.filename,lineno:n.lineno,colno:n.colno})});window.addEventListener("unhandledrejection",n=>{j0("Unhandled Promise Rejection",n.reason)});const I0=document.getElementById("root");if(!I0)throw new Error("Could not find root element to mount to");const $T=y_.createRoot(I0);$T.render(u.jsx(ii.StrictMode,{children:u.jsx(lT,{children:u.jsx(a1,{children:u.jsx(P_,{children:u.jsx(G_,{children:u.jsx(cS,{children:u.jsx(PT,{children:u.jsx(oT,{children:u.jsx(iT,{})})})})})})})})}));export{o1 as A,$e as B,u1 as C,C0 as D,mn as E,Ka as F,Bh as G,dl as H,ze as I,YT as J,ZT as K,ra as L,Ya as M,aa as N,X1 as O,Fh as P,M_ as Q,kr as R,Zr as S,L_ as T,Rl as U,V1 as V,jn as a,QT as b,Mn as c,Ze as d,je as e,R1 as f,bT as g,z1 as h,uo as i,u as j,I1 as k,eA as l,JT as m,WT as n,nu as o,XT as p,ru as q,B as r,vl as s,so as t,Za as u,au as v,KT as w,ii as x,VT as y,Cr as z};
