const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/StudySession-BpQpXa7E.js","assets/MasteryBar-OxNLaxF2.js","assets/ProgressBar-uuvsF9ns.js","assets/useKeyboardShortcuts-DDqqjUc1.js","assets/ToggleSwitch-CgGySvEw.js","assets/ReaderSession-DXdg708e.js","assets/SettingsPage-0m772oxC.js","assets/DeckDetailsPage-BdNh9gVd.js","assets/TruncatedText-D8yP2_dh.js","assets/SeriesOverviewPage-yas4Bs5E.js","assets/DeckListItem-C6Bt4s9R.js","assets/DashboardPage-DHCED95_.js","assets/SeriesListItem-DN-q-9J5.js","assets/AllDecksPage-BueUKUNK.js","assets/DeckSortControl-CuzjDKvZ.js","assets/AllSeriesPage-CZIGJtCu.js"])))=>i.map(i=>d[i]);
(function(){const a=document.createElement("link").relList;if(a&&a.supports&&a.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))i(l);new MutationObserver(l=>{for(const c of l)if(c.type==="childList")for(const d of c.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&i(d)}).observe(document,{childList:!0,subtree:!0});function s(l){const c={};return l.integrity&&(c.integrity=l.integrity),l.referrerPolicy&&(c.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?c.credentials="include":l.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function i(l){if(l.ep)return;l.ep=!0;const c=s(l);fetch(l.href,c)}})();var Pc=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function io(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}function Wx(n){if(Object.prototype.hasOwnProperty.call(n,"__esModule"))return n;var a=n.default;if(typeof a=="function"){var s=function i(){return this instanceof i?Reflect.construct(a,arguments,this.constructor):a.apply(this,arguments)};s.prototype=a.prototype}else s={};return Object.defineProperty(s,"__esModule",{value:!0}),Object.keys(n).forEach(function(i){var l=Object.getOwnPropertyDescriptor(n,i);Object.defineProperty(s,i,l.get?l:{enumerable:!0,get:function(){return n[i]}})}),s}var qf={exports:{}},el={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var py;function e_(){if(py)return el;py=1;var n=Symbol.for("react.transitional.element"),a=Symbol.for("react.fragment");function s(i,l,c){var d=null;if(c!==void 0&&(d=""+c),l.key!==void 0&&(d=""+l.key),"key"in l){c={};for(var m in l)m!=="key"&&(c[m]=l[m])}else c=l;return l=c.ref,{$$typeof:n,type:i,key:d,ref:l!==void 0?l:null,props:c}}return el.Fragment=a,el.jsx=s,el.jsxs=s,el}var gy;function t_(){return gy||(gy=1,qf.exports=e_()),qf.exports}var u=t_(),Pf={exports:{}},pt={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var yy;function n_(){if(yy)return pt;yy=1;var n=Symbol.for("react.transitional.element"),a=Symbol.for("react.portal"),s=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),l=Symbol.for("react.profiler"),c=Symbol.for("react.consumer"),d=Symbol.for("react.context"),m=Symbol.for("react.forward_ref"),p=Symbol.for("react.suspense"),h=Symbol.for("react.memo"),v=Symbol.for("react.lazy"),S=Symbol.for("react.activity"),A=Symbol.iterator;function _(z){return z===null||typeof z!="object"?null:(z=A&&z[A]||z["@@iterator"],typeof z=="function"?z:null)}var E={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},w=Object.assign,k={};function N(z,R,re){this.props=z,this.context=R,this.refs=k,this.updater=re||E}N.prototype.isReactComponent={},N.prototype.setState=function(z,R){if(typeof z!="object"&&typeof z!="function"&&z!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,z,R,"setState")},N.prototype.forceUpdate=function(z){this.updater.enqueueForceUpdate(this,z,"forceUpdate")};function I(){}I.prototype=N.prototype;function M(z,R,re){this.props=z,this.context=R,this.refs=k,this.updater=re||E}var F=M.prototype=new I;F.constructor=M,w(F,N.prototype),F.isPureReactComponent=!0;var q=Array.isArray;function Q(){}var U={H:null,A:null,T:null,S:null},j=Object.prototype.hasOwnProperty;function O(z,R,re){var oe=re.ref;return{$$typeof:n,type:z,key:R,ref:oe!==void 0?oe:null,props:re}}function B(z,R){return O(z.type,R,z.props)}function te(z){return typeof z=="object"&&z!==null&&z.$$typeof===n}function L(z){var R={"=":"=0",":":"=2"};return"$"+z.replace(/[=:]/g,function(re){return R[re]})}var J=/\/+/g;function D(z,R){return typeof z=="object"&&z!==null&&z.key!=null?L(""+z.key):R.toString(36)}function ie(z){switch(z.status){case"fulfilled":return z.value;case"rejected":throw z.reason;default:switch(typeof z.status=="string"?z.then(Q,Q):(z.status="pending",z.then(function(R){z.status==="pending"&&(z.status="fulfilled",z.value=R)},function(R){z.status==="pending"&&(z.status="rejected",z.reason=R)})),z.status){case"fulfilled":return z.value;case"rejected":throw z.reason}}throw z}function Z(z,R,re,oe,he){var fe=typeof z;(fe==="undefined"||fe==="boolean")&&(z=null);var Me=!1;if(z===null)Me=!0;else switch(fe){case"bigint":case"string":case"number":Me=!0;break;case"object":switch(z.$$typeof){case n:case a:Me=!0;break;case v:return Me=z._init,Z(Me(z._payload),R,re,oe,he)}}if(Me)return he=he(z),Me=oe===""?"."+D(z,0):oe,q(he)?(re="",Me!=null&&(re=Me.replace(J,"$&/")+"/"),Z(he,R,re,"",function(Ve){return Ve})):he!=null&&(te(he)&&(he=B(he,re+(he.key==null||z&&z.key===he.key?"":(""+he.key).replace(J,"$&/")+"/")+Me)),R.push(he)),1;Me=0;var Fe=oe===""?".":oe+":";if(q(z))for(var Ce=0;Ce<z.length;Ce++)oe=z[Ce],fe=Fe+D(oe,Ce),Me+=Z(oe,R,re,fe,he);else if(Ce=_(z),typeof Ce=="function")for(z=Ce.call(z),Ce=0;!(oe=z.next()).done;)oe=oe.value,fe=Fe+D(oe,Ce++),Me+=Z(oe,R,re,fe,he);else if(fe==="object"){if(typeof z.then=="function")return Z(ie(z),R,re,oe,he);throw R=String(z),Error("Objects are not valid as a React child (found: "+(R==="[object Object]"?"object with keys {"+Object.keys(z).join(", ")+"}":R)+"). If you meant to render a collection of children, use an array instead.")}return Me}function Y(z,R,re){if(z==null)return z;var oe=[],he=0;return Z(z,oe,"","",function(fe){return R.call(re,fe,he++)}),oe}function me(z){if(z._status===-1){var R=z._result;R=R(),R.then(function(re){(z._status===0||z._status===-1)&&(z._status=1,z._result=re)},function(re){(z._status===0||z._status===-1)&&(z._status=2,z._result=re)}),z._status===-1&&(z._status=0,z._result=R)}if(z._status===1)return z._result.default;throw z._result}var W=typeof reportError=="function"?reportError:function(z){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var R=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof z=="object"&&z!==null&&typeof z.message=="string"?String(z.message):String(z),error:z});if(!window.dispatchEvent(R))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",z);return}console.error(z)},be={map:Y,forEach:function(z,R,re){Y(z,function(){R.apply(this,arguments)},re)},count:function(z){var R=0;return Y(z,function(){R++}),R},toArray:function(z){return Y(z,function(R){return R})||[]},only:function(z){if(!te(z))throw Error("React.Children.only expected to receive a single React element child.");return z}};return pt.Activity=S,pt.Children=be,pt.Component=N,pt.Fragment=s,pt.Profiler=l,pt.PureComponent=M,pt.StrictMode=i,pt.Suspense=p,pt.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=U,pt.__COMPILER_RUNTIME={__proto__:null,c:function(z){return U.H.useMemoCache(z)}},pt.cache=function(z){return function(){return z.apply(null,arguments)}},pt.cacheSignal=function(){return null},pt.cloneElement=function(z,R,re){if(z==null)throw Error("The argument must be a React element, but you passed "+z+".");var oe=w({},z.props),he=z.key;if(R!=null)for(fe in R.key!==void 0&&(he=""+R.key),R)!j.call(R,fe)||fe==="key"||fe==="__self"||fe==="__source"||fe==="ref"&&R.ref===void 0||(oe[fe]=R[fe]);var fe=arguments.length-2;if(fe===1)oe.children=re;else if(1<fe){for(var Me=Array(fe),Fe=0;Fe<fe;Fe++)Me[Fe]=arguments[Fe+2];oe.children=Me}return O(z.type,he,oe)},pt.createContext=function(z){return z={$$typeof:d,_currentValue:z,_currentValue2:z,_threadCount:0,Provider:null,Consumer:null},z.Provider=z,z.Consumer={$$typeof:c,_context:z},z},pt.createElement=function(z,R,re){var oe,he={},fe=null;if(R!=null)for(oe in R.key!==void 0&&(fe=""+R.key),R)j.call(R,oe)&&oe!=="key"&&oe!=="__self"&&oe!=="__source"&&(he[oe]=R[oe]);var Me=arguments.length-2;if(Me===1)he.children=re;else if(1<Me){for(var Fe=Array(Me),Ce=0;Ce<Me;Ce++)Fe[Ce]=arguments[Ce+2];he.children=Fe}if(z&&z.defaultProps)for(oe in Me=z.defaultProps,Me)he[oe]===void 0&&(he[oe]=Me[oe]);return O(z,fe,he)},pt.createRef=function(){return{current:null}},pt.forwardRef=function(z){return{$$typeof:m,render:z}},pt.isValidElement=te,pt.lazy=function(z){return{$$typeof:v,_payload:{_status:-1,_result:z},_init:me}},pt.memo=function(z,R){return{$$typeof:h,type:z,compare:R===void 0?null:R}},pt.startTransition=function(z){var R=U.T,re={};U.T=re;try{var oe=z(),he=U.S;he!==null&&he(re,oe),typeof oe=="object"&&oe!==null&&typeof oe.then=="function"&&oe.then(Q,W)}catch(fe){W(fe)}finally{R!==null&&re.types!==null&&(R.types=re.types),U.T=R}},pt.unstable_useCacheRefresh=function(){return U.H.useCacheRefresh()},pt.use=function(z){return U.H.use(z)},pt.useActionState=function(z,R,re){return U.H.useActionState(z,R,re)},pt.useCallback=function(z,R){return U.H.useCallback(z,R)},pt.useContext=function(z){return U.H.useContext(z)},pt.useDebugValue=function(){},pt.useDeferredValue=function(z,R){return U.H.useDeferredValue(z,R)},pt.useEffect=function(z,R){return U.H.useEffect(z,R)},pt.useEffectEvent=function(z){return U.H.useEffectEvent(z)},pt.useId=function(){return U.H.useId()},pt.useImperativeHandle=function(z,R,re){return U.H.useImperativeHandle(z,R,re)},pt.useInsertionEffect=function(z,R){return U.H.useInsertionEffect(z,R)},pt.useLayoutEffect=function(z,R){return U.H.useLayoutEffect(z,R)},pt.useMemo=function(z,R){return U.H.useMemo(z,R)},pt.useOptimistic=function(z,R){return U.H.useOptimistic(z,R)},pt.useReducer=function(z,R,re){return U.H.useReducer(z,R,re)},pt.useRef=function(z){return U.H.useRef(z)},pt.useState=function(z){return U.H.useState(z)},pt.useSyncExternalStore=function(z,R,re){return U.H.useSyncExternalStore(z,R,re)},pt.useTransition=function(){return U.H.useTransition()},pt.version="19.2.3",pt}var vy;function Dl(){return vy||(vy=1,Pf.exports=n_()),Pf.exports}var G=Dl();const Wi=io(G);var Yf={exports:{}},tl={},$f={exports:{}},Vf={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var by;function r_(){return by||(by=1,(function(n){function a(Z,Y){var me=Z.length;Z.push(Y);e:for(;0<me;){var W=me-1>>>1,be=Z[W];if(0<l(be,Y))Z[W]=Y,Z[me]=be,me=W;else break e}}function s(Z){return Z.length===0?null:Z[0]}function i(Z){if(Z.length===0)return null;var Y=Z[0],me=Z.pop();if(me!==Y){Z[0]=me;e:for(var W=0,be=Z.length,z=be>>>1;W<z;){var R=2*(W+1)-1,re=Z[R],oe=R+1,he=Z[oe];if(0>l(re,me))oe<be&&0>l(he,re)?(Z[W]=he,Z[oe]=me,W=oe):(Z[W]=re,Z[R]=me,W=R);else if(oe<be&&0>l(he,me))Z[W]=he,Z[oe]=me,W=oe;else break e}}return Y}function l(Z,Y){var me=Z.sortIndex-Y.sortIndex;return me!==0?me:Z.id-Y.id}if(n.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var c=performance;n.unstable_now=function(){return c.now()}}else{var d=Date,m=d.now();n.unstable_now=function(){return d.now()-m}}var p=[],h=[],v=1,S=null,A=3,_=!1,E=!1,w=!1,k=!1,N=typeof setTimeout=="function"?setTimeout:null,I=typeof clearTimeout=="function"?clearTimeout:null,M=typeof setImmediate<"u"?setImmediate:null;function F(Z){for(var Y=s(h);Y!==null;){if(Y.callback===null)i(h);else if(Y.startTime<=Z)i(h),Y.sortIndex=Y.expirationTime,a(p,Y);else break;Y=s(h)}}function q(Z){if(w=!1,F(Z),!E)if(s(p)!==null)E=!0,Q||(Q=!0,L());else{var Y=s(h);Y!==null&&ie(q,Y.startTime-Z)}}var Q=!1,U=-1,j=5,O=-1;function B(){return k?!0:!(n.unstable_now()-O<j)}function te(){if(k=!1,Q){var Z=n.unstable_now();O=Z;var Y=!0;try{e:{E=!1,w&&(w=!1,I(U),U=-1),_=!0;var me=A;try{t:{for(F(Z),S=s(p);S!==null&&!(S.expirationTime>Z&&B());){var W=S.callback;if(typeof W=="function"){S.callback=null,A=S.priorityLevel;var be=W(S.expirationTime<=Z);if(Z=n.unstable_now(),typeof be=="function"){S.callback=be,F(Z),Y=!0;break t}S===s(p)&&i(p),F(Z)}else i(p);S=s(p)}if(S!==null)Y=!0;else{var z=s(h);z!==null&&ie(q,z.startTime-Z),Y=!1}}break e}finally{S=null,A=me,_=!1}Y=void 0}}finally{Y?L():Q=!1}}}var L;if(typeof M=="function")L=function(){M(te)};else if(typeof MessageChannel<"u"){var J=new MessageChannel,D=J.port2;J.port1.onmessage=te,L=function(){D.postMessage(null)}}else L=function(){N(te,0)};function ie(Z,Y){U=N(function(){Z(n.unstable_now())},Y)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(Z){Z.callback=null},n.unstable_forceFrameRate=function(Z){0>Z||125<Z?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):j=0<Z?Math.floor(1e3/Z):5},n.unstable_getCurrentPriorityLevel=function(){return A},n.unstable_next=function(Z){switch(A){case 1:case 2:case 3:var Y=3;break;default:Y=A}var me=A;A=Y;try{return Z()}finally{A=me}},n.unstable_requestPaint=function(){k=!0},n.unstable_runWithPriority=function(Z,Y){switch(Z){case 1:case 2:case 3:case 4:case 5:break;default:Z=3}var me=A;A=Z;try{return Y()}finally{A=me}},n.unstable_scheduleCallback=function(Z,Y,me){var W=n.unstable_now();switch(typeof me=="object"&&me!==null?(me=me.delay,me=typeof me=="number"&&0<me?W+me:W):me=W,Z){case 1:var be=-1;break;case 2:be=250;break;case 5:be=1073741823;break;case 4:be=1e4;break;default:be=5e3}return be=me+be,Z={id:v++,callback:Y,priorityLevel:Z,startTime:me,expirationTime:be,sortIndex:-1},me>W?(Z.sortIndex=me,a(h,Z),s(p)===null&&Z===s(h)&&(w?(I(U),U=-1):w=!0,ie(q,me-W))):(Z.sortIndex=be,a(p,Z),E||_||(E=!0,Q||(Q=!0,L()))),Z},n.unstable_shouldYield=B,n.unstable_wrapCallback=function(Z){var Y=A;return function(){var me=A;A=Y;try{return Z.apply(this,arguments)}finally{A=me}}}})(Vf)),Vf}var xy;function a_(){return xy||(xy=1,$f.exports=r_()),$f.exports}var Zf={exports:{}},$n={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var _y;function s_(){if(_y)return $n;_y=1;var n=Dl();function a(p){var h="https://react.dev/errors/"+p;if(1<arguments.length){h+="?args[]="+encodeURIComponent(arguments[1]);for(var v=2;v<arguments.length;v++)h+="&args[]="+encodeURIComponent(arguments[v])}return"Minified React error #"+p+"; visit "+h+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function s(){}var i={d:{f:s,r:function(){throw Error(a(522))},D:s,C:s,L:s,m:s,X:s,S:s,M:s},p:0,findDOMNode:null},l=Symbol.for("react.portal");function c(p,h,v){var S=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:l,key:S==null?null:""+S,children:p,containerInfo:h,implementation:v}}var d=n.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function m(p,h){if(p==="font")return"";if(typeof h=="string")return h==="use-credentials"?h:""}return $n.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=i,$n.createPortal=function(p,h){var v=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!h||h.nodeType!==1&&h.nodeType!==9&&h.nodeType!==11)throw Error(a(299));return c(p,h,null,v)},$n.flushSync=function(p){var h=d.T,v=i.p;try{if(d.T=null,i.p=2,p)return p()}finally{d.T=h,i.p=v,i.d.f()}},$n.preconnect=function(p,h){typeof p=="string"&&(h?(h=h.crossOrigin,h=typeof h=="string"?h==="use-credentials"?h:"":void 0):h=null,i.d.C(p,h))},$n.prefetchDNS=function(p){typeof p=="string"&&i.d.D(p)},$n.preinit=function(p,h){if(typeof p=="string"&&h&&typeof h.as=="string"){var v=h.as,S=m(v,h.crossOrigin),A=typeof h.integrity=="string"?h.integrity:void 0,_=typeof h.fetchPriority=="string"?h.fetchPriority:void 0;v==="style"?i.d.S(p,typeof h.precedence=="string"?h.precedence:void 0,{crossOrigin:S,integrity:A,fetchPriority:_}):v==="script"&&i.d.X(p,{crossOrigin:S,integrity:A,fetchPriority:_,nonce:typeof h.nonce=="string"?h.nonce:void 0})}},$n.preinitModule=function(p,h){if(typeof p=="string")if(typeof h=="object"&&h!==null){if(h.as==null||h.as==="script"){var v=m(h.as,h.crossOrigin);i.d.M(p,{crossOrigin:v,integrity:typeof h.integrity=="string"?h.integrity:void 0,nonce:typeof h.nonce=="string"?h.nonce:void 0})}}else h==null&&i.d.M(p)},$n.preload=function(p,h){if(typeof p=="string"&&typeof h=="object"&&h!==null&&typeof h.as=="string"){var v=h.as,S=m(v,h.crossOrigin);i.d.L(p,v,{crossOrigin:S,integrity:typeof h.integrity=="string"?h.integrity:void 0,nonce:typeof h.nonce=="string"?h.nonce:void 0,type:typeof h.type=="string"?h.type:void 0,fetchPriority:typeof h.fetchPriority=="string"?h.fetchPriority:void 0,referrerPolicy:typeof h.referrerPolicy=="string"?h.referrerPolicy:void 0,imageSrcSet:typeof h.imageSrcSet=="string"?h.imageSrcSet:void 0,imageSizes:typeof h.imageSizes=="string"?h.imageSizes:void 0,media:typeof h.media=="string"?h.media:void 0})}},$n.preloadModule=function(p,h){if(typeof p=="string")if(h){var v=m(h.as,h.crossOrigin);i.d.m(p,{as:typeof h.as=="string"&&h.as!=="script"?h.as:void 0,crossOrigin:v,integrity:typeof h.integrity=="string"?h.integrity:void 0})}else i.d.m(p)},$n.requestFormReset=function(p){i.d.r(p)},$n.unstable_batchedUpdates=function(p,h){return p(h)},$n.useFormState=function(p,h,v){return d.H.useFormState(p,h,v)},$n.useFormStatus=function(){return d.H.useHostTransitionStatus()},$n.version="19.2.3",$n}var Sy;function i_(){if(Sy)return Zf.exports;Sy=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(a){console.error(a)}}return n(),Zf.exports=s_(),Zf.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var wy;function o_(){if(wy)return tl;wy=1;var n=a_(),a=Dl(),s=i_();function i(e){var t="https://react.dev/errors/"+e;if(1<arguments.length){t+="?args[]="+encodeURIComponent(arguments[1]);for(var r=2;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r])}return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function l(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function c(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,(t.flags&4098)!==0&&(r=t.return),e=t.return;while(e)}return t.tag===3?r:null}function d(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function m(e){if(e.tag===31){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function p(e){if(c(e)!==e)throw Error(i(188))}function h(e){var t=e.alternate;if(!t){if(t=c(e),t===null)throw Error(i(188));return t!==e?null:e}for(var r=e,o=t;;){var f=r.return;if(f===null)break;var g=f.alternate;if(g===null){if(o=f.return,o!==null){r=o;continue}break}if(f.child===g.child){for(g=f.child;g;){if(g===r)return p(f),e;if(g===o)return p(f),t;g=g.sibling}throw Error(i(188))}if(r.return!==o.return)r=f,o=g;else{for(var T=!1,H=f.child;H;){if(H===r){T=!0,r=f,o=g;break}if(H===o){T=!0,o=f,r=g;break}H=H.sibling}if(!T){for(H=g.child;H;){if(H===r){T=!0,r=g,o=f;break}if(H===o){T=!0,o=g,r=f;break}H=H.sibling}if(!T)throw Error(i(189))}}if(r.alternate!==o)throw Error(i(190))}if(r.tag!==3)throw Error(i(188));return r.stateNode.current===r?e:t}function v(e){var t=e.tag;if(t===5||t===26||t===27||t===6)return e;for(e=e.child;e!==null;){if(t=v(e),t!==null)return t;e=e.sibling}return null}var S=Object.assign,A=Symbol.for("react.element"),_=Symbol.for("react.transitional.element"),E=Symbol.for("react.portal"),w=Symbol.for("react.fragment"),k=Symbol.for("react.strict_mode"),N=Symbol.for("react.profiler"),I=Symbol.for("react.consumer"),M=Symbol.for("react.context"),F=Symbol.for("react.forward_ref"),q=Symbol.for("react.suspense"),Q=Symbol.for("react.suspense_list"),U=Symbol.for("react.memo"),j=Symbol.for("react.lazy"),O=Symbol.for("react.activity"),B=Symbol.for("react.memo_cache_sentinel"),te=Symbol.iterator;function L(e){return e===null||typeof e!="object"?null:(e=te&&e[te]||e["@@iterator"],typeof e=="function"?e:null)}var J=Symbol.for("react.client.reference");function D(e){if(e==null)return null;if(typeof e=="function")return e.$$typeof===J?null:e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case w:return"Fragment";case N:return"Profiler";case k:return"StrictMode";case q:return"Suspense";case Q:return"SuspenseList";case O:return"Activity"}if(typeof e=="object")switch(e.$$typeof){case E:return"Portal";case M:return e.displayName||"Context";case I:return(e._context.displayName||"Context")+".Consumer";case F:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case U:return t=e.displayName||null,t!==null?t:D(e.type)||"Memo";case j:t=e._payload,e=e._init;try{return D(e(t))}catch{}}return null}var ie=Array.isArray,Z=a.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Y=s.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,me={pending:!1,data:null,method:null,action:null},W=[],be=-1;function z(e){return{current:e}}function R(e){0>be||(e.current=W[be],W[be]=null,be--)}function re(e,t){be++,W[be]=e.current,e.current=t}var oe=z(null),he=z(null),fe=z(null),Me=z(null);function Fe(e,t){switch(re(fe,t),re(he,e),re(oe,null),t.nodeType){case 9:case 11:e=(e=t.documentElement)&&(e=e.namespaceURI)?zg(e):0;break;default:if(e=t.tagName,t=t.namespaceURI)t=zg(t),e=Fg(t,e);else switch(e){case"svg":e=1;break;case"math":e=2;break;default:e=0}}R(oe),re(oe,e)}function Ce(){R(oe),R(he),R(fe)}function Ve(e){e.memoizedState!==null&&re(Me,e);var t=oe.current,r=Fg(t,e.type);t!==r&&(re(he,e),re(oe,r))}function Qe(e){he.current===e&&(R(oe),R(he)),Me.current===e&&(R(Me),Ko._currentValue=me)}var ue,de;function x(e){if(ue===void 0)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);ue=t&&t[1]||"",de=-1<r.stack.indexOf(`
    at`)?" (<anonymous>)":-1<r.stack.indexOf("@")?"@unknown:0:0":""}return`
`+ue+e+de}var se=!1;function X(e,t){if(!e||se)return"";se=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var o={DetermineComponentFrameRoot:function(){try{if(t){var Re=function(){throw Error()};if(Object.defineProperty(Re.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(Re,[])}catch(Ae){var we=Ae}Reflect.construct(e,[],Re)}else{try{Re.call()}catch(Ae){we=Ae}e.call(Re.prototype)}}else{try{throw Error()}catch(Ae){we=Ae}(Re=e())&&typeof Re.catch=="function"&&Re.catch(function(){})}}catch(Ae){if(Ae&&we&&typeof Ae.stack=="string")return[Ae.stack,we.stack]}return[null,null]}};o.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var f=Object.getOwnPropertyDescriptor(o.DetermineComponentFrameRoot,"name");f&&f.configurable&&Object.defineProperty(o.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var g=o.DetermineComponentFrameRoot(),T=g[0],H=g[1];if(T&&H){var ae=T.split(`
`),Se=H.split(`
`);for(f=o=0;o<ae.length&&!ae[o].includes("DetermineComponentFrameRoot");)o++;for(;f<Se.length&&!Se[f].includes("DetermineComponentFrameRoot");)f++;if(o===ae.length||f===Se.length)for(o=ae.length-1,f=Se.length-1;1<=o&&0<=f&&ae[o]!==Se[f];)f--;for(;1<=o&&0<=f;o--,f--)if(ae[o]!==Se[f]){if(o!==1||f!==1)do if(o--,f--,0>f||ae[o]!==Se[f]){var De=`
`+ae[o].replace(" at new "," at ");return e.displayName&&De.includes("<anonymous>")&&(De=De.replace("<anonymous>",e.displayName)),De}while(1<=o&&0<=f);break}}}finally{se=!1,Error.prepareStackTrace=r}return(r=e?e.displayName||e.name:"")?x(r):""}function $(e,t){switch(e.tag){case 26:case 27:case 5:return x(e.type);case 16:return x("Lazy");case 13:return e.child!==t&&t!==null?x("Suspense Fallback"):x("Suspense");case 19:return x("SuspenseList");case 0:case 15:return X(e.type,!1);case 11:return X(e.type.render,!1);case 1:return X(e.type,!0);case 31:return x("Activity");default:return""}}function P(e){try{var t="",r=null;do t+=$(e,r),r=e,e=e.return;while(e);return t}catch(o){return`
Error generating stack: `+o.message+`
`+o.stack}}var K=Object.prototype.hasOwnProperty,ye=n.unstable_scheduleCallback,ve=n.unstable_cancelCallback,ne=n.unstable_shouldYield,ke=n.unstable_requestPaint,Oe=n.unstable_now,Te=n.unstable_getCurrentPriorityLevel,He=n.unstable_ImmediatePriority,it=n.unstable_UserBlockingPriority,at=n.unstable_NormalPriority,Ot=n.unstable_LowPriority,Zt=n.unstable_IdlePriority,zt=n.log,qt=n.unstable_setDisableYieldValue,ht=null,bt=null;function pn(e){if(typeof zt=="function"&&qt(e),bt&&typeof bt.setStrictMode=="function")try{bt.setStrictMode(ht,e)}catch{}}var It=Math.clz32?Math.clz32:Ya,ya=Math.log,dt=Math.LN2;function Ya(e){return e>>>=0,e===0?32:31-(ya(e)/dt|0)|0}var Nr=256,Ft=262144,cn=4194304;function jn(e){var t=e&42;if(t!==0)return t;switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return e&261888;case 262144:case 524288:case 1048576:case 2097152:return e&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return e&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return e}}function Qn(e,t,r){var o=e.pendingLanes;if(o===0)return 0;var f=0,g=e.suspendedLanes,T=e.pingedLanes;e=e.warmLanes;var H=o&134217727;return H!==0?(o=H&~g,o!==0?f=jn(o):(T&=H,T!==0?f=jn(T):r||(r=H&~e,r!==0&&(f=jn(r))))):(H=o&~g,H!==0?f=jn(H):T!==0?f=jn(T):r||(r=o&~e,r!==0&&(f=jn(r)))),f===0?0:t!==0&&t!==f&&(t&g)===0&&(g=f&-f,r=t&-t,g>=r||g===32&&(r&4194048)!==0)?t:f}function Zr(e,t){return(e.pendingLanes&~(e.suspendedLanes&~e.pingedLanes)&t)===0}function Ge(e,t){switch(e){case 1:case 2:case 4:case 8:case 64:return t+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function va(){var e=cn;return cn<<=1,(cn&62914560)===0&&(cn=4194304),e}function gn(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function fr(e,t){e.pendingLanes|=t,t!==268435456&&(e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0)}function $a(e,t,r,o,f,g){var T=e.pendingLanes;e.pendingLanes=r,e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0,e.expiredLanes&=r,e.entangledLanes&=r,e.errorRecoveryDisabledLanes&=r,e.shellSuspendCounter=0;var H=e.entanglements,ae=e.expirationTimes,Se=e.hiddenUpdates;for(r=T&~r;0<r;){var De=31-It(r),Re=1<<De;H[De]=0,ae[De]=-1;var we=Se[De];if(we!==null)for(Se[De]=null,De=0;De<we.length;De++){var Ae=we[De];Ae!==null&&(Ae.lane&=-536870913)}r&=~Re}o!==0&&Va(e,o,0),g!==0&&f===0&&e.tag!==0&&(e.suspendedLanes|=g&~(T&~t))}function Va(e,t,r){e.pendingLanes|=t,e.suspendedLanes&=~t;var o=31-It(t);e.entangledLanes|=t,e.entanglements[o]=e.entanglements[o]|1073741824|r&261930}function Dr(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var o=31-It(r),f=1<<o;f&t|e[o]&t&&(e[o]|=t),r&=~f}}function In(e,t){var r=t&-t;return r=(r&42)!==0?1:xn(r),(r&(e.suspendedLanes|t))!==0?0:r}function xn(e){switch(e){case 2:e=1;break;case 8:e=4;break;case 32:e=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:e=128;break;case 268435456:e=134217728;break;default:e=0}return e}function ba(e){return e&=-e,2<e?8<e?(e&134217727)!==0?32:268435456:8:2}function Cr(){var e=Y.p;return e!==0?e:(e=window.event,e===void 0?32:ly(e.type))}function Is(e,t){var r=Y.p;try{return Y.p=e,t()}finally{Y.p=r}}var ar=Math.random().toString(36).slice(2),Bt="__reactFiber$"+ar,Rt="__reactProps$"+ar,Or="__reactContainer$"+ar,Za="__reactEvents$"+ar,Qa="__reactListeners$"+ar,ci="__reactHandles$"+ar,Xe="__reactResources$"+ar,le="__reactMarker$"+ar;function Le(e){delete e[Bt],delete e[Rt],delete e[Za],delete e[Qa],delete e[ci]}function $e(e){var t=e[Bt];if(t)return t;for(var r=e.parentNode;r;){if(t=r[Or]||r[Bt]){if(r=t.alternate,t.child!==null||r!==null&&r.child!==null)for(e=$g(e);e!==null;){if(r=e[Bt])return r;e=$g(e)}return t}e=r,r=e.parentNode}return null}function ct(e){if(e=e[Bt]||e[Or]){var t=e.tag;if(t===5||t===6||t===13||t===31||t===26||t===27||t===3)return e}return null}function Wt(e){var t=e.tag;if(t===5||t===26||t===27||t===6)return e.stateNode;throw Error(i(33))}function Jt(e){var t=e[Xe];return t||(t=e[Xe]={hoistableStyles:new Map,hoistableScripts:new Map}),t}function wt(e){e[le]=!0}var _n=new Set,hr={};function en(e,t){Pn(e,t),Pn(e+"Capture",t)}function Pn(e,t){for(hr[e]=t,e=0;e<t.length;e++)_n.add(t[e])}var Ka=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),lo={},co={};function jl(e){return K.call(co,e)?!0:K.call(lo,e)?!1:Ka.test(e)?co[e]=!0:(lo[e]=!0,!1)}function ui(e,t,r){if(jl(t))if(r===null)e.removeAttribute(t);else{switch(typeof r){case"undefined":case"function":case"symbol":e.removeAttribute(t);return;case"boolean":var o=t.toLowerCase().slice(0,5);if(o!=="data-"&&o!=="aria-"){e.removeAttribute(t);return}}e.setAttribute(t,""+r)}}function Rs(e,t,r){if(r===null)e.removeAttribute(t);else{switch(typeof r){case"undefined":case"function":case"symbol":case"boolean":e.removeAttribute(t);return}e.setAttribute(t,""+r)}}function jr(e,t,r,o){if(o===null)e.removeAttribute(r);else{switch(typeof o){case"undefined":case"function":case"symbol":case"boolean":e.removeAttribute(r);return}e.setAttributeNS(t,r,""+o)}}function Dn(e){switch(typeof e){case"bigint":case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function uo(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function Qt(e,t,r){var o=Object.getOwnPropertyDescriptor(e.constructor.prototype,t);if(!e.hasOwnProperty(t)&&typeof o<"u"&&typeof o.get=="function"&&typeof o.set=="function"){var f=o.get,g=o.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return f.call(this)},set:function(T){r=""+T,g.call(this,T)}}),Object.defineProperty(e,t,{enumerable:o.enumerable}),{getValue:function(){return r},setValue:function(T){r=""+T},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function xa(e){if(!e._valueTracker){var t=uo(e)?"checked":"value";e._valueTracker=Qt(e,t,""+e[t])}}function di(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),o="";return e&&(o=uo(e)?e.checked?"true":"false":e.value),e=o,e!==r?(t.setValue(e),!0):!1}function Ir(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}var fi=/[\n"\\]/g;function Rn(e){return e.replace(fi,function(t){return"\\"+t.charCodeAt(0).toString(16)+" "})}function Ja(e,t,r,o,f,g,T,H){e.name="",T!=null&&typeof T!="function"&&typeof T!="symbol"&&typeof T!="boolean"?e.type=T:e.removeAttribute("type"),t!=null?T==="number"?(t===0&&e.value===""||e.value!=t)&&(e.value=""+Dn(t)):e.value!==""+Dn(t)&&(e.value=""+Dn(t)):T!=="submit"&&T!=="reset"||e.removeAttribute("value"),t!=null?fo(e,T,Dn(t)):r!=null?fo(e,T,Dn(r)):o!=null&&e.removeAttribute("value"),f==null&&g!=null&&(e.defaultChecked=!!g),f!=null&&(e.checked=f&&typeof f!="function"&&typeof f!="symbol"),H!=null&&typeof H!="function"&&typeof H!="symbol"&&typeof H!="boolean"?e.name=""+Dn(H):e.removeAttribute("name")}function Xa(e,t,r,o,f,g,T,H){if(g!=null&&typeof g!="function"&&typeof g!="symbol"&&typeof g!="boolean"&&(e.type=g),t!=null||r!=null){if(!(g!=="submit"&&g!=="reset"||t!=null)){xa(e);return}r=r!=null?""+Dn(r):"",t=t!=null?""+Dn(t):r,H||t===e.value||(e.value=t),e.defaultValue=t}o=o??f,o=typeof o!="function"&&typeof o!="symbol"&&!!o,e.checked=H?e.checked:!!o,e.defaultChecked=!!o,T!=null&&typeof T!="function"&&typeof T!="symbol"&&typeof T!="boolean"&&(e.name=T),xa(e)}function fo(e,t,r){t==="number"&&Ir(e.ownerDocument)===e||e.defaultValue===""+r||(e.defaultValue=""+r)}function Wa(e,t,r,o){if(e=e.options,t){t={};for(var f=0;f<r.length;f++)t["$"+r[f]]=!0;for(r=0;r<e.length;r++)f=t.hasOwnProperty("$"+e[r].value),e[r].selected!==f&&(e[r].selected=f),f&&o&&(e[r].defaultSelected=!0)}else{for(r=""+Dn(r),t=null,f=0;f<e.length;f++){if(e[f].value===r){e[f].selected=!0,o&&(e[f].defaultSelected=!0);return}t!==null||e[f].disabled||(t=e[f])}t!==null&&(t.selected=!0)}}function ho(e,t,r){if(t!=null&&(t=""+Dn(t),t!==e.value&&(e.value=t),r==null)){e.defaultValue!==t&&(e.defaultValue=t);return}e.defaultValue=r!=null?""+Dn(r):""}function hi(e,t,r,o){if(t==null){if(o!=null){if(r!=null)throw Error(i(92));if(ie(o)){if(1<o.length)throw Error(i(93));o=o[0]}r=o}r==null&&(r=""),t=r}r=Dn(t),e.defaultValue=r,o=e.textContent,o===r&&o!==""&&o!==null&&(e.value=o),xa(e)}function _a(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&r.nodeType===3){r.nodeValue=t;return}}e.textContent=t}var mo=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function mi(e,t,r){var o=t.indexOf("--")===0;r==null||typeof r=="boolean"||r===""?o?e.setProperty(t,""):t==="float"?e.cssFloat="":e[t]="":o?e.setProperty(t,r):typeof r!="number"||r===0||mo.has(t)?t==="float"?e.cssFloat=r:e[t]=(""+r).trim():e[t]=r+"px"}function Il(e,t,r){if(t!=null&&typeof t!="object")throw Error(i(62));if(e=e.style,r!=null){for(var o in r)!r.hasOwnProperty(o)||t!=null&&t.hasOwnProperty(o)||(o.indexOf("--")===0?e.setProperty(o,""):o==="float"?e.cssFloat="":e[o]="");for(var f in t)o=t[f],t.hasOwnProperty(f)&&r[f]!==o&&mi(e,f,o)}else for(var g in t)t.hasOwnProperty(g)&&mi(e,g,t[g])}function es(e){if(e.indexOf("-")===-1)return!1;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var pi=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Sa=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function ts(e){return Sa.test(""+e)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":e}function Tn(){}var ia=null;function ns(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var wa=null,rs=null;function tt(e){var t=ct(e);if(t&&(e=t.stateNode)){var r=e[Rt]||null;e:switch(e=t.stateNode,t.type){case"input":if(Ja(e,r.value,r.defaultValue,r.defaultValue,r.checked,r.defaultChecked,r.type,r.name),t=r.name,r.type==="radio"&&t!=null){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll('input[name="'+Rn(""+t)+'"][type="radio"]'),t=0;t<r.length;t++){var o=r[t];if(o!==e&&o.form===e.form){var f=o[Rt]||null;if(!f)throw Error(i(90));Ja(o,f.value,f.defaultValue,f.defaultValue,f.checked,f.defaultChecked,f.type,f.name)}}for(t=0;t<r.length;t++)o=r[t],o.form===e.form&&di(o)}break e;case"textarea":ho(e,r.value,r.defaultValue);break e;case"select":t=r.value,t!=null&&Wa(e,!!r.multiple,t,!1)}}}var gi=!1;function Ms(e,t,r){if(gi)return e(t,r);gi=!0;try{var o=e(t);return o}finally{if(gi=!1,(wa!==null||rs!==null)&&(Sc(),wa&&(t=wa,e=rs,rs=wa=null,tt(t),e)))for(t=0;t<e.length;t++)tt(e[t])}}function oa(e,t){var r=e.stateNode;if(r===null)return null;var o=r[Rt]||null;if(o===null)return null;r=o[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(o=!o.disabled)||(e=e.type,o=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!o;break e;default:e=!1}if(e)return null;if(r&&typeof r!="function")throw Error(i(231,t,typeof r));return r}var Rr=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Ea=!1;if(Rr)try{var Qr={};Object.defineProperty(Qr,"passive",{get:function(){Ea=!0}}),window.addEventListener("test",Qr,Qr),window.removeEventListener("test",Qr,Qr)}catch{Ea=!1}var Mn=null,as=null,Us=null;function y(){if(Us)return Us;var e,t=as,r=t.length,o,f="value"in Mn?Mn.value:Mn.textContent,g=f.length;for(e=0;e<r&&t[e]===f[e];e++);var T=r-e;for(o=1;o<=T&&t[r-o]===f[g-o];o++);return Us=f.slice(e,1<o?1-o:void 0)}function b(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function C(){return!0}function V(){return!1}function ee(e){function t(r,o,f,g,T){this._reactName=r,this._targetInst=f,this.type=o,this.nativeEvent=g,this.target=T,this.currentTarget=null;for(var H in e)e.hasOwnProperty(H)&&(r=e[H],this[H]=r?r(g):g[H]);return this.isDefaultPrevented=(g.defaultPrevented!=null?g.defaultPrevented:g.returnValue===!1)?C:V,this.isPropagationStopped=V,this}return S(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=C)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=C)},persist:function(){},isPersistent:C}),t}var Ee={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},je=ee(Ee),st=S({},Ee,{view:0,detail:0}),Dt=ee(st),mt,an,sn,Ls=S({},st,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:go,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==sn&&(sn&&e.type==="mousemove"?(mt=e.screenX-sn.screenX,an=e.screenY-sn.screenY):an=mt=0,sn=e),mt)},movementY:function(e){return"movementY"in e?e.movementY:an}}),Rl=ee(Ls),Ml=S({},Ls,{dataTransfer:0}),Cu=ee(Ml),Ul=S({},st,{relatedTarget:0}),po=ee(Ul),Ou=S({},Ee,{animationName:0,elapsedTime:0,pseudoElement:0}),ju=ee(Ou),Iu=S({},Ee,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),Ru=ee(Iu),Mu=S({},Ee,{data:0}),Ll=ee(Mu),Uu={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},zl={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Lu={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function zu(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=Lu[e])?!!t[e]:!1}function go(){return zu}var Fu=S({},st,{key:function(e){if(e.key){var t=Uu[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=b(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?zl[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:go,charCode:function(e){return e.type==="keypress"?b(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?b(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),Bu=ee(Fu),Hu=S({},Ls,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Fl=ee(Hu),Bl=S({},st,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:go}),Gu=ee(Bl),qu=S({},Ee,{propertyName:0,elapsedTime:0,pseudoElement:0}),Pu=ee(qu),Yu=S({},Ls,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),$u=ee(Yu),Vu=S({},Ee,{newState:0,oldState:0}),Hl=ee(Vu),Zu=[9,13,27,32],yo=Rr&&"CompositionEvent"in window,zs=null;Rr&&"documentMode"in document&&(zs=document.documentMode);var yi=Rr&&"TextEvent"in window&&!zs,vo=Rr&&(!yo||zs&&8<zs&&11>=zs),bo=" ",xe=!1;function Ue(e,t){switch(e){case"keyup":return Zu.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function We(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var ot=!1;function xt(e,t){switch(e){case"compositionend":return We(t);case"keypress":return t.which!==32?null:(xe=!0,bo);case"textInput":return e=t.data,e===bo&&xe?null:e;default:return null}}function Pt(e,t){if(ot)return e==="compositionend"||!yo&&Ue(e,t)?(e=y(),Us=as=Mn=null,ot=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return vo&&t.locale!=="ko"?null:t.data;default:return null}}var mr={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Kn(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!mr[e.type]:t==="textarea"}function Yn(e,t,r,o){wa?rs?rs.push(o):rs=[o]:wa=o,t=Dc(t,"onChange"),0<t.length&&(r=new je("onChange","change",null,r,o),e.push({event:r,listeners:t}))}var Un=null,ka=null;function Ta(e){jg(e,0)}function vi(e){var t=Wt(e);if(di(t))return e}function Jh(e,t){if(e==="change")return t}var Xh=!1;if(Rr){var Qu;if(Rr){var Ku="oninput"in document;if(!Ku){var Wh=document.createElement("div");Wh.setAttribute("oninput","return;"),Ku=typeof Wh.oninput=="function"}Qu=Ku}else Qu=!1;Xh=Qu&&(!document.documentMode||9<document.documentMode)}function em(){Un&&(Un.detachEvent("onpropertychange",tm),ka=Un=null)}function tm(e){if(e.propertyName==="value"&&vi(ka)){var t=[];Yn(t,ka,e,ns(e)),Ms(Ta,t)}}function A0(e,t,r){e==="focusin"?(em(),Un=t,ka=r,Un.attachEvent("onpropertychange",tm)):e==="focusout"&&em()}function N0(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return vi(ka)}function D0(e,t){if(e==="click")return vi(t)}function C0(e,t){if(e==="input"||e==="change")return vi(t)}function O0(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var pr=typeof Object.is=="function"?Object.is:O0;function xo(e,t){if(pr(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var r=Object.keys(e),o=Object.keys(t);if(r.length!==o.length)return!1;for(o=0;o<r.length;o++){var f=r[o];if(!K.call(t,f)||!pr(e[f],t[f]))return!1}return!0}function nm(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function rm(e,t){var r=nm(e);e=0;for(var o;r;){if(r.nodeType===3){if(o=e+r.textContent.length,e<=t&&o>=t)return{node:r,offset:t-e};e=o}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=nm(r)}}function am(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?am(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function sm(e){e=e!=null&&e.ownerDocument!=null&&e.ownerDocument.defaultView!=null?e.ownerDocument.defaultView:window;for(var t=Ir(e.document);t instanceof e.HTMLIFrameElement;){try{var r=typeof t.contentWindow.location.href=="string"}catch{r=!1}if(r)e=t.contentWindow;else break;t=Ir(e.document)}return t}function Ju(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}var j0=Rr&&"documentMode"in document&&11>=document.documentMode,bi=null,Xu=null,_o=null,Wu=!1;function im(e,t,r){var o=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;Wu||bi==null||bi!==Ir(o)||(o=bi,"selectionStart"in o&&Ju(o)?o={start:o.selectionStart,end:o.selectionEnd}:(o=(o.ownerDocument&&o.ownerDocument.defaultView||window).getSelection(),o={anchorNode:o.anchorNode,anchorOffset:o.anchorOffset,focusNode:o.focusNode,focusOffset:o.focusOffset}),_o&&xo(_o,o)||(_o=o,o=Dc(Xu,"onSelect"),0<o.length&&(t=new je("onSelect","select",null,t,r),e.push({event:t,listeners:o}),t.target=bi)))}function Fs(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var xi={animationend:Fs("Animation","AnimationEnd"),animationiteration:Fs("Animation","AnimationIteration"),animationstart:Fs("Animation","AnimationStart"),transitionrun:Fs("Transition","TransitionRun"),transitionstart:Fs("Transition","TransitionStart"),transitioncancel:Fs("Transition","TransitionCancel"),transitionend:Fs("Transition","TransitionEnd")},ed={},om={};Rr&&(om=document.createElement("div").style,"AnimationEvent"in window||(delete xi.animationend.animation,delete xi.animationiteration.animation,delete xi.animationstart.animation),"TransitionEvent"in window||delete xi.transitionend.transition);function Bs(e){if(ed[e])return ed[e];if(!xi[e])return e;var t=xi[e],r;for(r in t)if(t.hasOwnProperty(r)&&r in om)return ed[e]=t[r];return e}var lm=Bs("animationend"),cm=Bs("animationiteration"),um=Bs("animationstart"),I0=Bs("transitionrun"),R0=Bs("transitionstart"),M0=Bs("transitioncancel"),dm=Bs("transitionend"),fm=new Map,td="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");td.push("scrollEnd");function Kr(e,t){fm.set(e,t),en(t,[e])}var Gl=typeof reportError=="function"?reportError:function(e){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var t=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof e=="object"&&e!==null&&typeof e.message=="string"?String(e.message):String(e),error:e});if(!window.dispatchEvent(t))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",e);return}console.error(e)},Mr=[],_i=0,nd=0;function ql(){for(var e=_i,t=nd=_i=0;t<e;){var r=Mr[t];Mr[t++]=null;var o=Mr[t];Mr[t++]=null;var f=Mr[t];Mr[t++]=null;var g=Mr[t];if(Mr[t++]=null,o!==null&&f!==null){var T=o.pending;T===null?f.next=f:(f.next=T.next,T.next=f),o.pending=f}g!==0&&hm(r,f,g)}}function Pl(e,t,r,o){Mr[_i++]=e,Mr[_i++]=t,Mr[_i++]=r,Mr[_i++]=o,nd|=o,e.lanes|=o,e=e.alternate,e!==null&&(e.lanes|=o)}function rd(e,t,r,o){return Pl(e,t,r,o),Yl(e)}function Hs(e,t){return Pl(e,null,null,t),Yl(e)}function hm(e,t,r){e.lanes|=r;var o=e.alternate;o!==null&&(o.lanes|=r);for(var f=!1,g=e.return;g!==null;)g.childLanes|=r,o=g.alternate,o!==null&&(o.childLanes|=r),g.tag===22&&(e=g.stateNode,e===null||e._visibility&1||(f=!0)),e=g,g=g.return;return e.tag===3?(g=e.stateNode,f&&t!==null&&(f=31-It(r),e=g.hiddenUpdates,o=e[f],o===null?e[f]=[t]:o.push(t),t.lane=r|536870912),g):null}function Yl(e){if(50<qo)throw qo=0,hf=null,Error(i(185));for(var t=e.return;t!==null;)e=t,t=e.return;return e.tag===3?e.stateNode:null}var Si={};function U0(e,t,r,o){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=o,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function gr(e,t,r,o){return new U0(e,t,r,o)}function ad(e){return e=e.prototype,!(!e||!e.isReactComponent)}function Aa(e,t){var r=e.alternate;return r===null?(r=gr(e.tag,t,e.key,e.mode),r.elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=e.flags&65011712,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r.refCleanup=e.refCleanup,r}function mm(e,t){e.flags&=65011714;var r=e.alternate;return r===null?(e.childLanes=0,e.lanes=t,e.child=null,e.subtreeFlags=0,e.memoizedProps=null,e.memoizedState=null,e.updateQueue=null,e.dependencies=null,e.stateNode=null):(e.childLanes=r.childLanes,e.lanes=r.lanes,e.child=r.child,e.subtreeFlags=0,e.deletions=null,e.memoizedProps=r.memoizedProps,e.memoizedState=r.memoizedState,e.updateQueue=r.updateQueue,e.type=r.type,t=r.dependencies,e.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),e}function $l(e,t,r,o,f,g){var T=0;if(o=e,typeof e=="function")ad(e)&&(T=1);else if(typeof e=="string")T=Hx(e,r,oe.current)?26:e==="html"||e==="head"||e==="body"?27:5;else e:switch(e){case O:return e=gr(31,r,t,f),e.elementType=O,e.lanes=g,e;case w:return Gs(r.children,f,g,t);case k:T=8,f|=24;break;case N:return e=gr(12,r,t,f|2),e.elementType=N,e.lanes=g,e;case q:return e=gr(13,r,t,f),e.elementType=q,e.lanes=g,e;case Q:return e=gr(19,r,t,f),e.elementType=Q,e.lanes=g,e;default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case M:T=10;break e;case I:T=9;break e;case F:T=11;break e;case U:T=14;break e;case j:T=16,o=null;break e}T=29,r=Error(i(130,e===null?"null":typeof e,"")),o=null}return t=gr(T,r,t,f),t.elementType=e,t.type=o,t.lanes=g,t}function Gs(e,t,r,o){return e=gr(7,e,o,t),e.lanes=r,e}function sd(e,t,r){return e=gr(6,e,null,t),e.lanes=r,e}function pm(e){var t=gr(18,null,null,0);return t.stateNode=e,t}function id(e,t,r){return t=gr(4,e.children!==null?e.children:[],e.key,t),t.lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}var gm=new WeakMap;function Ur(e,t){if(typeof e=="object"&&e!==null){var r=gm.get(e);return r!==void 0?r:(t={value:e,source:t,stack:P(t)},gm.set(e,t),t)}return{value:e,source:t,stack:P(t)}}var wi=[],Ei=0,Vl=null,So=0,Lr=[],zr=0,ss=null,la=1,ca="";function Na(e,t){wi[Ei++]=So,wi[Ei++]=Vl,Vl=e,So=t}function ym(e,t,r){Lr[zr++]=la,Lr[zr++]=ca,Lr[zr++]=ss,ss=e;var o=la;e=ca;var f=32-It(o)-1;o&=~(1<<f),r+=1;var g=32-It(t)+f;if(30<g){var T=f-f%5;g=(o&(1<<T)-1).toString(32),o>>=T,f-=T,la=1<<32-It(t)+f|r<<f|o,ca=g+e}else la=1<<g|r<<f|o,ca=e}function od(e){e.return!==null&&(Na(e,1),ym(e,1,0))}function ld(e){for(;e===Vl;)Vl=wi[--Ei],wi[Ei]=null,So=wi[--Ei],wi[Ei]=null;for(;e===ss;)ss=Lr[--zr],Lr[zr]=null,ca=Lr[--zr],Lr[zr]=null,la=Lr[--zr],Lr[zr]=null}function vm(e,t){Lr[zr++]=la,Lr[zr++]=ca,Lr[zr++]=ss,la=t.id,ca=t.overflow,ss=e}var Ln=null,tn=null,Ct=!1,is=null,Fr=!1,cd=Error(i(519));function os(e){var t=Error(i(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw wo(Ur(t,e)),cd}function bm(e){var t=e.stateNode,r=e.type,o=e.memoizedProps;switch(t[Bt]=e,t[Rt]=o,r){case"dialog":kt("cancel",t),kt("close",t);break;case"iframe":case"object":case"embed":kt("load",t);break;case"video":case"audio":for(r=0;r<Yo.length;r++)kt(Yo[r],t);break;case"source":kt("error",t);break;case"img":case"image":case"link":kt("error",t),kt("load",t);break;case"details":kt("toggle",t);break;case"input":kt("invalid",t),Xa(t,o.value,o.defaultValue,o.checked,o.defaultChecked,o.type,o.name,!0);break;case"select":kt("invalid",t);break;case"textarea":kt("invalid",t),hi(t,o.value,o.defaultValue,o.children)}r=o.children,typeof r!="string"&&typeof r!="number"&&typeof r!="bigint"||t.textContent===""+r||o.suppressHydrationWarning===!0||Ug(t.textContent,r)?(o.popover!=null&&(kt("beforetoggle",t),kt("toggle",t)),o.onScroll!=null&&kt("scroll",t),o.onScrollEnd!=null&&kt("scrollend",t),o.onClick!=null&&(t.onclick=Tn),t=!0):t=!1,t||os(e,!0)}function xm(e){for(Ln=e.return;Ln;)switch(Ln.tag){case 5:case 31:case 13:Fr=!1;return;case 27:case 3:Fr=!0;return;default:Ln=Ln.return}}function ki(e){if(e!==Ln)return!1;if(!Ct)return xm(e),Ct=!0,!1;var t=e.tag,r;if((r=t!==3&&t!==27)&&((r=t===5)&&(r=e.type,r=!(r!=="form"&&r!=="button")||Nf(e.type,e.memoizedProps)),r=!r),r&&tn&&os(e),xm(e),t===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(i(317));tn=Yg(e)}else if(t===31){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(i(317));tn=Yg(e)}else t===27?(t=tn,_s(e.type)?(e=If,If=null,tn=e):tn=t):tn=Ln?Hr(e.stateNode.nextSibling):null;return!0}function qs(){tn=Ln=null,Ct=!1}function ud(){var e=is;return e!==null&&(lr===null?lr=e:lr.push.apply(lr,e),is=null),e}function wo(e){is===null?is=[e]:is.push(e)}var dd=z(null),Ps=null,Da=null;function ls(e,t,r){re(dd,t._currentValue),t._currentValue=r}function Ca(e){e._currentValue=dd.current,R(dd)}function fd(e,t,r){for(;e!==null;){var o=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,o!==null&&(o.childLanes|=t)):o!==null&&(o.childLanes&t)!==t&&(o.childLanes|=t),e===r)break;e=e.return}}function hd(e,t,r,o){var f=e.child;for(f!==null&&(f.return=e);f!==null;){var g=f.dependencies;if(g!==null){var T=f.child;g=g.firstContext;e:for(;g!==null;){var H=g;g=f;for(var ae=0;ae<t.length;ae++)if(H.context===t[ae]){g.lanes|=r,H=g.alternate,H!==null&&(H.lanes|=r),fd(g.return,r,e),o||(T=null);break e}g=H.next}}else if(f.tag===18){if(T=f.return,T===null)throw Error(i(341));T.lanes|=r,g=T.alternate,g!==null&&(g.lanes|=r),fd(T,r,e),T=null}else T=f.child;if(T!==null)T.return=f;else for(T=f;T!==null;){if(T===e){T=null;break}if(f=T.sibling,f!==null){f.return=T.return,T=f;break}T=T.return}f=T}}function Ti(e,t,r,o){e=null;for(var f=t,g=!1;f!==null;){if(!g){if((f.flags&524288)!==0)g=!0;else if((f.flags&262144)!==0)break}if(f.tag===10){var T=f.alternate;if(T===null)throw Error(i(387));if(T=T.memoizedProps,T!==null){var H=f.type;pr(f.pendingProps.value,T.value)||(e!==null?e.push(H):e=[H])}}else if(f===Me.current){if(T=f.alternate,T===null)throw Error(i(387));T.memoizedState.memoizedState!==f.memoizedState.memoizedState&&(e!==null?e.push(Ko):e=[Ko])}f=f.return}e!==null&&hd(t,e,r,o),t.flags|=262144}function Zl(e){for(e=e.firstContext;e!==null;){if(!pr(e.context._currentValue,e.memoizedValue))return!0;e=e.next}return!1}function Ys(e){Ps=e,Da=null,e=e.dependencies,e!==null&&(e.firstContext=null)}function zn(e){return _m(Ps,e)}function Ql(e,t){return Ps===null&&Ys(e),_m(e,t)}function _m(e,t){var r=t._currentValue;if(t={context:t,memoizedValue:r,next:null},Da===null){if(e===null)throw Error(i(308));Da=t,e.dependencies={lanes:0,firstContext:t},e.flags|=524288}else Da=Da.next=t;return r}var L0=typeof AbortController<"u"?AbortController:function(){var e=[],t=this.signal={aborted:!1,addEventListener:function(r,o){e.push(o)}};this.abort=function(){t.aborted=!0,e.forEach(function(r){return r()})}},z0=n.unstable_scheduleCallback,F0=n.unstable_NormalPriority,Sn={$$typeof:M,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function md(){return{controller:new L0,data:new Map,refCount:0}}function Eo(e){e.refCount--,e.refCount===0&&z0(F0,function(){e.controller.abort()})}var ko=null,pd=0,Ai=0,Ni=null;function B0(e,t){if(ko===null){var r=ko=[];pd=0,Ai=bf(),Ni={status:"pending",value:void 0,then:function(o){r.push(o)}}}return pd++,t.then(Sm,Sm),t}function Sm(){if(--pd===0&&ko!==null){Ni!==null&&(Ni.status="fulfilled");var e=ko;ko=null,Ai=0,Ni=null;for(var t=0;t<e.length;t++)(0,e[t])()}}function H0(e,t){var r=[],o={status:"pending",value:null,reason:null,then:function(f){r.push(f)}};return e.then(function(){o.status="fulfilled",o.value=t;for(var f=0;f<r.length;f++)(0,r[f])(t)},function(f){for(o.status="rejected",o.reason=f,f=0;f<r.length;f++)(0,r[f])(void 0)}),o}var wm=Z.S;Z.S=function(e,t){ig=Oe(),typeof t=="object"&&t!==null&&typeof t.then=="function"&&B0(e,t),wm!==null&&wm(e,t)};var $s=z(null);function gd(){var e=$s.current;return e!==null?e:Kt.pooledCache}function Kl(e,t){t===null?re($s,$s.current):re($s,t.pool)}function Em(){var e=gd();return e===null?null:{parent:Sn._currentValue,pool:e}}var Di=Error(i(460)),yd=Error(i(474)),Jl=Error(i(542)),Xl={then:function(){}};function km(e){return e=e.status,e==="fulfilled"||e==="rejected"}function Tm(e,t,r){switch(r=e[r],r===void 0?e.push(t):r!==t&&(t.then(Tn,Tn),t=r),t.status){case"fulfilled":return t.value;case"rejected":throw e=t.reason,Nm(e),e;default:if(typeof t.status=="string")t.then(Tn,Tn);else{if(e=Kt,e!==null&&100<e.shellSuspendCounter)throw Error(i(482));e=t,e.status="pending",e.then(function(o){if(t.status==="pending"){var f=t;f.status="fulfilled",f.value=o}},function(o){if(t.status==="pending"){var f=t;f.status="rejected",f.reason=o}})}switch(t.status){case"fulfilled":return t.value;case"rejected":throw e=t.reason,Nm(e),e}throw Zs=t,Di}}function Vs(e){try{var t=e._init;return t(e._payload)}catch(r){throw r!==null&&typeof r=="object"&&typeof r.then=="function"?(Zs=r,Di):r}}var Zs=null;function Am(){if(Zs===null)throw Error(i(459));var e=Zs;return Zs=null,e}function Nm(e){if(e===Di||e===Jl)throw Error(i(483))}var Ci=null,To=0;function Wl(e){var t=To;return To+=1,Ci===null&&(Ci=[]),Tm(Ci,e,t)}function Ao(e,t){t=t.props.ref,e.ref=t!==void 0?t:null}function ec(e,t){throw t.$$typeof===A?Error(i(525)):(e=Object.prototype.toString.call(t),Error(i(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)))}function Dm(e){function t(pe,ce){if(e){var _e=pe.deletions;_e===null?(pe.deletions=[ce],pe.flags|=16):_e.push(ce)}}function r(pe,ce){if(!e)return null;for(;ce!==null;)t(pe,ce),ce=ce.sibling;return null}function o(pe){for(var ce=new Map;pe!==null;)pe.key!==null?ce.set(pe.key,pe):ce.set(pe.index,pe),pe=pe.sibling;return ce}function f(pe,ce){return pe=Aa(pe,ce),pe.index=0,pe.sibling=null,pe}function g(pe,ce,_e){return pe.index=_e,e?(_e=pe.alternate,_e!==null?(_e=_e.index,_e<ce?(pe.flags|=67108866,ce):_e):(pe.flags|=67108866,ce)):(pe.flags|=1048576,ce)}function T(pe){return e&&pe.alternate===null&&(pe.flags|=67108866),pe}function H(pe,ce,_e,Ie){return ce===null||ce.tag!==6?(ce=sd(_e,pe.mode,Ie),ce.return=pe,ce):(ce=f(ce,_e),ce.return=pe,ce)}function ae(pe,ce,_e,Ie){var rt=_e.type;return rt===w?De(pe,ce,_e.props.children,Ie,_e.key):ce!==null&&(ce.elementType===rt||typeof rt=="object"&&rt!==null&&rt.$$typeof===j&&Vs(rt)===ce.type)?(ce=f(ce,_e.props),Ao(ce,_e),ce.return=pe,ce):(ce=$l(_e.type,_e.key,_e.props,null,pe.mode,Ie),Ao(ce,_e),ce.return=pe,ce)}function Se(pe,ce,_e,Ie){return ce===null||ce.tag!==4||ce.stateNode.containerInfo!==_e.containerInfo||ce.stateNode.implementation!==_e.implementation?(ce=id(_e,pe.mode,Ie),ce.return=pe,ce):(ce=f(ce,_e.children||[]),ce.return=pe,ce)}function De(pe,ce,_e,Ie,rt){return ce===null||ce.tag!==7?(ce=Gs(_e,pe.mode,Ie,rt),ce.return=pe,ce):(ce=f(ce,_e),ce.return=pe,ce)}function Re(pe,ce,_e){if(typeof ce=="string"&&ce!==""||typeof ce=="number"||typeof ce=="bigint")return ce=sd(""+ce,pe.mode,_e),ce.return=pe,ce;if(typeof ce=="object"&&ce!==null){switch(ce.$$typeof){case _:return _e=$l(ce.type,ce.key,ce.props,null,pe.mode,_e),Ao(_e,ce),_e.return=pe,_e;case E:return ce=id(ce,pe.mode,_e),ce.return=pe,ce;case j:return ce=Vs(ce),Re(pe,ce,_e)}if(ie(ce)||L(ce))return ce=Gs(ce,pe.mode,_e,null),ce.return=pe,ce;if(typeof ce.then=="function")return Re(pe,Wl(ce),_e);if(ce.$$typeof===M)return Re(pe,Ql(pe,ce),_e);ec(pe,ce)}return null}function we(pe,ce,_e,Ie){var rt=ce!==null?ce.key:null;if(typeof _e=="string"&&_e!==""||typeof _e=="number"||typeof _e=="bigint")return rt!==null?null:H(pe,ce,""+_e,Ie);if(typeof _e=="object"&&_e!==null){switch(_e.$$typeof){case _:return _e.key===rt?ae(pe,ce,_e,Ie):null;case E:return _e.key===rt?Se(pe,ce,_e,Ie):null;case j:return _e=Vs(_e),we(pe,ce,_e,Ie)}if(ie(_e)||L(_e))return rt!==null?null:De(pe,ce,_e,Ie,null);if(typeof _e.then=="function")return we(pe,ce,Wl(_e),Ie);if(_e.$$typeof===M)return we(pe,ce,Ql(pe,_e),Ie);ec(pe,_e)}return null}function Ae(pe,ce,_e,Ie,rt){if(typeof Ie=="string"&&Ie!==""||typeof Ie=="number"||typeof Ie=="bigint")return pe=pe.get(_e)||null,H(ce,pe,""+Ie,rt);if(typeof Ie=="object"&&Ie!==null){switch(Ie.$$typeof){case _:return pe=pe.get(Ie.key===null?_e:Ie.key)||null,ae(ce,pe,Ie,rt);case E:return pe=pe.get(Ie.key===null?_e:Ie.key)||null,Se(ce,pe,Ie,rt);case j:return Ie=Vs(Ie),Ae(pe,ce,_e,Ie,rt)}if(ie(Ie)||L(Ie))return pe=pe.get(_e)||null,De(ce,pe,Ie,rt,null);if(typeof Ie.then=="function")return Ae(pe,ce,_e,Wl(Ie),rt);if(Ie.$$typeof===M)return Ae(pe,ce,_e,Ql(ce,Ie),rt);ec(ce,Ie)}return null}function Je(pe,ce,_e,Ie){for(var rt=null,Mt=null,et=ce,vt=ce=0,Nt=null;et!==null&&vt<_e.length;vt++){et.index>vt?(Nt=et,et=null):Nt=et.sibling;var Ut=we(pe,et,_e[vt],Ie);if(Ut===null){et===null&&(et=Nt);break}e&&et&&Ut.alternate===null&&t(pe,et),ce=g(Ut,ce,vt),Mt===null?rt=Ut:Mt.sibling=Ut,Mt=Ut,et=Nt}if(vt===_e.length)return r(pe,et),Ct&&Na(pe,vt),rt;if(et===null){for(;vt<_e.length;vt++)et=Re(pe,_e[vt],Ie),et!==null&&(ce=g(et,ce,vt),Mt===null?rt=et:Mt.sibling=et,Mt=et);return Ct&&Na(pe,vt),rt}for(et=o(et);vt<_e.length;vt++)Nt=Ae(et,pe,vt,_e[vt],Ie),Nt!==null&&(e&&Nt.alternate!==null&&et.delete(Nt.key===null?vt:Nt.key),ce=g(Nt,ce,vt),Mt===null?rt=Nt:Mt.sibling=Nt,Mt=Nt);return e&&et.forEach(function(Ts){return t(pe,Ts)}),Ct&&Na(pe,vt),rt}function lt(pe,ce,_e,Ie){if(_e==null)throw Error(i(151));for(var rt=null,Mt=null,et=ce,vt=ce=0,Nt=null,Ut=_e.next();et!==null&&!Ut.done;vt++,Ut=_e.next()){et.index>vt?(Nt=et,et=null):Nt=et.sibling;var Ts=we(pe,et,Ut.value,Ie);if(Ts===null){et===null&&(et=Nt);break}e&&et&&Ts.alternate===null&&t(pe,et),ce=g(Ts,ce,vt),Mt===null?rt=Ts:Mt.sibling=Ts,Mt=Ts,et=Nt}if(Ut.done)return r(pe,et),Ct&&Na(pe,vt),rt;if(et===null){for(;!Ut.done;vt++,Ut=_e.next())Ut=Re(pe,Ut.value,Ie),Ut!==null&&(ce=g(Ut,ce,vt),Mt===null?rt=Ut:Mt.sibling=Ut,Mt=Ut);return Ct&&Na(pe,vt),rt}for(et=o(et);!Ut.done;vt++,Ut=_e.next())Ut=Ae(et,pe,vt,Ut.value,Ie),Ut!==null&&(e&&Ut.alternate!==null&&et.delete(Ut.key===null?vt:Ut.key),ce=g(Ut,ce,vt),Mt===null?rt=Ut:Mt.sibling=Ut,Mt=Ut);return e&&et.forEach(function(Xx){return t(pe,Xx)}),Ct&&Na(pe,vt),rt}function Vt(pe,ce,_e,Ie){if(typeof _e=="object"&&_e!==null&&_e.type===w&&_e.key===null&&(_e=_e.props.children),typeof _e=="object"&&_e!==null){switch(_e.$$typeof){case _:e:{for(var rt=_e.key;ce!==null;){if(ce.key===rt){if(rt=_e.type,rt===w){if(ce.tag===7){r(pe,ce.sibling),Ie=f(ce,_e.props.children),Ie.return=pe,pe=Ie;break e}}else if(ce.elementType===rt||typeof rt=="object"&&rt!==null&&rt.$$typeof===j&&Vs(rt)===ce.type){r(pe,ce.sibling),Ie=f(ce,_e.props),Ao(Ie,_e),Ie.return=pe,pe=Ie;break e}r(pe,ce);break}else t(pe,ce);ce=ce.sibling}_e.type===w?(Ie=Gs(_e.props.children,pe.mode,Ie,_e.key),Ie.return=pe,pe=Ie):(Ie=$l(_e.type,_e.key,_e.props,null,pe.mode,Ie),Ao(Ie,_e),Ie.return=pe,pe=Ie)}return T(pe);case E:e:{for(rt=_e.key;ce!==null;){if(ce.key===rt)if(ce.tag===4&&ce.stateNode.containerInfo===_e.containerInfo&&ce.stateNode.implementation===_e.implementation){r(pe,ce.sibling),Ie=f(ce,_e.children||[]),Ie.return=pe,pe=Ie;break e}else{r(pe,ce);break}else t(pe,ce);ce=ce.sibling}Ie=id(_e,pe.mode,Ie),Ie.return=pe,pe=Ie}return T(pe);case j:return _e=Vs(_e),Vt(pe,ce,_e,Ie)}if(ie(_e))return Je(pe,ce,_e,Ie);if(L(_e)){if(rt=L(_e),typeof rt!="function")throw Error(i(150));return _e=rt.call(_e),lt(pe,ce,_e,Ie)}if(typeof _e.then=="function")return Vt(pe,ce,Wl(_e),Ie);if(_e.$$typeof===M)return Vt(pe,ce,Ql(pe,_e),Ie);ec(pe,_e)}return typeof _e=="string"&&_e!==""||typeof _e=="number"||typeof _e=="bigint"?(_e=""+_e,ce!==null&&ce.tag===6?(r(pe,ce.sibling),Ie=f(ce,_e),Ie.return=pe,pe=Ie):(r(pe,ce),Ie=sd(_e,pe.mode,Ie),Ie.return=pe,pe=Ie),T(pe)):r(pe,ce)}return function(pe,ce,_e,Ie){try{To=0;var rt=Vt(pe,ce,_e,Ie);return Ci=null,rt}catch(et){if(et===Di||et===Jl)throw et;var Mt=gr(29,et,null,pe.mode);return Mt.lanes=Ie,Mt.return=pe,Mt}finally{}}}var Qs=Dm(!0),Cm=Dm(!1),cs=!1;function vd(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function bd(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,callbacks:null})}function us(e){return{lane:e,tag:0,payload:null,callback:null,next:null}}function ds(e,t,r){var o=e.updateQueue;if(o===null)return null;if(o=o.shared,(Lt&2)!==0){var f=o.pending;return f===null?t.next=t:(t.next=f.next,f.next=t),o.pending=t,t=Yl(e),hm(e,null,r),t}return Pl(e,o,t,r),Yl(e)}function No(e,t,r){if(t=t.updateQueue,t!==null&&(t=t.shared,(r&4194048)!==0)){var o=t.lanes;o&=e.pendingLanes,r|=o,t.lanes=r,Dr(e,r)}}function xd(e,t){var r=e.updateQueue,o=e.alternate;if(o!==null&&(o=o.updateQueue,r===o)){var f=null,g=null;if(r=r.firstBaseUpdate,r!==null){do{var T={lane:r.lane,tag:r.tag,payload:r.payload,callback:null,next:null};g===null?f=g=T:g=g.next=T,r=r.next}while(r!==null);g===null?f=g=t:g=g.next=t}else f=g=t;r={baseState:o.baseState,firstBaseUpdate:f,lastBaseUpdate:g,shared:o.shared,callbacks:o.callbacks},e.updateQueue=r;return}e=r.lastBaseUpdate,e===null?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}var _d=!1;function Do(){if(_d){var e=Ni;if(e!==null)throw e}}function Co(e,t,r,o){_d=!1;var f=e.updateQueue;cs=!1;var g=f.firstBaseUpdate,T=f.lastBaseUpdate,H=f.shared.pending;if(H!==null){f.shared.pending=null;var ae=H,Se=ae.next;ae.next=null,T===null?g=Se:T.next=Se,T=ae;var De=e.alternate;De!==null&&(De=De.updateQueue,H=De.lastBaseUpdate,H!==T&&(H===null?De.firstBaseUpdate=Se:H.next=Se,De.lastBaseUpdate=ae))}if(g!==null){var Re=f.baseState;T=0,De=Se=ae=null,H=g;do{var we=H.lane&-536870913,Ae=we!==H.lane;if(Ae?(At&we)===we:(o&we)===we){we!==0&&we===Ai&&(_d=!0),De!==null&&(De=De.next={lane:0,tag:H.tag,payload:H.payload,callback:null,next:null});e:{var Je=e,lt=H;we=t;var Vt=r;switch(lt.tag){case 1:if(Je=lt.payload,typeof Je=="function"){Re=Je.call(Vt,Re,we);break e}Re=Je;break e;case 3:Je.flags=Je.flags&-65537|128;case 0:if(Je=lt.payload,we=typeof Je=="function"?Je.call(Vt,Re,we):Je,we==null)break e;Re=S({},Re,we);break e;case 2:cs=!0}}we=H.callback,we!==null&&(e.flags|=64,Ae&&(e.flags|=8192),Ae=f.callbacks,Ae===null?f.callbacks=[we]:Ae.push(we))}else Ae={lane:we,tag:H.tag,payload:H.payload,callback:H.callback,next:null},De===null?(Se=De=Ae,ae=Re):De=De.next=Ae,T|=we;if(H=H.next,H===null){if(H=f.shared.pending,H===null)break;Ae=H,H=Ae.next,Ae.next=null,f.lastBaseUpdate=Ae,f.shared.pending=null}}while(!0);De===null&&(ae=Re),f.baseState=ae,f.firstBaseUpdate=Se,f.lastBaseUpdate=De,g===null&&(f.shared.lanes=0),gs|=T,e.lanes=T,e.memoizedState=Re}}function Om(e,t){if(typeof e!="function")throw Error(i(191,e));e.call(t)}function jm(e,t){var r=e.callbacks;if(r!==null)for(e.callbacks=null,e=0;e<r.length;e++)Om(r[e],t)}var Oi=z(null),tc=z(0);function Im(e,t){e=Fa,re(tc,e),re(Oi,t),Fa=e|t.baseLanes}function Sd(){re(tc,Fa),re(Oi,Oi.current)}function wd(){Fa=tc.current,R(Oi),R(tc)}var yr=z(null),Br=null;function fs(e){var t=e.alternate;re(yn,yn.current&1),re(yr,e),Br===null&&(t===null||Oi.current!==null||t.memoizedState!==null)&&(Br=e)}function Ed(e){re(yn,yn.current),re(yr,e),Br===null&&(Br=e)}function Rm(e){e.tag===22?(re(yn,yn.current),re(yr,e),Br===null&&(Br=e)):hs()}function hs(){re(yn,yn.current),re(yr,yr.current)}function vr(e){R(yr),Br===e&&(Br=null),R(yn)}var yn=z(0);function nc(e){for(var t=e;t!==null;){if(t.tag===13){var r=t.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||Of(r)||jf(r)))return t}else if(t.tag===19&&(t.memoizedProps.revealOrder==="forwards"||t.memoizedProps.revealOrder==="backwards"||t.memoizedProps.revealOrder==="unstable_legacy-backwards"||t.memoizedProps.revealOrder==="together")){if((t.flags&128)!==0)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var Oa=0,gt=null,Yt=null,wn=null,rc=!1,ji=!1,Ks=!1,ac=0,Oo=0,Ii=null,G0=0;function fn(){throw Error(i(321))}function kd(e,t){if(t===null)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!pr(e[r],t[r]))return!1;return!0}function Td(e,t,r,o,f,g){return Oa=g,gt=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,Z.H=e===null||e.memoizedState===null?yp:Hd,Ks=!1,g=r(o,f),Ks=!1,ji&&(g=Um(t,r,o,f)),Mm(e),g}function Mm(e){Z.H=Ro;var t=Yt!==null&&Yt.next!==null;if(Oa=0,wn=Yt=gt=null,rc=!1,Oo=0,Ii=null,t)throw Error(i(300));e===null||En||(e=e.dependencies,e!==null&&Zl(e)&&(En=!0))}function Um(e,t,r,o){gt=e;var f=0;do{if(ji&&(Ii=null),Oo=0,ji=!1,25<=f)throw Error(i(301));if(f+=1,wn=Yt=null,e.updateQueue!=null){var g=e.updateQueue;g.lastEffect=null,g.events=null,g.stores=null,g.memoCache!=null&&(g.memoCache.index=0)}Z.H=vp,g=t(r,o)}while(ji);return g}function q0(){var e=Z.H,t=e.useState()[0];return t=typeof t.then=="function"?jo(t):t,e=e.useState()[0],(Yt!==null?Yt.memoizedState:null)!==e&&(gt.flags|=1024),t}function Ad(){var e=ac!==0;return ac=0,e}function Nd(e,t,r){t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~r}function Dd(e){if(rc){for(e=e.memoizedState;e!==null;){var t=e.queue;t!==null&&(t.pending=null),e=e.next}rc=!1}Oa=0,wn=Yt=gt=null,ji=!1,Oo=ac=0,Ii=null}function Jn(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return wn===null?gt.memoizedState=wn=e:wn=wn.next=e,wn}function vn(){if(Yt===null){var e=gt.alternate;e=e!==null?e.memoizedState:null}else e=Yt.next;var t=wn===null?gt.memoizedState:wn.next;if(t!==null)wn=t,Yt=e;else{if(e===null)throw gt.alternate===null?Error(i(467)):Error(i(310));Yt=e,e={memoizedState:Yt.memoizedState,baseState:Yt.baseState,baseQueue:Yt.baseQueue,queue:Yt.queue,next:null},wn===null?gt.memoizedState=wn=e:wn=wn.next=e}return wn}function sc(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function jo(e){var t=Oo;return Oo+=1,Ii===null&&(Ii=[]),e=Tm(Ii,e,t),t=gt,(wn===null?t.memoizedState:wn.next)===null&&(t=t.alternate,Z.H=t===null||t.memoizedState===null?yp:Hd),e}function ic(e){if(e!==null&&typeof e=="object"){if(typeof e.then=="function")return jo(e);if(e.$$typeof===M)return zn(e)}throw Error(i(438,String(e)))}function Cd(e){var t=null,r=gt.updateQueue;if(r!==null&&(t=r.memoCache),t==null){var o=gt.alternate;o!==null&&(o=o.updateQueue,o!==null&&(o=o.memoCache,o!=null&&(t={data:o.data.map(function(f){return f.slice()}),index:0})))}if(t==null&&(t={data:[],index:0}),r===null&&(r=sc(),gt.updateQueue=r),r.memoCache=t,r=t.data[t.index],r===void 0)for(r=t.data[t.index]=Array(e),o=0;o<e;o++)r[o]=B;return t.index++,r}function ja(e,t){return typeof t=="function"?t(e):t}function oc(e){var t=vn();return Od(t,Yt,e)}function Od(e,t,r){var o=e.queue;if(o===null)throw Error(i(311));o.lastRenderedReducer=r;var f=e.baseQueue,g=o.pending;if(g!==null){if(f!==null){var T=f.next;f.next=g.next,g.next=T}t.baseQueue=f=g,o.pending=null}if(g=e.baseState,f===null)e.memoizedState=g;else{t=f.next;var H=T=null,ae=null,Se=t,De=!1;do{var Re=Se.lane&-536870913;if(Re!==Se.lane?(At&Re)===Re:(Oa&Re)===Re){var we=Se.revertLane;if(we===0)ae!==null&&(ae=ae.next={lane:0,revertLane:0,gesture:null,action:Se.action,hasEagerState:Se.hasEagerState,eagerState:Se.eagerState,next:null}),Re===Ai&&(De=!0);else if((Oa&we)===we){Se=Se.next,we===Ai&&(De=!0);continue}else Re={lane:0,revertLane:Se.revertLane,gesture:null,action:Se.action,hasEagerState:Se.hasEagerState,eagerState:Se.eagerState,next:null},ae===null?(H=ae=Re,T=g):ae=ae.next=Re,gt.lanes|=we,gs|=we;Re=Se.action,Ks&&r(g,Re),g=Se.hasEagerState?Se.eagerState:r(g,Re)}else we={lane:Re,revertLane:Se.revertLane,gesture:Se.gesture,action:Se.action,hasEagerState:Se.hasEagerState,eagerState:Se.eagerState,next:null},ae===null?(H=ae=we,T=g):ae=ae.next=we,gt.lanes|=Re,gs|=Re;Se=Se.next}while(Se!==null&&Se!==t);if(ae===null?T=g:ae.next=H,!pr(g,e.memoizedState)&&(En=!0,De&&(r=Ni,r!==null)))throw r;e.memoizedState=g,e.baseState=T,e.baseQueue=ae,o.lastRenderedState=g}return f===null&&(o.lanes=0),[e.memoizedState,o.dispatch]}function jd(e){var t=vn(),r=t.queue;if(r===null)throw Error(i(311));r.lastRenderedReducer=e;var o=r.dispatch,f=r.pending,g=t.memoizedState;if(f!==null){r.pending=null;var T=f=f.next;do g=e(g,T.action),T=T.next;while(T!==f);pr(g,t.memoizedState)||(En=!0),t.memoizedState=g,t.baseQueue===null&&(t.baseState=g),r.lastRenderedState=g}return[g,o]}function Lm(e,t,r){var o=gt,f=vn(),g=Ct;if(g){if(r===void 0)throw Error(i(407));r=r()}else r=t();var T=!pr((Yt||f).memoizedState,r);if(T&&(f.memoizedState=r,En=!0),f=f.queue,Md(Bm.bind(null,o,f,e),[e]),f.getSnapshot!==t||T||wn!==null&&wn.memoizedState.tag&1){if(o.flags|=2048,Ri(9,{destroy:void 0},Fm.bind(null,o,f,r,t),null),Kt===null)throw Error(i(349));g||(Oa&127)!==0||zm(o,t,r)}return r}function zm(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},t=gt.updateQueue,t===null?(t=sc(),gt.updateQueue=t,t.stores=[e]):(r=t.stores,r===null?t.stores=[e]:r.push(e))}function Fm(e,t,r,o){t.value=r,t.getSnapshot=o,Hm(t)&&Gm(e)}function Bm(e,t,r){return r(function(){Hm(t)&&Gm(e)})}function Hm(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!pr(e,r)}catch{return!0}}function Gm(e){var t=Hs(e,2);t!==null&&cr(t,e,2)}function Id(e){var t=Jn();if(typeof e=="function"){var r=e;if(e=r(),Ks){pn(!0);try{r()}finally{pn(!1)}}}return t.memoizedState=t.baseState=e,t.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:ja,lastRenderedState:e},t}function qm(e,t,r,o){return e.baseState=r,Od(e,Yt,typeof o=="function"?o:ja)}function P0(e,t,r,o,f){if(uc(e))throw Error(i(485));if(e=t.action,e!==null){var g={payload:f,action:e,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(T){g.listeners.push(T)}};Z.T!==null?r(!0):g.isTransition=!1,o(g),r=t.pending,r===null?(g.next=t.pending=g,Pm(t,g)):(g.next=r.next,t.pending=r.next=g)}}function Pm(e,t){var r=t.action,o=t.payload,f=e.state;if(t.isTransition){var g=Z.T,T={};Z.T=T;try{var H=r(f,o),ae=Z.S;ae!==null&&ae(T,H),Ym(e,t,H)}catch(Se){Rd(e,t,Se)}finally{g!==null&&T.types!==null&&(g.types=T.types),Z.T=g}}else try{g=r(f,o),Ym(e,t,g)}catch(Se){Rd(e,t,Se)}}function Ym(e,t,r){r!==null&&typeof r=="object"&&typeof r.then=="function"?r.then(function(o){$m(e,t,o)},function(o){return Rd(e,t,o)}):$m(e,t,r)}function $m(e,t,r){t.status="fulfilled",t.value=r,Vm(t),e.state=r,t=e.pending,t!==null&&(r=t.next,r===t?e.pending=null:(r=r.next,t.next=r,Pm(e,r)))}function Rd(e,t,r){var o=e.pending;if(e.pending=null,o!==null){o=o.next;do t.status="rejected",t.reason=r,Vm(t),t=t.next;while(t!==o)}e.action=null}function Vm(e){e=e.listeners;for(var t=0;t<e.length;t++)(0,e[t])()}function Zm(e,t){return t}function Qm(e,t){if(Ct){var r=Kt.formState;if(r!==null){e:{var o=gt;if(Ct){if(tn){t:{for(var f=tn,g=Fr;f.nodeType!==8;){if(!g){f=null;break t}if(f=Hr(f.nextSibling),f===null){f=null;break t}}g=f.data,f=g==="F!"||g==="F"?f:null}if(f){tn=Hr(f.nextSibling),o=f.data==="F!";break e}}os(o)}o=!1}o&&(t=r[0])}}return r=Jn(),r.memoizedState=r.baseState=t,o={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Zm,lastRenderedState:t},r.queue=o,r=mp.bind(null,gt,o),o.dispatch=r,o=Id(!1),g=Bd.bind(null,gt,!1,o.queue),o=Jn(),f={state:t,dispatch:null,action:e,pending:null},o.queue=f,r=P0.bind(null,gt,f,g,r),f.dispatch=r,o.memoizedState=e,[t,r,!1]}function Km(e){var t=vn();return Jm(t,Yt,e)}function Jm(e,t,r){if(t=Od(e,t,Zm)[0],e=oc(ja)[0],typeof t=="object"&&t!==null&&typeof t.then=="function")try{var o=jo(t)}catch(T){throw T===Di?Jl:T}else o=t;t=vn();var f=t.queue,g=f.dispatch;return r!==t.memoizedState&&(gt.flags|=2048,Ri(9,{destroy:void 0},Y0.bind(null,f,r),null)),[o,g,e]}function Y0(e,t){e.action=t}function Xm(e){var t=vn(),r=Yt;if(r!==null)return Jm(t,r,e);vn(),t=t.memoizedState,r=vn();var o=r.queue.dispatch;return r.memoizedState=e,[t,o,!1]}function Ri(e,t,r,o){return e={tag:e,create:r,deps:o,inst:t,next:null},t=gt.updateQueue,t===null&&(t=sc(),gt.updateQueue=t),r=t.lastEffect,r===null?t.lastEffect=e.next=e:(o=r.next,r.next=e,e.next=o,t.lastEffect=e),e}function Wm(){return vn().memoizedState}function lc(e,t,r,o){var f=Jn();gt.flags|=e,f.memoizedState=Ri(1|t,{destroy:void 0},r,o===void 0?null:o)}function cc(e,t,r,o){var f=vn();o=o===void 0?null:o;var g=f.memoizedState.inst;Yt!==null&&o!==null&&kd(o,Yt.memoizedState.deps)?f.memoizedState=Ri(t,g,r,o):(gt.flags|=e,f.memoizedState=Ri(1|t,g,r,o))}function ep(e,t){lc(8390656,8,e,t)}function Md(e,t){cc(2048,8,e,t)}function $0(e){gt.flags|=4;var t=gt.updateQueue;if(t===null)t=sc(),gt.updateQueue=t,t.events=[e];else{var r=t.events;r===null?t.events=[e]:r.push(e)}}function tp(e){var t=vn().memoizedState;return $0({ref:t,nextImpl:e}),function(){if((Lt&2)!==0)throw Error(i(440));return t.impl.apply(void 0,arguments)}}function np(e,t){return cc(4,2,e,t)}function rp(e,t){return cc(4,4,e,t)}function ap(e,t){if(typeof t=="function"){e=e();var r=t(e);return function(){typeof r=="function"?r():t(null)}}if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function sp(e,t,r){r=r!=null?r.concat([e]):null,cc(4,4,ap.bind(null,t,e),r)}function Ud(){}function ip(e,t){var r=vn();t=t===void 0?null:t;var o=r.memoizedState;return t!==null&&kd(t,o[1])?o[0]:(r.memoizedState=[e,t],e)}function op(e,t){var r=vn();t=t===void 0?null:t;var o=r.memoizedState;if(t!==null&&kd(t,o[1]))return o[0];if(o=e(),Ks){pn(!0);try{e()}finally{pn(!1)}}return r.memoizedState=[o,t],o}function Ld(e,t,r){return r===void 0||(Oa&1073741824)!==0&&(At&261930)===0?e.memoizedState=t:(e.memoizedState=r,e=lg(),gt.lanes|=e,gs|=e,r)}function lp(e,t,r,o){return pr(r,t)?r:Oi.current!==null?(e=Ld(e,r,o),pr(e,t)||(En=!0),e):(Oa&42)===0||(Oa&1073741824)!==0&&(At&261930)===0?(En=!0,e.memoizedState=r):(e=lg(),gt.lanes|=e,gs|=e,t)}function cp(e,t,r,o,f){var g=Y.p;Y.p=g!==0&&8>g?g:8;var T=Z.T,H={};Z.T=H,Bd(e,!1,t,r);try{var ae=f(),Se=Z.S;if(Se!==null&&Se(H,ae),ae!==null&&typeof ae=="object"&&typeof ae.then=="function"){var De=H0(ae,o);Io(e,t,De,_r(e))}else Io(e,t,o,_r(e))}catch(Re){Io(e,t,{then:function(){},status:"rejected",reason:Re},_r())}finally{Y.p=g,T!==null&&H.types!==null&&(T.types=H.types),Z.T=T}}function V0(){}function zd(e,t,r,o){if(e.tag!==5)throw Error(i(476));var f=up(e).queue;cp(e,f,t,me,r===null?V0:function(){return dp(e),r(o)})}function up(e){var t=e.memoizedState;if(t!==null)return t;t={memoizedState:me,baseState:me,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:ja,lastRenderedState:me},next:null};var r={};return t.next={memoizedState:r,baseState:r,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:ja,lastRenderedState:r},next:null},e.memoizedState=t,e=e.alternate,e!==null&&(e.memoizedState=t),t}function dp(e){var t=up(e);t.next===null&&(t=e.alternate.memoizedState),Io(e,t.next.queue,{},_r())}function Fd(){return zn(Ko)}function fp(){return vn().memoizedState}function hp(){return vn().memoizedState}function Z0(e){for(var t=e.return;t!==null;){switch(t.tag){case 24:case 3:var r=_r();e=us(r);var o=ds(t,e,r);o!==null&&(cr(o,t,r),No(o,t,r)),t={cache:md()},e.payload=t;return}t=t.return}}function Q0(e,t,r){var o=_r();r={lane:o,revertLane:0,gesture:null,action:r,hasEagerState:!1,eagerState:null,next:null},uc(e)?pp(t,r):(r=rd(e,t,r,o),r!==null&&(cr(r,e,o),gp(r,t,o)))}function mp(e,t,r){var o=_r();Io(e,t,r,o)}function Io(e,t,r,o){var f={lane:o,revertLane:0,gesture:null,action:r,hasEagerState:!1,eagerState:null,next:null};if(uc(e))pp(t,f);else{var g=e.alternate;if(e.lanes===0&&(g===null||g.lanes===0)&&(g=t.lastRenderedReducer,g!==null))try{var T=t.lastRenderedState,H=g(T,r);if(f.hasEagerState=!0,f.eagerState=H,pr(H,T))return Pl(e,t,f,0),Kt===null&&ql(),!1}catch{}finally{}if(r=rd(e,t,f,o),r!==null)return cr(r,e,o),gp(r,t,o),!0}return!1}function Bd(e,t,r,o){if(o={lane:2,revertLane:bf(),gesture:null,action:o,hasEagerState:!1,eagerState:null,next:null},uc(e)){if(t)throw Error(i(479))}else t=rd(e,r,o,2),t!==null&&cr(t,e,2)}function uc(e){var t=e.alternate;return e===gt||t!==null&&t===gt}function pp(e,t){ji=rc=!0;var r=e.pending;r===null?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function gp(e,t,r){if((r&4194048)!==0){var o=t.lanes;o&=e.pendingLanes,r|=o,t.lanes=r,Dr(e,r)}}var Ro={readContext:zn,use:ic,useCallback:fn,useContext:fn,useEffect:fn,useImperativeHandle:fn,useLayoutEffect:fn,useInsertionEffect:fn,useMemo:fn,useReducer:fn,useRef:fn,useState:fn,useDebugValue:fn,useDeferredValue:fn,useTransition:fn,useSyncExternalStore:fn,useId:fn,useHostTransitionStatus:fn,useFormState:fn,useActionState:fn,useOptimistic:fn,useMemoCache:fn,useCacheRefresh:fn};Ro.useEffectEvent=fn;var yp={readContext:zn,use:ic,useCallback:function(e,t){return Jn().memoizedState=[e,t===void 0?null:t],e},useContext:zn,useEffect:ep,useImperativeHandle:function(e,t,r){r=r!=null?r.concat([e]):null,lc(4194308,4,ap.bind(null,t,e),r)},useLayoutEffect:function(e,t){return lc(4194308,4,e,t)},useInsertionEffect:function(e,t){lc(4,2,e,t)},useMemo:function(e,t){var r=Jn();t=t===void 0?null:t;var o=e();if(Ks){pn(!0);try{e()}finally{pn(!1)}}return r.memoizedState=[o,t],o},useReducer:function(e,t,r){var o=Jn();if(r!==void 0){var f=r(t);if(Ks){pn(!0);try{r(t)}finally{pn(!1)}}}else f=t;return o.memoizedState=o.baseState=f,e={pending:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:f},o.queue=e,e=e.dispatch=Q0.bind(null,gt,e),[o.memoizedState,e]},useRef:function(e){var t=Jn();return e={current:e},t.memoizedState=e},useState:function(e){e=Id(e);var t=e.queue,r=mp.bind(null,gt,t);return t.dispatch=r,[e.memoizedState,r]},useDebugValue:Ud,useDeferredValue:function(e,t){var r=Jn();return Ld(r,e,t)},useTransition:function(){var e=Id(!1);return e=cp.bind(null,gt,e.queue,!0,!1),Jn().memoizedState=e,[!1,e]},useSyncExternalStore:function(e,t,r){var o=gt,f=Jn();if(Ct){if(r===void 0)throw Error(i(407));r=r()}else{if(r=t(),Kt===null)throw Error(i(349));(At&127)!==0||zm(o,t,r)}f.memoizedState=r;var g={value:r,getSnapshot:t};return f.queue=g,ep(Bm.bind(null,o,g,e),[e]),o.flags|=2048,Ri(9,{destroy:void 0},Fm.bind(null,o,g,r,t),null),r},useId:function(){var e=Jn(),t=Kt.identifierPrefix;if(Ct){var r=ca,o=la;r=(o&~(1<<32-It(o)-1)).toString(32)+r,t="_"+t+"R_"+r,r=ac++,0<r&&(t+="H"+r.toString(32)),t+="_"}else r=G0++,t="_"+t+"r_"+r.toString(32)+"_";return e.memoizedState=t},useHostTransitionStatus:Fd,useFormState:Qm,useActionState:Qm,useOptimistic:function(e){var t=Jn();t.memoizedState=t.baseState=e;var r={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return t.queue=r,t=Bd.bind(null,gt,!0,r),r.dispatch=t,[e,t]},useMemoCache:Cd,useCacheRefresh:function(){return Jn().memoizedState=Z0.bind(null,gt)},useEffectEvent:function(e){var t=Jn(),r={impl:e};return t.memoizedState=r,function(){if((Lt&2)!==0)throw Error(i(440));return r.impl.apply(void 0,arguments)}}},Hd={readContext:zn,use:ic,useCallback:ip,useContext:zn,useEffect:Md,useImperativeHandle:sp,useInsertionEffect:np,useLayoutEffect:rp,useMemo:op,useReducer:oc,useRef:Wm,useState:function(){return oc(ja)},useDebugValue:Ud,useDeferredValue:function(e,t){var r=vn();return lp(r,Yt.memoizedState,e,t)},useTransition:function(){var e=oc(ja)[0],t=vn().memoizedState;return[typeof e=="boolean"?e:jo(e),t]},useSyncExternalStore:Lm,useId:fp,useHostTransitionStatus:Fd,useFormState:Km,useActionState:Km,useOptimistic:function(e,t){var r=vn();return qm(r,Yt,e,t)},useMemoCache:Cd,useCacheRefresh:hp};Hd.useEffectEvent=tp;var vp={readContext:zn,use:ic,useCallback:ip,useContext:zn,useEffect:Md,useImperativeHandle:sp,useInsertionEffect:np,useLayoutEffect:rp,useMemo:op,useReducer:jd,useRef:Wm,useState:function(){return jd(ja)},useDebugValue:Ud,useDeferredValue:function(e,t){var r=vn();return Yt===null?Ld(r,e,t):lp(r,Yt.memoizedState,e,t)},useTransition:function(){var e=jd(ja)[0],t=vn().memoizedState;return[typeof e=="boolean"?e:jo(e),t]},useSyncExternalStore:Lm,useId:fp,useHostTransitionStatus:Fd,useFormState:Xm,useActionState:Xm,useOptimistic:function(e,t){var r=vn();return Yt!==null?qm(r,Yt,e,t):(r.baseState=e,[e,r.queue.dispatch])},useMemoCache:Cd,useCacheRefresh:hp};vp.useEffectEvent=tp;function Gd(e,t,r,o){t=e.memoizedState,r=r(o,t),r=r==null?t:S({},t,r),e.memoizedState=r,e.lanes===0&&(e.updateQueue.baseState=r)}var qd={enqueueSetState:function(e,t,r){e=e._reactInternals;var o=_r(),f=us(o);f.payload=t,r!=null&&(f.callback=r),t=ds(e,f,o),t!==null&&(cr(t,e,o),No(t,e,o))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var o=_r(),f=us(o);f.tag=1,f.payload=t,r!=null&&(f.callback=r),t=ds(e,f,o),t!==null&&(cr(t,e,o),No(t,e,o))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=_r(),o=us(r);o.tag=2,t!=null&&(o.callback=t),t=ds(e,o,r),t!==null&&(cr(t,e,r),No(t,e,r))}};function bp(e,t,r,o,f,g,T){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(o,g,T):t.prototype&&t.prototype.isPureReactComponent?!xo(r,o)||!xo(f,g):!0}function xp(e,t,r,o){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(r,o),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(r,o),t.state!==e&&qd.enqueueReplaceState(t,t.state,null)}function Js(e,t){var r=t;if("ref"in t){r={};for(var o in t)o!=="ref"&&(r[o]=t[o])}if(e=e.defaultProps){r===t&&(r=S({},r));for(var f in e)r[f]===void 0&&(r[f]=e[f])}return r}function _p(e){Gl(e)}function Sp(e){console.error(e)}function wp(e){Gl(e)}function dc(e,t){try{var r=e.onUncaughtError;r(t.value,{componentStack:t.stack})}catch(o){setTimeout(function(){throw o})}}function Ep(e,t,r){try{var o=e.onCaughtError;o(r.value,{componentStack:r.stack,errorBoundary:t.tag===1?t.stateNode:null})}catch(f){setTimeout(function(){throw f})}}function Pd(e,t,r){return r=us(r),r.tag=3,r.payload={element:null},r.callback=function(){dc(e,t)},r}function kp(e){return e=us(e),e.tag=3,e}function Tp(e,t,r,o){var f=r.type.getDerivedStateFromError;if(typeof f=="function"){var g=o.value;e.payload=function(){return f(g)},e.callback=function(){Ep(t,r,o)}}var T=r.stateNode;T!==null&&typeof T.componentDidCatch=="function"&&(e.callback=function(){Ep(t,r,o),typeof f!="function"&&(ys===null?ys=new Set([this]):ys.add(this));var H=o.stack;this.componentDidCatch(o.value,{componentStack:H!==null?H:""})})}function K0(e,t,r,o,f){if(r.flags|=32768,o!==null&&typeof o=="object"&&typeof o.then=="function"){if(t=r.alternate,t!==null&&Ti(t,r,f,!0),r=yr.current,r!==null){switch(r.tag){case 31:case 13:return Br===null?wc():r.alternate===null&&hn===0&&(hn=3),r.flags&=-257,r.flags|=65536,r.lanes=f,o===Xl?r.flags|=16384:(t=r.updateQueue,t===null?r.updateQueue=new Set([o]):t.add(o),gf(e,o,f)),!1;case 22:return r.flags|=65536,o===Xl?r.flags|=16384:(t=r.updateQueue,t===null?(t={transitions:null,markerInstances:null,retryQueue:new Set([o])},r.updateQueue=t):(r=t.retryQueue,r===null?t.retryQueue=new Set([o]):r.add(o)),gf(e,o,f)),!1}throw Error(i(435,r.tag))}return gf(e,o,f),wc(),!1}if(Ct)return t=yr.current,t!==null?((t.flags&65536)===0&&(t.flags|=256),t.flags|=65536,t.lanes=f,o!==cd&&(e=Error(i(422),{cause:o}),wo(Ur(e,r)))):(o!==cd&&(t=Error(i(423),{cause:o}),wo(Ur(t,r))),e=e.current.alternate,e.flags|=65536,f&=-f,e.lanes|=f,o=Ur(o,r),f=Pd(e.stateNode,o,f),xd(e,f),hn!==4&&(hn=2)),!1;var g=Error(i(520),{cause:o});if(g=Ur(g,r),Go===null?Go=[g]:Go.push(g),hn!==4&&(hn=2),t===null)return!0;o=Ur(o,r),r=t;do{switch(r.tag){case 3:return r.flags|=65536,e=f&-f,r.lanes|=e,e=Pd(r.stateNode,o,e),xd(r,e),!1;case 1:if(t=r.type,g=r.stateNode,(r.flags&128)===0&&(typeof t.getDerivedStateFromError=="function"||g!==null&&typeof g.componentDidCatch=="function"&&(ys===null||!ys.has(g))))return r.flags|=65536,f&=-f,r.lanes|=f,f=kp(f),Tp(f,e,r,o),xd(r,f),!1}r=r.return}while(r!==null);return!1}var Yd=Error(i(461)),En=!1;function Fn(e,t,r,o){t.child=e===null?Cm(t,null,r,o):Qs(t,e.child,r,o)}function Ap(e,t,r,o,f){r=r.render;var g=t.ref;if("ref"in o){var T={};for(var H in o)H!=="ref"&&(T[H]=o[H])}else T=o;return Ys(t),o=Td(e,t,r,T,g,f),H=Ad(),e!==null&&!En?(Nd(e,t,f),Ia(e,t,f)):(Ct&&H&&od(t),t.flags|=1,Fn(e,t,o,f),t.child)}function Np(e,t,r,o,f){if(e===null){var g=r.type;return typeof g=="function"&&!ad(g)&&g.defaultProps===void 0&&r.compare===null?(t.tag=15,t.type=g,Dp(e,t,g,o,f)):(e=$l(r.type,null,o,t,t.mode,f),e.ref=t.ref,e.return=t,t.child=e)}if(g=e.child,!Wd(e,f)){var T=g.memoizedProps;if(r=r.compare,r=r!==null?r:xo,r(T,o)&&e.ref===t.ref)return Ia(e,t,f)}return t.flags|=1,e=Aa(g,o),e.ref=t.ref,e.return=t,t.child=e}function Dp(e,t,r,o,f){if(e!==null){var g=e.memoizedProps;if(xo(g,o)&&e.ref===t.ref)if(En=!1,t.pendingProps=o=g,Wd(e,f))(e.flags&131072)!==0&&(En=!0);else return t.lanes=e.lanes,Ia(e,t,f)}return $d(e,t,r,o,f)}function Cp(e,t,r,o){var f=o.children,g=e!==null?e.memoizedState:null;if(e===null&&t.stateNode===null&&(t.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),o.mode==="hidden"){if((t.flags&128)!==0){if(g=g!==null?g.baseLanes|r:r,e!==null){for(o=t.child=e.child,f=0;o!==null;)f=f|o.lanes|o.childLanes,o=o.sibling;o=f&~g}else o=0,t.child=null;return Op(e,t,g,r,o)}if((r&536870912)!==0)t.memoizedState={baseLanes:0,cachePool:null},e!==null&&Kl(t,g!==null?g.cachePool:null),g!==null?Im(t,g):Sd(),Rm(t);else return o=t.lanes=536870912,Op(e,t,g!==null?g.baseLanes|r:r,r,o)}else g!==null?(Kl(t,g.cachePool),Im(t,g),hs(),t.memoizedState=null):(e!==null&&Kl(t,null),Sd(),hs());return Fn(e,t,f,r),t.child}function Mo(e,t){return e!==null&&e.tag===22||t.stateNode!==null||(t.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),t.sibling}function Op(e,t,r,o,f){var g=gd();return g=g===null?null:{parent:Sn._currentValue,pool:g},t.memoizedState={baseLanes:r,cachePool:g},e!==null&&Kl(t,null),Sd(),Rm(t),e!==null&&Ti(e,t,o,!0),t.childLanes=f,null}function fc(e,t){return t=mc({mode:t.mode,children:t.children},e.mode),t.ref=e.ref,e.child=t,t.return=e,t}function jp(e,t,r){return Qs(t,e.child,null,r),e=fc(t,t.pendingProps),e.flags|=2,vr(t),t.memoizedState=null,e}function J0(e,t,r){var o=t.pendingProps,f=(t.flags&128)!==0;if(t.flags&=-129,e===null){if(Ct){if(o.mode==="hidden")return e=fc(t,o),t.lanes=536870912,Mo(null,e);if(Ed(t),(e=tn)?(e=Pg(e,Fr),e=e!==null&&e.data==="&"?e:null,e!==null&&(t.memoizedState={dehydrated:e,treeContext:ss!==null?{id:la,overflow:ca}:null,retryLane:536870912,hydrationErrors:null},r=pm(e),r.return=t,t.child=r,Ln=t,tn=null)):e=null,e===null)throw os(t);return t.lanes=536870912,null}return fc(t,o)}var g=e.memoizedState;if(g!==null){var T=g.dehydrated;if(Ed(t),f)if(t.flags&256)t.flags&=-257,t=jp(e,t,r);else if(t.memoizedState!==null)t.child=e.child,t.flags|=128,t=null;else throw Error(i(558));else if(En||Ti(e,t,r,!1),f=(r&e.childLanes)!==0,En||f){if(o=Kt,o!==null&&(T=In(o,r),T!==0&&T!==g.retryLane))throw g.retryLane=T,Hs(e,T),cr(o,e,T),Yd;wc(),t=jp(e,t,r)}else e=g.treeContext,tn=Hr(T.nextSibling),Ln=t,Ct=!0,is=null,Fr=!1,e!==null&&vm(t,e),t=fc(t,o),t.flags|=4096;return t}return e=Aa(e.child,{mode:o.mode,children:o.children}),e.ref=t.ref,t.child=e,e.return=t,e}function hc(e,t){var r=t.ref;if(r===null)e!==null&&e.ref!==null&&(t.flags|=4194816);else{if(typeof r!="function"&&typeof r!="object")throw Error(i(284));(e===null||e.ref!==r)&&(t.flags|=4194816)}}function $d(e,t,r,o,f){return Ys(t),r=Td(e,t,r,o,void 0,f),o=Ad(),e!==null&&!En?(Nd(e,t,f),Ia(e,t,f)):(Ct&&o&&od(t),t.flags|=1,Fn(e,t,r,f),t.child)}function Ip(e,t,r,o,f,g){return Ys(t),t.updateQueue=null,r=Um(t,o,r,f),Mm(e),o=Ad(),e!==null&&!En?(Nd(e,t,g),Ia(e,t,g)):(Ct&&o&&od(t),t.flags|=1,Fn(e,t,r,g),t.child)}function Rp(e,t,r,o,f){if(Ys(t),t.stateNode===null){var g=Si,T=r.contextType;typeof T=="object"&&T!==null&&(g=zn(T)),g=new r(o,g),t.memoizedState=g.state!==null&&g.state!==void 0?g.state:null,g.updater=qd,t.stateNode=g,g._reactInternals=t,g=t.stateNode,g.props=o,g.state=t.memoizedState,g.refs={},vd(t),T=r.contextType,g.context=typeof T=="object"&&T!==null?zn(T):Si,g.state=t.memoizedState,T=r.getDerivedStateFromProps,typeof T=="function"&&(Gd(t,r,T,o),g.state=t.memoizedState),typeof r.getDerivedStateFromProps=="function"||typeof g.getSnapshotBeforeUpdate=="function"||typeof g.UNSAFE_componentWillMount!="function"&&typeof g.componentWillMount!="function"||(T=g.state,typeof g.componentWillMount=="function"&&g.componentWillMount(),typeof g.UNSAFE_componentWillMount=="function"&&g.UNSAFE_componentWillMount(),T!==g.state&&qd.enqueueReplaceState(g,g.state,null),Co(t,o,g,f),Do(),g.state=t.memoizedState),typeof g.componentDidMount=="function"&&(t.flags|=4194308),o=!0}else if(e===null){g=t.stateNode;var H=t.memoizedProps,ae=Js(r,H);g.props=ae;var Se=g.context,De=r.contextType;T=Si,typeof De=="object"&&De!==null&&(T=zn(De));var Re=r.getDerivedStateFromProps;De=typeof Re=="function"||typeof g.getSnapshotBeforeUpdate=="function",H=t.pendingProps!==H,De||typeof g.UNSAFE_componentWillReceiveProps!="function"&&typeof g.componentWillReceiveProps!="function"||(H||Se!==T)&&xp(t,g,o,T),cs=!1;var we=t.memoizedState;g.state=we,Co(t,o,g,f),Do(),Se=t.memoizedState,H||we!==Se||cs?(typeof Re=="function"&&(Gd(t,r,Re,o),Se=t.memoizedState),(ae=cs||bp(t,r,ae,o,we,Se,T))?(De||typeof g.UNSAFE_componentWillMount!="function"&&typeof g.componentWillMount!="function"||(typeof g.componentWillMount=="function"&&g.componentWillMount(),typeof g.UNSAFE_componentWillMount=="function"&&g.UNSAFE_componentWillMount()),typeof g.componentDidMount=="function"&&(t.flags|=4194308)):(typeof g.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=o,t.memoizedState=Se),g.props=o,g.state=Se,g.context=T,o=ae):(typeof g.componentDidMount=="function"&&(t.flags|=4194308),o=!1)}else{g=t.stateNode,bd(e,t),T=t.memoizedProps,De=Js(r,T),g.props=De,Re=t.pendingProps,we=g.context,Se=r.contextType,ae=Si,typeof Se=="object"&&Se!==null&&(ae=zn(Se)),H=r.getDerivedStateFromProps,(Se=typeof H=="function"||typeof g.getSnapshotBeforeUpdate=="function")||typeof g.UNSAFE_componentWillReceiveProps!="function"&&typeof g.componentWillReceiveProps!="function"||(T!==Re||we!==ae)&&xp(t,g,o,ae),cs=!1,we=t.memoizedState,g.state=we,Co(t,o,g,f),Do();var Ae=t.memoizedState;T!==Re||we!==Ae||cs||e!==null&&e.dependencies!==null&&Zl(e.dependencies)?(typeof H=="function"&&(Gd(t,r,H,o),Ae=t.memoizedState),(De=cs||bp(t,r,De,o,we,Ae,ae)||e!==null&&e.dependencies!==null&&Zl(e.dependencies))?(Se||typeof g.UNSAFE_componentWillUpdate!="function"&&typeof g.componentWillUpdate!="function"||(typeof g.componentWillUpdate=="function"&&g.componentWillUpdate(o,Ae,ae),typeof g.UNSAFE_componentWillUpdate=="function"&&g.UNSAFE_componentWillUpdate(o,Ae,ae)),typeof g.componentDidUpdate=="function"&&(t.flags|=4),typeof g.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof g.componentDidUpdate!="function"||T===e.memoizedProps&&we===e.memoizedState||(t.flags|=4),typeof g.getSnapshotBeforeUpdate!="function"||T===e.memoizedProps&&we===e.memoizedState||(t.flags|=1024),t.memoizedProps=o,t.memoizedState=Ae),g.props=o,g.state=Ae,g.context=ae,o=De):(typeof g.componentDidUpdate!="function"||T===e.memoizedProps&&we===e.memoizedState||(t.flags|=4),typeof g.getSnapshotBeforeUpdate!="function"||T===e.memoizedProps&&we===e.memoizedState||(t.flags|=1024),o=!1)}return g=o,hc(e,t),o=(t.flags&128)!==0,g||o?(g=t.stateNode,r=o&&typeof r.getDerivedStateFromError!="function"?null:g.render(),t.flags|=1,e!==null&&o?(t.child=Qs(t,e.child,null,f),t.child=Qs(t,null,r,f)):Fn(e,t,r,f),t.memoizedState=g.state,e=t.child):e=Ia(e,t,f),e}function Mp(e,t,r,o){return qs(),t.flags|=256,Fn(e,t,r,o),t.child}var Vd={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Zd(e){return{baseLanes:e,cachePool:Em()}}function Qd(e,t,r){return e=e!==null?e.childLanes&~r:0,t&&(e|=xr),e}function Up(e,t,r){var o=t.pendingProps,f=!1,g=(t.flags&128)!==0,T;if((T=g)||(T=e!==null&&e.memoizedState===null?!1:(yn.current&2)!==0),T&&(f=!0,t.flags&=-129),T=(t.flags&32)!==0,t.flags&=-33,e===null){if(Ct){if(f?fs(t):hs(),(e=tn)?(e=Pg(e,Fr),e=e!==null&&e.data!=="&"?e:null,e!==null&&(t.memoizedState={dehydrated:e,treeContext:ss!==null?{id:la,overflow:ca}:null,retryLane:536870912,hydrationErrors:null},r=pm(e),r.return=t,t.child=r,Ln=t,tn=null)):e=null,e===null)throw os(t);return jf(e)?t.lanes=32:t.lanes=536870912,null}var H=o.children;return o=o.fallback,f?(hs(),f=t.mode,H=mc({mode:"hidden",children:H},f),o=Gs(o,f,r,null),H.return=t,o.return=t,H.sibling=o,t.child=H,o=t.child,o.memoizedState=Zd(r),o.childLanes=Qd(e,T,r),t.memoizedState=Vd,Mo(null,o)):(fs(t),Kd(t,H))}var ae=e.memoizedState;if(ae!==null&&(H=ae.dehydrated,H!==null)){if(g)t.flags&256?(fs(t),t.flags&=-257,t=Jd(e,t,r)):t.memoizedState!==null?(hs(),t.child=e.child,t.flags|=128,t=null):(hs(),H=o.fallback,f=t.mode,o=mc({mode:"visible",children:o.children},f),H=Gs(H,f,r,null),H.flags|=2,o.return=t,H.return=t,o.sibling=H,t.child=o,Qs(t,e.child,null,r),o=t.child,o.memoizedState=Zd(r),o.childLanes=Qd(e,T,r),t.memoizedState=Vd,t=Mo(null,o));else if(fs(t),jf(H)){if(T=H.nextSibling&&H.nextSibling.dataset,T)var Se=T.dgst;T=Se,o=Error(i(419)),o.stack="",o.digest=T,wo({value:o,source:null,stack:null}),t=Jd(e,t,r)}else if(En||Ti(e,t,r,!1),T=(r&e.childLanes)!==0,En||T){if(T=Kt,T!==null&&(o=In(T,r),o!==0&&o!==ae.retryLane))throw ae.retryLane=o,Hs(e,o),cr(T,e,o),Yd;Of(H)||wc(),t=Jd(e,t,r)}else Of(H)?(t.flags|=192,t.child=e.child,t=null):(e=ae.treeContext,tn=Hr(H.nextSibling),Ln=t,Ct=!0,is=null,Fr=!1,e!==null&&vm(t,e),t=Kd(t,o.children),t.flags|=4096);return t}return f?(hs(),H=o.fallback,f=t.mode,ae=e.child,Se=ae.sibling,o=Aa(ae,{mode:"hidden",children:o.children}),o.subtreeFlags=ae.subtreeFlags&65011712,Se!==null?H=Aa(Se,H):(H=Gs(H,f,r,null),H.flags|=2),H.return=t,o.return=t,o.sibling=H,t.child=o,Mo(null,o),o=t.child,H=e.child.memoizedState,H===null?H=Zd(r):(f=H.cachePool,f!==null?(ae=Sn._currentValue,f=f.parent!==ae?{parent:ae,pool:ae}:f):f=Em(),H={baseLanes:H.baseLanes|r,cachePool:f}),o.memoizedState=H,o.childLanes=Qd(e,T,r),t.memoizedState=Vd,Mo(e.child,o)):(fs(t),r=e.child,e=r.sibling,r=Aa(r,{mode:"visible",children:o.children}),r.return=t,r.sibling=null,e!==null&&(T=t.deletions,T===null?(t.deletions=[e],t.flags|=16):T.push(e)),t.child=r,t.memoizedState=null,r)}function Kd(e,t){return t=mc({mode:"visible",children:t},e.mode),t.return=e,e.child=t}function mc(e,t){return e=gr(22,e,null,t),e.lanes=0,e}function Jd(e,t,r){return Qs(t,e.child,null,r),e=Kd(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function Lp(e,t,r){e.lanes|=t;var o=e.alternate;o!==null&&(o.lanes|=t),fd(e.return,t,r)}function Xd(e,t,r,o,f,g){var T=e.memoizedState;T===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:o,tail:r,tailMode:f,treeForkCount:g}:(T.isBackwards=t,T.rendering=null,T.renderingStartTime=0,T.last=o,T.tail=r,T.tailMode=f,T.treeForkCount=g)}function zp(e,t,r){var o=t.pendingProps,f=o.revealOrder,g=o.tail;o=o.children;var T=yn.current,H=(T&2)!==0;if(H?(T=T&1|2,t.flags|=128):T&=1,re(yn,T),Fn(e,t,o,r),o=Ct?So:0,!H&&e!==null&&(e.flags&128)!==0)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&Lp(e,r,t);else if(e.tag===19)Lp(e,r,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}switch(f){case"forwards":for(r=t.child,f=null;r!==null;)e=r.alternate,e!==null&&nc(e)===null&&(f=r),r=r.sibling;r=f,r===null?(f=t.child,t.child=null):(f=r.sibling,r.sibling=null),Xd(t,!1,f,r,g,o);break;case"backwards":case"unstable_legacy-backwards":for(r=null,f=t.child,t.child=null;f!==null;){if(e=f.alternate,e!==null&&nc(e)===null){t.child=f;break}e=f.sibling,f.sibling=r,r=f,f=e}Xd(t,!0,r,null,g,o);break;case"together":Xd(t,!1,null,null,void 0,o);break;default:t.memoizedState=null}return t.child}function Ia(e,t,r){if(e!==null&&(t.dependencies=e.dependencies),gs|=t.lanes,(r&t.childLanes)===0)if(e!==null){if(Ti(e,t,r,!1),(r&t.childLanes)===0)return null}else return null;if(e!==null&&t.child!==e.child)throw Error(i(153));if(t.child!==null){for(e=t.child,r=Aa(e,e.pendingProps),t.child=r,r.return=t;e.sibling!==null;)e=e.sibling,r=r.sibling=Aa(e,e.pendingProps),r.return=t;r.sibling=null}return t.child}function Wd(e,t){return(e.lanes&t)!==0?!0:(e=e.dependencies,!!(e!==null&&Zl(e)))}function X0(e,t,r){switch(t.tag){case 3:Fe(t,t.stateNode.containerInfo),ls(t,Sn,e.memoizedState.cache),qs();break;case 27:case 5:Ve(t);break;case 4:Fe(t,t.stateNode.containerInfo);break;case 10:ls(t,t.type,t.memoizedProps.value);break;case 31:if(t.memoizedState!==null)return t.flags|=128,Ed(t),null;break;case 13:var o=t.memoizedState;if(o!==null)return o.dehydrated!==null?(fs(t),t.flags|=128,null):(r&t.child.childLanes)!==0?Up(e,t,r):(fs(t),e=Ia(e,t,r),e!==null?e.sibling:null);fs(t);break;case 19:var f=(e.flags&128)!==0;if(o=(r&t.childLanes)!==0,o||(Ti(e,t,r,!1),o=(r&t.childLanes)!==0),f){if(o)return zp(e,t,r);t.flags|=128}if(f=t.memoizedState,f!==null&&(f.rendering=null,f.tail=null,f.lastEffect=null),re(yn,yn.current),o)break;return null;case 22:return t.lanes=0,Cp(e,t,r,t.pendingProps);case 24:ls(t,Sn,e.memoizedState.cache)}return Ia(e,t,r)}function Fp(e,t,r){if(e!==null)if(e.memoizedProps!==t.pendingProps)En=!0;else{if(!Wd(e,r)&&(t.flags&128)===0)return En=!1,X0(e,t,r);En=(e.flags&131072)!==0}else En=!1,Ct&&(t.flags&1048576)!==0&&ym(t,So,t.index);switch(t.lanes=0,t.tag){case 16:e:{var o=t.pendingProps;if(e=Vs(t.elementType),t.type=e,typeof e=="function")ad(e)?(o=Js(e,o),t.tag=1,t=Rp(null,t,e,o,r)):(t.tag=0,t=$d(null,t,e,o,r));else{if(e!=null){var f=e.$$typeof;if(f===F){t.tag=11,t=Ap(null,t,e,o,r);break e}else if(f===U){t.tag=14,t=Np(null,t,e,o,r);break e}}throw t=D(e)||e,Error(i(306,t,""))}}return t;case 0:return $d(e,t,t.type,t.pendingProps,r);case 1:return o=t.type,f=Js(o,t.pendingProps),Rp(e,t,o,f,r);case 3:e:{if(Fe(t,t.stateNode.containerInfo),e===null)throw Error(i(387));o=t.pendingProps;var g=t.memoizedState;f=g.element,bd(e,t),Co(t,o,null,r);var T=t.memoizedState;if(o=T.cache,ls(t,Sn,o),o!==g.cache&&hd(t,[Sn],r,!0),Do(),o=T.element,g.isDehydrated)if(g={element:o,isDehydrated:!1,cache:T.cache},t.updateQueue.baseState=g,t.memoizedState=g,t.flags&256){t=Mp(e,t,o,r);break e}else if(o!==f){f=Ur(Error(i(424)),t),wo(f),t=Mp(e,t,o,r);break e}else{switch(e=t.stateNode.containerInfo,e.nodeType){case 9:e=e.body;break;default:e=e.nodeName==="HTML"?e.ownerDocument.body:e}for(tn=Hr(e.firstChild),Ln=t,Ct=!0,is=null,Fr=!0,r=Cm(t,null,o,r),t.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling}else{if(qs(),o===f){t=Ia(e,t,r);break e}Fn(e,t,o,r)}t=t.child}return t;case 26:return hc(e,t),e===null?(r=Kg(t.type,null,t.pendingProps,null))?t.memoizedState=r:Ct||(r=t.type,e=t.pendingProps,o=Cc(fe.current).createElement(r),o[Bt]=t,o[Rt]=e,Bn(o,r,e),wt(o),t.stateNode=o):t.memoizedState=Kg(t.type,e.memoizedProps,t.pendingProps,e.memoizedState),null;case 27:return Ve(t),e===null&&Ct&&(o=t.stateNode=Vg(t.type,t.pendingProps,fe.current),Ln=t,Fr=!0,f=tn,_s(t.type)?(If=f,tn=Hr(o.firstChild)):tn=f),Fn(e,t,t.pendingProps.children,r),hc(e,t),e===null&&(t.flags|=4194304),t.child;case 5:return e===null&&Ct&&((f=o=tn)&&(o=Nx(o,t.type,t.pendingProps,Fr),o!==null?(t.stateNode=o,Ln=t,tn=Hr(o.firstChild),Fr=!1,f=!0):f=!1),f||os(t)),Ve(t),f=t.type,g=t.pendingProps,T=e!==null?e.memoizedProps:null,o=g.children,Nf(f,g)?o=null:T!==null&&Nf(f,T)&&(t.flags|=32),t.memoizedState!==null&&(f=Td(e,t,q0,null,null,r),Ko._currentValue=f),hc(e,t),Fn(e,t,o,r),t.child;case 6:return e===null&&Ct&&((e=r=tn)&&(r=Dx(r,t.pendingProps,Fr),r!==null?(t.stateNode=r,Ln=t,tn=null,e=!0):e=!1),e||os(t)),null;case 13:return Up(e,t,r);case 4:return Fe(t,t.stateNode.containerInfo),o=t.pendingProps,e===null?t.child=Qs(t,null,o,r):Fn(e,t,o,r),t.child;case 11:return Ap(e,t,t.type,t.pendingProps,r);case 7:return Fn(e,t,t.pendingProps,r),t.child;case 8:return Fn(e,t,t.pendingProps.children,r),t.child;case 12:return Fn(e,t,t.pendingProps.children,r),t.child;case 10:return o=t.pendingProps,ls(t,t.type,o.value),Fn(e,t,o.children,r),t.child;case 9:return f=t.type._context,o=t.pendingProps.children,Ys(t),f=zn(f),o=o(f),t.flags|=1,Fn(e,t,o,r),t.child;case 14:return Np(e,t,t.type,t.pendingProps,r);case 15:return Dp(e,t,t.type,t.pendingProps,r);case 19:return zp(e,t,r);case 31:return J0(e,t,r);case 22:return Cp(e,t,r,t.pendingProps);case 24:return Ys(t),o=zn(Sn),e===null?(f=gd(),f===null&&(f=Kt,g=md(),f.pooledCache=g,g.refCount++,g!==null&&(f.pooledCacheLanes|=r),f=g),t.memoizedState={parent:o,cache:f},vd(t),ls(t,Sn,f)):((e.lanes&r)!==0&&(bd(e,t),Co(t,null,null,r),Do()),f=e.memoizedState,g=t.memoizedState,f.parent!==o?(f={parent:o,cache:o},t.memoizedState=f,t.lanes===0&&(t.memoizedState=t.updateQueue.baseState=f),ls(t,Sn,o)):(o=g.cache,ls(t,Sn,o),o!==f.cache&&hd(t,[Sn],r,!0))),Fn(e,t,t.pendingProps.children,r),t.child;case 29:throw t.pendingProps}throw Error(i(156,t.tag))}function Ra(e){e.flags|=4}function ef(e,t,r,o,f){if((t=(e.mode&32)!==0)&&(t=!1),t){if(e.flags|=16777216,(f&335544128)===f)if(e.stateNode.complete)e.flags|=8192;else if(fg())e.flags|=8192;else throw Zs=Xl,yd}else e.flags&=-16777217}function Bp(e,t){if(t.type!=="stylesheet"||(t.state.loading&4)!==0)e.flags&=-16777217;else if(e.flags|=16777216,!ty(t))if(fg())e.flags|=8192;else throw Zs=Xl,yd}function pc(e,t){t!==null&&(e.flags|=4),e.flags&16384&&(t=e.tag!==22?va():536870912,e.lanes|=t,zi|=t)}function Uo(e,t){if(!Ct)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var o=null;r!==null;)r.alternate!==null&&(o=r),r=r.sibling;o===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:o.sibling=null}}function nn(e){var t=e.alternate!==null&&e.alternate.child===e.child,r=0,o=0;if(t)for(var f=e.child;f!==null;)r|=f.lanes|f.childLanes,o|=f.subtreeFlags&65011712,o|=f.flags&65011712,f.return=e,f=f.sibling;else for(f=e.child;f!==null;)r|=f.lanes|f.childLanes,o|=f.subtreeFlags,o|=f.flags,f.return=e,f=f.sibling;return e.subtreeFlags|=o,e.childLanes=r,t}function W0(e,t,r){var o=t.pendingProps;switch(ld(t),t.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return nn(t),null;case 1:return nn(t),null;case 3:return r=t.stateNode,o=null,e!==null&&(o=e.memoizedState.cache),t.memoizedState.cache!==o&&(t.flags|=2048),Ca(Sn),Ce(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(e===null||e.child===null)&&(ki(t)?Ra(t):e===null||e.memoizedState.isDehydrated&&(t.flags&256)===0||(t.flags|=1024,ud())),nn(t),null;case 26:var f=t.type,g=t.memoizedState;return e===null?(Ra(t),g!==null?(nn(t),Bp(t,g)):(nn(t),ef(t,f,null,o,r))):g?g!==e.memoizedState?(Ra(t),nn(t),Bp(t,g)):(nn(t),t.flags&=-16777217):(e=e.memoizedProps,e!==o&&Ra(t),nn(t),ef(t,f,e,o,r)),null;case 27:if(Qe(t),r=fe.current,f=t.type,e!==null&&t.stateNode!=null)e.memoizedProps!==o&&Ra(t);else{if(!o){if(t.stateNode===null)throw Error(i(166));return nn(t),null}e=oe.current,ki(t)?bm(t):(e=Vg(f,o,r),t.stateNode=e,Ra(t))}return nn(t),null;case 5:if(Qe(t),f=t.type,e!==null&&t.stateNode!=null)e.memoizedProps!==o&&Ra(t);else{if(!o){if(t.stateNode===null)throw Error(i(166));return nn(t),null}if(g=oe.current,ki(t))bm(t);else{var T=Cc(fe.current);switch(g){case 1:g=T.createElementNS("http://www.w3.org/2000/svg",f);break;case 2:g=T.createElementNS("http://www.w3.org/1998/Math/MathML",f);break;default:switch(f){case"svg":g=T.createElementNS("http://www.w3.org/2000/svg",f);break;case"math":g=T.createElementNS("http://www.w3.org/1998/Math/MathML",f);break;case"script":g=T.createElement("div"),g.innerHTML="<script><\/script>",g=g.removeChild(g.firstChild);break;case"select":g=typeof o.is=="string"?T.createElement("select",{is:o.is}):T.createElement("select"),o.multiple?g.multiple=!0:o.size&&(g.size=o.size);break;default:g=typeof o.is=="string"?T.createElement(f,{is:o.is}):T.createElement(f)}}g[Bt]=t,g[Rt]=o;e:for(T=t.child;T!==null;){if(T.tag===5||T.tag===6)g.appendChild(T.stateNode);else if(T.tag!==4&&T.tag!==27&&T.child!==null){T.child.return=T,T=T.child;continue}if(T===t)break e;for(;T.sibling===null;){if(T.return===null||T.return===t)break e;T=T.return}T.sibling.return=T.return,T=T.sibling}t.stateNode=g;e:switch(Bn(g,f,o),f){case"button":case"input":case"select":case"textarea":o=!!o.autoFocus;break e;case"img":o=!0;break e;default:o=!1}o&&Ra(t)}}return nn(t),ef(t,t.type,e===null?null:e.memoizedProps,t.pendingProps,r),null;case 6:if(e&&t.stateNode!=null)e.memoizedProps!==o&&Ra(t);else{if(typeof o!="string"&&t.stateNode===null)throw Error(i(166));if(e=fe.current,ki(t)){if(e=t.stateNode,r=t.memoizedProps,o=null,f=Ln,f!==null)switch(f.tag){case 27:case 5:o=f.memoizedProps}e[Bt]=t,e=!!(e.nodeValue===r||o!==null&&o.suppressHydrationWarning===!0||Ug(e.nodeValue,r)),e||os(t,!0)}else e=Cc(e).createTextNode(o),e[Bt]=t,t.stateNode=e}return nn(t),null;case 31:if(r=t.memoizedState,e===null||e.memoizedState!==null){if(o=ki(t),r!==null){if(e===null){if(!o)throw Error(i(318));if(e=t.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(i(557));e[Bt]=t}else qs(),(t.flags&128)===0&&(t.memoizedState=null),t.flags|=4;nn(t),e=!1}else r=ud(),e!==null&&e.memoizedState!==null&&(e.memoizedState.hydrationErrors=r),e=!0;if(!e)return t.flags&256?(vr(t),t):(vr(t),null);if((t.flags&128)!==0)throw Error(i(558))}return nn(t),null;case 13:if(o=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(f=ki(t),o!==null&&o.dehydrated!==null){if(e===null){if(!f)throw Error(i(318));if(f=t.memoizedState,f=f!==null?f.dehydrated:null,!f)throw Error(i(317));f[Bt]=t}else qs(),(t.flags&128)===0&&(t.memoizedState=null),t.flags|=4;nn(t),f=!1}else f=ud(),e!==null&&e.memoizedState!==null&&(e.memoizedState.hydrationErrors=f),f=!0;if(!f)return t.flags&256?(vr(t),t):(vr(t),null)}return vr(t),(t.flags&128)!==0?(t.lanes=r,t):(r=o!==null,e=e!==null&&e.memoizedState!==null,r&&(o=t.child,f=null,o.alternate!==null&&o.alternate.memoizedState!==null&&o.alternate.memoizedState.cachePool!==null&&(f=o.alternate.memoizedState.cachePool.pool),g=null,o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(g=o.memoizedState.cachePool.pool),g!==f&&(o.flags|=2048)),r!==e&&r&&(t.child.flags|=8192),pc(t,t.updateQueue),nn(t),null);case 4:return Ce(),e===null&&wf(t.stateNode.containerInfo),nn(t),null;case 10:return Ca(t.type),nn(t),null;case 19:if(R(yn),o=t.memoizedState,o===null)return nn(t),null;if(f=(t.flags&128)!==0,g=o.rendering,g===null)if(f)Uo(o,!1);else{if(hn!==0||e!==null&&(e.flags&128)!==0)for(e=t.child;e!==null;){if(g=nc(e),g!==null){for(t.flags|=128,Uo(o,!1),e=g.updateQueue,t.updateQueue=e,pc(t,e),t.subtreeFlags=0,e=r,r=t.child;r!==null;)mm(r,e),r=r.sibling;return re(yn,yn.current&1|2),Ct&&Na(t,o.treeForkCount),t.child}e=e.sibling}o.tail!==null&&Oe()>xc&&(t.flags|=128,f=!0,Uo(o,!1),t.lanes=4194304)}else{if(!f)if(e=nc(g),e!==null){if(t.flags|=128,f=!0,e=e.updateQueue,t.updateQueue=e,pc(t,e),Uo(o,!0),o.tail===null&&o.tailMode==="hidden"&&!g.alternate&&!Ct)return nn(t),null}else 2*Oe()-o.renderingStartTime>xc&&r!==536870912&&(t.flags|=128,f=!0,Uo(o,!1),t.lanes=4194304);o.isBackwards?(g.sibling=t.child,t.child=g):(e=o.last,e!==null?e.sibling=g:t.child=g,o.last=g)}return o.tail!==null?(e=o.tail,o.rendering=e,o.tail=e.sibling,o.renderingStartTime=Oe(),e.sibling=null,r=yn.current,re(yn,f?r&1|2:r&1),Ct&&Na(t,o.treeForkCount),e):(nn(t),null);case 22:case 23:return vr(t),wd(),o=t.memoizedState!==null,e!==null?e.memoizedState!==null!==o&&(t.flags|=8192):o&&(t.flags|=8192),o?(r&536870912)!==0&&(t.flags&128)===0&&(nn(t),t.subtreeFlags&6&&(t.flags|=8192)):nn(t),r=t.updateQueue,r!==null&&pc(t,r.retryQueue),r=null,e!==null&&e.memoizedState!==null&&e.memoizedState.cachePool!==null&&(r=e.memoizedState.cachePool.pool),o=null,t.memoizedState!==null&&t.memoizedState.cachePool!==null&&(o=t.memoizedState.cachePool.pool),o!==r&&(t.flags|=2048),e!==null&&R($s),null;case 24:return r=null,e!==null&&(r=e.memoizedState.cache),t.memoizedState.cache!==r&&(t.flags|=2048),Ca(Sn),nn(t),null;case 25:return null;case 30:return null}throw Error(i(156,t.tag))}function ex(e,t){switch(ld(t),t.tag){case 1:return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return Ca(Sn),Ce(),e=t.flags,(e&65536)!==0&&(e&128)===0?(t.flags=e&-65537|128,t):null;case 26:case 27:case 5:return Qe(t),null;case 31:if(t.memoizedState!==null){if(vr(t),t.alternate===null)throw Error(i(340));qs()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 13:if(vr(t),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(i(340));qs()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return R(yn),null;case 4:return Ce(),null;case 10:return Ca(t.type),null;case 22:case 23:return vr(t),wd(),e!==null&&R($s),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 24:return Ca(Sn),null;case 25:return null;default:return null}}function Hp(e,t){switch(ld(t),t.tag){case 3:Ca(Sn),Ce();break;case 26:case 27:case 5:Qe(t);break;case 4:Ce();break;case 31:t.memoizedState!==null&&vr(t);break;case 13:vr(t);break;case 19:R(yn);break;case 10:Ca(t.type);break;case 22:case 23:vr(t),wd(),e!==null&&R($s);break;case 24:Ca(Sn)}}function Lo(e,t){try{var r=t.updateQueue,o=r!==null?r.lastEffect:null;if(o!==null){var f=o.next;r=f;do{if((r.tag&e)===e){o=void 0;var g=r.create,T=r.inst;o=g(),T.destroy=o}r=r.next}while(r!==f)}}catch(H){Gt(t,t.return,H)}}function ms(e,t,r){try{var o=t.updateQueue,f=o!==null?o.lastEffect:null;if(f!==null){var g=f.next;o=g;do{if((o.tag&e)===e){var T=o.inst,H=T.destroy;if(H!==void 0){T.destroy=void 0,f=t;var ae=r,Se=H;try{Se()}catch(De){Gt(f,ae,De)}}}o=o.next}while(o!==g)}}catch(De){Gt(t,t.return,De)}}function Gp(e){var t=e.updateQueue;if(t!==null){var r=e.stateNode;try{jm(t,r)}catch(o){Gt(e,e.return,o)}}}function qp(e,t,r){r.props=Js(e.type,e.memoizedProps),r.state=e.memoizedState;try{r.componentWillUnmount()}catch(o){Gt(e,t,o)}}function zo(e,t){try{var r=e.ref;if(r!==null){switch(e.tag){case 26:case 27:case 5:var o=e.stateNode;break;case 30:o=e.stateNode;break;default:o=e.stateNode}typeof r=="function"?e.refCleanup=r(o):r.current=o}}catch(f){Gt(e,t,f)}}function ua(e,t){var r=e.ref,o=e.refCleanup;if(r!==null)if(typeof o=="function")try{o()}catch(f){Gt(e,t,f)}finally{e.refCleanup=null,e=e.alternate,e!=null&&(e.refCleanup=null)}else if(typeof r=="function")try{r(null)}catch(f){Gt(e,t,f)}else r.current=null}function Pp(e){var t=e.type,r=e.memoizedProps,o=e.stateNode;try{e:switch(t){case"button":case"input":case"select":case"textarea":r.autoFocus&&o.focus();break e;case"img":r.src?o.src=r.src:r.srcSet&&(o.srcset=r.srcSet)}}catch(f){Gt(e,e.return,f)}}function tf(e,t,r){try{var o=e.stateNode;Sx(o,e.type,r,t),o[Rt]=t}catch(f){Gt(e,e.return,f)}}function Yp(e){return e.tag===5||e.tag===3||e.tag===26||e.tag===27&&_s(e.type)||e.tag===4}function nf(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||Yp(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.tag===27&&_s(e.type)||e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function rf(e,t,r){var o=e.tag;if(o===5||o===6)e=e.stateNode,t?(r.nodeType===9?r.body:r.nodeName==="HTML"?r.ownerDocument.body:r).insertBefore(e,t):(t=r.nodeType===9?r.body:r.nodeName==="HTML"?r.ownerDocument.body:r,t.appendChild(e),r=r._reactRootContainer,r!=null||t.onclick!==null||(t.onclick=Tn));else if(o!==4&&(o===27&&_s(e.type)&&(r=e.stateNode,t=null),e=e.child,e!==null))for(rf(e,t,r),e=e.sibling;e!==null;)rf(e,t,r),e=e.sibling}function gc(e,t,r){var o=e.tag;if(o===5||o===6)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(o!==4&&(o===27&&_s(e.type)&&(r=e.stateNode),e=e.child,e!==null))for(gc(e,t,r),e=e.sibling;e!==null;)gc(e,t,r),e=e.sibling}function $p(e){var t=e.stateNode,r=e.memoizedProps;try{for(var o=e.type,f=t.attributes;f.length;)t.removeAttributeNode(f[0]);Bn(t,o,r),t[Bt]=e,t[Rt]=r}catch(g){Gt(e,e.return,g)}}var Ma=!1,kn=!1,af=!1,Vp=typeof WeakSet=="function"?WeakSet:Set,Cn=null;function tx(e,t){if(e=e.containerInfo,Tf=Lc,e=sm(e),Ju(e)){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{r=(r=e.ownerDocument)&&r.defaultView||window;var o=r.getSelection&&r.getSelection();if(o&&o.rangeCount!==0){r=o.anchorNode;var f=o.anchorOffset,g=o.focusNode;o=o.focusOffset;try{r.nodeType,g.nodeType}catch{r=null;break e}var T=0,H=-1,ae=-1,Se=0,De=0,Re=e,we=null;t:for(;;){for(var Ae;Re!==r||f!==0&&Re.nodeType!==3||(H=T+f),Re!==g||o!==0&&Re.nodeType!==3||(ae=T+o),Re.nodeType===3&&(T+=Re.nodeValue.length),(Ae=Re.firstChild)!==null;)we=Re,Re=Ae;for(;;){if(Re===e)break t;if(we===r&&++Se===f&&(H=T),we===g&&++De===o&&(ae=T),(Ae=Re.nextSibling)!==null)break;Re=we,we=Re.parentNode}Re=Ae}r=H===-1||ae===-1?null:{start:H,end:ae}}else r=null}r=r||{start:0,end:0}}else r=null;for(Af={focusedElem:e,selectionRange:r},Lc=!1,Cn=t;Cn!==null;)if(t=Cn,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,Cn=e;else for(;Cn!==null;){switch(t=Cn,g=t.alternate,e=t.flags,t.tag){case 0:if((e&4)!==0&&(e=t.updateQueue,e=e!==null?e.events:null,e!==null))for(r=0;r<e.length;r++)f=e[r],f.ref.impl=f.nextImpl;break;case 11:case 15:break;case 1:if((e&1024)!==0&&g!==null){e=void 0,r=t,f=g.memoizedProps,g=g.memoizedState,o=r.stateNode;try{var Je=Js(r.type,f);e=o.getSnapshotBeforeUpdate(Je,g),o.__reactInternalSnapshotBeforeUpdate=e}catch(lt){Gt(r,r.return,lt)}}break;case 3:if((e&1024)!==0){if(e=t.stateNode.containerInfo,r=e.nodeType,r===9)Cf(e);else if(r===1)switch(e.nodeName){case"HEAD":case"HTML":case"BODY":Cf(e);break;default:e.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((e&1024)!==0)throw Error(i(163))}if(e=t.sibling,e!==null){e.return=t.return,Cn=e;break}Cn=t.return}}function Zp(e,t,r){var o=r.flags;switch(r.tag){case 0:case 11:case 15:La(e,r),o&4&&Lo(5,r);break;case 1:if(La(e,r),o&4)if(e=r.stateNode,t===null)try{e.componentDidMount()}catch(T){Gt(r,r.return,T)}else{var f=Js(r.type,t.memoizedProps);t=t.memoizedState;try{e.componentDidUpdate(f,t,e.__reactInternalSnapshotBeforeUpdate)}catch(T){Gt(r,r.return,T)}}o&64&&Gp(r),o&512&&zo(r,r.return);break;case 3:if(La(e,r),o&64&&(e=r.updateQueue,e!==null)){if(t=null,r.child!==null)switch(r.child.tag){case 27:case 5:t=r.child.stateNode;break;case 1:t=r.child.stateNode}try{jm(e,t)}catch(T){Gt(r,r.return,T)}}break;case 27:t===null&&o&4&&$p(r);case 26:case 5:La(e,r),t===null&&o&4&&Pp(r),o&512&&zo(r,r.return);break;case 12:La(e,r);break;case 31:La(e,r),o&4&&Jp(e,r);break;case 13:La(e,r),o&4&&Xp(e,r),o&64&&(e=r.memoizedState,e!==null&&(e=e.dehydrated,e!==null&&(r=ux.bind(null,r),Cx(e,r))));break;case 22:if(o=r.memoizedState!==null||Ma,!o){t=t!==null&&t.memoizedState!==null||kn,f=Ma;var g=kn;Ma=o,(kn=t)&&!g?za(e,r,(r.subtreeFlags&8772)!==0):La(e,r),Ma=f,kn=g}break;case 30:break;default:La(e,r)}}function Qp(e){var t=e.alternate;t!==null&&(e.alternate=null,Qp(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&Le(t)),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}var on=null,sr=!1;function Ua(e,t,r){for(r=r.child;r!==null;)Kp(e,t,r),r=r.sibling}function Kp(e,t,r){if(bt&&typeof bt.onCommitFiberUnmount=="function")try{bt.onCommitFiberUnmount(ht,r)}catch{}switch(r.tag){case 26:kn||ua(r,t),Ua(e,t,r),r.memoizedState?r.memoizedState.count--:r.stateNode&&(r=r.stateNode,r.parentNode.removeChild(r));break;case 27:kn||ua(r,t);var o=on,f=sr;_s(r.type)&&(on=r.stateNode,sr=!1),Ua(e,t,r),Vo(r.stateNode),on=o,sr=f;break;case 5:kn||ua(r,t);case 6:if(o=on,f=sr,on=null,Ua(e,t,r),on=o,sr=f,on!==null)if(sr)try{(on.nodeType===9?on.body:on.nodeName==="HTML"?on.ownerDocument.body:on).removeChild(r.stateNode)}catch(g){Gt(r,t,g)}else try{on.removeChild(r.stateNode)}catch(g){Gt(r,t,g)}break;case 18:on!==null&&(sr?(e=on,Gg(e.nodeType===9?e.body:e.nodeName==="HTML"?e.ownerDocument.body:e,r.stateNode),$i(e)):Gg(on,r.stateNode));break;case 4:o=on,f=sr,on=r.stateNode.containerInfo,sr=!0,Ua(e,t,r),on=o,sr=f;break;case 0:case 11:case 14:case 15:ms(2,r,t),kn||ms(4,r,t),Ua(e,t,r);break;case 1:kn||(ua(r,t),o=r.stateNode,typeof o.componentWillUnmount=="function"&&qp(r,t,o)),Ua(e,t,r);break;case 21:Ua(e,t,r);break;case 22:kn=(o=kn)||r.memoizedState!==null,Ua(e,t,r),kn=o;break;default:Ua(e,t,r)}}function Jp(e,t){if(t.memoizedState===null&&(e=t.alternate,e!==null&&(e=e.memoizedState,e!==null))){e=e.dehydrated;try{$i(e)}catch(r){Gt(t,t.return,r)}}}function Xp(e,t){if(t.memoizedState===null&&(e=t.alternate,e!==null&&(e=e.memoizedState,e!==null&&(e=e.dehydrated,e!==null))))try{$i(e)}catch(r){Gt(t,t.return,r)}}function nx(e){switch(e.tag){case 31:case 13:case 19:var t=e.stateNode;return t===null&&(t=e.stateNode=new Vp),t;case 22:return e=e.stateNode,t=e._retryCache,t===null&&(t=e._retryCache=new Vp),t;default:throw Error(i(435,e.tag))}}function yc(e,t){var r=nx(e);t.forEach(function(o){if(!r.has(o)){r.add(o);var f=dx.bind(null,e,o);o.then(f,f)}})}function ir(e,t){var r=t.deletions;if(r!==null)for(var o=0;o<r.length;o++){var f=r[o],g=e,T=t,H=T;e:for(;H!==null;){switch(H.tag){case 27:if(_s(H.type)){on=H.stateNode,sr=!1;break e}break;case 5:on=H.stateNode,sr=!1;break e;case 3:case 4:on=H.stateNode.containerInfo,sr=!0;break e}H=H.return}if(on===null)throw Error(i(160));Kp(g,T,f),on=null,sr=!1,g=f.alternate,g!==null&&(g.return=null),f.return=null}if(t.subtreeFlags&13886)for(t=t.child;t!==null;)Wp(t,e),t=t.sibling}var Jr=null;function Wp(e,t){var r=e.alternate,o=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:ir(t,e),or(e),o&4&&(ms(3,e,e.return),Lo(3,e),ms(5,e,e.return));break;case 1:ir(t,e),or(e),o&512&&(kn||r===null||ua(r,r.return)),o&64&&Ma&&(e=e.updateQueue,e!==null&&(o=e.callbacks,o!==null&&(r=e.shared.hiddenCallbacks,e.shared.hiddenCallbacks=r===null?o:r.concat(o))));break;case 26:var f=Jr;if(ir(t,e),or(e),o&512&&(kn||r===null||ua(r,r.return)),o&4){var g=r!==null?r.memoizedState:null;if(o=e.memoizedState,r===null)if(o===null)if(e.stateNode===null){e:{o=e.type,r=e.memoizedProps,f=f.ownerDocument||f;t:switch(o){case"title":g=f.getElementsByTagName("title")[0],(!g||g[le]||g[Bt]||g.namespaceURI==="http://www.w3.org/2000/svg"||g.hasAttribute("itemprop"))&&(g=f.createElement(o),f.head.insertBefore(g,f.querySelector("head > title"))),Bn(g,o,r),g[Bt]=e,wt(g),o=g;break e;case"link":var T=Wg("link","href",f).get(o+(r.href||""));if(T){for(var H=0;H<T.length;H++)if(g=T[H],g.getAttribute("href")===(r.href==null||r.href===""?null:r.href)&&g.getAttribute("rel")===(r.rel==null?null:r.rel)&&g.getAttribute("title")===(r.title==null?null:r.title)&&g.getAttribute("crossorigin")===(r.crossOrigin==null?null:r.crossOrigin)){T.splice(H,1);break t}}g=f.createElement(o),Bn(g,o,r),f.head.appendChild(g);break;case"meta":if(T=Wg("meta","content",f).get(o+(r.content||""))){for(H=0;H<T.length;H++)if(g=T[H],g.getAttribute("content")===(r.content==null?null:""+r.content)&&g.getAttribute("name")===(r.name==null?null:r.name)&&g.getAttribute("property")===(r.property==null?null:r.property)&&g.getAttribute("http-equiv")===(r.httpEquiv==null?null:r.httpEquiv)&&g.getAttribute("charset")===(r.charSet==null?null:r.charSet)){T.splice(H,1);break t}}g=f.createElement(o),Bn(g,o,r),f.head.appendChild(g);break;default:throw Error(i(468,o))}g[Bt]=e,wt(g),o=g}e.stateNode=o}else ey(f,e.type,e.stateNode);else e.stateNode=Xg(f,o,e.memoizedProps);else g!==o?(g===null?r.stateNode!==null&&(r=r.stateNode,r.parentNode.removeChild(r)):g.count--,o===null?ey(f,e.type,e.stateNode):Xg(f,o,e.memoizedProps)):o===null&&e.stateNode!==null&&tf(e,e.memoizedProps,r.memoizedProps)}break;case 27:ir(t,e),or(e),o&512&&(kn||r===null||ua(r,r.return)),r!==null&&o&4&&tf(e,e.memoizedProps,r.memoizedProps);break;case 5:if(ir(t,e),or(e),o&512&&(kn||r===null||ua(r,r.return)),e.flags&32){f=e.stateNode;try{_a(f,"")}catch(Je){Gt(e,e.return,Je)}}o&4&&e.stateNode!=null&&(f=e.memoizedProps,tf(e,f,r!==null?r.memoizedProps:f)),o&1024&&(af=!0);break;case 6:if(ir(t,e),or(e),o&4){if(e.stateNode===null)throw Error(i(162));o=e.memoizedProps,r=e.stateNode;try{r.nodeValue=o}catch(Je){Gt(e,e.return,Je)}}break;case 3:if(Ic=null,f=Jr,Jr=Oc(t.containerInfo),ir(t,e),Jr=f,or(e),o&4&&r!==null&&r.memoizedState.isDehydrated)try{$i(t.containerInfo)}catch(Je){Gt(e,e.return,Je)}af&&(af=!1,eg(e));break;case 4:o=Jr,Jr=Oc(e.stateNode.containerInfo),ir(t,e),or(e),Jr=o;break;case 12:ir(t,e),or(e);break;case 31:ir(t,e),or(e),o&4&&(o=e.updateQueue,o!==null&&(e.updateQueue=null,yc(e,o)));break;case 13:ir(t,e),or(e),e.child.flags&8192&&e.memoizedState!==null!=(r!==null&&r.memoizedState!==null)&&(bc=Oe()),o&4&&(o=e.updateQueue,o!==null&&(e.updateQueue=null,yc(e,o)));break;case 22:f=e.memoizedState!==null;var ae=r!==null&&r.memoizedState!==null,Se=Ma,De=kn;if(Ma=Se||f,kn=De||ae,ir(t,e),kn=De,Ma=Se,or(e),o&8192)e:for(t=e.stateNode,t._visibility=f?t._visibility&-2:t._visibility|1,f&&(r===null||ae||Ma||kn||Xs(e)),r=null,t=e;;){if(t.tag===5||t.tag===26){if(r===null){ae=r=t;try{if(g=ae.stateNode,f)T=g.style,typeof T.setProperty=="function"?T.setProperty("display","none","important"):T.display="none";else{H=ae.stateNode;var Re=ae.memoizedProps.style,we=Re!=null&&Re.hasOwnProperty("display")?Re.display:null;H.style.display=we==null||typeof we=="boolean"?"":(""+we).trim()}}catch(Je){Gt(ae,ae.return,Je)}}}else if(t.tag===6){if(r===null){ae=t;try{ae.stateNode.nodeValue=f?"":ae.memoizedProps}catch(Je){Gt(ae,ae.return,Je)}}}else if(t.tag===18){if(r===null){ae=t;try{var Ae=ae.stateNode;f?qg(Ae,!0):qg(ae.stateNode,!1)}catch(Je){Gt(ae,ae.return,Je)}}}else if((t.tag!==22&&t.tag!==23||t.memoizedState===null||t===e)&&t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;r===t&&(r=null),t=t.return}r===t&&(r=null),t.sibling.return=t.return,t=t.sibling}o&4&&(o=e.updateQueue,o!==null&&(r=o.retryQueue,r!==null&&(o.retryQueue=null,yc(e,r))));break;case 19:ir(t,e),or(e),o&4&&(o=e.updateQueue,o!==null&&(e.updateQueue=null,yc(e,o)));break;case 30:break;case 21:break;default:ir(t,e),or(e)}}function or(e){var t=e.flags;if(t&2){try{for(var r,o=e.return;o!==null;){if(Yp(o)){r=o;break}o=o.return}if(r==null)throw Error(i(160));switch(r.tag){case 27:var f=r.stateNode,g=nf(e);gc(e,g,f);break;case 5:var T=r.stateNode;r.flags&32&&(_a(T,""),r.flags&=-33);var H=nf(e);gc(e,H,T);break;case 3:case 4:var ae=r.stateNode.containerInfo,Se=nf(e);rf(e,Se,ae);break;default:throw Error(i(161))}}catch(De){Gt(e,e.return,De)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function eg(e){if(e.subtreeFlags&1024)for(e=e.child;e!==null;){var t=e;eg(t),t.tag===5&&t.flags&1024&&t.stateNode.reset(),e=e.sibling}}function La(e,t){if(t.subtreeFlags&8772)for(t=t.child;t!==null;)Zp(e,t.alternate,t),t=t.sibling}function Xs(e){for(e=e.child;e!==null;){var t=e;switch(t.tag){case 0:case 11:case 14:case 15:ms(4,t,t.return),Xs(t);break;case 1:ua(t,t.return);var r=t.stateNode;typeof r.componentWillUnmount=="function"&&qp(t,t.return,r),Xs(t);break;case 27:Vo(t.stateNode);case 26:case 5:ua(t,t.return),Xs(t);break;case 22:t.memoizedState===null&&Xs(t);break;case 30:Xs(t);break;default:Xs(t)}e=e.sibling}}function za(e,t,r){for(r=r&&(t.subtreeFlags&8772)!==0,t=t.child;t!==null;){var o=t.alternate,f=e,g=t,T=g.flags;switch(g.tag){case 0:case 11:case 15:za(f,g,r),Lo(4,g);break;case 1:if(za(f,g,r),o=g,f=o.stateNode,typeof f.componentDidMount=="function")try{f.componentDidMount()}catch(Se){Gt(o,o.return,Se)}if(o=g,f=o.updateQueue,f!==null){var H=o.stateNode;try{var ae=f.shared.hiddenCallbacks;if(ae!==null)for(f.shared.hiddenCallbacks=null,f=0;f<ae.length;f++)Om(ae[f],H)}catch(Se){Gt(o,o.return,Se)}}r&&T&64&&Gp(g),zo(g,g.return);break;case 27:$p(g);case 26:case 5:za(f,g,r),r&&o===null&&T&4&&Pp(g),zo(g,g.return);break;case 12:za(f,g,r);break;case 31:za(f,g,r),r&&T&4&&Jp(f,g);break;case 13:za(f,g,r),r&&T&4&&Xp(f,g);break;case 22:g.memoizedState===null&&za(f,g,r),zo(g,g.return);break;case 30:break;default:za(f,g,r)}t=t.sibling}}function sf(e,t){var r=null;e!==null&&e.memoizedState!==null&&e.memoizedState.cachePool!==null&&(r=e.memoizedState.cachePool.pool),e=null,t.memoizedState!==null&&t.memoizedState.cachePool!==null&&(e=t.memoizedState.cachePool.pool),e!==r&&(e!=null&&e.refCount++,r!=null&&Eo(r))}function of(e,t){e=null,t.alternate!==null&&(e=t.alternate.memoizedState.cache),t=t.memoizedState.cache,t!==e&&(t.refCount++,e!=null&&Eo(e))}function Xr(e,t,r,o){if(t.subtreeFlags&10256)for(t=t.child;t!==null;)tg(e,t,r,o),t=t.sibling}function tg(e,t,r,o){var f=t.flags;switch(t.tag){case 0:case 11:case 15:Xr(e,t,r,o),f&2048&&Lo(9,t);break;case 1:Xr(e,t,r,o);break;case 3:Xr(e,t,r,o),f&2048&&(e=null,t.alternate!==null&&(e=t.alternate.memoizedState.cache),t=t.memoizedState.cache,t!==e&&(t.refCount++,e!=null&&Eo(e)));break;case 12:if(f&2048){Xr(e,t,r,o),e=t.stateNode;try{var g=t.memoizedProps,T=g.id,H=g.onPostCommit;typeof H=="function"&&H(T,t.alternate===null?"mount":"update",e.passiveEffectDuration,-0)}catch(ae){Gt(t,t.return,ae)}}else Xr(e,t,r,o);break;case 31:Xr(e,t,r,o);break;case 13:Xr(e,t,r,o);break;case 23:break;case 22:g=t.stateNode,T=t.alternate,t.memoizedState!==null?g._visibility&2?Xr(e,t,r,o):Fo(e,t):g._visibility&2?Xr(e,t,r,o):(g._visibility|=2,Mi(e,t,r,o,(t.subtreeFlags&10256)!==0||!1)),f&2048&&sf(T,t);break;case 24:Xr(e,t,r,o),f&2048&&of(t.alternate,t);break;default:Xr(e,t,r,o)}}function Mi(e,t,r,o,f){for(f=f&&((t.subtreeFlags&10256)!==0||!1),t=t.child;t!==null;){var g=e,T=t,H=r,ae=o,Se=T.flags;switch(T.tag){case 0:case 11:case 15:Mi(g,T,H,ae,f),Lo(8,T);break;case 23:break;case 22:var De=T.stateNode;T.memoizedState!==null?De._visibility&2?Mi(g,T,H,ae,f):Fo(g,T):(De._visibility|=2,Mi(g,T,H,ae,f)),f&&Se&2048&&sf(T.alternate,T);break;case 24:Mi(g,T,H,ae,f),f&&Se&2048&&of(T.alternate,T);break;default:Mi(g,T,H,ae,f)}t=t.sibling}}function Fo(e,t){if(t.subtreeFlags&10256)for(t=t.child;t!==null;){var r=e,o=t,f=o.flags;switch(o.tag){case 22:Fo(r,o),f&2048&&sf(o.alternate,o);break;case 24:Fo(r,o),f&2048&&of(o.alternate,o);break;default:Fo(r,o)}t=t.sibling}}var Bo=8192;function Ui(e,t,r){if(e.subtreeFlags&Bo)for(e=e.child;e!==null;)ng(e,t,r),e=e.sibling}function ng(e,t,r){switch(e.tag){case 26:Ui(e,t,r),e.flags&Bo&&e.memoizedState!==null&&Gx(r,Jr,e.memoizedState,e.memoizedProps);break;case 5:Ui(e,t,r);break;case 3:case 4:var o=Jr;Jr=Oc(e.stateNode.containerInfo),Ui(e,t,r),Jr=o;break;case 22:e.memoizedState===null&&(o=e.alternate,o!==null&&o.memoizedState!==null?(o=Bo,Bo=16777216,Ui(e,t,r),Bo=o):Ui(e,t,r));break;default:Ui(e,t,r)}}function rg(e){var t=e.alternate;if(t!==null&&(e=t.child,e!==null)){t.child=null;do t=e.sibling,e.sibling=null,e=t;while(e!==null)}}function Ho(e){var t=e.deletions;if((e.flags&16)!==0){if(t!==null)for(var r=0;r<t.length;r++){var o=t[r];Cn=o,sg(o,e)}rg(e)}if(e.subtreeFlags&10256)for(e=e.child;e!==null;)ag(e),e=e.sibling}function ag(e){switch(e.tag){case 0:case 11:case 15:Ho(e),e.flags&2048&&ms(9,e,e.return);break;case 3:Ho(e);break;case 12:Ho(e);break;case 22:var t=e.stateNode;e.memoizedState!==null&&t._visibility&2&&(e.return===null||e.return.tag!==13)?(t._visibility&=-3,vc(e)):Ho(e);break;default:Ho(e)}}function vc(e){var t=e.deletions;if((e.flags&16)!==0){if(t!==null)for(var r=0;r<t.length;r++){var o=t[r];Cn=o,sg(o,e)}rg(e)}for(e=e.child;e!==null;){switch(t=e,t.tag){case 0:case 11:case 15:ms(8,t,t.return),vc(t);break;case 22:r=t.stateNode,r._visibility&2&&(r._visibility&=-3,vc(t));break;default:vc(t)}e=e.sibling}}function sg(e,t){for(;Cn!==null;){var r=Cn;switch(r.tag){case 0:case 11:case 15:ms(8,r,t);break;case 23:case 22:if(r.memoizedState!==null&&r.memoizedState.cachePool!==null){var o=r.memoizedState.cachePool.pool;o!=null&&o.refCount++}break;case 24:Eo(r.memoizedState.cache)}if(o=r.child,o!==null)o.return=r,Cn=o;else e:for(r=e;Cn!==null;){o=Cn;var f=o.sibling,g=o.return;if(Qp(o),o===r){Cn=null;break e}if(f!==null){f.return=g,Cn=f;break e}Cn=g}}}var rx={getCacheForType:function(e){var t=zn(Sn),r=t.data.get(e);return r===void 0&&(r=e(),t.data.set(e,r)),r},cacheSignal:function(){return zn(Sn).controller.signal}},ax=typeof WeakMap=="function"?WeakMap:Map,Lt=0,Kt=null,Et=null,At=0,Ht=0,br=null,ps=!1,Li=!1,lf=!1,Fa=0,hn=0,gs=0,Ws=0,cf=0,xr=0,zi=0,Go=null,lr=null,uf=!1,bc=0,ig=0,xc=1/0,_c=null,ys=null,An=0,vs=null,Fi=null,Ba=0,df=0,ff=null,og=null,qo=0,hf=null;function _r(){return(Lt&2)!==0&&At!==0?At&-At:Z.T!==null?bf():Cr()}function lg(){if(xr===0)if((At&536870912)===0||Ct){var e=Ft;Ft<<=1,(Ft&3932160)===0&&(Ft=262144),xr=e}else xr=536870912;return e=yr.current,e!==null&&(e.flags|=32),xr}function cr(e,t,r){(e===Kt&&(Ht===2||Ht===9)||e.cancelPendingCommit!==null)&&(Bi(e,0),bs(e,At,xr,!1)),fr(e,r),((Lt&2)===0||e!==Kt)&&(e===Kt&&((Lt&2)===0&&(Ws|=r),hn===4&&bs(e,At,xr,!1)),da(e))}function cg(e,t,r){if((Lt&6)!==0)throw Error(i(327));var o=!r&&(t&127)===0&&(t&e.expiredLanes)===0||Zr(e,t),f=o?ox(e,t):pf(e,t,!0),g=o;do{if(f===0){Li&&!o&&bs(e,t,0,!1);break}else{if(r=e.current.alternate,g&&!sx(r)){f=pf(e,t,!1),g=!1;continue}if(f===2){if(g=t,e.errorRecoveryDisabledLanes&g)var T=0;else T=e.pendingLanes&-536870913,T=T!==0?T:T&536870912?536870912:0;if(T!==0){t=T;e:{var H=e;f=Go;var ae=H.current.memoizedState.isDehydrated;if(ae&&(Bi(H,T).flags|=256),T=pf(H,T,!1),T!==2){if(lf&&!ae){H.errorRecoveryDisabledLanes|=g,Ws|=g,f=4;break e}g=lr,lr=f,g!==null&&(lr===null?lr=g:lr.push.apply(lr,g))}f=T}if(g=!1,f!==2)continue}}if(f===1){Bi(e,0),bs(e,t,0,!0);break}e:{switch(o=e,g=f,g){case 0:case 1:throw Error(i(345));case 4:if((t&4194048)!==t)break;case 6:bs(o,t,xr,!ps);break e;case 2:lr=null;break;case 3:case 5:break;default:throw Error(i(329))}if((t&62914560)===t&&(f=bc+300-Oe(),10<f)){if(bs(o,t,xr,!ps),Qn(o,0,!0)!==0)break e;Ba=t,o.timeoutHandle=Bg(ug.bind(null,o,r,lr,_c,uf,t,xr,Ws,zi,ps,g,"Throttled",-0,0),f);break e}ug(o,r,lr,_c,uf,t,xr,Ws,zi,ps,g,null,-0,0)}}break}while(!0);da(e)}function ug(e,t,r,o,f,g,T,H,ae,Se,De,Re,we,Ae){if(e.timeoutHandle=-1,Re=t.subtreeFlags,Re&8192||(Re&16785408)===16785408){Re={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:Tn},ng(t,g,Re);var Je=(g&62914560)===g?bc-Oe():(g&4194048)===g?ig-Oe():0;if(Je=qx(Re,Je),Je!==null){Ba=g,e.cancelPendingCommit=Je(vg.bind(null,e,t,g,r,o,f,T,H,ae,De,Re,null,we,Ae)),bs(e,g,T,!Se);return}}vg(e,t,g,r,o,f,T,H,ae)}function sx(e){for(var t=e;;){var r=t.tag;if((r===0||r===11||r===15)&&t.flags&16384&&(r=t.updateQueue,r!==null&&(r=r.stores,r!==null)))for(var o=0;o<r.length;o++){var f=r[o],g=f.getSnapshot;f=f.value;try{if(!pr(g(),f))return!1}catch{return!1}}if(r=t.child,t.subtreeFlags&16384&&r!==null)r.return=t,t=r;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function bs(e,t,r,o){t&=~cf,t&=~Ws,e.suspendedLanes|=t,e.pingedLanes&=~t,o&&(e.warmLanes|=t),o=e.expirationTimes;for(var f=t;0<f;){var g=31-It(f),T=1<<g;o[g]=-1,f&=~T}r!==0&&Va(e,r,t)}function Sc(){return(Lt&6)===0?(Po(0),!1):!0}function mf(){if(Et!==null){if(Ht===0)var e=Et.return;else e=Et,Da=Ps=null,Dd(e),Ci=null,To=0,e=Et;for(;e!==null;)Hp(e.alternate,e),e=e.return;Et=null}}function Bi(e,t){var r=e.timeoutHandle;r!==-1&&(e.timeoutHandle=-1,kx(r)),r=e.cancelPendingCommit,r!==null&&(e.cancelPendingCommit=null,r()),Ba=0,mf(),Kt=e,Et=r=Aa(e.current,null),At=t,Ht=0,br=null,ps=!1,Li=Zr(e,t),lf=!1,zi=xr=cf=Ws=gs=hn=0,lr=Go=null,uf=!1,(t&8)!==0&&(t|=t&32);var o=e.entangledLanes;if(o!==0)for(e=e.entanglements,o&=t;0<o;){var f=31-It(o),g=1<<f;t|=e[f],o&=~g}return Fa=t,ql(),r}function dg(e,t){gt=null,Z.H=Ro,t===Di||t===Jl?(t=Am(),Ht=3):t===yd?(t=Am(),Ht=4):Ht=t===Yd?8:t!==null&&typeof t=="object"&&typeof t.then=="function"?6:1,br=t,Et===null&&(hn=1,dc(e,Ur(t,e.current)))}function fg(){var e=yr.current;return e===null?!0:(At&4194048)===At?Br===null:(At&62914560)===At||(At&536870912)!==0?e===Br:!1}function hg(){var e=Z.H;return Z.H=Ro,e===null?Ro:e}function mg(){var e=Z.A;return Z.A=rx,e}function wc(){hn=4,ps||(At&4194048)!==At&&yr.current!==null||(Li=!0),(gs&134217727)===0&&(Ws&134217727)===0||Kt===null||bs(Kt,At,xr,!1)}function pf(e,t,r){var o=Lt;Lt|=2;var f=hg(),g=mg();(Kt!==e||At!==t)&&(_c=null,Bi(e,t)),t=!1;var T=hn;e:do try{if(Ht!==0&&Et!==null){var H=Et,ae=br;switch(Ht){case 8:mf(),T=6;break e;case 3:case 2:case 9:case 6:yr.current===null&&(t=!0);var Se=Ht;if(Ht=0,br=null,Hi(e,H,ae,Se),r&&Li){T=0;break e}break;default:Se=Ht,Ht=0,br=null,Hi(e,H,ae,Se)}}ix(),T=hn;break}catch(De){dg(e,De)}while(!0);return t&&e.shellSuspendCounter++,Da=Ps=null,Lt=o,Z.H=f,Z.A=g,Et===null&&(Kt=null,At=0,ql()),T}function ix(){for(;Et!==null;)pg(Et)}function ox(e,t){var r=Lt;Lt|=2;var o=hg(),f=mg();Kt!==e||At!==t?(_c=null,xc=Oe()+500,Bi(e,t)):Li=Zr(e,t);e:do try{if(Ht!==0&&Et!==null){t=Et;var g=br;t:switch(Ht){case 1:Ht=0,br=null,Hi(e,t,g,1);break;case 2:case 9:if(km(g)){Ht=0,br=null,gg(t);break}t=function(){Ht!==2&&Ht!==9||Kt!==e||(Ht=7),da(e)},g.then(t,t);break e;case 3:Ht=7;break e;case 4:Ht=5;break e;case 7:km(g)?(Ht=0,br=null,gg(t)):(Ht=0,br=null,Hi(e,t,g,7));break;case 5:var T=null;switch(Et.tag){case 26:T=Et.memoizedState;case 5:case 27:var H=Et;if(T?ty(T):H.stateNode.complete){Ht=0,br=null;var ae=H.sibling;if(ae!==null)Et=ae;else{var Se=H.return;Se!==null?(Et=Se,Ec(Se)):Et=null}break t}}Ht=0,br=null,Hi(e,t,g,5);break;case 6:Ht=0,br=null,Hi(e,t,g,6);break;case 8:mf(),hn=6;break e;default:throw Error(i(462))}}lx();break}catch(De){dg(e,De)}while(!0);return Da=Ps=null,Z.H=o,Z.A=f,Lt=r,Et!==null?0:(Kt=null,At=0,ql(),hn)}function lx(){for(;Et!==null&&!ne();)pg(Et)}function pg(e){var t=Fp(e.alternate,e,Fa);e.memoizedProps=e.pendingProps,t===null?Ec(e):Et=t}function gg(e){var t=e,r=t.alternate;switch(t.tag){case 15:case 0:t=Ip(r,t,t.pendingProps,t.type,void 0,At);break;case 11:t=Ip(r,t,t.pendingProps,t.type.render,t.ref,At);break;case 5:Dd(t);default:Hp(r,t),t=Et=mm(t,Fa),t=Fp(r,t,Fa)}e.memoizedProps=e.pendingProps,t===null?Ec(e):Et=t}function Hi(e,t,r,o){Da=Ps=null,Dd(t),Ci=null,To=0;var f=t.return;try{if(K0(e,f,t,r,At)){hn=1,dc(e,Ur(r,e.current)),Et=null;return}}catch(g){if(f!==null)throw Et=f,g;hn=1,dc(e,Ur(r,e.current)),Et=null;return}t.flags&32768?(Ct||o===1?e=!0:Li||(At&536870912)!==0?e=!1:(ps=e=!0,(o===2||o===9||o===3||o===6)&&(o=yr.current,o!==null&&o.tag===13&&(o.flags|=16384))),yg(t,e)):Ec(t)}function Ec(e){var t=e;do{if((t.flags&32768)!==0){yg(t,ps);return}e=t.return;var r=W0(t.alternate,t,Fa);if(r!==null){Et=r;return}if(t=t.sibling,t!==null){Et=t;return}Et=t=e}while(t!==null);hn===0&&(hn=5)}function yg(e,t){do{var r=ex(e.alternate,e);if(r!==null){r.flags&=32767,Et=r;return}if(r=e.return,r!==null&&(r.flags|=32768,r.subtreeFlags=0,r.deletions=null),!t&&(e=e.sibling,e!==null)){Et=e;return}Et=e=r}while(e!==null);hn=6,Et=null}function vg(e,t,r,o,f,g,T,H,ae){e.cancelPendingCommit=null;do kc();while(An!==0);if((Lt&6)!==0)throw Error(i(327));if(t!==null){if(t===e.current)throw Error(i(177));if(g=t.lanes|t.childLanes,g|=nd,$a(e,r,g,T,H,ae),e===Kt&&(Et=Kt=null,At=0),Fi=t,vs=e,Ba=r,df=g,ff=f,og=o,(t.subtreeFlags&10256)!==0||(t.flags&10256)!==0?(e.callbackNode=null,e.callbackPriority=0,fx(at,function(){return wg(),null})):(e.callbackNode=null,e.callbackPriority=0),o=(t.flags&13878)!==0,(t.subtreeFlags&13878)!==0||o){o=Z.T,Z.T=null,f=Y.p,Y.p=2,T=Lt,Lt|=4;try{tx(e,t,r)}finally{Lt=T,Y.p=f,Z.T=o}}An=1,bg(),xg(),_g()}}function bg(){if(An===1){An=0;var e=vs,t=Fi,r=(t.flags&13878)!==0;if((t.subtreeFlags&13878)!==0||r){r=Z.T,Z.T=null;var o=Y.p;Y.p=2;var f=Lt;Lt|=4;try{Wp(t,e);var g=Af,T=sm(e.containerInfo),H=g.focusedElem,ae=g.selectionRange;if(T!==H&&H&&H.ownerDocument&&am(H.ownerDocument.documentElement,H)){if(ae!==null&&Ju(H)){var Se=ae.start,De=ae.end;if(De===void 0&&(De=Se),"selectionStart"in H)H.selectionStart=Se,H.selectionEnd=Math.min(De,H.value.length);else{var Re=H.ownerDocument||document,we=Re&&Re.defaultView||window;if(we.getSelection){var Ae=we.getSelection(),Je=H.textContent.length,lt=Math.min(ae.start,Je),Vt=ae.end===void 0?lt:Math.min(ae.end,Je);!Ae.extend&&lt>Vt&&(T=Vt,Vt=lt,lt=T);var pe=rm(H,lt),ce=rm(H,Vt);if(pe&&ce&&(Ae.rangeCount!==1||Ae.anchorNode!==pe.node||Ae.anchorOffset!==pe.offset||Ae.focusNode!==ce.node||Ae.focusOffset!==ce.offset)){var _e=Re.createRange();_e.setStart(pe.node,pe.offset),Ae.removeAllRanges(),lt>Vt?(Ae.addRange(_e),Ae.extend(ce.node,ce.offset)):(_e.setEnd(ce.node,ce.offset),Ae.addRange(_e))}}}}for(Re=[],Ae=H;Ae=Ae.parentNode;)Ae.nodeType===1&&Re.push({element:Ae,left:Ae.scrollLeft,top:Ae.scrollTop});for(typeof H.focus=="function"&&H.focus(),H=0;H<Re.length;H++){var Ie=Re[H];Ie.element.scrollLeft=Ie.left,Ie.element.scrollTop=Ie.top}}Lc=!!Tf,Af=Tf=null}finally{Lt=f,Y.p=o,Z.T=r}}e.current=t,An=2}}function xg(){if(An===2){An=0;var e=vs,t=Fi,r=(t.flags&8772)!==0;if((t.subtreeFlags&8772)!==0||r){r=Z.T,Z.T=null;var o=Y.p;Y.p=2;var f=Lt;Lt|=4;try{Zp(e,t.alternate,t)}finally{Lt=f,Y.p=o,Z.T=r}}An=3}}function _g(){if(An===4||An===3){An=0,ke();var e=vs,t=Fi,r=Ba,o=og;(t.subtreeFlags&10256)!==0||(t.flags&10256)!==0?An=5:(An=0,Fi=vs=null,Sg(e,e.pendingLanes));var f=e.pendingLanes;if(f===0&&(ys=null),ba(r),t=t.stateNode,bt&&typeof bt.onCommitFiberRoot=="function")try{bt.onCommitFiberRoot(ht,t,void 0,(t.current.flags&128)===128)}catch{}if(o!==null){t=Z.T,f=Y.p,Y.p=2,Z.T=null;try{for(var g=e.onRecoverableError,T=0;T<o.length;T++){var H=o[T];g(H.value,{componentStack:H.stack})}}finally{Z.T=t,Y.p=f}}(Ba&3)!==0&&kc(),da(e),f=e.pendingLanes,(r&261930)!==0&&(f&42)!==0?e===hf?qo++:(qo=0,hf=e):qo=0,Po(0)}}function Sg(e,t){(e.pooledCacheLanes&=t)===0&&(t=e.pooledCache,t!=null&&(e.pooledCache=null,Eo(t)))}function kc(){return bg(),xg(),_g(),wg()}function wg(){if(An!==5)return!1;var e=vs,t=df;df=0;var r=ba(Ba),o=Z.T,f=Y.p;try{Y.p=32>r?32:r,Z.T=null,r=ff,ff=null;var g=vs,T=Ba;if(An=0,Fi=vs=null,Ba=0,(Lt&6)!==0)throw Error(i(331));var H=Lt;if(Lt|=4,ag(g.current),tg(g,g.current,T,r),Lt=H,Po(0,!1),bt&&typeof bt.onPostCommitFiberRoot=="function")try{bt.onPostCommitFiberRoot(ht,g)}catch{}return!0}finally{Y.p=f,Z.T=o,Sg(e,t)}}function Eg(e,t,r){t=Ur(r,t),t=Pd(e.stateNode,t,2),e=ds(e,t,2),e!==null&&(fr(e,2),da(e))}function Gt(e,t,r){if(e.tag===3)Eg(e,e,r);else for(;t!==null;){if(t.tag===3){Eg(t,e,r);break}else if(t.tag===1){var o=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof o.componentDidCatch=="function"&&(ys===null||!ys.has(o))){e=Ur(r,e),r=kp(2),o=ds(t,r,2),o!==null&&(Tp(r,o,t,e),fr(o,2),da(o));break}}t=t.return}}function gf(e,t,r){var o=e.pingCache;if(o===null){o=e.pingCache=new ax;var f=new Set;o.set(t,f)}else f=o.get(t),f===void 0&&(f=new Set,o.set(t,f));f.has(r)||(lf=!0,f.add(r),e=cx.bind(null,e,t,r),t.then(e,e))}function cx(e,t,r){var o=e.pingCache;o!==null&&o.delete(t),e.pingedLanes|=e.suspendedLanes&r,e.warmLanes&=~r,Kt===e&&(At&r)===r&&(hn===4||hn===3&&(At&62914560)===At&&300>Oe()-bc?(Lt&2)===0&&Bi(e,0):cf|=r,zi===At&&(zi=0)),da(e)}function kg(e,t){t===0&&(t=va()),e=Hs(e,t),e!==null&&(fr(e,t),da(e))}function ux(e){var t=e.memoizedState,r=0;t!==null&&(r=t.retryLane),kg(e,r)}function dx(e,t){var r=0;switch(e.tag){case 31:case 13:var o=e.stateNode,f=e.memoizedState;f!==null&&(r=f.retryLane);break;case 19:o=e.stateNode;break;case 22:o=e.stateNode._retryCache;break;default:throw Error(i(314))}o!==null&&o.delete(t),kg(e,r)}function fx(e,t){return ye(e,t)}var Tc=null,Gi=null,yf=!1,Ac=!1,vf=!1,xs=0;function da(e){e!==Gi&&e.next===null&&(Gi===null?Tc=Gi=e:Gi=Gi.next=e),Ac=!0,yf||(yf=!0,mx())}function Po(e,t){if(!vf&&Ac){vf=!0;do for(var r=!1,o=Tc;o!==null;){if(e!==0){var f=o.pendingLanes;if(f===0)var g=0;else{var T=o.suspendedLanes,H=o.pingedLanes;g=(1<<31-It(42|e)+1)-1,g&=f&~(T&~H),g=g&201326741?g&201326741|1:g?g|2:0}g!==0&&(r=!0,Dg(o,g))}else g=At,g=Qn(o,o===Kt?g:0,o.cancelPendingCommit!==null||o.timeoutHandle!==-1),(g&3)===0||Zr(o,g)||(r=!0,Dg(o,g));o=o.next}while(r);vf=!1}}function hx(){Tg()}function Tg(){Ac=yf=!1;var e=0;xs!==0&&Ex()&&(e=xs);for(var t=Oe(),r=null,o=Tc;o!==null;){var f=o.next,g=Ag(o,t);g===0?(o.next=null,r===null?Tc=f:r.next=f,f===null&&(Gi=r)):(r=o,(e!==0||(g&3)!==0)&&(Ac=!0)),o=f}An!==0&&An!==5||Po(e),xs!==0&&(xs=0)}function Ag(e,t){for(var r=e.suspendedLanes,o=e.pingedLanes,f=e.expirationTimes,g=e.pendingLanes&-62914561;0<g;){var T=31-It(g),H=1<<T,ae=f[T];ae===-1?((H&r)===0||(H&o)!==0)&&(f[T]=Ge(H,t)):ae<=t&&(e.expiredLanes|=H),g&=~H}if(t=Kt,r=At,r=Qn(e,e===t?r:0,e.cancelPendingCommit!==null||e.timeoutHandle!==-1),o=e.callbackNode,r===0||e===t&&(Ht===2||Ht===9)||e.cancelPendingCommit!==null)return o!==null&&o!==null&&ve(o),e.callbackNode=null,e.callbackPriority=0;if((r&3)===0||Zr(e,r)){if(t=r&-r,t===e.callbackPriority)return t;switch(o!==null&&ve(o),ba(r)){case 2:case 8:r=it;break;case 32:r=at;break;case 268435456:r=Zt;break;default:r=at}return o=Ng.bind(null,e),r=ye(r,o),e.callbackPriority=t,e.callbackNode=r,t}return o!==null&&o!==null&&ve(o),e.callbackPriority=2,e.callbackNode=null,2}function Ng(e,t){if(An!==0&&An!==5)return e.callbackNode=null,e.callbackPriority=0,null;var r=e.callbackNode;if(kc()&&e.callbackNode!==r)return null;var o=At;return o=Qn(e,e===Kt?o:0,e.cancelPendingCommit!==null||e.timeoutHandle!==-1),o===0?null:(cg(e,o,t),Ag(e,Oe()),e.callbackNode!=null&&e.callbackNode===r?Ng.bind(null,e):null)}function Dg(e,t){if(kc())return null;cg(e,t,!0)}function mx(){Tx(function(){(Lt&6)!==0?ye(He,hx):Tg()})}function bf(){if(xs===0){var e=Ai;e===0&&(e=Nr,Nr<<=1,(Nr&261888)===0&&(Nr=256)),xs=e}return xs}function Cg(e){return e==null||typeof e=="symbol"||typeof e=="boolean"?null:typeof e=="function"?e:ts(""+e)}function Og(e,t){var r=t.ownerDocument.createElement("input");return r.name=t.name,r.value=t.value,e.id&&r.setAttribute("form",e.id),t.parentNode.insertBefore(r,t),e=new FormData(e),r.parentNode.removeChild(r),e}function px(e,t,r,o,f){if(t==="submit"&&r&&r.stateNode===f){var g=Cg((f[Rt]||null).action),T=o.submitter;T&&(t=(t=T[Rt]||null)?Cg(t.formAction):T.getAttribute("formAction"),t!==null&&(g=t,T=null));var H=new je("action","action",null,o,f);e.push({event:H,listeners:[{instance:null,listener:function(){if(o.defaultPrevented){if(xs!==0){var ae=T?Og(f,T):new FormData(f);zd(r,{pending:!0,data:ae,method:f.method,action:g},null,ae)}}else typeof g=="function"&&(H.preventDefault(),ae=T?Og(f,T):new FormData(f),zd(r,{pending:!0,data:ae,method:f.method,action:g},g,ae))},currentTarget:f}]})}}for(var xf=0;xf<td.length;xf++){var _f=td[xf],gx=_f.toLowerCase(),yx=_f[0].toUpperCase()+_f.slice(1);Kr(gx,"on"+yx)}Kr(lm,"onAnimationEnd"),Kr(cm,"onAnimationIteration"),Kr(um,"onAnimationStart"),Kr("dblclick","onDoubleClick"),Kr("focusin","onFocus"),Kr("focusout","onBlur"),Kr(I0,"onTransitionRun"),Kr(R0,"onTransitionStart"),Kr(M0,"onTransitionCancel"),Kr(dm,"onTransitionEnd"),Pn("onMouseEnter",["mouseout","mouseover"]),Pn("onMouseLeave",["mouseout","mouseover"]),Pn("onPointerEnter",["pointerout","pointerover"]),Pn("onPointerLeave",["pointerout","pointerover"]),en("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),en("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),en("onBeforeInput",["compositionend","keypress","textInput","paste"]),en("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),en("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),en("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Yo="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),vx=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Yo));function jg(e,t){t=(t&4)!==0;for(var r=0;r<e.length;r++){var o=e[r],f=o.event;o=o.listeners;e:{var g=void 0;if(t)for(var T=o.length-1;0<=T;T--){var H=o[T],ae=H.instance,Se=H.currentTarget;if(H=H.listener,ae!==g&&f.isPropagationStopped())break e;g=H,f.currentTarget=Se;try{g(f)}catch(De){Gl(De)}f.currentTarget=null,g=ae}else for(T=0;T<o.length;T++){if(H=o[T],ae=H.instance,Se=H.currentTarget,H=H.listener,ae!==g&&f.isPropagationStopped())break e;g=H,f.currentTarget=Se;try{g(f)}catch(De){Gl(De)}f.currentTarget=null,g=ae}}}}function kt(e,t){var r=t[Za];r===void 0&&(r=t[Za]=new Set);var o=e+"__bubble";r.has(o)||(Ig(t,e,2,!1),r.add(o))}function Sf(e,t,r){var o=0;t&&(o|=4),Ig(r,e,o,t)}var Nc="_reactListening"+Math.random().toString(36).slice(2);function wf(e){if(!e[Nc]){e[Nc]=!0,_n.forEach(function(r){r!=="selectionchange"&&(vx.has(r)||Sf(r,!1,e),Sf(r,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[Nc]||(t[Nc]=!0,Sf("selectionchange",!1,t))}}function Ig(e,t,r,o){switch(ly(t)){case 2:var f=$x;break;case 8:f=Vx;break;default:f=zf}r=f.bind(null,t,r,e),f=void 0,!Ea||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(f=!0),o?f!==void 0?e.addEventListener(t,r,{capture:!0,passive:f}):e.addEventListener(t,r,!0):f!==void 0?e.addEventListener(t,r,{passive:f}):e.addEventListener(t,r,!1)}function Ef(e,t,r,o,f){var g=o;if((t&1)===0&&(t&2)===0&&o!==null)e:for(;;){if(o===null)return;var T=o.tag;if(T===3||T===4){var H=o.stateNode.containerInfo;if(H===f)break;if(T===4)for(T=o.return;T!==null;){var ae=T.tag;if((ae===3||ae===4)&&T.stateNode.containerInfo===f)return;T=T.return}for(;H!==null;){if(T=$e(H),T===null)return;if(ae=T.tag,ae===5||ae===6||ae===26||ae===27){o=g=T;continue e}H=H.parentNode}}o=o.return}Ms(function(){var Se=g,De=ns(r),Re=[];e:{var we=fm.get(e);if(we!==void 0){var Ae=je,Je=e;switch(e){case"keypress":if(b(r)===0)break e;case"keydown":case"keyup":Ae=Bu;break;case"focusin":Je="focus",Ae=po;break;case"focusout":Je="blur",Ae=po;break;case"beforeblur":case"afterblur":Ae=po;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Ae=Rl;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Ae=Cu;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Ae=Gu;break;case lm:case cm:case um:Ae=ju;break;case dm:Ae=Pu;break;case"scroll":case"scrollend":Ae=Dt;break;case"wheel":Ae=$u;break;case"copy":case"cut":case"paste":Ae=Ru;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Ae=Fl;break;case"toggle":case"beforetoggle":Ae=Hl}var lt=(t&4)!==0,Vt=!lt&&(e==="scroll"||e==="scrollend"),pe=lt?we!==null?we+"Capture":null:we;lt=[];for(var ce=Se,_e;ce!==null;){var Ie=ce;if(_e=Ie.stateNode,Ie=Ie.tag,Ie!==5&&Ie!==26&&Ie!==27||_e===null||pe===null||(Ie=oa(ce,pe),Ie!=null&&lt.push($o(ce,Ie,_e))),Vt)break;ce=ce.return}0<lt.length&&(we=new Ae(we,Je,null,r,De),Re.push({event:we,listeners:lt}))}}if((t&7)===0){e:{if(we=e==="mouseover"||e==="pointerover",Ae=e==="mouseout"||e==="pointerout",we&&r!==ia&&(Je=r.relatedTarget||r.fromElement)&&($e(Je)||Je[Or]))break e;if((Ae||we)&&(we=De.window===De?De:(we=De.ownerDocument)?we.defaultView||we.parentWindow:window,Ae?(Je=r.relatedTarget||r.toElement,Ae=Se,Je=Je?$e(Je):null,Je!==null&&(Vt=c(Je),lt=Je.tag,Je!==Vt||lt!==5&&lt!==27&&lt!==6)&&(Je=null)):(Ae=null,Je=Se),Ae!==Je)){if(lt=Rl,Ie="onMouseLeave",pe="onMouseEnter",ce="mouse",(e==="pointerout"||e==="pointerover")&&(lt=Fl,Ie="onPointerLeave",pe="onPointerEnter",ce="pointer"),Vt=Ae==null?we:Wt(Ae),_e=Je==null?we:Wt(Je),we=new lt(Ie,ce+"leave",Ae,r,De),we.target=Vt,we.relatedTarget=_e,Ie=null,$e(De)===Se&&(lt=new lt(pe,ce+"enter",Je,r,De),lt.target=_e,lt.relatedTarget=Vt,Ie=lt),Vt=Ie,Ae&&Je)t:{for(lt=bx,pe=Ae,ce=Je,_e=0,Ie=pe;Ie;Ie=lt(Ie))_e++;Ie=0;for(var rt=ce;rt;rt=lt(rt))Ie++;for(;0<_e-Ie;)pe=lt(pe),_e--;for(;0<Ie-_e;)ce=lt(ce),Ie--;for(;_e--;){if(pe===ce||ce!==null&&pe===ce.alternate){lt=pe;break t}pe=lt(pe),ce=lt(ce)}lt=null}else lt=null;Ae!==null&&Rg(Re,we,Ae,lt,!1),Je!==null&&Vt!==null&&Rg(Re,Vt,Je,lt,!0)}}e:{if(we=Se?Wt(Se):window,Ae=we.nodeName&&we.nodeName.toLowerCase(),Ae==="select"||Ae==="input"&&we.type==="file")var Mt=Jh;else if(Kn(we))if(Xh)Mt=C0;else{Mt=N0;var et=A0}else Ae=we.nodeName,!Ae||Ae.toLowerCase()!=="input"||we.type!=="checkbox"&&we.type!=="radio"?Se&&es(Se.elementType)&&(Mt=Jh):Mt=D0;if(Mt&&(Mt=Mt(e,Se))){Yn(Re,Mt,r,De);break e}et&&et(e,we,Se),e==="focusout"&&Se&&we.type==="number"&&Se.memoizedProps.value!=null&&fo(we,"number",we.value)}switch(et=Se?Wt(Se):window,e){case"focusin":(Kn(et)||et.contentEditable==="true")&&(bi=et,Xu=Se,_o=null);break;case"focusout":_o=Xu=bi=null;break;case"mousedown":Wu=!0;break;case"contextmenu":case"mouseup":case"dragend":Wu=!1,im(Re,r,De);break;case"selectionchange":if(j0)break;case"keydown":case"keyup":im(Re,r,De)}var vt;if(yo)e:{switch(e){case"compositionstart":var Nt="onCompositionStart";break e;case"compositionend":Nt="onCompositionEnd";break e;case"compositionupdate":Nt="onCompositionUpdate";break e}Nt=void 0}else ot?Ue(e,r)&&(Nt="onCompositionEnd"):e==="keydown"&&r.keyCode===229&&(Nt="onCompositionStart");Nt&&(vo&&r.locale!=="ko"&&(ot||Nt!=="onCompositionStart"?Nt==="onCompositionEnd"&&ot&&(vt=y()):(Mn=De,as="value"in Mn?Mn.value:Mn.textContent,ot=!0)),et=Dc(Se,Nt),0<et.length&&(Nt=new Ll(Nt,e,null,r,De),Re.push({event:Nt,listeners:et}),vt?Nt.data=vt:(vt=We(r),vt!==null&&(Nt.data=vt)))),(vt=yi?xt(e,r):Pt(e,r))&&(Nt=Dc(Se,"onBeforeInput"),0<Nt.length&&(et=new Ll("onBeforeInput","beforeinput",null,r,De),Re.push({event:et,listeners:Nt}),et.data=vt)),px(Re,e,Se,r,De)}jg(Re,t)})}function $o(e,t,r){return{instance:e,listener:t,currentTarget:r}}function Dc(e,t){for(var r=t+"Capture",o=[];e!==null;){var f=e,g=f.stateNode;if(f=f.tag,f!==5&&f!==26&&f!==27||g===null||(f=oa(e,r),f!=null&&o.unshift($o(e,f,g)),f=oa(e,t),f!=null&&o.push($o(e,f,g))),e.tag===3)return o;e=e.return}return[]}function bx(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5&&e.tag!==27);return e||null}function Rg(e,t,r,o,f){for(var g=t._reactName,T=[];r!==null&&r!==o;){var H=r,ae=H.alternate,Se=H.stateNode;if(H=H.tag,ae!==null&&ae===o)break;H!==5&&H!==26&&H!==27||Se===null||(ae=Se,f?(Se=oa(r,g),Se!=null&&T.unshift($o(r,Se,ae))):f||(Se=oa(r,g),Se!=null&&T.push($o(r,Se,ae)))),r=r.return}T.length!==0&&e.push({event:t,listeners:T})}var xx=/\r\n?/g,_x=/\u0000|\uFFFD/g;function Mg(e){return(typeof e=="string"?e:""+e).replace(xx,`
`).replace(_x,"")}function Ug(e,t){return t=Mg(t),Mg(e)===t}function $t(e,t,r,o,f,g){switch(r){case"children":typeof o=="string"?t==="body"||t==="textarea"&&o===""||_a(e,o):(typeof o=="number"||typeof o=="bigint")&&t!=="body"&&_a(e,""+o);break;case"className":Rs(e,"class",o);break;case"tabIndex":Rs(e,"tabindex",o);break;case"dir":case"role":case"viewBox":case"width":case"height":Rs(e,r,o);break;case"style":Il(e,o,g);break;case"data":if(t!=="object"){Rs(e,"data",o);break}case"src":case"href":if(o===""&&(t!=="a"||r!=="href")){e.removeAttribute(r);break}if(o==null||typeof o=="function"||typeof o=="symbol"||typeof o=="boolean"){e.removeAttribute(r);break}o=ts(""+o),e.setAttribute(r,o);break;case"action":case"formAction":if(typeof o=="function"){e.setAttribute(r,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof g=="function"&&(r==="formAction"?(t!=="input"&&$t(e,t,"name",f.name,f,null),$t(e,t,"formEncType",f.formEncType,f,null),$t(e,t,"formMethod",f.formMethod,f,null),$t(e,t,"formTarget",f.formTarget,f,null)):($t(e,t,"encType",f.encType,f,null),$t(e,t,"method",f.method,f,null),$t(e,t,"target",f.target,f,null)));if(o==null||typeof o=="symbol"||typeof o=="boolean"){e.removeAttribute(r);break}o=ts(""+o),e.setAttribute(r,o);break;case"onClick":o!=null&&(e.onclick=Tn);break;case"onScroll":o!=null&&kt("scroll",e);break;case"onScrollEnd":o!=null&&kt("scrollend",e);break;case"dangerouslySetInnerHTML":if(o!=null){if(typeof o!="object"||!("__html"in o))throw Error(i(61));if(r=o.__html,r!=null){if(f.children!=null)throw Error(i(60));e.innerHTML=r}}break;case"multiple":e.multiple=o&&typeof o!="function"&&typeof o!="symbol";break;case"muted":e.muted=o&&typeof o!="function"&&typeof o!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(o==null||typeof o=="function"||typeof o=="boolean"||typeof o=="symbol"){e.removeAttribute("xlink:href");break}r=ts(""+o),e.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",r);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":o!=null&&typeof o!="function"&&typeof o!="symbol"?e.setAttribute(r,""+o):e.removeAttribute(r);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":o&&typeof o!="function"&&typeof o!="symbol"?e.setAttribute(r,""):e.removeAttribute(r);break;case"capture":case"download":o===!0?e.setAttribute(r,""):o!==!1&&o!=null&&typeof o!="function"&&typeof o!="symbol"?e.setAttribute(r,o):e.removeAttribute(r);break;case"cols":case"rows":case"size":case"span":o!=null&&typeof o!="function"&&typeof o!="symbol"&&!isNaN(o)&&1<=o?e.setAttribute(r,o):e.removeAttribute(r);break;case"rowSpan":case"start":o==null||typeof o=="function"||typeof o=="symbol"||isNaN(o)?e.removeAttribute(r):e.setAttribute(r,o);break;case"popover":kt("beforetoggle",e),kt("toggle",e),ui(e,"popover",o);break;case"xlinkActuate":jr(e,"http://www.w3.org/1999/xlink","xlink:actuate",o);break;case"xlinkArcrole":jr(e,"http://www.w3.org/1999/xlink","xlink:arcrole",o);break;case"xlinkRole":jr(e,"http://www.w3.org/1999/xlink","xlink:role",o);break;case"xlinkShow":jr(e,"http://www.w3.org/1999/xlink","xlink:show",o);break;case"xlinkTitle":jr(e,"http://www.w3.org/1999/xlink","xlink:title",o);break;case"xlinkType":jr(e,"http://www.w3.org/1999/xlink","xlink:type",o);break;case"xmlBase":jr(e,"http://www.w3.org/XML/1998/namespace","xml:base",o);break;case"xmlLang":jr(e,"http://www.w3.org/XML/1998/namespace","xml:lang",o);break;case"xmlSpace":jr(e,"http://www.w3.org/XML/1998/namespace","xml:space",o);break;case"is":ui(e,"is",o);break;case"innerText":case"textContent":break;default:(!(2<r.length)||r[0]!=="o"&&r[0]!=="O"||r[1]!=="n"&&r[1]!=="N")&&(r=pi.get(r)||r,ui(e,r,o))}}function kf(e,t,r,o,f,g){switch(r){case"style":Il(e,o,g);break;case"dangerouslySetInnerHTML":if(o!=null){if(typeof o!="object"||!("__html"in o))throw Error(i(61));if(r=o.__html,r!=null){if(f.children!=null)throw Error(i(60));e.innerHTML=r}}break;case"children":typeof o=="string"?_a(e,o):(typeof o=="number"||typeof o=="bigint")&&_a(e,""+o);break;case"onScroll":o!=null&&kt("scroll",e);break;case"onScrollEnd":o!=null&&kt("scrollend",e);break;case"onClick":o!=null&&(e.onclick=Tn);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!hr.hasOwnProperty(r))e:{if(r[0]==="o"&&r[1]==="n"&&(f=r.endsWith("Capture"),t=r.slice(2,f?r.length-7:void 0),g=e[Rt]||null,g=g!=null?g[r]:null,typeof g=="function"&&e.removeEventListener(t,g,f),typeof o=="function")){typeof g!="function"&&g!==null&&(r in e?e[r]=null:e.hasAttribute(r)&&e.removeAttribute(r)),e.addEventListener(t,o,f);break e}r in e?e[r]=o:o===!0?e.setAttribute(r,""):ui(e,r,o)}}}function Bn(e,t,r){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":kt("error",e),kt("load",e);var o=!1,f=!1,g;for(g in r)if(r.hasOwnProperty(g)){var T=r[g];if(T!=null)switch(g){case"src":o=!0;break;case"srcSet":f=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(i(137,t));default:$t(e,t,g,T,r,null)}}f&&$t(e,t,"srcSet",r.srcSet,r,null),o&&$t(e,t,"src",r.src,r,null);return;case"input":kt("invalid",e);var H=g=T=f=null,ae=null,Se=null;for(o in r)if(r.hasOwnProperty(o)){var De=r[o];if(De!=null)switch(o){case"name":f=De;break;case"type":T=De;break;case"checked":ae=De;break;case"defaultChecked":Se=De;break;case"value":g=De;break;case"defaultValue":H=De;break;case"children":case"dangerouslySetInnerHTML":if(De!=null)throw Error(i(137,t));break;default:$t(e,t,o,De,r,null)}}Xa(e,g,H,ae,Se,T,f,!1);return;case"select":kt("invalid",e),o=T=g=null;for(f in r)if(r.hasOwnProperty(f)&&(H=r[f],H!=null))switch(f){case"value":g=H;break;case"defaultValue":T=H;break;case"multiple":o=H;default:$t(e,t,f,H,r,null)}t=g,r=T,e.multiple=!!o,t!=null?Wa(e,!!o,t,!1):r!=null&&Wa(e,!!o,r,!0);return;case"textarea":kt("invalid",e),g=f=o=null;for(T in r)if(r.hasOwnProperty(T)&&(H=r[T],H!=null))switch(T){case"value":o=H;break;case"defaultValue":f=H;break;case"children":g=H;break;case"dangerouslySetInnerHTML":if(H!=null)throw Error(i(91));break;default:$t(e,t,T,H,r,null)}hi(e,o,f,g);return;case"option":for(ae in r)if(r.hasOwnProperty(ae)&&(o=r[ae],o!=null))switch(ae){case"selected":e.selected=o&&typeof o!="function"&&typeof o!="symbol";break;default:$t(e,t,ae,o,r,null)}return;case"dialog":kt("beforetoggle",e),kt("toggle",e),kt("cancel",e),kt("close",e);break;case"iframe":case"object":kt("load",e);break;case"video":case"audio":for(o=0;o<Yo.length;o++)kt(Yo[o],e);break;case"image":kt("error",e),kt("load",e);break;case"details":kt("toggle",e);break;case"embed":case"source":case"link":kt("error",e),kt("load",e);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(Se in r)if(r.hasOwnProperty(Se)&&(o=r[Se],o!=null))switch(Se){case"children":case"dangerouslySetInnerHTML":throw Error(i(137,t));default:$t(e,t,Se,o,r,null)}return;default:if(es(t)){for(De in r)r.hasOwnProperty(De)&&(o=r[De],o!==void 0&&kf(e,t,De,o,r,void 0));return}}for(H in r)r.hasOwnProperty(H)&&(o=r[H],o!=null&&$t(e,t,H,o,r,null))}function Sx(e,t,r,o){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var f=null,g=null,T=null,H=null,ae=null,Se=null,De=null;for(Ae in r){var Re=r[Ae];if(r.hasOwnProperty(Ae)&&Re!=null)switch(Ae){case"checked":break;case"value":break;case"defaultValue":ae=Re;default:o.hasOwnProperty(Ae)||$t(e,t,Ae,null,o,Re)}}for(var we in o){var Ae=o[we];if(Re=r[we],o.hasOwnProperty(we)&&(Ae!=null||Re!=null))switch(we){case"type":g=Ae;break;case"name":f=Ae;break;case"checked":Se=Ae;break;case"defaultChecked":De=Ae;break;case"value":T=Ae;break;case"defaultValue":H=Ae;break;case"children":case"dangerouslySetInnerHTML":if(Ae!=null)throw Error(i(137,t));break;default:Ae!==Re&&$t(e,t,we,Ae,o,Re)}}Ja(e,T,H,ae,Se,De,g,f);return;case"select":Ae=T=H=we=null;for(g in r)if(ae=r[g],r.hasOwnProperty(g)&&ae!=null)switch(g){case"value":break;case"multiple":Ae=ae;default:o.hasOwnProperty(g)||$t(e,t,g,null,o,ae)}for(f in o)if(g=o[f],ae=r[f],o.hasOwnProperty(f)&&(g!=null||ae!=null))switch(f){case"value":we=g;break;case"defaultValue":H=g;break;case"multiple":T=g;default:g!==ae&&$t(e,t,f,g,o,ae)}t=H,r=T,o=Ae,we!=null?Wa(e,!!r,we,!1):!!o!=!!r&&(t!=null?Wa(e,!!r,t,!0):Wa(e,!!r,r?[]:"",!1));return;case"textarea":Ae=we=null;for(H in r)if(f=r[H],r.hasOwnProperty(H)&&f!=null&&!o.hasOwnProperty(H))switch(H){case"value":break;case"children":break;default:$t(e,t,H,null,o,f)}for(T in o)if(f=o[T],g=r[T],o.hasOwnProperty(T)&&(f!=null||g!=null))switch(T){case"value":we=f;break;case"defaultValue":Ae=f;break;case"children":break;case"dangerouslySetInnerHTML":if(f!=null)throw Error(i(91));break;default:f!==g&&$t(e,t,T,f,o,g)}ho(e,we,Ae);return;case"option":for(var Je in r)if(we=r[Je],r.hasOwnProperty(Je)&&we!=null&&!o.hasOwnProperty(Je))switch(Je){case"selected":e.selected=!1;break;default:$t(e,t,Je,null,o,we)}for(ae in o)if(we=o[ae],Ae=r[ae],o.hasOwnProperty(ae)&&we!==Ae&&(we!=null||Ae!=null))switch(ae){case"selected":e.selected=we&&typeof we!="function"&&typeof we!="symbol";break;default:$t(e,t,ae,we,o,Ae)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var lt in r)we=r[lt],r.hasOwnProperty(lt)&&we!=null&&!o.hasOwnProperty(lt)&&$t(e,t,lt,null,o,we);for(Se in o)if(we=o[Se],Ae=r[Se],o.hasOwnProperty(Se)&&we!==Ae&&(we!=null||Ae!=null))switch(Se){case"children":case"dangerouslySetInnerHTML":if(we!=null)throw Error(i(137,t));break;default:$t(e,t,Se,we,o,Ae)}return;default:if(es(t)){for(var Vt in r)we=r[Vt],r.hasOwnProperty(Vt)&&we!==void 0&&!o.hasOwnProperty(Vt)&&kf(e,t,Vt,void 0,o,we);for(De in o)we=o[De],Ae=r[De],!o.hasOwnProperty(De)||we===Ae||we===void 0&&Ae===void 0||kf(e,t,De,we,o,Ae);return}}for(var pe in r)we=r[pe],r.hasOwnProperty(pe)&&we!=null&&!o.hasOwnProperty(pe)&&$t(e,t,pe,null,o,we);for(Re in o)we=o[Re],Ae=r[Re],!o.hasOwnProperty(Re)||we===Ae||we==null&&Ae==null||$t(e,t,Re,we,o,Ae)}function Lg(e){switch(e){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function wx(){if(typeof performance.getEntriesByType=="function"){for(var e=0,t=0,r=performance.getEntriesByType("resource"),o=0;o<r.length;o++){var f=r[o],g=f.transferSize,T=f.initiatorType,H=f.duration;if(g&&H&&Lg(T)){for(T=0,H=f.responseEnd,o+=1;o<r.length;o++){var ae=r[o],Se=ae.startTime;if(Se>H)break;var De=ae.transferSize,Re=ae.initiatorType;De&&Lg(Re)&&(ae=ae.responseEnd,T+=De*(ae<H?1:(H-Se)/(ae-Se)))}if(--o,t+=8*(g+T)/(f.duration/1e3),e++,10<e)break}}if(0<e)return t/e/1e6}return navigator.connection&&(e=navigator.connection.downlink,typeof e=="number")?e:5}var Tf=null,Af=null;function Cc(e){return e.nodeType===9?e:e.ownerDocument}function zg(e){switch(e){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function Fg(e,t){if(e===0)switch(t){case"svg":return 1;case"math":return 2;default:return 0}return e===1&&t==="foreignObject"?0:e}function Nf(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.children=="bigint"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var Df=null;function Ex(){var e=window.event;return e&&e.type==="popstate"?e===Df?!1:(Df=e,!0):(Df=null,!1)}var Bg=typeof setTimeout=="function"?setTimeout:void 0,kx=typeof clearTimeout=="function"?clearTimeout:void 0,Hg=typeof Promise=="function"?Promise:void 0,Tx=typeof queueMicrotask=="function"?queueMicrotask:typeof Hg<"u"?function(e){return Hg.resolve(null).then(e).catch(Ax)}:Bg;function Ax(e){setTimeout(function(){throw e})}function _s(e){return e==="head"}function Gg(e,t){var r=t,o=0;do{var f=r.nextSibling;if(e.removeChild(r),f&&f.nodeType===8)if(r=f.data,r==="/$"||r==="/&"){if(o===0){e.removeChild(f),$i(t);return}o--}else if(r==="$"||r==="$?"||r==="$~"||r==="$!"||r==="&")o++;else if(r==="html")Vo(e.ownerDocument.documentElement);else if(r==="head"){r=e.ownerDocument.head,Vo(r);for(var g=r.firstChild;g;){var T=g.nextSibling,H=g.nodeName;g[le]||H==="SCRIPT"||H==="STYLE"||H==="LINK"&&g.rel.toLowerCase()==="stylesheet"||r.removeChild(g),g=T}}else r==="body"&&Vo(e.ownerDocument.body);r=f}while(r);$i(t)}function qg(e,t){var r=e;e=0;do{var o=r.nextSibling;if(r.nodeType===1?t?(r._stashedDisplay=r.style.display,r.style.display="none"):(r.style.display=r._stashedDisplay||"",r.getAttribute("style")===""&&r.removeAttribute("style")):r.nodeType===3&&(t?(r._stashedText=r.nodeValue,r.nodeValue=""):r.nodeValue=r._stashedText||""),o&&o.nodeType===8)if(r=o.data,r==="/$"){if(e===0)break;e--}else r!=="$"&&r!=="$?"&&r!=="$~"&&r!=="$!"||e++;r=o}while(r)}function Cf(e){var t=e.firstChild;for(t&&t.nodeType===10&&(t=t.nextSibling);t;){var r=t;switch(t=t.nextSibling,r.nodeName){case"HTML":case"HEAD":case"BODY":Cf(r),Le(r);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(r.rel.toLowerCase()==="stylesheet")continue}e.removeChild(r)}}function Nx(e,t,r,o){for(;e.nodeType===1;){var f=r;if(e.nodeName.toLowerCase()!==t.toLowerCase()){if(!o&&(e.nodeName!=="INPUT"||e.type!=="hidden"))break}else if(o){if(!e[le])switch(t){case"meta":if(!e.hasAttribute("itemprop"))break;return e;case"link":if(g=e.getAttribute("rel"),g==="stylesheet"&&e.hasAttribute("data-precedence"))break;if(g!==f.rel||e.getAttribute("href")!==(f.href==null||f.href===""?null:f.href)||e.getAttribute("crossorigin")!==(f.crossOrigin==null?null:f.crossOrigin)||e.getAttribute("title")!==(f.title==null?null:f.title))break;return e;case"style":if(e.hasAttribute("data-precedence"))break;return e;case"script":if(g=e.getAttribute("src"),(g!==(f.src==null?null:f.src)||e.getAttribute("type")!==(f.type==null?null:f.type)||e.getAttribute("crossorigin")!==(f.crossOrigin==null?null:f.crossOrigin))&&g&&e.hasAttribute("async")&&!e.hasAttribute("itemprop"))break;return e;default:return e}}else if(t==="input"&&e.type==="hidden"){var g=f.name==null?null:""+f.name;if(f.type==="hidden"&&e.getAttribute("name")===g)return e}else return e;if(e=Hr(e.nextSibling),e===null)break}return null}function Dx(e,t,r){if(t==="")return null;for(;e.nodeType!==3;)if((e.nodeType!==1||e.nodeName!=="INPUT"||e.type!=="hidden")&&!r||(e=Hr(e.nextSibling),e===null))return null;return e}function Pg(e,t){for(;e.nodeType!==8;)if((e.nodeType!==1||e.nodeName!=="INPUT"||e.type!=="hidden")&&!t||(e=Hr(e.nextSibling),e===null))return null;return e}function Of(e){return e.data==="$?"||e.data==="$~"}function jf(e){return e.data==="$!"||e.data==="$?"&&e.ownerDocument.readyState!=="loading"}function Cx(e,t){var r=e.ownerDocument;if(e.data==="$~")e._reactRetry=t;else if(e.data!=="$?"||r.readyState!=="loading")t();else{var o=function(){t(),r.removeEventListener("DOMContentLoaded",o)};r.addEventListener("DOMContentLoaded",o),e._reactRetry=o}}function Hr(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?"||t==="$~"||t==="&"||t==="F!"||t==="F")break;if(t==="/$"||t==="/&")return null}}return e}var If=null;function Yg(e){e=e.nextSibling;for(var t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="/$"||r==="/&"){if(t===0)return Hr(e.nextSibling);t--}else r!=="$"&&r!=="$!"&&r!=="$?"&&r!=="$~"&&r!=="&"||t++}e=e.nextSibling}return null}function $g(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="$"||r==="$!"||r==="$?"||r==="$~"||r==="&"){if(t===0)return e;t--}else r!=="/$"&&r!=="/&"||t++}e=e.previousSibling}return null}function Vg(e,t,r){switch(t=Cc(r),e){case"html":if(e=t.documentElement,!e)throw Error(i(452));return e;case"head":if(e=t.head,!e)throw Error(i(453));return e;case"body":if(e=t.body,!e)throw Error(i(454));return e;default:throw Error(i(451))}}function Vo(e){for(var t=e.attributes;t.length;)e.removeAttributeNode(t[0]);Le(e)}var Gr=new Map,Zg=new Set;function Oc(e){return typeof e.getRootNode=="function"?e.getRootNode():e.nodeType===9?e:e.ownerDocument}var Ha=Y.d;Y.d={f:Ox,r:jx,D:Ix,C:Rx,L:Mx,m:Ux,X:zx,S:Lx,M:Fx};function Ox(){var e=Ha.f(),t=Sc();return e||t}function jx(e){var t=ct(e);t!==null&&t.tag===5&&t.type==="form"?dp(t):Ha.r(e)}var qi=typeof document>"u"?null:document;function Qg(e,t,r){var o=qi;if(o&&typeof t=="string"&&t){var f=Rn(t);f='link[rel="'+e+'"][href="'+f+'"]',typeof r=="string"&&(f+='[crossorigin="'+r+'"]'),Zg.has(f)||(Zg.add(f),e={rel:e,crossOrigin:r,href:t},o.querySelector(f)===null&&(t=o.createElement("link"),Bn(t,"link",e),wt(t),o.head.appendChild(t)))}}function Ix(e){Ha.D(e),Qg("dns-prefetch",e,null)}function Rx(e,t){Ha.C(e,t),Qg("preconnect",e,t)}function Mx(e,t,r){Ha.L(e,t,r);var o=qi;if(o&&e&&t){var f='link[rel="preload"][as="'+Rn(t)+'"]';t==="image"&&r&&r.imageSrcSet?(f+='[imagesrcset="'+Rn(r.imageSrcSet)+'"]',typeof r.imageSizes=="string"&&(f+='[imagesizes="'+Rn(r.imageSizes)+'"]')):f+='[href="'+Rn(e)+'"]';var g=f;switch(t){case"style":g=Pi(e);break;case"script":g=Yi(e)}Gr.has(g)||(e=S({rel:"preload",href:t==="image"&&r&&r.imageSrcSet?void 0:e,as:t},r),Gr.set(g,e),o.querySelector(f)!==null||t==="style"&&o.querySelector(Zo(g))||t==="script"&&o.querySelector(Qo(g))||(t=o.createElement("link"),Bn(t,"link",e),wt(t),o.head.appendChild(t)))}}function Ux(e,t){Ha.m(e,t);var r=qi;if(r&&e){var o=t&&typeof t.as=="string"?t.as:"script",f='link[rel="modulepreload"][as="'+Rn(o)+'"][href="'+Rn(e)+'"]',g=f;switch(o){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":g=Yi(e)}if(!Gr.has(g)&&(e=S({rel:"modulepreload",href:e},t),Gr.set(g,e),r.querySelector(f)===null)){switch(o){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(r.querySelector(Qo(g)))return}o=r.createElement("link"),Bn(o,"link",e),wt(o),r.head.appendChild(o)}}}function Lx(e,t,r){Ha.S(e,t,r);var o=qi;if(o&&e){var f=Jt(o).hoistableStyles,g=Pi(e);t=t||"default";var T=f.get(g);if(!T){var H={loading:0,preload:null};if(T=o.querySelector(Zo(g)))H.loading=5;else{e=S({rel:"stylesheet",href:e,"data-precedence":t},r),(r=Gr.get(g))&&Rf(e,r);var ae=T=o.createElement("link");wt(ae),Bn(ae,"link",e),ae._p=new Promise(function(Se,De){ae.onload=Se,ae.onerror=De}),ae.addEventListener("load",function(){H.loading|=1}),ae.addEventListener("error",function(){H.loading|=2}),H.loading|=4,jc(T,t,o)}T={type:"stylesheet",instance:T,count:1,state:H},f.set(g,T)}}}function zx(e,t){Ha.X(e,t);var r=qi;if(r&&e){var o=Jt(r).hoistableScripts,f=Yi(e),g=o.get(f);g||(g=r.querySelector(Qo(f)),g||(e=S({src:e,async:!0},t),(t=Gr.get(f))&&Mf(e,t),g=r.createElement("script"),wt(g),Bn(g,"link",e),r.head.appendChild(g)),g={type:"script",instance:g,count:1,state:null},o.set(f,g))}}function Fx(e,t){Ha.M(e,t);var r=qi;if(r&&e){var o=Jt(r).hoistableScripts,f=Yi(e),g=o.get(f);g||(g=r.querySelector(Qo(f)),g||(e=S({src:e,async:!0,type:"module"},t),(t=Gr.get(f))&&Mf(e,t),g=r.createElement("script"),wt(g),Bn(g,"link",e),r.head.appendChild(g)),g={type:"script",instance:g,count:1,state:null},o.set(f,g))}}function Kg(e,t,r,o){var f=(f=fe.current)?Oc(f):null;if(!f)throw Error(i(446));switch(e){case"meta":case"title":return null;case"style":return typeof r.precedence=="string"&&typeof r.href=="string"?(t=Pi(r.href),r=Jt(f).hoistableStyles,o=r.get(t),o||(o={type:"style",instance:null,count:0,state:null},r.set(t,o)),o):{type:"void",instance:null,count:0,state:null};case"link":if(r.rel==="stylesheet"&&typeof r.href=="string"&&typeof r.precedence=="string"){e=Pi(r.href);var g=Jt(f).hoistableStyles,T=g.get(e);if(T||(f=f.ownerDocument||f,T={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},g.set(e,T),(g=f.querySelector(Zo(e)))&&!g._p&&(T.instance=g,T.state.loading=5),Gr.has(e)||(r={rel:"preload",as:"style",href:r.href,crossOrigin:r.crossOrigin,integrity:r.integrity,media:r.media,hrefLang:r.hrefLang,referrerPolicy:r.referrerPolicy},Gr.set(e,r),g||Bx(f,e,r,T.state))),t&&o===null)throw Error(i(528,""));return T}if(t&&o!==null)throw Error(i(529,""));return null;case"script":return t=r.async,r=r.src,typeof r=="string"&&t&&typeof t!="function"&&typeof t!="symbol"?(t=Yi(r),r=Jt(f).hoistableScripts,o=r.get(t),o||(o={type:"script",instance:null,count:0,state:null},r.set(t,o)),o):{type:"void",instance:null,count:0,state:null};default:throw Error(i(444,e))}}function Pi(e){return'href="'+Rn(e)+'"'}function Zo(e){return'link[rel="stylesheet"]['+e+"]"}function Jg(e){return S({},e,{"data-precedence":e.precedence,precedence:null})}function Bx(e,t,r,o){e.querySelector('link[rel="preload"][as="style"]['+t+"]")?o.loading=1:(t=e.createElement("link"),o.preload=t,t.addEventListener("load",function(){return o.loading|=1}),t.addEventListener("error",function(){return o.loading|=2}),Bn(t,"link",r),wt(t),e.head.appendChild(t))}function Yi(e){return'[src="'+Rn(e)+'"]'}function Qo(e){return"script[async]"+e}function Xg(e,t,r){if(t.count++,t.instance===null)switch(t.type){case"style":var o=e.querySelector('style[data-href~="'+Rn(r.href)+'"]');if(o)return t.instance=o,wt(o),o;var f=S({},r,{"data-href":r.href,"data-precedence":r.precedence,href:null,precedence:null});return o=(e.ownerDocument||e).createElement("style"),wt(o),Bn(o,"style",f),jc(o,r.precedence,e),t.instance=o;case"stylesheet":f=Pi(r.href);var g=e.querySelector(Zo(f));if(g)return t.state.loading|=4,t.instance=g,wt(g),g;o=Jg(r),(f=Gr.get(f))&&Rf(o,f),g=(e.ownerDocument||e).createElement("link"),wt(g);var T=g;return T._p=new Promise(function(H,ae){T.onload=H,T.onerror=ae}),Bn(g,"link",o),t.state.loading|=4,jc(g,r.precedence,e),t.instance=g;case"script":return g=Yi(r.src),(f=e.querySelector(Qo(g)))?(t.instance=f,wt(f),f):(o=r,(f=Gr.get(g))&&(o=S({},r),Mf(o,f)),e=e.ownerDocument||e,f=e.createElement("script"),wt(f),Bn(f,"link",o),e.head.appendChild(f),t.instance=f);case"void":return null;default:throw Error(i(443,t.type))}else t.type==="stylesheet"&&(t.state.loading&4)===0&&(o=t.instance,t.state.loading|=4,jc(o,r.precedence,e));return t.instance}function jc(e,t,r){for(var o=r.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),f=o.length?o[o.length-1]:null,g=f,T=0;T<o.length;T++){var H=o[T];if(H.dataset.precedence===t)g=H;else if(g!==f)break}g?g.parentNode.insertBefore(e,g.nextSibling):(t=r.nodeType===9?r.head:r,t.insertBefore(e,t.firstChild))}function Rf(e,t){e.crossOrigin==null&&(e.crossOrigin=t.crossOrigin),e.referrerPolicy==null&&(e.referrerPolicy=t.referrerPolicy),e.title==null&&(e.title=t.title)}function Mf(e,t){e.crossOrigin==null&&(e.crossOrigin=t.crossOrigin),e.referrerPolicy==null&&(e.referrerPolicy=t.referrerPolicy),e.integrity==null&&(e.integrity=t.integrity)}var Ic=null;function Wg(e,t,r){if(Ic===null){var o=new Map,f=Ic=new Map;f.set(r,o)}else f=Ic,o=f.get(r),o||(o=new Map,f.set(r,o));if(o.has(e))return o;for(o.set(e,null),r=r.getElementsByTagName(e),f=0;f<r.length;f++){var g=r[f];if(!(g[le]||g[Bt]||e==="link"&&g.getAttribute("rel")==="stylesheet")&&g.namespaceURI!=="http://www.w3.org/2000/svg"){var T=g.getAttribute(t)||"";T=e+T;var H=o.get(T);H?H.push(g):o.set(T,[g])}}return o}function ey(e,t,r){e=e.ownerDocument||e,e.head.insertBefore(r,t==="title"?e.querySelector("head > title"):null)}function Hx(e,t,r){if(r===1||t.itemProp!=null)return!1;switch(e){case"meta":case"title":return!0;case"style":if(typeof t.precedence!="string"||typeof t.href!="string"||t.href==="")break;return!0;case"link":if(typeof t.rel!="string"||typeof t.href!="string"||t.href===""||t.onLoad||t.onError)break;switch(t.rel){case"stylesheet":return e=t.disabled,typeof t.precedence=="string"&&e==null;default:return!0}case"script":if(t.async&&typeof t.async!="function"&&typeof t.async!="symbol"&&!t.onLoad&&!t.onError&&t.src&&typeof t.src=="string")return!0}return!1}function ty(e){return!(e.type==="stylesheet"&&(e.state.loading&3)===0)}function Gx(e,t,r,o){if(r.type==="stylesheet"&&(typeof o.media!="string"||matchMedia(o.media).matches!==!1)&&(r.state.loading&4)===0){if(r.instance===null){var f=Pi(o.href),g=t.querySelector(Zo(f));if(g){t=g._p,t!==null&&typeof t=="object"&&typeof t.then=="function"&&(e.count++,e=Rc.bind(e),t.then(e,e)),r.state.loading|=4,r.instance=g,wt(g);return}g=t.ownerDocument||t,o=Jg(o),(f=Gr.get(f))&&Rf(o,f),g=g.createElement("link"),wt(g);var T=g;T._p=new Promise(function(H,ae){T.onload=H,T.onerror=ae}),Bn(g,"link",o),r.instance=g}e.stylesheets===null&&(e.stylesheets=new Map),e.stylesheets.set(r,t),(t=r.state.preload)&&(r.state.loading&3)===0&&(e.count++,r=Rc.bind(e),t.addEventListener("load",r),t.addEventListener("error",r))}}var Uf=0;function qx(e,t){return e.stylesheets&&e.count===0&&Uc(e,e.stylesheets),0<e.count||0<e.imgCount?function(r){var o=setTimeout(function(){if(e.stylesheets&&Uc(e,e.stylesheets),e.unsuspend){var g=e.unsuspend;e.unsuspend=null,g()}},6e4+t);0<e.imgBytes&&Uf===0&&(Uf=62500*wx());var f=setTimeout(function(){if(e.waitingForImages=!1,e.count===0&&(e.stylesheets&&Uc(e,e.stylesheets),e.unsuspend)){var g=e.unsuspend;e.unsuspend=null,g()}},(e.imgBytes>Uf?50:800)+t);return e.unsuspend=r,function(){e.unsuspend=null,clearTimeout(o),clearTimeout(f)}}:null}function Rc(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)Uc(this,this.stylesheets);else if(this.unsuspend){var e=this.unsuspend;this.unsuspend=null,e()}}}var Mc=null;function Uc(e,t){e.stylesheets=null,e.unsuspend!==null&&(e.count++,Mc=new Map,t.forEach(Px,e),Mc=null,Rc.call(e))}function Px(e,t){if(!(t.state.loading&4)){var r=Mc.get(e);if(r)var o=r.get(null);else{r=new Map,Mc.set(e,r);for(var f=e.querySelectorAll("link[data-precedence],style[data-precedence]"),g=0;g<f.length;g++){var T=f[g];(T.nodeName==="LINK"||T.getAttribute("media")!=="not all")&&(r.set(T.dataset.precedence,T),o=T)}o&&r.set(null,o)}f=t.instance,T=f.getAttribute("data-precedence"),g=r.get(T)||o,g===o&&r.set(null,f),r.set(T,f),this.count++,o=Rc.bind(this),f.addEventListener("load",o),f.addEventListener("error",o),g?g.parentNode.insertBefore(f,g.nextSibling):(e=e.nodeType===9?e.head:e,e.insertBefore(f,e.firstChild)),t.state.loading|=4}}var Ko={$$typeof:M,Provider:null,Consumer:null,_currentValue:me,_currentValue2:me,_threadCount:0};function Yx(e,t,r,o,f,g,T,H,ae){this.tag=1,this.containerInfo=e,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=gn(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=gn(0),this.hiddenUpdates=gn(null),this.identifierPrefix=o,this.onUncaughtError=f,this.onCaughtError=g,this.onRecoverableError=T,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=ae,this.incompleteTransitions=new Map}function ny(e,t,r,o,f,g,T,H,ae,Se,De,Re){return e=new Yx(e,t,r,T,ae,Se,De,Re,H),t=1,g===!0&&(t|=24),g=gr(3,null,null,t),e.current=g,g.stateNode=e,t=md(),t.refCount++,e.pooledCache=t,t.refCount++,g.memoizedState={element:o,isDehydrated:r,cache:t},vd(g),e}function ry(e){return e?(e=Si,e):Si}function ay(e,t,r,o,f,g){f=ry(f),o.context===null?o.context=f:o.pendingContext=f,o=us(t),o.payload={element:r},g=g===void 0?null:g,g!==null&&(o.callback=g),r=ds(e,o,t),r!==null&&(cr(r,e,t),No(r,e,t))}function sy(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var r=e.retryLane;e.retryLane=r!==0&&r<t?r:t}}function Lf(e,t){sy(e,t),(e=e.alternate)&&sy(e,t)}function iy(e){if(e.tag===13||e.tag===31){var t=Hs(e,67108864);t!==null&&cr(t,e,67108864),Lf(e,67108864)}}function oy(e){if(e.tag===13||e.tag===31){var t=_r();t=xn(t);var r=Hs(e,t);r!==null&&cr(r,e,t),Lf(e,t)}}var Lc=!0;function $x(e,t,r,o){var f=Z.T;Z.T=null;var g=Y.p;try{Y.p=2,zf(e,t,r,o)}finally{Y.p=g,Z.T=f}}function Vx(e,t,r,o){var f=Z.T;Z.T=null;var g=Y.p;try{Y.p=8,zf(e,t,r,o)}finally{Y.p=g,Z.T=f}}function zf(e,t,r,o){if(Lc){var f=Ff(o);if(f===null)Ef(e,t,o,zc,r),cy(e,o);else if(Qx(f,e,t,r,o))o.stopPropagation();else if(cy(e,o),t&4&&-1<Zx.indexOf(e)){for(;f!==null;){var g=ct(f);if(g!==null)switch(g.tag){case 3:if(g=g.stateNode,g.current.memoizedState.isDehydrated){var T=jn(g.pendingLanes);if(T!==0){var H=g;for(H.pendingLanes|=2,H.entangledLanes|=2;T;){var ae=1<<31-It(T);H.entanglements[1]|=ae,T&=~ae}da(g),(Lt&6)===0&&(xc=Oe()+500,Po(0))}}break;case 31:case 13:H=Hs(g,2),H!==null&&cr(H,g,2),Sc(),Lf(g,2)}if(g=Ff(o),g===null&&Ef(e,t,o,zc,r),g===f)break;f=g}f!==null&&o.stopPropagation()}else Ef(e,t,o,null,r)}}function Ff(e){return e=ns(e),Bf(e)}var zc=null;function Bf(e){if(zc=null,e=$e(e),e!==null){var t=c(e);if(t===null)e=null;else{var r=t.tag;if(r===13){if(e=d(t),e!==null)return e;e=null}else if(r===31){if(e=m(t),e!==null)return e;e=null}else if(r===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null)}}return zc=e,null}function ly(e){switch(e){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Te()){case He:return 2;case it:return 8;case at:case Ot:return 32;case Zt:return 268435456;default:return 32}default:return 32}}var Hf=!1,Ss=null,ws=null,Es=null,Jo=new Map,Xo=new Map,ks=[],Zx="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function cy(e,t){switch(e){case"focusin":case"focusout":Ss=null;break;case"dragenter":case"dragleave":ws=null;break;case"mouseover":case"mouseout":Es=null;break;case"pointerover":case"pointerout":Jo.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Xo.delete(t.pointerId)}}function Wo(e,t,r,o,f,g){return e===null||e.nativeEvent!==g?(e={blockedOn:t,domEventName:r,eventSystemFlags:o,nativeEvent:g,targetContainers:[f]},t!==null&&(t=ct(t),t!==null&&iy(t)),e):(e.eventSystemFlags|=o,t=e.targetContainers,f!==null&&t.indexOf(f)===-1&&t.push(f),e)}function Qx(e,t,r,o,f){switch(t){case"focusin":return Ss=Wo(Ss,e,t,r,o,f),!0;case"dragenter":return ws=Wo(ws,e,t,r,o,f),!0;case"mouseover":return Es=Wo(Es,e,t,r,o,f),!0;case"pointerover":var g=f.pointerId;return Jo.set(g,Wo(Jo.get(g)||null,e,t,r,o,f)),!0;case"gotpointercapture":return g=f.pointerId,Xo.set(g,Wo(Xo.get(g)||null,e,t,r,o,f)),!0}return!1}function uy(e){var t=$e(e.target);if(t!==null){var r=c(t);if(r!==null){if(t=r.tag,t===13){if(t=d(r),t!==null){e.blockedOn=t,Is(e.priority,function(){oy(r)});return}}else if(t===31){if(t=m(r),t!==null){e.blockedOn=t,Is(e.priority,function(){oy(r)});return}}else if(t===3&&r.stateNode.current.memoizedState.isDehydrated){e.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Fc(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var r=Ff(e.nativeEvent);if(r===null){r=e.nativeEvent;var o=new r.constructor(r.type,r);ia=o,r.target.dispatchEvent(o),ia=null}else return t=ct(r),t!==null&&iy(t),e.blockedOn=r,!1;t.shift()}return!0}function dy(e,t,r){Fc(e)&&r.delete(t)}function Kx(){Hf=!1,Ss!==null&&Fc(Ss)&&(Ss=null),ws!==null&&Fc(ws)&&(ws=null),Es!==null&&Fc(Es)&&(Es=null),Jo.forEach(dy),Xo.forEach(dy)}function Bc(e,t){e.blockedOn===t&&(e.blockedOn=null,Hf||(Hf=!0,n.unstable_scheduleCallback(n.unstable_NormalPriority,Kx)))}var Hc=null;function fy(e){Hc!==e&&(Hc=e,n.unstable_scheduleCallback(n.unstable_NormalPriority,function(){Hc===e&&(Hc=null);for(var t=0;t<e.length;t+=3){var r=e[t],o=e[t+1],f=e[t+2];if(typeof o!="function"){if(Bf(o||r)===null)continue;break}var g=ct(r);g!==null&&(e.splice(t,3),t-=3,zd(g,{pending:!0,data:f,method:r.method,action:o},o,f))}}))}function $i(e){function t(ae){return Bc(ae,e)}Ss!==null&&Bc(Ss,e),ws!==null&&Bc(ws,e),Es!==null&&Bc(Es,e),Jo.forEach(t),Xo.forEach(t);for(var r=0;r<ks.length;r++){var o=ks[r];o.blockedOn===e&&(o.blockedOn=null)}for(;0<ks.length&&(r=ks[0],r.blockedOn===null);)uy(r),r.blockedOn===null&&ks.shift();if(r=(e.ownerDocument||e).$$reactFormReplay,r!=null)for(o=0;o<r.length;o+=3){var f=r[o],g=r[o+1],T=f[Rt]||null;if(typeof g=="function")T||fy(r);else if(T){var H=null;if(g&&g.hasAttribute("formAction")){if(f=g,T=g[Rt]||null)H=T.formAction;else if(Bf(f)!==null)continue}else H=T.action;typeof H=="function"?r[o+1]=H:(r.splice(o,3),o-=3),fy(r)}}}function hy(){function e(g){g.canIntercept&&g.info==="react-transition"&&g.intercept({handler:function(){return new Promise(function(T){return f=T})},focusReset:"manual",scroll:"manual"})}function t(){f!==null&&(f(),f=null),o||setTimeout(r,20)}function r(){if(!o&&!navigation.transition){var g=navigation.currentEntry;g&&g.url!=null&&navigation.navigate(g.url,{state:g.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var o=!1,f=null;return navigation.addEventListener("navigate",e),navigation.addEventListener("navigatesuccess",t),navigation.addEventListener("navigateerror",t),setTimeout(r,100),function(){o=!0,navigation.removeEventListener("navigate",e),navigation.removeEventListener("navigatesuccess",t),navigation.removeEventListener("navigateerror",t),f!==null&&(f(),f=null)}}}function Gf(e){this._internalRoot=e}Gc.prototype.render=Gf.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(i(409));var r=t.current,o=_r();ay(r,o,e,t,null,null)},Gc.prototype.unmount=Gf.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;ay(e.current,2,null,e,null,null),Sc(),t[Or]=null}};function Gc(e){this._internalRoot=e}Gc.prototype.unstable_scheduleHydration=function(e){if(e){var t=Cr();e={blockedOn:null,target:e,priority:t};for(var r=0;r<ks.length&&t!==0&&t<ks[r].priority;r++);ks.splice(r,0,e),r===0&&uy(e)}};var my=a.version;if(my!=="19.2.3")throw Error(i(527,my,"19.2.3"));Y.findDOMNode=function(e){var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(i(188)):(e=Object.keys(e).join(","),Error(i(268,e)));return e=h(t),e=e!==null?v(e):null,e=e===null?null:e.stateNode,e};var Jx={bundleType:0,version:"19.2.3",rendererPackageName:"react-dom",currentDispatcherRef:Z,reconcilerVersion:"19.2.3"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var qc=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!qc.isDisabled&&qc.supportsFiber)try{ht=qc.inject(Jx),bt=qc}catch{}}return tl.createRoot=function(e,t){if(!l(e))throw Error(i(299));var r=!1,o="",f=_p,g=Sp,T=wp;return t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(o=t.identifierPrefix),t.onUncaughtError!==void 0&&(f=t.onUncaughtError),t.onCaughtError!==void 0&&(g=t.onCaughtError),t.onRecoverableError!==void 0&&(T=t.onRecoverableError)),t=ny(e,1,!1,null,null,r,o,null,f,g,T,hy),e[Or]=t.current,wf(e),new Gf(t)},tl.hydrateRoot=function(e,t,r){if(!l(e))throw Error(i(299));var o=!1,f="",g=_p,T=Sp,H=wp,ae=null;return r!=null&&(r.unstable_strictMode===!0&&(o=!0),r.identifierPrefix!==void 0&&(f=r.identifierPrefix),r.onUncaughtError!==void 0&&(g=r.onUncaughtError),r.onCaughtError!==void 0&&(T=r.onCaughtError),r.onRecoverableError!==void 0&&(H=r.onRecoverableError),r.formState!==void 0&&(ae=r.formState)),t=ny(e,1,!0,t,r??null,o,f,ae,g,T,H,hy),t.context=ry(null),r=t.current,o=_r(),o=xn(o),f=us(o),f.callback=null,ds(r,f,o),r=o,t.current.lanes=r,fr(t,r),da(t),e[Or]=t.current,wf(e),new Gc(t)},tl.version="19.2.3",tl}var Ey;function l_(){if(Ey)return Yf.exports;Ey=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(a){console.error(a)}}return n(),Yf.exports=o_(),Yf.exports}var c_=l_();const u_=io(c_),d_={},ky=n=>{let a;const s=new Set,i=(v,S)=>{const A=typeof v=="function"?v(a):v;if(!Object.is(A,a)){const _=a;a=S??(typeof A!="object"||A===null)?A:Object.assign({},a,A),s.forEach(E=>E(a,_))}},l=()=>a,p={setState:i,getState:l,getInitialState:()=>h,subscribe:v=>(s.add(v),()=>s.delete(v)),destroy:()=>{(d_?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),s.clear()}},h=a=n(i,l,p);return p},f_=n=>n?ky(n):ky;var Qf={exports:{}},Kf={},Jf={exports:{}},Xf={};/**
 * @license React
 * use-sync-external-store-shim.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ty;function h_(){if(Ty)return Xf;Ty=1;var n=Dl();function a(S,A){return S===A&&(S!==0||1/S===1/A)||S!==S&&A!==A}var s=typeof Object.is=="function"?Object.is:a,i=n.useState,l=n.useEffect,c=n.useLayoutEffect,d=n.useDebugValue;function m(S,A){var _=A(),E=i({inst:{value:_,getSnapshot:A}}),w=E[0].inst,k=E[1];return c(function(){w.value=_,w.getSnapshot=A,p(w)&&k({inst:w})},[S,_,A]),l(function(){return p(w)&&k({inst:w}),S(function(){p(w)&&k({inst:w})})},[S]),d(_),_}function p(S){var A=S.getSnapshot;S=S.value;try{var _=A();return!s(S,_)}catch{return!0}}function h(S,A){return A()}var v=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?h:m;return Xf.useSyncExternalStore=n.useSyncExternalStore!==void 0?n.useSyncExternalStore:v,Xf}var Ay;function m_(){return Ay||(Ay=1,Jf.exports=h_()),Jf.exports}/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ny;function p_(){if(Ny)return Kf;Ny=1;var n=Dl(),a=m_();function s(h,v){return h===v&&(h!==0||1/h===1/v)||h!==h&&v!==v}var i=typeof Object.is=="function"?Object.is:s,l=a.useSyncExternalStore,c=n.useRef,d=n.useEffect,m=n.useMemo,p=n.useDebugValue;return Kf.useSyncExternalStoreWithSelector=function(h,v,S,A,_){var E=c(null);if(E.current===null){var w={hasValue:!1,value:null};E.current=w}else w=E.current;E=m(function(){function N(Q){if(!I){if(I=!0,M=Q,Q=A(Q),_!==void 0&&w.hasValue){var U=w.value;if(_(U,Q))return F=U}return F=Q}if(U=F,i(M,Q))return U;var j=A(Q);return _!==void 0&&_(U,j)?U:(M=Q,F=j)}var I=!1,M,F,q=S===void 0?null:S;return[function(){return N(v())},q===null?void 0:function(){return N(q())}]},[v,S,A,_]);var k=l(h,E[0],E[1]);return d(function(){w.hasValue=!0,w.value=k},[k]),p(k),k},Kf}var Dy;function g_(){return Dy||(Dy=1,Qf.exports=p_()),Qf.exports}var y_=g_();const v_=io(y_),fb={},{useDebugValue:b_}=Wi,{useSyncExternalStoreWithSelector:x_}=v_;let Cy=!1;const __=n=>n;function S_(n,a=__,s){(fb?"production":void 0)!=="production"&&s&&!Cy&&(console.warn("[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"),Cy=!0);const i=x_(n.subscribe,n.getState,n.getServerState||n.getInitialState,a,s);return b_(i),i}const w_=n=>{(fb?"production":void 0)!=="production"&&typeof n!="function"&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");const a=typeof n=="function"?f_(n):n,s=(i,l)=>S_(a,i,l);return Object.assign(s,a),s},E_=n=>w_;var Ne=(n=>(n.Flashcard="flashcard",n.Quiz="quiz",n.Learning="learning",n))(Ne||{}),Sr=(n=>(n[n.Again=1]="Again",n[n.Hard=2]="Hard",n[n.Good=3]="Good",n[n.Easy=4]="Easy",n))(Sr||{}),uu=(n=>(n.CREATE_DECK="CREATE_DECK",n.RENAME_DECK="RENAME_DECK",n.DELETE_DECK="DELETE_DECK",n.MOVE_DECK_TO_FOLDER="MOVE_DECK_TO_FOLDER",n.CREATE_FOLDER="CREATE_FOLDER",n.RENAME_FOLDER="RENAME_FOLDER",n.DELETE_FOLDER="DELETE_FOLDER",n.EXPAND_SERIES_ADD_LEVELS="EXPAND_SERIES_ADD_LEVELS",n.EXPAND_SERIES_ADD_DECKS="EXPAND_SERIES_ADD_DECKS",n.GENERATE_QUESTIONS_FOR_DECK="GENERATE_QUESTIONS_FOR_DECK",n.UPGRADE_TO_LEARNING="UPGRADE_TO_LEARNING",n.NO_ACTION="NO_ACTION",n))(uu||{});function k_(n,a){var i,l;const s={...n,lastModified:Date.now()};switch(a.type){case"SET_LOADING":return{...n,isLoading:a.payload};case"SET_SERIES_PROGRESS":return{...n,seriesProgress:a.payload};case"SET_LEARNING_PROGRESS":return{...n,learningProgress:a.payload};case"UPDATE_LEARNING_PROGRESS":return{...n,learningProgress:{...n.learningProgress,[a.payload.deckId]:a.payload}};case"LOAD_DATA":{const c={};a.payload.decks.forEach(p=>c[p.id]=p);const d={};a.payload.folders.forEach(p=>d[p.id]=p);const m={};return a.payload.deckSeries.forEach(p=>m[p.id]=p),{...n,decks:c,folders:d,deckSeries:m,isLoading:!1,lastModified:null}}case"SET_AI_GENERATION_STATUS":return{...n,aiGenerationStatus:{...n.aiGenerationStatus,...a.payload}};case"ADD_AI_TASK_TO_QUEUE":{const c=Array.isArray(n.aiGenerationStatus.queue)?n.aiGenerationStatus.queue:[];return{...n,aiGenerationStatus:{...n.aiGenerationStatus,queue:[...c,a.payload]}}}case"START_NEXT_AI_TASK":{const d=(Array.isArray(n.aiGenerationStatus.queue)?n.aiGenerationStatus.queue:[]).slice(1),{task:m,abortController:p}=a.payload;return{...n,aiGenerationStatus:{...n.aiGenerationStatus,queue:d,currentTask:{...m,abortController:p},isGenerating:!0}}}case"UPDATE_CURRENT_AI_TASK_STATUS":{if(!n.aiGenerationStatus.currentTask)return n;const{statusText:c,deckId:d,seriesId:m}=a.payload,p={...n.aiGenerationStatus.currentTask,statusText:c,deckId:d,seriesId:m};return{...n,aiGenerationStatus:{...n.aiGenerationStatus,currentTask:p}}}case"FINISH_CURRENT_AI_TASK":return{...n,aiGenerationStatus:{...n.aiGenerationStatus,currentTask:null,isGenerating:!1}};case"CANCEL_AI_TASK":if((i=a.payload)!=null&&i.taskId){const c=Array.isArray(n.aiGenerationStatus.queue)?n.aiGenerationStatus.queue:[];return{...n,aiGenerationStatus:{...n.aiGenerationStatus,queue:c.filter(d=>d.id!==a.payload.taskId)}}}else return(l=n.aiGenerationStatus.currentTask)==null||l.abortController.abort(),{...n,aiGenerationStatus:{...n.aiGenerationStatus,currentTask:null,isGenerating:!1}};case"SET_AI_CHAT_HISTORY":return{...n,aiChatHistory:a.payload};case"ADD_DECKS":{const c={...n.decks};return a.payload.forEach(d=>c[d.id]=d),{...s,decks:c}}case"RESTORE_DATA":{const{decks:c,folders:d,deckSeries:m}=a.payload,p={};c.forEach(S=>p[S.id]=S);const h={};d.forEach(S=>h[S.id]=S);const v={};return m.forEach(S=>v[S.id]=S),{...s,decks:p,folders:h,deckSeries:v}}case"DELETE_DECK":{const c={...n.decks};delete c[a.payload];const d={...n.deckSeries};return Object.keys(d).forEach(m=>{const p=d[m];p.levels&&(d[m]={...p,levels:p.levels.map(h=>({...h,deckIds:(h.deckIds||[]).filter(v=>v!==a.payload)}))})}),{...s,decks:c,deckSeries:d}}case"UPDATE_DECK":return{...s,decks:{...n.decks,[a.payload.id]:a.payload}};case"BULK_UPDATE_DECKS":{const c={...n.decks};return a.payload.forEach(d=>c[d.id]=d),{...s,decks:c}}case"ADD_FOLDER":return{...s,folders:{...n.folders,[a.payload.id]:a.payload}};case"ADD_FOLDERS":{const c={...n.folders};return a.payload.forEach(d=>c[d.id]=d),{...s,folders:c}}case"UPDATE_FOLDER":return{...s,folders:{...n.folders,[a.payload.id]:a.payload}};case"DELETE_FOLDER":{const c={...n.folders};delete c[a.payload];const d={...n.decks};return Object.values(d).forEach(m=>{m.folderId===a.payload&&(d[m.id]={...m,folderId:null})}),{...s,folders:c,decks:d}}case"ADD_SERIES":return{...s,deckSeries:{...n.deckSeries,[a.payload.id]:a.payload}};case"ADD_SERIES_WITH_DECKS":{const{series:c,decks:d}=a.payload,m={...n.decks};return d.forEach(p=>m[p.id]=p),{...s,decks:m,deckSeries:{...n.deckSeries,[c.id]:c}}}case"UPDATE_SERIES":return{...s,deckSeries:{...n.deckSeries,[a.payload.id]:a.payload}};case"DELETE_SERIES":{const c={...n.deckSeries};return delete c[a.payload],{...s,deckSeries:c}}default:return n}}const T_={decks:{},folders:{},deckSeries:{},seriesProgress:new Map,learningProgress:{},isLoading:!0,lastModified:null,aiGenerationStatus:{isGenerating:!1,statusText:null,generatingDeckId:null,generatingSeriesId:null,queue:[],currentTask:null},aiChatHistory:[]},Ke=E_()(n=>({...T_,dispatch:a=>n(s=>k_(s,a))})),A_=n=>{const a=new Date;a.setHours(23,59,59,999);const s=(n.type===Ne.Quiz||n.type==="learning"?n.questions:n.cards)||[];return Array.isArray(s)?s.filter(i=>!i.suspended&&new Date(i.dueDate).getTime()<=a.getTime()).length:0},Uh=()=>Ke(n=>Object.values(n.decks)),N_=()=>Ke(n=>Object.values(n.folders)),Lh=()=>Ke(n=>Object.values(n.deckSeries)),D_=()=>Ke(n=>Object.values(n.deckSeries).filter(a=>!a.archived&&!a.deletedAt)),C_=()=>Ke(n=>{const a=new Set;return Object.values(n.deckSeries).forEach(s=>{(s.levels||[]).forEach(i=>((i==null?void 0:i.deckIds)||[]).forEach(l=>a.add(l)))}),Object.values(n.decks).filter(s=>!s.archived&&!s.deletedAt&&!a.has(s.id))}),O_=()=>Ke(n=>{const a=new Set;return Object.values(n.deckSeries).forEach(s=>{var i;if(!s.archived&&!s.deletedAt){const l=((i=n.seriesProgress.get(s.id))==null?void 0:i.size)||0;let c=0;(s.levels||[]).filter(Boolean).forEach(d=>{(d.deckIds||[]).forEach(m=>{c<=l&&a.add(m),c++})})}}),Object.values(n.decks).reduce((s,i)=>{if(i.archived||i.deletedAt)return s;if(i.type===Ne.Learning){const c=n.learningProgress[i.id];if(c&&c.unlockedQuestionIds){const d=new Set(c.unlockedQuestionIds),p=(i.questions||[]).filter(h=>d.has(h.id)&&!h.suspended&&new Date(h.dueDate).getTime()<=new Date().setHours(23,59,59,999)).length;return s+p}}return(i.type===Ne.Quiz||i.type===Ne.Learning)&&Object.values(n.deckSeries).some(c=>(c.levels||[]).some(d=>{var m;return(m=d.deckIds)==null?void 0:m.includes(i.id)}))&&!a.has(i.id)?s:s+A_(i)},0)}),hb=G.createContext(null),oo=()=>{const n=G.useContext(hb);if(!n)throw new Error("useData must be used within a DataManagementProvider");return n},j_=({children:n,value:a})=>u.jsx(hb.Provider,{value:a,children:n}),I_="modulepreload",R_=function(n){return"/"+n},Oy={},Ar=function(a,s,i){let l=Promise.resolve();if(s&&s.length>0){let d=function(h){return Promise.all(h.map(v=>Promise.resolve(v).then(S=>({status:"fulfilled",value:S}),S=>({status:"rejected",reason:S}))))};document.getElementsByTagName("link");const m=document.querySelector("meta[property=csp-nonce]"),p=(m==null?void 0:m.nonce)||(m==null?void 0:m.getAttribute("nonce"));l=d(s.map(h=>{if(h=R_(h),h in Oy)return;Oy[h]=!0;const v=h.endsWith(".css"),S=v?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${h}"]${S}`))return;const A=document.createElement("link");if(A.rel=v?"stylesheet":I_,v||(A.as="script"),A.crossOrigin="",A.href=h,p&&A.setAttribute("nonce",p),document.head.appendChild(A),v)return new Promise((_,E)=>{A.addEventListener("load",_),A.addEventListener("error",()=>E(new Error(`Unable to preload CSS for ${h}`)))})}))}function c(d){const m=new Event("vite:preloadError",{cancelable:!0});if(m.payload=d,window.dispatchEvent(m),!m.defaultPrevented)throw d}return l.then(d=>{for(const m of d||[])m.status==="rejected"&&c(m.reason);return a().catch(c)})},mb=G.createContext(void 0),Wf=()=>window.location.hash.startsWith("#/")?window.location.hash.substring(1):"/",M_=({children:n})=>{const[a,s]=G.useState(Wf()),i=G.useRef([Wf()]),[l,c]=G.useState(1),d=G.useCallback(()=>{const v=Wf();s(v);const S=i.current,A=S[S.length-1],_=S[S.length-2];let E=S;v===_?E=S.slice(0,-1):v!==A&&(E=[...S,v]),i.current=E,c(E.length)},[]);G.useEffect(()=>(window.addEventListener("hashchange",d),()=>{window.removeEventListener("hashchange",d)}),[d]);const m=G.useCallback((v,S)=>{const A=`#${v}`;if(S!=null&&S.replace){const _=i.current;if(_.length>0){const E=new URL(window.location.href);E.hash=A,window.location.replace(E.toString());const w=[..._];w[w.length-1]=v,i.current=w;return}}window.location.hash=A},[]),p=G.useCallback(()=>{const v=i.current;if(v.length>1){const S=v[v.length-2];window.location.hash=`#${S}`}else m("/")},[m]),h={path:a,navigate:m,goBack:p,canGoBack:l>1};return u.jsx(mb.Provider,{value:h,children:n})},Pa=()=>{const n=G.useContext(mb);if(n===void 0)throw new Error("useRouter must be used within a RouterProvider");return n},pb=G.createContext(void 0),ei=(n,a)=>{if(typeof window>"u")return a;try{const s=window.localStorage.getItem(n);return s?JSON.parse(s):a}catch(s){return console.error(`Error reading ${n} from localStorage`,s),a}},U_=()=>{if(typeof window>"u")return!1;try{const n=window.localStorage.getItem("cogniflow-aiFeaturesEnabled");return n!==null?JSON.parse(n)===!0:!!(window.location.origin.endsWith("aistudio.google.com")||window.location.origin.endsWith("scf.usercontent.goog"))}catch(n){return console.error("Error reading cogniflow-aiFeaturesEnabled from localStorage",n),!1}},L_=({children:n})=>{const[a,s]=G.useState(()=>ei("cogniflow-disableAnimations",!1)),[i,l]=G.useState(()=>ei("cogniflow-hapticsEnabled",!0)),[c,d]=G.useState(U_),[m,p]=G.useState(()=>ei("cogniflow-backupEnabled",!0)),[h,v]=G.useState(()=>{try{return window.localStorage.getItem("cogniflow-backupApiKey")||"qRt+gU/57GHKhxTZeRnRi+dfT274iSkKKq2UnTr9Bxs="}catch{return"qRt+gU/57GHKhxTZeRnRi+dfT274iSkKKq2UnTr9Bxs="}}),[S,A]=G.useState(()=>{try{return window.localStorage.getItem("cogniflow-encryptionPassword")||""}catch{return""}}),[_,E]=G.useState(()=>ei("cogniflow-syncOnCellular",!0)),[w,k]=G.useState(()=>{try{return window.localStorage.getItem("cogniflow-fontFamily")||"sans"}catch{return"sans"}}),[N,I]=G.useState(()=>ei("cogniflow-notificationsEnabled",!1)),[M,F]=G.useState(()=>ei("cogniflow-leechThreshold",8)),[q,Q]=G.useState(()=>ei("cogniflow-leechAction","suspend")),U=G.useCallback(W=>{s(W);try{window.localStorage.setItem("cogniflow-disableAnimations",JSON.stringify(W))}catch(be){console.error("Error writing animation setting to localStorage",be)}},[]),j=G.useCallback(W=>{l(W);try{window.localStorage.setItem("cogniflow-hapticsEnabled",JSON.stringify(W))}catch(be){console.error("Error writing haptics setting to localStorage",be)}},[]),O=G.useCallback(W=>{d(W);try{window.localStorage.setItem("cogniflow-aiFeaturesEnabled",JSON.stringify(W))}catch(be){console.error("Error writing AI features setting to localStorage",be)}},[]),B=G.useCallback(W=>{p(W);try{window.localStorage.setItem("cogniflow-backupEnabled",JSON.stringify(W))}catch(be){console.error("Error writing backup enabled setting to localStorage",be)}},[]),te=G.useCallback(W=>{v(W);try{window.localStorage.setItem("cogniflow-backupApiKey",W)}catch(be){console.error("Error writing backup API key to localStorage",be)}},[]),L=G.useCallback(W=>{A(W);try{W?window.localStorage.setItem("cogniflow-encryptionPassword",W):window.localStorage.removeItem("cogniflow-encryptionPassword")}catch(be){console.error("Error writing encryption password to localStorage",be)}},[]),J=G.useCallback(W=>{E(W);try{window.localStorage.setItem("cogniflow-syncOnCellular",JSON.stringify(W))}catch(be){console.error("Error writing syncOnCellular setting to localStorage",be)}},[]),D=G.useCallback(W=>{k(W);try{window.localStorage.setItem("cogniflow-fontFamily",W)}catch(be){console.error("Error writing fontFamily setting to localStorage",be)}},[]),ie=G.useCallback(W=>{I(W);try{window.localStorage.setItem("cogniflow-notificationsEnabled",JSON.stringify(W)),W&&"Notification"in window&&Notification.permission!=="granted"&&Notification.requestPermission().then(be=>{be!=="granted"&&(I(!1),window.localStorage.setItem("cogniflow-notificationsEnabled",JSON.stringify(!1)))})}catch(be){console.error("Error writing notifications setting to localStorage",be)}},[]),Z=G.useCallback(W=>{F(W);try{window.localStorage.setItem("cogniflow-leechThreshold",JSON.stringify(W))}catch(be){console.error("Error writing leechThreshold to localStorage",be)}},[]),Y=G.useCallback(W=>{Q(W);try{window.localStorage.setItem("cogniflow-leechAction",JSON.stringify(W))}catch(be){console.error("Error writing leechAction to localStorage",be)}},[]),me={disableAnimations:a,setDisableAnimations:U,hapticsEnabled:i,setHapticsEnabled:j,aiFeaturesEnabled:c,setAiFeaturesEnabled:O,backupEnabled:m,setBackupEnabled:B,backupApiKey:h,setBackupApiKey:te,encryptionPassword:S,setEncryptionPassword:L,syncOnCellular:_,setSyncOnCellular:J,fontFamily:w,setFontFamily:D,notificationsEnabled:N,setNotificationsEnabled:ie,leechThreshold:M,setLeechThreshold:Z,leechAction:q,setLeechAction:Y};return u.jsx(pb.Provider,{value:me,children:n})},ii=()=>{const n=G.useContext(pb);if(n===void 0)throw new Error("useSettings must be used within a SettingsProvider");return n},ea=({href:n,children:a,passAs:s,...i})=>{const{navigate:l}=Pa(),c=m=>{m.currentTarget.tagName==="A"&&(m.metaKey||m.ctrlKey)||(m.preventDefault(),i.onClick&&i.onClick(m),l(n))},d=`#${n}`;return s?u.jsx(s,{...i,onClick:c,children:a}):u.jsx("a",{...i,href:d,onClick:c,children:a})},_h={plus:u.jsxs(u.Fragment,{children:[u.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),u.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]}),"upload-cloud":u.jsxs(u.Fragment,{children:[u.jsx("path",{d:"M20 16.58A5 5 0 0 0 18 7h-1.26A8 8 0 1 0 4 15.25"}),u.jsx("polyline",{points:"16 16 12 12 8 16"}),u.jsx("line",{x1:"12",y1:"12",x2:"12",y2:"21"})]}),x:u.jsxs(u.Fragment,{children:[u.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),u.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]}),"chevron-left":u.jsx(u.Fragment,{children:u.jsx("polyline",{points:"15 18 9 12 15 6"})}),"trash-2":u.jsxs(u.Fragment,{children:[u.jsx("polyline",{points:"3 6 5 6 21 6"}),u.jsx("path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"}),u.jsx("line",{x1:"10",y1:"11",x2:"10",y2:"17"}),u.jsx("line",{x1:"14",y1:"11",x2:"14",y2:"17"})]}),"check-circle":u.jsxs(u.Fragment,{children:[u.jsx("path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14"}),u.jsx("polyline",{points:"22 4 12 14.01 9 11.01"})]}),"x-circle":u.jsxs(u.Fragment,{children:[u.jsx("circle",{cx:"12",cy:"12",r:"10"}),u.jsx("line",{x1:"15",y1:"9",x2:"9",y2:"15"}),u.jsx("line",{x1:"9",y1:"9",x2:"15",y2:"15"})]}),download:u.jsxs(u.Fragment,{children:[u.jsx("path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"}),u.jsx("polyline",{points:"7 10 12 15 17 10"}),u.jsx("line",{x1:"12",y1:"15",x2:"12",y2:"3"})]}),laptop:u.jsxs(u.Fragment,{children:[u.jsx("path",{d:"M20 16V7a2 2 0 0 0-2-2H6a2 2 0 0 0-2 2v9h16z"}),u.jsx("rect",{x:"2",y:"17",width:"20",height:"4",rx:"1"})]}),menu:u.jsxs(u.Fragment,{children:[u.jsx("line",{x1:"3",y1:"12",x2:"21",y2:"12"}),u.jsx("line",{x1:"3",y1:"6",x2:"21",y2:"6"}),u.jsx("line",{x1:"3",y1:"18",x2:"21",y2:"18"})]}),edit:u.jsxs(u.Fragment,{children:[u.jsx("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"}),u.jsx("path",{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"})]}),save:u.jsxs(u.Fragment,{children:[u.jsx("path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"}),u.jsx("polyline",{points:"17 21 17 13 7 13 7 21"}),u.jsx("polyline",{points:"7 3 7 8 15 8"})]}),sun:u.jsxs(u.Fragment,{children:[u.jsx("circle",{cx:"12",cy:"12",r:"5"}),u.jsx("line",{x1:"12",y1:"1",x2:"12",y2:"3"}),u.jsx("line",{x1:"12",y1:"21",x2:"12",y2:"23"}),u.jsx("line",{x1:"4.22",y1:"4.22",x2:"5.64",y2:"5.64"}),u.jsx("line",{x1:"18.36",y1:"18.36",x2:"19.78",y2:"19.78"}),u.jsx("line",{x1:"1",y1:"12",x2:"3",y2:"12"}),u.jsx("line",{x1:"21",y1:"12",x2:"23",y2:"12"}),u.jsx("line",{x1:"4.22",y1:"19.78",x2:"5.64",y2:"18.36"}),u.jsx("line",{x1:"18.36",y1:"5.64",x2:"19.78",y2:"4.22"})]}),moon:u.jsx(u.Fragment,{children:u.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})}),code:u.jsxs(u.Fragment,{children:[u.jsx("polyline",{points:"16 18 22 12 16 6"}),u.jsx("polyline",{points:"8 6 2 12 8 18"})]}),"refresh-ccw":u.jsxs(u.Fragment,{children:[u.jsx("polyline",{points:"1 4 1 10 7 10"}),u.jsx("polyline",{points:"23 20 23 14 17 14"}),u.jsx("path",{d:"M20.49 9A9 9 0 0 0 7.2 6.51"}),u.jsx("path",{d:"M3.51 15A9 9 0 0 0 16.8 17.49"})]}),broom:u.jsx(u.Fragment,{children:u.jsx("path",{d:"M9.59 4.59A2 2 0 1 1 11 8H2m10.59 11.41A2 2 0 1 0 14 16H2m15.73-8.27A2.5 2.5 0 1 1 19.5 12H2"})}),settings:u.jsxs(u.Fragment,{children:[u.jsx("circle",{cx:"12",cy:"12",r:"3"}),u.jsx("path",{d:"M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"})]}),info:u.jsxs(u.Fragment,{children:[u.jsx("circle",{cx:"12",cy:"12",r:"10"}),u.jsx("line",{x1:"12",y1:"16",x2:"12",y2:"12"}),u.jsx("line",{x1:"12",y1:"8",x2:"12.01",y2:"8"})]}),"chevron-down":u.jsx(u.Fragment,{children:u.jsx("polyline",{points:"6 9 12 15 18 9"})}),eye:u.jsxs(u.Fragment,{children:[u.jsx("path",{d:"M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"}),u.jsx("circle",{cx:"12",cy:"12",r:"3"})]}),"eye-off":u.jsxs(u.Fragment,{children:[u.jsx("path",{d:"M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24"}),u.jsx("line",{x1:"1",y1:"1",x2:"23",y2:"23"})]}),zap:u.jsx(u.Fragment,{children:u.jsx("polygon",{points:"13 2 3 14 12 14 11 22 21 10 12 10 13 2"})}),"help-circle":u.jsxs(u.Fragment,{children:[u.jsx("circle",{cx:"12",cy:"12",r:"10"}),u.jsx("path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"}),u.jsx("line",{x1:"12",y1:"17",x2:"12.01",y2:"17"})]}),google:u.jsxs(u.Fragment,{children:[u.jsx("path",{d:"M17.64 9.2c0-.63-.06-1.25-.16-1.84H9v3.48h4.84c-.2 1.12-.84 2.08-1.74 2.71v2.26h2.92c1.7-1.56 2.68-3.88 2.68-6.61z"}),u.jsx("path",{d:"M9 18c2.43 0 4.47-.8 5.96-2.18l-2.92-2.26c-.8.54-1.82.86-3.04.86-2.34 0-4.32-1.58-5.04-3.7H1v2.34C2.64 16.32 5.57 18 9 18z"}),u.jsx("path",{d:"M3.96 10.71c-.18-.54-.28-1.12-.28-1.71s.1-1.17.28-1.71V4.96H1c-.64 1.28-1 2.74-1 4.34s.36 3.06 1 4.34l2.96-2.34z"}),u.jsx("path",{d:"M9 3.6c1.32 0 2.52.45 3.44 1.34l2.6-2.6C13.46.8 11.43 0 9 0 5.57 0 2.64 1.68 1 4.34l2.96 2.34C4.68 4.54 6.66 3.6 9 3.6z"})]}),folder:u.jsx(u.Fragment,{children:u.jsx("path",{d:"M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"})}),"folder-plus":u.jsxs(u.Fragment,{children:[u.jsx("path",{d:"M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"}),u.jsx("line",{x1:"12",y1:"11",x2:"12",y2:"17"}),u.jsx("line",{x1:"9",y1:"14",x2:"15",y2:"14"})]}),"folder-edit":u.jsxs(u.Fragment,{children:[u.jsx("path",{d:"M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"}),u.jsx("path",{d:"M14 13.5l2 2-4 4-2-2 4-4zm-1.5 2.5l2-2"})]}),list:u.jsxs(u.Fragment,{children:[u.jsx("line",{x1:"8",y1:"6",x2:"21",y2:"6"}),u.jsx("line",{x1:"8",y1:"12",x2:"21",y2:"12"}),u.jsx("line",{x1:"8",y1:"18",x2:"21",y2:"18"}),u.jsx("line",{x1:"3",y1:"6",x2:"3.01",y2:"6"}),u.jsx("line",{x1:"3",y1:"12",x2:"3.01",y2:"12"}),u.jsx("line",{x1:"3",y1:"18",x2:"3.01",y2:"18"})]}),lock:u.jsxs(u.Fragment,{children:[u.jsx("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"}),u.jsx("path",{d:"M7 11V7a5 5 0 0 1 10 0v4"})]}),unlock:u.jsxs(u.Fragment,{children:[u.jsx("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"}),u.jsx("path",{d:"M7 11V7a5 5 0 0 1 9.9-1"})]}),archive:u.jsxs(u.Fragment,{children:[u.jsx("polyline",{points:"21 8 21 21 3 21 3 8"}),u.jsx("rect",{x:"1",y:"3",width:"22",height:"5"}),u.jsx("line",{x1:"10",y1:"12",x2:"14",y2:"12"})]}),unarchive:u.jsxs(u.Fragment,{children:[u.jsx("polyline",{points:"21 8 21 21 3 21 3 8"}),u.jsx("rect",{x:"1",y:"3",width:"22",height:"5"}),u.jsx("polyline",{points:"10 13 12 11 14 13"}),u.jsx("line",{x1:"12",y1:"11",x2:"12",y2:"17"})]}),"arrow-down":u.jsxs(u.Fragment,{children:[u.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),u.jsx("polyline",{points:"19 12 12 19 5 12"})]}),monitor:u.jsxs(u.Fragment,{children:[u.jsx("rect",{x:"2",y:"3",width:"20",height:"14",rx:"2",ry:"2"}),u.jsx("line",{x1:"8",y1:"21",x2:"16",y2:"21"}),u.jsx("line",{x1:"12",y1:"17",x2:"12",y2:"21"})]}),"more-vertical":u.jsxs(u.Fragment,{children:[u.jsx("circle",{cx:"12",cy:"12",r:"1"}),u.jsx("circle",{cx:"12",cy:"5",r:"1"}),u.jsx("circle",{cx:"12",cy:"19",r:"1"})]}),search:u.jsxs(u.Fragment,{children:[u.jsx("circle",{cx:"11",cy:"11",r:"8"}),u.jsx("line",{x1:"21",y1:"21",x2:"16.65",y2:"16.65"})]}),filter:u.jsx(u.Fragment,{children:u.jsx("polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3"})}),layers:u.jsxs(u.Fragment,{children:[u.jsx("polygon",{points:"12 2 2 7 12 12 22 7 12 2"}),u.jsx("polyline",{points:"2 17 12 22 22 17"}),u.jsx("polyline",{points:"2 12 12 17 22 12"})]}),terminal:u.jsxs(u.Fragment,{children:[u.jsx("polyline",{points:"4 17 10 11 4 5"}),u.jsx("line",{x1:"12",y1:"19",x2:"20",y2:"19"})]}),"trending-up":u.jsxs(u.Fragment,{children:[u.jsx("polyline",{points:"23 6 13.5 15.5 8.5 10.5 1 18"}),u.jsx("polyline",{points:"17 6 23 6 23 12"})]}),"grip-vertical":u.jsxs(u.Fragment,{children:[u.jsx("circle",{cx:"9",cy:"12",r:"1"}),u.jsx("circle",{cx:"9",cy:"5",r:"1"}),u.jsx("circle",{cx:"9",cy:"19",r:"1"}),u.jsx("circle",{cx:"15",cy:"12",r:"1"}),u.jsx("circle",{cx:"15",cy:"5",r:"1"}),u.jsx("circle",{cx:"15",cy:"19",r:"1"})]}),repeat:u.jsxs(u.Fragment,{children:[u.jsx("polyline",{points:"17 1 21 5 17 9"}),u.jsx("path",{d:"M3 11V9a4 4 0 0 1 4-4h14"}),u.jsx("polyline",{points:"7 23 3 19 7 15"}),u.jsx("path",{d:"M21 13v2a4 4 0 0 1-4 4H3"})]}),bot:u.jsxs(u.Fragment,{children:[u.jsx("rect",{x:"5",y:"10",width:"14",height:"10",rx:"2"}),u.jsx("circle",{cx:"8.5",cy:"15",r:"1"}),u.jsx("circle",{cx:"15.5",cy:"15",r:"1"}),u.jsx("path",{d:"M9 10V4m6 6V4"}),u.jsx("line",{x1:"9",y1:"4",x2:"15",y2:"4"})]}),"book-open":u.jsxs(u.Fragment,{children:[u.jsx("path",{d:"M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z"}),u.jsx("path",{d:"M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z"})]}),"wifi-off":u.jsxs(u.Fragment,{children:[u.jsx("line",{x1:"1",y1:"1",x2:"23",y2:"23"}),u.jsx("path",{d:"M16.72 11.06A10.94 10.94 0 0 1 19 12.55"}),u.jsx("path",{d:"M5 12.55a10.94 10.94 0 0 1 5.17-2.39"}),u.jsx("path",{d:"M10.71 5.05A16 16 0 0 1 22.58 9"}),u.jsx("path",{d:"M1.42 9a15.91 15.91 0 0 1 4.7-2.88"}),u.jsx("path",{d:"M8.53 16.11a6 6 0 0 1 6.95 0"}),u.jsx("line",{x1:"12",y1:"20",x2:"12.01",y2:"20"})]}),link:u.jsxs(u.Fragment,{children:[u.jsx("path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.72"}),u.jsx("path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.72-1.72"})]}),"file-text":u.jsxs(u.Fragment,{children:[u.jsx("path",{d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"}),u.jsx("polyline",{points:"14 2 14 8 20 8"}),u.jsx("line",{x1:"16",y1:"13",x2:"8",y2:"13"}),u.jsx("line",{x1:"16",y1:"17",x2:"8",y2:"17"}),u.jsx("polyline",{points:"10 9 9 9 8 9"})]}),"volume-2":u.jsxs(u.Fragment,{children:[u.jsx("polygon",{points:"11 5 6 9 2 9 2 15 6 15 11 19 11 5"}),u.jsx("path",{d:"M19.07 4.93a10 10 0 0 1 0 14.14M15.54 8.46a5 5 0 0 1 0 7.07"})]}),mic:u.jsxs(u.Fragment,{children:[u.jsx("path",{d:"M12 1a3 3 0 0 0-3 3v8a3 3 0 0 0 6 0V4a3 3 0 0 0-3-3z"}),u.jsx("path",{d:"M19 10v2a7 7 0 0 1-14 0v-2"}),u.jsx("line",{x1:"12",y1:"19",x2:"12",y2:"23"}),u.jsx("line",{x1:"8",y1:"23",x2:"16",y2:"23"})]}),keyboard:u.jsxs(u.Fragment,{children:[u.jsx("rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",ry:"2"}),u.jsx("line",{x1:"6",y1:"12",x2:"6",y2:"12"}),u.jsx("line",{x1:"10",y1:"12",x2:"10",y2:"12"}),u.jsx("line",{x1:"14",y1:"12",x2:"14",y2:"12"}),u.jsx("line",{x1:"18",y1:"12",x2:"18",y2:"12"}),u.jsx("line",{x1:"6",y1:"16",x2:"6",y2:"16"}),u.jsx("line",{x1:"10",y1:"16",x2:"10",y2:"16"}),u.jsx("line",{x1:"14",y1:"16",x2:"14",y2:"16"}),u.jsx("line",{x1:"18",y1:"16",x2:"18",y2:"16"}),u.jsx("line",{x1:"6",y1:"8",x2:"6",y2:"8"}),u.jsx("line",{x1:"10",y1:"8",x2:"10",y2:"8"}),u.jsx("line",{x1:"14",y1:"8",x2:"14",y2:"8"}),u.jsx("line",{x1:"18",y1:"8",x2:"18",y2:"8"})]}),type:u.jsxs(u.Fragment,{children:[u.jsx("polyline",{points:"4 7 4 4 20 4 20 7"}),u.jsx("line",{x1:"9",y1:"20",x2:"15",y2:"20"}),u.jsx("line",{x1:"12",y1:"4",x2:"12",y2:"20"})]}),maximize:u.jsx(u.Fragment,{children:u.jsx("path",{d:"M8 3H5a2 2 0 0 0-2 2v3m18 0V5a2 2 0 0 0-2-2h-3m0 18h3a2 2 0 0 0 2-2v-3M3 16v3a2 2 0 0 0 2 2h3"})}),minimize:u.jsx(u.Fragment,{children:u.jsx("path",{d:"M8 3v3a2 2 0 0 1-2 2H3m18 0h-3a2 2 0 0 1-2-2V3m0 18v-3a2 2 0 0 1 2-2h3M3 16h3a2 2 0 0 1 2 2v3"})}),calendar:u.jsxs(u.Fragment,{children:[u.jsx("rect",{x:"3",y:"4",width:"18",height:"18",rx:"2",ry:"2"}),u.jsx("line",{x1:"16",y1:"2",x2:"16",y2:"6"}),u.jsx("line",{x1:"8",y1:"2",x2:"8",y2:"6"}),u.jsx("line",{x1:"3",y1:"10",x2:"21",y2:"10"})]}),printer:u.jsxs(u.Fragment,{children:[u.jsx("polyline",{points:"6 9 6 2 18 2 18 9"}),u.jsx("path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2"}),u.jsx("rect",{x:"6",y:"14",width:"12",height:"8"})]}),columns:u.jsx(u.Fragment,{children:u.jsx("path",{d:"M12 3h7a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-7m0-18H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h7m0-18v18"})})},kk=Object.keys(_h),ze=({name:n,className:a="w-6 h-6",...s})=>u.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:`${a} pointer-events-none`,...s,children:_h[n]||_h["help-circle"]}),jy=(n,a)=>{if(!n)return"";const s=String(n);return s.length>a?s.substring(0,a)+"...":s},z_=({items:n})=>{if(!n||n.length<=1)return null;const a=s=>u.jsxs(u.Fragment,{children:[u.jsx("span",{className:"sm:hidden",title:s,children:jy(s,8)}),u.jsx("span",{className:"hidden sm:inline",title:s,children:jy(s,25)})]});return u.jsx("nav",{"aria-label":"Breadcrumb",className:"mb-4 sm:mb-6",children:u.jsx("ol",{className:"flex items-center space-x-1 sm:space-x-2 text-xs sm:text-sm text-text-muted flex-wrap",children:n.map((s,i)=>{const l=i===n.length-1;return u.jsxs("li",{className:"flex items-center",children:[i>0&&u.jsx(ze,{name:"chevron-left",className:"w-3 h-3 sm:w-4 sm:h-4 rotate-180 mx-1 sm:mx-2 flex-shrink-0"}),l?u.jsx("span",{className:"font-semibold text-text","aria-current":"page",children:a(s.label)}):u.jsx(ea,{href:s.href,className:"hover:underline hover:text-primary whitespace-nowrap",children:a(s.label)})]},i)})})})},F_=({children:n})=>u.jsx("div",{className:"animate-fade-in-up",children:n}),ln=({className:n="",variant:a="text",width:s,height:i})=>{const l="animate-pulse bg-gray-200 dark:bg-gray-700/50",c={text:"rounded h-4 w-full",circular:"rounded-full",rectangular:"rounded-md"},d={};return s&&(d.width=s),i&&(d.height=i),u.jsx("div",{className:`${l} ${c[a]} ${n}`,style:d,"aria-hidden":"true"})},Iy=()=>u.jsxs("div",{className:"min-h-screen bg-background",children:[u.jsx("div",{className:"bg-surface/80 border-b border-border h-16 fixed top-0 left-0 right-0 z-20",children:u.jsxs("div",{className:"container mx-auto px-4 h-full flex items-center justify-between",children:[u.jsx(ln,{width:120,height:24}),u.jsxs("div",{className:"flex gap-2",children:[u.jsx(ln,{variant:"circular",width:32,height:32}),u.jsx(ln,{variant:"circular",width:32,height:32})]})]})}),u.jsxs("main",{className:"container mx-auto px-4 pt-24 pb-20",children:[u.jsxs("div",{className:"mb-8 flex flex-wrap gap-4",children:[u.jsx(ln,{variant:"rectangular",width:200,height:48,className:"rounded-lg"}),u.jsx(ln,{variant:"rectangular",width:160,height:48,className:"rounded-lg"})]}),u.jsxs("div",{className:"mb-8",children:[u.jsxs("div",{className:"flex justify-between mb-4",children:[u.jsx(ln,{width:150,height:32}),u.jsx(ln,{width:80,height:32})]}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[u.jsxs("div",{className:"bg-surface rounded-lg shadow-md p-4 border border-transparent h-48 flex flex-col justify-between",children:[u.jsxs("div",{className:"flex gap-4",children:[u.jsx(ln,{variant:"rectangular",width:40,height:40}),u.jsxs("div",{className:"flex-1 space-y-2",children:[u.jsx(ln,{width:"70%",height:24}),u.jsx(ln,{width:"90%",height:16}),u.jsx(ln,{width:"60%",height:16})]})]}),u.jsxs("div",{className:"space-y-2 mt-4",children:[u.jsx(ln,{variant:"rectangular",height:8,className:"rounded-full"}),u.jsx(ln,{variant:"rectangular",height:8,className:"rounded-full"})]})]}),u.jsxs("div",{className:"bg-surface rounded-lg shadow-md p-4 border border-transparent h-48 flex flex-col justify-between",children:[u.jsxs("div",{className:"flex gap-4",children:[u.jsx(ln,{variant:"rectangular",width:40,height:40}),u.jsxs("div",{className:"flex-1 space-y-2",children:[u.jsx(ln,{width:"60%",height:24}),u.jsx(ln,{width:"80%",height:16})]})]}),u.jsxs("div",{className:"space-y-2 mt-4",children:[u.jsx(ln,{variant:"rectangular",height:8,className:"rounded-full"}),u.jsx(ln,{variant:"rectangular",height:8,className:"rounded-full"})]})]})]})]}),u.jsxs("div",{className:"space-y-4",children:[u.jsxs("div",{className:"flex justify-between mb-4",children:[u.jsx(ln,{width:150,height:32}),u.jsx(ln,{width:80,height:32})]}),[1,2,3].map(n=>u.jsxs("div",{className:"bg-surface rounded-lg shadow-md p-4 flex justify-between items-center h-24",children:[u.jsxs("div",{className:"flex gap-4 items-center flex-1",children:[u.jsx(ln,{variant:"circular",width:24,height:24}),u.jsxs("div",{className:"space-y-2 flex-1 max-w-md",children:[u.jsx(ln,{width:"50%",height:20}),u.jsx(ln,{width:"80%",height:14})]})]}),u.jsx(ln,{variant:"rectangular",width:80,height:32,className:"rounded-md"})]},n))]})]})]}),qe=({children:n,variant:a="primary",size:s="md",className:i="",...l})=>{const c="inline-flex items-center justify-center rounded-md font-medium transition-colors focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-background disabled:opacity-50 disabled:pointer-events-none",d={primary:"bg-primary text-on-primary hover:bg-primary-hover focus:ring-primary",secondary:"bg-surface text-text border border-border hover:bg-border/20 focus:ring-primary",danger:"bg-red-600 text-white hover:bg-red-700 focus:ring-red-500",ghost:"text-text-muted hover:bg-border/50 hover:text-text focus:ring-primary"},m={sm:"px-2 py-1 text-xs",md:"px-4 py-2 text-sm",lg:"px-6 py-3 text-base"};return u.jsx("button",{className:`${c} ${d[a]} ${m[s]} ${i}`,...l,children:n})},nl=G.lazy(()=>Ar(()=>import("./StudySession-BpQpXa7E.js"),__vite__mapDeps([0,1,2,3,4]))),B_=G.lazy(()=>Ar(()=>import("./ReaderSession-DXdg708e.js"),__vite__mapDeps([5,3]))),H_=G.lazy(()=>Ar(()=>import("./SettingsPage-0m772oxC.js"),__vite__mapDeps([6,4])).then(n=>({default:n.SettingsPage}))),G_=G.lazy(()=>Ar(()=>import("./DeckDetailsPage-BdNh9gVd.js"),__vite__mapDeps([7,1,8]))),q_=G.lazy(()=>Ar(()=>import("./JsonInstructionsPage-DtB8t9E7.js"),[])),P_=G.lazy(()=>Ar(()=>import("./SeriesOverviewPage-yas4Bs5E.js"),__vite__mapDeps([9,10,1,8]))),Y_=G.lazy(()=>Ar(()=>import("./ArchivePage-CMSKQHfs.js"),[]).then(n=>({default:n.ArchivePage}))),$_=G.lazy(()=>Ar(()=>import("./TrashPage-C6CDDFVN.js"),[])),V_=G.lazy(()=>Ar(()=>import("./DashboardPage-DHCED95_.js"),__vite__mapDeps([11,12,1,2,10]))),Z_=G.lazy(()=>Ar(()=>import("./AllDecksPage-BueUKUNK.js"),__vite__mapDeps([13,10,1,14]))),Q_=G.lazy(()=>Ar(()=>import("./AllSeriesPage-CZIGJtCu.js"),__vite__mapDeps([15,12,1,2,14]))),K_=G.lazy(()=>Ar(()=>import("./ProgressPage-CLvxrVOU.js"),[])),J_=G.lazy(()=>Ar(()=>import("./DeckPrintView-DWE1Wcwh.js"),[])),X_=()=>{const{path:n,navigate:a}=Pa(),s=oo(),{activeDeck:i,activeSeries:l,generalStudyDeck:c,sessionsToResume:d,isSyncing:m,lastSyncStatus:p,isGapiReady:h,isGapiSignedIn:v,gapiUser:S,sortPreference:A,setSortPreference:_,draggedDeckId:E,setDraggedDeckId:w,openFolderIds:k,onToggleFolder:N}=s,{aiFeaturesEnabled:I}=ii(),[M]=n.split("?"),F=Lh(),q=C_(),Q=D_(),U=O_(),j=G.useMemo(()=>M.startsWith("/study/")||M.endsWith("/study")||M.endsWith("/cram")||M.endsWith("/study-reversed")||M.endsWith("/study-flip")||M.endsWith("/read"),[M]),O=M.endsWith("/print"),B=G.useMemo(()=>{if(O)return[];const L=[{label:"Home",href:"/"}],J=new URLSearchParams(window.location.hash.split("?")[1]);if(M==="/series")L.push({label:"Series"});else if(M.startsWith("/series/")&&l)L.push({label:"Series",href:"/series"}),L.push({label:l.name||"Series"});else if(M==="/decks")L.push({label:"Decks"});else if(M.startsWith("/decks/")&&i){let D=null;const ie=J.get("seriesId");ie&&(D=F.find(Z=>Z.id===ie)),D||(D=F.find(Z=>!Z.deletedAt&&(Z.levels||[]).some(Y=>{var me;return(me=Y.deckIds)==null?void 0:me.includes(i.id)}))),D?(L.push({label:"Series",href:"/series"}),L.push({label:D.name||"Series",href:`/series/${D.id}`})):L.push({label:"Decks",href:"/decks"}),L.push({label:i.name||"Deck"})}else M==="/settings"?L.push({label:"Settings"}):M==="/trash"?L.push({label:"Trash"}):M==="/archive"?L.push({label:"Archive"}):M==="/progress"?L.push({label:"Progress"}):M==="/instructions/json"&&L.push({label:"JSON Guide"});return L},[M,i,l,F,O]),te=()=>{if(M==="/settings")return u.jsx(H_,{onExport:s.handleExportData,onRestore:()=>s.openModal("restore"),onResetProgress:()=>s.openModal("resetProgress"),onFactoryReset:s.handleFactoryReset,onSync:s.handleManualSync,onForceFetch:s.handleForceFetchFromServer,onForceUpload:s.handleForceUploadToServer,isSyncing:m,lastSyncStatus:p,onManageServerBackups:()=>s.openModal("serverBackup"),onCreateServerBackup:s.handleCreateServerBackup,isGapiReady:h,isGapiSignedIn:v,gapiUser:S,onGoogleSignIn:s.handleGoogleSignIn,onGoogleSignOut:s.handleGoogleSignOut,onBackupToDrive:s.handleBackupToDrive,onRestoreFromDrive:s.openRestoreFromDriveModal,onClearAppCache:s.handleClearAppCache,onClearCdnCache:s.handleClearCdnCache,onRevertLastFetch:s.handleRevertLastFetch});if(M==="/trash")return u.jsx($_,{onRestoreDeck:s.handleRestoreDeck,onRestoreSeries:s.handleRestoreSeries,onDeleteDeckPermanently:s.handleDeleteDeckPermanently,onDeleteSeriesPermanently:s.handleDeleteSeriesPermanently,openConfirmModal:s.openConfirmModal});if(M==="/archive")return u.jsx(Y_,{onUpdateDeck:s.handleUpdateDeck,onUpdateSeries:s.handleUpdateSeries,onDeleteDeck:s.handleDeleteDeck,onDeleteSeries:s.handleDeleteSeries,openConfirmModal:s.openConfirmModal});if(M==="/progress")return u.jsx(K_,{});if(M.startsWith("/series/")&&l)return u.jsx(P_,{series:l,sessionsToResume:d,onUpdateSeries:s.handleUpdateSeries,onDeleteSeries:s.handleDeleteSeries,onAddDeckToSeries:s.handleAddDeckToSeries,onUpdateDeck:s.handleUpdateDeck,onStartSeriesStudy:s.handleStartSeriesStudy,onUpdateLastOpened:s.updateLastOpenedSeries,openConfirmModal:s.openConfirmModal,onAiAddLevelsToSeries:s.handleAiAddLevelsToSeries,onAiAddDecksToLevel:s.handleAiAddDecksToLevel,handleGenerateQuestionsForEmptyDecksInSeries:s.handleGenerateQuestionsForEmptyDecksInSeries,handleGenerateQuestionsForDeck:s.handleGenerateQuestionsForDeck,onCancelAIGeneration:s.handleCancelAIGeneration,onExportSeries:s.handleExportSeries,onDeleteDeck:s.handleDeleteDeck,handleGenerateContentForLearningDeck:s.handleGenerateContentForLearningDeck,onGenerateDeckForLevel:s.handleOpenAIGenerationForSeriesLevel,onAutoExpandSeries:s.handleOpenAIAutoExpandSeries},l.id);if(M==="/study/general"){const L=new URLSearchParams(window.location.hash.split("?")[1]).get("seriesId")||void 0;return c&&u.jsx(nl,{deck:c,seriesId:L,onSessionEnd:s.handleSessionEnd,onItemReviewed:s.handleItemReviewed,onUpdateLastOpened:()=>{},onStudyNextDeck:s.handleStudyNextDeckInSeries},"general-study")}if(M.startsWith("/decks/")&&M.endsWith("/cram")){if(!i)return null;const L=new URLSearchParams(window.location.hash.split("?")[1]),J=L.get("sort")||"random",D=L.get("limit")||"all";let ie=((i.type===Ne.Flashcard?i.cards:i.questions)||[]).filter(me=>!me.suspended);if(J==="hardest"?ie.sort((me,W)=>{const be=(W.lapses||0)-(me.lapses||0);return be!==0?be:(me.easeFactor||2.5)-(W.easeFactor||2.5)}):J==="newest"?ie.reverse():J==="oldest"||ie.sort(()=>Math.random()-.5),D!=="all"){const me=parseInt(D,10);isNaN(me)||(ie=ie.slice(0,me))}const Z=i.type===Ne.Flashcard?{...i,name:`${i.name} (Cram)`,cards:ie}:{...i,name:`${i.name} (Cram)`,questions:ie},Y=L.get("seriesId")||void 0;return u.jsx(nl,{deck:Z,seriesId:Y,onSessionEnd:s.handleSessionEnd,onItemReviewed:s.handleItemReviewed,onUpdateLastOpened:s.updateLastOpened,sessionKeySuffix:"_cram",onStudyNextDeck:s.handleStudyNextDeckInSeries},`${i.id}-cram`)}if(M.startsWith("/decks/")&&M.endsWith("/study-reversed")){if(!i||i.type!=="flashcard")return null;const L={...i,name:`${i.name} (Reversed)`,cards:(i.cards||[]).map(D=>({...D,front:D.back,back:D.front}))},J=new URLSearchParams(window.location.hash.split("?")[1]).get("seriesId")||void 0;return u.jsx(nl,{deck:L,seriesId:J,onSessionEnd:s.handleSessionEnd,onItemReviewed:s.handleItemReviewed,onUpdateLastOpened:s.updateLastOpened,sessionKeySuffix:"_reversed",onStudyNextDeck:s.handleStudyNextDeckInSeries},`${i.id}-reversed`)}if(M.startsWith("/decks/")&&M.endsWith("/study-flip")){if(!i||i.type!=="quiz"&&i.type!=="learning")return null;const L=i,J=(L.questions||[]).filter(Z=>!Z.suspended).map(Z=>{const Y=(Z.options||[]).find(W=>W.id===Z.correctAnswerId),me=`<div class="text-left w-full"><p class="text-xl"><b>Answer:</b> ${(Y==null?void 0:Y.text)||"N/A"}</p><hr class="my-4"/><div class="prose prose-sm dark:prose-invert max-w-none">${Z.detailedExplanation}</div></div>`;return{...Z,front:Z.questionText,back:me}}),D={...L,name:`${L.name} (Review)`,type:Ne.Flashcard,cards:J.sort(()=>Math.random()-.5)},ie=new URLSearchParams(window.location.hash.split("?")[1]).get("seriesId")||void 0;return u.jsx(nl,{deck:D,seriesId:ie,onSessionEnd:s.handleSessionEnd,onItemReviewed:s.handleItemReviewed,onUpdateLastOpened:s.updateLastOpened,sessionKeySuffix:"_flip",onStudyNextDeck:s.handleStudyNextDeckInSeries},`${i.id}-flip`)}if(M.startsWith("/decks/")&&M.endsWith("/study")){const L=new URLSearchParams(window.location.hash.split("?")[1]).get("seriesId")||void 0;return i&&u.jsx(nl,{deck:i,seriesId:L,onSessionEnd:s.handleSessionEnd,onItemReviewed:s.handleItemReviewed,onUpdateLastOpened:s.updateLastOpened,onStudyNextDeck:s.handleStudyNextDeckInSeries},i.id)}return M.startsWith("/decks/")&&M.endsWith("/read")?!i||i.type!==Ne.Learning?null:u.jsx(B_,{deck:i,onExit:()=>a(`/decks/${i.id}`),onPractice:()=>a(`/decks/${i.id}/study`)}):M.startsWith("/decks/")&&M.endsWith("/print")?i&&u.jsx(J_,{deck:i}):M.startsWith("/decks/")?i&&u.jsx(G_,{deck:i,sessionsToResume:d,onUpdateDeck:s.handleUpdateDeck,onDeleteDeck:s.handleDeleteDeck,onUpdateLastOpened:s.updateLastOpened,openConfirmModal:s.openConfirmModal,handleGenerateQuestionsForDeck:s.handleGenerateQuestionsForDeck,handleGenerateContentForLearningDeck:s.handleGenerateContentForLearningDeck,onCancelAIGeneration:s.handleCancelAIGeneration,onSaveLearningBlock:s.handleSaveLearningBlock,onDeleteLearningBlock:s.handleDeleteLearningBlock,onExportDeck:s.handleExportDeck,onRegenerateQuestion:s.handleRegenerateQuestion,onExpandText:s.handleExpandText,onGenerateAI:()=>s.handleOpenAIGenerationForDeck(i)},i.id):M==="/instructions/json"?u.jsx(q_,{}):M==="/decks"?u.jsx(Z_,{sessionsToResume:d,sortPreference:A,onSortChange:_,onUpdateLastOpened:s.updateLastOpened,onDeleteFolder:s.handleDeleteFolder,draggedDeckId:E,onDragStart:w,onDragEnd:()=>w(null),onMoveDeck:s.handleMoveDeck,openFolderIds:k,onToggleFolder:N,onUpdateDeck:s.handleUpdateDeck,onDeleteDeck:s.handleDeleteDeck,openConfirmModal:s.openConfirmModal,onNewFolder:()=>s.openModal("folder",{folder:"new"}),onImportDecks:()=>s.openModal("import"),onCreateSampleDeck:s.handleCreateSampleDeck,handleSaveFolder:s.handleSaveFolder,handleGenerateQuestionsForDeck:s.handleGenerateQuestionsForDeck,handleGenerateContentForLearningDeck:s.handleGenerateContentForLearningDeck,onCancelAIGeneration:s.handleCancelAIGeneration}):M==="/series"?u.jsx(Q_,{onStartSeriesStudy:s.handleStartSeriesStudy,onCreateNewSeries:()=>s.openModal("series",{series:"new"}),onCreateSampleSeries:s.handleCreateSampleSeries,onGenerateAI:()=>s.openModal("aiGeneration"),handleGenerateQuestionsForEmptyDecksInSeries:s.handleGenerateQuestionsForEmptyDecksInSeries,onCancelAIGeneration:s.handleCancelAIGeneration}):q.length>0||Q.length>0?u.jsx(V_,{onGenerateAI:()=>s.openModal("aiGeneration"),totalDueQuestions:U,onStartGeneralStudy:s.handleStartGeneralStudy,sessionsToResume:d,onUpdateLastOpened:s.updateLastOpened,onUpdateDeck:s.handleUpdateDeck,onDeleteDeck:s.handleDeleteDeck,openConfirmModal:s.openConfirmModal,seriesProgress:Ke.getState().seriesProgress,onStartSeriesStudy:s.handleStartSeriesStudy,handleGenerateQuestionsForDeck:s.handleGenerateQuestionsForDeck,handleGenerateContentForLearningDeck:s.handleGenerateContentForLearningDeck,handleGenerateQuestionsForEmptyDecksInSeries:s.handleGenerateQuestionsForEmptyDecksInSeries,onCancelAIGeneration:s.handleCancelAIGeneration,onCreateSampleQuizDeck:s.handleCreateSampleQuizDeck,onCreateSampleFlashcardDeck:s.handleCreateSampleFlashcardDeck,onCreateSampleLearningDeck:s.handleCreateSampleLearningDeck,onCreateSampleSeries:s.handleCreateSampleSeries,onCreateSampleCourse:s.onCreateSampleCourse}):u.jsxs("div",{className:"text-center py-20 max-w-4xl mx-auto",children:[u.jsx("h2",{className:"text-3xl font-bold text-gray-600 dark:text-gray-400",children:"Welcome to CogniFlow"}),u.jsx("p",{className:"mt-4 text-gray-500 dark:text-gray-500",children:"Get started by creating or importing content."}),u.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-center gap-4 mt-8 flex-wrap",children:[I&&u.jsxs(qe,{onClick:()=>s.openModal("aiGeneration"),variant:"primary",children:[u.jsx(ze,{name:"zap",className:"w-5 h-5 mr-2"}),"Generate with AI"]}),u.jsxs(qe,{onClick:()=>s.openModal("import"),children:[u.jsx(ze,{name:"plus",className:"w-5 h-5 mr-2"}),"Create / Import"]}),u.jsxs(qe,{onClick:()=>s.openModal("series",{series:"new"}),variant:"secondary",children:[u.jsx(ze,{name:"layers",className:"w-5 h-5 mr-2"}),"New Series"]}),u.jsxs(qe,{onClick:()=>s.openModal("restore"),variant:"secondary",children:[u.jsx(ze,{name:"upload-cloud",className:"w-5 h-5 mr-2"}),"Restore Backup"]})]}),u.jsxs("div",{className:"mt-12 border-t border-border pt-8",children:[u.jsx("h3",{className:"text-lg font-semibold text-text-muted mb-4",children:"Or try a sample:"}),u.jsxs("div",{className:"flex flex-wrap justify-center gap-3",children:[u.jsxs(qe,{onClick:s.handleCreateSampleQuizDeck,variant:"ghost",size:"sm",children:[u.jsx(ze,{name:"help-circle",className:"w-4 h-4 mr-2"})," Quiz Deck"]}),u.jsxs(qe,{onClick:s.handleCreateSampleFlashcardDeck,variant:"ghost",size:"sm",children:[u.jsx(ze,{name:"laptop",className:"w-4 h-4 mr-2"})," Flashcard Deck"]}),u.jsxs(qe,{onClick:s.handleCreateSampleLearningDeck,variant:"ghost",size:"sm",children:[u.jsx(ze,{name:"book-open",className:"w-4 h-4 mr-2"})," Learning Deck"]}),u.jsxs(qe,{onClick:s.handleCreateSampleSeries,variant:"ghost",size:"sm",children:[u.jsx(ze,{name:"layers",className:"w-4 h-4 mr-2"})," Series"]})]})]})]})};return j||O?u.jsx(G.Suspense,{fallback:u.jsx(Iy,{}),children:te()}):u.jsxs(u.Fragment,{children:[u.jsx(z_,{items:B}),u.jsx(F_,{children:u.jsx(G.Suspense,{fallback:u.jsx(Iy,{}),children:te()})},M)]})},W_=({onOpenMenu:n,onOpenCommandPalette:a,activeDeck:s,isVisible:i})=>{const{path:l,goBack:c,canGoBack:d}=Pa(),[m]=l.split("?"),p=m==="/";let h;if(p)h=u.jsx(ea,{href:"/",className:"no-underline",children:u.jsx("h1",{className:"text-2xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-blue-400 to-teal-300",children:"CogniFlow"})});else{let v="Back";s?v=s.name:m==="/study/general"?v="General Study":m==="/settings"&&(v="Settings"),h=u.jsxs(qe,{variant:"ghost",onClick:c,className:"flex items-center space-x-2 -ml-3 min-w-0","aria-label":"Go Back",children:[u.jsx(ze,{name:"chevron-left"}),u.jsx("span",{className:"truncate",children:v})]})}return u.jsx("header",{className:`bg-surface/80 backdrop-blur-sm fixed top-0 left-0 right-0 z-20 border-b border-border transition-transform duration-300 ease-in-out ${i?"translate-y-0":"-translate-y-full"}`,children:u.jsxs("nav",{className:"container mx-auto px-4 sm:px-6 lg:px-8 flex items-center justify-between h-16",children:[u.jsx("div",{className:"flex items-center flex-1 min-w-0",children:h}),u.jsxs("div",{className:"flex items-center space-x-1",children:[u.jsx(qe,{variant:"ghost",onClick:a,className:"p-1 h-auto","aria-label":"Open command palette",children:u.jsx(ze,{name:"search"})}),u.jsx(qe,{variant:"ghost",onClick:n,className:"p-1 h-auto","aria-label":"Open menu",children:u.jsx(ze,{name:"menu"})})]})]})})},eS='a[href], button:not([disabled]), textarea, input, select, [tabindex]:not([tabindex="-1"])',On=(n,a)=>{const s=G.useRef([]);G.useEffect(()=>{if(a&&n.current){s.current=Array.from(n.current.querySelectorAll(eS));const i=s.current[0];i&&setTimeout(()=>i.focus(),100);const l=c=>{var p;if(c.key!=="Tab"||!((p=n.current)!=null&&p.contains(document.activeElement)))return;const d=s.current[0],m=s.current[s.current.length-1];c.shiftKey?document.activeElement===d&&(c.preventDefault(),m==null||m.focus()):document.activeElement===m&&(c.preventDefault(),d==null||d.focus())};return document.addEventListener("keydown",l),()=>{document.removeEventListener("keydown",l)}}},[a,n])},tS=({isOpen:n,onClose:a,onImport:s,onCreateSeries:i,onGenerateAI:l,onInstall:c})=>{const d=G.useRef(null),{aiFeaturesEnabled:m}=ii();return On(d,n),G.useEffect(()=>{const p=h=>{h.key==="Escape"&&a()};return n&&document.addEventListener("keydown",p),()=>{document.removeEventListener("keydown",p)}},[n,a]),u.jsxs(u.Fragment,{children:[u.jsx("div",{className:`fixed inset-0 bg-black bg-opacity-60 z-50 transition-opacity duration-300 ${n?"opacity-100":"opacity-0 pointer-events-none"}`,onClick:a,"aria-hidden":"true"}),u.jsx("div",{ref:d,className:`fixed top-0 right-0 h-full w-full max-w-xs z-[51] transform transition-transform duration-300 ease-in-out ${n?"translate-x-0":"translate-x-full"}`,role:"dialog","aria-modal":"true","aria-labelledby":"sidebar-title",children:u.jsxs("div",{className:"bg-surface shadow-xl h-full flex flex-col",children:[u.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-border",children:[u.jsx("h2",{id:"sidebar-title",className:"text-xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-blue-400 to-teal-300",children:"Menu"}),u.jsx(qe,{variant:"ghost",onClick:a,className:"p-1 h-auto","aria-label":"Close menu",children:u.jsx(ze,{name:"x"})})]}),u.jsxs("nav",{className:"flex-grow p-4 space-y-2",children:[u.jsxs(ea,{href:"/",onClick:a,className:"flex items-center px-3 py-2 text-text rounded-md hover:bg-border/30 text-lg",children:[u.jsx(ze,{name:"laptop",className:"w-6 h-6 mr-3"})," Home"]}),u.jsxs(ea,{href:"/series",onClick:a,className:"flex items-center px-3 py-2 text-text rounded-md hover:bg-border/30 text-lg",children:[u.jsx(ze,{name:"layers",className:"w-6 h-6 mr-3"})," Series"]}),u.jsxs(ea,{href:"/decks",onClick:a,className:"flex items-center px-3 py-2 text-text rounded-md hover:bg-border/30 text-lg",children:[u.jsx(ze,{name:"folder",className:"w-6 h-6 mr-3"})," Decks"]}),u.jsxs(ea,{href:"/progress",onClick:a,className:"flex items-center px-3 py-2 text-text rounded-md hover:bg-border/30 text-lg",children:[u.jsx(ze,{name:"trending-up",className:"w-6 h-6 mr-3"}),"Progress"]}),u.jsxs(ea,{href:"/archive",onClick:a,className:"flex items-center px-3 py-2 text-text rounded-md hover:bg-border/30 text-lg",children:[u.jsx(ze,{name:"archive",className:"w-6 h-6 mr-3"}),"Archive"]}),u.jsxs(ea,{href:"/trash",onClick:a,className:"flex items-center px-3 py-2 text-text rounded-md hover:bg-border/30 text-lg",children:[u.jsx(ze,{name:"trash-2",className:"w-6 h-6 mr-3"}),"Trash"]}),u.jsxs(ea,{href:"/settings",onClick:a,className:"flex items-center px-3 py-2 text-text rounded-md hover:bg-border/30 text-lg",children:[u.jsx(ze,{name:"settings",className:"w-6 h-6 mr-3"}),"Settings"]}),u.jsxs(ea,{href:"/instructions/json",onClick:a,className:"flex items-center px-3 py-2 text-text rounded-md hover:bg-border/30 text-lg",children:[u.jsx(ze,{name:"help-circle",className:"w-6 h-6 mr-3"}),"JSON Guide"]})]}),u.jsxs("div",{className:"p-4 border-t border-border space-y-2",children:[m&&u.jsxs(qe,{variant:"primary",onClick:l,className:"w-full",children:[u.jsx(ze,{name:"zap",className:"w-5 h-5 mr-2"}),"Generate with AI"]}),u.jsxs(qe,{variant:"secondary",onClick:i,className:"w-full",children:[u.jsx(ze,{name:"layers",className:"w-5 h-5 mr-2"}),"Create New Series"]}),u.jsxs(qe,{variant:"secondary",onClick:s,className:"w-full",children:[u.jsx(ze,{name:"plus",className:"w-5 h-5 mr-2"}),"Create / Import Deck"]}),c&&u.jsxs(qe,{variant:"secondary",onClick:c,className:"w-full",children:[u.jsx(ze,{name:"download",className:"w-5 h-5 mr-2"}),"Install App"]})]})]})})]})},gb=G.createContext(void 0),Cl=()=>{const n=G.useContext(gb);if(!n)throw new Error("useModal must be used within a ModalProvider");return n},nS=({children:n})=>{const[a,s]=G.useState({type:null,payload:null}),i=G.useRef(null),l=G.useCallback((d,m={})=>{i.current=document.activeElement,s({type:d,payload:m})},[]),c=G.useCallback(()=>{s({type:null,payload:null}),setTimeout(()=>{var d;return(d=i.current)==null?void 0:d.focus()},100)},[]);return u.jsx(gb.Provider,{value:{modalType:a.type,modalPayload:a.payload,openModal:l,closeModal:c},children:n})},wr=2.5,Sh=1.3,rS=1,aS=1.2,sS=1.3,iS={1:-.2,2:-.15,3:0,4:.15};function zh(n,a=null){const s={isValid:!1,parsed:null,errors:[],detailedErrors:[],suggestions:[],fixedJSON:null,schemaIssues:[]};if(!n||typeof n!="string"||n.trim()==="")return s.errors.push("Input must be a non-empty string"),s;let i=null;if(a)try{i=JSON.parse(a)}catch{s.schemaIssues.push({type:"error",path:"Template",message:"The provided Schema/Template JSON is itself invalid and cannot be used for comparison."})}let l=n;try{s.parsed=JSON.parse(l),s.isValid=!0,s.fixedJSON=JSON.stringify(s.parsed,null,2)}catch(c){const d=oS(c,l);s.errors.push(c.message),s.detailedErrors.push(d);const m=uS(l);if(m.success){s.fixedJSON=m.fixed,l=m.fixed,s.suggestions=m.suggestions;try{s.parsed=JSON.parse(l),s.isValid=!0}catch{}}else s.suggestions=m.suggestions}return i&&s.parsed&&s.schemaIssues.push(...wh(s.parsed,i)),s}function wh(n,a,s="$"){const i=[];if(Array.isArray(a))return Array.isArray(n)?(a.length>0&&n.length>0&&i.push(...wh(n[0],a[0],`${s}[0]`)),i):(i.push({type:"error",path:s,message:`Type Mismatch: Expected an array but got ${typeof n}.`}),i);if(typeof a=="object"&&a!==null){if(typeof n!="object"||n===null||Array.isArray(n))return i.push({type:"error",path:s,message:`Type Mismatch: Expected an object but got ${Array.isArray(n)?"array":typeof n}.`}),i;const l=Object.keys(a),c=new Set(Object.keys(n));for(const d of l){const m=`${s}.${d}`;if(!c.has(d))i.push({type:"warning",path:m,message:`Missing Key: The key '${d}' is missing.`});else{const p=Array.isArray(a[d])?"array":typeof a[d],h=Array.isArray(n[d])?"array":typeof n[d];p!==h?i.push({type:"error",path:m,message:`Type Mismatch: Expected type '${p}' but got '${h}'.`}):typeof a[d]=="object"&&a[d]!==null&&i.push(...wh(n[d],a[d],m))}}for(const d of Array.from(c))l.includes(d)||i.push({type:"info",path:`${s}.${d}`,message:`Extra Key: The key '${d}' is present but not in the schema.`});return i}return i}function oS(n,a){var _;const s=n.message,i=a.split(`
`);let l=null,c=null,d="Syntax Error",m="",p="",h="",v;const S=s.match(/at position (\d+)/),A=s.match(/at line (\d+) column (\d+)/i);if(S){const E=parseInt(S[1],10),{line:w,column:k}=lS(a,E);l=w,c=k,m=Yc(i,l-1,c-1);const N=a.substring(0,E).trim();s.includes("Expected property name or '}'")?(d="Invalid Object Key or Trailing Comma",N.endsWith(",")?v='A trailing comma was found. JSON does not allow a comma after the last item in an object. For example, `{"key": "value",}` is invalid. Remove the comma.':v='An object key might be missing or invalid. All keys in JSON must be strings enclosed in double quotes (e.g., `"key": "value"`). Check for unquoted keys or a missing comma.'):s.includes("Unexpected token")&&(h=((_=s.match(/Unexpected token (.+?) in JSON/))==null?void 0:_[1])||"",d="Unexpected Token",(h==="}"||h==="]")&&N.endsWith(",")?(d="Trailing Comma",v='A trailing comma was found. JSON format does not allow a comma after the last item in an array or object. For example, `[1, 2,]` and `{"key":"value",}` are invalid. Remove the final comma.'):h==="'"?(d="Invalid String Quote",v="JSON strings must use double quotes (`\"`). Single quotes (`'`) are not permitted. For example, change `'value'` to `\"value\"`."):h==="="?(d="Invalid Assignment",v="JSON uses a colon (`:`) to separate keys from values, not an equals sign (`=`). This may be a typo (e.g., `:=` instead of just `:`) that needs to be corrected."):h.toLowerCase()==="u"&&a.substring(E).startsWith("undefined")?(d="Invalid Value",v="The value `undefined` is not valid in JSON. This is common when converting JavaScript objects. Use `null` instead or remove the key-value pair."):h.match(/^[a-zA-Z]/)?(d="Unquoted String",v='This looks like an unquoted string, key, or value. All strings and object keys in JSON must be enclosed in double quotes. For example, `{ key: "value" }` should be `{ "key": "value" }`.'):v=`An unexpected character '${h}' was found. This is often caused by a missing comma, a missing colon, or a typo. Please check the syntax around this character.`)}else if(A)l=parseInt(A[1],10),c=parseInt(A[2],10),m=Yc(i,l-1,c-1),s.includes("trailing comma")?(d="Trailing Comma",v="A trailing comma was found. JSON format does not allow a comma after the last item in an object or array. For example, `[1, 2,]` is invalid. Remove the final comma."):s.includes("expected property name")?(d="Invalid Object Key",v='An object key is expected here. All keys in JSON must be strings enclosed in double quotes (e.g., `"key": "value"`). Check for missing quotes or a missing comma before this line.'):s.includes("expected a string")?(d="Invalid String",v="This value was expected to be a string, but it isn't. Remember to wrap all strings in double quotes (`\"`). Single quotes are not allowed. For example, use `\"text\"` instead of `'text'` or `text`."):(d="Syntax Error",v="There is a syntax error at this location. Please check for issues like missing commas (,), colons (:), or mismatched brackets/braces ([]/{}).");else if(s.match(/Unterminated string|Unexpected end of JSON input/i)){const E=cS(a);E.line!==null&&E.column!==null?(d="Unterminated String",l=E.line,c=E.column,m=Yc(i,l-1,c-1),v='An unclosed string was detected. All strings in JSON must be enclosed in double quotes. Check for a missing closing quote (`"`) on this line or a previous one.'):(d="Unexpected End of Input",m=Yc(i,i.length-1),v="The JSON ends unexpectedly. This usually means you are missing a closing brace `}` for an object or a closing bracket `]` for an array.")}return v||(v="The JSON structure is invalid. Please check for common syntax errors like missing commas, incorrect quotes, or mismatched brackets and braces."),{type:d,line:l,column:c,expected:p,actual:h,context:m,message:s,friendlyMessage:v}}function lS(n,a){const s=n.substring(0,a).split(`
`);return{line:s.length,column:s[s.length-1].length+1}}function Yc(n,a,s,i=2){const l=Math.max(0,a-i),c=Math.min(n.length,a+i+1),d=n.slice(l,c);if(s!==void 0&&s>=1&&a>=l&&a<c){const m=a-l,p=" ".repeat(s-1)+"^";d.splice(m+1,0,p)}return d.join(`
`)}function cS(n){const a=n.split(`
`);let s=!1,i="",l=!1,c={line:null,column:null};for(let d=0;d<a.length;d++){const m=a[d];for(let p=0;p<m.length;p++){const h=m[p];if(l){l=!1;continue}if(h==="\\"&&s){l=!0;continue}(h==='"'||h==="'")&&!s?(s=!0,i=h,c={line:d+1,column:p+1}):h===i&&s&&(s=!1)}}return s&&c.line!==null?{...c,context:""}:{line:null,column:null,context:""}}function uS(n){let a=n;const s=new Set,i=fS(a);i.fixes.length>0&&(a=i.fixed,i.fixes.forEach(l=>s.add(l)));try{const l=JSON.parse(a);return{success:!0,fixed:JSON.stringify(l,null,2),suggestions:Array.from(s)}}catch(l){let c=Array.from(s);return l.message.includes("Unterminated string")&&c.push("Attempted to fix an unterminated string. Please review the result."),c.length===0&&c.push("Could not automatically fix JSON errors."),{success:!1,fixed:null,suggestions:c}}}function dS(n){return n.replace(/[\u2018\u2019\u201C\u201D]/g,'"')}function fS(n){const a=[];let s=n.trim();const i=s;s=dS(s),i!==s&&a.push("Replaced smart/typographic quotes with standard double quotes");const l=[{regex:/(:\s*)=/g,replacement:"$1",description:"Replaced invalid assignment operator (e.g. `:=`) with a colon"},{regex:/,\s*([}\]])/g,replacement:"$1",description:"Removed trailing commas"},{regex:/([{,]\s*)([a-zA-Z_$][a-zA-Z0-9_$]*)\s*:/g,replacement:'$1"$2":',description:"Added quotes to unquoted keys"},{regex:/:\s*([^",\s\[\{][^,}\]]*?)(?=\s*[,}])/g,replacement:': "$1"',description:"Added quotes to an unquoted string value"},{regex:/:\s*(undefined|NaN|Infinity|-Infinity)/g,replacement:": null",description:"Replaced `undefined`, `NaN`, or `Infinity` with `null`"},{regex:/"(\s*)"(?!\s*[:],}])/g,replacement:'","',description:"Added missing comma between string values"},{regex:/}(\s*)"/g,replacement:'},"$1"',description:"Added missing comma between an object and a following key"},{regex:/\](\s*)"/g,replacement:'],"$1"',description:"Added missing comma between an array and a following key"},{regex:/\](\s*)\{/g,replacement:"], $1{",description:"Added missing comma between an array and an object"}];for(let c=0;c<3;c++)l.forEach(d=>{const m=s;s=s.replace(d.regex,d.replacement),m!==s&&!a.includes(d.description)&&a.push(d.description)});return{fixed:s,fixes:a}}var jt;(function(n){n.assertEqual=l=>l;function a(l){}n.assertIs=a;function s(l){throw new Error}n.assertNever=s,n.arrayToEnum=l=>{const c={};for(const d of l)c[d]=d;return c},n.getValidEnumValues=l=>{const c=n.objectKeys(l).filter(m=>typeof l[l[m]]!="number"),d={};for(const m of c)d[m]=l[m];return n.objectValues(d)},n.objectValues=l=>n.objectKeys(l).map(function(c){return l[c]}),n.objectKeys=typeof Object.keys=="function"?l=>Object.keys(l):l=>{const c=[];for(const d in l)Object.prototype.hasOwnProperty.call(l,d)&&c.push(d);return c},n.find=(l,c)=>{for(const d of l)if(c(d))return d},n.isInteger=typeof Number.isInteger=="function"?l=>Number.isInteger(l):l=>typeof l=="number"&&isFinite(l)&&Math.floor(l)===l;function i(l,c=" | "){return l.map(d=>typeof d=="string"?`'${d}'`:d).join(c)}n.joinValues=i,n.jsonStringifyReplacer=(l,c)=>typeof c=="bigint"?c.toString():c})(jt||(jt={}));var Eh;(function(n){n.mergeShapes=(a,s)=>({...a,...s})})(Eh||(Eh={}));const Ze=jt.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),As=n=>{switch(typeof n){case"undefined":return Ze.undefined;case"string":return Ze.string;case"number":return isNaN(n)?Ze.nan:Ze.number;case"boolean":return Ze.boolean;case"function":return Ze.function;case"bigint":return Ze.bigint;case"symbol":return Ze.symbol;case"object":return Array.isArray(n)?Ze.array:n===null?Ze.null:n.then&&typeof n.then=="function"&&n.catch&&typeof n.catch=="function"?Ze.promise:typeof Map<"u"&&n instanceof Map?Ze.map:typeof Set<"u"&&n instanceof Set?Ze.set:typeof Date<"u"&&n instanceof Date?Ze.date:Ze.object;default:return Ze.unknown}},Be=jt.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]),hS=n=>JSON.stringify(n,null,2).replace(/"([^"]+)":/g,"$1:");class Er extends Error{constructor(a){super(),this.issues=[],this.addIssue=i=>{this.issues=[...this.issues,i]},this.addIssues=(i=[])=>{this.issues=[...this.issues,...i]};const s=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,s):this.__proto__=s,this.name="ZodError",this.issues=a}get errors(){return this.issues}format(a){const s=a||function(c){return c.message},i={_errors:[]},l=c=>{for(const d of c.issues)if(d.code==="invalid_union")d.unionErrors.map(l);else if(d.code==="invalid_return_type")l(d.returnTypeError);else if(d.code==="invalid_arguments")l(d.argumentsError);else if(d.path.length===0)i._errors.push(s(d));else{let m=i,p=0;for(;p<d.path.length;){const h=d.path[p];p===d.path.length-1?(m[h]=m[h]||{_errors:[]},m[h]._errors.push(s(d))):m[h]=m[h]||{_errors:[]},m=m[h],p++}}};return l(this),i}static assert(a){if(!(a instanceof Er))throw new Error(`Not a ZodError: ${a}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,jt.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(a=s=>s.message){const s={},i=[];for(const l of this.issues)l.path.length>0?(s[l.path[0]]=s[l.path[0]]||[],s[l.path[0]].push(a(l))):i.push(a(l));return{formErrors:i,fieldErrors:s}}get formErrors(){return this.flatten()}}Er.create=n=>new Er(n);const ro=(n,a)=>{let s;switch(n.code){case Be.invalid_type:n.received===Ze.undefined?s="Required":s=`Expected ${n.expected}, received ${n.received}`;break;case Be.invalid_literal:s=`Invalid literal value, expected ${JSON.stringify(n.expected,jt.jsonStringifyReplacer)}`;break;case Be.unrecognized_keys:s=`Unrecognized key(s) in object: ${jt.joinValues(n.keys,", ")}`;break;case Be.invalid_union:s="Invalid input";break;case Be.invalid_union_discriminator:s=`Invalid discriminator value. Expected ${jt.joinValues(n.options)}`;break;case Be.invalid_enum_value:s=`Invalid enum value. Expected ${jt.joinValues(n.options)}, received '${n.received}'`;break;case Be.invalid_arguments:s="Invalid function arguments";break;case Be.invalid_return_type:s="Invalid function return type";break;case Be.invalid_date:s="Invalid date";break;case Be.invalid_string:typeof n.validation=="object"?"includes"in n.validation?(s=`Invalid input: must include "${n.validation.includes}"`,typeof n.validation.position=="number"&&(s=`${s} at one or more positions greater than or equal to ${n.validation.position}`)):"startsWith"in n.validation?s=`Invalid input: must start with "${n.validation.startsWith}"`:"endsWith"in n.validation?s=`Invalid input: must end with "${n.validation.endsWith}"`:jt.assertNever(n.validation):n.validation!=="regex"?s=`Invalid ${n.validation}`:s="Invalid";break;case Be.too_small:n.type==="array"?s=`Array must contain ${n.exact?"exactly":n.inclusive?"at least":"more than"} ${n.minimum} element(s)`:n.type==="string"?s=`String must contain ${n.exact?"exactly":n.inclusive?"at least":"over"} ${n.minimum} character(s)`:n.type==="number"?s=`Number must be ${n.exact?"exactly equal to ":n.inclusive?"greater than or equal to ":"greater than "}${n.minimum}`:n.type==="date"?s=`Date must be ${n.exact?"exactly equal to ":n.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(n.minimum))}`:s="Invalid input";break;case Be.too_big:n.type==="array"?s=`Array must contain ${n.exact?"exactly":n.inclusive?"at most":"less than"} ${n.maximum} element(s)`:n.type==="string"?s=`String must contain ${n.exact?"exactly":n.inclusive?"at most":"under"} ${n.maximum} character(s)`:n.type==="number"?s=`Number must be ${n.exact?"exactly":n.inclusive?"less than or equal to":"less than"} ${n.maximum}`:n.type==="bigint"?s=`BigInt must be ${n.exact?"exactly":n.inclusive?"less than or equal to":"less than"} ${n.maximum}`:n.type==="date"?s=`Date must be ${n.exact?"exactly":n.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(n.maximum))}`:s="Invalid input";break;case Be.custom:s="Invalid input";break;case Be.invalid_intersection_types:s="Intersection results could not be merged";break;case Be.not_multiple_of:s=`Number must be a multiple of ${n.multipleOf}`;break;case Be.not_finite:s="Number must be finite";break;default:s=a.defaultError,jt.assertNever(n)}return{message:s}};let yb=ro;function mS(n){yb=n}function du(){return yb}const fu=n=>{const{data:a,path:s,errorMaps:i,issueData:l}=n,c=[...s,...l.path||[]],d={...l,path:c};if(l.message!==void 0)return{...l,path:c,message:l.message};let m="";const p=i.filter(h=>!!h).slice().reverse();for(const h of p)m=h(d,{data:a,defaultError:m}).message;return{...l,path:c,message:m}},pS=[];function Ye(n,a){const s=du(),i=fu({issueData:a,data:n.data,path:n.path,errorMaps:[n.common.contextualErrorMap,n.schemaErrorMap,s,s===ro?void 0:ro].filter(l=>!!l)});n.common.issues.push(i)}class Zn{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(a,s){const i=[];for(const l of s){if(l.status==="aborted")return ft;l.status==="dirty"&&a.dirty(),i.push(l.value)}return{status:a.value,value:i}}static async mergeObjectAsync(a,s){const i=[];for(const l of s){const c=await l.key,d=await l.value;i.push({key:c,value:d})}return Zn.mergeObjectSync(a,i)}static mergeObjectSync(a,s){const i={};for(const l of s){const{key:c,value:d}=l;if(c.status==="aborted"||d.status==="aborted")return ft;c.status==="dirty"&&a.dirty(),d.status==="dirty"&&a.dirty(),c.value!=="__proto__"&&(typeof d.value<"u"||l.alwaysSet)&&(i[c.value]=d.value)}return{status:a.value,value:i}}}const ft=Object.freeze({status:"aborted"}),Ji=n=>({status:"dirty",value:n}),er=n=>({status:"valid",value:n}),kh=n=>n.status==="aborted",Th=n=>n.status==="dirty",pl=n=>n.status==="valid",gl=n=>typeof Promise<"u"&&n instanceof Promise;function hu(n,a,s,i){if(typeof a=="function"?n!==a||!0:!a.has(n))throw new TypeError("Cannot read private member from an object whose class did not declare it");return a.get(n)}function vb(n,a,s,i,l){if(typeof a=="function"?n!==a||!0:!a.has(n))throw new TypeError("Cannot write private member to an object whose class did not declare it");return a.set(n,s),s}var nt;(function(n){n.errToObj=a=>typeof a=="string"?{message:a}:a||{},n.toString=a=>typeof a=="string"?a:a==null?void 0:a.message})(nt||(nt={}));var cl,ul;class pa{constructor(a,s,i,l){this._cachedPath=[],this.parent=a,this.data=s,this._path=i,this._key=l}get path(){return this._cachedPath.length||(this._key instanceof Array?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const Ry=(n,a)=>{if(pl(a))return{success:!0,data:a.value};if(!n.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const s=new Er(n.common.issues);return this._error=s,this._error}}};function yt(n){if(!n)return{};const{errorMap:a,invalid_type_error:s,required_error:i,description:l}=n;if(a&&(s||i))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return a?{errorMap:a,description:l}:{errorMap:(d,m)=>{var p,h;const{message:v}=n;return d.code==="invalid_enum_value"?{message:v??m.defaultError}:typeof m.data>"u"?{message:(p=v??i)!==null&&p!==void 0?p:m.defaultError}:d.code!=="invalid_type"?{message:m.defaultError}:{message:(h=v??s)!==null&&h!==void 0?h:m.defaultError}},description:l}}class _t{constructor(a){this.spa=this.safeParseAsync,this._def=a,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this)}get description(){return this._def.description}_getType(a){return As(a.data)}_getOrReturnCtx(a,s){return s||{common:a.parent.common,data:a.data,parsedType:As(a.data),schemaErrorMap:this._def.errorMap,path:a.path,parent:a.parent}}_processInputParams(a){return{status:new Zn,ctx:{common:a.parent.common,data:a.data,parsedType:As(a.data),schemaErrorMap:this._def.errorMap,path:a.path,parent:a.parent}}}_parseSync(a){const s=this._parse(a);if(gl(s))throw new Error("Synchronous parse encountered promise.");return s}_parseAsync(a){const s=this._parse(a);return Promise.resolve(s)}parse(a,s){const i=this.safeParse(a,s);if(i.success)return i.data;throw i.error}safeParse(a,s){var i;const l={common:{issues:[],async:(i=s==null?void 0:s.async)!==null&&i!==void 0?i:!1,contextualErrorMap:s==null?void 0:s.errorMap},path:(s==null?void 0:s.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:a,parsedType:As(a)},c=this._parseSync({data:a,path:l.path,parent:l});return Ry(l,c)}async parseAsync(a,s){const i=await this.safeParseAsync(a,s);if(i.success)return i.data;throw i.error}async safeParseAsync(a,s){const i={common:{issues:[],contextualErrorMap:s==null?void 0:s.errorMap,async:!0},path:(s==null?void 0:s.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:a,parsedType:As(a)},l=this._parse({data:a,path:i.path,parent:i}),c=await(gl(l)?l:Promise.resolve(l));return Ry(i,c)}refine(a,s){const i=l=>typeof s=="string"||typeof s>"u"?{message:s}:typeof s=="function"?s(l):s;return this._refinement((l,c)=>{const d=a(l),m=()=>c.addIssue({code:Be.custom,...i(l)});return typeof Promise<"u"&&d instanceof Promise?d.then(p=>p?!0:(m(),!1)):d?!0:(m(),!1)})}refinement(a,s){return this._refinement((i,l)=>a(i)?!0:(l.addIssue(typeof s=="function"?s(i,l):s),!1))}_refinement(a){return new aa({schema:this,typeName:ut.ZodEffects,effect:{type:"refinement",refinement:a}})}superRefine(a){return this._refinement(a)}optional(){return ma.create(this,this._def)}nullable(){return js.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return na.create(this,this._def)}promise(){return so.create(this,this._def)}or(a){return xl.create([this,a],this._def)}and(a){return _l.create(this,a,this._def)}transform(a){return new aa({...yt(this._def),schema:this,typeName:ut.ZodEffects,effect:{type:"transform",transform:a}})}default(a){const s=typeof a=="function"?a:()=>a;return new Tl({...yt(this._def),innerType:this,defaultValue:s,typeName:ut.ZodDefault})}brand(){return new Fh({typeName:ut.ZodBranded,type:this,...yt(this._def)})}catch(a){const s=typeof a=="function"?a:()=>a;return new Al({...yt(this._def),innerType:this,catchValue:s,typeName:ut.ZodCatch})}describe(a){const s=this.constructor;return new s({...this._def,description:a})}pipe(a){return Ol.create(this,a)}readonly(){return Nl.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const gS=/^c[^\s-]{8,}$/i,yS=/^[0-9a-z]+$/,vS=/^[0-9A-HJKMNP-TV-Z]{26}$/,bS=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,xS=/^[a-z0-9_-]{21}$/i,_S=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,SS=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,wS="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";let eh;const ES=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,kS=/^(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))$/,TS=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,bb="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",AS=new RegExp(`^${bb}$`);function xb(n){let a="([01]\\d|2[0-3]):[0-5]\\d:[0-5]\\d";return n.precision?a=`${a}\\.\\d{${n.precision}}`:n.precision==null&&(a=`${a}(\\.\\d+)?`),a}function NS(n){return new RegExp(`^${xb(n)}$`)}function _b(n){let a=`${bb}T${xb(n)}`;const s=[];return s.push(n.local?"Z?":"Z"),n.offset&&s.push("([+-]\\d{2}:?\\d{2})"),a=`${a}(${s.join("|")})`,new RegExp(`^${a}$`)}function DS(n,a){return!!((a==="v4"||!a)&&ES.test(n)||(a==="v6"||!a)&&kS.test(n))}class ta extends _t{_parse(a){if(this._def.coerce&&(a.data=String(a.data)),this._getType(a)!==Ze.string){const c=this._getOrReturnCtx(a);return Ye(c,{code:Be.invalid_type,expected:Ze.string,received:c.parsedType}),ft}const i=new Zn;let l;for(const c of this._def.checks)if(c.kind==="min")a.data.length<c.value&&(l=this._getOrReturnCtx(a,l),Ye(l,{code:Be.too_small,minimum:c.value,type:"string",inclusive:!0,exact:!1,message:c.message}),i.dirty());else if(c.kind==="max")a.data.length>c.value&&(l=this._getOrReturnCtx(a,l),Ye(l,{code:Be.too_big,maximum:c.value,type:"string",inclusive:!0,exact:!1,message:c.message}),i.dirty());else if(c.kind==="length"){const d=a.data.length>c.value,m=a.data.length<c.value;(d||m)&&(l=this._getOrReturnCtx(a,l),d?Ye(l,{code:Be.too_big,maximum:c.value,type:"string",inclusive:!0,exact:!0,message:c.message}):m&&Ye(l,{code:Be.too_small,minimum:c.value,type:"string",inclusive:!0,exact:!0,message:c.message}),i.dirty())}else if(c.kind==="email")SS.test(a.data)||(l=this._getOrReturnCtx(a,l),Ye(l,{validation:"email",code:Be.invalid_string,message:c.message}),i.dirty());else if(c.kind==="emoji")eh||(eh=new RegExp(wS,"u")),eh.test(a.data)||(l=this._getOrReturnCtx(a,l),Ye(l,{validation:"emoji",code:Be.invalid_string,message:c.message}),i.dirty());else if(c.kind==="uuid")bS.test(a.data)||(l=this._getOrReturnCtx(a,l),Ye(l,{validation:"uuid",code:Be.invalid_string,message:c.message}),i.dirty());else if(c.kind==="nanoid")xS.test(a.data)||(l=this._getOrReturnCtx(a,l),Ye(l,{validation:"nanoid",code:Be.invalid_string,message:c.message}),i.dirty());else if(c.kind==="cuid")gS.test(a.data)||(l=this._getOrReturnCtx(a,l),Ye(l,{validation:"cuid",code:Be.invalid_string,message:c.message}),i.dirty());else if(c.kind==="cuid2")yS.test(a.data)||(l=this._getOrReturnCtx(a,l),Ye(l,{validation:"cuid2",code:Be.invalid_string,message:c.message}),i.dirty());else if(c.kind==="ulid")vS.test(a.data)||(l=this._getOrReturnCtx(a,l),Ye(l,{validation:"ulid",code:Be.invalid_string,message:c.message}),i.dirty());else if(c.kind==="url")try{new URL(a.data)}catch{l=this._getOrReturnCtx(a,l),Ye(l,{validation:"url",code:Be.invalid_string,message:c.message}),i.dirty()}else c.kind==="regex"?(c.regex.lastIndex=0,c.regex.test(a.data)||(l=this._getOrReturnCtx(a,l),Ye(l,{validation:"regex",code:Be.invalid_string,message:c.message}),i.dirty())):c.kind==="trim"?a.data=a.data.trim():c.kind==="includes"?a.data.includes(c.value,c.position)||(l=this._getOrReturnCtx(a,l),Ye(l,{code:Be.invalid_string,validation:{includes:c.value,position:c.position},message:c.message}),i.dirty()):c.kind==="toLowerCase"?a.data=a.data.toLowerCase():c.kind==="toUpperCase"?a.data=a.data.toUpperCase():c.kind==="startsWith"?a.data.startsWith(c.value)||(l=this._getOrReturnCtx(a,l),Ye(l,{code:Be.invalid_string,validation:{startsWith:c.value},message:c.message}),i.dirty()):c.kind==="endsWith"?a.data.endsWith(c.value)||(l=this._getOrReturnCtx(a,l),Ye(l,{code:Be.invalid_string,validation:{endsWith:c.value},message:c.message}),i.dirty()):c.kind==="datetime"?_b(c).test(a.data)||(l=this._getOrReturnCtx(a,l),Ye(l,{code:Be.invalid_string,validation:"datetime",message:c.message}),i.dirty()):c.kind==="date"?AS.test(a.data)||(l=this._getOrReturnCtx(a,l),Ye(l,{code:Be.invalid_string,validation:"date",message:c.message}),i.dirty()):c.kind==="time"?NS(c).test(a.data)||(l=this._getOrReturnCtx(a,l),Ye(l,{code:Be.invalid_string,validation:"time",message:c.message}),i.dirty()):c.kind==="duration"?_S.test(a.data)||(l=this._getOrReturnCtx(a,l),Ye(l,{validation:"duration",code:Be.invalid_string,message:c.message}),i.dirty()):c.kind==="ip"?DS(a.data,c.version)||(l=this._getOrReturnCtx(a,l),Ye(l,{validation:"ip",code:Be.invalid_string,message:c.message}),i.dirty()):c.kind==="base64"?TS.test(a.data)||(l=this._getOrReturnCtx(a,l),Ye(l,{validation:"base64",code:Be.invalid_string,message:c.message}),i.dirty()):jt.assertNever(c);return{status:i.value,value:a.data}}_regex(a,s,i){return this.refinement(l=>a.test(l),{validation:s,code:Be.invalid_string,...nt.errToObj(i)})}_addCheck(a){return new ta({...this._def,checks:[...this._def.checks,a]})}email(a){return this._addCheck({kind:"email",...nt.errToObj(a)})}url(a){return this._addCheck({kind:"url",...nt.errToObj(a)})}emoji(a){return this._addCheck({kind:"emoji",...nt.errToObj(a)})}uuid(a){return this._addCheck({kind:"uuid",...nt.errToObj(a)})}nanoid(a){return this._addCheck({kind:"nanoid",...nt.errToObj(a)})}cuid(a){return this._addCheck({kind:"cuid",...nt.errToObj(a)})}cuid2(a){return this._addCheck({kind:"cuid2",...nt.errToObj(a)})}ulid(a){return this._addCheck({kind:"ulid",...nt.errToObj(a)})}base64(a){return this._addCheck({kind:"base64",...nt.errToObj(a)})}ip(a){return this._addCheck({kind:"ip",...nt.errToObj(a)})}datetime(a){var s,i;return typeof a=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:a}):this._addCheck({kind:"datetime",precision:typeof(a==null?void 0:a.precision)>"u"?null:a==null?void 0:a.precision,offset:(s=a==null?void 0:a.offset)!==null&&s!==void 0?s:!1,local:(i=a==null?void 0:a.local)!==null&&i!==void 0?i:!1,...nt.errToObj(a==null?void 0:a.message)})}date(a){return this._addCheck({kind:"date",message:a})}time(a){return typeof a=="string"?this._addCheck({kind:"time",precision:null,message:a}):this._addCheck({kind:"time",precision:typeof(a==null?void 0:a.precision)>"u"?null:a==null?void 0:a.precision,...nt.errToObj(a==null?void 0:a.message)})}duration(a){return this._addCheck({kind:"duration",...nt.errToObj(a)})}regex(a,s){return this._addCheck({kind:"regex",regex:a,...nt.errToObj(s)})}includes(a,s){return this._addCheck({kind:"includes",value:a,position:s==null?void 0:s.position,...nt.errToObj(s==null?void 0:s.message)})}startsWith(a,s){return this._addCheck({kind:"startsWith",value:a,...nt.errToObj(s)})}endsWith(a,s){return this._addCheck({kind:"endsWith",value:a,...nt.errToObj(s)})}min(a,s){return this._addCheck({kind:"min",value:a,...nt.errToObj(s)})}max(a,s){return this._addCheck({kind:"max",value:a,...nt.errToObj(s)})}length(a,s){return this._addCheck({kind:"length",value:a,...nt.errToObj(s)})}nonempty(a){return this.min(1,nt.errToObj(a))}trim(){return new ta({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new ta({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new ta({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(a=>a.kind==="datetime")}get isDate(){return!!this._def.checks.find(a=>a.kind==="date")}get isTime(){return!!this._def.checks.find(a=>a.kind==="time")}get isDuration(){return!!this._def.checks.find(a=>a.kind==="duration")}get isEmail(){return!!this._def.checks.find(a=>a.kind==="email")}get isURL(){return!!this._def.checks.find(a=>a.kind==="url")}get isEmoji(){return!!this._def.checks.find(a=>a.kind==="emoji")}get isUUID(){return!!this._def.checks.find(a=>a.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(a=>a.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(a=>a.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(a=>a.kind==="cuid2")}get isULID(){return!!this._def.checks.find(a=>a.kind==="ulid")}get isIP(){return!!this._def.checks.find(a=>a.kind==="ip")}get isBase64(){return!!this._def.checks.find(a=>a.kind==="base64")}get minLength(){let a=null;for(const s of this._def.checks)s.kind==="min"&&(a===null||s.value>a)&&(a=s.value);return a}get maxLength(){let a=null;for(const s of this._def.checks)s.kind==="max"&&(a===null||s.value<a)&&(a=s.value);return a}}ta.create=n=>{var a;return new ta({checks:[],typeName:ut.ZodString,coerce:(a=n==null?void 0:n.coerce)!==null&&a!==void 0?a:!1,...yt(n)})};function CS(n,a){const s=(n.toString().split(".")[1]||"").length,i=(a.toString().split(".")[1]||"").length,l=s>i?s:i,c=parseInt(n.toFixed(l).replace(".","")),d=parseInt(a.toFixed(l).replace(".",""));return c%d/Math.pow(10,l)}class Ds extends _t{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(a){if(this._def.coerce&&(a.data=Number(a.data)),this._getType(a)!==Ze.number){const c=this._getOrReturnCtx(a);return Ye(c,{code:Be.invalid_type,expected:Ze.number,received:c.parsedType}),ft}let i;const l=new Zn;for(const c of this._def.checks)c.kind==="int"?jt.isInteger(a.data)||(i=this._getOrReturnCtx(a,i),Ye(i,{code:Be.invalid_type,expected:"integer",received:"float",message:c.message}),l.dirty()):c.kind==="min"?(c.inclusive?a.data<c.value:a.data<=c.value)&&(i=this._getOrReturnCtx(a,i),Ye(i,{code:Be.too_small,minimum:c.value,type:"number",inclusive:c.inclusive,exact:!1,message:c.message}),l.dirty()):c.kind==="max"?(c.inclusive?a.data>c.value:a.data>=c.value)&&(i=this._getOrReturnCtx(a,i),Ye(i,{code:Be.too_big,maximum:c.value,type:"number",inclusive:c.inclusive,exact:!1,message:c.message}),l.dirty()):c.kind==="multipleOf"?CS(a.data,c.value)!==0&&(i=this._getOrReturnCtx(a,i),Ye(i,{code:Be.not_multiple_of,multipleOf:c.value,message:c.message}),l.dirty()):c.kind==="finite"?Number.isFinite(a.data)||(i=this._getOrReturnCtx(a,i),Ye(i,{code:Be.not_finite,message:c.message}),l.dirty()):jt.assertNever(c);return{status:l.value,value:a.data}}gte(a,s){return this.setLimit("min",a,!0,nt.toString(s))}gt(a,s){return this.setLimit("min",a,!1,nt.toString(s))}lte(a,s){return this.setLimit("max",a,!0,nt.toString(s))}lt(a,s){return this.setLimit("max",a,!1,nt.toString(s))}setLimit(a,s,i,l){return new Ds({...this._def,checks:[...this._def.checks,{kind:a,value:s,inclusive:i,message:nt.toString(l)}]})}_addCheck(a){return new Ds({...this._def,checks:[...this._def.checks,a]})}int(a){return this._addCheck({kind:"int",message:nt.toString(a)})}positive(a){return this._addCheck({kind:"min",value:0,inclusive:!1,message:nt.toString(a)})}negative(a){return this._addCheck({kind:"max",value:0,inclusive:!1,message:nt.toString(a)})}nonpositive(a){return this._addCheck({kind:"max",value:0,inclusive:!0,message:nt.toString(a)})}nonnegative(a){return this._addCheck({kind:"min",value:0,inclusive:!0,message:nt.toString(a)})}multipleOf(a,s){return this._addCheck({kind:"multipleOf",value:a,message:nt.toString(s)})}finite(a){return this._addCheck({kind:"finite",message:nt.toString(a)})}safe(a){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:nt.toString(a)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:nt.toString(a)})}get minValue(){let a=null;for(const s of this._def.checks)s.kind==="min"&&(a===null||s.value>a)&&(a=s.value);return a}get maxValue(){let a=null;for(const s of this._def.checks)s.kind==="max"&&(a===null||s.value<a)&&(a=s.value);return a}get isInt(){return!!this._def.checks.find(a=>a.kind==="int"||a.kind==="multipleOf"&&jt.isInteger(a.value))}get isFinite(){let a=null,s=null;for(const i of this._def.checks){if(i.kind==="finite"||i.kind==="int"||i.kind==="multipleOf")return!0;i.kind==="min"?(s===null||i.value>s)&&(s=i.value):i.kind==="max"&&(a===null||i.value<a)&&(a=i.value)}return Number.isFinite(s)&&Number.isFinite(a)}}Ds.create=n=>new Ds({checks:[],typeName:ut.ZodNumber,coerce:(n==null?void 0:n.coerce)||!1,...yt(n)});class Cs extends _t{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(a){if(this._def.coerce&&(a.data=BigInt(a.data)),this._getType(a)!==Ze.bigint){const c=this._getOrReturnCtx(a);return Ye(c,{code:Be.invalid_type,expected:Ze.bigint,received:c.parsedType}),ft}let i;const l=new Zn;for(const c of this._def.checks)c.kind==="min"?(c.inclusive?a.data<c.value:a.data<=c.value)&&(i=this._getOrReturnCtx(a,i),Ye(i,{code:Be.too_small,type:"bigint",minimum:c.value,inclusive:c.inclusive,message:c.message}),l.dirty()):c.kind==="max"?(c.inclusive?a.data>c.value:a.data>=c.value)&&(i=this._getOrReturnCtx(a,i),Ye(i,{code:Be.too_big,type:"bigint",maximum:c.value,inclusive:c.inclusive,message:c.message}),l.dirty()):c.kind==="multipleOf"?a.data%c.value!==BigInt(0)&&(i=this._getOrReturnCtx(a,i),Ye(i,{code:Be.not_multiple_of,multipleOf:c.value,message:c.message}),l.dirty()):jt.assertNever(c);return{status:l.value,value:a.data}}gte(a,s){return this.setLimit("min",a,!0,nt.toString(s))}gt(a,s){return this.setLimit("min",a,!1,nt.toString(s))}lte(a,s){return this.setLimit("max",a,!0,nt.toString(s))}lt(a,s){return this.setLimit("max",a,!1,nt.toString(s))}setLimit(a,s,i,l){return new Cs({...this._def,checks:[...this._def.checks,{kind:a,value:s,inclusive:i,message:nt.toString(l)}]})}_addCheck(a){return new Cs({...this._def,checks:[...this._def.checks,a]})}positive(a){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:nt.toString(a)})}negative(a){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:nt.toString(a)})}nonpositive(a){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:nt.toString(a)})}nonnegative(a){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:nt.toString(a)})}multipleOf(a,s){return this._addCheck({kind:"multipleOf",value:a,message:nt.toString(s)})}get minValue(){let a=null;for(const s of this._def.checks)s.kind==="min"&&(a===null||s.value>a)&&(a=s.value);return a}get maxValue(){let a=null;for(const s of this._def.checks)s.kind==="max"&&(a===null||s.value<a)&&(a=s.value);return a}}Cs.create=n=>{var a;return new Cs({checks:[],typeName:ut.ZodBigInt,coerce:(a=n==null?void 0:n.coerce)!==null&&a!==void 0?a:!1,...yt(n)})};class yl extends _t{_parse(a){if(this._def.coerce&&(a.data=!!a.data),this._getType(a)!==Ze.boolean){const i=this._getOrReturnCtx(a);return Ye(i,{code:Be.invalid_type,expected:Ze.boolean,received:i.parsedType}),ft}return er(a.data)}}yl.create=n=>new yl({typeName:ut.ZodBoolean,coerce:(n==null?void 0:n.coerce)||!1,...yt(n)});class ai extends _t{_parse(a){if(this._def.coerce&&(a.data=new Date(a.data)),this._getType(a)!==Ze.date){const c=this._getOrReturnCtx(a);return Ye(c,{code:Be.invalid_type,expected:Ze.date,received:c.parsedType}),ft}if(isNaN(a.data.getTime())){const c=this._getOrReturnCtx(a);return Ye(c,{code:Be.invalid_date}),ft}const i=new Zn;let l;for(const c of this._def.checks)c.kind==="min"?a.data.getTime()<c.value&&(l=this._getOrReturnCtx(a,l),Ye(l,{code:Be.too_small,message:c.message,inclusive:!0,exact:!1,minimum:c.value,type:"date"}),i.dirty()):c.kind==="max"?a.data.getTime()>c.value&&(l=this._getOrReturnCtx(a,l),Ye(l,{code:Be.too_big,message:c.message,inclusive:!0,exact:!1,maximum:c.value,type:"date"}),i.dirty()):jt.assertNever(c);return{status:i.value,value:new Date(a.data.getTime())}}_addCheck(a){return new ai({...this._def,checks:[...this._def.checks,a]})}min(a,s){return this._addCheck({kind:"min",value:a.getTime(),message:nt.toString(s)})}max(a,s){return this._addCheck({kind:"max",value:a.getTime(),message:nt.toString(s)})}get minDate(){let a=null;for(const s of this._def.checks)s.kind==="min"&&(a===null||s.value>a)&&(a=s.value);return a!=null?new Date(a):null}get maxDate(){let a=null;for(const s of this._def.checks)s.kind==="max"&&(a===null||s.value<a)&&(a=s.value);return a!=null?new Date(a):null}}ai.create=n=>new ai({checks:[],coerce:(n==null?void 0:n.coerce)||!1,typeName:ut.ZodDate,...yt(n)});class mu extends _t{_parse(a){if(this._getType(a)!==Ze.symbol){const i=this._getOrReturnCtx(a);return Ye(i,{code:Be.invalid_type,expected:Ze.symbol,received:i.parsedType}),ft}return er(a.data)}}mu.create=n=>new mu({typeName:ut.ZodSymbol,...yt(n)});class vl extends _t{_parse(a){if(this._getType(a)!==Ze.undefined){const i=this._getOrReturnCtx(a);return Ye(i,{code:Be.invalid_type,expected:Ze.undefined,received:i.parsedType}),ft}return er(a.data)}}vl.create=n=>new vl({typeName:ut.ZodUndefined,...yt(n)});class bl extends _t{_parse(a){if(this._getType(a)!==Ze.null){const i=this._getOrReturnCtx(a);return Ye(i,{code:Be.invalid_type,expected:Ze.null,received:i.parsedType}),ft}return er(a.data)}}bl.create=n=>new bl({typeName:ut.ZodNull,...yt(n)});class ao extends _t{constructor(){super(...arguments),this._any=!0}_parse(a){return er(a.data)}}ao.create=n=>new ao({typeName:ut.ZodAny,...yt(n)});class ri extends _t{constructor(){super(...arguments),this._unknown=!0}_parse(a){return er(a.data)}}ri.create=n=>new ri({typeName:ut.ZodUnknown,...yt(n)});class qa extends _t{_parse(a){const s=this._getOrReturnCtx(a);return Ye(s,{code:Be.invalid_type,expected:Ze.never,received:s.parsedType}),ft}}qa.create=n=>new qa({typeName:ut.ZodNever,...yt(n)});class pu extends _t{_parse(a){if(this._getType(a)!==Ze.undefined){const i=this._getOrReturnCtx(a);return Ye(i,{code:Be.invalid_type,expected:Ze.void,received:i.parsedType}),ft}return er(a.data)}}pu.create=n=>new pu({typeName:ut.ZodVoid,...yt(n)});class na extends _t{_parse(a){const{ctx:s,status:i}=this._processInputParams(a),l=this._def;if(s.parsedType!==Ze.array)return Ye(s,{code:Be.invalid_type,expected:Ze.array,received:s.parsedType}),ft;if(l.exactLength!==null){const d=s.data.length>l.exactLength.value,m=s.data.length<l.exactLength.value;(d||m)&&(Ye(s,{code:d?Be.too_big:Be.too_small,minimum:m?l.exactLength.value:void 0,maximum:d?l.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:l.exactLength.message}),i.dirty())}if(l.minLength!==null&&s.data.length<l.minLength.value&&(Ye(s,{code:Be.too_small,minimum:l.minLength.value,type:"array",inclusive:!0,exact:!1,message:l.minLength.message}),i.dirty()),l.maxLength!==null&&s.data.length>l.maxLength.value&&(Ye(s,{code:Be.too_big,maximum:l.maxLength.value,type:"array",inclusive:!0,exact:!1,message:l.maxLength.message}),i.dirty()),s.common.async)return Promise.all([...s.data].map((d,m)=>l.type._parseAsync(new pa(s,d,s.path,m)))).then(d=>Zn.mergeArray(i,d));const c=[...s.data].map((d,m)=>l.type._parseSync(new pa(s,d,s.path,m)));return Zn.mergeArray(i,c)}get element(){return this._def.type}min(a,s){return new na({...this._def,minLength:{value:a,message:nt.toString(s)}})}max(a,s){return new na({...this._def,maxLength:{value:a,message:nt.toString(s)}})}length(a,s){return new na({...this._def,exactLength:{value:a,message:nt.toString(s)}})}nonempty(a){return this.min(1,a)}}na.create=(n,a)=>new na({type:n,minLength:null,maxLength:null,exactLength:null,typeName:ut.ZodArray,...yt(a)});function Zi(n){if(n instanceof dn){const a={};for(const s in n.shape){const i=n.shape[s];a[s]=ma.create(Zi(i))}return new dn({...n._def,shape:()=>a})}else return n instanceof na?new na({...n._def,type:Zi(n.element)}):n instanceof ma?ma.create(Zi(n.unwrap())):n instanceof js?js.create(Zi(n.unwrap())):n instanceof ga?ga.create(n.items.map(a=>Zi(a))):n}class dn extends _t{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;const a=this._def.shape(),s=jt.objectKeys(a);return this._cached={shape:a,keys:s}}_parse(a){if(this._getType(a)!==Ze.object){const h=this._getOrReturnCtx(a);return Ye(h,{code:Be.invalid_type,expected:Ze.object,received:h.parsedType}),ft}const{status:i,ctx:l}=this._processInputParams(a),{shape:c,keys:d}=this._getCached(),m=[];if(!(this._def.catchall instanceof qa&&this._def.unknownKeys==="strip"))for(const h in l.data)d.includes(h)||m.push(h);const p=[];for(const h of d){const v=c[h],S=l.data[h];p.push({key:{status:"valid",value:h},value:v._parse(new pa(l,S,l.path,h)),alwaysSet:h in l.data})}if(this._def.catchall instanceof qa){const h=this._def.unknownKeys;if(h==="passthrough")for(const v of m)p.push({key:{status:"valid",value:v},value:{status:"valid",value:l.data[v]}});else if(h==="strict")m.length>0&&(Ye(l,{code:Be.unrecognized_keys,keys:m}),i.dirty());else if(h!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const h=this._def.catchall;for(const v of m){const S=l.data[v];p.push({key:{status:"valid",value:v},value:h._parse(new pa(l,S,l.path,v)),alwaysSet:v in l.data})}}return l.common.async?Promise.resolve().then(async()=>{const h=[];for(const v of p){const S=await v.key,A=await v.value;h.push({key:S,value:A,alwaysSet:v.alwaysSet})}return h}).then(h=>Zn.mergeObjectSync(i,h)):Zn.mergeObjectSync(i,p)}get shape(){return this._def.shape()}strict(a){return nt.errToObj,new dn({...this._def,unknownKeys:"strict",...a!==void 0?{errorMap:(s,i)=>{var l,c,d,m;const p=(d=(c=(l=this._def).errorMap)===null||c===void 0?void 0:c.call(l,s,i).message)!==null&&d!==void 0?d:i.defaultError;return s.code==="unrecognized_keys"?{message:(m=nt.errToObj(a).message)!==null&&m!==void 0?m:p}:{message:p}}}:{}})}strip(){return new dn({...this._def,unknownKeys:"strip"})}passthrough(){return new dn({...this._def,unknownKeys:"passthrough"})}extend(a){return new dn({...this._def,shape:()=>({...this._def.shape(),...a})})}merge(a){return new dn({unknownKeys:a._def.unknownKeys,catchall:a._def.catchall,shape:()=>({...this._def.shape(),...a._def.shape()}),typeName:ut.ZodObject})}setKey(a,s){return this.augment({[a]:s})}catchall(a){return new dn({...this._def,catchall:a})}pick(a){const s={};return jt.objectKeys(a).forEach(i=>{a[i]&&this.shape[i]&&(s[i]=this.shape[i])}),new dn({...this._def,shape:()=>s})}omit(a){const s={};return jt.objectKeys(this.shape).forEach(i=>{a[i]||(s[i]=this.shape[i])}),new dn({...this._def,shape:()=>s})}deepPartial(){return Zi(this)}partial(a){const s={};return jt.objectKeys(this.shape).forEach(i=>{const l=this.shape[i];a&&!a[i]?s[i]=l:s[i]=l.optional()}),new dn({...this._def,shape:()=>s})}required(a){const s={};return jt.objectKeys(this.shape).forEach(i=>{if(a&&!a[i])s[i]=this.shape[i];else{let c=this.shape[i];for(;c instanceof ma;)c=c._def.innerType;s[i]=c}}),new dn({...this._def,shape:()=>s})}keyof(){return Sb(jt.objectKeys(this.shape))}}dn.create=(n,a)=>new dn({shape:()=>n,unknownKeys:"strip",catchall:qa.create(),typeName:ut.ZodObject,...yt(a)});dn.strictCreate=(n,a)=>new dn({shape:()=>n,unknownKeys:"strict",catchall:qa.create(),typeName:ut.ZodObject,...yt(a)});dn.lazycreate=(n,a)=>new dn({shape:n,unknownKeys:"strip",catchall:qa.create(),typeName:ut.ZodObject,...yt(a)});class xl extends _t{_parse(a){const{ctx:s}=this._processInputParams(a),i=this._def.options;function l(c){for(const m of c)if(m.result.status==="valid")return m.result;for(const m of c)if(m.result.status==="dirty")return s.common.issues.push(...m.ctx.common.issues),m.result;const d=c.map(m=>new Er(m.ctx.common.issues));return Ye(s,{code:Be.invalid_union,unionErrors:d}),ft}if(s.common.async)return Promise.all(i.map(async c=>{const d={...s,common:{...s.common,issues:[]},parent:null};return{result:await c._parseAsync({data:s.data,path:s.path,parent:d}),ctx:d}})).then(l);{let c;const d=[];for(const p of i){const h={...s,common:{...s.common,issues:[]},parent:null},v=p._parseSync({data:s.data,path:s.path,parent:h});if(v.status==="valid")return v;v.status==="dirty"&&!c&&(c={result:v,ctx:h}),h.common.issues.length&&d.push(h.common.issues)}if(c)return s.common.issues.push(...c.ctx.common.issues),c.result;const m=d.map(p=>new Er(p));return Ye(s,{code:Be.invalid_union,unionErrors:m}),ft}}get options(){return this._def.options}}xl.create=(n,a)=>new xl({options:n,typeName:ut.ZodUnion,...yt(a)});const Ga=n=>n instanceof wl?Ga(n.schema):n instanceof aa?Ga(n.innerType()):n instanceof El?[n.value]:n instanceof Os?n.options:n instanceof kl?jt.objectValues(n.enum):n instanceof Tl?Ga(n._def.innerType):n instanceof vl?[void 0]:n instanceof bl?[null]:n instanceof ma?[void 0,...Ga(n.unwrap())]:n instanceof js?[null,...Ga(n.unwrap())]:n instanceof Fh||n instanceof Nl?Ga(n.unwrap()):n instanceof Al?Ga(n._def.innerType):[];class wu extends _t{_parse(a){const{ctx:s}=this._processInputParams(a);if(s.parsedType!==Ze.object)return Ye(s,{code:Be.invalid_type,expected:Ze.object,received:s.parsedType}),ft;const i=this.discriminator,l=s.data[i],c=this.optionsMap.get(l);return c?s.common.async?c._parseAsync({data:s.data,path:s.path,parent:s}):c._parseSync({data:s.data,path:s.path,parent:s}):(Ye(s,{code:Be.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[i]}),ft)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(a,s,i){const l=new Map;for(const c of s){const d=Ga(c.shape[a]);if(!d.length)throw new Error(`A discriminator value for key \`${a}\` could not be extracted from all schema options`);for(const m of d){if(l.has(m))throw new Error(`Discriminator property ${String(a)} has duplicate value ${String(m)}`);l.set(m,c)}}return new wu({typeName:ut.ZodDiscriminatedUnion,discriminator:a,options:s,optionsMap:l,...yt(i)})}}function Ah(n,a){const s=As(n),i=As(a);if(n===a)return{valid:!0,data:n};if(s===Ze.object&&i===Ze.object){const l=jt.objectKeys(a),c=jt.objectKeys(n).filter(m=>l.indexOf(m)!==-1),d={...n,...a};for(const m of c){const p=Ah(n[m],a[m]);if(!p.valid)return{valid:!1};d[m]=p.data}return{valid:!0,data:d}}else if(s===Ze.array&&i===Ze.array){if(n.length!==a.length)return{valid:!1};const l=[];for(let c=0;c<n.length;c++){const d=n[c],m=a[c],p=Ah(d,m);if(!p.valid)return{valid:!1};l.push(p.data)}return{valid:!0,data:l}}else return s===Ze.date&&i===Ze.date&&+n==+a?{valid:!0,data:n}:{valid:!1}}class _l extends _t{_parse(a){const{status:s,ctx:i}=this._processInputParams(a),l=(c,d)=>{if(kh(c)||kh(d))return ft;const m=Ah(c.value,d.value);return m.valid?((Th(c)||Th(d))&&s.dirty(),{status:s.value,value:m.data}):(Ye(i,{code:Be.invalid_intersection_types}),ft)};return i.common.async?Promise.all([this._def.left._parseAsync({data:i.data,path:i.path,parent:i}),this._def.right._parseAsync({data:i.data,path:i.path,parent:i})]).then(([c,d])=>l(c,d)):l(this._def.left._parseSync({data:i.data,path:i.path,parent:i}),this._def.right._parseSync({data:i.data,path:i.path,parent:i}))}}_l.create=(n,a,s)=>new _l({left:n,right:a,typeName:ut.ZodIntersection,...yt(s)});class ga extends _t{_parse(a){const{status:s,ctx:i}=this._processInputParams(a);if(i.parsedType!==Ze.array)return Ye(i,{code:Be.invalid_type,expected:Ze.array,received:i.parsedType}),ft;if(i.data.length<this._def.items.length)return Ye(i,{code:Be.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),ft;!this._def.rest&&i.data.length>this._def.items.length&&(Ye(i,{code:Be.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),s.dirty());const c=[...i.data].map((d,m)=>{const p=this._def.items[m]||this._def.rest;return p?p._parse(new pa(i,d,i.path,m)):null}).filter(d=>!!d);return i.common.async?Promise.all(c).then(d=>Zn.mergeArray(s,d)):Zn.mergeArray(s,c)}get items(){return this._def.items}rest(a){return new ga({...this._def,rest:a})}}ga.create=(n,a)=>{if(!Array.isArray(n))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new ga({items:n,typeName:ut.ZodTuple,rest:null,...yt(a)})};class Sl extends _t{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(a){const{status:s,ctx:i}=this._processInputParams(a);if(i.parsedType!==Ze.object)return Ye(i,{code:Be.invalid_type,expected:Ze.object,received:i.parsedType}),ft;const l=[],c=this._def.keyType,d=this._def.valueType;for(const m in i.data)l.push({key:c._parse(new pa(i,m,i.path,m)),value:d._parse(new pa(i,i.data[m],i.path,m)),alwaysSet:m in i.data});return i.common.async?Zn.mergeObjectAsync(s,l):Zn.mergeObjectSync(s,l)}get element(){return this._def.valueType}static create(a,s,i){return s instanceof _t?new Sl({keyType:a,valueType:s,typeName:ut.ZodRecord,...yt(i)}):new Sl({keyType:ta.create(),valueType:a,typeName:ut.ZodRecord,...yt(s)})}}class gu extends _t{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(a){const{status:s,ctx:i}=this._processInputParams(a);if(i.parsedType!==Ze.map)return Ye(i,{code:Be.invalid_type,expected:Ze.map,received:i.parsedType}),ft;const l=this._def.keyType,c=this._def.valueType,d=[...i.data.entries()].map(([m,p],h)=>({key:l._parse(new pa(i,m,i.path,[h,"key"])),value:c._parse(new pa(i,p,i.path,[h,"value"]))}));if(i.common.async){const m=new Map;return Promise.resolve().then(async()=>{for(const p of d){const h=await p.key,v=await p.value;if(h.status==="aborted"||v.status==="aborted")return ft;(h.status==="dirty"||v.status==="dirty")&&s.dirty(),m.set(h.value,v.value)}return{status:s.value,value:m}})}else{const m=new Map;for(const p of d){const h=p.key,v=p.value;if(h.status==="aborted"||v.status==="aborted")return ft;(h.status==="dirty"||v.status==="dirty")&&s.dirty(),m.set(h.value,v.value)}return{status:s.value,value:m}}}}gu.create=(n,a,s)=>new gu({valueType:a,keyType:n,typeName:ut.ZodMap,...yt(s)});class si extends _t{_parse(a){const{status:s,ctx:i}=this._processInputParams(a);if(i.parsedType!==Ze.set)return Ye(i,{code:Be.invalid_type,expected:Ze.set,received:i.parsedType}),ft;const l=this._def;l.minSize!==null&&i.data.size<l.minSize.value&&(Ye(i,{code:Be.too_small,minimum:l.minSize.value,type:"set",inclusive:!0,exact:!1,message:l.minSize.message}),s.dirty()),l.maxSize!==null&&i.data.size>l.maxSize.value&&(Ye(i,{code:Be.too_big,maximum:l.maxSize.value,type:"set",inclusive:!0,exact:!1,message:l.maxSize.message}),s.dirty());const c=this._def.valueType;function d(p){const h=new Set;for(const v of p){if(v.status==="aborted")return ft;v.status==="dirty"&&s.dirty(),h.add(v.value)}return{status:s.value,value:h}}const m=[...i.data.values()].map((p,h)=>c._parse(new pa(i,p,i.path,h)));return i.common.async?Promise.all(m).then(p=>d(p)):d(m)}min(a,s){return new si({...this._def,minSize:{value:a,message:nt.toString(s)}})}max(a,s){return new si({...this._def,maxSize:{value:a,message:nt.toString(s)}})}size(a,s){return this.min(a,s).max(a,s)}nonempty(a){return this.min(1,a)}}si.create=(n,a)=>new si({valueType:n,minSize:null,maxSize:null,typeName:ut.ZodSet,...yt(a)});class eo extends _t{constructor(){super(...arguments),this.validate=this.implement}_parse(a){const{ctx:s}=this._processInputParams(a);if(s.parsedType!==Ze.function)return Ye(s,{code:Be.invalid_type,expected:Ze.function,received:s.parsedType}),ft;function i(m,p){return fu({data:m,path:s.path,errorMaps:[s.common.contextualErrorMap,s.schemaErrorMap,du(),ro].filter(h=>!!h),issueData:{code:Be.invalid_arguments,argumentsError:p}})}function l(m,p){return fu({data:m,path:s.path,errorMaps:[s.common.contextualErrorMap,s.schemaErrorMap,du(),ro].filter(h=>!!h),issueData:{code:Be.invalid_return_type,returnTypeError:p}})}const c={errorMap:s.common.contextualErrorMap},d=s.data;if(this._def.returns instanceof so){const m=this;return er(async function(...p){const h=new Er([]),v=await m._def.args.parseAsync(p,c).catch(_=>{throw h.addIssue(i(p,_)),h}),S=await Reflect.apply(d,this,v);return await m._def.returns._def.type.parseAsync(S,c).catch(_=>{throw h.addIssue(l(S,_)),h})})}else{const m=this;return er(function(...p){const h=m._def.args.safeParse(p,c);if(!h.success)throw new Er([i(p,h.error)]);const v=Reflect.apply(d,this,h.data),S=m._def.returns.safeParse(v,c);if(!S.success)throw new Er([l(v,S.error)]);return S.data})}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...a){return new eo({...this._def,args:ga.create(a).rest(ri.create())})}returns(a){return new eo({...this._def,returns:a})}implement(a){return this.parse(a)}strictImplement(a){return this.parse(a)}static create(a,s,i){return new eo({args:a||ga.create([]).rest(ri.create()),returns:s||ri.create(),typeName:ut.ZodFunction,...yt(i)})}}class wl extends _t{get schema(){return this._def.getter()}_parse(a){const{ctx:s}=this._processInputParams(a);return this._def.getter()._parse({data:s.data,path:s.path,parent:s})}}wl.create=(n,a)=>new wl({getter:n,typeName:ut.ZodLazy,...yt(a)});class El extends _t{_parse(a){if(a.data!==this._def.value){const s=this._getOrReturnCtx(a);return Ye(s,{received:s.data,code:Be.invalid_literal,expected:this._def.value}),ft}return{status:"valid",value:a.data}}get value(){return this._def.value}}El.create=(n,a)=>new El({value:n,typeName:ut.ZodLiteral,...yt(a)});function Sb(n,a){return new Os({values:n,typeName:ut.ZodEnum,...yt(a)})}class Os extends _t{constructor(){super(...arguments),cl.set(this,void 0)}_parse(a){if(typeof a.data!="string"){const s=this._getOrReturnCtx(a),i=this._def.values;return Ye(s,{expected:jt.joinValues(i),received:s.parsedType,code:Be.invalid_type}),ft}if(hu(this,cl)||vb(this,cl,new Set(this._def.values)),!hu(this,cl).has(a.data)){const s=this._getOrReturnCtx(a),i=this._def.values;return Ye(s,{received:s.data,code:Be.invalid_enum_value,options:i}),ft}return er(a.data)}get options(){return this._def.values}get enum(){const a={};for(const s of this._def.values)a[s]=s;return a}get Values(){const a={};for(const s of this._def.values)a[s]=s;return a}get Enum(){const a={};for(const s of this._def.values)a[s]=s;return a}extract(a,s=this._def){return Os.create(a,{...this._def,...s})}exclude(a,s=this._def){return Os.create(this.options.filter(i=>!a.includes(i)),{...this._def,...s})}}cl=new WeakMap;Os.create=Sb;class kl extends _t{constructor(){super(...arguments),ul.set(this,void 0)}_parse(a){const s=jt.getValidEnumValues(this._def.values),i=this._getOrReturnCtx(a);if(i.parsedType!==Ze.string&&i.parsedType!==Ze.number){const l=jt.objectValues(s);return Ye(i,{expected:jt.joinValues(l),received:i.parsedType,code:Be.invalid_type}),ft}if(hu(this,ul)||vb(this,ul,new Set(jt.getValidEnumValues(this._def.values))),!hu(this,ul).has(a.data)){const l=jt.objectValues(s);return Ye(i,{received:i.data,code:Be.invalid_enum_value,options:l}),ft}return er(a.data)}get enum(){return this._def.values}}ul=new WeakMap;kl.create=(n,a)=>new kl({values:n,typeName:ut.ZodNativeEnum,...yt(a)});class so extends _t{unwrap(){return this._def.type}_parse(a){const{ctx:s}=this._processInputParams(a);if(s.parsedType!==Ze.promise&&s.common.async===!1)return Ye(s,{code:Be.invalid_type,expected:Ze.promise,received:s.parsedType}),ft;const i=s.parsedType===Ze.promise?s.data:Promise.resolve(s.data);return er(i.then(l=>this._def.type.parseAsync(l,{path:s.path,errorMap:s.common.contextualErrorMap})))}}so.create=(n,a)=>new so({type:n,typeName:ut.ZodPromise,...yt(a)});class aa extends _t{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===ut.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(a){const{status:s,ctx:i}=this._processInputParams(a),l=this._def.effect||null,c={addIssue:d=>{Ye(i,d),d.fatal?s.abort():s.dirty()},get path(){return i.path}};if(c.addIssue=c.addIssue.bind(c),l.type==="preprocess"){const d=l.transform(i.data,c);if(i.common.async)return Promise.resolve(d).then(async m=>{if(s.value==="aborted")return ft;const p=await this._def.schema._parseAsync({data:m,path:i.path,parent:i});return p.status==="aborted"?ft:p.status==="dirty"||s.value==="dirty"?Ji(p.value):p});{if(s.value==="aborted")return ft;const m=this._def.schema._parseSync({data:d,path:i.path,parent:i});return m.status==="aborted"?ft:m.status==="dirty"||s.value==="dirty"?Ji(m.value):m}}if(l.type==="refinement"){const d=m=>{const p=l.refinement(m,c);if(i.common.async)return Promise.resolve(p);if(p instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return m};if(i.common.async===!1){const m=this._def.schema._parseSync({data:i.data,path:i.path,parent:i});return m.status==="aborted"?ft:(m.status==="dirty"&&s.dirty(),d(m.value),{status:s.value,value:m.value})}else return this._def.schema._parseAsync({data:i.data,path:i.path,parent:i}).then(m=>m.status==="aborted"?ft:(m.status==="dirty"&&s.dirty(),d(m.value).then(()=>({status:s.value,value:m.value}))))}if(l.type==="transform")if(i.common.async===!1){const d=this._def.schema._parseSync({data:i.data,path:i.path,parent:i});if(!pl(d))return d;const m=l.transform(d.value,c);if(m instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:s.value,value:m}}else return this._def.schema._parseAsync({data:i.data,path:i.path,parent:i}).then(d=>pl(d)?Promise.resolve(l.transform(d.value,c)).then(m=>({status:s.value,value:m})):d);jt.assertNever(l)}}aa.create=(n,a,s)=>new aa({schema:n,typeName:ut.ZodEffects,effect:a,...yt(s)});aa.createWithPreprocess=(n,a,s)=>new aa({schema:a,effect:{type:"preprocess",transform:n},typeName:ut.ZodEffects,...yt(s)});class ma extends _t{_parse(a){return this._getType(a)===Ze.undefined?er(void 0):this._def.innerType._parse(a)}unwrap(){return this._def.innerType}}ma.create=(n,a)=>new ma({innerType:n,typeName:ut.ZodOptional,...yt(a)});class js extends _t{_parse(a){return this._getType(a)===Ze.null?er(null):this._def.innerType._parse(a)}unwrap(){return this._def.innerType}}js.create=(n,a)=>new js({innerType:n,typeName:ut.ZodNullable,...yt(a)});class Tl extends _t{_parse(a){const{ctx:s}=this._processInputParams(a);let i=s.data;return s.parsedType===Ze.undefined&&(i=this._def.defaultValue()),this._def.innerType._parse({data:i,path:s.path,parent:s})}removeDefault(){return this._def.innerType}}Tl.create=(n,a)=>new Tl({innerType:n,typeName:ut.ZodDefault,defaultValue:typeof a.default=="function"?a.default:()=>a.default,...yt(a)});class Al extends _t{_parse(a){const{ctx:s}=this._processInputParams(a),i={...s,common:{...s.common,issues:[]}},l=this._def.innerType._parse({data:i.data,path:i.path,parent:{...i}});return gl(l)?l.then(c=>({status:"valid",value:c.status==="valid"?c.value:this._def.catchValue({get error(){return new Er(i.common.issues)},input:i.data})})):{status:"valid",value:l.status==="valid"?l.value:this._def.catchValue({get error(){return new Er(i.common.issues)},input:i.data})}}removeCatch(){return this._def.innerType}}Al.create=(n,a)=>new Al({innerType:n,typeName:ut.ZodCatch,catchValue:typeof a.catch=="function"?a.catch:()=>a.catch,...yt(a)});class yu extends _t{_parse(a){if(this._getType(a)!==Ze.nan){const i=this._getOrReturnCtx(a);return Ye(i,{code:Be.invalid_type,expected:Ze.nan,received:i.parsedType}),ft}return{status:"valid",value:a.data}}}yu.create=n=>new yu({typeName:ut.ZodNaN,...yt(n)});const OS=Symbol("zod_brand");class Fh extends _t{_parse(a){const{ctx:s}=this._processInputParams(a),i=s.data;return this._def.type._parse({data:i,path:s.path,parent:s})}unwrap(){return this._def.type}}class Ol extends _t{_parse(a){const{status:s,ctx:i}=this._processInputParams(a);if(i.common.async)return(async()=>{const c=await this._def.in._parseAsync({data:i.data,path:i.path,parent:i});return c.status==="aborted"?ft:c.status==="dirty"?(s.dirty(),Ji(c.value)):this._def.out._parseAsync({data:c.value,path:i.path,parent:i})})();{const l=this._def.in._parseSync({data:i.data,path:i.path,parent:i});return l.status==="aborted"?ft:l.status==="dirty"?(s.dirty(),{status:"dirty",value:l.value}):this._def.out._parseSync({data:l.value,path:i.path,parent:i})}}static create(a,s){return new Ol({in:a,out:s,typeName:ut.ZodPipeline})}}class Nl extends _t{_parse(a){const s=this._def.innerType._parse(a),i=l=>(pl(l)&&(l.value=Object.freeze(l.value)),l);return gl(s)?s.then(l=>i(l)):i(s)}unwrap(){return this._def.innerType}}Nl.create=(n,a)=>new Nl({innerType:n,typeName:ut.ZodReadonly,...yt(a)});function wb(n,a={},s){return n?ao.create().superRefine((i,l)=>{var c,d;if(!n(i)){const m=typeof a=="function"?a(i):typeof a=="string"?{message:a}:a,p=(d=(c=m.fatal)!==null&&c!==void 0?c:s)!==null&&d!==void 0?d:!0,h=typeof m=="string"?{message:m}:m;l.addIssue({code:"custom",...h,fatal:p})}}):ao.create()}const jS={object:dn.lazycreate};var ut;(function(n){n.ZodString="ZodString",n.ZodNumber="ZodNumber",n.ZodNaN="ZodNaN",n.ZodBigInt="ZodBigInt",n.ZodBoolean="ZodBoolean",n.ZodDate="ZodDate",n.ZodSymbol="ZodSymbol",n.ZodUndefined="ZodUndefined",n.ZodNull="ZodNull",n.ZodAny="ZodAny",n.ZodUnknown="ZodUnknown",n.ZodNever="ZodNever",n.ZodVoid="ZodVoid",n.ZodArray="ZodArray",n.ZodObject="ZodObject",n.ZodUnion="ZodUnion",n.ZodDiscriminatedUnion="ZodDiscriminatedUnion",n.ZodIntersection="ZodIntersection",n.ZodTuple="ZodTuple",n.ZodRecord="ZodRecord",n.ZodMap="ZodMap",n.ZodSet="ZodSet",n.ZodFunction="ZodFunction",n.ZodLazy="ZodLazy",n.ZodLiteral="ZodLiteral",n.ZodEnum="ZodEnum",n.ZodEffects="ZodEffects",n.ZodNativeEnum="ZodNativeEnum",n.ZodOptional="ZodOptional",n.ZodNullable="ZodNullable",n.ZodDefault="ZodDefault",n.ZodCatch="ZodCatch",n.ZodPromise="ZodPromise",n.ZodBranded="ZodBranded",n.ZodPipeline="ZodPipeline",n.ZodReadonly="ZodReadonly"})(ut||(ut={}));const IS=(n,a={message:`Input not instance of ${n.name}`})=>wb(s=>s instanceof n,a),Eb=ta.create,kb=Ds.create,RS=yu.create,MS=Cs.create,Tb=yl.create,US=ai.create,LS=mu.create,zS=vl.create,FS=bl.create,BS=ao.create,HS=ri.create,GS=qa.create,qS=pu.create,PS=na.create,YS=dn.create,$S=dn.strictCreate,VS=xl.create,ZS=wu.create,QS=_l.create,KS=ga.create,JS=Sl.create,XS=gu.create,WS=si.create,e1=eo.create,t1=wl.create,n1=El.create,r1=Os.create,a1=kl.create,s1=so.create,My=aa.create,i1=ma.create,o1=js.create,l1=aa.createWithPreprocess,c1=Ol.create,u1=()=>Eb().optional(),d1=()=>kb().optional(),f1=()=>Tb().optional(),h1={string:(n=>ta.create({...n,coerce:!0})),number:(n=>Ds.create({...n,coerce:!0})),boolean:(n=>yl.create({...n,coerce:!0})),bigint:(n=>Cs.create({...n,coerce:!0})),date:(n=>ai.create({...n,coerce:!0}))},m1=ft;var ge=Object.freeze({__proto__:null,defaultErrorMap:ro,setErrorMap:mS,getErrorMap:du,makeIssue:fu,EMPTY_PATH:pS,addIssueToContext:Ye,ParseStatus:Zn,INVALID:ft,DIRTY:Ji,OK:er,isAborted:kh,isDirty:Th,isValid:pl,isAsync:gl,get util(){return jt},get objectUtil(){return Eh},ZodParsedType:Ze,getParsedType:As,ZodType:_t,datetimeRegex:_b,ZodString:ta,ZodNumber:Ds,ZodBigInt:Cs,ZodBoolean:yl,ZodDate:ai,ZodSymbol:mu,ZodUndefined:vl,ZodNull:bl,ZodAny:ao,ZodUnknown:ri,ZodNever:qa,ZodVoid:pu,ZodArray:na,ZodObject:dn,ZodUnion:xl,ZodDiscriminatedUnion:wu,ZodIntersection:_l,ZodTuple:ga,ZodRecord:Sl,ZodMap:gu,ZodSet:si,ZodFunction:eo,ZodLazy:wl,ZodLiteral:El,ZodEnum:Os,ZodNativeEnum:kl,ZodPromise:so,ZodEffects:aa,ZodTransformer:aa,ZodOptional:ma,ZodNullable:js,ZodDefault:Tl,ZodCatch:Al,ZodNaN:yu,BRAND:OS,ZodBranded:Fh,ZodPipeline:Ol,ZodReadonly:Nl,custom:wb,Schema:_t,ZodSchema:_t,late:jS,get ZodFirstPartyTypeKind(){return ut},coerce:h1,any:BS,array:PS,bigint:MS,boolean:Tb,date:US,discriminatedUnion:ZS,effect:My,enum:r1,function:e1,instanceof:IS,intersection:QS,lazy:t1,literal:n1,map:XS,nan:RS,nativeEnum:a1,never:GS,null:FS,nullable:o1,number:kb,object:YS,oboolean:f1,onumber:d1,optional:i1,ostring:u1,pipeline:c1,preprocess:l1,promise:s1,record:JS,set:WS,strictObject:$S,string:Eb,symbol:LS,transformer:My,tuple:KS,undefined:zS,union:VS,unknown:HS,void:qS,NEVER:m1,ZodIssueCode:Be,quotelessJson:hS,ZodError:Er});const Ab=ge.object({id:ge.union([ge.string(),ge.number()]).nullable().optional().transform(n=>n?String(n):crypto.randomUUID()),text:ge.preprocess(n=>n??"",ge.string()),explanation:ge.string().nullable().optional().transform(n=>n??"")}),Nb=ge.object({front:ge.preprocess(n=>n??"",ge.string()),back:ge.preprocess(n=>n??"",ge.string())}),Db=ge.object({id:ge.string().optional(),questionType:ge.preprocess(n=>n??"multipleChoice",ge.string()),questionText:ge.preprocess(n=>n??"",ge.string()),options:ge.preprocess(n=>Array.isArray(n)?n:[],ge.array(Ab)),correctAnswerId:ge.preprocess(n=>n?String(n):"",ge.string()),detailedExplanation:ge.string().nullable().optional().transform(n=>n??""),tags:ge.array(ge.string()).optional()}),Bh=ge.object({id:ge.coerce.string(),content:ge.string().nullable().optional().transform(n=>n??""),unlocksQuestionIds:ge.array(ge.string()).nullable().optional().transform(n=>n??[])}),p1=ge.object({name:ge.string(),description:ge.preprocess(n=>n??"",ge.string()),questions:ge.array(ge.any()),type:ge.string().optional(),infoCards:ge.array(ge.any()).optional(),learningMode:ge.string().optional()}),Cb=ge.object({id:ge.coerce.string(),dueDate:ge.string().nullable().optional().transform(n=>n??new Date().toISOString()),interval:ge.number().nullable().optional().transform(n=>n??0),easeFactor:ge.number().nullable().optional().transform(n=>n??wr),suspended:ge.boolean().nullable().optional().transform(n=>n??!1),masteryLevel:ge.number().nullable().optional().transform(n=>n??0),lastReviewed:ge.string().nullable().optional(),lapses:ge.number().nullable().optional().transform(n=>n??0)}),Ob=Cb.extend({front:ge.string().nullable().optional().transform(n=>n??""),back:ge.string().nullable().optional().transform(n=>n??""),css:ge.string().nullable().optional(),frontAudio:ge.string().nullable().optional(),backAudio:ge.string().nullable().optional(),tags:ge.array(ge.string()).nullable().optional().transform(n=>n??[])}),Hh=Cb.extend({questionType:ge.literal("multipleChoice"),questionText:ge.string().nullable().optional().transform(n=>n??""),options:ge.array(Ab).nullable().optional().transform(n=>n??[]),correctAnswerId:ge.string().nullable().optional().transform(n=>n??""),detailedExplanation:ge.string().nullable().optional().transform(n=>n??""),tags:ge.array(ge.string()).nullable().optional().transform(n=>n??[]),infoCardIds:ge.array(ge.string()).nullable().optional().transform(n=>n??[]),userSelectedAnswerId:ge.string().optional()}),Gh=ge.object({id:ge.coerce.string(),name:ge.coerce.string(),description:ge.string().nullable().optional().transform(n=>n??""),folderId:ge.string().nullable().optional(),lastOpened:ge.string().nullable().optional(),archived:ge.boolean().nullable().optional(),deletedAt:ge.string().nullable().optional(),lastModified:ge.number().nullable().optional(),locked:ge.boolean().nullable().optional(),icon:ge.string().nullable().optional(),aiGenerationParams:ge.any().optional(),suggestedQuestionCount:ge.number().nullable().optional()}),g1=Gh.extend({type:ge.literal(Ne.Flashcard),cards:ge.array(Ob).nullable().optional().transform(n=>n??[])}),y1=Gh.extend({type:ge.literal(Ne.Quiz),questions:ge.array(Hh).nullable().optional().transform(n=>n??[])}),v1=Gh.extend({type:ge.literal(Ne.Learning),infoCards:ge.array(Bh).nullable().optional().transform(n=>n??[]),questions:ge.array(Hh).nullable().optional().transform(n=>n??[]),learningMode:ge.enum(["mixed","separate"]).optional().transform(n=>n??"separate")}),b1=n=>{if(typeof n!="object"||n===null)return{id:crypto.randomUUID(),name:"Corrupted Deck Entry",type:Ne.Flashcard,cards:[],description:"This deck entry was corrupted in the source file."};const a={...n};a.id||(a.id=crypto.randomUUID()),a.id=String(a.id),(a.name===null||a.name===void 0)&&(a.name="Untitled Deck"),a.name=String(a.name),a.type&&typeof a.type=="string"&&(a.type=a.type.toLowerCase());const s=Object.values(Ne).map(l=>l.toString());(!a.type||!s.includes(a.type))&&(Array.isArray(a.infoCards)&&a.infoCards.length>0?a.type=Ne.Learning:Array.isArray(a.questions)&&a.questions.length>0?a.type=Ne.Quiz:a.type=Ne.Flashcard),(a.description===null||a.description===void 0)&&(a.description="");const i=l=>!l||typeof l!="object"?null:(l.id||(l.id=crypto.randomUUID()),l.id=String(l.id),a.type===Ne.Flashcard&&((l.front===null||l.front===void 0)&&(l.front=""),(l.back===null||l.back===void 0)&&(l.back="")),l);return Array.isArray(a.cards)?a.cards=a.cards.map(i).filter(l=>l!==null):a.cards=[],Array.isArray(a.questions)?a.questions=a.questions.map(l=>{const c=i(l);return c?(c.questionType||(c.questionType="multipleChoice"),c):null}).filter(l=>l!==null):a.questions=[],Array.isArray(a.infoCards)?a.infoCards=a.infoCards.map(i).filter(l=>l!==null):a.infoCards=[],a},x1=ge.preprocess(b1,ge.union([g1,y1,v1])),_1=ge.object({id:ge.coerce.string(),name:ge.coerce.string()}),S1=ge.object({title:ge.string().nullable().optional().transform(n=>n??"Untitled Level"),deckIds:ge.array(ge.coerce.string()).nullable().optional().transform(n=>n??[])}),w1=ge.object({id:ge.coerce.string(),type:ge.literal("series"),name:ge.string(),description:ge.string().nullable().optional().transform(n=>n??""),levels:ge.array(S1).nullable().optional().transform(n=>n??[]),createdAt:ge.string().nullable().optional().transform(n=>n??new Date().toISOString()),lastOpened:ge.string().nullable().optional(),archived:ge.boolean().nullable().optional(),deletedAt:ge.string().nullable().optional(),lastModified:ge.number().nullable().optional(),aiGenerationParams:ge.any().optional(),aiChatHistory:ge.array(ge.any()).optional()}),E1=ge.object({id:ge.union([ge.string(),ge.number()]).optional(),itemId:ge.coerce.string(),deckId:ge.coerce.string(),seriesId:ge.string().optional(),timestamp:ge.string(),rating:ge.nativeEnum(Sr).nullable().optional(),newInterval:ge.number(),easeFactor:ge.number(),masteryLevel:ge.number().nullable().optional().transform(n=>n??0)}),k1=ge.object({id:ge.string(),reviewQueue:ge.array(ge.any()).transform(n=>Array.isArray(n)?n.map(a=>{if(!a||typeof a!="object")return null;if("questionType"in a){const i=Hh.safeParse(a);return i.success?i.data:null}if("content"in a||"unlocksQuestionIds"in a){const i=Bh.safeParse(a);return i.success?i.data:null}const s=Ob.safeParse(a);return s.success?s.data:null}).filter(a=>a!==null):[]),currentIndex:ge.number(),itemsCompleted:ge.number().nullable().optional().transform(n=>n??0),readInfoCardIds:ge.array(ge.string()).optional(),unlockedQuestionIds:ge.array(ge.string()).optional()}),T1=ge.object({id:ge.string(),role:ge.enum(["user","model"]),text:ge.string(),actions:ge.array(ge.any()).optional(),isLoading:ge.boolean().optional()}),A1=ge.object({deckId:ge.string(),readInfoCardIds:ge.array(ge.string()).nullable().optional().transform(n=>n??[]),unlockedQuestionIds:ge.array(ge.string()).nullable().optional().transform(n=>n??[]),lastReadCardId:ge.string().optional()}),N1=ge.object({version:ge.number(),decks:ge.array(x1),folders:ge.array(_1).nullable().optional().transform(n=>n??[]),deckSeries:ge.array(w1).nullable().optional().transform(n=>n??[]),reviews:ge.array(E1).nullable().optional().transform(n=>n??[]),sessions:ge.array(k1).nullable().optional().transform(n=>n??[]),seriesProgress:ge.record(ge.string(),ge.array(ge.string())).nullable().optional().transform(n=>n??{}),learningProgress:ge.record(ge.string(),A1).nullable().optional().transform(n=>n??{}),aiChatHistory:ge.array(T1).nullable().optional().transform(n=>n??[]),aiOptions:ge.any().optional(),settings:ge.any().optional()}),D1=ge.object({title:ge.string().nullable().optional().transform(n=>n??"Untitled Level"),decks:ge.array(ge.any())}),C1=ge.object({seriesName:ge.string(),seriesDescription:ge.preprocess(n=>n??"",ge.string()),levels:ge.array(D1)});function $c(n){throw new Error('Could not dynamically require "'+n+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var th={exports:{}};/*!

JSZip v3.10.1 - A JavaScript class for generating and reading zip files
<http://stuartk.com/jszip>

(c) 2009-2016 Stuart Knightley <stuart [at] stuartk.com>
Dual licenced under the MIT license or GPLv3. See https://raw.github.com/Stuk/jszip/main/LICENSE.markdown.

JSZip uses the library pako released under the MIT license :
https://github.com/nodeca/pako/blob/main/LICENSE
*/var Uy;function O1(){return Uy||(Uy=1,(function(n,a){(function(s){n.exports=s()})(function(){return(function s(i,l,c){function d(h,v){if(!l[h]){if(!i[h]){var S=typeof $c=="function"&&$c;if(!v&&S)return S(h,!0);if(m)return m(h,!0);var A=new Error("Cannot find module '"+h+"'");throw A.code="MODULE_NOT_FOUND",A}var _=l[h]={exports:{}};i[h][0].call(_.exports,function(E){var w=i[h][1][E];return d(w||E)},_,_.exports,s,i,l,c)}return l[h].exports}for(var m=typeof $c=="function"&&$c,p=0;p<c.length;p++)d(c[p]);return d})({1:[function(s,i,l){var c=s("./utils"),d=s("./support"),m="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";l.encode=function(p){for(var h,v,S,A,_,E,w,k=[],N=0,I=p.length,M=I,F=c.getTypeOf(p)!=="string";N<p.length;)M=I-N,S=F?(h=p[N++],v=N<I?p[N++]:0,N<I?p[N++]:0):(h=p.charCodeAt(N++),v=N<I?p.charCodeAt(N++):0,N<I?p.charCodeAt(N++):0),A=h>>2,_=(3&h)<<4|v>>4,E=1<M?(15&v)<<2|S>>6:64,w=2<M?63&S:64,k.push(m.charAt(A)+m.charAt(_)+m.charAt(E)+m.charAt(w));return k.join("")},l.decode=function(p){var h,v,S,A,_,E,w=0,k=0,N="data:";if(p.substr(0,N.length)===N)throw new Error("Invalid base64 input, it looks like a data url.");var I,M=3*(p=p.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(p.charAt(p.length-1)===m.charAt(64)&&M--,p.charAt(p.length-2)===m.charAt(64)&&M--,M%1!=0)throw new Error("Invalid base64 input, bad content length.");for(I=d.uint8array?new Uint8Array(0|M):new Array(0|M);w<p.length;)h=m.indexOf(p.charAt(w++))<<2|(A=m.indexOf(p.charAt(w++)))>>4,v=(15&A)<<4|(_=m.indexOf(p.charAt(w++)))>>2,S=(3&_)<<6|(E=m.indexOf(p.charAt(w++))),I[k++]=h,_!==64&&(I[k++]=v),E!==64&&(I[k++]=S);return I}},{"./support":30,"./utils":32}],2:[function(s,i,l){var c=s("./external"),d=s("./stream/DataWorker"),m=s("./stream/Crc32Probe"),p=s("./stream/DataLengthProbe");function h(v,S,A,_,E){this.compressedSize=v,this.uncompressedSize=S,this.crc32=A,this.compression=_,this.compressedContent=E}h.prototype={getContentWorker:function(){var v=new d(c.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new p("data_length")),S=this;return v.on("end",function(){if(this.streamInfo.data_length!==S.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),v},getCompressedWorker:function(){return new d(c.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},h.createWorkerFrom=function(v,S,A){return v.pipe(new m).pipe(new p("uncompressedSize")).pipe(S.compressWorker(A)).pipe(new p("compressedSize")).withStreamInfo("compression",S)},i.exports=h},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(s,i,l){var c=s("./stream/GenericWorker");l.STORE={magic:"\0\0",compressWorker:function(){return new c("STORE compression")},uncompressWorker:function(){return new c("STORE decompression")}},l.DEFLATE=s("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(s,i,l){var c=s("./utils"),d=(function(){for(var m,p=[],h=0;h<256;h++){m=h;for(var v=0;v<8;v++)m=1&m?3988292384^m>>>1:m>>>1;p[h]=m}return p})();i.exports=function(m,p){return m!==void 0&&m.length?c.getTypeOf(m)!=="string"?(function(h,v,S,A){var _=d,E=A+S;h^=-1;for(var w=A;w<E;w++)h=h>>>8^_[255&(h^v[w])];return-1^h})(0|p,m,m.length,0):(function(h,v,S,A){var _=d,E=A+S;h^=-1;for(var w=A;w<E;w++)h=h>>>8^_[255&(h^v.charCodeAt(w))];return-1^h})(0|p,m,m.length,0):0}},{"./utils":32}],5:[function(s,i,l){l.base64=!1,l.binary=!1,l.dir=!1,l.createFolders=!0,l.date=null,l.compression=null,l.compressionOptions=null,l.comment=null,l.unixPermissions=null,l.dosPermissions=null},{}],6:[function(s,i,l){var c=null;c=typeof Promise<"u"?Promise:s("lie"),i.exports={Promise:c}},{lie:37}],7:[function(s,i,l){var c=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Uint32Array<"u",d=s("pako"),m=s("./utils"),p=s("./stream/GenericWorker"),h=c?"uint8array":"array";function v(S,A){p.call(this,"FlateWorker/"+S),this._pako=null,this._pakoAction=S,this._pakoOptions=A,this.meta={}}l.magic="\b\0",m.inherits(v,p),v.prototype.processChunk=function(S){this.meta=S.meta,this._pako===null&&this._createPako(),this._pako.push(m.transformTo(h,S.data),!1)},v.prototype.flush=function(){p.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)},v.prototype.cleanUp=function(){p.prototype.cleanUp.call(this),this._pako=null},v.prototype._createPako=function(){this._pako=new d[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var S=this;this._pako.onData=function(A){S.push({data:A,meta:S.meta})}},l.compressWorker=function(S){return new v("Deflate",S)},l.uncompressWorker=function(){return new v("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(s,i,l){function c(_,E){var w,k="";for(w=0;w<E;w++)k+=String.fromCharCode(255&_),_>>>=8;return k}function d(_,E,w,k,N,I){var M,F,q=_.file,Q=_.compression,U=I!==h.utf8encode,j=m.transformTo("string",I(q.name)),O=m.transformTo("string",h.utf8encode(q.name)),B=q.comment,te=m.transformTo("string",I(B)),L=m.transformTo("string",h.utf8encode(B)),J=O.length!==q.name.length,D=L.length!==B.length,ie="",Z="",Y="",me=q.dir,W=q.date,be={crc32:0,compressedSize:0,uncompressedSize:0};E&&!w||(be.crc32=_.crc32,be.compressedSize=_.compressedSize,be.uncompressedSize=_.uncompressedSize);var z=0;E&&(z|=8),U||!J&&!D||(z|=2048);var R=0,re=0;me&&(R|=16),N==="UNIX"?(re=798,R|=(function(he,fe){var Me=he;return he||(Me=fe?16893:33204),(65535&Me)<<16})(q.unixPermissions,me)):(re=20,R|=(function(he){return 63&(he||0)})(q.dosPermissions)),M=W.getUTCHours(),M<<=6,M|=W.getUTCMinutes(),M<<=5,M|=W.getUTCSeconds()/2,F=W.getUTCFullYear()-1980,F<<=4,F|=W.getUTCMonth()+1,F<<=5,F|=W.getUTCDate(),J&&(Z=c(1,1)+c(v(j),4)+O,ie+="up"+c(Z.length,2)+Z),D&&(Y=c(1,1)+c(v(te),4)+L,ie+="uc"+c(Y.length,2)+Y);var oe="";return oe+=`
\0`,oe+=c(z,2),oe+=Q.magic,oe+=c(M,2),oe+=c(F,2),oe+=c(be.crc32,4),oe+=c(be.compressedSize,4),oe+=c(be.uncompressedSize,4),oe+=c(j.length,2),oe+=c(ie.length,2),{fileRecord:S.LOCAL_FILE_HEADER+oe+j+ie,dirRecord:S.CENTRAL_FILE_HEADER+c(re,2)+oe+c(te.length,2)+"\0\0\0\0"+c(R,4)+c(k,4)+j+ie+te}}var m=s("../utils"),p=s("../stream/GenericWorker"),h=s("../utf8"),v=s("../crc32"),S=s("../signature");function A(_,E,w,k){p.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=E,this.zipPlatform=w,this.encodeFileName=k,this.streamFiles=_,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}m.inherits(A,p),A.prototype.push=function(_){var E=_.meta.percent||0,w=this.entriesCount,k=this._sources.length;this.accumulate?this.contentBuffer.push(_):(this.bytesWritten+=_.data.length,p.prototype.push.call(this,{data:_.data,meta:{currentFile:this.currentFile,percent:w?(E+100*(w-k-1))/w:100}}))},A.prototype.openedSource=function(_){this.currentSourceOffset=this.bytesWritten,this.currentFile=_.file.name;var E=this.streamFiles&&!_.file.dir;if(E){var w=d(_,E,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:w.fileRecord,meta:{percent:0}})}else this.accumulate=!0},A.prototype.closedSource=function(_){this.accumulate=!1;var E=this.streamFiles&&!_.file.dir,w=d(_,E,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(w.dirRecord),E)this.push({data:(function(k){return S.DATA_DESCRIPTOR+c(k.crc32,4)+c(k.compressedSize,4)+c(k.uncompressedSize,4)})(_),meta:{percent:100}});else for(this.push({data:w.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},A.prototype.flush=function(){for(var _=this.bytesWritten,E=0;E<this.dirRecords.length;E++)this.push({data:this.dirRecords[E],meta:{percent:100}});var w=this.bytesWritten-_,k=(function(N,I,M,F,q){var Q=m.transformTo("string",q(F));return S.CENTRAL_DIRECTORY_END+"\0\0\0\0"+c(N,2)+c(N,2)+c(I,4)+c(M,4)+c(Q.length,2)+Q})(this.dirRecords.length,w,_,this.zipComment,this.encodeFileName);this.push({data:k,meta:{percent:100}})},A.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},A.prototype.registerPrevious=function(_){this._sources.push(_);var E=this;return _.on("data",function(w){E.processChunk(w)}),_.on("end",function(){E.closedSource(E.previous.streamInfo),E._sources.length?E.prepareNextSource():E.end()}),_.on("error",function(w){E.error(w)}),this},A.prototype.resume=function(){return!!p.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},A.prototype.error=function(_){var E=this._sources;if(!p.prototype.error.call(this,_))return!1;for(var w=0;w<E.length;w++)try{E[w].error(_)}catch{}return!0},A.prototype.lock=function(){p.prototype.lock.call(this);for(var _=this._sources,E=0;E<_.length;E++)_[E].lock()},i.exports=A},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(s,i,l){var c=s("../compressions"),d=s("./ZipFileWorker");l.generateWorker=function(m,p,h){var v=new d(p.streamFiles,h,p.platform,p.encodeFileName),S=0;try{m.forEach(function(A,_){S++;var E=(function(I,M){var F=I||M,q=c[F];if(!q)throw new Error(F+" is not a valid compression method !");return q})(_.options.compression,p.compression),w=_.options.compressionOptions||p.compressionOptions||{},k=_.dir,N=_.date;_._compressWorker(E,w).withStreamInfo("file",{name:A,dir:k,date:N,comment:_.comment||"",unixPermissions:_.unixPermissions,dosPermissions:_.dosPermissions}).pipe(v)}),v.entriesCount=S}catch(A){v.error(A)}return v}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(s,i,l){function c(){if(!(this instanceof c))return new c;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var d=new c;for(var m in this)typeof this[m]!="function"&&(d[m]=this[m]);return d}}(c.prototype=s("./object")).loadAsync=s("./load"),c.support=s("./support"),c.defaults=s("./defaults"),c.version="3.10.1",c.loadAsync=function(d,m){return new c().loadAsync(d,m)},c.external=s("./external"),i.exports=c},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(s,i,l){var c=s("./utils"),d=s("./external"),m=s("./utf8"),p=s("./zipEntries"),h=s("./stream/Crc32Probe"),v=s("./nodejsUtils");function S(A){return new d.Promise(function(_,E){var w=A.decompressed.getContentWorker().pipe(new h);w.on("error",function(k){E(k)}).on("end",function(){w.streamInfo.crc32!==A.decompressed.crc32?E(new Error("Corrupted zip : CRC32 mismatch")):_()}).resume()})}i.exports=function(A,_){var E=this;return _=c.extend(_||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:m.utf8decode}),v.isNode&&v.isStream(A)?d.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):c.prepareContent("the loaded zip file",A,!0,_.optimizedBinaryString,_.base64).then(function(w){var k=new p(_);return k.load(w),k}).then(function(w){var k=[d.Promise.resolve(w)],N=w.files;if(_.checkCRC32)for(var I=0;I<N.length;I++)k.push(S(N[I]));return d.Promise.all(k)}).then(function(w){for(var k=w.shift(),N=k.files,I=0;I<N.length;I++){var M=N[I],F=M.fileNameStr,q=c.resolve(M.fileNameStr);E.file(q,M.decompressed,{binary:!0,optimizedBinaryString:!0,date:M.date,dir:M.dir,comment:M.fileCommentStr.length?M.fileCommentStr:null,unixPermissions:M.unixPermissions,dosPermissions:M.dosPermissions,createFolders:_.createFolders}),M.dir||(E.file(q).unsafeOriginalName=F)}return k.zipComment.length&&(E.comment=k.zipComment),E})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(s,i,l){var c=s("../utils"),d=s("../stream/GenericWorker");function m(p,h){d.call(this,"Nodejs stream input adapter for "+p),this._upstreamEnded=!1,this._bindStream(h)}c.inherits(m,d),m.prototype._bindStream=function(p){var h=this;(this._stream=p).pause(),p.on("data",function(v){h.push({data:v,meta:{percent:0}})}).on("error",function(v){h.isPaused?this.generatedError=v:h.error(v)}).on("end",function(){h.isPaused?h._upstreamEnded=!0:h.end()})},m.prototype.pause=function(){return!!d.prototype.pause.call(this)&&(this._stream.pause(),!0)},m.prototype.resume=function(){return!!d.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},i.exports=m},{"../stream/GenericWorker":28,"../utils":32}],13:[function(s,i,l){var c=s("readable-stream").Readable;function d(m,p,h){c.call(this,p),this._helper=m;var v=this;m.on("data",function(S,A){v.push(S)||v._helper.pause(),h&&h(A)}).on("error",function(S){v.emit("error",S)}).on("end",function(){v.push(null)})}s("../utils").inherits(d,c),d.prototype._read=function(){this._helper.resume()},i.exports=d},{"../utils":32,"readable-stream":16}],14:[function(s,i,l){i.exports={isNode:typeof Buffer<"u",newBufferFrom:function(c,d){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(c,d);if(typeof c=="number")throw new Error('The "data" argument must not be a number');return new Buffer(c,d)},allocBuffer:function(c){if(Buffer.alloc)return Buffer.alloc(c);var d=new Buffer(c);return d.fill(0),d},isBuffer:function(c){return Buffer.isBuffer(c)},isStream:function(c){return c&&typeof c.on=="function"&&typeof c.pause=="function"&&typeof c.resume=="function"}}},{}],15:[function(s,i,l){function c(q,Q,U){var j,O=m.getTypeOf(Q),B=m.extend(U||{},v);B.date=B.date||new Date,B.compression!==null&&(B.compression=B.compression.toUpperCase()),typeof B.unixPermissions=="string"&&(B.unixPermissions=parseInt(B.unixPermissions,8)),B.unixPermissions&&16384&B.unixPermissions&&(B.dir=!0),B.dosPermissions&&16&B.dosPermissions&&(B.dir=!0),B.dir&&(q=N(q)),B.createFolders&&(j=k(q))&&I.call(this,j,!0);var te=O==="string"&&B.binary===!1&&B.base64===!1;U&&U.binary!==void 0||(B.binary=!te),(Q instanceof S&&Q.uncompressedSize===0||B.dir||!Q||Q.length===0)&&(B.base64=!1,B.binary=!0,Q="",B.compression="STORE",O="string");var L=null;L=Q instanceof S||Q instanceof p?Q:E.isNode&&E.isStream(Q)?new w(q,Q):m.prepareContent(q,Q,B.binary,B.optimizedBinaryString,B.base64);var J=new A(q,L,B);this.files[q]=J}var d=s("./utf8"),m=s("./utils"),p=s("./stream/GenericWorker"),h=s("./stream/StreamHelper"),v=s("./defaults"),S=s("./compressedObject"),A=s("./zipObject"),_=s("./generate"),E=s("./nodejsUtils"),w=s("./nodejs/NodejsStreamInputAdapter"),k=function(q){q.slice(-1)==="/"&&(q=q.substring(0,q.length-1));var Q=q.lastIndexOf("/");return 0<Q?q.substring(0,Q):""},N=function(q){return q.slice(-1)!=="/"&&(q+="/"),q},I=function(q,Q){return Q=Q!==void 0?Q:v.createFolders,q=N(q),this.files[q]||c.call(this,q,null,{dir:!0,createFolders:Q}),this.files[q]};function M(q){return Object.prototype.toString.call(q)==="[object RegExp]"}var F={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(q){var Q,U,j;for(Q in this.files)j=this.files[Q],(U=Q.slice(this.root.length,Q.length))&&Q.slice(0,this.root.length)===this.root&&q(U,j)},filter:function(q){var Q=[];return this.forEach(function(U,j){q(U,j)&&Q.push(j)}),Q},file:function(q,Q,U){if(arguments.length!==1)return q=this.root+q,c.call(this,q,Q,U),this;if(M(q)){var j=q;return this.filter(function(B,te){return!te.dir&&j.test(B)})}var O=this.files[this.root+q];return O&&!O.dir?O:null},folder:function(q){if(!q)return this;if(M(q))return this.filter(function(O,B){return B.dir&&q.test(O)});var Q=this.root+q,U=I.call(this,Q),j=this.clone();return j.root=U.name,j},remove:function(q){q=this.root+q;var Q=this.files[q];if(Q||(q.slice(-1)!=="/"&&(q+="/"),Q=this.files[q]),Q&&!Q.dir)delete this.files[q];else for(var U=this.filter(function(O,B){return B.name.slice(0,q.length)===q}),j=0;j<U.length;j++)delete this.files[U[j].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(q){var Q,U={};try{if((U=m.extend(q||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:d.utf8encode})).type=U.type.toLowerCase(),U.compression=U.compression.toUpperCase(),U.type==="binarystring"&&(U.type="string"),!U.type)throw new Error("No output type specified.");m.checkSupport(U.type),U.platform!=="darwin"&&U.platform!=="freebsd"&&U.platform!=="linux"&&U.platform!=="sunos"||(U.platform="UNIX"),U.platform==="win32"&&(U.platform="DOS");var j=U.comment||this.comment||"";Q=_.generateWorker(this,U,j)}catch(O){(Q=new p("error")).error(O)}return new h(Q,U.type||"string",U.mimeType)},generateAsync:function(q,Q){return this.generateInternalStream(q).accumulate(Q)},generateNodeStream:function(q,Q){return(q=q||{}).type||(q.type="nodebuffer"),this.generateInternalStream(q).toNodejsStream(Q)}};i.exports=F},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(s,i,l){i.exports=s("stream")},{stream:void 0}],17:[function(s,i,l){var c=s("./DataReader");function d(m){c.call(this,m);for(var p=0;p<this.data.length;p++)m[p]=255&m[p]}s("../utils").inherits(d,c),d.prototype.byteAt=function(m){return this.data[this.zero+m]},d.prototype.lastIndexOfSignature=function(m){for(var p=m.charCodeAt(0),h=m.charCodeAt(1),v=m.charCodeAt(2),S=m.charCodeAt(3),A=this.length-4;0<=A;--A)if(this.data[A]===p&&this.data[A+1]===h&&this.data[A+2]===v&&this.data[A+3]===S)return A-this.zero;return-1},d.prototype.readAndCheckSignature=function(m){var p=m.charCodeAt(0),h=m.charCodeAt(1),v=m.charCodeAt(2),S=m.charCodeAt(3),A=this.readData(4);return p===A[0]&&h===A[1]&&v===A[2]&&S===A[3]},d.prototype.readData=function(m){if(this.checkOffset(m),m===0)return[];var p=this.data.slice(this.zero+this.index,this.zero+this.index+m);return this.index+=m,p},i.exports=d},{"../utils":32,"./DataReader":18}],18:[function(s,i,l){var c=s("../utils");function d(m){this.data=m,this.length=m.length,this.index=0,this.zero=0}d.prototype={checkOffset:function(m){this.checkIndex(this.index+m)},checkIndex:function(m){if(this.length<this.zero+m||m<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+m+"). Corrupted zip ?")},setIndex:function(m){this.checkIndex(m),this.index=m},skip:function(m){this.setIndex(this.index+m)},byteAt:function(){},readInt:function(m){var p,h=0;for(this.checkOffset(m),p=this.index+m-1;p>=this.index;p--)h=(h<<8)+this.byteAt(p);return this.index+=m,h},readString:function(m){return c.transformTo("string",this.readData(m))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var m=this.readInt(4);return new Date(Date.UTC(1980+(m>>25&127),(m>>21&15)-1,m>>16&31,m>>11&31,m>>5&63,(31&m)<<1))}},i.exports=d},{"../utils":32}],19:[function(s,i,l){var c=s("./Uint8ArrayReader");function d(m){c.call(this,m)}s("../utils").inherits(d,c),d.prototype.readData=function(m){this.checkOffset(m);var p=this.data.slice(this.zero+this.index,this.zero+this.index+m);return this.index+=m,p},i.exports=d},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(s,i,l){var c=s("./DataReader");function d(m){c.call(this,m)}s("../utils").inherits(d,c),d.prototype.byteAt=function(m){return this.data.charCodeAt(this.zero+m)},d.prototype.lastIndexOfSignature=function(m){return this.data.lastIndexOf(m)-this.zero},d.prototype.readAndCheckSignature=function(m){return m===this.readData(4)},d.prototype.readData=function(m){this.checkOffset(m);var p=this.data.slice(this.zero+this.index,this.zero+this.index+m);return this.index+=m,p},i.exports=d},{"../utils":32,"./DataReader":18}],21:[function(s,i,l){var c=s("./ArrayReader");function d(m){c.call(this,m)}s("../utils").inherits(d,c),d.prototype.readData=function(m){if(this.checkOffset(m),m===0)return new Uint8Array(0);var p=this.data.subarray(this.zero+this.index,this.zero+this.index+m);return this.index+=m,p},i.exports=d},{"../utils":32,"./ArrayReader":17}],22:[function(s,i,l){var c=s("../utils"),d=s("../support"),m=s("./ArrayReader"),p=s("./StringReader"),h=s("./NodeBufferReader"),v=s("./Uint8ArrayReader");i.exports=function(S){var A=c.getTypeOf(S);return c.checkSupport(A),A!=="string"||d.uint8array?A==="nodebuffer"?new h(S):d.uint8array?new v(c.transformTo("uint8array",S)):new m(c.transformTo("array",S)):new p(S)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(s,i,l){l.LOCAL_FILE_HEADER="PK",l.CENTRAL_FILE_HEADER="PK",l.CENTRAL_DIRECTORY_END="PK",l.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07",l.ZIP64_CENTRAL_DIRECTORY_END="PK",l.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(s,i,l){var c=s("./GenericWorker"),d=s("../utils");function m(p){c.call(this,"ConvertWorker to "+p),this.destType=p}d.inherits(m,c),m.prototype.processChunk=function(p){this.push({data:d.transformTo(this.destType,p.data),meta:p.meta})},i.exports=m},{"../utils":32,"./GenericWorker":28}],25:[function(s,i,l){var c=s("./GenericWorker"),d=s("../crc32");function m(){c.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}s("../utils").inherits(m,c),m.prototype.processChunk=function(p){this.streamInfo.crc32=d(p.data,this.streamInfo.crc32||0),this.push(p)},i.exports=m},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(s,i,l){var c=s("../utils"),d=s("./GenericWorker");function m(p){d.call(this,"DataLengthProbe for "+p),this.propName=p,this.withStreamInfo(p,0)}c.inherits(m,d),m.prototype.processChunk=function(p){if(p){var h=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=h+p.data.length}d.prototype.processChunk.call(this,p)},i.exports=m},{"../utils":32,"./GenericWorker":28}],27:[function(s,i,l){var c=s("../utils"),d=s("./GenericWorker");function m(p){d.call(this,"DataWorker");var h=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,p.then(function(v){h.dataIsReady=!0,h.data=v,h.max=v&&v.length||0,h.type=c.getTypeOf(v),h.isPaused||h._tickAndRepeat()},function(v){h.error(v)})}c.inherits(m,d),m.prototype.cleanUp=function(){d.prototype.cleanUp.call(this),this.data=null},m.prototype.resume=function(){return!!d.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,c.delay(this._tickAndRepeat,[],this)),!0)},m.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(c.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},m.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var p=null,h=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":p=this.data.substring(this.index,h);break;case"uint8array":p=this.data.subarray(this.index,h);break;case"array":case"nodebuffer":p=this.data.slice(this.index,h)}return this.index=h,this.push({data:p,meta:{percent:this.max?this.index/this.max*100:0}})},i.exports=m},{"../utils":32,"./GenericWorker":28}],28:[function(s,i,l){function c(d){this.name=d||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}c.prototype={push:function(d){this.emit("data",d)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(d){this.emit("error",d)}return!0},error:function(d){return!this.isFinished&&(this.isPaused?this.generatedError=d:(this.isFinished=!0,this.emit("error",d),this.previous&&this.previous.error(d),this.cleanUp()),!0)},on:function(d,m){return this._listeners[d].push(m),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(d,m){if(this._listeners[d])for(var p=0;p<this._listeners[d].length;p++)this._listeners[d][p].call(this,m)},pipe:function(d){return d.registerPrevious(this)},registerPrevious:function(d){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=d.streamInfo,this.mergeStreamInfo(),this.previous=d;var m=this;return d.on("data",function(p){m.processChunk(p)}),d.on("end",function(){m.end()}),d.on("error",function(p){m.error(p)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var d=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),d=!0),this.previous&&this.previous.resume(),!d},flush:function(){},processChunk:function(d){this.push(d)},withStreamInfo:function(d,m){return this.extraStreamInfo[d]=m,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var d in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,d)&&(this.streamInfo[d]=this.extraStreamInfo[d])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var d="Worker "+this.name;return this.previous?this.previous+" -> "+d:d}},i.exports=c},{}],29:[function(s,i,l){var c=s("../utils"),d=s("./ConvertWorker"),m=s("./GenericWorker"),p=s("../base64"),h=s("../support"),v=s("../external"),S=null;if(h.nodestream)try{S=s("../nodejs/NodejsStreamOutputAdapter")}catch{}function A(E,w){return new v.Promise(function(k,N){var I=[],M=E._internalType,F=E._outputType,q=E._mimeType;E.on("data",function(Q,U){I.push(Q),w&&w(U)}).on("error",function(Q){I=[],N(Q)}).on("end",function(){try{var Q=(function(U,j,O){switch(U){case"blob":return c.newBlob(c.transformTo("arraybuffer",j),O);case"base64":return p.encode(j);default:return c.transformTo(U,j)}})(F,(function(U,j){var O,B=0,te=null,L=0;for(O=0;O<j.length;O++)L+=j[O].length;switch(U){case"string":return j.join("");case"array":return Array.prototype.concat.apply([],j);case"uint8array":for(te=new Uint8Array(L),O=0;O<j.length;O++)te.set(j[O],B),B+=j[O].length;return te;case"nodebuffer":return Buffer.concat(j);default:throw new Error("concat : unsupported type '"+U+"'")}})(M,I),q);k(Q)}catch(U){N(U)}I=[]}).resume()})}function _(E,w,k){var N=w;switch(w){case"blob":case"arraybuffer":N="uint8array";break;case"base64":N="string"}try{this._internalType=N,this._outputType=w,this._mimeType=k,c.checkSupport(N),this._worker=E.pipe(new d(N)),E.lock()}catch(I){this._worker=new m("error"),this._worker.error(I)}}_.prototype={accumulate:function(E){return A(this,E)},on:function(E,w){var k=this;return E==="data"?this._worker.on(E,function(N){w.call(k,N.data,N.meta)}):this._worker.on(E,function(){c.delay(w,arguments,k)}),this},resume:function(){return c.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(E){if(c.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new S(this,{objectMode:this._outputType!=="nodebuffer"},E)}},i.exports=_},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(s,i,l){if(l.base64=!0,l.array=!0,l.string=!0,l.arraybuffer=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u",l.nodebuffer=typeof Buffer<"u",l.uint8array=typeof Uint8Array<"u",typeof ArrayBuffer>"u")l.blob=!1;else{var c=new ArrayBuffer(0);try{l.blob=new Blob([c],{type:"application/zip"}).size===0}catch{try{var d=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);d.append(c),l.blob=d.getBlob("application/zip").size===0}catch{l.blob=!1}}}try{l.nodestream=!!s("readable-stream").Readable}catch{l.nodestream=!1}},{"readable-stream":16}],31:[function(s,i,l){for(var c=s("./utils"),d=s("./support"),m=s("./nodejsUtils"),p=s("./stream/GenericWorker"),h=new Array(256),v=0;v<256;v++)h[v]=252<=v?6:248<=v?5:240<=v?4:224<=v?3:192<=v?2:1;h[254]=h[254]=1;function S(){p.call(this,"utf-8 decode"),this.leftOver=null}function A(){p.call(this,"utf-8 encode")}l.utf8encode=function(_){return d.nodebuffer?m.newBufferFrom(_,"utf-8"):(function(E){var w,k,N,I,M,F=E.length,q=0;for(I=0;I<F;I++)(64512&(k=E.charCodeAt(I)))==55296&&I+1<F&&(64512&(N=E.charCodeAt(I+1)))==56320&&(k=65536+(k-55296<<10)+(N-56320),I++),q+=k<128?1:k<2048?2:k<65536?3:4;for(w=d.uint8array?new Uint8Array(q):new Array(q),I=M=0;M<q;I++)(64512&(k=E.charCodeAt(I)))==55296&&I+1<F&&(64512&(N=E.charCodeAt(I+1)))==56320&&(k=65536+(k-55296<<10)+(N-56320),I++),k<128?w[M++]=k:(k<2048?w[M++]=192|k>>>6:(k<65536?w[M++]=224|k>>>12:(w[M++]=240|k>>>18,w[M++]=128|k>>>12&63),w[M++]=128|k>>>6&63),w[M++]=128|63&k);return w})(_)},l.utf8decode=function(_){return d.nodebuffer?c.transformTo("nodebuffer",_).toString("utf-8"):(function(E){var w,k,N,I,M=E.length,F=new Array(2*M);for(w=k=0;w<M;)if((N=E[w++])<128)F[k++]=N;else if(4<(I=h[N]))F[k++]=65533,w+=I-1;else{for(N&=I===2?31:I===3?15:7;1<I&&w<M;)N=N<<6|63&E[w++],I--;1<I?F[k++]=65533:N<65536?F[k++]=N:(N-=65536,F[k++]=55296|N>>10&1023,F[k++]=56320|1023&N)}return F.length!==k&&(F.subarray?F=F.subarray(0,k):F.length=k),c.applyFromCharCode(F)})(_=c.transformTo(d.uint8array?"uint8array":"array",_))},c.inherits(S,p),S.prototype.processChunk=function(_){var E=c.transformTo(d.uint8array?"uint8array":"array",_.data);if(this.leftOver&&this.leftOver.length){if(d.uint8array){var w=E;(E=new Uint8Array(w.length+this.leftOver.length)).set(this.leftOver,0),E.set(w,this.leftOver.length)}else E=this.leftOver.concat(E);this.leftOver=null}var k=(function(I,M){var F;for((M=M||I.length)>I.length&&(M=I.length),F=M-1;0<=F&&(192&I[F])==128;)F--;return F<0||F===0?M:F+h[I[F]]>M?F:M})(E),N=E;k!==E.length&&(d.uint8array?(N=E.subarray(0,k),this.leftOver=E.subarray(k,E.length)):(N=E.slice(0,k),this.leftOver=E.slice(k,E.length))),this.push({data:l.utf8decode(N),meta:_.meta})},S.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:l.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},l.Utf8DecodeWorker=S,c.inherits(A,p),A.prototype.processChunk=function(_){this.push({data:l.utf8encode(_.data),meta:_.meta})},l.Utf8EncodeWorker=A},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(s,i,l){var c=s("./support"),d=s("./base64"),m=s("./nodejsUtils"),p=s("./external");function h(w){return w}function v(w,k){for(var N=0;N<w.length;++N)k[N]=255&w.charCodeAt(N);return k}s("setimmediate"),l.newBlob=function(w,k){l.checkSupport("blob");try{return new Blob([w],{type:k})}catch{try{var N=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return N.append(w),N.getBlob(k)}catch{throw new Error("Bug : can't construct the Blob.")}}};var S={stringifyByChunk:function(w,k,N){var I=[],M=0,F=w.length;if(F<=N)return String.fromCharCode.apply(null,w);for(;M<F;)k==="array"||k==="nodebuffer"?I.push(String.fromCharCode.apply(null,w.slice(M,Math.min(M+N,F)))):I.push(String.fromCharCode.apply(null,w.subarray(M,Math.min(M+N,F)))),M+=N;return I.join("")},stringifyByChar:function(w){for(var k="",N=0;N<w.length;N++)k+=String.fromCharCode(w[N]);return k},applyCanBeUsed:{uint8array:(function(){try{return c.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch{return!1}})(),nodebuffer:(function(){try{return c.nodebuffer&&String.fromCharCode.apply(null,m.allocBuffer(1)).length===1}catch{return!1}})()}};function A(w){var k=65536,N=l.getTypeOf(w),I=!0;if(N==="uint8array"?I=S.applyCanBeUsed.uint8array:N==="nodebuffer"&&(I=S.applyCanBeUsed.nodebuffer),I)for(;1<k;)try{return S.stringifyByChunk(w,N,k)}catch{k=Math.floor(k/2)}return S.stringifyByChar(w)}function _(w,k){for(var N=0;N<w.length;N++)k[N]=w[N];return k}l.applyFromCharCode=A;var E={};E.string={string:h,array:function(w){return v(w,new Array(w.length))},arraybuffer:function(w){return E.string.uint8array(w).buffer},uint8array:function(w){return v(w,new Uint8Array(w.length))},nodebuffer:function(w){return v(w,m.allocBuffer(w.length))}},E.array={string:A,array:h,arraybuffer:function(w){return new Uint8Array(w).buffer},uint8array:function(w){return new Uint8Array(w)},nodebuffer:function(w){return m.newBufferFrom(w)}},E.arraybuffer={string:function(w){return A(new Uint8Array(w))},array:function(w){return _(new Uint8Array(w),new Array(w.byteLength))},arraybuffer:h,uint8array:function(w){return new Uint8Array(w)},nodebuffer:function(w){return m.newBufferFrom(new Uint8Array(w))}},E.uint8array={string:A,array:function(w){return _(w,new Array(w.length))},arraybuffer:function(w){return w.buffer},uint8array:h,nodebuffer:function(w){return m.newBufferFrom(w)}},E.nodebuffer={string:A,array:function(w){return _(w,new Array(w.length))},arraybuffer:function(w){return E.nodebuffer.uint8array(w).buffer},uint8array:function(w){return _(w,new Uint8Array(w.length))},nodebuffer:h},l.transformTo=function(w,k){if(k=k||"",!w)return k;l.checkSupport(w);var N=l.getTypeOf(k);return E[N][w](k)},l.resolve=function(w){for(var k=w.split("/"),N=[],I=0;I<k.length;I++){var M=k[I];M==="."||M===""&&I!==0&&I!==k.length-1||(M===".."?N.pop():N.push(M))}return N.join("/")},l.getTypeOf=function(w){return typeof w=="string"?"string":Object.prototype.toString.call(w)==="[object Array]"?"array":c.nodebuffer&&m.isBuffer(w)?"nodebuffer":c.uint8array&&w instanceof Uint8Array?"uint8array":c.arraybuffer&&w instanceof ArrayBuffer?"arraybuffer":void 0},l.checkSupport=function(w){if(!c[w.toLowerCase()])throw new Error(w+" is not supported by this platform")},l.MAX_VALUE_16BITS=65535,l.MAX_VALUE_32BITS=-1,l.pretty=function(w){var k,N,I="";for(N=0;N<(w||"").length;N++)I+="\\x"+((k=w.charCodeAt(N))<16?"0":"")+k.toString(16).toUpperCase();return I},l.delay=function(w,k,N){setImmediate(function(){w.apply(N||null,k||[])})},l.inherits=function(w,k){function N(){}N.prototype=k.prototype,w.prototype=new N},l.extend=function(){var w,k,N={};for(w=0;w<arguments.length;w++)for(k in arguments[w])Object.prototype.hasOwnProperty.call(arguments[w],k)&&N[k]===void 0&&(N[k]=arguments[w][k]);return N},l.prepareContent=function(w,k,N,I,M){return p.Promise.resolve(k).then(function(F){return c.blob&&(F instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(F))!==-1)&&typeof FileReader<"u"?new p.Promise(function(q,Q){var U=new FileReader;U.onload=function(j){q(j.target.result)},U.onerror=function(j){Q(j.target.error)},U.readAsArrayBuffer(F)}):F}).then(function(F){var q=l.getTypeOf(F);return q?(q==="arraybuffer"?F=l.transformTo("uint8array",F):q==="string"&&(M?F=d.decode(F):N&&I!==!0&&(F=(function(Q){return v(Q,c.uint8array?new Uint8Array(Q.length):new Array(Q.length))})(F))),F):p.Promise.reject(new Error("Can't read the data of '"+w+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(s,i,l){var c=s("./reader/readerFor"),d=s("./utils"),m=s("./signature"),p=s("./zipEntry"),h=s("./support");function v(S){this.files=[],this.loadOptions=S}v.prototype={checkSignature:function(S){if(!this.reader.readAndCheckSignature(S)){this.reader.index-=4;var A=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+d.pretty(A)+", expected "+d.pretty(S)+")")}},isSignature:function(S,A){var _=this.reader.index;this.reader.setIndex(S);var E=this.reader.readString(4)===A;return this.reader.setIndex(_),E},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var S=this.reader.readData(this.zipCommentLength),A=h.uint8array?"uint8array":"array",_=d.transformTo(A,S);this.zipComment=this.loadOptions.decodeFileName(_)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var S,A,_,E=this.zip64EndOfCentralSize-44;0<E;)S=this.reader.readInt(2),A=this.reader.readInt(4),_=this.reader.readData(A),this.zip64ExtensibleData[S]={id:S,length:A,value:_}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var S,A;for(S=0;S<this.files.length;S++)A=this.files[S],this.reader.setIndex(A.localHeaderOffset),this.checkSignature(m.LOCAL_FILE_HEADER),A.readLocalPart(this.reader),A.handleUTF8(),A.processAttributes()},readCentralDir:function(){var S;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(m.CENTRAL_FILE_HEADER);)(S=new p({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(S);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var S=this.reader.lastIndexOfSignature(m.CENTRAL_DIRECTORY_END);if(S<0)throw this.isSignature(0,m.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(S);var A=S;if(this.checkSignature(m.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===d.MAX_VALUE_16BITS||this.diskWithCentralDirStart===d.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===d.MAX_VALUE_16BITS||this.centralDirRecords===d.MAX_VALUE_16BITS||this.centralDirSize===d.MAX_VALUE_32BITS||this.centralDirOffset===d.MAX_VALUE_32BITS){if(this.zip64=!0,(S=this.reader.lastIndexOfSignature(m.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(S),this.checkSignature(m.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,m.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(m.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(m.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var _=this.centralDirOffset+this.centralDirSize;this.zip64&&(_+=20,_+=12+this.zip64EndOfCentralSize);var E=A-_;if(0<E)this.isSignature(A,m.CENTRAL_FILE_HEADER)||(this.reader.zero=E);else if(E<0)throw new Error("Corrupted zip: missing "+Math.abs(E)+" bytes.")},prepareReader:function(S){this.reader=c(S)},load:function(S){this.prepareReader(S),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},i.exports=v},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(s,i,l){var c=s("./reader/readerFor"),d=s("./utils"),m=s("./compressedObject"),p=s("./crc32"),h=s("./utf8"),v=s("./compressions"),S=s("./support");function A(_,E){this.options=_,this.loadOptions=E}A.prototype={isEncrypted:function(){return(1&this.bitFlag)==1},useUTF8:function(){return(2048&this.bitFlag)==2048},readLocalPart:function(_){var E,w;if(_.skip(22),this.fileNameLength=_.readInt(2),w=_.readInt(2),this.fileName=_.readData(this.fileNameLength),_.skip(w),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if((E=(function(k){for(var N in v)if(Object.prototype.hasOwnProperty.call(v,N)&&v[N].magic===k)return v[N];return null})(this.compressionMethod))===null)throw new Error("Corrupted zip : compression "+d.pretty(this.compressionMethod)+" unknown (inner file : "+d.transformTo("string",this.fileName)+")");this.decompressed=new m(this.compressedSize,this.uncompressedSize,this.crc32,E,_.readData(this.compressedSize))},readCentralPart:function(_){this.versionMadeBy=_.readInt(2),_.skip(2),this.bitFlag=_.readInt(2),this.compressionMethod=_.readString(2),this.date=_.readDate(),this.crc32=_.readInt(4),this.compressedSize=_.readInt(4),this.uncompressedSize=_.readInt(4);var E=_.readInt(2);if(this.extraFieldsLength=_.readInt(2),this.fileCommentLength=_.readInt(2),this.diskNumberStart=_.readInt(2),this.internalFileAttributes=_.readInt(2),this.externalFileAttributes=_.readInt(4),this.localHeaderOffset=_.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");_.skip(E),this.readExtraFields(_),this.parseZIP64ExtraField(_),this.fileComment=_.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var _=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),_==0&&(this.dosPermissions=63&this.externalFileAttributes),_==3&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||this.fileNameStr.slice(-1)!=="/"||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var _=c(this.extraFields[1].value);this.uncompressedSize===d.MAX_VALUE_32BITS&&(this.uncompressedSize=_.readInt(8)),this.compressedSize===d.MAX_VALUE_32BITS&&(this.compressedSize=_.readInt(8)),this.localHeaderOffset===d.MAX_VALUE_32BITS&&(this.localHeaderOffset=_.readInt(8)),this.diskNumberStart===d.MAX_VALUE_32BITS&&(this.diskNumberStart=_.readInt(4))}},readExtraFields:function(_){var E,w,k,N=_.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});_.index+4<N;)E=_.readInt(2),w=_.readInt(2),k=_.readData(w),this.extraFields[E]={id:E,length:w,value:k};_.setIndex(N)},handleUTF8:function(){var _=S.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=h.utf8decode(this.fileName),this.fileCommentStr=h.utf8decode(this.fileComment);else{var E=this.findExtraFieldUnicodePath();if(E!==null)this.fileNameStr=E;else{var w=d.transformTo(_,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(w)}var k=this.findExtraFieldUnicodeComment();if(k!==null)this.fileCommentStr=k;else{var N=d.transformTo(_,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(N)}}},findExtraFieldUnicodePath:function(){var _=this.extraFields[28789];if(_){var E=c(_.value);return E.readInt(1)!==1||p(this.fileName)!==E.readInt(4)?null:h.utf8decode(E.readData(_.length-5))}return null},findExtraFieldUnicodeComment:function(){var _=this.extraFields[25461];if(_){var E=c(_.value);return E.readInt(1)!==1||p(this.fileComment)!==E.readInt(4)?null:h.utf8decode(E.readData(_.length-5))}return null}},i.exports=A},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(s,i,l){function c(E,w,k){this.name=E,this.dir=k.dir,this.date=k.date,this.comment=k.comment,this.unixPermissions=k.unixPermissions,this.dosPermissions=k.dosPermissions,this._data=w,this._dataBinary=k.binary,this.options={compression:k.compression,compressionOptions:k.compressionOptions}}var d=s("./stream/StreamHelper"),m=s("./stream/DataWorker"),p=s("./utf8"),h=s("./compressedObject"),v=s("./stream/GenericWorker");c.prototype={internalStream:function(E){var w=null,k="string";try{if(!E)throw new Error("No output type specified.");var N=(k=E.toLowerCase())==="string"||k==="text";k!=="binarystring"&&k!=="text"||(k="string"),w=this._decompressWorker();var I=!this._dataBinary;I&&!N&&(w=w.pipe(new p.Utf8EncodeWorker)),!I&&N&&(w=w.pipe(new p.Utf8DecodeWorker))}catch(M){(w=new v("error")).error(M)}return new d(w,k,"")},async:function(E,w){return this.internalStream(E).accumulate(w)},nodeStream:function(E,w){return this.internalStream(E||"nodebuffer").toNodejsStream(w)},_compressWorker:function(E,w){if(this._data instanceof h&&this._data.compression.magic===E.magic)return this._data.getCompressedWorker();var k=this._decompressWorker();return this._dataBinary||(k=k.pipe(new p.Utf8EncodeWorker)),h.createWorkerFrom(k,E,w)},_decompressWorker:function(){return this._data instanceof h?this._data.getContentWorker():this._data instanceof v?this._data:new m(this._data)}};for(var S=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],A=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},_=0;_<S.length;_++)c.prototype[S[_]]=A;i.exports=c},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(s,i,l){(function(c){var d,m,p=c.MutationObserver||c.WebKitMutationObserver;if(p){var h=0,v=new p(E),S=c.document.createTextNode("");v.observe(S,{characterData:!0}),d=function(){S.data=h=++h%2}}else if(c.setImmediate||c.MessageChannel===void 0)d="document"in c&&"onreadystatechange"in c.document.createElement("script")?function(){var w=c.document.createElement("script");w.onreadystatechange=function(){E(),w.onreadystatechange=null,w.parentNode.removeChild(w),w=null},c.document.documentElement.appendChild(w)}:function(){setTimeout(E,0)};else{var A=new c.MessageChannel;A.port1.onmessage=E,d=function(){A.port2.postMessage(0)}}var _=[];function E(){var w,k;m=!0;for(var N=_.length;N;){for(k=_,_=[],w=-1;++w<N;)k[w]();N=_.length}m=!1}i.exports=function(w){_.push(w)!==1||m||d()}}).call(this,typeof Pc<"u"?Pc:typeof self<"u"?self:typeof window<"u"?window:{})},{}],37:[function(s,i,l){var c=s("immediate");function d(){}var m={},p=["REJECTED"],h=["FULFILLED"],v=["PENDING"];function S(N){if(typeof N!="function")throw new TypeError("resolver must be a function");this.state=v,this.queue=[],this.outcome=void 0,N!==d&&w(this,N)}function A(N,I,M){this.promise=N,typeof I=="function"&&(this.onFulfilled=I,this.callFulfilled=this.otherCallFulfilled),typeof M=="function"&&(this.onRejected=M,this.callRejected=this.otherCallRejected)}function _(N,I,M){c(function(){var F;try{F=I(M)}catch(q){return m.reject(N,q)}F===N?m.reject(N,new TypeError("Cannot resolve promise with itself")):m.resolve(N,F)})}function E(N){var I=N&&N.then;if(N&&(typeof N=="object"||typeof N=="function")&&typeof I=="function")return function(){I.apply(N,arguments)}}function w(N,I){var M=!1;function F(U){M||(M=!0,m.reject(N,U))}function q(U){M||(M=!0,m.resolve(N,U))}var Q=k(function(){I(q,F)});Q.status==="error"&&F(Q.value)}function k(N,I){var M={};try{M.value=N(I),M.status="success"}catch(F){M.status="error",M.value=F}return M}(i.exports=S).prototype.finally=function(N){if(typeof N!="function")return this;var I=this.constructor;return this.then(function(M){return I.resolve(N()).then(function(){return M})},function(M){return I.resolve(N()).then(function(){throw M})})},S.prototype.catch=function(N){return this.then(null,N)},S.prototype.then=function(N,I){if(typeof N!="function"&&this.state===h||typeof I!="function"&&this.state===p)return this;var M=new this.constructor(d);return this.state!==v?_(M,this.state===h?N:I,this.outcome):this.queue.push(new A(M,N,I)),M},A.prototype.callFulfilled=function(N){m.resolve(this.promise,N)},A.prototype.otherCallFulfilled=function(N){_(this.promise,this.onFulfilled,N)},A.prototype.callRejected=function(N){m.reject(this.promise,N)},A.prototype.otherCallRejected=function(N){_(this.promise,this.onRejected,N)},m.resolve=function(N,I){var M=k(E,I);if(M.status==="error")return m.reject(N,M.value);var F=M.value;if(F)w(N,F);else{N.state=h,N.outcome=I;for(var q=-1,Q=N.queue.length;++q<Q;)N.queue[q].callFulfilled(I)}return N},m.reject=function(N,I){N.state=p,N.outcome=I;for(var M=-1,F=N.queue.length;++M<F;)N.queue[M].callRejected(I);return N},S.resolve=function(N){return N instanceof this?N:m.resolve(new this(d),N)},S.reject=function(N){var I=new this(d);return m.reject(I,N)},S.all=function(N){var I=this;if(Object.prototype.toString.call(N)!=="[object Array]")return this.reject(new TypeError("must be an array"));var M=N.length,F=!1;if(!M)return this.resolve([]);for(var q=new Array(M),Q=0,U=-1,j=new this(d);++U<M;)O(N[U],U);return j;function O(B,te){I.resolve(B).then(function(L){q[te]=L,++Q!==M||F||(F=!0,m.resolve(j,q))},function(L){F||(F=!0,m.reject(j,L))})}},S.race=function(N){var I=this;if(Object.prototype.toString.call(N)!=="[object Array]")return this.reject(new TypeError("must be an array"));var M=N.length,F=!1;if(!M)return this.resolve([]);for(var q=-1,Q=new this(d);++q<M;)U=N[q],I.resolve(U).then(function(j){F||(F=!0,m.resolve(Q,j))},function(j){F||(F=!0,m.reject(Q,j))});var U;return Q}},{immediate:36}],38:[function(s,i,l){var c={};(0,s("./lib/utils/common").assign)(c,s("./lib/deflate"),s("./lib/inflate"),s("./lib/zlib/constants")),i.exports=c},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(s,i,l){var c=s("./zlib/deflate"),d=s("./utils/common"),m=s("./utils/strings"),p=s("./zlib/messages"),h=s("./zlib/zstream"),v=Object.prototype.toString,S=0,A=-1,_=0,E=8;function w(N){if(!(this instanceof w))return new w(N);this.options=d.assign({level:A,method:E,chunkSize:16384,windowBits:15,memLevel:8,strategy:_,to:""},N||{});var I=this.options;I.raw&&0<I.windowBits?I.windowBits=-I.windowBits:I.gzip&&0<I.windowBits&&I.windowBits<16&&(I.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new h,this.strm.avail_out=0;var M=c.deflateInit2(this.strm,I.level,I.method,I.windowBits,I.memLevel,I.strategy);if(M!==S)throw new Error(p[M]);if(I.header&&c.deflateSetHeader(this.strm,I.header),I.dictionary){var F;if(F=typeof I.dictionary=="string"?m.string2buf(I.dictionary):v.call(I.dictionary)==="[object ArrayBuffer]"?new Uint8Array(I.dictionary):I.dictionary,(M=c.deflateSetDictionary(this.strm,F))!==S)throw new Error(p[M]);this._dict_set=!0}}function k(N,I){var M=new w(I);if(M.push(N,!0),M.err)throw M.msg||p[M.err];return M.result}w.prototype.push=function(N,I){var M,F,q=this.strm,Q=this.options.chunkSize;if(this.ended)return!1;F=I===~~I?I:I===!0?4:0,typeof N=="string"?q.input=m.string2buf(N):v.call(N)==="[object ArrayBuffer]"?q.input=new Uint8Array(N):q.input=N,q.next_in=0,q.avail_in=q.input.length;do{if(q.avail_out===0&&(q.output=new d.Buf8(Q),q.next_out=0,q.avail_out=Q),(M=c.deflate(q,F))!==1&&M!==S)return this.onEnd(M),!(this.ended=!0);q.avail_out!==0&&(q.avail_in!==0||F!==4&&F!==2)||(this.options.to==="string"?this.onData(m.buf2binstring(d.shrinkBuf(q.output,q.next_out))):this.onData(d.shrinkBuf(q.output,q.next_out)))}while((0<q.avail_in||q.avail_out===0)&&M!==1);return F===4?(M=c.deflateEnd(this.strm),this.onEnd(M),this.ended=!0,M===S):F!==2||(this.onEnd(S),!(q.avail_out=0))},w.prototype.onData=function(N){this.chunks.push(N)},w.prototype.onEnd=function(N){N===S&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=d.flattenChunks(this.chunks)),this.chunks=[],this.err=N,this.msg=this.strm.msg},l.Deflate=w,l.deflate=k,l.deflateRaw=function(N,I){return(I=I||{}).raw=!0,k(N,I)},l.gzip=function(N,I){return(I=I||{}).gzip=!0,k(N,I)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(s,i,l){var c=s("./zlib/inflate"),d=s("./utils/common"),m=s("./utils/strings"),p=s("./zlib/constants"),h=s("./zlib/messages"),v=s("./zlib/zstream"),S=s("./zlib/gzheader"),A=Object.prototype.toString;function _(w){if(!(this instanceof _))return new _(w);this.options=d.assign({chunkSize:16384,windowBits:0,to:""},w||{});var k=this.options;k.raw&&0<=k.windowBits&&k.windowBits<16&&(k.windowBits=-k.windowBits,k.windowBits===0&&(k.windowBits=-15)),!(0<=k.windowBits&&k.windowBits<16)||w&&w.windowBits||(k.windowBits+=32),15<k.windowBits&&k.windowBits<48&&(15&k.windowBits)==0&&(k.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new v,this.strm.avail_out=0;var N=c.inflateInit2(this.strm,k.windowBits);if(N!==p.Z_OK)throw new Error(h[N]);this.header=new S,c.inflateGetHeader(this.strm,this.header)}function E(w,k){var N=new _(k);if(N.push(w,!0),N.err)throw N.msg||h[N.err];return N.result}_.prototype.push=function(w,k){var N,I,M,F,q,Q,U=this.strm,j=this.options.chunkSize,O=this.options.dictionary,B=!1;if(this.ended)return!1;I=k===~~k?k:k===!0?p.Z_FINISH:p.Z_NO_FLUSH,typeof w=="string"?U.input=m.binstring2buf(w):A.call(w)==="[object ArrayBuffer]"?U.input=new Uint8Array(w):U.input=w,U.next_in=0,U.avail_in=U.input.length;do{if(U.avail_out===0&&(U.output=new d.Buf8(j),U.next_out=0,U.avail_out=j),(N=c.inflate(U,p.Z_NO_FLUSH))===p.Z_NEED_DICT&&O&&(Q=typeof O=="string"?m.string2buf(O):A.call(O)==="[object ArrayBuffer]"?new Uint8Array(O):O,N=c.inflateSetDictionary(this.strm,Q)),N===p.Z_BUF_ERROR&&B===!0&&(N=p.Z_OK,B=!1),N!==p.Z_STREAM_END&&N!==p.Z_OK)return this.onEnd(N),!(this.ended=!0);U.next_out&&(U.avail_out!==0&&N!==p.Z_STREAM_END&&(U.avail_in!==0||I!==p.Z_FINISH&&I!==p.Z_SYNC_FLUSH)||(this.options.to==="string"?(M=m.utf8border(U.output,U.next_out),F=U.next_out-M,q=m.buf2string(U.output,M),U.next_out=F,U.avail_out=j-F,F&&d.arraySet(U.output,U.output,M,F,0),this.onData(q)):this.onData(d.shrinkBuf(U.output,U.next_out)))),U.avail_in===0&&U.avail_out===0&&(B=!0)}while((0<U.avail_in||U.avail_out===0)&&N!==p.Z_STREAM_END);return N===p.Z_STREAM_END&&(I=p.Z_FINISH),I===p.Z_FINISH?(N=c.inflateEnd(this.strm),this.onEnd(N),this.ended=!0,N===p.Z_OK):I!==p.Z_SYNC_FLUSH||(this.onEnd(p.Z_OK),!(U.avail_out=0))},_.prototype.onData=function(w){this.chunks.push(w)},_.prototype.onEnd=function(w){w===p.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=d.flattenChunks(this.chunks)),this.chunks=[],this.err=w,this.msg=this.strm.msg},l.Inflate=_,l.inflate=E,l.inflateRaw=function(w,k){return(k=k||{}).raw=!0,E(w,k)},l.ungzip=E},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(s,i,l){var c=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";l.assign=function(p){for(var h=Array.prototype.slice.call(arguments,1);h.length;){var v=h.shift();if(v){if(typeof v!="object")throw new TypeError(v+"must be non-object");for(var S in v)v.hasOwnProperty(S)&&(p[S]=v[S])}}return p},l.shrinkBuf=function(p,h){return p.length===h?p:p.subarray?p.subarray(0,h):(p.length=h,p)};var d={arraySet:function(p,h,v,S,A){if(h.subarray&&p.subarray)p.set(h.subarray(v,v+S),A);else for(var _=0;_<S;_++)p[A+_]=h[v+_]},flattenChunks:function(p){var h,v,S,A,_,E;for(h=S=0,v=p.length;h<v;h++)S+=p[h].length;for(E=new Uint8Array(S),h=A=0,v=p.length;h<v;h++)_=p[h],E.set(_,A),A+=_.length;return E}},m={arraySet:function(p,h,v,S,A){for(var _=0;_<S;_++)p[A+_]=h[v+_]},flattenChunks:function(p){return[].concat.apply([],p)}};l.setTyped=function(p){p?(l.Buf8=Uint8Array,l.Buf16=Uint16Array,l.Buf32=Int32Array,l.assign(l,d)):(l.Buf8=Array,l.Buf16=Array,l.Buf32=Array,l.assign(l,m))},l.setTyped(c)},{}],42:[function(s,i,l){var c=s("./common"),d=!0,m=!0;try{String.fromCharCode.apply(null,[0])}catch{d=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{m=!1}for(var p=new c.Buf8(256),h=0;h<256;h++)p[h]=252<=h?6:248<=h?5:240<=h?4:224<=h?3:192<=h?2:1;function v(S,A){if(A<65537&&(S.subarray&&m||!S.subarray&&d))return String.fromCharCode.apply(null,c.shrinkBuf(S,A));for(var _="",E=0;E<A;E++)_+=String.fromCharCode(S[E]);return _}p[254]=p[254]=1,l.string2buf=function(S){var A,_,E,w,k,N=S.length,I=0;for(w=0;w<N;w++)(64512&(_=S.charCodeAt(w)))==55296&&w+1<N&&(64512&(E=S.charCodeAt(w+1)))==56320&&(_=65536+(_-55296<<10)+(E-56320),w++),I+=_<128?1:_<2048?2:_<65536?3:4;for(A=new c.Buf8(I),w=k=0;k<I;w++)(64512&(_=S.charCodeAt(w)))==55296&&w+1<N&&(64512&(E=S.charCodeAt(w+1)))==56320&&(_=65536+(_-55296<<10)+(E-56320),w++),_<128?A[k++]=_:(_<2048?A[k++]=192|_>>>6:(_<65536?A[k++]=224|_>>>12:(A[k++]=240|_>>>18,A[k++]=128|_>>>12&63),A[k++]=128|_>>>6&63),A[k++]=128|63&_);return A},l.buf2binstring=function(S){return v(S,S.length)},l.binstring2buf=function(S){for(var A=new c.Buf8(S.length),_=0,E=A.length;_<E;_++)A[_]=S.charCodeAt(_);return A},l.buf2string=function(S,A){var _,E,w,k,N=A||S.length,I=new Array(2*N);for(_=E=0;_<N;)if((w=S[_++])<128)I[E++]=w;else if(4<(k=p[w]))I[E++]=65533,_+=k-1;else{for(w&=k===2?31:k===3?15:7;1<k&&_<N;)w=w<<6|63&S[_++],k--;1<k?I[E++]=65533:w<65536?I[E++]=w:(w-=65536,I[E++]=55296|w>>10&1023,I[E++]=56320|1023&w)}return v(I,E)},l.utf8border=function(S,A){var _;for((A=A||S.length)>S.length&&(A=S.length),_=A-1;0<=_&&(192&S[_])==128;)_--;return _<0||_===0?A:_+p[S[_]]>A?_:A}},{"./common":41}],43:[function(s,i,l){i.exports=function(c,d,m,p){for(var h=65535&c|0,v=c>>>16&65535|0,S=0;m!==0;){for(m-=S=2e3<m?2e3:m;v=v+(h=h+d[p++]|0)|0,--S;);h%=65521,v%=65521}return h|v<<16|0}},{}],44:[function(s,i,l){i.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(s,i,l){var c=(function(){for(var d,m=[],p=0;p<256;p++){d=p;for(var h=0;h<8;h++)d=1&d?3988292384^d>>>1:d>>>1;m[p]=d}return m})();i.exports=function(d,m,p,h){var v=c,S=h+p;d^=-1;for(var A=h;A<S;A++)d=d>>>8^v[255&(d^m[A])];return-1^d}},{}],46:[function(s,i,l){var c,d=s("../utils/common"),m=s("./trees"),p=s("./adler32"),h=s("./crc32"),v=s("./messages"),S=0,A=4,_=0,E=-2,w=-1,k=4,N=2,I=8,M=9,F=286,q=30,Q=19,U=2*F+1,j=15,O=3,B=258,te=B+O+1,L=42,J=113,D=1,ie=2,Z=3,Y=4;function me(x,se){return x.msg=v[se],se}function W(x){return(x<<1)-(4<x?9:0)}function be(x){for(var se=x.length;0<=--se;)x[se]=0}function z(x){var se=x.state,X=se.pending;X>x.avail_out&&(X=x.avail_out),X!==0&&(d.arraySet(x.output,se.pending_buf,se.pending_out,X,x.next_out),x.next_out+=X,se.pending_out+=X,x.total_out+=X,x.avail_out-=X,se.pending-=X,se.pending===0&&(se.pending_out=0))}function R(x,se){m._tr_flush_block(x,0<=x.block_start?x.block_start:-1,x.strstart-x.block_start,se),x.block_start=x.strstart,z(x.strm)}function re(x,se){x.pending_buf[x.pending++]=se}function oe(x,se){x.pending_buf[x.pending++]=se>>>8&255,x.pending_buf[x.pending++]=255&se}function he(x,se){var X,$,P=x.max_chain_length,K=x.strstart,ye=x.prev_length,ve=x.nice_match,ne=x.strstart>x.w_size-te?x.strstart-(x.w_size-te):0,ke=x.window,Oe=x.w_mask,Te=x.prev,He=x.strstart+B,it=ke[K+ye-1],at=ke[K+ye];x.prev_length>=x.good_match&&(P>>=2),ve>x.lookahead&&(ve=x.lookahead);do if(ke[(X=se)+ye]===at&&ke[X+ye-1]===it&&ke[X]===ke[K]&&ke[++X]===ke[K+1]){K+=2,X++;do;while(ke[++K]===ke[++X]&&ke[++K]===ke[++X]&&ke[++K]===ke[++X]&&ke[++K]===ke[++X]&&ke[++K]===ke[++X]&&ke[++K]===ke[++X]&&ke[++K]===ke[++X]&&ke[++K]===ke[++X]&&K<He);if($=B-(He-K),K=He-B,ye<$){if(x.match_start=se,ve<=(ye=$))break;it=ke[K+ye-1],at=ke[K+ye]}}while((se=Te[se&Oe])>ne&&--P!=0);return ye<=x.lookahead?ye:x.lookahead}function fe(x){var se,X,$,P,K,ye,ve,ne,ke,Oe,Te=x.w_size;do{if(P=x.window_size-x.lookahead-x.strstart,x.strstart>=Te+(Te-te)){for(d.arraySet(x.window,x.window,Te,Te,0),x.match_start-=Te,x.strstart-=Te,x.block_start-=Te,se=X=x.hash_size;$=x.head[--se],x.head[se]=Te<=$?$-Te:0,--X;);for(se=X=Te;$=x.prev[--se],x.prev[se]=Te<=$?$-Te:0,--X;);P+=Te}if(x.strm.avail_in===0)break;if(ye=x.strm,ve=x.window,ne=x.strstart+x.lookahead,ke=P,Oe=void 0,Oe=ye.avail_in,ke<Oe&&(Oe=ke),X=Oe===0?0:(ye.avail_in-=Oe,d.arraySet(ve,ye.input,ye.next_in,Oe,ne),ye.state.wrap===1?ye.adler=p(ye.adler,ve,Oe,ne):ye.state.wrap===2&&(ye.adler=h(ye.adler,ve,Oe,ne)),ye.next_in+=Oe,ye.total_in+=Oe,Oe),x.lookahead+=X,x.lookahead+x.insert>=O)for(K=x.strstart-x.insert,x.ins_h=x.window[K],x.ins_h=(x.ins_h<<x.hash_shift^x.window[K+1])&x.hash_mask;x.insert&&(x.ins_h=(x.ins_h<<x.hash_shift^x.window[K+O-1])&x.hash_mask,x.prev[K&x.w_mask]=x.head[x.ins_h],x.head[x.ins_h]=K,K++,x.insert--,!(x.lookahead+x.insert<O)););}while(x.lookahead<te&&x.strm.avail_in!==0)}function Me(x,se){for(var X,$;;){if(x.lookahead<te){if(fe(x),x.lookahead<te&&se===S)return D;if(x.lookahead===0)break}if(X=0,x.lookahead>=O&&(x.ins_h=(x.ins_h<<x.hash_shift^x.window[x.strstart+O-1])&x.hash_mask,X=x.prev[x.strstart&x.w_mask]=x.head[x.ins_h],x.head[x.ins_h]=x.strstart),X!==0&&x.strstart-X<=x.w_size-te&&(x.match_length=he(x,X)),x.match_length>=O)if($=m._tr_tally(x,x.strstart-x.match_start,x.match_length-O),x.lookahead-=x.match_length,x.match_length<=x.max_lazy_match&&x.lookahead>=O){for(x.match_length--;x.strstart++,x.ins_h=(x.ins_h<<x.hash_shift^x.window[x.strstart+O-1])&x.hash_mask,X=x.prev[x.strstart&x.w_mask]=x.head[x.ins_h],x.head[x.ins_h]=x.strstart,--x.match_length!=0;);x.strstart++}else x.strstart+=x.match_length,x.match_length=0,x.ins_h=x.window[x.strstart],x.ins_h=(x.ins_h<<x.hash_shift^x.window[x.strstart+1])&x.hash_mask;else $=m._tr_tally(x,0,x.window[x.strstart]),x.lookahead--,x.strstart++;if($&&(R(x,!1),x.strm.avail_out===0))return D}return x.insert=x.strstart<O-1?x.strstart:O-1,se===A?(R(x,!0),x.strm.avail_out===0?Z:Y):x.last_lit&&(R(x,!1),x.strm.avail_out===0)?D:ie}function Fe(x,se){for(var X,$,P;;){if(x.lookahead<te){if(fe(x),x.lookahead<te&&se===S)return D;if(x.lookahead===0)break}if(X=0,x.lookahead>=O&&(x.ins_h=(x.ins_h<<x.hash_shift^x.window[x.strstart+O-1])&x.hash_mask,X=x.prev[x.strstart&x.w_mask]=x.head[x.ins_h],x.head[x.ins_h]=x.strstart),x.prev_length=x.match_length,x.prev_match=x.match_start,x.match_length=O-1,X!==0&&x.prev_length<x.max_lazy_match&&x.strstart-X<=x.w_size-te&&(x.match_length=he(x,X),x.match_length<=5&&(x.strategy===1||x.match_length===O&&4096<x.strstart-x.match_start)&&(x.match_length=O-1)),x.prev_length>=O&&x.match_length<=x.prev_length){for(P=x.strstart+x.lookahead-O,$=m._tr_tally(x,x.strstart-1-x.prev_match,x.prev_length-O),x.lookahead-=x.prev_length-1,x.prev_length-=2;++x.strstart<=P&&(x.ins_h=(x.ins_h<<x.hash_shift^x.window[x.strstart+O-1])&x.hash_mask,X=x.prev[x.strstart&x.w_mask]=x.head[x.ins_h],x.head[x.ins_h]=x.strstart),--x.prev_length!=0;);if(x.match_available=0,x.match_length=O-1,x.strstart++,$&&(R(x,!1),x.strm.avail_out===0))return D}else if(x.match_available){if(($=m._tr_tally(x,0,x.window[x.strstart-1]))&&R(x,!1),x.strstart++,x.lookahead--,x.strm.avail_out===0)return D}else x.match_available=1,x.strstart++,x.lookahead--}return x.match_available&&($=m._tr_tally(x,0,x.window[x.strstart-1]),x.match_available=0),x.insert=x.strstart<O-1?x.strstart:O-1,se===A?(R(x,!0),x.strm.avail_out===0?Z:Y):x.last_lit&&(R(x,!1),x.strm.avail_out===0)?D:ie}function Ce(x,se,X,$,P){this.good_length=x,this.max_lazy=se,this.nice_length=X,this.max_chain=$,this.func=P}function Ve(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=I,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new d.Buf16(2*U),this.dyn_dtree=new d.Buf16(2*(2*q+1)),this.bl_tree=new d.Buf16(2*(2*Q+1)),be(this.dyn_ltree),be(this.dyn_dtree),be(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new d.Buf16(j+1),this.heap=new d.Buf16(2*F+1),be(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new d.Buf16(2*F+1),be(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function Qe(x){var se;return x&&x.state?(x.total_in=x.total_out=0,x.data_type=N,(se=x.state).pending=0,se.pending_out=0,se.wrap<0&&(se.wrap=-se.wrap),se.status=se.wrap?L:J,x.adler=se.wrap===2?0:1,se.last_flush=S,m._tr_init(se),_):me(x,E)}function ue(x){var se=Qe(x);return se===_&&(function(X){X.window_size=2*X.w_size,be(X.head),X.max_lazy_match=c[X.level].max_lazy,X.good_match=c[X.level].good_length,X.nice_match=c[X.level].nice_length,X.max_chain_length=c[X.level].max_chain,X.strstart=0,X.block_start=0,X.lookahead=0,X.insert=0,X.match_length=X.prev_length=O-1,X.match_available=0,X.ins_h=0})(x.state),se}function de(x,se,X,$,P,K){if(!x)return E;var ye=1;if(se===w&&(se=6),$<0?(ye=0,$=-$):15<$&&(ye=2,$-=16),P<1||M<P||X!==I||$<8||15<$||se<0||9<se||K<0||k<K)return me(x,E);$===8&&($=9);var ve=new Ve;return(x.state=ve).strm=x,ve.wrap=ye,ve.gzhead=null,ve.w_bits=$,ve.w_size=1<<ve.w_bits,ve.w_mask=ve.w_size-1,ve.hash_bits=P+7,ve.hash_size=1<<ve.hash_bits,ve.hash_mask=ve.hash_size-1,ve.hash_shift=~~((ve.hash_bits+O-1)/O),ve.window=new d.Buf8(2*ve.w_size),ve.head=new d.Buf16(ve.hash_size),ve.prev=new d.Buf16(ve.w_size),ve.lit_bufsize=1<<P+6,ve.pending_buf_size=4*ve.lit_bufsize,ve.pending_buf=new d.Buf8(ve.pending_buf_size),ve.d_buf=1*ve.lit_bufsize,ve.l_buf=3*ve.lit_bufsize,ve.level=se,ve.strategy=K,ve.method=X,ue(x)}c=[new Ce(0,0,0,0,function(x,se){var X=65535;for(X>x.pending_buf_size-5&&(X=x.pending_buf_size-5);;){if(x.lookahead<=1){if(fe(x),x.lookahead===0&&se===S)return D;if(x.lookahead===0)break}x.strstart+=x.lookahead,x.lookahead=0;var $=x.block_start+X;if((x.strstart===0||x.strstart>=$)&&(x.lookahead=x.strstart-$,x.strstart=$,R(x,!1),x.strm.avail_out===0)||x.strstart-x.block_start>=x.w_size-te&&(R(x,!1),x.strm.avail_out===0))return D}return x.insert=0,se===A?(R(x,!0),x.strm.avail_out===0?Z:Y):(x.strstart>x.block_start&&(R(x,!1),x.strm.avail_out),D)}),new Ce(4,4,8,4,Me),new Ce(4,5,16,8,Me),new Ce(4,6,32,32,Me),new Ce(4,4,16,16,Fe),new Ce(8,16,32,32,Fe),new Ce(8,16,128,128,Fe),new Ce(8,32,128,256,Fe),new Ce(32,128,258,1024,Fe),new Ce(32,258,258,4096,Fe)],l.deflateInit=function(x,se){return de(x,se,I,15,8,0)},l.deflateInit2=de,l.deflateReset=ue,l.deflateResetKeep=Qe,l.deflateSetHeader=function(x,se){return x&&x.state?x.state.wrap!==2?E:(x.state.gzhead=se,_):E},l.deflate=function(x,se){var X,$,P,K;if(!x||!x.state||5<se||se<0)return x?me(x,E):E;if($=x.state,!x.output||!x.input&&x.avail_in!==0||$.status===666&&se!==A)return me(x,x.avail_out===0?-5:E);if($.strm=x,X=$.last_flush,$.last_flush=se,$.status===L)if($.wrap===2)x.adler=0,re($,31),re($,139),re($,8),$.gzhead?(re($,($.gzhead.text?1:0)+($.gzhead.hcrc?2:0)+($.gzhead.extra?4:0)+($.gzhead.name?8:0)+($.gzhead.comment?16:0)),re($,255&$.gzhead.time),re($,$.gzhead.time>>8&255),re($,$.gzhead.time>>16&255),re($,$.gzhead.time>>24&255),re($,$.level===9?2:2<=$.strategy||$.level<2?4:0),re($,255&$.gzhead.os),$.gzhead.extra&&$.gzhead.extra.length&&(re($,255&$.gzhead.extra.length),re($,$.gzhead.extra.length>>8&255)),$.gzhead.hcrc&&(x.adler=h(x.adler,$.pending_buf,$.pending,0)),$.gzindex=0,$.status=69):(re($,0),re($,0),re($,0),re($,0),re($,0),re($,$.level===9?2:2<=$.strategy||$.level<2?4:0),re($,3),$.status=J);else{var ye=I+($.w_bits-8<<4)<<8;ye|=(2<=$.strategy||$.level<2?0:$.level<6?1:$.level===6?2:3)<<6,$.strstart!==0&&(ye|=32),ye+=31-ye%31,$.status=J,oe($,ye),$.strstart!==0&&(oe($,x.adler>>>16),oe($,65535&x.adler)),x.adler=1}if($.status===69)if($.gzhead.extra){for(P=$.pending;$.gzindex<(65535&$.gzhead.extra.length)&&($.pending!==$.pending_buf_size||($.gzhead.hcrc&&$.pending>P&&(x.adler=h(x.adler,$.pending_buf,$.pending-P,P)),z(x),P=$.pending,$.pending!==$.pending_buf_size));)re($,255&$.gzhead.extra[$.gzindex]),$.gzindex++;$.gzhead.hcrc&&$.pending>P&&(x.adler=h(x.adler,$.pending_buf,$.pending-P,P)),$.gzindex===$.gzhead.extra.length&&($.gzindex=0,$.status=73)}else $.status=73;if($.status===73)if($.gzhead.name){P=$.pending;do{if($.pending===$.pending_buf_size&&($.gzhead.hcrc&&$.pending>P&&(x.adler=h(x.adler,$.pending_buf,$.pending-P,P)),z(x),P=$.pending,$.pending===$.pending_buf_size)){K=1;break}K=$.gzindex<$.gzhead.name.length?255&$.gzhead.name.charCodeAt($.gzindex++):0,re($,K)}while(K!==0);$.gzhead.hcrc&&$.pending>P&&(x.adler=h(x.adler,$.pending_buf,$.pending-P,P)),K===0&&($.gzindex=0,$.status=91)}else $.status=91;if($.status===91)if($.gzhead.comment){P=$.pending;do{if($.pending===$.pending_buf_size&&($.gzhead.hcrc&&$.pending>P&&(x.adler=h(x.adler,$.pending_buf,$.pending-P,P)),z(x),P=$.pending,$.pending===$.pending_buf_size)){K=1;break}K=$.gzindex<$.gzhead.comment.length?255&$.gzhead.comment.charCodeAt($.gzindex++):0,re($,K)}while(K!==0);$.gzhead.hcrc&&$.pending>P&&(x.adler=h(x.adler,$.pending_buf,$.pending-P,P)),K===0&&($.status=103)}else $.status=103;if($.status===103&&($.gzhead.hcrc?($.pending+2>$.pending_buf_size&&z(x),$.pending+2<=$.pending_buf_size&&(re($,255&x.adler),re($,x.adler>>8&255),x.adler=0,$.status=J)):$.status=J),$.pending!==0){if(z(x),x.avail_out===0)return $.last_flush=-1,_}else if(x.avail_in===0&&W(se)<=W(X)&&se!==A)return me(x,-5);if($.status===666&&x.avail_in!==0)return me(x,-5);if(x.avail_in!==0||$.lookahead!==0||se!==S&&$.status!==666){var ve=$.strategy===2?(function(ne,ke){for(var Oe;;){if(ne.lookahead===0&&(fe(ne),ne.lookahead===0)){if(ke===S)return D;break}if(ne.match_length=0,Oe=m._tr_tally(ne,0,ne.window[ne.strstart]),ne.lookahead--,ne.strstart++,Oe&&(R(ne,!1),ne.strm.avail_out===0))return D}return ne.insert=0,ke===A?(R(ne,!0),ne.strm.avail_out===0?Z:Y):ne.last_lit&&(R(ne,!1),ne.strm.avail_out===0)?D:ie})($,se):$.strategy===3?(function(ne,ke){for(var Oe,Te,He,it,at=ne.window;;){if(ne.lookahead<=B){if(fe(ne),ne.lookahead<=B&&ke===S)return D;if(ne.lookahead===0)break}if(ne.match_length=0,ne.lookahead>=O&&0<ne.strstart&&(Te=at[He=ne.strstart-1])===at[++He]&&Te===at[++He]&&Te===at[++He]){it=ne.strstart+B;do;while(Te===at[++He]&&Te===at[++He]&&Te===at[++He]&&Te===at[++He]&&Te===at[++He]&&Te===at[++He]&&Te===at[++He]&&Te===at[++He]&&He<it);ne.match_length=B-(it-He),ne.match_length>ne.lookahead&&(ne.match_length=ne.lookahead)}if(ne.match_length>=O?(Oe=m._tr_tally(ne,1,ne.match_length-O),ne.lookahead-=ne.match_length,ne.strstart+=ne.match_length,ne.match_length=0):(Oe=m._tr_tally(ne,0,ne.window[ne.strstart]),ne.lookahead--,ne.strstart++),Oe&&(R(ne,!1),ne.strm.avail_out===0))return D}return ne.insert=0,ke===A?(R(ne,!0),ne.strm.avail_out===0?Z:Y):ne.last_lit&&(R(ne,!1),ne.strm.avail_out===0)?D:ie})($,se):c[$.level].func($,se);if(ve!==Z&&ve!==Y||($.status=666),ve===D||ve===Z)return x.avail_out===0&&($.last_flush=-1),_;if(ve===ie&&(se===1?m._tr_align($):se!==5&&(m._tr_stored_block($,0,0,!1),se===3&&(be($.head),$.lookahead===0&&($.strstart=0,$.block_start=0,$.insert=0))),z(x),x.avail_out===0))return $.last_flush=-1,_}return se!==A?_:$.wrap<=0?1:($.wrap===2?(re($,255&x.adler),re($,x.adler>>8&255),re($,x.adler>>16&255),re($,x.adler>>24&255),re($,255&x.total_in),re($,x.total_in>>8&255),re($,x.total_in>>16&255),re($,x.total_in>>24&255)):(oe($,x.adler>>>16),oe($,65535&x.adler)),z(x),0<$.wrap&&($.wrap=-$.wrap),$.pending!==0?_:1)},l.deflateEnd=function(x){var se;return x&&x.state?(se=x.state.status)!==L&&se!==69&&se!==73&&se!==91&&se!==103&&se!==J&&se!==666?me(x,E):(x.state=null,se===J?me(x,-3):_):E},l.deflateSetDictionary=function(x,se){var X,$,P,K,ye,ve,ne,ke,Oe=se.length;if(!x||!x.state||(K=(X=x.state).wrap)===2||K===1&&X.status!==L||X.lookahead)return E;for(K===1&&(x.adler=p(x.adler,se,Oe,0)),X.wrap=0,Oe>=X.w_size&&(K===0&&(be(X.head),X.strstart=0,X.block_start=0,X.insert=0),ke=new d.Buf8(X.w_size),d.arraySet(ke,se,Oe-X.w_size,X.w_size,0),se=ke,Oe=X.w_size),ye=x.avail_in,ve=x.next_in,ne=x.input,x.avail_in=Oe,x.next_in=0,x.input=se,fe(X);X.lookahead>=O;){for($=X.strstart,P=X.lookahead-(O-1);X.ins_h=(X.ins_h<<X.hash_shift^X.window[$+O-1])&X.hash_mask,X.prev[$&X.w_mask]=X.head[X.ins_h],X.head[X.ins_h]=$,$++,--P;);X.strstart=$,X.lookahead=O-1,fe(X)}return X.strstart+=X.lookahead,X.block_start=X.strstart,X.insert=X.lookahead,X.lookahead=0,X.match_length=X.prev_length=O-1,X.match_available=0,x.next_in=ve,x.input=ne,x.avail_in=ye,X.wrap=K,_},l.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(s,i,l){i.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(s,i,l){i.exports=function(c,d){var m,p,h,v,S,A,_,E,w,k,N,I,M,F,q,Q,U,j,O,B,te,L,J,D,ie;m=c.state,p=c.next_in,D=c.input,h=p+(c.avail_in-5),v=c.next_out,ie=c.output,S=v-(d-c.avail_out),A=v+(c.avail_out-257),_=m.dmax,E=m.wsize,w=m.whave,k=m.wnext,N=m.window,I=m.hold,M=m.bits,F=m.lencode,q=m.distcode,Q=(1<<m.lenbits)-1,U=(1<<m.distbits)-1;e:do{M<15&&(I+=D[p++]<<M,M+=8,I+=D[p++]<<M,M+=8),j=F[I&Q];t:for(;;){if(I>>>=O=j>>>24,M-=O,(O=j>>>16&255)===0)ie[v++]=65535&j;else{if(!(16&O)){if((64&O)==0){j=F[(65535&j)+(I&(1<<O)-1)];continue t}if(32&O){m.mode=12;break e}c.msg="invalid literal/length code",m.mode=30;break e}B=65535&j,(O&=15)&&(M<O&&(I+=D[p++]<<M,M+=8),B+=I&(1<<O)-1,I>>>=O,M-=O),M<15&&(I+=D[p++]<<M,M+=8,I+=D[p++]<<M,M+=8),j=q[I&U];n:for(;;){if(I>>>=O=j>>>24,M-=O,!(16&(O=j>>>16&255))){if((64&O)==0){j=q[(65535&j)+(I&(1<<O)-1)];continue n}c.msg="invalid distance code",m.mode=30;break e}if(te=65535&j,M<(O&=15)&&(I+=D[p++]<<M,(M+=8)<O&&(I+=D[p++]<<M,M+=8)),_<(te+=I&(1<<O)-1)){c.msg="invalid distance too far back",m.mode=30;break e}if(I>>>=O,M-=O,(O=v-S)<te){if(w<(O=te-O)&&m.sane){c.msg="invalid distance too far back",m.mode=30;break e}if(J=N,(L=0)===k){if(L+=E-O,O<B){for(B-=O;ie[v++]=N[L++],--O;);L=v-te,J=ie}}else if(k<O){if(L+=E+k-O,(O-=k)<B){for(B-=O;ie[v++]=N[L++],--O;);if(L=0,k<B){for(B-=O=k;ie[v++]=N[L++],--O;);L=v-te,J=ie}}}else if(L+=k-O,O<B){for(B-=O;ie[v++]=N[L++],--O;);L=v-te,J=ie}for(;2<B;)ie[v++]=J[L++],ie[v++]=J[L++],ie[v++]=J[L++],B-=3;B&&(ie[v++]=J[L++],1<B&&(ie[v++]=J[L++]))}else{for(L=v-te;ie[v++]=ie[L++],ie[v++]=ie[L++],ie[v++]=ie[L++],2<(B-=3););B&&(ie[v++]=ie[L++],1<B&&(ie[v++]=ie[L++]))}break}}break}}while(p<h&&v<A);p-=B=M>>3,I&=(1<<(M-=B<<3))-1,c.next_in=p,c.next_out=v,c.avail_in=p<h?h-p+5:5-(p-h),c.avail_out=v<A?A-v+257:257-(v-A),m.hold=I,m.bits=M}},{}],49:[function(s,i,l){var c=s("../utils/common"),d=s("./adler32"),m=s("./crc32"),p=s("./inffast"),h=s("./inftrees"),v=1,S=2,A=0,_=-2,E=1,w=852,k=592;function N(L){return(L>>>24&255)+(L>>>8&65280)+((65280&L)<<8)+((255&L)<<24)}function I(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new c.Buf16(320),this.work=new c.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function M(L){var J;return L&&L.state?(J=L.state,L.total_in=L.total_out=J.total=0,L.msg="",J.wrap&&(L.adler=1&J.wrap),J.mode=E,J.last=0,J.havedict=0,J.dmax=32768,J.head=null,J.hold=0,J.bits=0,J.lencode=J.lendyn=new c.Buf32(w),J.distcode=J.distdyn=new c.Buf32(k),J.sane=1,J.back=-1,A):_}function F(L){var J;return L&&L.state?((J=L.state).wsize=0,J.whave=0,J.wnext=0,M(L)):_}function q(L,J){var D,ie;return L&&L.state?(ie=L.state,J<0?(D=0,J=-J):(D=1+(J>>4),J<48&&(J&=15)),J&&(J<8||15<J)?_:(ie.window!==null&&ie.wbits!==J&&(ie.window=null),ie.wrap=D,ie.wbits=J,F(L))):_}function Q(L,J){var D,ie;return L?(ie=new I,(L.state=ie).window=null,(D=q(L,J))!==A&&(L.state=null),D):_}var U,j,O=!0;function B(L){if(O){var J;for(U=new c.Buf32(512),j=new c.Buf32(32),J=0;J<144;)L.lens[J++]=8;for(;J<256;)L.lens[J++]=9;for(;J<280;)L.lens[J++]=7;for(;J<288;)L.lens[J++]=8;for(h(v,L.lens,0,288,U,0,L.work,{bits:9}),J=0;J<32;)L.lens[J++]=5;h(S,L.lens,0,32,j,0,L.work,{bits:5}),O=!1}L.lencode=U,L.lenbits=9,L.distcode=j,L.distbits=5}function te(L,J,D,ie){var Z,Y=L.state;return Y.window===null&&(Y.wsize=1<<Y.wbits,Y.wnext=0,Y.whave=0,Y.window=new c.Buf8(Y.wsize)),ie>=Y.wsize?(c.arraySet(Y.window,J,D-Y.wsize,Y.wsize,0),Y.wnext=0,Y.whave=Y.wsize):(ie<(Z=Y.wsize-Y.wnext)&&(Z=ie),c.arraySet(Y.window,J,D-ie,Z,Y.wnext),(ie-=Z)?(c.arraySet(Y.window,J,D-ie,ie,0),Y.wnext=ie,Y.whave=Y.wsize):(Y.wnext+=Z,Y.wnext===Y.wsize&&(Y.wnext=0),Y.whave<Y.wsize&&(Y.whave+=Z))),0}l.inflateReset=F,l.inflateReset2=q,l.inflateResetKeep=M,l.inflateInit=function(L){return Q(L,15)},l.inflateInit2=Q,l.inflate=function(L,J){var D,ie,Z,Y,me,W,be,z,R,re,oe,he,fe,Me,Fe,Ce,Ve,Qe,ue,de,x,se,X,$,P=0,K=new c.Buf8(4),ye=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!L||!L.state||!L.output||!L.input&&L.avail_in!==0)return _;(D=L.state).mode===12&&(D.mode=13),me=L.next_out,Z=L.output,be=L.avail_out,Y=L.next_in,ie=L.input,W=L.avail_in,z=D.hold,R=D.bits,re=W,oe=be,se=A;e:for(;;)switch(D.mode){case E:if(D.wrap===0){D.mode=13;break}for(;R<16;){if(W===0)break e;W--,z+=ie[Y++]<<R,R+=8}if(2&D.wrap&&z===35615){K[D.check=0]=255&z,K[1]=z>>>8&255,D.check=m(D.check,K,2,0),R=z=0,D.mode=2;break}if(D.flags=0,D.head&&(D.head.done=!1),!(1&D.wrap)||(((255&z)<<8)+(z>>8))%31){L.msg="incorrect header check",D.mode=30;break}if((15&z)!=8){L.msg="unknown compression method",D.mode=30;break}if(R-=4,x=8+(15&(z>>>=4)),D.wbits===0)D.wbits=x;else if(x>D.wbits){L.msg="invalid window size",D.mode=30;break}D.dmax=1<<x,L.adler=D.check=1,D.mode=512&z?10:12,R=z=0;break;case 2:for(;R<16;){if(W===0)break e;W--,z+=ie[Y++]<<R,R+=8}if(D.flags=z,(255&D.flags)!=8){L.msg="unknown compression method",D.mode=30;break}if(57344&D.flags){L.msg="unknown header flags set",D.mode=30;break}D.head&&(D.head.text=z>>8&1),512&D.flags&&(K[0]=255&z,K[1]=z>>>8&255,D.check=m(D.check,K,2,0)),R=z=0,D.mode=3;case 3:for(;R<32;){if(W===0)break e;W--,z+=ie[Y++]<<R,R+=8}D.head&&(D.head.time=z),512&D.flags&&(K[0]=255&z,K[1]=z>>>8&255,K[2]=z>>>16&255,K[3]=z>>>24&255,D.check=m(D.check,K,4,0)),R=z=0,D.mode=4;case 4:for(;R<16;){if(W===0)break e;W--,z+=ie[Y++]<<R,R+=8}D.head&&(D.head.xflags=255&z,D.head.os=z>>8),512&D.flags&&(K[0]=255&z,K[1]=z>>>8&255,D.check=m(D.check,K,2,0)),R=z=0,D.mode=5;case 5:if(1024&D.flags){for(;R<16;){if(W===0)break e;W--,z+=ie[Y++]<<R,R+=8}D.length=z,D.head&&(D.head.extra_len=z),512&D.flags&&(K[0]=255&z,K[1]=z>>>8&255,D.check=m(D.check,K,2,0)),R=z=0}else D.head&&(D.head.extra=null);D.mode=6;case 6:if(1024&D.flags&&(W<(he=D.length)&&(he=W),he&&(D.head&&(x=D.head.extra_len-D.length,D.head.extra||(D.head.extra=new Array(D.head.extra_len)),c.arraySet(D.head.extra,ie,Y,he,x)),512&D.flags&&(D.check=m(D.check,ie,he,Y)),W-=he,Y+=he,D.length-=he),D.length))break e;D.length=0,D.mode=7;case 7:if(2048&D.flags){if(W===0)break e;for(he=0;x=ie[Y+he++],D.head&&x&&D.length<65536&&(D.head.name+=String.fromCharCode(x)),x&&he<W;);if(512&D.flags&&(D.check=m(D.check,ie,he,Y)),W-=he,Y+=he,x)break e}else D.head&&(D.head.name=null);D.length=0,D.mode=8;case 8:if(4096&D.flags){if(W===0)break e;for(he=0;x=ie[Y+he++],D.head&&x&&D.length<65536&&(D.head.comment+=String.fromCharCode(x)),x&&he<W;);if(512&D.flags&&(D.check=m(D.check,ie,he,Y)),W-=he,Y+=he,x)break e}else D.head&&(D.head.comment=null);D.mode=9;case 9:if(512&D.flags){for(;R<16;){if(W===0)break e;W--,z+=ie[Y++]<<R,R+=8}if(z!==(65535&D.check)){L.msg="header crc mismatch",D.mode=30;break}R=z=0}D.head&&(D.head.hcrc=D.flags>>9&1,D.head.done=!0),L.adler=D.check=0,D.mode=12;break;case 10:for(;R<32;){if(W===0)break e;W--,z+=ie[Y++]<<R,R+=8}L.adler=D.check=N(z),R=z=0,D.mode=11;case 11:if(D.havedict===0)return L.next_out=me,L.avail_out=be,L.next_in=Y,L.avail_in=W,D.hold=z,D.bits=R,2;L.adler=D.check=1,D.mode=12;case 12:if(J===5||J===6)break e;case 13:if(D.last){z>>>=7&R,R-=7&R,D.mode=27;break}for(;R<3;){if(W===0)break e;W--,z+=ie[Y++]<<R,R+=8}switch(D.last=1&z,R-=1,3&(z>>>=1)){case 0:D.mode=14;break;case 1:if(B(D),D.mode=20,J!==6)break;z>>>=2,R-=2;break e;case 2:D.mode=17;break;case 3:L.msg="invalid block type",D.mode=30}z>>>=2,R-=2;break;case 14:for(z>>>=7&R,R-=7&R;R<32;){if(W===0)break e;W--,z+=ie[Y++]<<R,R+=8}if((65535&z)!=(z>>>16^65535)){L.msg="invalid stored block lengths",D.mode=30;break}if(D.length=65535&z,R=z=0,D.mode=15,J===6)break e;case 15:D.mode=16;case 16:if(he=D.length){if(W<he&&(he=W),be<he&&(he=be),he===0)break e;c.arraySet(Z,ie,Y,he,me),W-=he,Y+=he,be-=he,me+=he,D.length-=he;break}D.mode=12;break;case 17:for(;R<14;){if(W===0)break e;W--,z+=ie[Y++]<<R,R+=8}if(D.nlen=257+(31&z),z>>>=5,R-=5,D.ndist=1+(31&z),z>>>=5,R-=5,D.ncode=4+(15&z),z>>>=4,R-=4,286<D.nlen||30<D.ndist){L.msg="too many length or distance symbols",D.mode=30;break}D.have=0,D.mode=18;case 18:for(;D.have<D.ncode;){for(;R<3;){if(W===0)break e;W--,z+=ie[Y++]<<R,R+=8}D.lens[ye[D.have++]]=7&z,z>>>=3,R-=3}for(;D.have<19;)D.lens[ye[D.have++]]=0;if(D.lencode=D.lendyn,D.lenbits=7,X={bits:D.lenbits},se=h(0,D.lens,0,19,D.lencode,0,D.work,X),D.lenbits=X.bits,se){L.msg="invalid code lengths set",D.mode=30;break}D.have=0,D.mode=19;case 19:for(;D.have<D.nlen+D.ndist;){for(;Ce=(P=D.lencode[z&(1<<D.lenbits)-1])>>>16&255,Ve=65535&P,!((Fe=P>>>24)<=R);){if(W===0)break e;W--,z+=ie[Y++]<<R,R+=8}if(Ve<16)z>>>=Fe,R-=Fe,D.lens[D.have++]=Ve;else{if(Ve===16){for($=Fe+2;R<$;){if(W===0)break e;W--,z+=ie[Y++]<<R,R+=8}if(z>>>=Fe,R-=Fe,D.have===0){L.msg="invalid bit length repeat",D.mode=30;break}x=D.lens[D.have-1],he=3+(3&z),z>>>=2,R-=2}else if(Ve===17){for($=Fe+3;R<$;){if(W===0)break e;W--,z+=ie[Y++]<<R,R+=8}R-=Fe,x=0,he=3+(7&(z>>>=Fe)),z>>>=3,R-=3}else{for($=Fe+7;R<$;){if(W===0)break e;W--,z+=ie[Y++]<<R,R+=8}R-=Fe,x=0,he=11+(127&(z>>>=Fe)),z>>>=7,R-=7}if(D.have+he>D.nlen+D.ndist){L.msg="invalid bit length repeat",D.mode=30;break}for(;he--;)D.lens[D.have++]=x}}if(D.mode===30)break;if(D.lens[256]===0){L.msg="invalid code -- missing end-of-block",D.mode=30;break}if(D.lenbits=9,X={bits:D.lenbits},se=h(v,D.lens,0,D.nlen,D.lencode,0,D.work,X),D.lenbits=X.bits,se){L.msg="invalid literal/lengths set",D.mode=30;break}if(D.distbits=6,D.distcode=D.distdyn,X={bits:D.distbits},se=h(S,D.lens,D.nlen,D.ndist,D.distcode,0,D.work,X),D.distbits=X.bits,se){L.msg="invalid distances set",D.mode=30;break}if(D.mode=20,J===6)break e;case 20:D.mode=21;case 21:if(6<=W&&258<=be){L.next_out=me,L.avail_out=be,L.next_in=Y,L.avail_in=W,D.hold=z,D.bits=R,p(L,oe),me=L.next_out,Z=L.output,be=L.avail_out,Y=L.next_in,ie=L.input,W=L.avail_in,z=D.hold,R=D.bits,D.mode===12&&(D.back=-1);break}for(D.back=0;Ce=(P=D.lencode[z&(1<<D.lenbits)-1])>>>16&255,Ve=65535&P,!((Fe=P>>>24)<=R);){if(W===0)break e;W--,z+=ie[Y++]<<R,R+=8}if(Ce&&(240&Ce)==0){for(Qe=Fe,ue=Ce,de=Ve;Ce=(P=D.lencode[de+((z&(1<<Qe+ue)-1)>>Qe)])>>>16&255,Ve=65535&P,!(Qe+(Fe=P>>>24)<=R);){if(W===0)break e;W--,z+=ie[Y++]<<R,R+=8}z>>>=Qe,R-=Qe,D.back+=Qe}if(z>>>=Fe,R-=Fe,D.back+=Fe,D.length=Ve,Ce===0){D.mode=26;break}if(32&Ce){D.back=-1,D.mode=12;break}if(64&Ce){L.msg="invalid literal/length code",D.mode=30;break}D.extra=15&Ce,D.mode=22;case 22:if(D.extra){for($=D.extra;R<$;){if(W===0)break e;W--,z+=ie[Y++]<<R,R+=8}D.length+=z&(1<<D.extra)-1,z>>>=D.extra,R-=D.extra,D.back+=D.extra}D.was=D.length,D.mode=23;case 23:for(;Ce=(P=D.distcode[z&(1<<D.distbits)-1])>>>16&255,Ve=65535&P,!((Fe=P>>>24)<=R);){if(W===0)break e;W--,z+=ie[Y++]<<R,R+=8}if((240&Ce)==0){for(Qe=Fe,ue=Ce,de=Ve;Ce=(P=D.distcode[de+((z&(1<<Qe+ue)-1)>>Qe)])>>>16&255,Ve=65535&P,!(Qe+(Fe=P>>>24)<=R);){if(W===0)break e;W--,z+=ie[Y++]<<R,R+=8}z>>>=Qe,R-=Qe,D.back+=Qe}if(z>>>=Fe,R-=Fe,D.back+=Fe,64&Ce){L.msg="invalid distance code",D.mode=30;break}D.offset=Ve,D.extra=15&Ce,D.mode=24;case 24:if(D.extra){for($=D.extra;R<$;){if(W===0)break e;W--,z+=ie[Y++]<<R,R+=8}D.offset+=z&(1<<D.extra)-1,z>>>=D.extra,R-=D.extra,D.back+=D.extra}if(D.offset>D.dmax){L.msg="invalid distance too far back",D.mode=30;break}D.mode=25;case 25:if(be===0)break e;if(he=oe-be,D.offset>he){if((he=D.offset-he)>D.whave&&D.sane){L.msg="invalid distance too far back",D.mode=30;break}fe=he>D.wnext?(he-=D.wnext,D.wsize-he):D.wnext-he,he>D.length&&(he=D.length),Me=D.window}else Me=Z,fe=me-D.offset,he=D.length;for(be<he&&(he=be),be-=he,D.length-=he;Z[me++]=Me[fe++],--he;);D.length===0&&(D.mode=21);break;case 26:if(be===0)break e;Z[me++]=D.length,be--,D.mode=21;break;case 27:if(D.wrap){for(;R<32;){if(W===0)break e;W--,z|=ie[Y++]<<R,R+=8}if(oe-=be,L.total_out+=oe,D.total+=oe,oe&&(L.adler=D.check=D.flags?m(D.check,Z,oe,me-oe):d(D.check,Z,oe,me-oe)),oe=be,(D.flags?z:N(z))!==D.check){L.msg="incorrect data check",D.mode=30;break}R=z=0}D.mode=28;case 28:if(D.wrap&&D.flags){for(;R<32;){if(W===0)break e;W--,z+=ie[Y++]<<R,R+=8}if(z!==(4294967295&D.total)){L.msg="incorrect length check",D.mode=30;break}R=z=0}D.mode=29;case 29:se=1;break e;case 30:se=-3;break e;case 31:return-4;case 32:default:return _}return L.next_out=me,L.avail_out=be,L.next_in=Y,L.avail_in=W,D.hold=z,D.bits=R,(D.wsize||oe!==L.avail_out&&D.mode<30&&(D.mode<27||J!==4))&&te(L,L.output,L.next_out,oe-L.avail_out)?(D.mode=31,-4):(re-=L.avail_in,oe-=L.avail_out,L.total_in+=re,L.total_out+=oe,D.total+=oe,D.wrap&&oe&&(L.adler=D.check=D.flags?m(D.check,Z,oe,L.next_out-oe):d(D.check,Z,oe,L.next_out-oe)),L.data_type=D.bits+(D.last?64:0)+(D.mode===12?128:0)+(D.mode===20||D.mode===15?256:0),(re==0&&oe===0||J===4)&&se===A&&(se=-5),se)},l.inflateEnd=function(L){if(!L||!L.state)return _;var J=L.state;return J.window&&(J.window=null),L.state=null,A},l.inflateGetHeader=function(L,J){var D;return L&&L.state?(2&(D=L.state).wrap)==0?_:((D.head=J).done=!1,A):_},l.inflateSetDictionary=function(L,J){var D,ie=J.length;return L&&L.state?(D=L.state).wrap!==0&&D.mode!==11?_:D.mode===11&&d(1,J,ie,0)!==D.check?-3:te(L,J,ie,ie)?(D.mode=31,-4):(D.havedict=1,A):_},l.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(s,i,l){var c=s("../utils/common"),d=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],m=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],p=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],h=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];i.exports=function(v,S,A,_,E,w,k,N){var I,M,F,q,Q,U,j,O,B,te=N.bits,L=0,J=0,D=0,ie=0,Z=0,Y=0,me=0,W=0,be=0,z=0,R=null,re=0,oe=new c.Buf16(16),he=new c.Buf16(16),fe=null,Me=0;for(L=0;L<=15;L++)oe[L]=0;for(J=0;J<_;J++)oe[S[A+J]]++;for(Z=te,ie=15;1<=ie&&oe[ie]===0;ie--);if(ie<Z&&(Z=ie),ie===0)return E[w++]=20971520,E[w++]=20971520,N.bits=1,0;for(D=1;D<ie&&oe[D]===0;D++);for(Z<D&&(Z=D),L=W=1;L<=15;L++)if(W<<=1,(W-=oe[L])<0)return-1;if(0<W&&(v===0||ie!==1))return-1;for(he[1]=0,L=1;L<15;L++)he[L+1]=he[L]+oe[L];for(J=0;J<_;J++)S[A+J]!==0&&(k[he[S[A+J]]++]=J);if(U=v===0?(R=fe=k,19):v===1?(R=d,re-=257,fe=m,Me-=257,256):(R=p,fe=h,-1),L=D,Q=w,me=J=z=0,F=-1,q=(be=1<<(Y=Z))-1,v===1&&852<be||v===2&&592<be)return 1;for(;;){for(j=L-me,B=k[J]<U?(O=0,k[J]):k[J]>U?(O=fe[Me+k[J]],R[re+k[J]]):(O=96,0),I=1<<L-me,D=M=1<<Y;E[Q+(z>>me)+(M-=I)]=j<<24|O<<16|B|0,M!==0;);for(I=1<<L-1;z&I;)I>>=1;if(I!==0?(z&=I-1,z+=I):z=0,J++,--oe[L]==0){if(L===ie)break;L=S[A+k[J]]}if(Z<L&&(z&q)!==F){for(me===0&&(me=Z),Q+=D,W=1<<(Y=L-me);Y+me<ie&&!((W-=oe[Y+me])<=0);)Y++,W<<=1;if(be+=1<<Y,v===1&&852<be||v===2&&592<be)return 1;E[F=z&q]=Z<<24|Y<<16|Q-w|0}}return z!==0&&(E[Q+z]=L-me<<24|64<<16|0),N.bits=Z,0}},{"../utils/common":41}],51:[function(s,i,l){i.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(s,i,l){var c=s("../utils/common"),d=0,m=1;function p(P){for(var K=P.length;0<=--K;)P[K]=0}var h=0,v=29,S=256,A=S+1+v,_=30,E=19,w=2*A+1,k=15,N=16,I=7,M=256,F=16,q=17,Q=18,U=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],j=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],O=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],B=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],te=new Array(2*(A+2));p(te);var L=new Array(2*_);p(L);var J=new Array(512);p(J);var D=new Array(256);p(D);var ie=new Array(v);p(ie);var Z,Y,me,W=new Array(_);function be(P,K,ye,ve,ne){this.static_tree=P,this.extra_bits=K,this.extra_base=ye,this.elems=ve,this.max_length=ne,this.has_stree=P&&P.length}function z(P,K){this.dyn_tree=P,this.max_code=0,this.stat_desc=K}function R(P){return P<256?J[P]:J[256+(P>>>7)]}function re(P,K){P.pending_buf[P.pending++]=255&K,P.pending_buf[P.pending++]=K>>>8&255}function oe(P,K,ye){P.bi_valid>N-ye?(P.bi_buf|=K<<P.bi_valid&65535,re(P,P.bi_buf),P.bi_buf=K>>N-P.bi_valid,P.bi_valid+=ye-N):(P.bi_buf|=K<<P.bi_valid&65535,P.bi_valid+=ye)}function he(P,K,ye){oe(P,ye[2*K],ye[2*K+1])}function fe(P,K){for(var ye=0;ye|=1&P,P>>>=1,ye<<=1,0<--K;);return ye>>>1}function Me(P,K,ye){var ve,ne,ke=new Array(k+1),Oe=0;for(ve=1;ve<=k;ve++)ke[ve]=Oe=Oe+ye[ve-1]<<1;for(ne=0;ne<=K;ne++){var Te=P[2*ne+1];Te!==0&&(P[2*ne]=fe(ke[Te]++,Te))}}function Fe(P){var K;for(K=0;K<A;K++)P.dyn_ltree[2*K]=0;for(K=0;K<_;K++)P.dyn_dtree[2*K]=0;for(K=0;K<E;K++)P.bl_tree[2*K]=0;P.dyn_ltree[2*M]=1,P.opt_len=P.static_len=0,P.last_lit=P.matches=0}function Ce(P){8<P.bi_valid?re(P,P.bi_buf):0<P.bi_valid&&(P.pending_buf[P.pending++]=P.bi_buf),P.bi_buf=0,P.bi_valid=0}function Ve(P,K,ye,ve){var ne=2*K,ke=2*ye;return P[ne]<P[ke]||P[ne]===P[ke]&&ve[K]<=ve[ye]}function Qe(P,K,ye){for(var ve=P.heap[ye],ne=ye<<1;ne<=P.heap_len&&(ne<P.heap_len&&Ve(K,P.heap[ne+1],P.heap[ne],P.depth)&&ne++,!Ve(K,ve,P.heap[ne],P.depth));)P.heap[ye]=P.heap[ne],ye=ne,ne<<=1;P.heap[ye]=ve}function ue(P,K,ye){var ve,ne,ke,Oe,Te=0;if(P.last_lit!==0)for(;ve=P.pending_buf[P.d_buf+2*Te]<<8|P.pending_buf[P.d_buf+2*Te+1],ne=P.pending_buf[P.l_buf+Te],Te++,ve===0?he(P,ne,K):(he(P,(ke=D[ne])+S+1,K),(Oe=U[ke])!==0&&oe(P,ne-=ie[ke],Oe),he(P,ke=R(--ve),ye),(Oe=j[ke])!==0&&oe(P,ve-=W[ke],Oe)),Te<P.last_lit;);he(P,M,K)}function de(P,K){var ye,ve,ne,ke=K.dyn_tree,Oe=K.stat_desc.static_tree,Te=K.stat_desc.has_stree,He=K.stat_desc.elems,it=-1;for(P.heap_len=0,P.heap_max=w,ye=0;ye<He;ye++)ke[2*ye]!==0?(P.heap[++P.heap_len]=it=ye,P.depth[ye]=0):ke[2*ye+1]=0;for(;P.heap_len<2;)ke[2*(ne=P.heap[++P.heap_len]=it<2?++it:0)]=1,P.depth[ne]=0,P.opt_len--,Te&&(P.static_len-=Oe[2*ne+1]);for(K.max_code=it,ye=P.heap_len>>1;1<=ye;ye--)Qe(P,ke,ye);for(ne=He;ye=P.heap[1],P.heap[1]=P.heap[P.heap_len--],Qe(P,ke,1),ve=P.heap[1],P.heap[--P.heap_max]=ye,P.heap[--P.heap_max]=ve,ke[2*ne]=ke[2*ye]+ke[2*ve],P.depth[ne]=(P.depth[ye]>=P.depth[ve]?P.depth[ye]:P.depth[ve])+1,ke[2*ye+1]=ke[2*ve+1]=ne,P.heap[1]=ne++,Qe(P,ke,1),2<=P.heap_len;);P.heap[--P.heap_max]=P.heap[1],(function(at,Ot){var Zt,zt,qt,ht,bt,pn,It=Ot.dyn_tree,ya=Ot.max_code,dt=Ot.stat_desc.static_tree,Ya=Ot.stat_desc.has_stree,Nr=Ot.stat_desc.extra_bits,Ft=Ot.stat_desc.extra_base,cn=Ot.stat_desc.max_length,jn=0;for(ht=0;ht<=k;ht++)at.bl_count[ht]=0;for(It[2*at.heap[at.heap_max]+1]=0,Zt=at.heap_max+1;Zt<w;Zt++)cn<(ht=It[2*It[2*(zt=at.heap[Zt])+1]+1]+1)&&(ht=cn,jn++),It[2*zt+1]=ht,ya<zt||(at.bl_count[ht]++,bt=0,Ft<=zt&&(bt=Nr[zt-Ft]),pn=It[2*zt],at.opt_len+=pn*(ht+bt),Ya&&(at.static_len+=pn*(dt[2*zt+1]+bt)));if(jn!==0){do{for(ht=cn-1;at.bl_count[ht]===0;)ht--;at.bl_count[ht]--,at.bl_count[ht+1]+=2,at.bl_count[cn]--,jn-=2}while(0<jn);for(ht=cn;ht!==0;ht--)for(zt=at.bl_count[ht];zt!==0;)ya<(qt=at.heap[--Zt])||(It[2*qt+1]!==ht&&(at.opt_len+=(ht-It[2*qt+1])*It[2*qt],It[2*qt+1]=ht),zt--)}})(P,K),Me(ke,it,P.bl_count)}function x(P,K,ye){var ve,ne,ke=-1,Oe=K[1],Te=0,He=7,it=4;for(Oe===0&&(He=138,it=3),K[2*(ye+1)+1]=65535,ve=0;ve<=ye;ve++)ne=Oe,Oe=K[2*(ve+1)+1],++Te<He&&ne===Oe||(Te<it?P.bl_tree[2*ne]+=Te:ne!==0?(ne!==ke&&P.bl_tree[2*ne]++,P.bl_tree[2*F]++):Te<=10?P.bl_tree[2*q]++:P.bl_tree[2*Q]++,ke=ne,it=(Te=0)===Oe?(He=138,3):ne===Oe?(He=6,3):(He=7,4))}function se(P,K,ye){var ve,ne,ke=-1,Oe=K[1],Te=0,He=7,it=4;for(Oe===0&&(He=138,it=3),ve=0;ve<=ye;ve++)if(ne=Oe,Oe=K[2*(ve+1)+1],!(++Te<He&&ne===Oe)){if(Te<it)for(;he(P,ne,P.bl_tree),--Te!=0;);else ne!==0?(ne!==ke&&(he(P,ne,P.bl_tree),Te--),he(P,F,P.bl_tree),oe(P,Te-3,2)):Te<=10?(he(P,q,P.bl_tree),oe(P,Te-3,3)):(he(P,Q,P.bl_tree),oe(P,Te-11,7));ke=ne,it=(Te=0)===Oe?(He=138,3):ne===Oe?(He=6,3):(He=7,4)}}p(W);var X=!1;function $(P,K,ye,ve){oe(P,(h<<1)+(ve?1:0),3),(function(ne,ke,Oe,Te){Ce(ne),re(ne,Oe),re(ne,~Oe),c.arraySet(ne.pending_buf,ne.window,ke,Oe,ne.pending),ne.pending+=Oe})(P,K,ye)}l._tr_init=function(P){X||((function(){var K,ye,ve,ne,ke,Oe=new Array(k+1);for(ne=ve=0;ne<v-1;ne++)for(ie[ne]=ve,K=0;K<1<<U[ne];K++)D[ve++]=ne;for(D[ve-1]=ne,ne=ke=0;ne<16;ne++)for(W[ne]=ke,K=0;K<1<<j[ne];K++)J[ke++]=ne;for(ke>>=7;ne<_;ne++)for(W[ne]=ke<<7,K=0;K<1<<j[ne]-7;K++)J[256+ke++]=ne;for(ye=0;ye<=k;ye++)Oe[ye]=0;for(K=0;K<=143;)te[2*K+1]=8,K++,Oe[8]++;for(;K<=255;)te[2*K+1]=9,K++,Oe[9]++;for(;K<=279;)te[2*K+1]=7,K++,Oe[7]++;for(;K<=287;)te[2*K+1]=8,K++,Oe[8]++;for(Me(te,A+1,Oe),K=0;K<_;K++)L[2*K+1]=5,L[2*K]=fe(K,5);Z=new be(te,U,S+1,A,k),Y=new be(L,j,0,_,k),me=new be(new Array(0),O,0,E,I)})(),X=!0),P.l_desc=new z(P.dyn_ltree,Z),P.d_desc=new z(P.dyn_dtree,Y),P.bl_desc=new z(P.bl_tree,me),P.bi_buf=0,P.bi_valid=0,Fe(P)},l._tr_stored_block=$,l._tr_flush_block=function(P,K,ye,ve){var ne,ke,Oe=0;0<P.level?(P.strm.data_type===2&&(P.strm.data_type=(function(Te){var He,it=4093624447;for(He=0;He<=31;He++,it>>>=1)if(1&it&&Te.dyn_ltree[2*He]!==0)return d;if(Te.dyn_ltree[18]!==0||Te.dyn_ltree[20]!==0||Te.dyn_ltree[26]!==0)return m;for(He=32;He<S;He++)if(Te.dyn_ltree[2*He]!==0)return m;return d})(P)),de(P,P.l_desc),de(P,P.d_desc),Oe=(function(Te){var He;for(x(Te,Te.dyn_ltree,Te.l_desc.max_code),x(Te,Te.dyn_dtree,Te.d_desc.max_code),de(Te,Te.bl_desc),He=E-1;3<=He&&Te.bl_tree[2*B[He]+1]===0;He--);return Te.opt_len+=3*(He+1)+5+5+4,He})(P),ne=P.opt_len+3+7>>>3,(ke=P.static_len+3+7>>>3)<=ne&&(ne=ke)):ne=ke=ye+5,ye+4<=ne&&K!==-1?$(P,K,ye,ve):P.strategy===4||ke===ne?(oe(P,2+(ve?1:0),3),ue(P,te,L)):(oe(P,4+(ve?1:0),3),(function(Te,He,it,at){var Ot;for(oe(Te,He-257,5),oe(Te,it-1,5),oe(Te,at-4,4),Ot=0;Ot<at;Ot++)oe(Te,Te.bl_tree[2*B[Ot]+1],3);se(Te,Te.dyn_ltree,He-1),se(Te,Te.dyn_dtree,it-1)})(P,P.l_desc.max_code+1,P.d_desc.max_code+1,Oe+1),ue(P,P.dyn_ltree,P.dyn_dtree)),Fe(P),ve&&Ce(P)},l._tr_tally=function(P,K,ye){return P.pending_buf[P.d_buf+2*P.last_lit]=K>>>8&255,P.pending_buf[P.d_buf+2*P.last_lit+1]=255&K,P.pending_buf[P.l_buf+P.last_lit]=255&ye,P.last_lit++,K===0?P.dyn_ltree[2*ye]++:(P.matches++,K--,P.dyn_ltree[2*(D[ye]+S+1)]++,P.dyn_dtree[2*R(K)]++),P.last_lit===P.lit_bufsize-1},l._tr_align=function(P){oe(P,2,3),he(P,M,te),(function(K){K.bi_valid===16?(re(K,K.bi_buf),K.bi_buf=0,K.bi_valid=0):8<=K.bi_valid&&(K.pending_buf[K.pending++]=255&K.bi_buf,K.bi_buf>>=8,K.bi_valid-=8)})(P)}},{"../utils/common":41}],53:[function(s,i,l){i.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(s,i,l){(function(c){(function(d,m){if(!d.setImmediate){var p,h,v,S,A=1,_={},E=!1,w=d.document,k=Object.getPrototypeOf&&Object.getPrototypeOf(d);k=k&&k.setTimeout?k:d,p={}.toString.call(d.process)==="[object process]"?function(F){process.nextTick(function(){I(F)})}:(function(){if(d.postMessage&&!d.importScripts){var F=!0,q=d.onmessage;return d.onmessage=function(){F=!1},d.postMessage("","*"),d.onmessage=q,F}})()?(S="setImmediate$"+Math.random()+"$",d.addEventListener?d.addEventListener("message",M,!1):d.attachEvent("onmessage",M),function(F){d.postMessage(S+F,"*")}):d.MessageChannel?((v=new MessageChannel).port1.onmessage=function(F){I(F.data)},function(F){v.port2.postMessage(F)}):w&&"onreadystatechange"in w.createElement("script")?(h=w.documentElement,function(F){var q=w.createElement("script");q.onreadystatechange=function(){I(F),q.onreadystatechange=null,h.removeChild(q),q=null},h.appendChild(q)}):function(F){setTimeout(I,0,F)},k.setImmediate=function(F){typeof F!="function"&&(F=new Function(""+F));for(var q=new Array(arguments.length-1),Q=0;Q<q.length;Q++)q[Q]=arguments[Q+1];var U={callback:F,args:q};return _[A]=U,p(A),A++},k.clearImmediate=N}function N(F){delete _[F]}function I(F){if(E)setTimeout(I,0,F);else{var q=_[F];if(q){E=!0;try{(function(Q){var U=Q.callback,j=Q.args;switch(j.length){case 0:U();break;case 1:U(j[0]);break;case 2:U(j[0],j[1]);break;case 3:U(j[0],j[1],j[2]);break;default:U.apply(m,j)}})(q)}finally{N(F),E=!1}}}}function M(F){F.source===d&&typeof F.data=="string"&&F.data.indexOf(S)===0&&I(+F.data.slice(S.length))}})(typeof self>"u"?c===void 0?this:c:self)}).call(this,typeof Pc<"u"?Pc:typeof self<"u"?self:typeof window<"u"?window:{})},{}]},{},[10])(10)})})(th)),th.exports}var j1=O1();const qh=io(j1);var iu={exports:{}};/* @license
Papa Parse
v5.4.1
https://github.com/mholt/PapaParse
License: MIT
*/var I1=iu.exports,Ly;function R1(){return Ly||(Ly=1,(function(n,a){(function(s,i){n.exports=i()})(I1,function s(){var i=typeof self<"u"?self:typeof window<"u"?window:i!==void 0?i:{},l=!i.document&&!!i.postMessage,c=i.IS_PAPA_WORKER||!1,d={},m=0,p={parse:function(j,O){var B=(O=O||{}).dynamicTyping||!1;if(U(B)&&(O.dynamicTypingFunction=B,B={}),O.dynamicTyping=B,O.transform=!!U(O.transform)&&O.transform,O.worker&&p.WORKERS_SUPPORTED){var te=(function(){if(!p.WORKERS_SUPPORTED)return!1;var J=(ie=i.URL||i.webkitURL||null,Z=s.toString(),p.BLOB_URL||(p.BLOB_URL=ie.createObjectURL(new Blob(["var global = (function() { if (typeof self !== 'undefined') { return self; } if (typeof window !== 'undefined') { return window; } if (typeof global !== 'undefined') { return global; } return {}; })(); global.IS_PAPA_WORKER=true; ","(",Z,")();"],{type:"text/javascript"})))),D=new i.Worker(J),ie,Z;return D.onmessage=I,D.id=m++,d[D.id]=D})();return te.userStep=O.step,te.userChunk=O.chunk,te.userComplete=O.complete,te.userError=O.error,O.step=U(O.step),O.chunk=U(O.chunk),O.complete=U(O.complete),O.error=U(O.error),delete O.worker,void te.postMessage({input:j,config:O,workerId:te.id})}var L=null;return p.NODE_STREAM_INPUT,typeof j=="string"?(j=(function(J){return J.charCodeAt(0)===65279?J.slice(1):J})(j),L=O.download?new S(O):new _(O)):j.readable===!0&&U(j.read)&&U(j.on)?L=new E(O):(i.File&&j instanceof File||j instanceof Object)&&(L=new A(O)),L.stream(j)},unparse:function(j,O){var B=!1,te=!0,L=",",J=`\r
`,D='"',ie=D+D,Z=!1,Y=null,me=!1;(function(){if(typeof O=="object"){if(typeof O.delimiter!="string"||p.BAD_DELIMITERS.filter(function(R){return O.delimiter.indexOf(R)!==-1}).length||(L=O.delimiter),(typeof O.quotes=="boolean"||typeof O.quotes=="function"||Array.isArray(O.quotes))&&(B=O.quotes),typeof O.skipEmptyLines!="boolean"&&typeof O.skipEmptyLines!="string"||(Z=O.skipEmptyLines),typeof O.newline=="string"&&(J=O.newline),typeof O.quoteChar=="string"&&(D=O.quoteChar),typeof O.header=="boolean"&&(te=O.header),Array.isArray(O.columns)){if(O.columns.length===0)throw new Error("Option columns is empty");Y=O.columns}O.escapeChar!==void 0&&(ie=O.escapeChar+D),(typeof O.escapeFormulae=="boolean"||O.escapeFormulae instanceof RegExp)&&(me=O.escapeFormulae instanceof RegExp?O.escapeFormulae:/^[=+\-@\t\r].*$/)}})();var W=new RegExp(k(D),"g");if(typeof j=="string"&&(j=JSON.parse(j)),Array.isArray(j)){if(!j.length||Array.isArray(j[0]))return be(null,j,Z);if(typeof j[0]=="object")return be(Y||Object.keys(j[0]),j,Z)}else if(typeof j=="object")return typeof j.data=="string"&&(j.data=JSON.parse(j.data)),Array.isArray(j.data)&&(j.fields||(j.fields=j.meta&&j.meta.fields||Y),j.fields||(j.fields=Array.isArray(j.data[0])?j.fields:typeof j.data[0]=="object"?Object.keys(j.data[0]):[]),Array.isArray(j.data[0])||typeof j.data[0]=="object"||(j.data=[j.data])),be(j.fields||[],j.data||[],Z);throw new Error("Unable to serialize unrecognized input");function be(R,re,oe){var he="";typeof R=="string"&&(R=JSON.parse(R)),typeof re=="string"&&(re=JSON.parse(re));var fe=Array.isArray(R)&&0<R.length,Me=!Array.isArray(re[0]);if(fe&&te){for(var Fe=0;Fe<R.length;Fe++)0<Fe&&(he+=L),he+=z(R[Fe],Fe);0<re.length&&(he+=J)}for(var Ce=0;Ce<re.length;Ce++){var Ve=fe?R.length:re[Ce].length,Qe=!1,ue=fe?Object.keys(re[Ce]).length===0:re[Ce].length===0;if(oe&&!fe&&(Qe=oe==="greedy"?re[Ce].join("").trim()==="":re[Ce].length===1&&re[Ce][0].length===0),oe==="greedy"&&fe){for(var de=[],x=0;x<Ve;x++){var se=Me?R[x]:x;de.push(re[Ce][se])}Qe=de.join("").trim()===""}if(!Qe){for(var X=0;X<Ve;X++){0<X&&!ue&&(he+=L);var $=fe&&Me?R[X]:X;he+=z(re[Ce][$],X)}Ce<re.length-1&&(!oe||0<Ve&&!ue)&&(he+=J)}}return he}function z(R,re){if(R==null)return"";if(R.constructor===Date)return JSON.stringify(R).slice(1,25);var oe=!1;me&&typeof R=="string"&&me.test(R)&&(R="'"+R,oe=!0);var he=R.toString().replace(W,ie);return(oe=oe||B===!0||typeof B=="function"&&B(R,re)||Array.isArray(B)&&B[re]||(function(fe,Me){for(var Fe=0;Fe<Me.length;Fe++)if(-1<fe.indexOf(Me[Fe]))return!0;return!1})(he,p.BAD_DELIMITERS)||-1<he.indexOf(L)||he.charAt(0)===" "||he.charAt(he.length-1)===" ")?D+he+D:he}}};if(p.RECORD_SEP="",p.UNIT_SEP="",p.BYTE_ORDER_MARK="\uFEFF",p.BAD_DELIMITERS=["\r",`
`,'"',p.BYTE_ORDER_MARK],p.WORKERS_SUPPORTED=!l&&!!i.Worker,p.NODE_STREAM_INPUT=1,p.LocalChunkSize=10485760,p.RemoteChunkSize=5242880,p.DefaultDelimiter=",",p.Parser=N,p.ParserHandle=w,p.NetworkStreamer=S,p.FileStreamer=A,p.StringStreamer=_,p.ReadableStreamStreamer=E,i.jQuery){var h=i.jQuery;h.fn.parse=function(j){var O=j.config||{},B=[];return this.each(function(J){if(!(h(this).prop("tagName").toUpperCase()==="INPUT"&&h(this).attr("type").toLowerCase()==="file"&&i.FileReader)||!this.files||this.files.length===0)return!0;for(var D=0;D<this.files.length;D++)B.push({file:this.files[D],inputElem:this,instanceConfig:h.extend({},O)})}),te(),this;function te(){if(B.length!==0){var J,D,ie,Z,Y=B[0];if(U(j.before)){var me=j.before(Y.file,Y.inputElem);if(typeof me=="object"){if(me.action==="abort")return J="AbortError",D=Y.file,ie=Y.inputElem,Z=me.reason,void(U(j.error)&&j.error({name:J},D,ie,Z));if(me.action==="skip")return void L();typeof me.config=="object"&&(Y.instanceConfig=h.extend(Y.instanceConfig,me.config))}else if(me==="skip")return void L()}var W=Y.instanceConfig.complete;Y.instanceConfig.complete=function(be){U(W)&&W(be,Y.file,Y.inputElem),L()},p.parse(Y.file,Y.instanceConfig)}else U(j.complete)&&j.complete()}function L(){B.splice(0,1),te()}}}function v(j){this._handle=null,this._finished=!1,this._completed=!1,this._halted=!1,this._input=null,this._baseIndex=0,this._partialLine="",this._rowCount=0,this._start=0,this._nextChunk=null,this.isFirstChunk=!0,this._completeResults={data:[],errors:[],meta:{}},(function(O){var B=q(O);B.chunkSize=parseInt(B.chunkSize),O.step||O.chunk||(B.chunkSize=null),this._handle=new w(B),(this._handle.streamer=this)._config=B}).call(this,j),this.parseChunk=function(O,B){if(this.isFirstChunk&&U(this._config.beforeFirstChunk)){var te=this._config.beforeFirstChunk(O);te!==void 0&&(O=te)}this.isFirstChunk=!1,this._halted=!1;var L=this._partialLine+O;this._partialLine="";var J=this._handle.parse(L,this._baseIndex,!this._finished);if(!this._handle.paused()&&!this._handle.aborted()){var D=J.meta.cursor;this._finished||(this._partialLine=L.substring(D-this._baseIndex),this._baseIndex=D),J&&J.data&&(this._rowCount+=J.data.length);var ie=this._finished||this._config.preview&&this._rowCount>=this._config.preview;if(c)i.postMessage({results:J,workerId:p.WORKER_ID,finished:ie});else if(U(this._config.chunk)&&!B){if(this._config.chunk(J,this._handle),this._handle.paused()||this._handle.aborted())return void(this._halted=!0);J=void 0,this._completeResults=void 0}return this._config.step||this._config.chunk||(this._completeResults.data=this._completeResults.data.concat(J.data),this._completeResults.errors=this._completeResults.errors.concat(J.errors),this._completeResults.meta=J.meta),this._completed||!ie||!U(this._config.complete)||J&&J.meta.aborted||(this._config.complete(this._completeResults,this._input),this._completed=!0),ie||J&&J.meta.paused||this._nextChunk(),J}this._halted=!0},this._sendError=function(O){U(this._config.error)?this._config.error(O):c&&this._config.error&&i.postMessage({workerId:p.WORKER_ID,error:O,finished:!1})}}function S(j){var O;(j=j||{}).chunkSize||(j.chunkSize=p.RemoteChunkSize),v.call(this,j),this._nextChunk=l?function(){this._readChunk(),this._chunkLoaded()}:function(){this._readChunk()},this.stream=function(B){this._input=B,this._nextChunk()},this._readChunk=function(){if(this._finished)this._chunkLoaded();else{if(O=new XMLHttpRequest,this._config.withCredentials&&(O.withCredentials=this._config.withCredentials),l||(O.onload=Q(this._chunkLoaded,this),O.onerror=Q(this._chunkError,this)),O.open(this._config.downloadRequestBody?"POST":"GET",this._input,!l),this._config.downloadRequestHeaders){var B=this._config.downloadRequestHeaders;for(var te in B)O.setRequestHeader(te,B[te])}if(this._config.chunkSize){var L=this._start+this._config.chunkSize-1;O.setRequestHeader("Range","bytes="+this._start+"-"+L)}try{O.send(this._config.downloadRequestBody)}catch(J){this._chunkError(J.message)}l&&O.status===0&&this._chunkError()}},this._chunkLoaded=function(){O.readyState===4&&(O.status<200||400<=O.status?this._chunkError():(this._start+=this._config.chunkSize?this._config.chunkSize:O.responseText.length,this._finished=!this._config.chunkSize||this._start>=(function(B){var te=B.getResponseHeader("Content-Range");return te===null?-1:parseInt(te.substring(te.lastIndexOf("/")+1))})(O),this.parseChunk(O.responseText)))},this._chunkError=function(B){var te=O.statusText||B;this._sendError(new Error(te))}}function A(j){var O,B;(j=j||{}).chunkSize||(j.chunkSize=p.LocalChunkSize),v.call(this,j);var te=typeof FileReader<"u";this.stream=function(L){this._input=L,B=L.slice||L.webkitSlice||L.mozSlice,te?((O=new FileReader).onload=Q(this._chunkLoaded,this),O.onerror=Q(this._chunkError,this)):O=new FileReaderSync,this._nextChunk()},this._nextChunk=function(){this._finished||this._config.preview&&!(this._rowCount<this._config.preview)||this._readChunk()},this._readChunk=function(){var L=this._input;if(this._config.chunkSize){var J=Math.min(this._start+this._config.chunkSize,this._input.size);L=B.call(L,this._start,J)}var D=O.readAsText(L,this._config.encoding);te||this._chunkLoaded({target:{result:D}})},this._chunkLoaded=function(L){this._start+=this._config.chunkSize,this._finished=!this._config.chunkSize||this._start>=this._input.size,this.parseChunk(L.target.result)},this._chunkError=function(){this._sendError(O.error)}}function _(j){var O;v.call(this,j=j||{}),this.stream=function(B){return O=B,this._nextChunk()},this._nextChunk=function(){if(!this._finished){var B,te=this._config.chunkSize;return te?(B=O.substring(0,te),O=O.substring(te)):(B=O,O=""),this._finished=!O,this.parseChunk(B)}}}function E(j){v.call(this,j=j||{});var O=[],B=!0,te=!1;this.pause=function(){v.prototype.pause.apply(this,arguments),this._input.pause()},this.resume=function(){v.prototype.resume.apply(this,arguments),this._input.resume()},this.stream=function(L){this._input=L,this._input.on("data",this._streamData),this._input.on("end",this._streamEnd),this._input.on("error",this._streamError)},this._checkIsFinished=function(){te&&O.length===1&&(this._finished=!0)},this._nextChunk=function(){this._checkIsFinished(),O.length?this.parseChunk(O.shift()):B=!0},this._streamData=Q(function(L){try{O.push(typeof L=="string"?L:L.toString(this._config.encoding)),B&&(B=!1,this._checkIsFinished(),this.parseChunk(O.shift()))}catch(J){this._streamError(J)}},this),this._streamError=Q(function(L){this._streamCleanUp(),this._sendError(L)},this),this._streamEnd=Q(function(){this._streamCleanUp(),te=!0,this._streamData("")},this),this._streamCleanUp=Q(function(){this._input.removeListener("data",this._streamData),this._input.removeListener("end",this._streamEnd),this._input.removeListener("error",this._streamError)},this)}function w(j){var O,B,te,L=Math.pow(2,53),J=-L,D=/^\s*-?(\d+\.?|\.\d+|\d+\.\d+)([eE][-+]?\d+)?\s*$/,ie=/^((\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z)))$/,Z=this,Y=0,me=0,W=!1,be=!1,z=[],R={data:[],errors:[],meta:{}};if(U(j.step)){var re=j.step;j.step=function(Ce){if(R=Ce,fe())he();else{if(he(),R.data.length===0)return;Y+=Ce.data.length,j.preview&&Y>j.preview?B.abort():(R.data=R.data[0],re(R,Z))}}}function oe(Ce){return j.skipEmptyLines==="greedy"?Ce.join("").trim()==="":Ce.length===1&&Ce[0].length===0}function he(){return R&&te&&(Fe("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to '"+p.DefaultDelimiter+"'"),te=!1),j.skipEmptyLines&&(R.data=R.data.filter(function(Ce){return!oe(Ce)})),fe()&&(function(){if(!R)return;function Ce(Qe,ue){U(j.transformHeader)&&(Qe=j.transformHeader(Qe,ue)),z.push(Qe)}if(Array.isArray(R.data[0])){for(var Ve=0;fe()&&Ve<R.data.length;Ve++)R.data[Ve].forEach(Ce);R.data.splice(0,1)}else R.data.forEach(Ce)})(),(function(){if(!R||!j.header&&!j.dynamicTyping&&!j.transform)return R;function Ce(Qe,ue){var de,x=j.header?{}:[];for(de=0;de<Qe.length;de++){var se=de,X=Qe[de];j.header&&(se=de>=z.length?"__parsed_extra":z[de]),j.transform&&(X=j.transform(X,se)),X=Me(se,X),se==="__parsed_extra"?(x[se]=x[se]||[],x[se].push(X)):x[se]=X}return j.header&&(de>z.length?Fe("FieldMismatch","TooManyFields","Too many fields: expected "+z.length+" fields but parsed "+de,me+ue):de<z.length&&Fe("FieldMismatch","TooFewFields","Too few fields: expected "+z.length+" fields but parsed "+de,me+ue)),x}var Ve=1;return!R.data.length||Array.isArray(R.data[0])?(R.data=R.data.map(Ce),Ve=R.data.length):R.data=Ce(R.data,0),j.header&&R.meta&&(R.meta.fields=z),me+=Ve,R})()}function fe(){return j.header&&z.length===0}function Me(Ce,Ve){return Qe=Ce,j.dynamicTypingFunction&&j.dynamicTyping[Qe]===void 0&&(j.dynamicTyping[Qe]=j.dynamicTypingFunction(Qe)),(j.dynamicTyping[Qe]||j.dynamicTyping)===!0?Ve==="true"||Ve==="TRUE"||Ve!=="false"&&Ve!=="FALSE"&&((function(ue){if(D.test(ue)){var de=parseFloat(ue);if(J<de&&de<L)return!0}return!1})(Ve)?parseFloat(Ve):ie.test(Ve)?new Date(Ve):Ve===""?null:Ve):Ve;var Qe}function Fe(Ce,Ve,Qe,ue){var de={type:Ce,code:Ve,message:Qe};ue!==void 0&&(de.row=ue),R.errors.push(de)}this.parse=function(Ce,Ve,Qe){var ue=j.quoteChar||'"';if(j.newline||(j.newline=(function(se,X){se=se.substring(0,1048576);var $=new RegExp(k(X)+"([^]*?)"+k(X),"gm"),P=(se=se.replace($,"")).split("\r"),K=se.split(`
`),ye=1<K.length&&K[0].length<P[0].length;if(P.length===1||ye)return`
`;for(var ve=0,ne=0;ne<P.length;ne++)P[ne][0]===`
`&&ve++;return ve>=P.length/2?`\r
`:"\r"})(Ce,ue)),te=!1,j.delimiter)U(j.delimiter)&&(j.delimiter=j.delimiter(Ce),R.meta.delimiter=j.delimiter);else{var de=(function(se,X,$,P,K){var ye,ve,ne,ke;K=K||[",","	","|",";",p.RECORD_SEP,p.UNIT_SEP];for(var Oe=0;Oe<K.length;Oe++){var Te=K[Oe],He=0,it=0,at=0;ne=void 0;for(var Ot=new N({comments:P,delimiter:Te,newline:X,preview:10}).parse(se),Zt=0;Zt<Ot.data.length;Zt++)if($&&oe(Ot.data[Zt]))at++;else{var zt=Ot.data[Zt].length;it+=zt,ne!==void 0?0<zt&&(He+=Math.abs(zt-ne),ne=zt):ne=zt}0<Ot.data.length&&(it/=Ot.data.length-at),(ve===void 0||He<=ve)&&(ke===void 0||ke<it)&&1.99<it&&(ve=He,ye=Te,ke=it)}return{successful:!!(j.delimiter=ye),bestDelimiter:ye}})(Ce,j.newline,j.skipEmptyLines,j.comments,j.delimitersToGuess);de.successful?j.delimiter=de.bestDelimiter:(te=!0,j.delimiter=p.DefaultDelimiter),R.meta.delimiter=j.delimiter}var x=q(j);return j.preview&&j.header&&x.preview++,O=Ce,B=new N(x),R=B.parse(O,Ve,Qe),he(),W?{meta:{paused:!0}}:R||{meta:{paused:!1}}},this.paused=function(){return W},this.pause=function(){W=!0,B.abort(),O=U(j.chunk)?"":O.substring(B.getCharIndex())},this.resume=function(){Z.streamer._halted?(W=!1,Z.streamer.parseChunk(O,!0)):setTimeout(Z.resume,3)},this.aborted=function(){return be},this.abort=function(){be=!0,B.abort(),R.meta.aborted=!0,U(j.complete)&&j.complete(R),O=""}}function k(j){return j.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function N(j){var O,B=(j=j||{}).delimiter,te=j.newline,L=j.comments,J=j.step,D=j.preview,ie=j.fastMode,Z=O=j.quoteChar===void 0||j.quoteChar===null?'"':j.quoteChar;if(j.escapeChar!==void 0&&(Z=j.escapeChar),(typeof B!="string"||-1<p.BAD_DELIMITERS.indexOf(B))&&(B=","),L===B)throw new Error("Comment character same as delimiter");L===!0?L="#":(typeof L!="string"||-1<p.BAD_DELIMITERS.indexOf(L))&&(L=!1),te!==`
`&&te!=="\r"&&te!==`\r
`&&(te=`
`);var Y=0,me=!1;this.parse=function(W,be,z){if(typeof W!="string")throw new Error("Input must be a string");var R=W.length,re=B.length,oe=te.length,he=L.length,fe=U(J),Me=[],Fe=[],Ce=[],Ve=Y=0;if(!W)return qt();if(j.header&&!be){var Qe=W.split(te)[0].split(B),ue=[],de={},x=!1;for(var se in Qe){var X=Qe[se];U(j.transformHeader)&&(X=j.transformHeader(X,se));var $=X,P=de[X]||0;for(0<P&&(x=!0,$=X+"_"+P),de[X]=P+1;ue.includes($);)$=$+"_"+P;ue.push($)}if(x){var K=W.split(te);K[0]=ue.join(B),W=K.join(te)}}if(ie||ie!==!1&&W.indexOf(O)===-1){for(var ye=W.split(te),ve=0;ve<ye.length;ve++){if(Ce=ye[ve],Y+=Ce.length,ve!==ye.length-1)Y+=te.length;else if(z)return qt();if(!L||Ce.substring(0,he)!==L){if(fe){if(Me=[],at(Ce.split(B)),ht(),me)return qt()}else at(Ce.split(B));if(D&&D<=ve)return Me=Me.slice(0,D),qt(!0)}}return qt()}for(var ne=W.indexOf(B,Y),ke=W.indexOf(te,Y),Oe=new RegExp(k(Z)+k(O),"g"),Te=W.indexOf(O,Y);;)if(W[Y]!==O)if(L&&Ce.length===0&&W.substring(Y,Y+he)===L){if(ke===-1)return qt();Y=ke+oe,ke=W.indexOf(te,Y),ne=W.indexOf(B,Y)}else if(ne!==-1&&(ne<ke||ke===-1))Ce.push(W.substring(Y,ne)),Y=ne+re,ne=W.indexOf(B,Y);else{if(ke===-1)break;if(Ce.push(W.substring(Y,ke)),zt(ke+oe),fe&&(ht(),me))return qt();if(D&&Me.length>=D)return qt(!0)}else for(Te=Y,Y++;;){if((Te=W.indexOf(O,Te+1))===-1)return z||Fe.push({type:"Quotes",code:"MissingQuotes",message:"Quoted field unterminated",row:Me.length,index:Y}),Zt();if(Te===R-1)return Zt(W.substring(Y,Te).replace(Oe,O));if(O!==Z||W[Te+1]!==Z){if(O===Z||Te===0||W[Te-1]!==Z){ne!==-1&&ne<Te+1&&(ne=W.indexOf(B,Te+1)),ke!==-1&&ke<Te+1&&(ke=W.indexOf(te,Te+1));var He=Ot(ke===-1?ne:Math.min(ne,ke));if(W.substr(Te+1+He,re)===B){Ce.push(W.substring(Y,Te).replace(Oe,O)),W[Y=Te+1+He+re]!==O&&(Te=W.indexOf(O,Y)),ne=W.indexOf(B,Y),ke=W.indexOf(te,Y);break}var it=Ot(ke);if(W.substring(Te+1+it,Te+1+it+oe)===te){if(Ce.push(W.substring(Y,Te).replace(Oe,O)),zt(Te+1+it+oe),ne=W.indexOf(B,Y),Te=W.indexOf(O,Y),fe&&(ht(),me))return qt();if(D&&Me.length>=D)return qt(!0);break}Fe.push({type:"Quotes",code:"InvalidQuotes",message:"Trailing quote on quoted field is malformed",row:Me.length,index:Y}),Te++}}else Te++}return Zt();function at(bt){Me.push(bt),Ve=Y}function Ot(bt){var pn=0;if(bt!==-1){var It=W.substring(Te+1,bt);It&&It.trim()===""&&(pn=It.length)}return pn}function Zt(bt){return z||(bt===void 0&&(bt=W.substring(Y)),Ce.push(bt),Y=R,at(Ce),fe&&ht()),qt()}function zt(bt){Y=bt,at(Ce),Ce=[],ke=W.indexOf(te,Y)}function qt(bt){return{data:Me,errors:Fe,meta:{delimiter:B,linebreak:te,aborted:me,truncated:!!bt,cursor:Ve+(be||0)}}}function ht(){J(qt()),Me=[],Fe=[]}},this.abort=function(){me=!0},this.getCharIndex=function(){return Y}}function I(j){var O=j.data,B=d[O.workerId],te=!1;if(O.error)B.userError(O.error,O.file);else if(O.results&&O.results.data){var L={abort:function(){te=!0,M(O.workerId,{data:[],errors:[],meta:{aborted:!0}})},pause:F,resume:F};if(U(B.userStep)){for(var J=0;J<O.results.data.length&&(B.userStep({data:O.results.data[J],errors:O.results.errors,meta:O.results.meta},L),!te);J++);delete O.results}else U(B.userChunk)&&(B.userChunk(O.results,L,O.file),delete O.results)}O.finished&&!te&&M(O.workerId,O.results)}function M(j,O){var B=d[j];U(B.userComplete)&&B.userComplete(O),B.terminate(),delete d[j]}function F(){throw new Error("Not implemented.")}function q(j){if(typeof j!="object"||j===null)return j;var O=Array.isArray(j)?[]:{};for(var B in j)O[B]=q(j[B]);return O}function Q(j,O){return function(){j.apply(O,arguments)}}function U(j){return typeof j=="function"}return c&&(i.onmessage=function(j){var O=j.data;if(p.WORKER_ID===void 0&&O&&(p.WORKER_ID=O.workerId),typeof O.input=="string")i.postMessage({workerId:p.WORKER_ID,results:p.parse(O.input,O.config),finished:!0});else if(i.File&&O.input instanceof File||O.input instanceof Object){var B=p.parse(O.input,O.config);B&&i.postMessage({workerId:p.WORKER_ID,results:B,finished:!0})}}),(S.prototype=Object.create(v.prototype)).constructor=S,(A.prototype=Object.create(v.prototype)).constructor=A,(_.prototype=Object.create(_.prototype)).constructor=_,(E.prototype=Object.create(v.prototype)).constructor=E,p})})(iu)),iu.exports}var M1=R1();const jb=io(M1),U1=n=>{if(Array.isArray(n))return{version:9,decks:n.filter(Boolean).map(s=>(s.type||(s.type=Array.isArray(s.cards)?Ne.Flashcard:Ne.Quiz),s.type===Ne.Flashcard?s.cards=(s.cards||[]).filter(Boolean):s.type===Ne.Quiz&&(s.questions=(s.questions||[]).filter(Boolean)),s.id=String(s.id||crypto.randomUUID()),s.name||(s.name="Untitled Deck"),s)).filter(s=>s&&s.name),folders:[],deckSeries:[],reviews:[],sessions:[],seriesProgress:{},learningProgress:{},aiChatHistory:[]};if(typeof n=="object"&&n!==null){const a={...n};return a.version||(a.version=2),a.decks||(a.decks=[]),a.folders||(a.folders=[]),a.deckSeries||(a.deckSeries=[]),a.reviews||(a.reviews=[]),a.sessions||(a.sessions=[]),a.seriesProgress||(a.seriesProgress={}),a.learningProgress||(a.learningProgress={}),a.aiChatHistory||(a.aiChatHistory=[]),a.decks=a.decks.map(s=>{if(!s)return null;s.id?s.id=String(s.id):s.id=crypto.randomUUID(),s.type||(s.cards&&s.cards.length>0?s.type="flashcard":s.infoCards&&s.infoCards.length>0?s.type="learning":s.type="quiz"),s.cards||(s.cards=[]),s.questions||(s.questions=[]),s.infoCards||(s.infoCards=[]);const i=l=>l?(l.id=String(l.id||crypto.randomUUID()),(l.interval===void 0||l.interval===null)&&(l.interval=0),(l.easeFactor===void 0||l.easeFactor===null)&&(l.easeFactor=2.5),(l.lapses===void 0||l.lapses===null)&&(l.lapses=0),(l.masteryLevel===void 0||l.masteryLevel===null)&&(l.masteryLevel=0),l.dueDate||(l.dueDate=new Date().toISOString()),l):null;return s.type==="flashcard"?s.cards=s.cards.map(i).filter(Boolean):(s.questions=s.questions.map(l=>{const c=i(l);return c?(c.questionType||(c.questionType="multipleChoice"),c.options||(c.options=[]),c.options=c.options.map(d=>({...d,id:String(d.id||crypto.randomUUID())})),c):null}).filter(Boolean),s.type==="learning"&&(s.infoCards=s.infoCards.map(l=>l?(l.id=String(l.id||crypto.randomUUID()),l.unlocksQuestionIds||(l.unlocksQuestionIds=[]),l):null).filter(Boolean))),s}).filter(Boolean),a.deckSeries=a.deckSeries.map(s=>(s.id=String(s.id),s.levels||(s.levels=[]),s)),a.reviews=a.reviews.map(s=>(s.itemId=String(s.itemId),s.deckId=String(s.deckId),s)),a.sessions=a.sessions.map(s=>s?((s.itemsCompleted===void 0||s.itemsCompleted===null)&&(s.itemsCompleted=s.currentIndex||0),s):null).filter(Boolean),a.version=9,a}return n},Eu=async n=>{let a;try{a=JSON.parse(n)}catch{const i=zh(n);if(!i.isValid&&!i.fixedJSON)throw new Error("Failed to parse backup file.");a=i.parsed||JSON.parse(i.fixedJSON)}if(!a)throw new Error("The backup file appears to be empty or invalid.");if(typeof a=="string"&&(a=JSON.parse(a)),typeof a=="object"&&a!==null&&a.dataType==="cogniflow-compressed-backup-v1"&&typeof a.content=="string"){const i=(await qh.loadAsync(a.content,{base64:!0})).file("backup.json");if(i){const l=await i.async("string");a=JSON.parse(l)}}if(typeof a=="object"&&a!==null&&!("version"in a)&&!Array.isArray(a)&&("data"in a&&typeof a.data=="object"?a=a.data:"content"in a&&typeof a.content=="object"&&(a=a.content)),a=U1(a),typeof a=="object"&&a!==null&&"version"in a){if(a.version>9)throw new Error(`Unsupported backup version: ${a.version}.`);const s=N1.safeParse(a);if(!s.success)throw new Error(`Invalid backup data at ${s.error.issues[0].path.join(".")}`);return s.data}throw new Error("The file is not a valid CogniFlow backup file.")},vu=n=>{if(!n.trim())throw new Error("Pasted content is empty.");const a=zh(n);if(!a.isValid)throw new Error("Invalid JSON.");const s=a.parsed,i=C1.safeParse(s);if(i.success)return{type:"series",data:i.data};const l=ge.array(Nb).safeParse(s);if(l.success)return{type:Ne.Flashcard,data:l.data};const c=p1.safeParse(s);if(c.success){const d=ge.array(Db).safeParse(s.questions),m=ge.array(Bh).optional().safeParse(s.infoCards);d.success||console.warn("Questions failed deep validation:",d.error);const p={...c.data,questions:d.success?d.data:s.questions,infoCards:m.success?m.data:s.infoCards};if(p.type==="learning"||Array.isArray(p.infoCards)&&p.infoCards.length>0){const h=p.questions||[];return(p.infoCards||[]).forEach(S=>{Array.isArray(S.unlocksQuestionIds)&&S.unlocksQuestionIds.forEach(A=>{const _=h.find(E=>E.id===A);_&&(_.infoCardIds||(_.infoCardIds=[]),_.infoCardIds.includes(S.id)||_.infoCardIds.push(S.id))})}),{type:Ne.Learning,data:p}}return{type:Ne.Quiz,data:p}}throw new Error("Unsupported JSON structure.")},Tk=(n,a)=>{if(!n.trim())throw new Error("Pasted content is empty.");const s=zh(n);if(!s.isValid)throw new Error("Invalid JSON.");const i=s.parsed;if(!Array.isArray(i))throw new Error("JSON must be an array of items.");if(i.length===0)return[];if(a===Ne.Flashcard){const l=ge.array(Nb).safeParse(i);if(!l.success)throw new Error("Invalid flashcard format.");return l.data}else{const l=ge.array(Db).safeParse(i);if(!l.success)throw new Error(`Invalid question format: ${l.error.issues[0].message}`);return l.data}},ha=n=>{const a=new Date;return a.setHours(0,0,0,0),n.map(s=>({id:crypto.randomUUID(),front:s.front,back:s.back,dueDate:a.toISOString(),interval:0,easeFactor:wr,masteryLevel:0,lapses:0}))},qr=n=>{const a=new Date;return a.setHours(0,0,0,0),n.map(s=>{const i=s.correctAnswerId,l=(s.options||[]).map(d=>({...d,id:d.id||crypto.randomUUID(),text:d.text||"",explanation:d.explanation||""}));let c="";if(i){const d=l.find(m=>m.id===i);d&&(c=d.id)}if(!c){const d=l.find(m=>{var p,h,v;return((p=m.explanation)==null?void 0:p.toLowerCase().includes("correct"))||((h=m.text)==null?void 0:h.toLowerCase().startsWith("correct"))||((v=m.explanation)==null?void 0:v.toLowerCase().startsWith("correct"))});d&&(c=d.id)}return!c&&l.length>0&&(c=l[0].id),{...s,id:s.id||crypto.randomUUID(),questionType:"multipleChoice",dueDate:a.toISOString(),interval:0,easeFactor:wr,masteryLevel:0,lapses:0,detailedExplanation:s.detailedExplanation||"",correctAnswerId:c,options:l}})},L1=n=>{const{data:a,errors:s}=jb.parse(n,{header:!0,skipEmptyLines:!0,transformHeader:l=>l.trim().toLowerCase()});if(s.length>0)throw new Error(`CSV Parsing Error: ${s[0].message}`);const i=a.map(l=>{const c=l.front||l.question||l.term||l.en||Object.values(l)[0],d=l.back||l.answer||l.definition||l.translation||Object.values(l)[1];return!c||!d?null:{front:String(c).trim(),back:String(d).trim()}}).filter(l=>l!==null);if(i.length===0)throw new Error("No valid cards found in CSV.");return i},Ib=async n=>{const a=n.name.toLowerCase();if(a.endsWith(".apkg")||a.endsWith(".zip"))return{type:"anki",data:{name:n.name},file:n,fileName:n.name};if(a.match(/\.(png|jpg|jpeg|webp|gif)$/))return{type:"image",data:{name:n.name,mimeType:n.type},file:n,fileName:n.name};if(a.endsWith(".csv"))try{const s=await n.text();return{type:"flashcard",data:L1(s),fileName:n.name}}catch(s){console.error("Failed to parse CSV",s)}try{const s=await n.text(),i=s.trim();if(i.startsWith("{")||i.startsWith("[")){try{const l=vu(s);return{type:l.type,data:l.data,fileName:n.name}}catch(l){console.debug("JSON: Not a standard import format, checking if backup...",l)}try{return{type:"backup",data:await Eu(s),fileName:n.name}}catch(l){console.debug("JSON: Not a valid backup format.",l)}}}catch(s){console.error("Failed to read file text for JSON check",s)}return null};var z1={};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var zy;(function(n){n.OUTCOME_UNSPECIFIED="OUTCOME_UNSPECIFIED",n.OUTCOME_OK="OUTCOME_OK",n.OUTCOME_FAILED="OUTCOME_FAILED",n.OUTCOME_DEADLINE_EXCEEDED="OUTCOME_DEADLINE_EXCEEDED"})(zy||(zy={}));var Fy;(function(n){n.LANGUAGE_UNSPECIFIED="LANGUAGE_UNSPECIFIED",n.PYTHON="PYTHON"})(Fy||(Fy={}));var By;(function(n){n.SCHEDULING_UNSPECIFIED="SCHEDULING_UNSPECIFIED",n.SILENT="SILENT",n.WHEN_IDLE="WHEN_IDLE",n.INTERRUPT="INTERRUPT"})(By||(By={}));var dr;(function(n){n.TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",n.STRING="STRING",n.NUMBER="NUMBER",n.INTEGER="INTEGER",n.BOOLEAN="BOOLEAN",n.ARRAY="ARRAY",n.OBJECT="OBJECT",n.NULL="NULL"})(dr||(dr={}));var Hy;(function(n){n.MODE_UNSPECIFIED="MODE_UNSPECIFIED",n.MODE_DYNAMIC="MODE_DYNAMIC"})(Hy||(Hy={}));var Gy;(function(n){n.API_SPEC_UNSPECIFIED="API_SPEC_UNSPECIFIED",n.SIMPLE_SEARCH="SIMPLE_SEARCH",n.ELASTIC_SEARCH="ELASTIC_SEARCH"})(Gy||(Gy={}));var qy;(function(n){n.AUTH_TYPE_UNSPECIFIED="AUTH_TYPE_UNSPECIFIED",n.NO_AUTH="NO_AUTH",n.API_KEY_AUTH="API_KEY_AUTH",n.HTTP_BASIC_AUTH="HTTP_BASIC_AUTH",n.GOOGLE_SERVICE_ACCOUNT_AUTH="GOOGLE_SERVICE_ACCOUNT_AUTH",n.OAUTH="OAUTH",n.OIDC_AUTH="OIDC_AUTH"})(qy||(qy={}));var Py;(function(n){n.HTTP_IN_UNSPECIFIED="HTTP_IN_UNSPECIFIED",n.HTTP_IN_QUERY="HTTP_IN_QUERY",n.HTTP_IN_HEADER="HTTP_IN_HEADER",n.HTTP_IN_PATH="HTTP_IN_PATH",n.HTTP_IN_BODY="HTTP_IN_BODY",n.HTTP_IN_COOKIE="HTTP_IN_COOKIE"})(Py||(Py={}));var Yy;(function(n){n.PHISH_BLOCK_THRESHOLD_UNSPECIFIED="PHISH_BLOCK_THRESHOLD_UNSPECIFIED",n.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",n.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",n.BLOCK_HIGH_AND_ABOVE="BLOCK_HIGH_AND_ABOVE",n.BLOCK_HIGHER_AND_ABOVE="BLOCK_HIGHER_AND_ABOVE",n.BLOCK_VERY_HIGH_AND_ABOVE="BLOCK_VERY_HIGH_AND_ABOVE",n.BLOCK_ONLY_EXTREMELY_HIGH="BLOCK_ONLY_EXTREMELY_HIGH"})(Yy||(Yy={}));var $y;(function(n){n.THINKING_LEVEL_UNSPECIFIED="THINKING_LEVEL_UNSPECIFIED",n.LOW="LOW",n.MEDIUM="MEDIUM",n.HIGH="HIGH",n.MINIMAL="MINIMAL"})($y||($y={}));var Vy;(function(n){n.HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",n.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",n.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",n.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",n.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",n.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY",n.HARM_CATEGORY_IMAGE_HATE="HARM_CATEGORY_IMAGE_HATE",n.HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT="HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT",n.HARM_CATEGORY_IMAGE_HARASSMENT="HARM_CATEGORY_IMAGE_HARASSMENT",n.HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT="HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT",n.HARM_CATEGORY_JAILBREAK="HARM_CATEGORY_JAILBREAK"})(Vy||(Vy={}));var Zy;(function(n){n.HARM_BLOCK_METHOD_UNSPECIFIED="HARM_BLOCK_METHOD_UNSPECIFIED",n.SEVERITY="SEVERITY",n.PROBABILITY="PROBABILITY"})(Zy||(Zy={}));var Qy;(function(n){n.HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",n.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",n.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",n.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",n.BLOCK_NONE="BLOCK_NONE",n.OFF="OFF"})(Qy||(Qy={}));var Ky;(function(n){n.FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",n.STOP="STOP",n.MAX_TOKENS="MAX_TOKENS",n.SAFETY="SAFETY",n.RECITATION="RECITATION",n.LANGUAGE="LANGUAGE",n.OTHER="OTHER",n.BLOCKLIST="BLOCKLIST",n.PROHIBITED_CONTENT="PROHIBITED_CONTENT",n.SPII="SPII",n.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",n.IMAGE_SAFETY="IMAGE_SAFETY",n.UNEXPECTED_TOOL_CALL="UNEXPECTED_TOOL_CALL",n.IMAGE_PROHIBITED_CONTENT="IMAGE_PROHIBITED_CONTENT",n.NO_IMAGE="NO_IMAGE",n.IMAGE_RECITATION="IMAGE_RECITATION",n.IMAGE_OTHER="IMAGE_OTHER"})(Ky||(Ky={}));var Jy;(function(n){n.HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",n.NEGLIGIBLE="NEGLIGIBLE",n.LOW="LOW",n.MEDIUM="MEDIUM",n.HIGH="HIGH"})(Jy||(Jy={}));var Xy;(function(n){n.HARM_SEVERITY_UNSPECIFIED="HARM_SEVERITY_UNSPECIFIED",n.HARM_SEVERITY_NEGLIGIBLE="HARM_SEVERITY_NEGLIGIBLE",n.HARM_SEVERITY_LOW="HARM_SEVERITY_LOW",n.HARM_SEVERITY_MEDIUM="HARM_SEVERITY_MEDIUM",n.HARM_SEVERITY_HIGH="HARM_SEVERITY_HIGH"})(Xy||(Xy={}));var Wy;(function(n){n.URL_RETRIEVAL_STATUS_UNSPECIFIED="URL_RETRIEVAL_STATUS_UNSPECIFIED",n.URL_RETRIEVAL_STATUS_SUCCESS="URL_RETRIEVAL_STATUS_SUCCESS",n.URL_RETRIEVAL_STATUS_ERROR="URL_RETRIEVAL_STATUS_ERROR",n.URL_RETRIEVAL_STATUS_PAYWALL="URL_RETRIEVAL_STATUS_PAYWALL",n.URL_RETRIEVAL_STATUS_UNSAFE="URL_RETRIEVAL_STATUS_UNSAFE"})(Wy||(Wy={}));var ev;(function(n){n.BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",n.SAFETY="SAFETY",n.OTHER="OTHER",n.BLOCKLIST="BLOCKLIST",n.PROHIBITED_CONTENT="PROHIBITED_CONTENT",n.IMAGE_SAFETY="IMAGE_SAFETY",n.MODEL_ARMOR="MODEL_ARMOR",n.JAILBREAK="JAILBREAK"})(ev||(ev={}));var tv;(function(n){n.TRAFFIC_TYPE_UNSPECIFIED="TRAFFIC_TYPE_UNSPECIFIED",n.ON_DEMAND="ON_DEMAND",n.PROVISIONED_THROUGHPUT="PROVISIONED_THROUGHPUT"})(tv||(tv={}));var Nh;(function(n){n.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",n.TEXT="TEXT",n.IMAGE="IMAGE",n.AUDIO="AUDIO"})(Nh||(Nh={}));var nv;(function(n){n.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",n.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",n.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",n.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH"})(nv||(nv={}));var rv;(function(n){n.TUNING_MODE_UNSPECIFIED="TUNING_MODE_UNSPECIFIED",n.TUNING_MODE_FULL="TUNING_MODE_FULL",n.TUNING_MODE_PEFT_ADAPTER="TUNING_MODE_PEFT_ADAPTER"})(rv||(rv={}));var av;(function(n){n.ADAPTER_SIZE_UNSPECIFIED="ADAPTER_SIZE_UNSPECIFIED",n.ADAPTER_SIZE_ONE="ADAPTER_SIZE_ONE",n.ADAPTER_SIZE_TWO="ADAPTER_SIZE_TWO",n.ADAPTER_SIZE_FOUR="ADAPTER_SIZE_FOUR",n.ADAPTER_SIZE_EIGHT="ADAPTER_SIZE_EIGHT",n.ADAPTER_SIZE_SIXTEEN="ADAPTER_SIZE_SIXTEEN",n.ADAPTER_SIZE_THIRTY_TWO="ADAPTER_SIZE_THIRTY_TWO"})(av||(av={}));var sv;(function(n){n.JOB_STATE_UNSPECIFIED="JOB_STATE_UNSPECIFIED",n.JOB_STATE_QUEUED="JOB_STATE_QUEUED",n.JOB_STATE_PENDING="JOB_STATE_PENDING",n.JOB_STATE_RUNNING="JOB_STATE_RUNNING",n.JOB_STATE_SUCCEEDED="JOB_STATE_SUCCEEDED",n.JOB_STATE_FAILED="JOB_STATE_FAILED",n.JOB_STATE_CANCELLING="JOB_STATE_CANCELLING",n.JOB_STATE_CANCELLED="JOB_STATE_CANCELLED",n.JOB_STATE_PAUSED="JOB_STATE_PAUSED",n.JOB_STATE_EXPIRED="JOB_STATE_EXPIRED",n.JOB_STATE_UPDATING="JOB_STATE_UPDATING",n.JOB_STATE_PARTIALLY_SUCCEEDED="JOB_STATE_PARTIALLY_SUCCEEDED"})(sv||(sv={}));var iv;(function(n){n.TUNING_TASK_UNSPECIFIED="TUNING_TASK_UNSPECIFIED",n.TUNING_TASK_I2V="TUNING_TASK_I2V",n.TUNING_TASK_T2V="TUNING_TASK_T2V",n.TUNING_TASK_R2V="TUNING_TASK_R2V"})(iv||(iv={}));var ov;(function(n){n.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",n.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",n.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",n.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH",n.MEDIA_RESOLUTION_ULTRA_HIGH="MEDIA_RESOLUTION_ULTRA_HIGH"})(ov||(ov={}));var lv;(function(n){n.FEATURE_SELECTION_PREFERENCE_UNSPECIFIED="FEATURE_SELECTION_PREFERENCE_UNSPECIFIED",n.PRIORITIZE_QUALITY="PRIORITIZE_QUALITY",n.BALANCED="BALANCED",n.PRIORITIZE_COST="PRIORITIZE_COST"})(lv||(lv={}));var cv;(function(n){n.UNSPECIFIED="UNSPECIFIED",n.BLOCKING="BLOCKING",n.NON_BLOCKING="NON_BLOCKING"})(cv||(cv={}));var uv;(function(n){n.MODE_UNSPECIFIED="MODE_UNSPECIFIED",n.MODE_DYNAMIC="MODE_DYNAMIC"})(uv||(uv={}));var dv;(function(n){n.ENVIRONMENT_UNSPECIFIED="ENVIRONMENT_UNSPECIFIED",n.ENVIRONMENT_BROWSER="ENVIRONMENT_BROWSER"})(dv||(dv={}));var fv;(function(n){n.MODE_UNSPECIFIED="MODE_UNSPECIFIED",n.AUTO="AUTO",n.ANY="ANY",n.NONE="NONE",n.VALIDATED="VALIDATED"})(fv||(fv={}));var hv;(function(n){n.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",n.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",n.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",n.BLOCK_NONE="BLOCK_NONE"})(hv||(hv={}));var mv;(function(n){n.DONT_ALLOW="DONT_ALLOW",n.ALLOW_ADULT="ALLOW_ADULT",n.ALLOW_ALL="ALLOW_ALL"})(mv||(mv={}));var pv;(function(n){n.auto="auto",n.en="en",n.ja="ja",n.ko="ko",n.hi="hi",n.zh="zh",n.pt="pt",n.es="es"})(pv||(pv={}));var gv;(function(n){n.MASK_MODE_DEFAULT="MASK_MODE_DEFAULT",n.MASK_MODE_USER_PROVIDED="MASK_MODE_USER_PROVIDED",n.MASK_MODE_BACKGROUND="MASK_MODE_BACKGROUND",n.MASK_MODE_FOREGROUND="MASK_MODE_FOREGROUND",n.MASK_MODE_SEMANTIC="MASK_MODE_SEMANTIC"})(gv||(gv={}));var yv;(function(n){n.CONTROL_TYPE_DEFAULT="CONTROL_TYPE_DEFAULT",n.CONTROL_TYPE_CANNY="CONTROL_TYPE_CANNY",n.CONTROL_TYPE_SCRIBBLE="CONTROL_TYPE_SCRIBBLE",n.CONTROL_TYPE_FACE_MESH="CONTROL_TYPE_FACE_MESH"})(yv||(yv={}));var vv;(function(n){n.SUBJECT_TYPE_DEFAULT="SUBJECT_TYPE_DEFAULT",n.SUBJECT_TYPE_PERSON="SUBJECT_TYPE_PERSON",n.SUBJECT_TYPE_ANIMAL="SUBJECT_TYPE_ANIMAL",n.SUBJECT_TYPE_PRODUCT="SUBJECT_TYPE_PRODUCT"})(vv||(vv={}));var bv;(function(n){n.EDIT_MODE_DEFAULT="EDIT_MODE_DEFAULT",n.EDIT_MODE_INPAINT_REMOVAL="EDIT_MODE_INPAINT_REMOVAL",n.EDIT_MODE_INPAINT_INSERTION="EDIT_MODE_INPAINT_INSERTION",n.EDIT_MODE_OUTPAINT="EDIT_MODE_OUTPAINT",n.EDIT_MODE_CONTROLLED_EDITING="EDIT_MODE_CONTROLLED_EDITING",n.EDIT_MODE_STYLE="EDIT_MODE_STYLE",n.EDIT_MODE_BGSWAP="EDIT_MODE_BGSWAP",n.EDIT_MODE_PRODUCT_IMAGE="EDIT_MODE_PRODUCT_IMAGE"})(bv||(bv={}));var xv;(function(n){n.FOREGROUND="FOREGROUND",n.BACKGROUND="BACKGROUND",n.PROMPT="PROMPT",n.SEMANTIC="SEMANTIC",n.INTERACTIVE="INTERACTIVE"})(xv||(xv={}));var _v;(function(n){n.ASSET="ASSET",n.STYLE="STYLE"})(_v||(_v={}));var Sv;(function(n){n.INSERT="INSERT",n.REMOVE="REMOVE",n.REMOVE_STATIC="REMOVE_STATIC",n.OUTPAINT="OUTPAINT"})(Sv||(Sv={}));var wv;(function(n){n.OPTIMIZED="OPTIMIZED",n.LOSSLESS="LOSSLESS"})(wv||(wv={}));var Ev;(function(n){n.SUPERVISED_FINE_TUNING="SUPERVISED_FINE_TUNING",n.PREFERENCE_TUNING="PREFERENCE_TUNING"})(Ev||(Ev={}));var kv;(function(n){n.STATE_UNSPECIFIED="STATE_UNSPECIFIED",n.STATE_PENDING="STATE_PENDING",n.STATE_ACTIVE="STATE_ACTIVE",n.STATE_FAILED="STATE_FAILED"})(kv||(kv={}));var Tv;(function(n){n.STATE_UNSPECIFIED="STATE_UNSPECIFIED",n.PROCESSING="PROCESSING",n.ACTIVE="ACTIVE",n.FAILED="FAILED"})(Tv||(Tv={}));var Av;(function(n){n.SOURCE_UNSPECIFIED="SOURCE_UNSPECIFIED",n.UPLOADED="UPLOADED",n.GENERATED="GENERATED"})(Av||(Av={}));var Nv;(function(n){n.TURN_COMPLETE_REASON_UNSPECIFIED="TURN_COMPLETE_REASON_UNSPECIFIED",n.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",n.RESPONSE_REJECTED="RESPONSE_REJECTED",n.NEED_MORE_INPUT="NEED_MORE_INPUT"})(Nv||(Nv={}));var Dv;(function(n){n.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",n.TEXT="TEXT",n.IMAGE="IMAGE",n.VIDEO="VIDEO",n.AUDIO="AUDIO",n.DOCUMENT="DOCUMENT"})(Dv||(Dv={}));var Cv;(function(n){n.VAD_SIGNAL_TYPE_UNSPECIFIED="VAD_SIGNAL_TYPE_UNSPECIFIED",n.VAD_SIGNAL_TYPE_SOS="VAD_SIGNAL_TYPE_SOS",n.VAD_SIGNAL_TYPE_EOS="VAD_SIGNAL_TYPE_EOS"})(Cv||(Cv={}));var Ov;(function(n){n.START_SENSITIVITY_UNSPECIFIED="START_SENSITIVITY_UNSPECIFIED",n.START_SENSITIVITY_HIGH="START_SENSITIVITY_HIGH",n.START_SENSITIVITY_LOW="START_SENSITIVITY_LOW"})(Ov||(Ov={}));var jv;(function(n){n.END_SENSITIVITY_UNSPECIFIED="END_SENSITIVITY_UNSPECIFIED",n.END_SENSITIVITY_HIGH="END_SENSITIVITY_HIGH",n.END_SENSITIVITY_LOW="END_SENSITIVITY_LOW"})(jv||(jv={}));var Iv;(function(n){n.ACTIVITY_HANDLING_UNSPECIFIED="ACTIVITY_HANDLING_UNSPECIFIED",n.START_OF_ACTIVITY_INTERRUPTS="START_OF_ACTIVITY_INTERRUPTS",n.NO_INTERRUPTION="NO_INTERRUPTION"})(Iv||(Iv={}));var Rv;(function(n){n.TURN_COVERAGE_UNSPECIFIED="TURN_COVERAGE_UNSPECIFIED",n.TURN_INCLUDES_ONLY_ACTIVITY="TURN_INCLUDES_ONLY_ACTIVITY",n.TURN_INCLUDES_ALL_INPUT="TURN_INCLUDES_ALL_INPUT"})(Rv||(Rv={}));var Mv;(function(n){n.SCALE_UNSPECIFIED="SCALE_UNSPECIFIED",n.C_MAJOR_A_MINOR="C_MAJOR_A_MINOR",n.D_FLAT_MAJOR_B_FLAT_MINOR="D_FLAT_MAJOR_B_FLAT_MINOR",n.D_MAJOR_B_MINOR="D_MAJOR_B_MINOR",n.E_FLAT_MAJOR_C_MINOR="E_FLAT_MAJOR_C_MINOR",n.E_MAJOR_D_FLAT_MINOR="E_MAJOR_D_FLAT_MINOR",n.F_MAJOR_D_MINOR="F_MAJOR_D_MINOR",n.G_FLAT_MAJOR_E_FLAT_MINOR="G_FLAT_MAJOR_E_FLAT_MINOR",n.G_MAJOR_E_MINOR="G_MAJOR_E_MINOR",n.A_FLAT_MAJOR_F_MINOR="A_FLAT_MAJOR_F_MINOR",n.A_MAJOR_G_FLAT_MINOR="A_MAJOR_G_FLAT_MINOR",n.B_FLAT_MAJOR_G_MINOR="B_FLAT_MAJOR_G_MINOR",n.B_MAJOR_A_FLAT_MINOR="B_MAJOR_A_FLAT_MINOR"})(Mv||(Mv={}));var Uv;(function(n){n.MUSIC_GENERATION_MODE_UNSPECIFIED="MUSIC_GENERATION_MODE_UNSPECIFIED",n.QUALITY="QUALITY",n.DIVERSITY="DIVERSITY",n.VOCALIZATION="VOCALIZATION"})(Uv||(Uv={}));var Lv;(function(n){n.PLAYBACK_CONTROL_UNSPECIFIED="PLAYBACK_CONTROL_UNSPECIFIED",n.PLAY="PLAY",n.PAUSE="PAUSE",n.STOP="STOP",n.RESET_CONTEXT="RESET_CONTEXT"})(Lv||(Lv={}));/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var zv;(function(n){n.PAGED_ITEM_BATCH_JOBS="batchJobs",n.PAGED_ITEM_MODELS="models",n.PAGED_ITEM_TUNING_JOBS="tuningJobs",n.PAGED_ITEM_FILES="files",n.PAGED_ITEM_CACHED_CONTENTS="cachedContents",n.PAGED_ITEM_FILE_SEARCH_STORES="fileSearchStores",n.PAGED_ITEM_DOCUMENTS="documents"})(zv||(zv={}));function bu(n,a){var s={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&a.indexOf(i)<0&&(s[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var l=0,i=Object.getOwnPropertySymbols(n);l<i.length;l++)a.indexOf(i[l])<0&&Object.prototype.propertyIsEnumerable.call(n,i[l])&&(s[i[l]]=n[i[l]]);return s}function Fv(n){var a=typeof Symbol=="function"&&Symbol.iterator,s=a&&n[a],i=0;if(s)return s.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&i>=n.length&&(n=void 0),{value:n&&n[i++],done:!n}}};throw new TypeError(a?"Object is not iterable.":"Symbol.iterator is not defined.")}function un(n){return this instanceof un?(this.v=n,this):new un(n)}function hl(n,a,s){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i=s.apply(n,a||[]),l,c=[];return l=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),m("next"),m("throw"),m("return",d),l[Symbol.asyncIterator]=function(){return this},l;function d(_){return function(E){return Promise.resolve(E).then(_,S)}}function m(_,E){i[_]&&(l[_]=function(w){return new Promise(function(k,N){c.push([_,w,k,N])>1||p(_,w)})},E&&(l[_]=E(l[_])))}function p(_,E){try{h(i[_](E))}catch(w){A(c[0][3],w)}}function h(_){_.value instanceof un?Promise.resolve(_.value.v).then(v,S):A(c[0][2],_)}function v(_){p("next",_)}function S(_){p("throw",_)}function A(_,E){_(E),c.shift(),c.length&&p(c[0][0],c[0][1])}}function to(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var a=n[Symbol.asyncIterator],s;return a?a.call(n):(n=typeof Fv=="function"?Fv(n):n[Symbol.iterator](),s={},i("next"),i("throw"),i("return"),s[Symbol.asyncIterator]=function(){return this},s);function i(c){s[c]=n[c]&&function(d){return new Promise(function(m,p){d=n[c](d),l(m,p,d.done,d.value)})}}function l(c,d,m,p){Promise.resolve(p).then(function(h){c({value:h,done:m})},d)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */let Rb=function(){const{crypto:n}=globalThis;if(n!=null&&n.randomUUID)return Rb=n.randomUUID.bind(n),n.randomUUID();const a=new Uint8Array(1),s=n?()=>n.getRandomValues(a)[0]:()=>Math.random()*255&255;return"10000000-1000-4000-8000-100000000000".replace(/[018]/g,i=>(+i^s()&15>>+i/4).toString(16))};const F1=()=>Rb();/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Dh(n){return typeof n=="object"&&n!==null&&("name"in n&&n.name==="AbortError"||"message"in n&&String(n.message).includes("FetchRequestCanceledException"))}const Ch=n=>{if(n instanceof Error)return n;if(typeof n=="object"&&n!==null){try{if(Object.prototype.toString.call(n)==="[object Error]"){const a=new Error(n.message,n.cause?{cause:n.cause}:{});return n.stack&&(a.stack=n.stack),n.cause&&!a.cause&&(a.cause=n.cause),n.name&&(a.name=n.name),a}}catch{}try{return new Error(JSON.stringify(n))}catch{}}return new Error(n)};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Yr extends Error{}class tr extends Yr{constructor(a,s,i,l){super(`${tr.makeMessage(a,s,i)}`),this.status=a,this.headers=l,this.error=s}static makeMessage(a,s,i){const l=s!=null&&s.message?typeof s.message=="string"?s.message:JSON.stringify(s.message):s?JSON.stringify(s):i;return a&&l?`${a} ${l}`:a?`${a} status code (no body)`:l||"(no status code or body)"}static generate(a,s,i,l){if(!a||!l)return new ku({message:i,cause:Ch(s)});const c=s;return a===400?new Ub(a,c,i,l):a===401?new Lb(a,c,i,l):a===403?new zb(a,c,i,l):a===404?new Fb(a,c,i,l):a===409?new Bb(a,c,i,l):a===422?new Hb(a,c,i,l):a===429?new Gb(a,c,i,l):a>=500?new qb(a,c,i,l):new tr(a,c,i,l)}}class Oh extends tr{constructor({message:a}={}){super(void 0,void 0,a||"Request was aborted.",void 0)}}class ku extends tr{constructor({message:a,cause:s}){super(void 0,void 0,a||"Connection error.",void 0),s&&(this.cause=s)}}class Mb extends ku{constructor({message:a}={}){super({message:a??"Request timed out."})}}class Ub extends tr{}class Lb extends tr{}class zb extends tr{}class Fb extends tr{}class Bb extends tr{}class Hb extends tr{}class Gb extends tr{}class qb extends tr{}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const B1=/^[a-z][a-z0-9+.-]*:/i,H1=n=>B1.test(n);let jh=n=>(jh=Array.isArray,jh(n));const G1=jh;let q1=G1;const Bv=q1;function P1(n){if(!n)return!0;for(const a in n)return!1;return!0}function Y1(n,a){return Object.prototype.hasOwnProperty.call(n,a)}const $1=(n,a)=>{if(typeof a!="number"||!Number.isInteger(a))throw new Yr(`${n} must be an integer`);if(a<0)throw new Yr(`${n} must be a positive integer`);return a},V1=n=>{try{return JSON.parse(n)}catch{return}};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Z1=n=>new Promise(a=>setTimeout(a,n));/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Qi="0.0.1";/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Q1(){return typeof Deno<"u"&&Deno.build!=null?"deno":typeof EdgeRuntime<"u"?"edge":Object.prototype.toString.call(typeof globalThis.process<"u"?globalThis.process:0)==="[object process]"?"node":"unknown"}const K1=()=>{var n,a,s,i,l;const c=Q1();if(c==="deno")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Qi,"X-Stainless-OS":Gv(Deno.build.os),"X-Stainless-Arch":Hv(Deno.build.arch),"X-Stainless-Runtime":"deno","X-Stainless-Runtime-Version":typeof Deno.version=="string"?Deno.version:(a=(n=Deno.version)===null||n===void 0?void 0:n.deno)!==null&&a!==void 0?a:"unknown"};if(typeof EdgeRuntime<"u")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Qi,"X-Stainless-OS":"Unknown","X-Stainless-Arch":`other:${EdgeRuntime}`,"X-Stainless-Runtime":"edge","X-Stainless-Runtime-Version":globalThis.process.version};if(c==="node")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Qi,"X-Stainless-OS":Gv((s=globalThis.process.platform)!==null&&s!==void 0?s:"unknown"),"X-Stainless-Arch":Hv((i=globalThis.process.arch)!==null&&i!==void 0?i:"unknown"),"X-Stainless-Runtime":"node","X-Stainless-Runtime-Version":(l=globalThis.process.version)!==null&&l!==void 0?l:"unknown"};const d=J1();return d?{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Qi,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":`browser:${d.browser}`,"X-Stainless-Runtime-Version":d.version}:{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Qi,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":"unknown","X-Stainless-Runtime-Version":"unknown"}};function J1(){if(typeof navigator>"u"||!navigator)return null;const n=[{key:"edge",pattern:/Edge(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/MSIE(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/Trident(?:.*rv\:(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"chrome",pattern:/Chrome(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"firefox",pattern:/Firefox(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"safari",pattern:/(?:Version\W+(\d+)\.(\d+)(?:\.(\d+))?)?(?:\W+Mobile\S*)?\W+Safari/}];for(const{key:a,pattern:s}of n){const i=s.exec(navigator.userAgent);if(i){const l=i[1]||0,c=i[2]||0,d=i[3]||0;return{browser:a,version:`${l}.${c}.${d}`}}}return null}const Hv=n=>n==="x32"?"x32":n==="x86_64"||n==="x64"?"x64":n==="arm"?"arm":n==="aarch64"||n==="arm64"?"arm64":n?`other:${n}`:"unknown",Gv=n=>(n=n.toLowerCase(),n.includes("ios")?"iOS":n==="android"?"Android":n==="darwin"?"MacOS":n==="win32"?"Windows":n==="freebsd"?"FreeBSD":n==="openbsd"?"OpenBSD":n==="linux"?"Linux":n?`Other:${n}`:"Unknown");let Vc;const X1=()=>Vc??(Vc=K1());/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function W1(){if(typeof fetch<"u")return fetch;throw new Error("`fetch` is not defined as a global; Either pass `fetch` to the client, `new GeminiNextGenAPIClient({ fetch })` or polyfill the global, `globalThis.fetch = fetch`")}function Pb(...n){const a=globalThis.ReadableStream;if(typeof a>"u")throw new Error("`ReadableStream` is not defined as a global; You will need to polyfill it, `globalThis.ReadableStream = ReadableStream`");return new a(...n)}function ew(n){let a=Symbol.asyncIterator in n?n[Symbol.asyncIterator]():n[Symbol.iterator]();return Pb({start(){},async pull(s){const{done:i,value:l}=await a.next();i?s.close():s.enqueue(l)},async cancel(){var s;await((s=a.return)===null||s===void 0?void 0:s.call(a))}})}function Yb(n){if(n[Symbol.asyncIterator])return n;const a=n.getReader();return{async next(){try{const s=await a.read();return s!=null&&s.done&&a.releaseLock(),s}catch(s){throw a.releaseLock(),s}},async return(){const s=a.cancel();return a.releaseLock(),await s,{done:!0,value:void 0}},[Symbol.asyncIterator](){return this}}}async function tw(n){var a,s;if(n===null||typeof n!="object")return;if(n[Symbol.asyncIterator]){await((s=(a=n[Symbol.asyncIterator]()).return)===null||s===void 0?void 0:s.call(a));return}const i=n.getReader(),l=i.cancel();i.releaseLock(),await l}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const nw=({headers:n,body:a})=>({bodyHeaders:{"content-type":"application/json"},body:JSON.stringify(a)});/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const $b=()=>{var n;if(typeof File>"u"){const{process:a}=globalThis,s=typeof((n=a==null?void 0:a.versions)===null||n===void 0?void 0:n.node)=="string"&&parseInt(a.versions.node.split("."))<20;throw new Error("`File` is not defined as a global, which is required for file uploads."+(s?" Update to Node 20 LTS or newer, or set `globalThis.File` to `import('node:buffer').File`.":""))}};function nh(n,a,s){return $b(),new File(n,a??"unknown_file",s)}function rw(n){return(typeof n=="object"&&n!==null&&("name"in n&&n.name&&String(n.name)||"url"in n&&n.url&&String(n.url)||"filename"in n&&n.filename&&String(n.filename)||"path"in n&&n.path&&String(n.path))||"").split(/[\\/]/).pop()||void 0}const aw=n=>n!=null&&typeof n=="object"&&typeof n[Symbol.asyncIterator]=="function";/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Vb=n=>n!=null&&typeof n=="object"&&typeof n.size=="number"&&typeof n.type=="string"&&typeof n.text=="function"&&typeof n.slice=="function"&&typeof n.arrayBuffer=="function",sw=n=>n!=null&&typeof n=="object"&&typeof n.name=="string"&&typeof n.lastModified=="number"&&Vb(n),iw=n=>n!=null&&typeof n=="object"&&typeof n.url=="string"&&typeof n.blob=="function";async function ow(n,a,s){if($b(),n=await n,sw(n))return n instanceof File?n:nh([await n.arrayBuffer()],n.name);if(iw(n)){const l=await n.blob();return a||(a=new URL(n.url).pathname.split(/[\\/]/).pop()),nh(await Ih(l),a,s)}const i=await Ih(n);if(a||(a=rw(n)),!(s!=null&&s.type)){const l=i.find(c=>typeof c=="object"&&"type"in c&&c.type);typeof l=="string"&&(s=Object.assign(Object.assign({},s),{type:l}))}return nh(i,a,s)}async function Ih(n){var a,s,i,l,c;let d=[];if(typeof n=="string"||ArrayBuffer.isView(n)||n instanceof ArrayBuffer)d.push(n);else if(Vb(n))d.push(n instanceof Blob?n:await n.arrayBuffer());else if(aw(n))try{for(var m=!0,p=to(n),h;h=await p.next(),a=h.done,!a;m=!0){l=h.value,m=!1;const v=l;d.push(...await Ih(v))}}catch(v){s={error:v}}finally{try{!m&&!a&&(i=p.return)&&await i.call(p)}finally{if(s)throw s.error}}else{const v=(c=n==null?void 0:n.constructor)===null||c===void 0?void 0:c.name;throw new Error(`Unexpected data type: ${typeof n}${v?`; constructor: ${v}`:""}${lw(n)}`)}return d}function lw(n){return typeof n!="object"||n===null?"":`; props: [${Object.getOwnPropertyNames(n).map(s=>`"${s}"`).join(", ")}]`}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Zb{constructor(a){this._client=a}}Zb._key=[];/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Qb(n){return n.replace(/[^A-Za-z0-9\-._~!$&'()*+,;=:@]+/g,encodeURIComponent)}const qv=Object.freeze(Object.create(null)),cw=(n=Qb)=>(function(s,...i){if(s.length===1)return s[0];let l=!1;const c=[],d=s.reduce((v,S,A)=>{var _,E,w;/[?#]/.test(S)&&(l=!0);const k=i[A];let N=(l?encodeURIComponent:n)(""+k);return A!==i.length&&(k==null||typeof k=="object"&&k.toString===((w=Object.getPrototypeOf((E=Object.getPrototypeOf((_=k.hasOwnProperty)!==null&&_!==void 0?_:qv))!==null&&E!==void 0?E:qv))===null||w===void 0?void 0:w.toString))&&(N=k+"",c.push({start:v.length+S.length,length:N.length,error:`Value of type ${Object.prototype.toString.call(k).slice(8,-1)} is not a valid path parameter`})),v+S+(A===i.length?"":N)},""),m=d.split(/[?#]/,1)[0],p=new RegExp("(?<=^|\\/)(?:\\.|%2e){1,2}(?=\\/|$)","gi");let h;for(;(h=p.exec(m))!==null;)c.push({start:h.index,length:h[0].length,error:`Value "${h[0]}" can't be safely passed as a path parameter`});if(c.sort((v,S)=>v.start-S.start),c.length>0){let v=0;const S=c.reduce((A,_)=>{const E=" ".repeat(_.start-v),w="^".repeat(_.length);return v=_.start+_.length,A+E+w},"");throw new Yr(`Path parameters result in path with invalid segments:
${c.map(A=>A.error).join(`
`)}
${d}
${S}`)}return d}),Zc=cw(Qb);/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Kb extends Zb{create(a,s){var i;const{api_version:l=this._client.apiVersion}=a,c=bu(a,["api_version"]);if("model"in c&&"agent_config"in c)throw new Yr("Invalid request: specified `model` and `agent_config`. If specifying `model`, use `generation_config`.");if("agent"in c&&"generation_config"in c)throw new Yr("Invalid request: specified `agent` and `generation_config`. If specifying `agent`, use `agent_config`.");return this._client.post(Zc`/${l}/interactions`,Object.assign(Object.assign({body:c},s),{stream:(i=a.stream)!==null&&i!==void 0?i:!1}))}delete(a,s={},i){const{api_version:l=this._client.apiVersion}=s??{};return this._client.delete(Zc`/${l}/interactions/${a}`,i)}cancel(a,s={},i){const{api_version:l=this._client.apiVersion}=s??{};return this._client.post(Zc`/${l}/interactions/${a}/cancel`,i)}get(a,s={},i){var l;const c=s??{},{api_version:d=this._client.apiVersion}=c,m=bu(c,["api_version"]);return this._client.get(Zc`/${d}/interactions/${a}`,Object.assign(Object.assign({query:m},i),{stream:(l=s==null?void 0:s.stream)!==null&&l!==void 0?l:!1}))}}Kb._key=Object.freeze(["interactions"]);class Jb extends Kb{}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function uw(n){let a=0;for(const l of n)a+=l.length;const s=new Uint8Array(a);let i=0;for(const l of n)s.set(l,i),i+=l.length;return s}let Qc;function Ph(n){let a;return(Qc??(a=new globalThis.TextEncoder,Qc=a.encode.bind(a)))(n)}let Kc;function Pv(n){let a;return(Kc??(a=new globalThis.TextDecoder,Kc=a.decode.bind(a)))(n)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Tu{constructor(){this.buffer=new Uint8Array,this.carriageReturnIndex=null}decode(a){if(a==null)return[];const s=a instanceof ArrayBuffer?new Uint8Array(a):typeof a=="string"?Ph(a):a;this.buffer=uw([this.buffer,s]);const i=[];let l;for(;(l=dw(this.buffer,this.carriageReturnIndex))!=null;){if(l.carriage&&this.carriageReturnIndex==null){this.carriageReturnIndex=l.index;continue}if(this.carriageReturnIndex!=null&&(l.index!==this.carriageReturnIndex+1||l.carriage)){i.push(Pv(this.buffer.subarray(0,this.carriageReturnIndex-1))),this.buffer=this.buffer.subarray(this.carriageReturnIndex),this.carriageReturnIndex=null;continue}const c=this.carriageReturnIndex!==null?l.preceding-1:l.preceding,d=Pv(this.buffer.subarray(0,c));i.push(d),this.buffer=this.buffer.subarray(l.index),this.carriageReturnIndex=null}return i}flush(){return this.buffer.length?this.decode(`
`):[]}}Tu.NEWLINE_CHARS=new Set([`
`,"\r"]);Tu.NEWLINE_REGEXP=/\r\n|[\n\r]/g;function dw(n,a){for(let l=a??0;l<n.length;l++){if(n[l]===10)return{preceding:l,index:l+1,carriage:!1};if(n[l]===13)return{preceding:l,index:l+1,carriage:!0}}return null}function fw(n){for(let i=0;i<n.length-1;i++){if(n[i]===10&&n[i+1]===10||n[i]===13&&n[i+1]===13)return i+2;if(n[i]===13&&n[i+1]===10&&i+3<n.length&&n[i+2]===13&&n[i+3]===10)return i+4}return-1}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const xu={off:0,error:200,warn:300,info:400,debug:500},Yv=(n,a,s)=>{if(n){if(Y1(xu,n))return n;Xn(s).warn(`${a} was set to ${JSON.stringify(n)}, expected one of ${JSON.stringify(Object.keys(xu))}`)}};function dl(){}function Jc(n,a,s){return!a||xu[n]>xu[s]?dl:a[n].bind(a)}const hw={error:dl,warn:dl,info:dl,debug:dl};let $v=new WeakMap;function Xn(n){var a;const s=n.logger,i=(a=n.logLevel)!==null&&a!==void 0?a:"off";if(!s)return hw;const l=$v.get(s);if(l&&l[0]===i)return l[1];const c={error:Jc("error",s,i),warn:Jc("warn",s,i),info:Jc("info",s,i),debug:Jc("debug",s,i)};return $v.set(s,[i,c]),c}const ti=n=>(n.options&&(n.options=Object.assign({},n.options),delete n.options.headers),n.headers&&(n.headers=Object.fromEntries((n.headers instanceof Headers?[...n.headers]:Object.entries(n.headers)).map(([a,s])=>[a,a.toLowerCase()==="x-goog-api-key"||a.toLowerCase()==="authorization"||a.toLowerCase()==="cookie"||a.toLowerCase()==="set-cookie"?"***":s]))),"retryOfRequestLogID"in n&&(n.retryOfRequestLogID&&(n.retryOf=n.retryOfRequestLogID),delete n.retryOfRequestLogID),n);/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Xi{constructor(a,s,i){this.iterator=a,this.controller=s,this.client=i}static fromSSEResponse(a,s,i){let l=!1;const c=i?Xn(i):console;function d(){return hl(this,arguments,function*(){var p,h,v,S;if(l)throw new Yr("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");l=!0;let A=!1;try{try{for(var _=!0,E=to(mw(a,s)),w;w=yield un(E.next()),p=w.done,!p;_=!0){S=w.value,_=!1;const k=S;if(!A)if(k.data.startsWith("[DONE]")){A=!0;continue}else try{yield yield un(JSON.parse(k.data))}catch(N){throw c.error("Could not parse message into JSON:",k.data),c.error("From chunk:",k.raw),N}}}catch(k){h={error:k}}finally{try{!_&&!p&&(v=E.return)&&(yield un(v.call(E)))}finally{if(h)throw h.error}}A=!0}catch(k){if(Dh(k))return yield un(void 0);throw k}finally{A||s.abort()}})}return new Xi(d,s,i)}static fromReadableStream(a,s,i){let l=!1;function c(){return hl(this,arguments,function*(){var p,h,v,S;const A=new Tu,_=Yb(a);try{for(var E=!0,w=to(_),k;k=yield un(w.next()),p=k.done,!p;E=!0){S=k.value,E=!1;const N=S;for(const I of A.decode(N))yield yield un(I)}}catch(N){h={error:N}}finally{try{!E&&!p&&(v=w.return)&&(yield un(v.call(w)))}finally{if(h)throw h.error}}for(const N of A.flush())yield yield un(N)})}function d(){return hl(this,arguments,function*(){var p,h,v,S;if(l)throw new Yr("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");l=!0;let A=!1;try{try{for(var _=!0,E=to(c()),w;w=yield un(E.next()),p=w.done,!p;_=!0){S=w.value,_=!1;const k=S;A||k&&(yield yield un(JSON.parse(k)))}}catch(k){h={error:k}}finally{try{!_&&!p&&(v=E.return)&&(yield un(v.call(E)))}finally{if(h)throw h.error}}A=!0}catch(k){if(Dh(k))return yield un(void 0);throw k}finally{A||s.abort()}})}return new Xi(d,s,i)}[Symbol.asyncIterator](){return this.iterator()}tee(){const a=[],s=[],i=this.iterator(),l=c=>({next:()=>{if(c.length===0){const d=i.next();a.push(d),s.push(d)}return c.shift()}});return[new Xi(()=>l(a),this.controller,this.client),new Xi(()=>l(s),this.controller,this.client)]}toReadableStream(){const a=this;let s;return Pb({async start(){s=a[Symbol.asyncIterator]()},async pull(i){try{const{value:l,done:c}=await s.next();if(c)return i.close();const d=Ph(JSON.stringify(l)+`
`);i.enqueue(d)}catch(l){i.error(l)}},async cancel(){var i;await((i=s.return)===null||i===void 0?void 0:i.call(s))}})}}function mw(n,a){return hl(this,arguments,function*(){var i,l,c,d;if(!n.body)throw a.abort(),typeof globalThis.navigator<"u"&&globalThis.navigator.product==="ReactNative"?new Yr("The default react-native fetch implementation does not support streaming. Please use expo/fetch: https://docs.expo.dev/versions/latest/sdk/expo/#expofetch-api"):new Yr("Attempted to iterate over a response with no body");const m=new gw,p=new Tu,h=Yb(n.body);try{for(var v=!0,S=to(pw(h)),A;A=yield un(S.next()),i=A.done,!i;v=!0){d=A.value,v=!1;const _=d;for(const E of p.decode(_)){const w=m.decode(E);w&&(yield yield un(w))}}}catch(_){l={error:_}}finally{try{!v&&!i&&(c=S.return)&&(yield un(c.call(S)))}finally{if(l)throw l.error}}for(const _ of p.flush()){const E=m.decode(_);E&&(yield yield un(E))}})}function pw(n){return hl(this,arguments,function*(){var s,i,l,c;let d=new Uint8Array;try{for(var m=!0,p=to(n),h;h=yield un(p.next()),s=h.done,!s;m=!0){c=h.value,m=!1;const v=c;if(v==null)continue;const S=v instanceof ArrayBuffer?new Uint8Array(v):typeof v=="string"?Ph(v):v;let A=new Uint8Array(d.length+S.length);A.set(d),A.set(S,d.length),d=A;let _;for(;(_=fw(d))!==-1;)yield yield un(d.slice(0,_)),d=d.slice(_)}}catch(v){i={error:v}}finally{try{!m&&!s&&(l=p.return)&&(yield un(l.call(p)))}finally{if(i)throw i.error}}d.length>0&&(yield yield un(d))})}class gw{constructor(){this.event=null,this.data=[],this.chunks=[]}decode(a){if(a.endsWith("\r")&&(a=a.substring(0,a.length-1)),!a){if(!this.event&&!this.data.length)return null;const c={event:this.event,data:this.data.join(`
`),raw:this.chunks};return this.event=null,this.data=[],this.chunks=[],c}if(this.chunks.push(a),a.startsWith(":"))return null;let[s,i,l]=yw(a,":");return l.startsWith(" ")&&(l=l.substring(1)),s==="event"?this.event=l:s==="data"&&this.data.push(l),null}}function yw(n,a){const s=n.indexOf(a);return s!==-1?[n.substring(0,s),a,n.substring(s+a.length)]:[n,"",""]}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */async function vw(n,a){const{response:s,requestLogID:i,retryOfRequestLogID:l,startTime:c}=a,d=await(async()=>{var m;if(a.options.stream)return Xn(n).debug("response",s.status,s.url,s.headers,s.body),a.options.__streamClass?a.options.__streamClass.fromSSEResponse(s,a.controller,n):Xi.fromSSEResponse(s,a.controller,n);if(s.status===204)return null;if(a.options.__binaryResponse)return s;const p=s.headers.get("content-type"),h=(m=p==null?void 0:p.split(";")[0])===null||m===void 0?void 0:m.trim();return(h==null?void 0:h.includes("application/json"))||(h==null?void 0:h.endsWith("+json"))?await s.json():await s.text()})();return Xn(n).debug(`[${i}] response parsed`,ti({retryOfRequestLogID:l,url:s.url,status:s.status,body:d,durationMs:Date.now()-c})),d}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Yh extends Promise{constructor(a,s,i=vw){super(l=>{l(null)}),this.responsePromise=s,this.parseResponse=i,this.client=a}_thenUnwrap(a){return new Yh(this.client,this.responsePromise,async(s,i)=>a(await this.parseResponse(s,i),i))}asResponse(){return this.responsePromise.then(a=>a.response)}async withResponse(){const[a,s]=await Promise.all([this.parse(),this.asResponse()]);return{data:a,response:s}}parse(){return this.parsedPromise||(this.parsedPromise=this.responsePromise.then(a=>this.parseResponse(this.client,a))),this.parsedPromise}then(a,s){return this.parse().then(a,s)}catch(a){return this.parse().catch(a)}finally(a){return this.parse().finally(a)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Xb=Symbol("brand.privateNullableHeaders");function*bw(n){if(!n)return;if(Xb in n){const{values:i,nulls:l}=n;yield*i.entries();for(const c of l)yield[c,null];return}let a=!1,s;n instanceof Headers?s=n.entries():Bv(n)?s=n:(a=!0,s=Object.entries(n??{}));for(let i of s){const l=i[0];if(typeof l!="string")throw new TypeError("expected header name to be a string");const c=Bv(i[1])?i[1]:[i[1]];let d=!1;for(const m of c)m!==void 0&&(a&&!d&&(d=!0,yield[l,null]),yield[l,m])}}const rl=n=>{const a=new Headers,s=new Set;for(const i of n){const l=new Set;for(const[c,d]of bw(i)){const m=c.toLowerCase();l.has(m)||(a.delete(c),l.add(m)),d===null?(a.delete(c),s.add(m)):(a.append(c,d),s.delete(m))}}return{[Xb]:!0,values:a,nulls:s}};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const rh=n=>{var a,s,i,l,c,d;if(typeof globalThis.process<"u")return(i=(s=(a=z1)===null||a===void 0?void 0:a[n])===null||s===void 0?void 0:s.trim())!==null&&i!==void 0?i:void 0;if(typeof globalThis.Deno<"u")return(d=(c=(l=globalThis.Deno.env)===null||l===void 0?void 0:l.get)===null||c===void 0?void 0:c.call(l,n))===null||d===void 0?void 0:d.trim()};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var Wb;class Au{constructor(a){var s,i,l,c,d,m,p,{baseURL:h=rh("GEMINI_NEXT_GEN_API_BASE_URL"),apiKey:v=(s=rh("GEMINI_API_KEY"))!==null&&s!==void 0?s:null,apiVersion:S="v1beta"}=a,A=bu(a,["baseURL","apiKey","apiVersion"]);const _=Object.assign(Object.assign({apiKey:v,apiVersion:S},A),{baseURL:h||"https://generativelanguage.googleapis.com"});this.baseURL=_.baseURL,this.timeout=(i=_.timeout)!==null&&i!==void 0?i:Au.DEFAULT_TIMEOUT,this.logger=(l=_.logger)!==null&&l!==void 0?l:console;const E="warn";this.logLevel=E,this.logLevel=(d=(c=Yv(_.logLevel,"ClientOptions.logLevel",this))!==null&&c!==void 0?c:Yv(rh("GEMINI_NEXT_GEN_API_LOG"),"process.env['GEMINI_NEXT_GEN_API_LOG']",this))!==null&&d!==void 0?d:E,this.fetchOptions=_.fetchOptions,this.maxRetries=(m=_.maxRetries)!==null&&m!==void 0?m:2,this.fetch=(p=_.fetch)!==null&&p!==void 0?p:W1(),this.encoder=nw,this._options=_,this.apiKey=v,this.apiVersion=S,this.clientAdapter=_.clientAdapter}withOptions(a){return new this.constructor(Object.assign(Object.assign(Object.assign({},this._options),{baseURL:this.baseURL,maxRetries:this.maxRetries,timeout:this.timeout,logger:this.logger,logLevel:this.logLevel,fetch:this.fetch,fetchOptions:this.fetchOptions,apiKey:this.apiKey,apiVersion:this.apiVersion}),a))}baseURLOverridden(){return this.baseURL!=="https://generativelanguage.googleapis.com"}defaultQuery(){return this._options.defaultQuery}validateHeaders({values:a,nulls:s}){if(!(a.has("authorization")||a.has("x-goog-api-key"))&&!(this.apiKey&&a.get("x-goog-api-key"))&&!s.has("x-goog-api-key"))throw new Error('Could not resolve authentication method. Expected the apiKey to be set. Or for the "x-goog-api-key" headers to be explicitly omitted')}async authHeaders(a){const s=rl([a.headers]);if(!(s.values.has("authorization")||s.values.has("x-goog-api-key"))){if(this.apiKey)return rl([{"x-goog-api-key":this.apiKey}]);if(this.clientAdapter.isVertexAI())return rl([await this.clientAdapter.getAuthHeaders()])}}stringifyQuery(a){return Object.entries(a).filter(([s,i])=>typeof i<"u").map(([s,i])=>{if(typeof i=="string"||typeof i=="number"||typeof i=="boolean")return`${encodeURIComponent(s)}=${encodeURIComponent(i)}`;if(i===null)return`${encodeURIComponent(s)}=`;throw new Yr(`Cannot stringify type ${typeof i}; Expected string, number, boolean, or null. If you need to pass nested query parameters, you can manually encode them, e.g. { query: { 'foo[key1]': value1, 'foo[key2]': value2 } }, and please open a GitHub issue requesting better support for your use case.`)}).join("&")}getUserAgent(){return`${this.constructor.name}/JS ${Qi}`}defaultIdempotencyKey(){return`stainless-node-retry-${F1()}`}makeStatusError(a,s,i,l){return tr.generate(a,s,i,l)}buildURL(a,s,i){const l=!this.baseURLOverridden()&&i||this.baseURL,c=H1(a)?new URL(a):new URL(l+(l.endsWith("/")&&a.startsWith("/")?a.slice(1):a)),d=this.defaultQuery();return P1(d)||(s=Object.assign(Object.assign({},d),s)),typeof s=="object"&&s&&!Array.isArray(s)&&(c.search=this.stringifyQuery(s)),c.toString()}async prepareOptions(a){if(this.clientAdapter&&this.clientAdapter.isVertexAI()&&!a.path.startsWith(`/${this.apiVersion}/projects/`)){const s=a.path.slice(this.apiVersion.length+1);a.path=`/${this.apiVersion}/projects/${this.clientAdapter.getProject()}/locations/${this.clientAdapter.getLocation()}${s}`}}async prepareRequest(a,{url:s,options:i}){}get(a,s){return this.methodRequest("get",a,s)}post(a,s){return this.methodRequest("post",a,s)}patch(a,s){return this.methodRequest("patch",a,s)}put(a,s){return this.methodRequest("put",a,s)}delete(a,s){return this.methodRequest("delete",a,s)}methodRequest(a,s,i){return this.request(Promise.resolve(i).then(l=>Object.assign({method:a,path:s},l)))}request(a,s=null){return new Yh(this,this.makeRequest(a,s,void 0))}async makeRequest(a,s,i){var l,c,d;const m=await a,p=(l=m.maxRetries)!==null&&l!==void 0?l:this.maxRetries;s==null&&(s=p),await this.prepareOptions(m);const{req:h,url:v,timeout:S}=await this.buildRequest(m,{retryCount:p-s});await this.prepareRequest(h,{url:v,options:m});const A="log_"+(Math.random()*(1<<24)|0).toString(16).padStart(6,"0"),_=i===void 0?"":`, retryOf: ${i}`,E=Date.now();if(Xn(this).debug(`[${A}] sending request`,ti({retryOfRequestLogID:i,method:m.method,url:v,options:m,headers:h.headers})),!((c=m.signal)===null||c===void 0)&&c.aborted)throw new Oh;const w=new AbortController,k=await this.fetchWithTimeout(v,h,S,w).catch(Ch),N=Date.now();if(k instanceof globalThis.Error){const M=`retrying, ${s} attempts remaining`;if(!((d=m.signal)===null||d===void 0)&&d.aborted)throw new Oh;const F=Dh(k)||/timed? ?out/i.test(String(k)+("cause"in k?String(k.cause):""));if(s)return Xn(this).info(`[${A}] connection ${F?"timed out":"failed"} - ${M}`),Xn(this).debug(`[${A}] connection ${F?"timed out":"failed"} (${M})`,ti({retryOfRequestLogID:i,url:v,durationMs:N-E,message:k.message})),this.retryRequest(m,s,i??A);throw Xn(this).info(`[${A}] connection ${F?"timed out":"failed"} - error; no more retries left`),Xn(this).debug(`[${A}] connection ${F?"timed out":"failed"} (error; no more retries left)`,ti({retryOfRequestLogID:i,url:v,durationMs:N-E,message:k.message})),F?new Mb:new ku({cause:k})}const I=`[${A}${_}] ${h.method} ${v} ${k.ok?"succeeded":"failed"} with status ${k.status} in ${N-E}ms`;if(!k.ok){const M=await this.shouldRetry(k);if(s&&M){const O=`retrying, ${s} attempts remaining`;return await tw(k.body),Xn(this).info(`${I} - ${O}`),Xn(this).debug(`[${A}] response error (${O})`,ti({retryOfRequestLogID:i,url:k.url,status:k.status,headers:k.headers,durationMs:N-E})),this.retryRequest(m,s,i??A,k.headers)}const F=M?"error; no more retries left":"error; not retryable";Xn(this).info(`${I} - ${F}`);const q=await k.text().catch(O=>Ch(O).message),Q=V1(q),U=Q?void 0:q;throw Xn(this).debug(`[${A}] response error (${F})`,ti({retryOfRequestLogID:i,url:k.url,status:k.status,headers:k.headers,message:U,durationMs:Date.now()-E})),this.makeStatusError(k.status,Q,U,k.headers)}return Xn(this).info(I),Xn(this).debug(`[${A}] response start`,ti({retryOfRequestLogID:i,url:k.url,status:k.status,headers:k.headers,durationMs:N-E})),{response:k,options:m,controller:w,requestLogID:A,retryOfRequestLogID:i,startTime:E}}async fetchWithTimeout(a,s,i,l){const c=s||{},{signal:d,method:m}=c,p=bu(c,["signal","method"]);d&&d.addEventListener("abort",()=>l.abort());const h=setTimeout(()=>l.abort(),i),v=globalThis.ReadableStream&&p.body instanceof globalThis.ReadableStream||typeof p.body=="object"&&p.body!==null&&Symbol.asyncIterator in p.body,S=Object.assign(Object.assign(Object.assign({signal:l.signal},v?{duplex:"half"}:{}),{method:"GET"}),p);m&&(S.method=m.toUpperCase());try{return await this.fetch.call(void 0,a,S)}finally{clearTimeout(h)}}async shouldRetry(a){const s=a.headers.get("x-should-retry");return s==="true"?!0:s==="false"?!1:a.status===408||a.status===409||a.status===429||a.status>=500}async retryRequest(a,s,i,l){var c;let d;const m=l==null?void 0:l.get("retry-after-ms");if(m){const h=parseFloat(m);Number.isNaN(h)||(d=h)}const p=l==null?void 0:l.get("retry-after");if(p&&!d){const h=parseFloat(p);Number.isNaN(h)?d=Date.parse(p)-Date.now():d=h*1e3}if(!(d&&0<=d&&d<60*1e3)){const h=(c=a.maxRetries)!==null&&c!==void 0?c:this.maxRetries;d=this.calculateDefaultRetryTimeoutMillis(s,h)}return await Z1(d),this.makeRequest(a,s-1,i)}calculateDefaultRetryTimeoutMillis(a,s){const c=s-a,d=Math.min(.5*Math.pow(2,c),8),m=1-Math.random()*.25;return d*m*1e3}async buildRequest(a,{retryCount:s=0}={}){var i,l,c;const d=Object.assign({},a),{method:m,path:p,query:h,defaultBaseURL:v}=d,S=this.buildURL(p,h,v);"timeout"in d&&$1("timeout",d.timeout),d.timeout=(i=d.timeout)!==null&&i!==void 0?i:this.timeout;const{bodyHeaders:A,body:_}=this.buildBody({options:d}),E=await this.buildHeaders({options:a,method:m,bodyHeaders:A,retryCount:s});return{req:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({method:m,headers:E},d.signal&&{signal:d.signal}),globalThis.ReadableStream&&_ instanceof globalThis.ReadableStream&&{duplex:"half"}),_&&{body:_}),(l=this.fetchOptions)!==null&&l!==void 0?l:{}),(c=d.fetchOptions)!==null&&c!==void 0?c:{}),url:S,timeout:d.timeout}}async buildHeaders({options:a,method:s,bodyHeaders:i,retryCount:l}){let c={};this.idempotencyHeader&&s!=="get"&&(a.idempotencyKey||(a.idempotencyKey=this.defaultIdempotencyKey()),c[this.idempotencyHeader]=a.idempotencyKey);const d=await this.authHeaders(a);let m=rl([c,Object.assign(Object.assign({Accept:"application/json","User-Agent":this.getUserAgent(),"X-Stainless-Retry-Count":String(l)},a.timeout?{"X-Stainless-Timeout":String(Math.trunc(a.timeout/1e3))}:{}),X1()),this._options.defaultHeaders,i,a.headers,d]);return this.validateHeaders(m),m.values}buildBody({options:{body:a,headers:s}}){if(!a)return{bodyHeaders:void 0,body:void 0};const i=rl([s]);return ArrayBuffer.isView(a)||a instanceof ArrayBuffer||a instanceof DataView||typeof a=="string"&&i.values.has("content-type")||globalThis.Blob&&a instanceof globalThis.Blob||a instanceof FormData||a instanceof URLSearchParams||globalThis.ReadableStream&&a instanceof globalThis.ReadableStream?{bodyHeaders:void 0,body:a}:typeof a=="object"&&(Symbol.asyncIterator in a||Symbol.iterator in a&&"next"in a&&typeof a.next=="function")?{bodyHeaders:void 0,body:ew(a)}:this.encoder({body:a,headers:i})}}Au.DEFAULT_TIMEOUT=6e4;class Gn extends Au{constructor(){super(...arguments),this.interactions=new Jb(this)}}Wb=Gn;Gn.GeminiNextGenAPIClient=Wb;Gn.GeminiNextGenAPIClientError=Yr;Gn.APIError=tr;Gn.APIConnectionError=ku;Gn.APIConnectionTimeoutError=Mb;Gn.APIUserAbortError=Oh;Gn.NotFoundError=Fb;Gn.ConflictError=Bb;Gn.RateLimitError=Gb;Gn.BadRequestError=Ub;Gn.AuthenticationError=Lb;Gn.InternalServerError=qb;Gn.PermissionDeniedError=zb;Gn.UnprocessableEntityError=Hb;Gn.toFile=ow;Gn.Interactions=Jb;const rn=()=>{throw new Error("API Key missing from environment (process.env.API_KEY)")},qn=n=>{const a=n.replace(/```json/g,"").replace(/```/g,"").trim();return JSON.parse(a)},Ak=async(n,a)=>{const s=rn(),i=`
        Analyze the following educational content and suggest a high-quality name and a detailed, engaging HTML description.
        
        CONTENT:
        ${n}
        
        TASK:
        1. Suggest a concise, descriptive name (e.g., "Level 1.1: Introduction to X").
        2. Suggest a 2-4 sentence description using HTML tags like <b> and <i> for emphasis. Focus on what the user will learn.
        
        JSON SCHEMA:
        {
            "name": "string",
            "description": "string (HTML)"
        }
        
        ONLY return raw JSON.
    `,l=await s.models.generateContent({model:"gemini-3-flash-preview",contents:i,config:{responseMimeType:"application/json"}});return qn(l.text||"{}")},xw=async(n,a,s)=>{const i=rn(),l=`Generate a learning outline for ${n.topic} at ${n.understanding} level. ${n.generationType.includes("learning")?`Requested comprehensiveness: ${n.comprehensiveness}.`:""} ${n.generationType==="rework-deck"?`USER REWORK INSTRUCTIONS: ${n.reworkInstructions}`:""}`;return{outline:(await i.models.generateContent({model:"gemini-3-flash-preview",contents:l})).text||"",metadata:{name:n.topic}}},_w=async(n,a,s)=>(await rn().models.generateContent({model:"gemini-3-flash-preview",contents:"Refine this outline based on feedback."})).text||"",Sw=async(n,a)=>{const i=await rn().models.generateContent({model:"gemini-3-pro-preview",contents:`Generate questions based on this outline: ${n}`,config:{responseMimeType:"application/json"}});return qn(i.text||"{}")},ww=async(n,a)=>{const i=await rn().models.generateContent({model:"gemini-3-flash-preview",contents:`Generate a series scaffold from this outline: ${n}`,config:{responseMimeType:"application/json"}});return qn(i.text||"{}")},Ew=async(n,a)=>{const s=rn(),i=`
        Create a high-quality flashcard deck for the topic: "${n.topic}".
        Persona: ${a.instruction}
        Target Level: ${n.understanding}
        
        TASK:
        1. Generate a compelling name and HTML description for the deck.
        2. Generate ${n.count||15} cards.
        
        JSON SCHEMA:
        {
            "name": "...",
            "description": "...",
            "cards": [{ "front": "...", "back": "..." }]
        }
        
        ONLY return raw JSON.
    `,l=await s.models.generateContent({model:"gemini-3-pro-preview",contents:i,config:{responseMimeType:"application/json"}});return qn(l.text||"{}")},ah=async(n,a="Standard",s)=>{const i=rn();let l="Generate 8-12 instructional chapters (InfoCards).",c="Each InfoCard should be detailed and educational.";a==="Exhaustive"?(l="Generate a TRULY EXHAUSTIVE and MASTER-LEVEL curriculum. You MUST provide at least 20 detailed instructional chapters (InfoCards).",c="CRITICAL: Each InfoCard (chapter) MUST be extremely thorough and lengthy. A single chapter should feel like several pages of high-quality textbook material. Use multiple headers, deep-dive into nuances, include historical context, edge cases, and practical examples. Do not hold back on word count."):a==="Quick Overview"?l="Generate 3-5 concise instructional chapters (InfoCards).":a==="Comprehensive"&&(l="Generate 15-20 detailed instructional chapters (InfoCards).",c="Each InfoCard should be a substantial read, covering topics in significant depth.");const d=`
        Act as a world-class subject matter expert and instructional designer. Create a ${s?"deep-dive structured course":"comprehensive learning guide"} for the topic: "${n}".
        
        ${l}
        ${c}
        
        REQUIREMENTS:
        1. Each InfoCard MUST use rich HTML formatting (h2, h3 headers, bolding, lists, blockquotes).
        2. For EACH InfoCard, generate 1 to 4 multiple-choice questions that specifically test the nuanced content introduced in that card. The number of questions should vary depending on the density and importance of the card's information.
        3. Ensure a logical progression from foundational concepts to advanced, interdisciplinary applications.
        4. Every question must have high-quality, pedagogical explanations for every option.
        5. Generate a compelling, professional name for this course and a detailed HTML description summarizing the learning objectives.
        
        JSON SCHEMA:
        {
            "name": "The Course Title",
            "description": "HTML summary of the course...",
            "infoCards": [
                {
                    "id": "chap-1",
                    "content": "EXTENSIVE HTML instructional text (aim for 500-1000 words per card if Exhaustive)...",
                    "unlocksQuestionIds": ["q-1", "q-2"]
                }
            ],
            "questions": [
                {
                    "id": "q-1",
                    "questionText": "...",
                    "options": [{ "id": "o1", "text": "...", "explanation": "..." }],
                    "correctAnswerId": "o1",
                    "detailedExplanation": "..."
                }
            ]
        }
        
        ONLY return raw JSON.
    `,m=await i.models.generateContent({model:"gemini-3-pro-preview",contents:d,config:{responseMimeType:"application/json",thinkingConfig:{thinkingBudget:32768}}});return qn(m.text||"{}")},kw=async(n,a)=>{const s=rn(),i=n.type===Ne.Flashcard?`${n.cards.length} flashcards`:n.type===Ne.Learning?`${n.infoCards.length} chapters and ${n.questions.length} questions`:`${n.questions.length} questions`,l=`
        You are an expert instructional designer. Rework the following deck titled "${n.name}".
        
        CURRENT DECK TYPE: ${n.type}
        CURRENT CONTENT SUMMARY: ${i}
        USER REWORK INSTRUCTIONS: "${a.reworkInstructions}"
        COMPREHENSIVENESS: ${a.comprehensiveness}
        TARGET AUDIENCE LEVEL: ${a.understanding}
        
        TASK:
        1. Fully regenerate the deck content (infoCards, questions, or cards) while maintaining the original theme but improving quality according to the instructions.
        2. If instructions specify a shift in focus or difficulty, apply that shift.
        3. Maintain the original IDs if possible for items that are being refined rather than replaced, but feel free to add/remove items to match the requested comprehensiveness.
        4. Use rich HTML formatting for all text.
        5. Generate a new, improved name and description based on the reworked content.
        
        JSON SCHEMA (MUST MATCH ORIGINAL TYPE ${n.type}):
        {
          "name": "...",
          "description": "...",
          ${n.type===Ne.Flashcard?'"cards": [{ "front": "...", "back": "..." }]':n.type===Ne.Quiz?'"questions": [{ "questionText": "...", "options": [...], "correctAnswerId": "...", "detailedExplanation": "..." }]':'"infoCards": [{ "content": "...", "unlocksQuestionIds": ["..."] }], "questions": [{ "id": "...", "questionText": "...", "options": [...], "correctAnswerId": "...", "detailedExplanation": "..." }]'}
        }
        
        ONLY return raw JSON.
    `,c=await s.models.generateContent({model:"gemini-3-pro-preview",contents:l,config:{responseMimeType:"application/json"}});return qn(c.text||"{}")},Tw=async(n,a,s)=>{const l=await rn().models.generateContent({model:"gemini-3-pro-preview",contents:`Generate ${a} questions for ${n.name}`,config:{responseMimeType:"application/json"}});return qn(l.text||"[]")},Aw=async n=>{const a=rn();let s="";n.type===Ne.Flashcard?s=n.cards.map(c=>`Card Front: ${c.front}`).join(`
`):n.type===Ne.Quiz&&(s=n.questions.map(c=>`Question: ${c.questionText}`).join(`
`));const i=`
        Upgrade this deck named "${n.name}" into a comprehensive Learning Deck (Course).
        
        The deck currently contains these items:
        ${s}
        
        TASK:
        1. Analyze the concepts covered in the items.
        2. Generate 3-8 instructional "InfoCards" (chapters) that explain these concepts in a structured, progressive way.
        3. Use high-quality HTML formatting for the InfoCards (bolding, headers, lists).
        4. For each InfoCard, you MUST decide which of the existing question/card IDs should be "unlocked" after reading it.
        5. Map existing item IDs to the new InfoCards using the "unlocksQuestionIds" field.
        
        EXISTING IDS:
        ${(n.type===Ne.Flashcard?n.cards:n.questions).map(c=>`- ${c.id}: ${"front"in c?c.front:c.questionText}`).join(`
`)}

        JSON SCHEMA:
        {
            "infoCards": [
                {
                    "id": "unique-id",
                    "content": "HTML instructional content...",
                    "unlocksQuestionIds": ["existing-id-1", "existing-id-2"]
                }
            ]
        }
        
        ONLY return raw JSON.
    `,l=await a.models.generateContent({model:"gemini-3-pro-preview",contents:i,config:{responseMimeType:"application/json"}});return qn(l.text||"{}")},Nk=async(n,a)=>(await rn().models.generateContent({model:"gemini-3-flash-preview",contents:`Create a mnemonic to remember: ${n} means ${a}`})).text||"",Dk=async(n,a)=>(await rn().models.generateContent({model:"gemini-3-flash-preview",contents:`Explain like I'm 5: ${n}. Context: ${a}`})).text||"",sh=async n=>{var i,l,c,d,m,p;return((p=(m=(d=(c=(l=(i=(await rn().models.generateContent({model:"gemini-2.5-flash-preview-tts",contents:[{parts:[{text:n}]}],config:{responseModalities:[Nh.AUDIO],speechConfig:{voiceConfig:{prebuiltVoiceConfig:{voiceName:"Kore"}}}}})).candidates)==null?void 0:i[0])==null?void 0:l.content)==null?void 0:c.parts)==null?void 0:d[0])==null?void 0:m.inlineData)==null?void 0:p.data)||""},Nw=async(n,a)=>((await rn().models.generateContent({model:"gemini-3-flash-preview",contents:`Suggest a single-word icon name from Lucide library for deck: ${n}`})).text||"book").trim(),Dw=async n=>{const s=await rn().models.generateContent({model:"gemini-3-flash-preview",contents:`Generate relevant tags for these questions: ${JSON.stringify(n)}`,config:{responseMimeType:"application/json"}});return qn(s.text||"{}")},Cw=async(n,a,s)=>(await rn().models.generateContent({model:"gemini-3-flash-preview",contents:`Provide 3 concrete usage examples for: ${n} / ${a}. Context: ${s}`})).text||"",Vv=async(n,a,s,i)=>{const c=await rn().models.generateContent({model:"gemini-3-pro-preview",contents:`Create better distractors for: ${n}. Correct: ${a}. Context: ${i}`,config:{responseMimeType:"application/json"}});return qn(c.text||"[]")},Ow=async(n,a,s)=>(await rn().models.generateContent({model:"gemini-3-flash-preview",contents:`Expand on "${s}" in the context of ${n}. Original text: ${a}`})).text||"",Zv=async(n,a,s)=>{const l=await rn().models.generateContent({model:"gemini-3-flash-preview",contents:`Generate a structured learning path for ${n}. Description: ${a}`,config:{responseMimeType:"application/json"}});return qn(l.text||"{}")},jw=async(n,a,s,i)=>{const c=await rn().models.generateContent({model:"gemini-3-flash-preview",contents:`Suggest new decks for level ${s} in series ${n}`,config:{responseMimeType:"application/json"}});return qn(c.text||"[]")},Iw=async(n,a)=>{const i=await rn().models.generateContent({model:"gemini-3-pro-preview",contents:`Regenerate this question for ${a}: ${JSON.stringify(n)}`,config:{responseMimeType:"application/json"}});return qn(i.text||"{}")},Rw=async n=>{const a=rn();let s="";if(n.type===Ne.Flashcard)s=`Flashcard Deck with ${n.cards.length} cards.`;else if(n.type===Ne.Quiz)s=`Quiz Deck with ${n.questions.length} questions.`;else if(n.type===Ne.Learning){const c=n;s=`Learning Deck (Course) with ${c.infoCards.length} chapters (InfoCards) and ${c.questions.length} questions.`}const i=`
        You are a pedagogical expert analyzing educational content for a spaced repetition app.
        Analyze the following deck named "${n.name}" and provide specific, actionable improvement suggestions.
        
        DECK TYPE: ${n.type}
        CONTENT SUMMARY: ${s}
        DECK DATA:
        ${JSON.stringify(n)}
        
        TASK:
        Identify issues such as:
        1. Ambiguous questions or answers.
        2. Factual inaccuracies.
        3. Spelling/Grammar errors.
        4. Poor HTML formatting (lack of bolding for key terms).
        5. (For Learning Decks) Misalignment between InfoCards (instructional text) and the Questions they are supposed to "unlock".
        6. (For Learning Decks) Important concepts mentioned in InfoCards that lack a corresponding quiz question.
        7. (For Learning Decks) Questions that test material not covered in the InfoCards.
        
        OUTPUT FORMAT:
        Return an array of suggestion objects with the following schema:
        {
            "id": "unique-slug",
            "title": "Short title of improvement",
            "category": "Instructional Alignment | Accuracy | Formatting | Clarity",
            "description": "What needs to be changed (be specific)",
            "rationale": "Why this change improves the learning experience",
            "targetId": "Optional ID of the specific InfoCard or Question being targeted"
        }
        
        ONLY return raw JSON.
    `,l=await a.models.generateContent({model:"gemini-3-pro-preview",contents:i,config:{responseMimeType:"application/json"}});return qn(l.text||"[]")},Mw=async(n,a)=>{const s=rn(),i=`
        You are a content editor. Apply the following pedagogical improvements to the provided deck.
        
        IMPROVEMENTS TO APPLY:
        ${JSON.stringify(a)}
        
        ORIGINAL DECK:
        ${JSON.stringify(n)}
        
        INSTRUCTIONS:
        1. Rewrite or restructure the deck content based on the suggestions.
        2. Ensure the output is a single valid JSON object matching the original deck's schema (${n.type}).
        3. Maintain all existing IDs (deck, question, card, infoCard) unless the suggestion explicitly asks to remove/add items.
        4. If it's a Learning Deck, ensure the mapping of 'unlocksQuestionIds' in InfoCards and 'infoCardIds' in Questions is accurate and consistent with the new content.
        5. Generate a new, improved name and description based on the reworked content.
        
        ONLY return the raw JSON for the updated deck.
    `,l=await s.models.generateContent({model:"gemini-3-pro-preview",contents:i,config:{responseMimeType:"application/json"}});return qn(l.text||"{}")},e0=async(n,a,s)=>{const l=await rn().models.generateContent({model:"gemini-2.5-flash-image",contents:{parts:[{inlineData:{data:n,mimeType:a}},{text:`Create a flashcard deck from this image. Topic hint: ${s}`}]}});return qn(l.text||"{}")},Uw=async n=>{const s=await rn().models.generateContent({model:"gemini-3-flash-preview",contents:`Suggest related learning topics for: ${JSON.stringify(n)}`,config:{responseMimeType:"application/json"}});return qn(s.text||"[]")},Lw={success:u.jsx(ze,{name:"check-circle",className:"w-6 h-6 text-green-500"}),error:u.jsx(ze,{name:"x-circle",className:"w-6 h-6 text-red-500"}),info:u.jsx(ze,{name:"info",className:"w-6 h-6 text-blue-500"}),warning:u.jsx(ze,{name:"info",className:"w-6 h-6 text-yellow-500"})},zw=({message:n,onDismiss:a})=>(G.useEffect(()=>{const s=setTimeout(()=>{a(n.id)},5e3);return()=>{clearTimeout(s)}},[n.id,a]),u.jsx("div",{className:"bg-surface shadow-lg rounded-lg pointer-events-auto ring-1 ring-black ring-opacity-5 overflow-hidden animate-fade-in-right",children:u.jsx("div",{className:"p-4",children:u.jsxs("div",{className:"flex items-start",children:[u.jsx("div",{className:"flex-shrink-0",children:Lw[n.type]}),u.jsx("div",{className:"ml-3 w-0 flex-1 pt-0.5",children:u.jsx("p",{className:"text-sm font-medium text-text break-words",children:n.message})}),u.jsx("div",{className:"ml-4 flex-shrink-0 flex",children:u.jsxs("button",{onClick:()=>a(n.id),className:"bg-surface rounded-md inline-flex text-text-muted hover:text-text focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-surface focus:ring-primary",children:[u.jsx("span",{className:"sr-only",children:"Close"}),u.jsx(ze,{name:"x",className:"h-5 w-5"})]})})]})})})),t0=G.createContext(void 0),Fw=({children:n})=>{const[a,s]=G.useState([]),i=G.useCallback((c,d)=>{const m=crypto.randomUUID();s(p=>[...p,{id:m,message:c,type:d}])},[]),l=G.useCallback(c=>{s(d=>d.filter(m=>m.id!==c))},[]);return u.jsxs(t0.Provider,{value:{addToast:i},children:[n,u.jsx("div",{className:"fixed top-5 right-5 z-[100] w-full max-w-xs space-y-3",children:a.map(c=>u.jsx(zw,{message:c,onDismiss:l},c.id))})]})},Nn=()=>{const n=G.useContext(t0);if(n===void 0)throw new Error("useToast must be used within a ToastProvider");return n},$r=({size:n="md"})=>{const a={sm:"h-6 w-6",md:"h-10 w-10",lg:"h-16 w-16"};return u.jsx("div",{className:"flex justify-center items-center",role:"status","aria-label":"Loading",children:u.jsxs("svg",{className:`animate-spin text-blue-500 dark:text-blue-400 ${a[n]}`,xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[u.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),u.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]})})},n0="Europe/Stockholm",Bw=()=>new Date().toLocaleDateString("sv-SE",{timeZone:n0}),$h=()=>new Date().toLocaleString("sv-SE",{timeZone:n0,year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1}).replace(/ /g,"_").replace(/:/g,"-"),Hw=({isOpen:n,onClose:a,onAddDecks:s,onAddSeriesWithDecks:i})=>{const[l,c]=G.useState("create"),[d,m]=G.useState(""),[p,h]=G.useState(""),[v,S]=G.useState(""),[A,_]=G.useState(!1),[E,w]=G.useState(null),[k,N]=G.useState(null),[I,M]=G.useState(""),F=G.useRef(null),q=G.useRef(null),{addToast:Q}=Nn(),{aiFeaturesEnabled:U}=ii(),{openModal:j}=Cl(),O=G.useRef(null);On(O,n);const B=G.useCallback(()=>{c("create"),m(""),h(""),S(""),_(!1),w(null),N(null),M("")},[]),te=G.useCallback(()=>{B(),a()},[B,a]),L=G.useCallback(R=>{h(R);try{const re=vu(R);(re==null?void 0:re.type)===Ne.Quiz?m(re.data.name):(re==null?void 0:re.type)==="series"&&m(re.data.seriesName)}catch{}},[]),J=G.useCallback(async R=>{if(R){S(R.name),_(!0);try{const re=await Ib(R);if(!re){Q("Unsupported file type. Please upload a JSON, CSV, Anki package, or Image.","error"),S(""),_(!1);return}if(re.type==="backup"||re.type==="anki"||re.type==="image"){_(!1),j("droppedFile",{analysis:re});return}if(re.type==="flashcard"||re.type==="quiz"||re.type==="series"){const oe=JSON.stringify(re.data,null,2);if(L(oe),_(!1),c("paste"),re.type==="flashcard"&&re.fileName){const he=re.fileName.replace(/\.(csv|json)$/i,"");m(he)}Q("File processed. Review content and click Import.","success");return}}catch(re){console.error("Failed to process file:",re),Q(`An error occurred: ${re instanceof Error?re.message:"Unknown error"}`,"error"),B()}}},[Q,L,j,B]),D=R=>{var oe;const re=(oe=R.target.files)==null?void 0:oe[0];if(re){w(re);const he=new FileReader;he.onload=fe=>{var Me;N((Me=fe.target)==null?void 0:Me.result)},he.readAsDataURL(re)}R.target&&(R.target.value="")},ie=G.useCallback(R=>{var oe;R.preventDefault();const re=(oe=R.dataTransfer.files)==null?void 0:oe[0];re&&J(re)},[J]),Z=G.useCallback(R=>{R.preventDefault()},[]),Y=async()=>{if(E){_(!0);try{const R=await new Promise((Me,Fe)=>{const Ce=new FileReader;Ce.onload=()=>{const Ve=Ce.result;Me(Ve.split(",")[1])},Ce.onerror=Fe,Ce.readAsDataURL(E)}),{name:re,description:oe,cards:he}=await e0(R,E.type,I),fe={id:crypto.randomUUID(),name:re||`Image Deck - ${E.name}`,description:oe||`Generated from ${E.name}`,type:Ne.Flashcard,cards:ha(he)};s([fe]),Q(`Deck "${fe.name}" generated successfully.`,"success"),te()}catch(R){console.error(R),Q(`Image generation failed: ${R.message}`,"error"),_(!1)}}},me=G.useCallback(()=>{if(l==="image"){Y();return}if(l==="create"){if(!d.trim()){Q("Please enter a deck name.","error");return}const R={id:crypto.randomUUID(),name:d.trim(),type:Ne.Flashcard,cards:[],description:`An empty deck created on ${Bw()}`};s([R]),Q(`Deck "${R.name}" created.`,"success"),te();return}if(!p){Q("Please paste content or upload a file.","error");return}try{const R=vu(p);if(!R)return;if(R.type==="series"){const{seriesName:oe,seriesDescription:he,levels:fe}=R.data,Me=[],Fe=fe.map(Ve=>{const Qe=Ve.decks.map(ue=>ue.type===Ne.Quiz?{id:crypto.randomUUID(),name:ue.name,description:ue.description,type:Ne.Quiz,questions:qr(ue.questions||[])}:ue.type===Ne.Flashcard?{id:crypto.randomUUID(),name:ue.name,description:ue.description,type:Ne.Flashcard,cards:ha(ue.cards||[])}:null).filter(ue=>ue!==null);return Me.push(...Qe),{title:Ve.title,deckIds:Qe.map(ue=>ue.id)}}),Ce={id:crypto.randomUUID(),type:"series",name:oe,description:he,levels:Fe,archived:!1,createdAt:new Date().toISOString()};i(Ce,Me),te();return}if(!d.trim()){Q("Please enter a deck name.","error");return}let re;if(R.type===Ne.Flashcard){const oe=ha(R.data);re={id:crypto.randomUUID(),name:d.trim(),type:Ne.Flashcard,cards:oe,description:`${oe.length} imported flashcard${oe.length===1?"":"s"}.`}}else{const oe=qr(R.data.questions);re={id:crypto.randomUUID(),name:d.trim(),description:R.data.description,type:Ne.Quiz,questions:oe}}s([re]),Q(`Deck "${re.name}" imported successfully.`,"success"),te()}catch(R){Q(R instanceof Error?R.message:"Invalid JSON content.","error")}},[d,l,p,s,te,Q,i,Y]),W=R=>{var oe;const re=(oe=R.target.files)==null?void 0:oe[0];re&&J(re),R.target&&(R.target.value="")};if(!n)return null;const be=()=>{switch(l){case"image":return u.jsxs("div",{className:"space-y-4",children:[u.jsxs("div",{className:"flex flex-col items-center justify-center w-full h-48 border-2 border-dashed border-border rounded-lg cursor-pointer hover:bg-background transition-colors relative overflow-hidden",children:[k?u.jsxs("div",{className:"relative w-full h-full group",children:[u.jsx("img",{src:k,alt:"Preview",className:"w-full h-full object-contain"}),u.jsx("div",{className:"absolute inset-0 bg-black/50 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center",children:u.jsx(qe,{variant:"danger",size:"sm",onClick:R=>{R.stopPropagation(),w(null),N(null)},children:"Remove Image"})})]}):u.jsxs("label",{className:"flex flex-col items-center justify-center w-full h-full cursor-pointer",onClick:R=>{var re;R.preventDefault(),(re=q.current)==null||re.click()},children:[u.jsx(ze,{name:"upload-cloud",className:"w-10 h-10 text-text-muted mb-2"}),u.jsx("p",{className:"text-sm text-text-muted",children:u.jsx("span",{className:"font-semibold text-primary",children:"Click to upload image"})}),u.jsx("p",{className:"text-xs text-text-muted/70",children:"PNG, JPG, WEBP"})]}),u.jsx("input",{type:"file",ref:q,className:"hidden",accept:"image/*",onChange:D})]}),u.jsxs("div",{children:[u.jsx("label",{htmlFor:"image-hint",className:"block text-sm font-medium text-text-muted mb-1",children:"Topic / Hint (Optional)"}),u.jsx("input",{type:"text",id:"image-hint",value:I,onChange:R=>M(R.target.value),className:"w-full p-2 bg-background border border-border rounded-md focus:ring-2 focus:ring-primary focus:outline-none",placeholder:"e.g., Focus on the dates in the timeline"}),u.jsx("p",{className:"text-xs text-text-muted mt-1",children:"Guide the AI to extract specific information."})]})]});case"paste":return u.jsxs("div",{children:[u.jsx("textarea",{className:"w-full h-48 p-2 bg-background border border-border rounded-md focus:ring-2 focus:ring-primary focus:outline-none text-text",placeholder:'Paste JSON here... e.g., [{"front": "Q1", "back": "A1"}] or a Quiz/Series object.',value:p,onChange:R=>L(R.target.value)}),u.jsxs(ea,{href:"/instructions/json",onClick:a,className:"text-sm text-primary hover:underline mt-2 inline-flex items-center gap-1",children:[u.jsx(ze,{name:"help-circle",className:"w-4 h-4"}),"View JSON format guide"]})]});case"upload":return u.jsxs(u.Fragment,{children:[u.jsx("input",{type:"file",ref:F,className:"hidden",accept:".json, .csv, .apkg, .zip, image/*",onChange:W}),u.jsxs("label",{onDrop:ie,onDragOver:Z,className:"flex flex-col items-center justify-center w-full h-48 border-2 border-dashed border-border rounded-lg cursor-pointer hover:bg-background transition-colors",children:[u.jsx(ze,{name:"upload-cloud",className:"w-10 h-10 text-text-muted mb-2"}),u.jsxs("p",{className:"text-sm text-text-muted",children:[u.jsx("span",{className:"font-semibold text-primary",onClick:R=>{var re;R.preventDefault(),(re=F.current)==null||re.click()},children:"Click to upload"})," or drag and drop anywhere"]}),u.jsx("p",{className:"text-xs text-text-muted/70",children:"JSON, CSV, Anki (.apkg), Backup, or Image"}),v&&u.jsx("p",{className:"text-sm text-green-500 dark:text-green-400 mt-2 truncate",title:v,children:v})]})]});case"create":default:return u.jsx("p",{className:"text-text-muted text-center py-12",children:"Create an empty flashcard deck."})}},z=l!=="image"&&l!=="upload";return u.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-[60] p-4",children:u.jsxs("div",{ref:O,className:"bg-surface rounded-lg shadow-xl w-full max-w-lg overflow-hidden transform transition-all relative",children:[A&&u.jsxs("div",{className:"absolute inset-0 bg-surface/80 flex flex-col items-center justify-center z-20",children:[u.jsx($r,{}),u.jsx("p",{className:"text-lg text-text mt-4",children:l==="image"?"Analyzing image...":"Processing file..."})]}),u.jsxs("div",{className:"flex justify-between items-center p-4 border-b border-border",children:[u.jsx("h2",{className:"text-xl font-bold text-text",children:"Create / Import"}),u.jsx(qe,{variant:"ghost",onClick:te,className:"p-1 h-auto",children:u.jsx(ze,{name:"x"})})]}),u.jsxs("div",{className:"p-6 space-y-4",children:[z&&u.jsxs("div",{children:[u.jsx("label",{htmlFor:"deck-name",className:"block text-sm font-medium text-text-muted mb-1",children:"Deck / Series Name"}),u.jsx("input",{type:"text",id:"deck-name",value:d,onChange:R=>m(R.target.value),className:"w-full p-2 bg-background border border-border rounded-md focus:ring-2 focus:ring-primary focus:outline-none",placeholder:"e.g. Japanese Vocabulary"}),u.jsx("p",{className:"text-xs text-text-muted mt-1",children:"For single deck or new deck creation. This is auto-filled when pasting a Series object."})]}),u.jsx("div",{className:"flex border-b border-border overflow-x-auto",children:["create","paste","upload",...U?["image"]:[]].map(R=>u.jsx("button",{onClick:()=>c(R),className:`capitalize px-4 py-2 text-sm font-medium transition-colors whitespace-nowrap ${l===R?"border-b-2 border-primary text-text":"text-text-muted hover:text-text"}`,children:R==="create"?"Create Empty":R},R))}),u.jsx("div",{className:"mt-4",children:be()})]}),u.jsxs("div",{className:"flex justify-end p-4 bg-background/50 border-t border-border",children:[u.jsx(qe,{variant:"secondary",onClick:te,className:"mr-2",children:"Cancel"}),u.jsx(qe,{variant:"primary",onClick:me,disabled:A||l==="create"&&!d.trim()||l==="paste"&&!p||l==="upload"&&!v||l==="image"&&!E,children:l==="create"?"Create Deck":l==="image"?"Generate Deck":"Import"})]})]})})},r0=G.createContext(null),a0=()=>{const n=G.useContext(r0);if(!n)throw new Error("Accordion components must be used within an <Accordion> component.");return n},s0=G.createContext(null),i0=()=>{const n=G.useContext(s0);if(!n)throw new Error("AccordionTrigger/Content must be used within an <AccordionItem> component.");return n},Gw=({children:n,type:a="single",defaultValue:s,className:i=""})=>{const[l,c]=G.useState(s||(a==="multiple"?[]:"")),d=m=>{c(a==="multiple"?p=>{const h=Array.isArray(p)?p:[];return h.includes(m)?h.filter(v=>v!==m):[...h,m]}:p=>p===m?"":m)};return G.useEffect(()=>{c(s===void 0?a==="multiple"?[]:"":s)},[s,a]),u.jsx(r0.Provider,{value:{value:l,onValueChange:d,type:a},children:u.jsx("div",{className:i,children:n})})},Xc=({children:n,value:a,className:s=""})=>{const{value:i,type:l}=a0(),c=l==="multiple"?Array.isArray(i)&&i.includes(a):i===a;return u.jsx(s0.Provider,{value:{value:a,isOpen:c},children:u.jsx("div",{className:s,children:n})})},Wc=({children:n,className:a="",...s})=>{const{onValueChange:i}=a0(),{value:l,isOpen:c}=i0(),d=`accordion-content-${l}`,m=`accordion-header-${l}`;return u.jsx("h3",{id:m,className:"m-0 font-medium",children:u.jsxs("button",{type:"button",onClick:()=>i(l),"aria-expanded":c,"aria-controls":d,className:`w-full flex justify-between items-center text-left p-4 bg-surface hover:bg-border/20 transition-colors ${a}`,...s,children:[n,u.jsx(ze,{name:"chevron-down",className:`w-5 h-5 transition-transform duration-300 ${c?"rotate-180":""} text-text-muted`})]})})},eu=({children:n,className:a=""})=>{const{value:s,isOpen:i}=i0(),l=`accordion-content-${s}`,c=`accordion-header-${s}`;return i?u.jsx("div",{id:l,role:"region","aria-labelledby":c,className:`animate-fade-in ${a}`,children:n}):null},al=({label:n,localValue:a,backupValue:s,hasChanged:i})=>i?u.jsxs("div",{className:"text-xs",children:[u.jsxs("span",{className:"font-semibold",children:[n,": "]}),u.jsx("span",{className:"text-text-muted",children:a}),u.jsx(ze,{name:"arrow-down",className:"inline w-3 h-3 mx-1 rotate-[-90deg]"}),u.jsx("span",{className:"text-primary font-semibold",children:s})]}):null,qw=({isOpen:n,onClose:a,onCompare:s,onRestoreSelected:i,onFullRestore:l,openConfirmModal:c,file:d})=>{const[m,p]=G.useState("upload"),[h,v]=G.useState(""),[S,A]=G.useState(null),[_,E]=G.useState(null),[w,k]=G.useState(new Set),N=G.useRef(null),{addToast:I}=Nn(),M=G.useRef(null);On(M,n);const{seriesProgress:F}=Ke();G.useEffect(()=>{d&&n&&Q(d)},[d,n]);const q=()=>{p("upload"),v(""),A(null),E(null),k(new Set),a()},Q=async ie=>{if(ie){p("loading"),v(ie.name);try{const Z=await ie.text(),Y=await Eu(Z);A(Y);const me=s(Y);E(me);const W=[...me.newSeries.map(be=>be.id),...me.newDecks.map(be=>be.id),...me.changedSeries.map(be=>be.backup.id),...me.changedDecks.map(be=>be.backup.id)];k(new Set(W)),p("compare")}catch(Z){I(`Restore failed: ${Z instanceof Error?Z.message:"Unknown error"}`,"error"),q()}}},U=ie=>{var Y;if(m==="loading")return;const Z=(Y=ie.target.files)==null?void 0:Y[0];Z&&Q(Z),ie.target&&(ie.target.value="")},j=ie=>{var Y;if(ie.preventDefault(),m==="loading")return;const Z=(Y=ie.dataTransfer.files)==null?void 0:Y[0];Z&&Q(Z)},O=ie=>ie.preventDefault(),B=async()=>{S&&(p("loading"),await i({selectedIds:w,backupData:S}),q())},te=()=>{S&&(a(),c({title:"Confirm Full Restore",message:"This will completely overwrite all your local data with the contents of the backup file. This action cannot be undone.",confirmText:"overwrite everything",onConfirm:()=>l(S)}))},L=ie=>{k(Z=>{const Y=new Set(Z);return Y.has(ie)?Y.delete(ie):Y.add(ie),Y})};if(!n)return null;const J=ie=>{var Z,Y;return ie.type===Ne.Flashcard?((Z=ie.cards)==null?void 0:Z.length)||0:((Y=ie.questions)==null?void 0:Y.length)||0},D=()=>{if(m==="loading")return u.jsxs("div",{className:"absolute inset-0 bg-surface/80 flex flex-col items-center justify-center z-20",children:[u.jsx($r,{}),u.jsx("p",{className:"text-lg text-text mt-4",children:"Analyzing backup..."})]});if(m==="compare"&&_){const{newSeries:ie,newDecks:Z,changedSeries:Y,changedDecks:me,dueCounts:W,masteryLevels:be}=_,z=new Set(ie.flatMap(fe=>(fe.levels||[]).flatMap(Me=>Me.deckIds||[]))),R=Z.filter(fe=>!z.has(fe.id)),re=ie.length>0||R.length>0,oe=Y.length>0||me.length>0,he=[];return ie.length>0&&he.push("new-series"),R.length>0&&he.push("new-decks"),Y.length>0&&he.push("changed-series"),me.length>0&&he.push("changed-decks"),u.jsx("div",{className:"p-6 space-y-4 max-h-[60vh] overflow-y-auto",children:!re&&!oe?u.jsxs("div",{className:"text-center py-8 text-text-muted",children:[u.jsx(ze,{name:"check-circle",className:"w-12 h-12 mx-auto text-green-500"}),u.jsx("p",{className:"mt-2 font-medium",children:"Everything is up-to-date!"}),u.jsx("p",{className:"text-sm",children:"Your local data already matches the contents of this backup file."})]}):u.jsxs(Gw,{type:"multiple",defaultValue:he,children:[ie.length>0&&u.jsxs(Xc,{value:"new-series",className:"border-b",children:[u.jsxs(Wc,{children:["New Series (",ie.length,")"]}),u.jsx(eu,{className:"p-2 space-y-2",children:ie.map(fe=>u.jsx("div",{className:"p-3 bg-background rounded-md border border-border",children:u.jsxs("label",{className:"flex items-start gap-3 cursor-pointer",children:[u.jsx("input",{type:"checkbox",checked:w.has(fe.id),onChange:()=>L(fe.id),className:"mt-1 h-4 w-4 rounded border-gray-300 text-primary focus:ring-primary"}),u.jsxs("div",{className:"flex-grow",children:[u.jsx("p",{className:"font-semibold text-text",children:fe.name}),u.jsxs("p",{className:"text-xs text-text-muted",children:[(fe.levels||[]).reduce((Me,Fe)=>{var Ce;return Me+(((Ce=Fe.deckIds)==null?void 0:Ce.length)||0)},0)," deck(s)"]})]})]})},fe.id))})]}),Y.length>0&&u.jsxs(Xc,{value:"changed-series",className:"border-b",children:[u.jsxs(Wc,{children:["Changed Series (",Y.length,")"]}),u.jsx(eu,{className:"p-2 space-y-2",children:Y.map(({local:fe,backup:Me,diff:Fe})=>{var de,x;const Ce=`${((de=F.get(fe.id))==null?void 0:de.size)||0}/${(fe.levels||[]).reduce((se,X)=>{var $;return se+((($=X.deckIds)==null?void 0:$.length)||0)},0)}`,Ve=`${((x=((S==null?void 0:S.seriesProgress)||{})[Me.id])==null?void 0:x.length)||0}/${(Me.levels||[]).reduce((se,X)=>{var $;return se+((($=X.deckIds)==null?void 0:$.length)||0)},0)}`,Qe=Math.round((be.get(`local-${fe.id}`)||0)*100),ue=Math.round((be.get(Me.id)||0)*100);return u.jsx("div",{className:"p-3 bg-background rounded-md border border-border",children:u.jsxs("label",{className:"flex items-start gap-3 cursor-pointer",children:[u.jsx("input",{type:"checkbox",checked:w.has(Me.id),onChange:()=>L(Me.id),className:"mt-1 h-4 w-4 rounded border-gray-300 text-primary focus:ring-primary"}),u.jsxs("div",{className:"flex-grow space-y-1",children:[u.jsx("p",{className:"font-semibold text-text",children:Me.name}),u.jsx(al,{label:"Completion",localValue:Ce,backupValue:Ve,hasChanged:Fe.completion}),u.jsx(al,{label:"Mastery",localValue:`${Qe}%`,backupValue:`${ue}%`,hasChanged:Fe.mastery}),Fe.structure&&u.jsx("p",{className:"text-xs font-semibold text-primary",children:"Content/Structure updated"})]})]})},Me.id)})})]}),R.length>0&&u.jsxs(Xc,{value:"new-decks",className:"border-b",children:[u.jsxs(Wc,{children:["New Standalone Decks (",R.length,")"]}),u.jsx(eu,{className:"p-2 space-y-2",children:R.map(fe=>u.jsx("div",{className:"p-3 bg-background rounded-md border border-border",children:u.jsxs("label",{className:"flex items-start gap-3 cursor-pointer",children:[u.jsx("input",{type:"checkbox",checked:w.has(fe.id),onChange:()=>L(fe.id),className:"mt-1 h-4 w-4 rounded border-gray-300 text-primary focus:ring-primary"}),u.jsxs("div",{className:"flex-grow",children:[u.jsx("p",{className:"font-semibold text-text",children:fe.name}),u.jsxs("p",{className:"text-xs text-text-muted",children:[J(fe)," item(s)  ",W.get(fe.id)||0," due"]})]})]})},fe.id))})]}),me.length>0&&u.jsxs(Xc,{value:"changed-decks",className:"border-b",children:[u.jsxs(Wc,{children:["Changed Decks (",me.length,")"]}),u.jsx(eu,{className:"p-2 space-y-2",children:me.map(({local:fe,backup:Me,diff:Fe})=>{const Ce=Math.round((be.get(`local-${fe.id}`)||0)*100),Ve=Math.round((be.get(Me.id)||0)*100);return u.jsx("div",{className:"p-3 bg-background rounded-md border border-border",children:u.jsxs("label",{className:"flex items-start gap-3 cursor-pointer",children:[u.jsx("input",{type:"checkbox",checked:w.has(Me.id),onChange:()=>L(Me.id),className:"mt-1 h-4 w-4 rounded border-gray-300 text-primary focus:ring-primary"}),u.jsxs("div",{className:"flex-grow space-y-1",children:[u.jsx("p",{className:"font-semibold text-text",children:Me.name}),u.jsx(al,{label:"Items",localValue:J(fe),backupValue:J(Me),hasChanged:Fe.content}),u.jsx(al,{label:"Due",localValue:W.get(`local-${fe.id}`),backupValue:W.get(Me.id),hasChanged:Fe.dueCount}),u.jsx(al,{label:"Mastery",localValue:`${Ce}%`,backupValue:`${Ve}%`,hasChanged:Fe.mastery}),Fe.content&&u.jsx("p",{className:"text-xs font-semibold text-primary",children:"Content updated"})]})]})},Me.id)})})]})]})})}return u.jsxs("div",{className:"p-6 space-y-4",children:[u.jsx("input",{type:"file",ref:N,className:"hidden",accept:".json,application/json,.zip",onChange:U}),u.jsxs("label",{onDragOver:O,onDrop:j,className:"flex flex-col items-center justify-center w-full h-48 border-2 border-dashed border-border rounded-lg cursor-pointer hover:bg-background",children:[u.jsx(ze,{name:"upload-cloud",className:"w-10 h-10 text-text-muted mb-2"}),u.jsxs("p",{className:"text-sm text-text-muted",children:[u.jsx("span",{className:"font-semibold text-primary",onClick:ie=>{var Z;ie.preventDefault(),(Z=N.current)==null||Z.click()},children:"Click to upload"})," or drag and drop"]}),u.jsx("p",{className:"text-xs text-text-muted/70",children:"CogniFlow Backup JSON file"})]})]})};return u.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-[60] p-4",children:u.jsxs("div",{ref:M,className:"bg-surface rounded-lg shadow-xl w-full max-w-lg overflow-hidden transform transition-all relative",children:[u.jsxs("div",{className:"flex justify-between items-center p-4 border-b border-border",children:[u.jsx("h2",{className:"text-xl font-bold",children:"Restore from Backup"}),u.jsx(qe,{variant:"ghost",onClick:q,className:"p-1 h-auto",disabled:m==="loading",children:u.jsx(ze,{name:"x"})})]}),D(),u.jsxs("div",{className:"flex justify-between items-center p-4 bg-background/50 border-t border-border",children:[u.jsx("div",{children:m==="compare"&&u.jsx(qe,{variant:"danger",onClick:te,children:"Full Restore"})}),u.jsxs("div",{className:"flex gap-2",children:[u.jsx(qe,{variant:"secondary",onClick:q,disabled:m==="loading",children:"Cancel"}),m==="compare"&&u.jsxs(qe,{variant:"primary",onClick:B,disabled:w.size===0,children:["Add/Update Selected (",w.size,")"]})]})]})]})})},Pw=({isOpen:n,onClose:a,onReset:s,decks:i})=>{const[l,c]=G.useState(""),{addToast:d}=Nn(),m=G.useRef(null);On(m,n);const h=!!G.useMemo(()=>i.find(A=>A.id===l),[i,l]),v=()=>{if(!h){d("Please select a deck to reset.","error");return}s(l),a()},S=()=>{c(""),a()};return n?u.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-[60] p-4",children:u.jsxs("div",{ref:m,className:"bg-surface rounded-lg shadow-xl w-full max-w-lg transform transition-all relative",children:[u.jsxs("div",{className:"flex justify-between items-center p-4 border-b border-border",children:[u.jsx("h2",{className:"text-xl font-bold",children:"Reset Deck Progress"}),u.jsx(qe,{type:"button",variant:"ghost",onClick:S,className:"p-1 h-auto",children:u.jsx(ze,{name:"x"})})]}),u.jsxs("div",{className:"p-6 space-y-4",children:[u.jsx("div",{className:"bg-red-900/20 border border-red-500/30 rounded-lg p-4 text-sm text-red-700 dark:text-red-200",children:u.jsxs("p",{children:[u.jsx("strong",{className:"font-bold",children:"Warning:"})," This will reset all spaced repetition data (due dates, intervals) for the selected deck. The cards themselves will not be deleted. This action cannot be undone."]})}),u.jsxs("div",{children:[u.jsx("label",{htmlFor:"deck-select",className:"block text-sm font-medium text-text-muted mb-1",children:"Select Deck"}),u.jsxs("select",{id:"deck-select",value:l,onChange:A=>{c(A.target.value)},className:"w-full p-2 bg-background border border-border rounded-md focus:ring-2 focus:ring-primary focus:outline-none",children:[u.jsx("option",{value:"",disabled:!0,children:"-- Select a deck --"}),i.map(A=>u.jsx("option",{value:A.id,children:A.name},A.id))]})]})]}),u.jsxs("div",{className:"flex justify-end p-4 bg-background/50 border-t border-border",children:[u.jsx(qe,{type:"button",variant:"secondary",onClick:S,className:"mr-2",children:"Cancel"}),u.jsxs(qe,{type:"button",variant:"danger",onClick:v,disabled:!h,children:[u.jsx(ze,{name:"refresh-ccw",className:"w-5 h-5 mr-2"}),"Reset Progress"]})]})]})}):null},Yw=({isOpen:n,onClose:a,onConfirm:s,title:i,message:l,confirmText:c})=>{const[d,m]=G.useState(!1),p=G.useRef(null);On(p,n),G.useEffect(()=>{n&&m(!1)},[n]);const h=async()=>{m(!0);try{await Promise.resolve(s()),p.current&&a()}catch(v){console.error("Confirmation action failed:",v)}finally{p.current&&m(!1)}};return n?u.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-[60] p-4",children:u.jsxs("div",{ref:p,className:"bg-surface rounded-lg shadow-xl w-full max-w-md transform transition-all relative",role:"alertdialog","aria-modal":"true","aria-labelledby":"confirm-title","aria-describedby":"confirm-message",children:[u.jsxs("div",{className:"flex justify-between items-center p-4 border-b border-border",children:[u.jsx("h2",{id:"confirm-title",className:"text-xl font-bold text-text",children:i}),u.jsx(qe,{type:"button",variant:"ghost",onClick:a,className:"p-1 h-auto","aria-label":"Close",disabled:d,children:u.jsx(ze,{name:"x"})})]}),u.jsx("div",{className:"p-6 space-y-4",children:u.jsx("p",{id:"confirm-message",className:"text-text-muted",children:l})}),u.jsxs("div",{className:"flex justify-end p-4 bg-background/50 border-t border-border",children:[u.jsx(qe,{type:"button",variant:"secondary",onClick:a,className:"mr-2",disabled:d,children:"Cancel"}),u.jsx(qe,{type:"button",variant:"danger",onClick:h,disabled:d,children:d?u.jsx($r,{size:"sm"}):c||"Confirm"})]})]})}):null},$w=({folder:n,isOpen:a,onClose:s,onSave:i})=>{const[l,c]=G.useState(""),{addToast:d}=Nn(),m=G.useRef(null);On(m,a),G.useEffect(()=>{c(n?n.name:"")},[n]);const p=h=>{if(h.preventDefault(),!l.trim()){d("Folder name cannot be empty.","error");return}i({id:(n==null?void 0:n.id)||null,name:l.trim()}),s()};return a?u.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-[60] p-4",children:u.jsx("div",{ref:m,className:"bg-surface rounded-lg shadow-xl w-full max-w-md transform transition-all relative",children:u.jsxs("form",{onSubmit:p,children:[u.jsxs("div",{className:"flex justify-between items-center p-4 border-b border-border",children:[u.jsx("h2",{className:"text-xl font-bold",children:n?"Edit Folder":"Create New Folder"}),u.jsx(qe,{type:"button",variant:"ghost",onClick:s,className:"p-1 h-auto",children:u.jsx(ze,{name:"x"})})]}),u.jsx("div",{className:"p-6 space-y-4",children:u.jsxs("div",{children:[u.jsx("label",{htmlFor:"folder-name",className:"block text-sm font-medium text-text-muted mb-1",children:"Folder Name"}),u.jsx("input",{id:"folder-name",type:"text",value:l,onChange:h=>c(h.target.value),className:"w-full p-2 bg-background border border-border rounded-md focus:ring-2 focus:ring-primary focus:outline-none",placeholder:"e.g., University Courses",autoFocus:!0})]})}),u.jsxs("div",{className:"flex justify-end p-4 bg-background/50 border-t border-border",children:[u.jsx(qe,{type:"button",variant:"secondary",onClick:s,className:"mr-2",children:"Cancel"}),u.jsxs(qe,{type:"submit",variant:"primary",children:[u.jsx(ze,{name:"save",className:"w-4 h-4 mr-2"}),n?"Save Changes":"Create Folder"]})]})]})})}):null},Vw=({series:n,isOpen:a,onClose:s,onSave:i})=>{const[l,c]=G.useState(""),[d,m]=G.useState(""),[p,h]=G.useState(null),{addToast:v}=Nn(),S=G.useRef(null);On(S,a);const A=n===null;G.useEffect(()=>{n?(c(n.name),m(n.description),h(null)):(c(""),m(""),h(null))},[n]);const _=w=>{if(!A)return;const k=w.clipboardData.getData("text");if(k.trim().startsWith("{"))try{const N=JSON.parse(k);typeof N.seriesName=="string"&&typeof N.seriesDescription=="string"&&Array.isArray(N.levels)&&(w.preventDefault(),c(N.seriesName),m(N.seriesDescription),h(N),v("Series details and structure populated from JSON scaffold!","success"))}catch{}},E=w=>{if(w.preventDefault(),!l.trim()){v("Series name cannot be empty.","error");return}i({id:A?null:n.id,name:l.trim(),description:d.trim(),scaffold:A?p:null}),s()};return a?u.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-[60] p-4",children:u.jsx("div",{ref:S,className:"bg-surface rounded-lg shadow-xl w-full max-w-lg transform transition-all relative",children:u.jsxs("form",{onSubmit:E,children:[u.jsxs("div",{className:"flex justify-between items-center p-4 border-b border-border",children:[u.jsx("h2",{className:"text-xl font-bold",children:A?"Create New Series":"Edit Series"}),u.jsx(qe,{type:"button",variant:"ghost",onClick:s,className:"p-1 h-auto",children:u.jsx(ze,{name:"x"})})]}),u.jsxs("div",{className:"p-6 space-y-4",children:[u.jsxs("div",{children:[u.jsx("label",{htmlFor:"series-name",className:"block text-sm font-medium text-text-muted mb-1",children:"Series Name"}),u.jsx("input",{id:"series-name",type:"text",value:l,onChange:w=>c(w.target.value),onPaste:_,className:"w-full p-2 bg-background border border-border rounded-md focus:ring-2 focus:ring-primary focus:outline-none",placeholder:"e.g., Introduction to Algebra",autoFocus:!0}),A&&u.jsx("p",{className:"text-xs text-text-muted mt-1",children:"You can paste a full JSON scaffold object here to auto-populate."})]}),u.jsxs("div",{children:[u.jsx("label",{htmlFor:"series-description",className:"block text-sm font-medium text-text-muted mb-1",children:"Description"}),u.jsx("textarea",{id:"series-description",value:d,onChange:w=>m(w.target.value),onPaste:_,rows:3,className:"w-full p-2 bg-background border border-border rounded-md focus:ring-2 focus:ring-primary focus:outline-none",placeholder:"A collection of decks covering core concepts."})]}),A&&p&&u.jsxs("div",{className:"space-y-2 animate-fade-in",children:[u.jsx("h4",{className:"text-sm font-semibold text-text-muted",children:"Structure Preview"}),u.jsx("div",{className:"bg-background border border-border rounded-md p-3 max-h-48 overflow-y-auto text-sm",children:u.jsx("ul",{className:"space-y-3",children:(p.levels||[]).filter(w=>!!w).map((w,k)=>{const N=w.decks||[];return u.jsxs("li",{children:[u.jsxs("div",{className:"flex items-center gap-2 font-medium text-text",children:[u.jsx(ze,{name:"layers",className:"w-4 h-4 text-purple-500 flex-shrink-0"}),u.jsx("span",{className:"font-semibold",children:w.title})]}),u.jsxs("ul",{className:"pl-6 mt-1 space-y-1",children:[N.map((I,M)=>u.jsxs("li",{className:"flex items-center gap-2 text-text-muted",children:[u.jsx(ze,{name:"help-circle",className:"w-3.5 h-3.5 flex-shrink-0"}),u.jsx("span",{children:I.name})]},M)),N.length===0&&u.jsx("li",{className:"flex items-center gap-2 text-xs text-text-muted/70 italic",children:"(No decks in this level)"})]})]},k)})})})]})]}),u.jsxs("div",{className:"flex justify-end p-4 bg-background/50 border-t border-border",children:[u.jsx(qe,{type:"button",variant:"secondary",onClick:s,className:"mr-2",children:"Cancel"}),u.jsxs(qe,{type:"submit",variant:"primary",children:[u.jsx(ze,{name:"save",className:"w-4 h-4 mr-2"}),A?"Create Series":"Save Changes"]})]})]})})}):null},o0="cogniflow-ai-options",tu={understandingLevels:["Auto","Novice","Beginner","Intermediate","Advanced","Expert"],comprehensivenessLevels:["Quick Overview","Standard","Comprehensive","Exhaustive"],learningGoalOptions:["Auto","Master a subject","Learn for the sake of curiosity","Explore a new interest","Become more informed","Understand a complex topic","Practically learn the topic"],learningStyleOptions:["Auto","Conceptual Understanding (Why & How)","Factual Recall (What, Who, When)","Practical Application & Scenarios"],languageOptions:["Auto","English","Swedish","Spanish","French","German","Japanese","Mandarin","Russian"],toneOptions:["Auto","Neutral","Formal","Casual","Academic","Enthusiastic","Humorous"],personas:[{id:"default",name:"Default Assistant",instruction:"You are a helpful and neutral AI assistant."},{id:"tutor",name:"Friendly Tutor",instruction:"You are a friendly and encouraging tutor. You use analogies and explain complex topics in a simple, easy-to-understand way."},{id:"professor",name:"University Professor",instruction:"You are an expert professor. Your tone is formal, academic, and you provide in-depth, precise information."},{id:"author",name:"Technical Author",instruction:"You are a technical author. Your style is concise, precise, and fact-focused. You avoid fluff and get straight to the point."},{id:"lindstrom",name:"Fredrik Lindstrm",instruction:'You are Fredrik Lindstrm. You explain topics with a focus on linguistics, history, and cultural nuances. You are witty, slightly dry, and love to find the "human" element in dry facts. You make connections between language, culture, and history that others miss.'},{id:"bryson",name:"Bill Bryson",instruction:'You are Bill Bryson. You write with an infectious sense of wonder, finding the "extraordinary in the ordinary." Your prose is conversational, witty, and avoids academic jargon. You use dry, self-deprecating humor and focus on the bizarre anecdotes and hidden history that textbooks leave out.'},{id:"feynman",name:"Richard Feynman",instruction:'You are Richard Feynman. You hate jargon and pseudo-intellectualism. Your goal is to explain complex topics using simple, physical analogies and plain language. You focus on the "why" and "how," not just the names of things. You are enthusiastic and radically curious.'},{id:"roach",name:"Mary Roach",instruction:"You are Mary Roach. You are intensely curious about the practical, slightly gross, or bizarre aspects of the topic. You focus on the human side of science and historythe sweat, the mistakes, and the awkward details. You are funny, fearless, and relatable."},{id:"great_teacher",name:"The Great Teacher",instruction:`You are "The Great Teacher." Your teaching style is built on narrative, humor, and relatability. You model "Radical Curiosity" and awe for the subject. You use storytelling to make facts stick, and you constantly relate the material back to the learner's life.`},{id:"the_master",name:"The Master",instruction:`You are "The Master," the ultimate educational companion. 
      
      CORE PHILOSOPHY: Facts are useless without context. Understanding requires "Radical Curiosity."
      
      YOUR 5 PILLARS OF TEACHING:
      1. THE STYLIST: Write with rhythm. Combine short, punchy sentences with lyrical descriptions. Avoid dry academic tone. You are a mentor, not a manual.
      2. THE STORYTELLER: Find the human struggle behind the fact. Gravity isn't just a force; it's Newton's obsession.
      3. THE ANALOGY ARCHITECT: Never explain a complex abstract concept without a concrete physical analogy. (e.g., "Voltage is water pressure").
      4. THE PROVOCATEUR (Keating Mode): Occasionally ask the user a question that has no right answer. Challenge their assumptions. Remind them that learning is an act of rebellion.
      5. THE FORMATTER: Use HTML tags (<b>, <i>, <br>) aggressively to structure your text. Key terms must be bold. Use italics for emphasis.
      
      When generating content, you must embody this persona completely.`}],customFields:[]},Zw=()=>{try{const n=localStorage.getItem(o0);if(n){const a=JSON.parse(n),s=[...tu.personas,...(a.personas||[]).filter(i=>!tu.personas.some(l=>l.id===i.id))];return{...tu,...a,personas:s}}}catch(n){console.error("Failed to parse AI options from localStorage",n)}return tu},Nu=()=>{const[n,a]=G.useState(Zw),s=l=>{try{localStorage.setItem(o0,JSON.stringify(l)),a(l)}catch(c){console.error("Failed to save AI options to localStorage",c)}},i=G.useCallback((l,c)=>{a(d=>{const m={...d,[l]:c};return s(m),m})},[]);return{options:n,updateCategory:i}},Vi=({title:n,category:a})=>{const{options:s,updateCategory:i}=Nu(),[l,c]=G.useState(s[a]),[d,m]=G.useState(""),p=()=>{if(d.trim()){const v=[...l,d.trim()];c(v),i(a,v),m("")}},h=v=>{const S=l.filter((A,_)=>_!==v);c(S),i(a,S)};return u.jsxs("div",{className:"p-4 bg-background border border-border rounded-lg",children:[u.jsx("h4",{className:"font-semibold text-text mb-2",children:n}),u.jsx("ul",{className:"space-y-2",children:l.map((v,S)=>u.jsxs("li",{className:"flex items-center justify-between p-2 bg-surface rounded-md border border-border/50",children:[u.jsx("span",{className:"text-sm",children:v}),u.jsx(qe,{variant:"ghost",size:"sm",className:"p-1 h-auto",onClick:()=>h(S),children:u.jsx(ze,{name:"trash-2",className:"w-4 h-4 text-red-500"})})]},S))}),u.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[u.jsx("input",{type:"text",value:d,onChange:v=>m(v.target.value),onKeyDown:v=>{v.key==="Enter"&&(v.preventDefault(),p())},placeholder:"Add...",className:"flex-grow p-1.5 text-sm bg-surface border border-border rounded-md"}),u.jsx(qe,{variant:"secondary",size:"sm",onClick:p,children:"Add"})]})]})},Qw=()=>{const{options:n,updateCategory:a}=Nu(),[s,i]=G.useState(()=>JSON.parse(JSON.stringify(n.personas))),{addToast:l}=Nn(),c=(h,v,S)=>{const A=[...s];A[h]={...A[h],[v]:S},i(A)},d=()=>{i([...s,{id:crypto.randomUUID(),name:"",instruction:""}])},m=h=>{s[h].id!=="default"&&i(s.filter((v,S)=>S!==h))},p=()=>{a("personas",s.filter(h=>h.name.trim()&&h.instruction.trim())),l("Personas saved!","success")};return u.jsxs("div",{className:"space-y-4",children:[u.jsxs("div",{className:"flex justify-between items-center",children:[u.jsx("h4",{className:"font-semibold text-text",children:"AI Personas"}),u.jsx(qe,{variant:"secondary",size:"sm",onClick:p,children:"Save Personas"})]}),s.map((h,v)=>u.jsxs("div",{className:"space-y-2 p-3 bg-background border border-border rounded-md",children:[u.jsx("input",{type:"text",placeholder:"Persona Name (e.g., Cheerful Tutor)",value:h.name,onChange:S=>c(v,"name",S.target.value),className:"w-full p-2 text-sm bg-surface border border-border rounded-md",disabled:h.id==="default"}),u.jsx("textarea",{placeholder:"System instruction for this persona...",value:h.instruction,onChange:S=>c(v,"instruction",S.target.value),rows:3,className:"w-full p-2 text-sm bg-surface border border-border rounded-md"}),h.id!=="default"&&u.jsxs(qe,{variant:"ghost",size:"sm",onClick:()=>m(v),className:"text-red-500",children:[u.jsx(ze,{name:"trash-2",className:"w-4 h-4 mr-2"})," Remove Persona"]})]},h.id)),u.jsxs(qe,{variant:"ghost",size:"sm",onClick:d,children:[u.jsx(ze,{name:"plus",className:"w-4 h-4 mr-2"})," Add Persona"]})]})},Kw=({onBack:n})=>u.jsxs("div",{className:"flex flex-col h-full overflow-hidden",children:[u.jsx("header",{className:"flex-shrink-0 flex justify-between items-center p-4 border-b border-border",children:u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx(qe,{variant:"ghost",onClick:n,className:"p-1 h-auto",children:u.jsx(ze,{name:"chevron-left"})}),u.jsx("h2",{className:"text-xl font-bold",children:"Manage AI Options"})]})}),u.jsxs("main",{className:"flex-grow p-6 overflow-y-auto space-y-6 no-scrollbar",children:[u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[u.jsx(Vi,{title:"Understanding Levels",category:"understandingLevels"}),u.jsx(Vi,{title:"Comprehensiveness Levels",category:"comprehensivenessLevels"}),u.jsx(Vi,{title:"Learning Goals",category:"learningGoalOptions"}),u.jsx(Vi,{title:"Learning Styles",category:"learningStyleOptions"}),u.jsx(Vi,{title:"Languages",category:"languageOptions"}),u.jsx(Vi,{title:"Tones",category:"toneOptions"})]}),u.jsx("div",{className:"border-t border-border pt-6 pb-4",children:u.jsx(Qw,{})})]})]}),Jw=({isOpen:n,onClose:a,onStartAIGeneration:s,initialTopic:i,initialGenerationType:l,context:c})=>{const[d,m]=G.useState("main"),[p,h]=G.useState(i||(c==null?void 0:c.deckName)||""),[v,S]=G.useState(""),[A,_]=G.useState(c!=null&&c.seriesId?"series":"deck"),[E,w]=G.useState("quiz"),[k,N]=G.useState(10),[I,M]=G.useState("none"),[F,q]=G.useState("default"),[Q,U]=G.useState("Auto"),[j,O]=G.useState("Standard"),{options:B}=Nu(),te=G.useRef(null);On(te,n);const{addToast:L}=Nn(),J=oo(),[D,ie]=G.useState([]),[Z,Y]=G.useState(!1),me=(c==null?void 0:c.mode)||"generate";G.useEffect(()=>{c!=null&&c.deckType&&(c.deckType===Ne.Flashcard?w("flashcard"):c.deckType===Ne.Learning?w("learning"):w("quiz"))},[c]),G.useEffect(()=>{i?h(i):c!=null&&c.deckName&&h(c.deckName)},[i,c]);const W=!!(c!=null&&c.deckId),be=G.useMemo(()=>A==="deck"?[{value:"quiz",label:"Interactive Quiz",icon:"help-circle"},{value:"flashcard",label:"Flashcards",icon:"laptop"},{value:"vocab",label:"Vocabulary Builder",icon:"book-open"},{value:"atomic",label:"Atomic Concepts",icon:"zap"},{value:"blooms",label:"Bloom's Taxonomy Quiz",icon:"trending-up"},{value:"learning",label:"Learning Deck",icon:"layers"},{value:"course",label:"Course / Guide (Reader)",icon:"file-text"}]:[{value:"quiz",label:"Interactive Quizzes",icon:"help-circle"},{value:"flashcard",label:"Flashcards",icon:"laptop"},{value:"vocab",label:"Vocabulary Builder",icon:"book-open"},{value:"course",label:"Course / Guide (Reader)",icon:"file-text"}],[A]);G.useEffect(()=>{!W&&!be.some(fe=>fe.value===E)&&w(be[0].value)},[A,be,E,W]);const z=async()=>{if(!(!(c!=null&&c.deckName)&&!(c!=null&&c.seriesName))){Y(!0);try{const fe=await Uw({name:c.deckName||c.seriesName||"",description:c.seriesDescription,type:c.seriesId?"series":"deck"});ie(fe)}catch{L("Failed to get suggestions.","error")}finally{Y(!1)}}},R=()=>me==="rework"?"rework-deck":A==="series"?E==="flashcard"?"series-flashcard":E==="vocab"?"series-vocab":E==="course"?"series-course":"series-quiz":E==="quiz"?"single-deck-quiz":E==="flashcard"?"deck-flashcard":E==="vocab"?"deck-vocab":E==="atomic"?"deck-atomic":E==="blooms"?"quiz-blooms":E==="learning"?"single-deck-learning":E==="course"?"deck-course":"single-deck-quiz",re=()=>({generationType:R(),topic:p,persona:F,understanding:Q,comprehensiveness:j,count:k,imageStyle:E==="flashcard"||E==="vocab"||E==="atomic"?I:void 0,seriesId:c==null?void 0:c.seriesId,levelIndex:c==null?void 0:c.levelIndex,deckId:c==null?void 0:c.deckId,reworkInstructions:v.trim()}),oe=()=>{p.trim()&&s(re())},he=()=>{p.trim()&&J!=null&&J.handleImmediateAIGeneration&&(J.handleImmediateAIGeneration(re()),a())};return n?u.jsx("div",{className:"fixed inset-0 bg-black/75 flex items-center justify-center z-[60] p-4",children:u.jsx("div",{ref:te,className:"bg-surface rounded-lg shadow-xl w-full max-w-2xl transform transition-all relative h-full max-h-[90vh] overflow-hidden flex flex-col",children:d==="main"?u.jsxs("div",{className:"flex flex-col h-full overflow-hidden",children:[u.jsxs("header",{className:"flex-shrink-0 flex justify-between items-center p-4 border-b border-border",children:[u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx(ze,{name:me==="rework"?"refresh-ccw":"bot",className:"w-6 h-6 text-primary"}),u.jsx("h2",{className:"text-xl font-bold",children:me==="rework"?`Rework "${c==null?void 0:c.deckName}"`:c!=null&&c.deckId?`Expand "${c.deckName}"`:"Generate with AI"})]}),u.jsx(qe,{type:"button",variant:"ghost",onClick:a,className:"p-1 h-auto",children:u.jsx(ze,{name:"x"})})]}),u.jsxs("main",{className:"flex-grow p-6 space-y-6 overflow-y-auto no-scrollbar",children:[!W&&!(c!=null&&c.seriesId)&&u.jsxs("div",{className:"flex bg-background rounded-lg p-1 border border-border",children:[u.jsx("button",{type:"button",onClick:()=>_("deck"),className:`flex-1 py-2 rounded-md text-sm font-medium transition-colors ${A==="deck"?"bg-primary text-on-primary shadow-sm":"text-text-muted hover:text-text"}`,children:"Single Deck"}),u.jsx("button",{type:"button",onClick:()=>_("series"),className:`flex-1 py-2 rounded-md text-sm font-medium transition-colors ${A==="series"?"bg-primary text-on-primary shadow-sm":"text-text-muted hover:text-text"}`,children:"Full Series"})]}),u.jsxs("div",{children:[u.jsxs("div",{className:"flex justify-between items-end mb-1",children:[u.jsx("label",{htmlFor:"topic",className:"block text-sm font-medium text-text-muted",children:me==="rework"?"Base Topic (Derived from Deck)":c!=null&&c.deckId?"Additional Topic / Context":"Topic"}),((c==null?void 0:c.deckName)||(c==null?void 0:c.seriesName))&&me!=="rework"&&u.jsxs("button",{type:"button",onClick:z,disabled:Z,className:"text-xs text-primary hover:underline flex items-center gap-1",children:[Z?u.jsx($r,{size:"sm"}):u.jsx(ze,{name:"zap",className:"w-3 h-3"}),D.length>0?"Refresh Suggestions":"Get Suggestions"]})]}),u.jsx("input",{id:"topic",type:"text",value:p,onChange:fe=>h(fe.target.value),className:"w-full p-2 bg-background border border-border rounded-md focus:ring-2 focus:ring-primary focus:outline-none",placeholder:"e.g., The History of Ancient Rome",autoFocus:me!=="rework"}),D.length>0&&me!=="rework"&&u.jsx("div",{className:"flex flex-wrap gap-2 mt-2 animate-fade-in",children:D.map((fe,Me)=>u.jsx("button",{type:"button",onClick:()=>h(fe),className:"text-xs px-2 py-1 bg-primary/10 text-primary rounded-full hover:bg-primary/20 transition-colors border border-primary/20",children:fe},Me))})]}),me==="rework"&&u.jsxs("div",{className:"animate-fade-in",children:[u.jsx("label",{htmlFor:"rework-instructions",className:"block text-sm font-medium text-text-muted mb-1",children:"Focus for Rework"}),u.jsx("textarea",{id:"rework-instructions",value:v,onChange:fe=>S(fe.target.value),rows:3,className:"w-full p-2 bg-background border border-border rounded-md focus:ring-2 focus:ring-primary focus:outline-none text-sm",placeholder:"e.g., Make the questions much harder, add more practical examples, or simplify the language for a child.",autoFocus:!0})]}),!(c!=null&&c.deckId)&&u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-text-muted mb-2",children:"Content Style"}),u.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2",children:be.map(fe=>u.jsxs("button",{type:"button",onClick:()=>w(fe.value),className:`flex items-center gap-3 p-3 rounded-lg border text-left transition-all ${E===fe.value?"border-primary bg-primary/5 ring-1 ring-primary":"border-border bg-background hover:border-primary/50"}`,children:[u.jsx("div",{className:`p-2 rounded-full ${E===fe.value?"bg-primary text-on-primary":"bg-surface text-text-muted"}`,children:u.jsx(ze,{name:fe.icon,className:"w-4 h-4"})}),u.jsx("span",{className:`text-sm font-medium ${E===fe.value?"text-primary":"text-text"}`,children:fe.label})]},fe.value))})]}),A==="deck"&&u.jsx("div",{className:"space-y-4",children:E==="learning"||E==="course"?u.jsxs("div",{children:[u.jsx("label",{htmlFor:"comprehensiveness",className:"block text-sm font-medium text-text-muted mb-1",children:"Depth of Content"}),u.jsx("select",{id:"comprehensiveness",value:j,onChange:fe=>O(fe.target.value),className:"w-full p-2 bg-background border border-border rounded-md focus:ring-2 focus:ring-primary focus:outline-none",children:B.comprehensivenessLevels.map(fe=>u.jsxs("option",{value:fe,children:[fe," ",fe==="Exhaustive"?"(Min 20 Chapters)":""]},fe))})]}):u.jsxs("div",{children:[u.jsxs("label",{className:"block text-sm font-medium text-text-muted mb-3 flex justify-between",children:[u.jsxs("span",{children:["Number of items ",me==="rework"?"to maintain":"to generate"]}),u.jsx("span",{className:"font-bold text-primary",children:k})]}),u.jsxs("div",{className:"flex items-center gap-4",children:[u.jsx("input",{type:"range",min:"5",max:"50",step:"5",value:k,onChange:fe=>N(Number(fe.target.value)),className:"flex-grow accent-primary"}),u.jsx("div",{className:"flex gap-1",children:[5,10,20,50].map(fe=>u.jsx("button",{type:"button",onClick:()=>N(fe),className:`px-2 py-1 text-[10px] font-bold rounded border transition-colors ${k===fe?"bg-primary text-on-primary border-primary":"border-border text-text-muted hover:border-primary"}`,children:fe},fe))})]}),k>=30&&u.jsxs("p",{className:"text-[10px] text-orange-500 mt-2 flex items-center gap-1",children:[u.jsx(ze,{name:"info",className:"w-3 h-3"})," Note: Large generations use more powerful models and take longer."]})]})}),u.jsxs("div",{className:"space-y-4 pt-4 border-t border-border",children:[(E==="flashcard"||E==="vocab"||E==="atomic")&&u.jsxs("div",{className:"animate-fade-in",children:[u.jsx("label",{htmlFor:"image-style",className:"block text-sm font-medium text-text-muted mb-1",children:"Image Generation"}),u.jsxs("select",{id:"image-style",value:I,onChange:fe=>M(fe.target.value),className:"w-full p-2 bg-background border border-border rounded-md focus:ring-2 focus:ring-primary focus:outline-none",children:[u.jsx("option",{value:"none",children:"No Images"}),u.jsx("option",{value:"realistic",children:"Find Realistic Images"}),u.jsx("option",{value:"creative",children:"Generate Creative Images"})]})]}),u.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[u.jsxs("div",{children:[u.jsx("label",{htmlFor:"persona",className:"block text-sm font-medium text-text-muted mb-1",children:"AI Persona"}),u.jsx("select",{id:"persona",value:F,onChange:fe=>q(fe.target.value),className:"w-full p-2 bg-background border border-border rounded-md focus:ring-2 focus:ring-primary focus:outline-none",children:B.personas.map(fe=>u.jsx("option",{value:fe.id,children:fe.name},fe.id))})]}),u.jsxs("div",{children:[u.jsx("label",{htmlFor:"understanding",className:"block text-sm font-medium text-text-muted mb-1",children:"My Current Level Is"}),u.jsx("select",{id:"understanding",value:Q,onChange:fe=>U(fe.target.value),className:"w-full p-2 bg-background border border-border rounded-md focus:ring-2 focus:ring-primary focus:outline-none",children:B.understandingLevels.map(fe=>u.jsx("option",{value:fe,children:fe},fe))})]})]}),!(E==="learning"||E==="course")&&u.jsxs("div",{children:[u.jsx("label",{htmlFor:"comprehensiveness-shared",className:"block text-sm font-medium text-text-muted mb-1",children:"Desired Comprehensiveness"}),u.jsx("select",{id:"comprehensiveness-shared",value:j,onChange:fe=>O(fe.target.value),className:"w-full p-2 bg-background border border-border rounded-md focus:ring-2 focus:ring-primary focus:outline-none",children:B.comprehensivenessLevels.map(fe=>u.jsx("option",{value:fe,children:fe},fe))})]})]})]}),u.jsxs("footer",{className:"flex-shrink-0 flex flex-wrap justify-between items-center p-4 bg-background/50 border-t border-border gap-2",children:[u.jsx(qe,{type:"button",variant:"ghost",onClick:()=>m("options"),children:"Options"}),u.jsxs("div",{className:"flex gap-2",children:[u.jsxs(qe,{type:"button",variant:"secondary",onClick:oe,disabled:!p.trim()||me==="rework"&&!v.trim(),children:[u.jsx(ze,{name:"bot",className:"w-4 h-4 mr-2"}),"Chat & Refine"]}),u.jsxs(qe,{type:"button",variant:"primary",onClick:he,disabled:!p.trim()||me==="rework"&&!v.trim(),children:[u.jsx(ze,{name:"zap",className:"w-5 h-5 mr-2"}),"Generate Now"]})]})]})]}):u.jsx("div",{className:"flex flex-col h-full overflow-hidden",children:u.jsx(Kw,{onBack:()=>m("main")})})})}):null},Xw=({isOpen:n,onClose:a,onCancel:s})=>{const{currentTask:i,queue:l}=Ke(p=>p.aiGenerationStatus),c=G.useRef(null);On(c,n);const d=()=>{s()},m=p=>{s(p)};return n?u.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-[60] p-4",children:u.jsxs("div",{ref:c,className:"bg-surface rounded-lg shadow-xl w-full max-w-lg transform transition-all relative max-h-[90vh] flex flex-col",role:"dialog","aria-modal":"true","aria-labelledby":"ai-status-title",children:[u.jsxs("div",{className:"flex-shrink-0 flex justify-between items-center p-4 border-b border-border",children:[u.jsx("h2",{id:"ai-status-title",className:"text-xl font-bold text-text",children:"AI Generation Status"}),u.jsx(qe,{type:"button",variant:"ghost",onClick:a,className:"p-1 h-auto","aria-label":"Close",children:u.jsx(ze,{name:"x"})})]}),u.jsxs("div",{className:"p-6 overflow-y-auto space-y-6",children:[u.jsxs("div",{children:[u.jsx("h3",{className:"text-sm font-semibold uppercase tracking-wider text-text-muted mb-2",children:"Current Task"}),u.jsx("div",{className:"bg-background p-4 rounded-lg",children:i?u.jsxs("div",{className:"flex items-center gap-4",children:[u.jsx($r,{size:"sm"}),u.jsx("p",{className:"text-text-muted flex-grow",children:i.statusText||"Processing your request..."}),u.jsx(qe,{variant:"danger",size:"sm",onClick:d,children:"Cancel"})]}):u.jsx("p",{className:"text-text-muted text-center py-4",children:"No AI tasks are currently running."})})]}),l&&l.length>0&&u.jsxs("div",{children:[u.jsxs("h3",{className:"text-sm font-semibold uppercase tracking-wider text-text-muted mb-2",children:["Queued Tasks (",l.length,")"]}),u.jsx("ul",{className:"space-y-2",children:l.map(p=>u.jsxs("li",{className:"bg-background p-3 rounded-lg flex items-center justify-between gap-4",children:[u.jsx("p",{className:"text-text-muted text-sm truncate flex-grow",children:p.statusText}),u.jsx(qe,{variant:"ghost",size:"sm",className:"p-1 h-auto hover:text-red-500",onClick:()=>m(p.id),"aria-label":`Cancel task: ${p.statusText}`,children:u.jsx(ze,{name:"x-circle",className:"w-5 h-5"})})]},p.id))})]})]}),u.jsx("div",{className:"flex-shrink-0 flex justify-end p-4 bg-background/50 border-t border-border",children:u.jsx(qe,{type:"button",variant:"primary",onClick:a,children:"Close"})})]})}):null},Ww="cogniflow-sync";let ih=null;const l0=()=>(ih||(ih=new BroadcastChannel(Ww)),ih),sa=()=>{l0().postMessage({type:"data-changed"})},eE=n=>{const a=l0(),s=()=>{n()};return a.addEventListener("message",s),()=>{a.removeEventListener("message",s)}},_u="CogniFlowDB",oh=9,nr="decks",Hn="folders",Vn="deckSeries",bn="sessions",mn="reviews",ra="ai_chat",Wn="seriesProgress",kr="learningProgress",tE=(n,a=20,s=5e3)=>{let i=0,l=Date.now(),c=!1;const d=(m,...p)=>{const h=Date.now();if(h-l>s&&(i=0,l=h,c&&console.warn(`[${n}] Logger is now unmuted after timeout.`),c=!1),!c){if(i++,i>a){console.error(`[${n}] Logger muted: Too many logs in a short time window (${a} logs in <${s}ms). This may indicate a serious issue like a data corruption loop or a repeated failed operation. Further logs from this source will be suppressed for a short time to prevent app overload.`),c=!0;return}console[m](`[${n}]`,...p)}};return{log:(...m)=>d("log",...m),warn:(...m)=>d("warn",...m),error:(...m)=>d("error",...m)}},Pe=tE("DB");let fa=null;function St(){return fa||(fa=new Promise((n,a)=>{Pe.log(`Initializing IndexedDB: ${_u} v${oh}...`);const s=typeof indexedDB<"u"?indexedDB:typeof window<"u"?window.indexedDB:void 0;if(!s){const l="IndexedDB is not supported in this environment.";return Pe.error(`${l}`),a(new Error(l))}const i=s.open(_u,oh);i.onblocked=l=>{const c="Database upgrade is required, but it is blocked by another open tab of this application. Please close all other tabs and reload.";Pe.error("IndexedDB open request blocked. Please close other tabs with this app open.",l),a(new Error(c))},i.onerror=()=>{Pe.error("IndexedDB error during open:",i.error),fa=null;const l=new Error("Could not open or delete the database. This can be caused by browser settings (like blocking all data), private mode, or corruption. Please clear website data for this app in your browser settings and reload.");a(l)},i.onsuccess=()=>{const l=i.result;l.onversionchange=()=>{l.close(),fa=null,console.warn("Database version changed in another tab. Closing connection to prevent blocking.")},Pe.log("IndexedDB connection successful."),l.onclose=()=>{fa=null,Pe.warn("Database connection closed.")},n(l)},i.onupgradeneeded=l=>{var m;const c=l.target.result,d=l.target.transaction;if(Pe.log(`Upgrading database from version ${l.oldVersion} to ${oh}`),!d){Pe.error("Upgrade transaction is not available, aborting upgrade."),l.target&&((m=l.target.transaction)==null||m.abort());return}switch(l.oldVersion){case 0:Pe.log("v1: Creating initial object stores (decks, folders)."),c.objectStoreNames.contains(nr)||c.createObjectStore(nr,{keyPath:"id"}),c.objectStoreNames.contains(Hn)||c.createObjectStore(Hn,{keyPath:"id"});case 1:case 2:Pe.log(`v3: Creating object store: ${Vn}`),c.objectStoreNames.contains(Vn)||c.createObjectStore(Vn,{keyPath:"id"});case 3:Pe.log(`v4: Creating object store: ${bn}`),c.objectStoreNames.contains(bn)||c.createObjectStore(bn,{keyPath:"id"});case 4:Pe.log(`v5: Creating object store: ${mn}`),c.objectStoreNames.contains(mn)||c.createObjectStore(mn,{autoIncrement:!0}).createIndex("timestamp","timestamp",{unique:!1});case 5:Pe.log("v6: Adding deckId index to reviews store.");const p=d.objectStore(mn);p.indexNames.contains("deckId")||p.createIndex("deckId","deckId",{unique:!1});case 6:Pe.log(`v7: Creating object store: ${ra}`),c.objectStoreNames.contains(ra)||c.createObjectStore(ra,{keyPath:"id"});case 7:Pe.log(`v8: Creating object store: ${Wn}`),c.objectStoreNames.contains(Wn)||c.createObjectStore(Wn,{keyPath:"id"});case 8:Pe.log(`v9: Creating object store: ${kr}`),c.objectStoreNames.contains(kr)||c.createObjectStore(kr,{keyPath:"deckId"});default:Pe.log("Database upgrade sequence complete.")}}}),fa)}async function nE(){const n=await St();return new Promise((a,s)=>{const c=n.transaction(nr,"readonly").objectStore(nr).getAll();c.onerror=()=>{Pe.error("DB Error fetching all decks:",c.error),s(new Error("Error fetching decks from the database."))},c.onsuccess=()=>{const d=c.result,m=Array.isArray(d)?d:[],p=m.length;p>0?Pe.log(`Successfully loaded ${p} decks from the database.`):Pe.warn("No decks found in the database."),a(m)}})}async function c0(n){if(n.length===0)return;const a=await St();return new Promise((s,i)=>{const l=a.transaction(nr,"readwrite"),c=l.objectStore(nr);l.oncomplete=()=>{sa(),s()},l.onerror=()=>{Pe.error("Transaction error adding/updating decks",l.error),i(new Error("Transaction error adding/updating decks."))},n.forEach(d=>{const m=c.put(d);m.onerror=()=>{Pe.error(`Error putting deck ${d.name}`,m.error)}})})}async function rE(n){await c0(n)}async function aE(n){const a=await St();return new Promise((s,i)=>{const l=a.transaction(nr,"readwrite");l.oncomplete=()=>{sa(),s()},l.onerror=()=>{Pe.error("Transaction error deleting deck",l.error),i(new Error("Transaction error deleting deck."))},l.objectStore(nr).delete(n)})}async function sE(n){const a=await St();return new Promise((s,i)=>{const l=a.transaction(nr,"readwrite");l.oncomplete=()=>{sa(),s()},l.onerror=()=>{Pe.error("Transaction error updating deck",l.error),i(new Error("Transaction error updating deck."))},l.objectStore(nr).put(n)})}async function iE(){const n=await St();return new Promise((a,s)=>{const c=n.transaction(Hn,"readonly").objectStore(Hn).getAll();c.onerror=()=>{Pe.error("DB Error fetching all folders:",c.error),s(new Error("Error fetching folders from the database."))},c.onsuccess=()=>{const d=c.result,m=Array.isArray(d)?d:[],p=m.length;p>0?Pe.log(`Successfully loaded ${p} folders from the database.`):Pe.warn("No folders found in the database."),a(m)}})}async function oE(n){const a=await St();return new Promise((s,i)=>{const l=a.transaction(Hn,"readwrite");l.oncomplete=()=>{sa(),s()},l.onerror=()=>{Pe.error("Transaction error adding folder",l.error),i(new Error("Transaction error adding folder."))},l.objectStore(Hn).add(n)})}async function lE(n){if(n.length===0)return;const a=await St();return new Promise((s,i)=>{const l=a.transaction(Hn,"readwrite");l.oncomplete=()=>{sa(),s()},l.onerror=()=>{Pe.error("Transaction error adding/updating folders",l.error),i(new Error("Transaction error adding/updating folders."))};const c=l.objectStore(Hn);n.forEach(d=>{const m=c.put(d);m.onerror=()=>{Pe.error(`Error putting folder ${d.name}`,m.error)}})})}async function cE(n){const a=await St();return new Promise((s,i)=>{const l=a.transaction(Hn,"readwrite");l.oncomplete=()=>{sa(),s()},l.onerror=()=>{Pe.error("Transaction error updating folder",l.error),i(new Error("Transaction error updating folder."))},l.objectStore(Hn).put(n)})}async function uE(n){const a=await St();return new Promise((s,i)=>{const l=a.transaction(Hn,"readwrite");l.oncomplete=()=>{sa(),s()},l.onerror=()=>{Pe.error("Transaction error deleting folder",l.error),i(new Error("Transaction error deleting folder."))},l.objectStore(Hn).delete(n)})}async function dE(){const n=await St();return new Promise((a,s)=>{const c=n.transaction(Vn,"readonly").objectStore(Vn).getAll();c.onerror=()=>{Pe.error("DB Error fetching all series:",c.error),s(new Error("Error fetching deck series from the database."))},c.onsuccess=()=>{const d=c.result,m=Array.isArray(d)?d:[],p=m.length;p>0?Pe.log(`Successfully loaded ${p} series from the database.`):Pe.warn("No series found in the database."),a(m)}})}async function fE(n){if(n.length===0)return;const a=await St();return new Promise((s,i)=>{const l=a.transaction(Vn,"readwrite");l.oncomplete=()=>{sa(),s()},l.onerror=()=>{Pe.error("Transaction error adding deck series",l.error),i(new Error("Transaction error adding deck series."))};const c=l.objectStore(Vn);n.forEach(d=>c.put(d))})}async function hE(n){const a=await St();return new Promise((s,i)=>{const l=a.transaction(Vn,"readwrite");l.oncomplete=()=>{sa(),s()},l.onerror=()=>{Pe.error("Transaction error updating deck series",l.error),i(new Error("Error updating deck series."))},l.objectStore(Vn).put(n)})}async function mE(n){const a=await St();return new Promise((s,i)=>{const l=a.transaction(Vn,"readwrite");l.oncomplete=()=>{sa(),s()},l.onerror=()=>{Pe.error("Transaction error deleting deck series",l.error),i(new Error("Error deleting deck series."))},l.objectStore(Vn).delete(n)})}async function pE(n,a){const s=await St();return new Promise((i,l)=>{const c=s.transaction(bn,"readwrite");c.oncomplete=()=>i(),c.onerror=()=>{Pe.error("Transaction error saving session state",c.error),l(new Error("Transaction error saving session state."))},c.objectStore(bn).put({id:n,...a})})}async function gE(n){const a=await St();return new Promise((s,i)=>{const d=a.transaction(bn,"readonly").objectStore(bn).get(n);d.onerror=()=>{Pe.error("DB Error fetching session state",d.error),i(new Error("Error fetching session state."))},d.onsuccess=()=>s(d.result||null)})}async function yE(){const n=await St();return new Promise((a,s)=>{const c=n.transaction(bn,"readonly").objectStore(bn).getAll();c.onsuccess=()=>{const d=c.result,m=Array.isArray(d)?d:[],p=m.length;p>0?Pe.log(`Successfully loaded ${p} sessions from the database.`):Pe.warn("No sessions found in the database."),a(m)},c.onerror=()=>{Pe.error("Failed to get all sessions.",c.error),s(new Error("Failed to get all sessions."))}})}async function vE(){const n=await St();return new Promise((a,s)=>{const c=n.transaction(bn,"readwrite").objectStore(bn).clear();c.onsuccess=()=>a(),c.onerror=()=>{Pe.error("Failed to clear sessions.",c.error),s(new Error("Failed to clear sessions."))}})}async function bE(n){if(n.length===0)return;const a=await St();return new Promise((s,i)=>{const l=a.transaction(bn,"readwrite"),c=l.objectStore(bn);l.oncomplete=()=>s(),l.onerror=()=>{Pe.error("Transaction error adding sessions.",l.error),i(new Error("Transaction error adding sessions."))},n.forEach(d=>c.put(d))})}async function xE(n){const a=await St();return new Promise((s,i)=>{const l=a.transaction(bn,"readwrite");l.oncomplete=()=>s(),l.onerror=()=>{Pe.error("Transaction error deleting session state",l.error),i(new Error("Transaction error deleting session state."))},l.objectStore(bn).delete(n)})}async function _E(){const n=await St();return new Promise((a,s)=>{const c=n.transaction(bn,"readonly").objectStore(bn).getAllKeys();c.onerror=()=>{Pe.error("DB Error fetching session keys",c.error),s(new Error("Error fetching session keys."))},c.onsuccess=()=>a(c.result)})}async function Vh(n){const a=await St();return new Promise((s,i)=>{const d=a.transaction(n,"readwrite").objectStore(n).clear();d.onsuccess=()=>s(),d.onerror=()=>{Pe.error(`Failed to clear object store: ${n}`,d.error),i(new Error(`Failed to clear object store: ${n}.`))}})}const SE=()=>Vh(nr),wE=()=>Vh(Hn),EE=()=>Vh(Vn);async function kE(n){const a=await St();return new Promise((s,i)=>{const d=a.transaction(kr,"readwrite").objectStore(kr).put(n);d.onsuccess=()=>s(),d.onerror=()=>{Pe.error("Failed to save learning progress.",d.error),i(new Error("Failed to save learning progress."))}})}async function TE(){const n=await St();return new Promise((a,s)=>{const c=n.transaction(kr,"readonly").objectStore(kr).getAll();c.onsuccess=()=>{const d={};(Array.isArray(c.result)?c.result:[]).forEach(p=>{d[p.deckId]=p}),a(d)},c.onerror=()=>{Pe.error("Failed to get learning progress.",c.error),s(new Error("Failed to get learning progress."))}})}async function AE(n){if(Object.keys(n).length===0)return;const a=await St();return new Promise((s,i)=>{const l=a.transaction(kr,"readwrite"),c=l.objectStore(kr);l.oncomplete=()=>s(),l.onerror=()=>{Pe.error("Transaction error adding learning progress.",l.error),i(new Error("Transaction error adding learning progress."))},Object.values(n).forEach(d=>{c.put(d)})})}async function Ns(){const n=await St();return new Promise((a,s)=>{const i=[nr,Hn,Vn,mn,bn,Wn,kr],l=n.transaction(i,"readonly"),c={decks:l.objectStore(nr).getAll(),folders:l.objectStore(Hn).getAll(),deckSeries:l.objectStore(Vn).getAll(),reviews:l.objectStore(mn).getAll(),sessions:l.objectStore(bn).getAll(),seriesProgress:l.objectStore(Wn).getAll(),learningProgress:l.objectStore(kr).getAll()};l.oncomplete=()=>{const d={};(Array.isArray(c.seriesProgress.result)?c.seriesProgress.result:[]).forEach(v=>{d[v.id]=v.completedDeckIds});const p={};(Array.isArray(c.learningProgress.result)?c.learningProgress.result:[]).forEach(v=>{p[v.deckId]=v}),a({decks:Array.isArray(c.decks.result)?c.decks.result:[],folders:Array.isArray(c.folders.result)?c.folders.result:[],deckSeries:Array.isArray(c.deckSeries.result)?c.deckSeries.result:[],reviews:Array.isArray(c.reviews.result)?c.reviews.result:[],sessions:Array.isArray(c.sessions.result)?c.sessions.result:[],seriesProgress:d,learningProgress:p})},l.onerror=()=>{Pe.error("Transaction error in getAllDataForBackup",l.error),s(new Error("Database transaction failed while gathering backup data."))}})}async function NE(n){const a=await St();return new Promise((s,i)=>{const l=a.transaction(mn,"readwrite");l.oncomplete=()=>s(),l.onerror=()=>{Pe.error("Transaction error adding review log",l.error),i(new Error("Transaction error adding review log."))},l.objectStore(mn).add(n)})}async function DE(n){const a=await St();return new Promise((s,i)=>{const d=a.transaction(mn,"readonly").objectStore(mn).index("timestamp"),m=IDBKeyRange.lowerBound(n.toISOString()),p=d.getAll(m);p.onerror=()=>{Pe.error("DB Error fetching review logs",p.error),i(new Error("Error fetching review logs."))},p.onsuccess=()=>s(p.result)})}async function CE(){const n=await St();return new Promise((a,s)=>{const c=n.transaction(mn,"readonly").objectStore(mn).getAll();c.onerror=()=>{Pe.error("DB Error fetching all reviews:",c.error),s(new Error("Error fetching all reviews from the database."))},c.onsuccess=()=>{const d=c.result,m=Array.isArray(d)?d:[],p=m.length;p>0&&Pe.log(`Successfully loaded ${p} review logs from the database.`),a(m)}})}async function OE(){const n=await St();return new Promise((a,s)=>{const c=n.transaction(mn,"readwrite").objectStore(mn).clear();c.onsuccess=()=>a(),c.onerror=d=>{Pe.error("Failed to clear review logs",c.error),s(new Error("Failed to clear review logs."))}})}async function jE(n){if(n.length===0)return;const a=await St();return new Promise((s,i)=>{const l=a.transaction(mn,"readwrite"),d=l.objectStore(mn).index("deckId"),m=new Set(n),p=d.openCursor();p.onsuccess=()=>{const h=p.result;h&&(m.has(String(h.value.deckId))&&h.delete(),h.continue())},l.oncomplete=()=>{Pe.log(`Deleted reviews for ${n.length} deck(s).`),s()},l.onerror=()=>{Pe.error("Transaction error deleting reviews for decks",l.error),i(new Error("Failed to delete review logs for specified decks."))}})}async function IE(n){if(n.length===0)return;const a=await St();return new Promise((s,i)=>{const l=a.transaction(mn,"readwrite"),c=l.objectStore(mn);l.oncomplete=()=>s(),l.onerror=()=>{Pe.error("Transaction error adding review logs",l.error),i(new Error("Transaction error adding review logs."))},n.forEach(d=>{const{id:m,...p}=d;c.add(p)})})}async function RE(n){const a=await St();return new Promise((s,i)=>{const m=a.transaction(mn,"readonly").objectStore(mn).index("deckId").getAll(n);m.onerror=()=>{Pe.error(`DB Error fetching reviews for deck ${n}`,m.error),i(new Error(`Error fetching reviews for deck ${n}.`))},m.onsuccess=()=>s(m.result)})}async function u0(n){const a=await St();return new Promise((s,i)=>{const d=a.transaction(ra,"readwrite").objectStore(ra).put({id:"global_history",history:n});d.onsuccess=()=>s(),d.onerror=()=>{Pe.error("Failed to save AI chat history.",d.error),i(new Error("Failed to save AI chat history."))}})}async function Du(){const n=await St();return new Promise((a,s)=>{const c=n.transaction(ra,"readonly").objectStore(ra).get("global_history");c.onsuccess=()=>{var m,p,h;const d=((p=(m=c.result)==null?void 0:m.history)==null?void 0:p.length)??0;d>0&&Pe.log(`Successfully loaded ${d} AI chat history messages.`),a(((h=c.result)==null?void 0:h.history)||[])},c.onerror=()=>{Pe.error("Failed to get AI chat history.",c.error),s(new Error("Failed to get AI chat history."))}})}async function ME(){const n=await St();return new Promise((a,s)=>{const c=n.transaction(ra,"readwrite").objectStore(ra).clear();c.onsuccess=()=>a(),c.onerror=()=>{Pe.error("Failed to clear AI chat history.",c.error),s(new Error("Failed to clear AI chat history."))}})}async function UE(n,a){const s=await St();return new Promise((i,l)=>{const m=s.transaction(Wn,"readwrite").objectStore(Wn).put({id:n,completedDeckIds:Array.from(a)});m.onsuccess=()=>i(),m.onerror=()=>{Pe.error("Failed to save series progress.",m.error),l(new Error("Failed to save series progress."))}})}async function LE(){const n=await St();return new Promise((a,s)=>{const c=n.transaction(Wn,"readonly").objectStore(Wn).getAll();c.onsuccess=()=>{const d={};(Array.isArray(c.result)?c.result:[]).forEach(h=>{d[h.id]=h.completedDeckIds});const p=Object.keys(d).length;p>0&&Pe.log(`Successfully loaded progress for ${p} series.`),a(d)},c.onerror=()=>{Pe.error("Failed to get all series progress.",c.error),s(new Error("Failed to get all series progress."))}})}async function zE(){const n=await St();return new Promise((a,s)=>{const c=n.transaction(Wn,"readwrite").objectStore(Wn).clear();c.onsuccess=()=>a(),c.onerror=()=>{Pe.error("Failed to clear series progress.",c.error),s(new Error("Failed to clear series progress."))}})}async function FE(n){if(Object.keys(n).length===0)return;const a=await St();return new Promise((s,i)=>{const l=a.transaction(Wn,"readwrite"),c=l.objectStore(Wn);l.oncomplete=()=>s(),l.onerror=()=>{Pe.error("Transaction error adding series progress.",l.error),i(new Error("Transaction error adding series progress."))},Object.entries(n).forEach(([d,m])=>{c.put({id:d,completedDeckIds:m})})})}async function d0(){if(typeof window>"u")return null;const{decks:n,folders:a,deckSeries:s,reviews:i,sessions:l,seriesProgress:c,learningProgress:d}=await Ns();if(n.length===0&&a.length===0&&s.length===0)throw new Error("There is no data to export.");const m=localStorage.getItem("cogniflow-ai-options"),p=m?JSON.parse(m):void 0,h=await Du(),v={},S=["themeId","disableAnimations","hapticsEnabled","aiFeaturesEnabled","backupEnabled","backupApiKey","syncOnCellular","notificationsEnabled","leechThreshold","leechAction","fontFamily","encryptionPassword"],A={themeId:"cogniflow-themeId",disableAnimations:"cogniflow-disableAnimations",hapticsEnabled:"cogniflow-hapticsEnabled",aiFeaturesEnabled:"cogniflow-aiFeaturesEnabled",backupEnabled:"cogniflow-backupEnabled",backupApiKey:"cogniflow-backupApiKey",syncOnCellular:"cogniflow-syncOnCellular",notificationsEnabled:"cogniflow-notificationsEnabled",leechThreshold:"cogniflow-leechThreshold",leechAction:"cogniflow-leechAction",fontFamily:"cogniflow-fontFamily",encryptionPassword:"cogniflow-encryptionPassword"};S.forEach(M=>{const F=A[M],q=localStorage.getItem(F);if(q!==null)try{["disableAnimations","hapticsEnabled","aiFeaturesEnabled","backupEnabled","syncOnCellular","notificationsEnabled"].includes(M)?v[M]=JSON.parse(q):["leechThreshold"].includes(M)?v[M]=Number(q):v[M]=q}catch{v[M]=q}});const _={version:9,decks:n,folders:a,deckSeries:s,reviews:i,sessions:l,aiChatHistory:h,seriesProgress:c,learningProgress:d,settings:v};p&&(_.aiOptions=p);const E=JSON.stringify(_,null,2),w=new Blob([E],{type:"application/json"}),k=URL.createObjectURL(w),N=document.createElement("a");N.style.display="none",N.href=k;const I=$h();return N.download=`cogniflow-backup-${I}.json`,document.body.appendChild(N),N.click(),window.URL.revokeObjectURL(k),document.body.removeChild(N),N.download}async function fl(n){const a=await St();return new Promise((s,i)=>{var d,m,p,h,v,S;Pe.log(`Starting atomic restore from backup version ${n.version}.`),Pe.log(`Backup contains: ${((d=n.decks)==null?void 0:d.length)||0} decks, ${((m=n.folders)==null?void 0:m.length)||0} folders, ${((p=n.deckSeries)==null?void 0:p.length)||0} series, ${((h=n.reviews)==null?void 0:h.length)||0} reviews, ${((v=n.sessions)==null?void 0:v.length)||0} sessions, ${Object.keys(n.seriesProgress||{}).length} series progresses, ${Object.keys(n.learningProgress||{}).length} learning progresses, and ${((S=n.aiChatHistory)==null?void 0:S.length)||0} chat messages.`);const l=[nr,Hn,Vn,mn,bn,ra,Wn,kr],c=a.transaction(l,"readwrite");c.oncomplete=()=>{Pe.log("Atomic restore transaction completed successfully. All data has been replaced."),sa(),s()},c.onerror=A=>{Pe.error("Atomic restore transaction failed:",c.error),i(new Error("Database transaction failed during data restore."))};try{Pe.log(`Clearing ${l.length} stores...`);const A=c.objectStore(nr);A.clear();const _=c.objectStore(Hn);_.clear();const E=c.objectStore(Vn);E.clear();const w=c.objectStore(mn);w.clear();const k=c.objectStore(bn);k.clear();const N=c.objectStore(ra);N.clear();const I=c.objectStore(Wn);I.clear();const M=c.objectStore(kr);M.clear(),Pe.log("All stores cleared."),Pe.log("Adding new data from backup..."),(n.decks||[]).forEach(F=>A.put(F)),(n.folders||[]).forEach(F=>_.put(F)),(n.deckSeries||[]).forEach(F=>E.put(F)),(n.reviews||[]).forEach(F=>{const{id:q,...Q}=F;w.add(Q)}),(n.sessions||[]).forEach(F=>k.put(F)),n.aiChatHistory&&n.aiChatHistory.length>0&&N.put({id:"global_history",history:n.aiChatHistory}),Object.entries(n.seriesProgress||{}).forEach(([F,q])=>{I.put({id:F,completedDeckIds:q})}),Object.values(n.learningProgress||{}).forEach(F=>{M.put(F)}),Pe.log("Finished queueing restore operations.")}catch(A){Pe.error("Error queueing operations for atomic restore:",A),c.abort(),i(A)}})}async function BE(){if(fa){try{(await fa).close()}catch(n){console.warn("Could not close existing DB connection (it might have failed to open):",n)}fa=null}return new Promise((n,a)=>{Pe.log(`Attempting to delete database: ${_u}`);const s=indexedDB.deleteDatabase(_u);s.onerror=i=>{Pe.error("Error deleting database.",i.target.error),a(new Error("Error deleting database."))},s.onsuccess=()=>{Pe.log("Database deleted successfully."),n()},s.onblocked=()=>{Pe.error("Database deletion blocked. Please close other tabs of this app and try again."),a(new Error("Deletion blocked. Please close other tabs of this app."))}})}const HE=Object.freeze(Object.defineProperty({__proto__:null,addDeckSeries:fE,addDecks:c0,addFolder:oE,addFolders:lE,addReviewLog:NE,bulkAddLearningProgress:AE,bulkAddReviews:IE,bulkAddSeriesProgress:FE,bulkAddSessions:bE,bulkUpdateDecks:rE,clearAIChatHistory:ME,clearDecks:SE,clearFolders:wE,clearReviews:OE,clearSeries:EE,clearSeriesProgress:zE,clearSessions:vE,deleteDeck:aE,deleteDeckSeries:mE,deleteFolder:uE,deleteReviewsForDecks:jE,deleteSessionState:xE,exportAllData:d0,factoryReset:BE,getAIChatHistory:Du,getAllDataForBackup:Ns,getAllDeckSeries:dE,getAllDecks:nE,getAllFolders:iE,getAllLearningProgress:TE,getAllReviews:CE,getAllSeriesProgress:LE,getAllSessionKeys:_E,getAllSessions:yE,getReviewsForDeck:RE,getReviewsSince:DE,getSessionState:gE,performAtomicRestore:fl,saveAIChatHistory:u0,saveLearningProgress:kE,saveSeriesProgress:UE,saveSessionState:pE,updateDeck:sE,updateDeckSeries:hE,updateFolder:cE},Symbol.toStringTag,{value:"Module"})),Zh="AES-GCM",Ki=16,ou=12;async function f0(n,a,s){const i=new TextEncoder,l=await window.crypto.subtle.importKey("raw",i.encode(n),{name:"PBKDF2"},!1,["deriveKey"]);return window.crypto.subtle.deriveKey({name:"PBKDF2",salt:a,iterations:1e5,hash:"SHA-256"},l,{name:Zh,length:256},!1,s)}async function h0(n,a){const s=window.crypto.getRandomValues(new Uint8Array(Ki)),i=window.crypto.getRandomValues(new Uint8Array(ou)),l=await f0(a,s,["encrypt"]),c=new TextEncoder,d=await window.crypto.subtle.encrypt({name:Zh,iv:i},l,c.encode(n)),m=new Uint8Array(s.byteLength+i.byteLength+d.byteLength);m.set(s,0),m.set(i,s.byteLength),m.set(new Uint8Array(d),s.byteLength+i.byteLength);let p="";for(let h=0;h<m.byteLength;h++)p+=String.fromCharCode(m[h]);return btoa(p)}async function GE(n,a){const s=atob(n),i=new Uint8Array(s.length);for(let p=0;p<s.length;p++)i[p]=s.charCodeAt(p);if(i.byteLength<Ki+ou)throw new Error("Invalid encrypted data.");const l=i.slice(0,Ki),c=i.slice(Ki,Ki+ou),d=i.slice(Ki+ou),m=await f0(a,l,["decrypt"]);try{const p=await window.crypto.subtle.decrypt({name:Zh,iv:c},m,d);return new TextDecoder().decode(p)}catch{throw new Error("Decryption failed. Wrong password or corrupted data.")}}const qE="https://www.greenyogafestival.org/backup-api/api/v1",oi="cogniflow-data",Su="cogniflow-data.json",PE=()=>localStorage.getItem("cogniflow-backupApiKey")||"qRt+gU/57GHKhxTZeRnRi+dfT274iSkKKq2UnTr9Bxs=",m0=n=>localStorage.setItem("cogniflow-lastSyncEtag",n),p0=()=>localStorage.getItem("cogniflow-lastSyncEtag");async function li(n,a={}){const s=`${qE}/${n}`,i=PE(),l=new Headers(a.headers||{});l.set("X-API-Key",i),a.body instanceof FormData&&l.delete("Content-Type");const c={...a,headers:l};console.log(`[BackupService] Requesting: ${a.method||"GET"} ${s}`,{headers:Object.fromEntries(l.entries())});const d=3,m=1e3;for(let p=1;p<=d;p++)try{const h=await window.fetch(s,c);if(console.log(`[BackupService] Response from ${a.method||"GET"} ${s}: ${h.status}`),!h.ok&&![304,404].includes(h.status)){let v;try{v=await h.json()}catch{v={error:`HTTP error! status: ${h.status}`}}console.error("[BackupService] API request failed:",v);const S=(v==null?void 0:v.error)||(v==null?void 0:v.message)||`Request failed with status ${h.status}`,A=new Error(S);throw A.status=h.status,A}return h}catch(h){if(h instanceof TypeError&&h.message.toLowerCase().includes("failed to fetch"))if(p<d){const v=m*Math.pow(2,p-1);console.warn(`[BackupService] Attempt ${p} failed. Retrying in ${v}ms...`,h),await new Promise(S=>setTimeout(S,v));continue}else{console.error("[BackupService] All network attempts failed. This may be a network or CORS issue.",h);const v=new Error("Network error: Could not connect to the backup server. Please check your internet connection and any browser extensions (like ad-blockers) that may be interfering.");throw v.isNetworkError=!0,v}throw h}throw new Error("An unexpected error occurred in the request function.")}async function g0(n){const a=new qh;return a.file("backup.json",JSON.stringify(n)),{dataType:"cogniflow-compressed-backup-v1",content:await a.generateAsync({type:"base64",compression:"DEFLATE",compressionOptions:{level:6}})}}async function lh(n,a=!1){console.log("[BackupService] Starting syncDataToServer...");let s;if(n)s=n;else{const{decks:S,folders:A,deckSeries:_,reviews:E,sessions:w,seriesProgress:k,learningProgress:N}=await Ns(),I=await Du(),M=localStorage.getItem("cogniflow-ai-options"),F=M?JSON.parse(M):void 0;s={version:9,decks:S,folders:A,deckSeries:_,reviews:E,sessions:w,seriesProgress:k,learningProgress:N,aiOptions:F,aiChatHistory:I}}const i=await g0(s);let l=JSON.stringify(i);const c=localStorage.getItem("cogniflow-encryptionPassword");if(c){const S=await h0(l,c);l=JSON.stringify({dataType:"cogniflow-encrypted-v1",content:S}),console.log("[BackupService] Payload encrypted.")}const d={"Content-Type":"application/json"},m=p0();m&&!a&&(d["If-Match"]=m),console.log(`[BackupService] PUT ${Su}`,{headers:d,bodySize:l.length});const p=await li(`apps/${oi}/backups/${Su}`,{method:"PUT",headers:d,body:l});if(!p.ok){let S;try{S=await p.json()}catch{S={error:`HTTP error! status: ${p.status}`}}const A=(S==null?void 0:S.error)||(S==null?void 0:S.message)||`Request failed with status ${p.status}`,_=new Error(A);throw _.status=p.status,_}const h=p.headers.get("ETag");h&&m0(h);const v=await p.json();return console.log("[BackupService] syncDataToServer successful:",v),{timestamp:v.modified,etag:h||""}}async function ch(){console.log("[BackupService] Starting syncDataFromServer...");const n=await li(`apps/${oi}/backups/${Su}`);if(n.status===404)throw new Error("No sync file found on the server.");const a=n.headers.get("ETag");a&&m0(a);let s=await n.text();try{const l=JSON.parse(s);if(l&&l.dataType==="cogniflow-encrypted-v1"){const c=localStorage.getItem("cogniflow-encryptionPassword");if(!c)throw new Error("Sync data is encrypted but no password is set on this device. Please set it in Settings.");s=await GE(l.content,c),console.log("[BackupService] Payload decrypted.")}}catch(l){if(l instanceof Error&&(l.message.includes("Decryption failed")||l.message.includes("password is set")))throw l}const i=await Eu(s);return console.log("[BackupService] syncDataFromServer successful."),i}async function YE(){console.log("[BackupService] Starting getSyncDataMetadata...");const n={},a=p0();a&&(n["If-None-Match"]=a);const s=await li(`apps/${oi}/backups/${Su}/meta`,{headers:n});if(s.status===304||s.status===404)return console.log(`[BackupService] getSyncDataMetadata finished with status: ${s.status}`),{metadata:null,isNotModified:s.status===304};const i=await s.json();return console.log("[BackupService] getSyncDataMetadata successful:",i),{metadata:i,isNotModified:!1}}async function $E(){var s;console.log("[BackupService] Starting listServerBackups...");const a=await(await li(`apps/${oi}/backups/list`)).json();return console.log(`[BackupService] Found ${((s=a.backups)==null?void 0:s.length)||0} backups.`),a.backups||[]}async function VE(){console.log("[BackupService] Starting createServerBackup...");const{decks:n,folders:a,deckSeries:s,reviews:i,sessions:l,seriesProgress:c,learningProgress:d}=await Ns(),m=localStorage.getItem("cogniflow-ai-options"),p=m?JSON.parse(m):void 0,h=await Du(),S=await g0({version:9,decks:n,folders:a,deckSeries:s,reviews:i,sessions:l,seriesProgress:c,learningProgress:d,aiOptions:p,aiChatHistory:h});let A=JSON.stringify(S);const _=localStorage.getItem("cogniflow-encryptionPassword");if(_){const M=await h0(A,_);A=JSON.stringify({dataType:"cogniflow-encrypted-v1",content:M}),console.log("[BackupService] Backup payload encrypted.")}const E=new Blob([A],{type:"application/json"}),w=`backup-${$h()}.json`,k=new FormData;k.append("file",E,w);const I=await(await li(`apps/${oi}/backups`,{method:"POST",body:k})).json();return console.log("[BackupService] createServerBackup successful:",I),I}async function ZE(n){console.log(`[BackupService] Restoring live sync from manual backup: ${n}...`);const s=await(await li(`apps/${oi}/backups/${n}/restore`,{method:"POST"})).json();return console.log(`[BackupService] Restore from ${n} successful:`,s),s}async function QE(n){console.log(`[BackupService] Deleting manual backup: ${n}...`),await li(`apps/${oi}/backups/${n}`,{method:"DELETE"}),console.log(`[BackupService] Deleted ${n} successfully.`)}const KE=({isOpen:n,onClose:a,onRestore:s,onDelete:i})=>{const[l,c]=G.useState([]),[d,m]=G.useState(!1),[p,h]=G.useState(null),[v,S]=G.useState(null),{addToast:A}=Nn(),_=G.useRef(null);On(_,n),G.useEffect(()=>{n&&(async()=>{m(!0),h(null),S("Loading sync file info...");try{const[N,{metadata:I}]=await Promise.all([$E(),YE()]),M=N.sort((F,q)=>new Date(q.modified).getTime()-new Date(F.modified).getTime());if(c(M),I){const F=new Date(I.modified),q=(I.size/1024).toFixed(1);S(`Live sync file: ${F.toLocaleString()} (${q} KB)`)}else S("No live sync file found on server.")}catch(N){const I=N instanceof Error?N.message:"Failed to load backups.";h(I),S("Could not retrieve live sync file info.")}finally{m(!1)}})()},[n]);const E=k=>{s(k),a()},w=async k=>{try{await i(k),c(N=>N.filter(I=>I.filename!==k)),A(`Deleted backup: ${k}`,"success")}catch{}};return u.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-[60] p-4",children:u.jsxs("div",{ref:_,className:"bg-surface rounded-lg shadow-xl w-full max-w-2xl transform transition-all relative max-h-[90vh] flex flex-col",children:[u.jsxs("div",{className:"flex-shrink-0 flex justify-between items-center p-4 border-b border-border",children:[u.jsx("h2",{className:"text-xl font-bold",children:"Manage Server Backups"}),u.jsx(qe,{type:"button",variant:"ghost",onClick:a,className:"p-1 h-auto",children:u.jsx(ze,{name:"x"})})]}),u.jsxs("div",{className:"p-6 overflow-y-auto",children:[u.jsx("p",{className:"text-text-muted mb-2",children:"Select a backup to restore your live sync data from, or delete old backups. Restoring will overwrite the current sync file on the server."}),v&&u.jsx("p",{className:"text-sm text-text-muted mb-4 p-2 bg-background rounded-md",children:v}),d?u.jsx("div",{className:"text-center py-8",children:u.jsx($r,{})}):p?u.jsx("div",{className:"text-center py-8 text-red-500",children:p}):l.length>0?u.jsx("div",{className:"space-y-2 border border-border rounded-md",children:l.map(k=>u.jsxs("div",{className:"flex items-center justify-between p-3 hover:bg-background border-b border-border last:border-b-0",children:[u.jsxs("div",{className:"text-sm min-w-0",children:[u.jsx("p",{className:"font-medium text-text truncate",children:k.filename}),u.jsxs("p",{className:"text-text-muted",children:[new Date(k.modified).toLocaleString()," - ",(k.size/1024).toFixed(2)," KB"]})]}),u.jsxs("div",{className:"flex-shrink-0 flex items-center gap-1",children:[u.jsx(qe,{variant:"secondary",size:"sm",onClick:()=>E(k.filename),children:"Restore"}),u.jsx(qe,{variant:"danger",size:"sm",onClick:()=>w(k.filename),children:"Delete"})]})]},k.filename))}):u.jsx("div",{className:"text-center py-8 text-text-muted",children:u.jsx("p",{children:"No server backups found."})})]}),u.jsx("div",{className:"flex-shrink-0 flex justify-end p-4 bg-background/50 border-t border-border",children:u.jsx(qe,{type:"button",variant:"primary",onClick:a,children:"Close"})})]})})},JE=({isOpen:n,onClose:a,onConfirm:s,analysis:i})=>{const[l,c]=G.useState(""),[d,m]=G.useState(""),[p,h]=G.useState(null),v=G.useRef(null);On(v,n),G.useEffect(()=>{if((i.type==="quiz"||i.type==="learning")&&i.data.name?c(i.data.name):c(""),i.type==="image"&&i.file){const k=new FileReader;k.readAsDataURL(i.file),k.onload=N=>{var I;h((I=N.target)==null?void 0:I.result)}}else h(null);m("")},[i]);const{title:S,message:A,confirmText:_}=G.useMemo(()=>{switch(i.type){case"backup":return{title:"Restore from Backup",message:`You dropped the backup file "${i.fileName}". Restoring will merge its content with your current data. Do you want to continue?`,confirmText:"Restore"};case"series":return{title:"Import Series",message:`You dropped a file containing the series "${i.data.seriesName}". Would you like to import it?`,confirmText:"Import Series"};case"quiz":return{title:"Import Quiz Deck",message:`You dropped a file for the quiz deck "${i.data.name}". Would you like to import it?`,confirmText:"Import Deck"};case"learning":return{title:"Import Learning Deck",message:`You dropped a file for the course "${i.data.name}". It includes instructional cards and associated questions.`,confirmText:"Import Course"};case"flashcard":return{title:"Import Flashcard Deck",message:`You dropped a file with ${i.data.length} flashcard(s). Please provide a name for the new deck.`,confirmText:"Import Deck"};case"anki":return{title:"Import Anki Package",message:`You dropped the Anki package "${i.fileName}". This may contain multiple decks and media.`,confirmText:"Import Anki Package"};case"image":return{title:"Generate Deck from Image",message:"Analyze this image with AI to create a flashcard deck.",confirmText:"Generate Deck"};default:return{title:"Confirm Import",message:"Unknown file type.",confirmText:"Confirm"}}},[i]),E=i.type==="flashcard"&&!l.trim(),w=()=>{s(i,{deckName:l.trim(),imageHint:d.trim()})};return n?u.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-[60] p-4",children:u.jsxs("div",{ref:v,className:"bg-surface rounded-lg shadow-xl w-full max-w-lg transform transition-all relative flex flex-col max-h-[90vh]",children:[u.jsxs("div",{className:"flex-shrink-0 flex justify-between items-center p-4 border-b border-border",children:[u.jsx("h2",{className:"text-xl font-bold text-text",children:S}),u.jsx(qe,{type:"button",variant:"ghost",onClick:a,className:"p-1 h-auto","aria-label":"Close",children:u.jsx(ze,{name:"x"})})]}),u.jsxs("div",{className:"p-6 space-y-4 overflow-y-auto",children:[u.jsx("p",{className:"text-text-muted",children:A}),(i.type==="flashcard"||i.type==="quiz"||i.type==="learning")&&u.jsxs("div",{children:[u.jsx("label",{htmlFor:"deck-name-input",className:"block text-sm font-medium text-text-muted mb-1",children:"Deck Name"}),u.jsx("input",{id:"deck-name-input",type:"text",value:l,onChange:k=>c(k.target.value),className:"w-full p-2 bg-background border border-border rounded-md focus:ring-2 focus:ring-primary focus:outline-none",placeholder:"Enter a name for the new deck",autoFocus:!0})]}),i.type==="image"&&u.jsxs("div",{className:"space-y-4",children:[p&&u.jsx("div",{className:"rounded-lg overflow-hidden border border-border max-h-48 flex justify-center bg-black/5",children:u.jsx("img",{src:p,alt:"Preview",className:"h-full object-contain"})}),u.jsxs("div",{children:[u.jsx("label",{htmlFor:"image-hint",className:"block text-sm font-medium text-text-muted mb-1",children:"Topic / Hint (Optional)"}),u.jsx("input",{type:"text",id:"image-hint",value:d,onChange:k=>m(k.target.value),className:"w-full p-2 bg-background border border-border rounded-md focus:ring-2 focus:ring-primary focus:outline-none",placeholder:"e.g., Focus on dates or biological terms"}),u.jsx("p",{className:"text-xs text-text-muted mt-1",children:"Guide the AI to extract specific information."})]})]})]}),u.jsxs("div",{className:"flex-shrink-0 flex justify-end p-4 bg-background/50 border-t border-border",children:[u.jsx(qe,{type:"button",variant:"secondary",onClick:a,className:"mr-2",children:"Cancel"}),u.jsx(qe,{type:"button",variant:"primary",onClick:w,disabled:E,children:_})]})]})}):null};/*! @license DOMPurify 3.1.2 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/3.1.2/LICENSE */const{entries:y0,setPrototypeOf:Qv,isFrozen:XE,getPrototypeOf:WE,getOwnPropertyDescriptor:e2}=Object;let{freeze:rr,seal:Vr,create:v0}=Object,{apply:Rh,construct:Mh}=typeof Reflect<"u"&&Reflect;rr||(rr=function(a){return a});Vr||(Vr=function(a){return a});Rh||(Rh=function(a,s,i){return a.apply(s,i)});Mh||(Mh=function(a,s){return new a(...s)});const nu=Tr(Array.prototype.forEach),Kv=Tr(Array.prototype.pop),sl=Tr(Array.prototype.push),lu=Tr(String.prototype.toLowerCase),uh=Tr(String.prototype.toString),Jv=Tr(String.prototype.match),il=Tr(String.prototype.replace),t2=Tr(String.prototype.indexOf),n2=Tr(String.prototype.trim),Wr=Tr(Object.prototype.hasOwnProperty),ur=Tr(RegExp.prototype.test),ol=r2(TypeError);function Tr(n){return function(a){for(var s=arguments.length,i=new Array(s>1?s-1:0),l=1;l<s;l++)i[l-1]=arguments[l];return Rh(n,a,i)}}function r2(n){return function(){for(var a=arguments.length,s=new Array(a),i=0;i<a;i++)s[i]=arguments[i];return Mh(n,s)}}function Tt(n,a){let s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:lu;Qv&&Qv(n,null);let i=a.length;for(;i--;){let l=a[i];if(typeof l=="string"){const c=s(l);c!==l&&(XE(a)||(a[i]=c),l=c)}n[l]=!0}return n}function a2(n){for(let a=0;a<n.length;a++)Wr(n,a)||(n[a]=null);return n}function ni(n){const a=v0(null);for(const[s,i]of y0(n))Wr(n,s)&&(Array.isArray(i)?a[s]=a2(i):i&&typeof i=="object"&&i.constructor===Object?a[s]=ni(i):a[s]=i);return a}function ru(n,a){for(;n!==null;){const i=e2(n,a);if(i){if(i.get)return Tr(i.get);if(typeof i.value=="function")return Tr(i.value)}n=WE(n)}function s(){return null}return s}const Xv=rr(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),dh=rr(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),fh=rr(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),s2=rr(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),hh=rr(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),i2=rr(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),Wv=rr(["#text"]),eb=rr(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),mh=rr(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),tb=rr(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),au=rr(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),o2=Vr(/\{\{[\w\W]*|[\w\W]*\}\}/gm),l2=Vr(/<%[\w\W]*|[\w\W]*%>/gm),c2=Vr(/\${[\w\W]*}/gm),u2=Vr(/^data-[\-\w.\u00B7-\uFFFF]/),d2=Vr(/^aria-[\-\w]+$/),b0=Vr(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),f2=Vr(/^(?:\w+script|data):/i),h2=Vr(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),x0=Vr(/^html$/i),m2=Vr(/^[a-z][.\w]*(-[.\w]+)+$/i);var nb=Object.freeze({__proto__:null,MUSTACHE_EXPR:o2,ERB_EXPR:l2,TMPLIT_EXPR:c2,DATA_ATTR:u2,ARIA_ATTR:d2,IS_ALLOWED_URI:b0,IS_SCRIPT_OR_DATA:f2,ATTR_WHITESPACE:h2,DOCTYPE_NAME:x0,CUSTOM_ELEMENT:m2});const p2=function(){return typeof window>"u"?null:window},g2=function(a,s){if(typeof a!="object"||typeof a.createPolicy!="function")return null;let i=null;const l="data-tt-policy-suffix";s&&s.hasAttribute(l)&&(i=s.getAttribute(l));const c="dompurify"+(i?"#"+i:"");try{return a.createPolicy(c,{createHTML(d){return d},createScriptURL(d){return d}})}catch{return console.warn("TrustedTypes policy "+c+" could not be created."),null}};function _0(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:p2();const a=Xe=>_0(Xe);if(a.version="3.1.2",a.removed=[],!n||!n.document||n.document.nodeType!==9)return a.isSupported=!1,a;let{document:s}=n;const i=s,l=i.currentScript,{DocumentFragment:c,HTMLTemplateElement:d,Node:m,Element:p,NodeFilter:h,NamedNodeMap:v=n.NamedNodeMap||n.MozNamedAttrMap,HTMLFormElement:S,DOMParser:A,trustedTypes:_}=n,E=p.prototype,w=ru(E,"cloneNode"),k=ru(E,"nextSibling"),N=ru(E,"childNodes"),I=ru(E,"parentNode");if(typeof d=="function"){const Xe=s.createElement("template");Xe.content&&Xe.content.ownerDocument&&(s=Xe.content.ownerDocument)}let M,F="";const{implementation:q,createNodeIterator:Q,createDocumentFragment:U,getElementsByTagName:j}=s,{importNode:O}=i;let B={};a.isSupported=typeof y0=="function"&&typeof I=="function"&&q&&q.createHTMLDocument!==void 0;const{MUSTACHE_EXPR:te,ERB_EXPR:L,TMPLIT_EXPR:J,DATA_ATTR:D,ARIA_ATTR:ie,IS_SCRIPT_OR_DATA:Z,ATTR_WHITESPACE:Y,CUSTOM_ELEMENT:me}=nb;let{IS_ALLOWED_URI:W}=nb,be=null;const z=Tt({},[...Xv,...dh,...fh,...hh,...Wv]);let R=null;const re=Tt({},[...eb,...mh,...tb,...au]);let oe=Object.seal(v0(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),he=null,fe=null,Me=!0,Fe=!0,Ce=!1,Ve=!0,Qe=!1,ue=!0,de=!1,x=!1,se=!1,X=!1,$=!1,P=!1,K=!0,ye=!1;const ve="user-content-";let ne=!0,ke=!1,Oe={},Te=null;const He=Tt({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let it=null;const at=Tt({},["audio","video","img","source","image","track"]);let Ot=null;const Zt=Tt({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),zt="http://www.w3.org/1998/Math/MathML",qt="http://www.w3.org/2000/svg",ht="http://www.w3.org/1999/xhtml";let bt=ht,pn=!1,It=null;const ya=Tt({},[zt,qt,ht],uh);let dt=null;const Ya=["application/xhtml+xml","text/html"],Nr="text/html";let Ft=null,cn=null;const jn=255,Qn=s.createElement("form"),Zr=function(le){return le instanceof RegExp||le instanceof Function},Ge=function(){let le=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!(cn&&cn===le)){if((!le||typeof le!="object")&&(le={}),le=ni(le),dt=Ya.indexOf(le.PARSER_MEDIA_TYPE)===-1?Nr:le.PARSER_MEDIA_TYPE,Ft=dt==="application/xhtml+xml"?uh:lu,be=Wr(le,"ALLOWED_TAGS")?Tt({},le.ALLOWED_TAGS,Ft):z,R=Wr(le,"ALLOWED_ATTR")?Tt({},le.ALLOWED_ATTR,Ft):re,It=Wr(le,"ALLOWED_NAMESPACES")?Tt({},le.ALLOWED_NAMESPACES,uh):ya,Ot=Wr(le,"ADD_URI_SAFE_ATTR")?Tt(ni(Zt),le.ADD_URI_SAFE_ATTR,Ft):Zt,it=Wr(le,"ADD_DATA_URI_TAGS")?Tt(ni(at),le.ADD_DATA_URI_TAGS,Ft):at,Te=Wr(le,"FORBID_CONTENTS")?Tt({},le.FORBID_CONTENTS,Ft):He,he=Wr(le,"FORBID_TAGS")?Tt({},le.FORBID_TAGS,Ft):{},fe=Wr(le,"FORBID_ATTR")?Tt({},le.FORBID_ATTR,Ft):{},Oe=Wr(le,"USE_PROFILES")?le.USE_PROFILES:!1,Me=le.ALLOW_ARIA_ATTR!==!1,Fe=le.ALLOW_DATA_ATTR!==!1,Ce=le.ALLOW_UNKNOWN_PROTOCOLS||!1,Ve=le.ALLOW_SELF_CLOSE_IN_ATTR!==!1,Qe=le.SAFE_FOR_TEMPLATES||!1,ue=le.SAFE_FOR_XML!==!1,de=le.WHOLE_DOCUMENT||!1,X=le.RETURN_DOM||!1,$=le.RETURN_DOM_FRAGMENT||!1,P=le.RETURN_TRUSTED_TYPE||!1,se=le.FORCE_BODY||!1,K=le.SANITIZE_DOM!==!1,ye=le.SANITIZE_NAMED_PROPS||!1,ne=le.KEEP_CONTENT!==!1,ke=le.IN_PLACE||!1,W=le.ALLOWED_URI_REGEXP||b0,bt=le.NAMESPACE||ht,oe=le.CUSTOM_ELEMENT_HANDLING||{},le.CUSTOM_ELEMENT_HANDLING&&Zr(le.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(oe.tagNameCheck=le.CUSTOM_ELEMENT_HANDLING.tagNameCheck),le.CUSTOM_ELEMENT_HANDLING&&Zr(le.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(oe.attributeNameCheck=le.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),le.CUSTOM_ELEMENT_HANDLING&&typeof le.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(oe.allowCustomizedBuiltInElements=le.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),Qe&&(Fe=!1),$&&(X=!0),Oe&&(be=Tt({},Wv),R=[],Oe.html===!0&&(Tt(be,Xv),Tt(R,eb)),Oe.svg===!0&&(Tt(be,dh),Tt(R,mh),Tt(R,au)),Oe.svgFilters===!0&&(Tt(be,fh),Tt(R,mh),Tt(R,au)),Oe.mathMl===!0&&(Tt(be,hh),Tt(R,tb),Tt(R,au))),le.ADD_TAGS&&(be===z&&(be=ni(be)),Tt(be,le.ADD_TAGS,Ft)),le.ADD_ATTR&&(R===re&&(R=ni(R)),Tt(R,le.ADD_ATTR,Ft)),le.ADD_URI_SAFE_ATTR&&Tt(Ot,le.ADD_URI_SAFE_ATTR,Ft),le.FORBID_CONTENTS&&(Te===He&&(Te=ni(Te)),Tt(Te,le.FORBID_CONTENTS,Ft)),ne&&(be["#text"]=!0),de&&Tt(be,["html","head","body"]),be.table&&(Tt(be,["tbody"]),delete he.tbody),le.TRUSTED_TYPES_POLICY){if(typeof le.TRUSTED_TYPES_POLICY.createHTML!="function")throw ol('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if(typeof le.TRUSTED_TYPES_POLICY.createScriptURL!="function")throw ol('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');M=le.TRUSTED_TYPES_POLICY,F=M.createHTML("")}else M===void 0&&(M=g2(_,l)),M!==null&&typeof F=="string"&&(F=M.createHTML(""));rr&&rr(le),cn=le}},va=Tt({},["mi","mo","mn","ms","mtext"]),gn=Tt({},["foreignobject","annotation-xml"]),fr=Tt({},["title","style","font","a","script"]),$a=Tt({},[...dh,...fh,...s2]),Va=Tt({},[...hh,...i2]),Dr=function(le){let Le=I(le);(!Le||!Le.tagName)&&(Le={namespaceURI:bt,tagName:"template"});const $e=lu(le.tagName),ct=lu(Le.tagName);return It[le.namespaceURI]?le.namespaceURI===qt?Le.namespaceURI===ht?$e==="svg":Le.namespaceURI===zt?$e==="svg"&&(ct==="annotation-xml"||va[ct]):!!$a[$e]:le.namespaceURI===zt?Le.namespaceURI===ht?$e==="math":Le.namespaceURI===qt?$e==="math"&&gn[ct]:!!Va[$e]:le.namespaceURI===ht?Le.namespaceURI===qt&&!gn[ct]||Le.namespaceURI===zt&&!va[ct]?!1:!Va[$e]&&(fr[$e]||!$a[$e]):!!(dt==="application/xhtml+xml"&&It[le.namespaceURI]):!1},In=function(le){sl(a.removed,{element:le});try{le.parentNode.removeChild(le)}catch{le.remove()}},xn=function(le,Le){try{sl(a.removed,{attribute:Le.getAttributeNode(le),from:Le})}catch{sl(a.removed,{attribute:null,from:Le})}if(Le.removeAttribute(le),le==="is"&&!R[le])if(X||$)try{In(Le)}catch{}else try{Le.setAttribute(le,"")}catch{}},ba=function(le){let Le=null,$e=null;if(se)le="<remove></remove>"+le;else{const Jt=Jv(le,/^[\r\n\t ]+/);$e=Jt&&Jt[0]}dt==="application/xhtml+xml"&&bt===ht&&(le='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+le+"</body></html>");const ct=M?M.createHTML(le):le;if(bt===ht)try{Le=new A().parseFromString(ct,dt)}catch{}if(!Le||!Le.documentElement){Le=q.createDocument(bt,"template",null);try{Le.documentElement.innerHTML=pn?F:ct}catch{}}const Wt=Le.body||Le.documentElement;return le&&$e&&Wt.insertBefore(s.createTextNode($e),Wt.childNodes[0]||null),bt===ht?j.call(Le,de?"html":"body")[0]:de?Le.documentElement:Wt},Cr=function(le){return Q.call(le.ownerDocument||le,le,h.SHOW_ELEMENT|h.SHOW_COMMENT|h.SHOW_TEXT|h.SHOW_PROCESSING_INSTRUCTION|h.SHOW_CDATA_SECTION,null)},Is=function(le){return le instanceof S&&(typeof le.__depth<"u"&&typeof le.__depth!="number"||typeof le.__removalCount<"u"&&typeof le.__removalCount!="number"||typeof le.nodeName!="string"||typeof le.textContent!="string"||typeof le.removeChild!="function"||!(le.attributes instanceof v)||typeof le.removeAttribute!="function"||typeof le.setAttribute!="function"||typeof le.namespaceURI!="string"||typeof le.insertBefore!="function"||typeof le.hasChildNodes!="function")},ar=function(le){return typeof m=="function"&&le instanceof m},Bt=function(le,Le,$e){B[le]&&nu(B[le],ct=>{ct.call(a,Le,$e,cn)})},Rt=function(le){let Le=null;if(Bt("beforeSanitizeElements",le,null),Is(le))return In(le),!0;const $e=Ft(le.nodeName);if(Bt("uponSanitizeElement",le,{tagName:$e,allowedTags:be}),le.hasChildNodes()&&!ar(le.firstElementChild)&&ur(/<[/\w]/g,le.innerHTML)&&ur(/<[/\w]/g,le.textContent)||le.nodeType===7||ue&&le.nodeType===8&&ur(/<[/\w]/g,le.data))return In(le),!0;if(!be[$e]||he[$e]){if(!he[$e]&&Za($e)&&(oe.tagNameCheck instanceof RegExp&&ur(oe.tagNameCheck,$e)||oe.tagNameCheck instanceof Function&&oe.tagNameCheck($e)))return!1;if(ne&&!Te[$e]){const ct=I(le)||le.parentNode,Wt=N(le)||le.childNodes;if(Wt&&ct){const Jt=Wt.length;for(let wt=Jt-1;wt>=0;--wt){const _n=w(Wt[wt],!0);_n.__removalCount=(le.__removalCount||0)+1,ct.insertBefore(_n,k(le))}}}return In(le),!0}return le instanceof p&&!Dr(le)||($e==="noscript"||$e==="noembed"||$e==="noframes")&&ur(/<\/no(script|embed|frames)/i,le.innerHTML)?(In(le),!0):(Qe&&le.nodeType===3&&(Le=le.textContent,nu([te,L,J],ct=>{Le=il(Le,ct," ")}),le.textContent!==Le&&(sl(a.removed,{element:le.cloneNode()}),le.textContent=Le)),Bt("afterSanitizeElements",le,null),!1)},Or=function(le,Le,$e){if(K&&(Le==="id"||Le==="name")&&($e in s||$e in Qn))return!1;if(!(Fe&&!fe[Le]&&ur(D,Le))){if(!(Me&&ur(ie,Le))){if(!R[Le]||fe[Le]){if(!(Za(le)&&(oe.tagNameCheck instanceof RegExp&&ur(oe.tagNameCheck,le)||oe.tagNameCheck instanceof Function&&oe.tagNameCheck(le))&&(oe.attributeNameCheck instanceof RegExp&&ur(oe.attributeNameCheck,Le)||oe.attributeNameCheck instanceof Function&&oe.attributeNameCheck(Le))||Le==="is"&&oe.allowCustomizedBuiltInElements&&(oe.tagNameCheck instanceof RegExp&&ur(oe.tagNameCheck,$e)||oe.tagNameCheck instanceof Function&&oe.tagNameCheck($e))))return!1}else if(!Ot[Le]){if(!ur(W,il($e,Y,""))){if(!((Le==="src"||Le==="xlink:href"||Le==="href")&&le!=="script"&&t2($e,"data:")===0&&it[le])){if(!(Ce&&!ur(Z,il($e,Y,"")))){if($e)return!1}}}}}}return!0},Za=function(le){return le!=="annotation-xml"&&Jv(le,me)},Qa=function(le){Bt("beforeSanitizeAttributes",le,null);const{attributes:Le}=le;if(!Le)return;const $e={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:R};let ct=Le.length;for(;ct--;){const Wt=Le[ct],{name:Jt,namespaceURI:wt,value:_n}=Wt,hr=Ft(Jt);let en=Jt==="value"?_n:n2(_n);if($e.attrName=hr,$e.attrValue=en,$e.keepAttr=!0,$e.forceKeepAttr=void 0,Bt("uponSanitizeAttribute",le,$e),en=$e.attrValue,$e.forceKeepAttr||(xn(Jt,le),!$e.keepAttr))continue;if(!Ve&&ur(/\/>/i,en)){xn(Jt,le);continue}Qe&&nu([te,L,J],Ka=>{en=il(en,Ka," ")});const Pn=Ft(le.nodeName);if(Or(Pn,hr,en)){if(ye&&(hr==="id"||hr==="name")&&(xn(Jt,le),en=ve+en),M&&typeof _=="object"&&typeof _.getAttributeType=="function"&&!wt)switch(_.getAttributeType(Pn,hr)){case"TrustedHTML":{en=M.createHTML(en);break}case"TrustedScriptURL":{en=M.createScriptURL(en);break}}try{wt?le.setAttributeNS(wt,Jt,en):le.setAttribute(Jt,en),Kv(a.removed)}catch{}}}Bt("afterSanitizeAttributes",le,null)},ci=function Xe(le){let Le=null;const $e=Cr(le);for(Bt("beforeSanitizeShadowDOM",le,null);Le=$e.nextNode();){if(Bt("uponSanitizeShadowNode",Le,null),Rt(Le))continue;const ct=I(Le);Le.nodeType===1&&(ct&&ct.__depth?Le.__depth=(Le.__removalCount||0)+ct.__depth+1:Le.__depth=1),Le.__depth>=jn&&In(Le),Le.content instanceof c&&(Le.content.__depth=Le.__depth,Xe(Le.content)),Qa(Le)}Bt("afterSanitizeShadowDOM",le,null)};return a.sanitize=function(Xe){let le=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},Le=null,$e=null,ct=null,Wt=null;if(pn=!Xe,pn&&(Xe="<!-->"),typeof Xe!="string"&&!ar(Xe))if(typeof Xe.toString=="function"){if(Xe=Xe.toString(),typeof Xe!="string")throw ol("dirty is not a string, aborting")}else throw ol("toString is not a function");if(!a.isSupported)return Xe;if(x||Ge(le),a.removed=[],typeof Xe=="string"&&(ke=!1),ke){if(Xe.nodeName){const _n=Ft(Xe.nodeName);if(!be[_n]||he[_n])throw ol("root node is forbidden and cannot be sanitized in-place")}}else if(Xe instanceof m)Le=ba("<!---->"),$e=Le.ownerDocument.importNode(Xe,!0),$e.nodeType===1&&$e.nodeName==="BODY"||$e.nodeName==="HTML"?Le=$e:Le.appendChild($e);else{if(!X&&!Qe&&!de&&Xe.indexOf("<")===-1)return M&&P?M.createHTML(Xe):Xe;if(Le=ba(Xe),!Le)return X?null:P?F:""}Le&&se&&In(Le.firstChild);const Jt=Cr(ke?Xe:Le);for(;ct=Jt.nextNode();){if(Rt(ct))continue;const _n=I(ct);ct.nodeType===1&&(_n&&_n.__depth?ct.__depth=(ct.__removalCount||0)+_n.__depth+1:ct.__depth=1),ct.__depth>=jn&&In(ct),ct.content instanceof c&&(ct.content.__depth=ct.__depth,ci(ct.content)),Qa(ct)}if(ke)return Xe;if(X){if($)for(Wt=U.call(Le.ownerDocument);Le.firstChild;)Wt.appendChild(Le.firstChild);else Wt=Le;return(R.shadowroot||R.shadowrootmode)&&(Wt=O.call(i,Wt,!0)),Wt}let wt=de?Le.outerHTML:Le.innerHTML;return de&&be["!doctype"]&&Le.ownerDocument&&Le.ownerDocument.doctype&&Le.ownerDocument.doctype.name&&ur(x0,Le.ownerDocument.doctype.name)&&(wt="<!DOCTYPE "+Le.ownerDocument.doctype.name+`>
`+wt),Qe&&nu([te,L,J],_n=>{wt=il(wt,_n," ")}),M&&P?M.createHTML(wt):wt},a.setConfig=function(){let Xe=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Ge(Xe),x=!0},a.clearConfig=function(){cn=null,x=!1},a.isValidAttribute=function(Xe,le,Le){cn||Ge({});const $e=Ft(Xe),ct=Ft(le);return Or($e,ct,Le)},a.addHook=function(Xe,le){typeof le=="function"&&(B[Xe]=B[Xe]||[],sl(B[Xe],le))},a.removeHook=function(Xe){if(B[Xe])return Kv(B[Xe])},a.removeHooks=function(Xe){B[Xe]&&(B[Xe]=[])},a.removeAllHooks=function(){B={}},a}var y2=_0();const S0=({html:n,className:a,as:s="div"})=>{const i=`html-container-${Wi.useId()}`,l=Wi.useMemo(()=>y2.sanitize(n,{ADD_TAGS:["script","style","iframe","video","audio","source","track","img"],ADD_ATTR:["allow","allowfullscreen","frameborder","scrolling","target","src","data-src","type","controls","autoplay","loop","muted","poster","preload","class","id","style"],FORCE_BODY:!0}),[n]);return Wi.useEffect(()=>{const c=document.getElementById(i);if(!c)return;Array.from(c.getElementsByTagName("img")).forEach(h=>{h.hasAttribute("loading")||h.setAttribute("loading","lazy"),h.hasAttribute("decoding")||h.setAttribute("decoding","async")});const m=Array.from(c.getElementsByTagName("script")),p=[];return m.forEach(h=>{const v=document.createElement("script");Array.from(h.attributes).forEach(S=>{v.setAttribute(S.name,S.value)}),h.text&&!h.src?v.text=`try { ${h.text} } catch (e) { console.error('Error in custom card script:', e); }`:v.text=h.text,document.body.appendChild(v),p.push(v)}),()=>{p.forEach(h=>{document.body.contains(h)&&document.body.removeChild(h)})}},[l,i]),u.jsx(s,{id:i,className:a,dangerouslySetInnerHTML:{__html:l}})},v2=()=>{throw new Error("AI features are disabled. A Google Gemini API key is required.")},b2={type:dr.ARRAY,description:"An array of one or more actions the user wants to perform. If the user is just chatting, return an array with a single NO_ACTION.",items:{type:dr.OBJECT,properties:{action:{type:dr.STRING,enum:Object.values(uu),description:"The specific action the user wants to perform. Use NO_ACTION for conversational replies."},payload:{type:dr.OBJECT,description:"The data needed to perform the action. Include only necessary fields.",properties:{deckId:{type:dr.STRING,description:"The ID of the target deck."},folderId:{type:dr.STRING,description:"The ID of the target folder. Use null to move a deck out of a folder."},name:{type:dr.STRING,description:"The name for a new deck or folder."},newName:{type:dr.STRING,description:"The new name for a deck or folder being renamed."},seriesId:{type:dr.STRING,description:"The ID of the target series for expansion."},levelIndex:{type:dr.NUMBER,description:"The 0-based index of the level within the series to add decks to."},count:{type:dr.NUMBER,description:"The number of questions to generate for a deck."}}},confirmationMessage:{type:dr.STRING,description:"A friendly message to the user asking them to confirm the action. For a NO_ACTION, this should be the AI's conversational reply."}},required:["action","payload","confirmationMessage"]}},x2=async(n,a)=>{var p,h;const s=v2(),i=a.decks.map(v=>`- Deck: "${v.name}" (id: ${v.id}, folderId: ${v.folderId||"none"})`).join(`
`),l=a.folders.map(v=>`- Folder: "${v.name}" (id: ${v.id})`).join(`
`),c=a.series.map(v=>{const S=(v.levels||[]).map((A,_)=>`  - Level ${_}: ${A.title} (${(A.deckIds||[]).length} decks)`).join(`
`);return`- Series: "${v.name}" (id: ${v.id})
${S}`}).join(`
`);let d="";if((p=a.activeContext)!=null&&p.deck){const v=a.activeContext.deck;d=`
CURRENT OPEN DECK: "${v.name}" (ID: ${v.id})
`;const S=v.type==="flashcard"?v.cards.length:v.questions.length;d+=`Contains ${S} items. User might refer to this with "this deck" or "@".
`}if((h=a.activeContext)!=null&&h.series){const v=a.activeContext.series;d+=`
CURRENT OPEN SERIES: "${v.name}" (ID: ${v.id})
`,d+=`User might refer to this with "this series" or "@".
`}const m=`
        You are an AI assistant for 'CogniFlow', a spaced repetition app. Your goal is to help users manage their decks and folders.

        **CRITICAL: REFERENCING CONTEXT (@)**
        Users may use "@" or "this" to refer to the current deck or series they are viewing. 
        ${d}

        You MUST respond with a JSON array of actions.

        **Capabilities:**
        - Create/rename/move/delete decks & folders.
        - Expand learning series.
        - Generate unique questions for decks using HTML formatting.
        - Answer general questions about study materials if context is provided.

        **Instructions:**
        1. Analyze user request. Use active context (marked above) if the user says "@" or "this".
        2. Find relevant IDs in the application state.
        3. For conversational replies, use 'NO_ACTION'.
        4. For data modifications, use a clear 'confirmationMessage'.

        **State:**
        Folders:
        ${l||"None"}
        Decks:
        ${i||"None"}
        Series:
        ${c||"None"}
    `;try{const S=(await s.models.generateContent({model:"gemini-2.5-pro",contents:n,config:{systemInstruction:m,responseMimeType:"application/json",responseSchema:b2,thinkingConfig:{thinkingBudget:32768}}})).text.trim(),A=JSON.parse(S);if(!Array.isArray(A))throw new Error("AI response was not a valid array of actions.");return A}catch(v){throw console.error("Error getting AI response:",v),v instanceof Error&&v.message.includes("SAFETY")?new Error("Blocked by safety settings."):new Error("Sorry, I had trouble with that. Try rephrasing?")}},_2=({isOpen:n,onClose:a,onExecuteAction:s,history:i})=>{const{dispatch:l}=Ke(),c=oo(),d=Uh(),m=N_(),p=Lh(),[h,v]=G.useState(""),[S,A]=G.useState(!1),[_,E]=G.useState(""),w=G.useRef(null),k=G.useRef(null),N=c==null?void 0:c.activeDeck,I=c==null?void 0:c.activeSeries;G.useEffect(()=>{var O;(O=w.current)==null||O.scrollIntoView({behavior:"smooth"})},[i]),G.useEffect(()=>{n&&u0(i)},[i,n]);const M=G.useMemo(()=>{const O=[];return N&&O.push({id:N.id,name:`this deck (${N.name})`,type:"deck"}),I&&O.push({id:I.id,name:`this series (${I.name})`,type:"series"}),m.forEach(B=>O.push({id:B.id,name:B.name,type:"folder"})),d.filter(B=>!B.deletedAt&&!B.archived).forEach(B=>O.push({id:B.id,name:B.name,type:"deck"})),O.filter(B=>B.name.toLowerCase().includes(_.toLowerCase()))},[d,m,N,I,_]),F=O=>{const B=O.target.value;v(B);const te=B.lastIndexOf("@");te!==-1&&te>=B.length-15?(A(!0),E(B.substring(te+1))):A(!1)},q=O=>{var L;const B=h.lastIndexOf("@"),te=h.substring(0,B)+`@${O.name} `;v(te),A(!1),(L=k.current)==null||L.focus()},Q=async O=>{var D;O.preventDefault();const B=h.trim();if(!B)return;v(""),A(!1);const te={id:crypto.randomUUID(),role:"user",text:B},L={id:crypto.randomUUID(),role:"model",text:"",isLoading:!0},J=[...i,te,L];l({type:"SET_AI_CHAT_HISTORY",payload:J});try{const ie=await x2(B,{decks:d,folders:m,series:p,activeContext:{deck:N||void 0,series:I||void 0}}),Z={id:crypto.randomUUID(),role:"model",text:((D=ie.find(Y=>Y.confirmationMessage))==null?void 0:D.confirmationMessage)||"I've processed your request.",actions:ie};l({type:"SET_AI_CHAT_HISTORY",payload:[...i,te,Z]})}catch(ie){const Z={id:crypto.randomUUID(),role:"model",text:ie instanceof Error?ie.message:"An unknown error occurred."};l({type:"SET_AI_CHAT_HISTORY",payload:[...i,te,Z]})}},U=O=>{s(O),a()},j=O=>O.replace(/\*\*(.*?)\*\*/g,"<b>$1</b>").replace(/\*(.*?)\*/g,"<i>$1</i>").replace(/```([\s\S]*?)```/g,'<pre class="bg-gray-800 text-white p-2 rounded my-2 overflow-x-auto text-xs"><code>$1</code></pre>').replace(/`([^`]+)`/g,'<code class="bg-gray-200 dark:bg-gray-700 px-1 rounded text-sm font-mono">$1</code>').replace(/\n/g,"<br />");return n?u.jsxs("div",{className:"fixed inset-0 bg-black/50 z-[60] flex flex-col items-center justify-end",onClick:a,children:[u.jsxs("div",{className:"bg-surface w-full max-w-2xl h-[70vh] max-h-[600px] rounded-t-2xl shadow-2xl flex flex-col transform transition-transform duration-300 animate-fade-in relative",style:{animationName:"slideUp",animationDuration:"0.3s"},onClick:O=>O.stopPropagation(),children:[u.jsxs("header",{className:"flex-shrink-0 flex items-center justify-between p-4 border-b border-border",children:[u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx(ze,{name:"bot",className:"w-6 h-6 text-primary"}),u.jsx("h2",{className:"text-xl font-bold text-text",children:"AI Assistant"})]}),u.jsx(qe,{variant:"ghost",onClick:a,className:"p-1 h-auto",children:u.jsx(ze,{name:"x"})})]}),u.jsx("main",{className:"flex-grow p-4 overflow-y-auto",children:u.jsxs("div",{className:"space-y-4",children:[i.map(O=>u.jsxs("div",{className:`flex gap-3 ${O.role==="user"?"justify-end":"justify-start"}`,children:[O.role==="model"&&u.jsx(ze,{name:"bot",className:"w-6 h-6 text-primary flex-shrink-0 mt-1"}),u.jsxs("div",{className:`max-w-md p-3 rounded-2xl ${O.role==="user"?"bg-primary text-on-primary rounded-br-lg":"bg-background rounded-bl-lg"}`,children:[O.isLoading?u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx($r,{size:"sm"}),u.jsx("span",{className:"text-text-muted",children:"Thinking..."})]}):u.jsx(S0,{html:j(O.text),className:"prose dark:prose-invert max-w-none text-sm"}),O.actions&&O.actions.length>0&&u.jsx("div",{className:"mt-3 pt-3 border-t border-border/50 flex flex-wrap gap-2",children:O.actions.map((B,te)=>B.action!=="NO_ACTION"&&u.jsx(qe,{size:"sm",variant:"secondary",onClick:()=>U(B),children:B.confirmationMessage},te))})]})]},O.id)),u.jsx("div",{ref:w})]})}),u.jsxs("footer",{className:"flex-shrink-0 p-4 border-t border-border relative",children:[S&&M.length>0&&u.jsxs("div",{className:"absolute bottom-full left-4 right-4 mb-2 bg-surface border border-border rounded-lg shadow-2xl max-h-48 overflow-y-auto z-10 animate-fade-in",children:[u.jsx("div",{className:"p-2 text-xs font-bold text-text-muted uppercase border-b border-border",children:"Reference Content"}),M.map(O=>u.jsxs("button",{className:"w-full text-left px-4 py-2 hover:bg-primary/10 flex items-center gap-2 text-sm transition-colors",onClick:()=>q(O),children:[u.jsx(ze,{name:O.type==="deck"?"laptop":O.type==="series"?"layers":"folder",className:"w-4 h-4 text-text-muted"}),u.jsx("span",{className:"truncate",children:O.name})]},`${O.type}-${O.id}`))]}),u.jsxs("form",{onSubmit:Q,className:"flex items-center gap-2",children:[u.jsx("input",{ref:k,type:"text",value:h,onChange:F,placeholder:"Ask a question or type @ to reference...",className:"flex-grow p-2 bg-background border border-border rounded-full focus:ring-2 focus:ring-primary focus:outline-none px-4",autoFocus:!0}),u.jsx(qe,{type:"submit",variant:"primary",className:"rounded-full w-10 h-10 p-0","aria-label":"Send message",children:u.jsx(ze,{name:"arrow-down",className:"w-5 h-5 -rotate-90"})})]})]})]}),u.jsx("style",{children:`
              @keyframes slideUp {
                from { transform: translateY(100%); }
                to { transform: translateY(0); }
              }
            `})]}):null},S2=({isOpen:n,onClose:a,onRestore:s,files:i})=>{const[l,c]=G.useState(""),d=G.useRef(null);On(d,n);const m=()=>{l&&s(l)};return n?u.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-[60] p-4",children:u.jsxs("div",{ref:d,className:"bg-white dark:bg-gray-800 rounded-lg shadow-xl w-full max-w-lg transform transition-all relative max-h-[90vh] flex flex-col",children:[u.jsxs("div",{className:"flex-shrink-0 flex justify-between items-center p-4 border-b border-gray-200 dark:border-gray-700",children:[u.jsx("h2",{className:"text-xl font-bold",children:"Restore from Google Drive"}),u.jsx(qe,{type:"button",variant:"ghost",onClick:a,className:"p-1 h-auto",children:u.jsx(ze,{name:"x"})})]}),u.jsxs("div",{className:"p-6 overflow-y-auto",children:[u.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-4",children:"Select a backup file to restore. Restoring will overwrite decks with the same ID."}),i.length>0?u.jsx("div",{className:"space-y-2 border border-gray-200 dark:border-gray-700 rounded-md",children:i.map(p=>u.jsxs("label",{className:"flex items-center p-3 hover:bg-gray-100 dark:hover:bg-gray-700/50 cursor-pointer border-b border-gray-200 dark:border-gray-700 last:border-b-0",children:[u.jsx("input",{type:"radio",name:"backup-file",value:p.id,checked:l===p.id,onChange:()=>c(p.id),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 dark:border-gray-600 dark:bg-gray-900"}),u.jsxs("div",{className:"ml-3 text-sm",children:[u.jsx("p",{className:"font-medium text-gray-900 dark:text-gray-100",children:p.name}),u.jsxs("p",{className:"text-gray-500 dark:text-gray-400",children:["Last modified: ",new Date(p.modifiedTime).toLocaleString()]})]})]},p.id))}):u.jsx("div",{className:"text-center py-8 text-gray-500 dark:text-gray-400",children:u.jsx("p",{children:"No backup files found in your Google Drive application folder."})})]}),u.jsxs("div",{className:"flex-shrink-0 flex justify-end p-4 bg-gray-100/50 dark:bg-gray-900/50 border-t border-gray-200 dark:border-gray-700",children:[u.jsx(qe,{type:"button",variant:"secondary",onClick:a,className:"mr-2",children:"Cancel"}),u.jsx(qe,{type:"button",variant:"danger",onClick:m,disabled:!l,children:"Restore Selected"})]})]})}):null},rb=n=>{var a,s;return n.type===Ne.Flashcard?((a=n.cards)==null?void 0:a.length)||0:((s=n.questions)==null?void 0:s.length)||0},ph=({label:n,localValue:a,remoteValue:s})=>u.jsxs("div",{className:"text-sm",children:[u.jsxs("span",{className:"font-semibold",children:[n,": "]}),u.jsx("span",{className:"text-text-muted",children:a}),u.jsx(ze,{name:"arrow-down",className:"inline w-3 h-3 mx-1 rotate-[-90deg]"}),u.jsx("span",{className:"text-primary font-semibold",children:s})]}),w2=({isOpen:n,onClose:a,onResolve:s,comparison:i,remoteData:l})=>{const c=G.useRef(null);On(c,n);const{seriesProgress:d}=Ke(),[m,p]=G.useState({decks:{},series:{}}),[h,v]=G.useState(null);G.useMemo(()=>{const E={decks:{},series:{}};i.changedDecks.forEach(w=>E.decks[w.local.id]="remote"),i.changedSeries.forEach(w=>E.series[w.local.id]="remote"),p(E)},[i]);const S=(E,w)=>{p(k=>({...k,[E]:{...k[E],[w]:k[E][w]==="local"?"remote":"local"}})),v("mixed")},A=E=>{const w={decks:{},series:{}};i.changedDecks.forEach(k=>w.decks[k.local.id]=E),i.changedSeries.forEach(k=>w.series[k.local.id]=E),p(w),v(E)},_=()=>{s(m,l)};return n?u.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-[60] p-4",children:u.jsxs("div",{ref:c,className:"bg-surface rounded-lg shadow-xl w-full max-w-2xl transform transition-all relative max-h-[90vh] flex flex-col",role:"alertdialog","aria-modal":"true","aria-labelledby":"conflict-title",children:[u.jsx("div",{className:"flex-shrink-0 flex justify-between items-center p-4 border-b border-border",children:u.jsx("h2",{id:"conflict-title",className:"text-xl font-bold text-yellow-600 dark:text-yellow-400",children:"Sync Conflict"})}),u.jsxs("div",{className:"p-6 overflow-y-auto space-y-4",children:[u.jsx("p",{className:"text-text-muted",children:"Both your local data and the server data have changed since the last sync. Please choose which version to keep for each item."}),u.jsxs("div",{className:"flex gap-2 mb-4",children:[u.jsx(qe,{variant:h==="local"?"primary":"secondary",size:"sm",onClick:()=>A("local"),children:"Keep All Local"}),u.jsx(qe,{variant:h==="remote"?"primary":"secondary",size:"sm",onClick:()=>A("remote"),children:"Take All Remote"})]}),u.jsxs("div",{className:"space-y-6",children:[(i.newSeries.length>0||i.newDecks.length>0)&&u.jsxs("div",{children:[u.jsxs("h3",{className:"font-semibold text-text mb-2 flex items-center gap-2",children:[u.jsx(ze,{name:"plus",className:"w-4 h-4 text-green-500"}),"New Items on Server (Will be added)"]}),u.jsxs("ul",{className:"text-sm list-disc list-inside text-text-muted bg-background p-3 rounded-md border border-border",children:[i.newSeries.map(E=>u.jsxs("li",{children:['Series: "',E.name,'"']},E.id)),i.newDecks.map(E=>u.jsxs("li",{children:['Deck: "',E.name,'"']},E.id))]})]}),i.changedSeries.length>0&&u.jsxs("div",{children:[u.jsx("h3",{className:"font-semibold text-text mb-2",children:"Changed Series"}),u.jsx("div",{className:"space-y-3",children:i.changedSeries.map(({local:E,backup:w})=>{var q,Q;const k=(E.levels||[]).reduce((U,j)=>{var O;return U+(((O=j.deckIds)==null?void 0:O.length)||0)},0),N=(w.levels||[]).reduce((U,j)=>{var O;return U+(((O=j.deckIds)==null?void 0:O.length)||0)},0),I=((q=d.get(E.id))==null?void 0:q.size)||0,M=(((Q=l.seriesProgress)==null?void 0:Q[w.id])||[]).length,F=m.series[E.id]==="local";return u.jsxs("div",{className:`p-3 rounded-md border transition-colors cursor-pointer ${F?"bg-blue-50 dark:bg-blue-900/20 border-blue-200 dark:border-blue-800":"bg-green-50 dark:bg-green-900/20 border-green-200 dark:border-green-800"}`,onClick:()=>S("series",E.id),children:[u.jsxs("div",{className:"flex justify-between items-center mb-2",children:[u.jsx("p",{className:"font-bold",children:E.name}),u.jsx("span",{className:`text-xs font-semibold px-2 py-1 rounded ${F?"bg-blue-100 text-blue-700":"bg-green-100 text-green-700"}`,children:F?"Keeping Local":"Taking Server"})]}),u.jsx(ph,{label:"Progress",localValue:`${I}/${k}`,remoteValue:`${M}/${N}`}),u.jsx("p",{className:"text-xs text-text-muted mt-2 text-right",children:"Tap to toggle"})]},E.id)})})]}),i.changedDecks.length>0&&u.jsxs("div",{children:[u.jsx("h3",{className:"font-semibold text-text mb-2",children:"Changed Decks"}),u.jsx("div",{className:"space-y-3",children:i.changedDecks.map(({local:E,backup:w})=>{const k=i.dueCounts.get(`local-${E.id}`)||0,N=i.dueCounts.get(w.id)||0,I=m.decks[E.id]==="local";return u.jsxs("div",{className:`p-3 rounded-md border transition-colors cursor-pointer ${I?"bg-blue-50 dark:bg-blue-900/20 border-blue-200 dark:border-blue-800":"bg-green-50 dark:bg-green-900/20 border-green-200 dark:border-green-800"}`,onClick:()=>S("decks",E.id),children:[u.jsxs("div",{className:"flex justify-between items-center mb-2",children:[u.jsx("p",{className:"font-bold",children:E.name}),u.jsx("span",{className:`text-xs font-semibold px-2 py-1 rounded ${I?"bg-blue-100 text-blue-700":"bg-green-100 text-green-700"}`,children:I?"Keeping Local":"Taking Server"})]}),u.jsx(ph,{label:"Items",localValue:rb(E),remoteValue:rb(w)}),u.jsx(ph,{label:"Due",localValue:k,remoteValue:N}),u.jsx("p",{className:"text-xs text-text-muted mt-2 text-right",children:"Tap to toggle"})]},E.id)})})]})]})]}),u.jsxs("div",{className:"flex-shrink-0 flex justify-between items-center p-4 bg-background/50 border-t border-border",children:[u.jsx(qe,{type:"button",variant:"danger",onClick:a,children:"Cancel Sync"}),u.jsxs(qe,{variant:"primary",onClick:_,children:[u.jsx(ze,{name:"check-circle",className:"mr-2"}),"Resolve & Merge"]})]})]})}):null},ml=n=>{if(!n)return"";try{return new DOMParser().parseFromString(n,"text/html").body.textContent||""}catch{return String(n).replace(/<[^>]+>/g,"")}},Ck=async(n,a=24e3)=>{const s=atob(n),i=s.length,l=new Uint8Array(i);for(let A=0;A<i;A++)l[A]=s.charCodeAt(A);const c=window.AudioContext||window.webkitAudioContext,d=new c({sampleRate:a}),m=new Int16Array(l.buffer),p=1,h=m.length/p,v=d.createBuffer(p,h,a);for(let A=0;A<p;A++){const _=v.getChannelData(A);for(let E=0;E<h;E++)_[E]=m[E*p+A]/32768}const S=d.createBufferSource();return S.buffer=v,S.connect(d.destination),S.start(),new Promise(A=>{S.onended=()=>{d.close(),A()}})},E2=({isOpen:n,onClose:a,actions:s})=>{const[i,l]=G.useState(""),[c,d]=G.useState(0),m=G.useRef(null),p=G.useRef(null),{navigate:h}=Pa(),v=Uh(),S=Lh();On(m,n);const A=G.useMemo(()=>{const F=[];return s.forEach(q=>F.push({type:"action",id:q.id,label:q.label,icon:q.icon,run:q.action,keywords:q.keywords,searchableOnly:q.searchableOnly})),v.filter(q=>!q.archived&&!q.deletedAt).forEach(q=>F.push({type:"deck",id:q.id,name:q.name,itemType:q.type})),S.filter(q=>!q.archived&&!q.deletedAt).forEach(q=>F.push({type:"series",id:q.id,name:q.name})),v.filter(q=>!q.archived&&!q.deletedAt).forEach(q=>{q.type==="flashcard"?(q.cards||[]).forEach(Q=>F.push({type:"card",id:Q.id,deckId:q.id,deckName:q.name,front:Q.front})):(q.questions||[]).forEach(Q=>F.push({type:"question",id:Q.id,deckId:q.id,deckName:q.name,text:Q.questionText}))}),F},[s,v,S]),_=G.useMemo(()=>{if(!i.trim())return A.filter(Q=>Q.type==="action"&&!Q.searchableOnly);const F=i.toLowerCase();return A.filter(Q=>{switch(Q.type){case"action":{const U=Q,j=U.label.toLowerCase().includes(F),O=(U.keywords||[]).some(B=>B.toLowerCase().includes(F));return j||O}case"deck":return Q.name.toLowerCase().includes(F);case"series":return Q.name.toLowerCase().includes(F);case"card":return ml(Q.front).toLowerCase().includes(F);case"question":return Q.text.toLowerCase().includes(F);default:return!1}}).slice(0,50)},[i,A]),E=G.useMemo(()=>{const F={Actions:[],Series:[],Decks:[],Cards:[]};return _.forEach(q=>{q.type==="action"?F.Actions.push(q):q.type==="series"?F.Series.push(q):q.type==="deck"?F.Decks.push(q):(q.type==="card"||q.type==="question")&&F.Cards.push(q)}),Object.entries(F).filter(([,q])=>q.length>0)},[_]),w=G.useMemo(()=>E.flatMap(([,F])=>F),[E]),k=G.useCallback(F=>{switch(F.type){case"action":F.run();break;case"deck":h(`/decks/${F.id}`);break;case"series":h(`/series/${F.id}`);break;case"card":case"question":h(`/decks/${F.deckId}`);break}a()},[h,a]);G.useEffect(()=>{const F=q=>{if(n)if(q.key==="ArrowDown")q.preventDefault(),d(Q=>(Q+1)%(w.length||1));else if(q.key==="ArrowUp")q.preventDefault(),d(Q=>(Q-1+(w.length||1))%(w.length||1));else if(q.key==="Enter"){q.preventDefault();const Q=w[c];Q&&k(Q)}else q.key==="Escape"&&a()};return window.addEventListener("keydown",F),()=>window.removeEventListener("keydown",F)},[n,c,w,k,a]),G.useEffect(()=>{n&&(l(""),d(0))},[n]),G.useEffect(()=>{d(0)},[i]),G.useEffect(()=>{var F;(F=document.getElementById(`cmdk-item-${c}`))==null||F.scrollIntoView({block:"nearest"})},[c]);const N=F=>{F.target===F.currentTarget&&a()};if(!n)return null;const I=(F,q)=>{let Q,U="",j;switch(F.type){case"action":Q=F.icon,U=F.label;break;case"deck":Q="help-circle",F.itemType===Ne.Flashcard?Q="laptop":F.itemType===Ne.Learning&&(Q="layers"),U=F.name;break;case"series":Q="layers",U=F.name;break;case"card":Q="laptop",U=ml(F.front),j=`In: ${F.deckName}`;break;case"question":Q="help-circle",U=F.text,j=`In: ${F.deckName}`;break}return u.jsxs("li",{id:`cmdk-item-${q}`,role:"option","aria-selected":c===q,onClick:()=>k(F),className:`flex items-center gap-4 px-4 py-3 cursor-pointer rounded-md ${c===q?"bg-primary/10":"hover:bg-border/30"}`,children:[u.jsx(ze,{name:Q,className:"w-5 h-5 text-text-muted flex-shrink-0"}),u.jsxs("div",{className:"flex-grow min-w-0",children:[u.jsx("p",{className:`font-medium truncate ${c===q?"text-primary":"text-text"}`,children:U}),j&&u.jsx("p",{className:`text-sm truncate ${c===q?"text-primary/80":"text-text-muted"}`,children:j})]})]},F.id)};let M=0;return u.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-70 flex justify-center items-start pt-4 sm:pt-[15vh] z-[60] p-4",onClick:N,children:u.jsxs("div",{ref:m,role:"dialog","aria-modal":"true",className:"bg-surface rounded-lg shadow-xl w-full max-w-2xl transform transition-all relative max-h-[70vh] flex flex-col",children:[u.jsxs("div",{className:"flex items-center gap-2 p-4 border-b border-border",children:[u.jsx(ze,{name:"search",className:"w-5 h-5 text-text-muted"}),u.jsx("input",{type:"text",value:i,onChange:F=>l(F.target.value),placeholder:"Search for anything or type a command...",className:"w-full bg-transparent focus:outline-none text-lg placeholder:text-text-muted",autoFocus:!0}),u.jsx("div",{className:"hidden sm:block text-xs text-text-muted border border-border rounded px-1.5 py-0.5",children:"ESC"})]}),u.jsx("div",{className:"flex-grow overflow-y-auto p-2",children:w.length>0?u.jsx("ul",{ref:p,role:"listbox",children:E.map(([F,q])=>u.jsxs("li",{children:[u.jsx("p",{className:"px-4 py-2 text-xs font-semibold text-text-muted uppercase tracking-wider",children:F}),u.jsx("ul",{className:"space-y-1",children:q.map(Q=>I(Q,M++))})]},F))}):u.jsx("div",{className:"text-center py-10 px-4",children:u.jsxs("p",{className:"text-text-muted",children:['No results found for "',i,'".']})})}),u.jsx("div",{className:"hidden sm:flex flex-shrink-0 justify-end items-center p-2 border-t border-border",children:u.jsxs("span",{className:"text-sm text-text-muted",children:[u.jsx(ze,{name:"terminal",className:"inline-block w-4 h-4 mr-2"}),u.jsx("kbd",{className:"font-sans",children:"Cmd+K"})," to toggle"]})})]})})},k2=({isOpen:n,onClose:a,onAddDeck:s})=>{const[i,l]=G.useState(""),{addToast:c}=Nn(),d=G.useRef(null);On(d,n);const m=`{
  "name": "New Quiz Deck Name",
  "description": "A description for the new deck.",
  "questions": [
    {
      "questionText": "What is 2+2?",
      "options": [{"id":"1","text":"4"}, {"id":"2","text":"3"}],
      "correctAnswerId": "1",
      "detailedExplanation": "It's basic math.",
      "tags": []
    }
  ]
}`,p=v=>{if(v.preventDefault(),!i.trim()){c("JSON content cannot be empty.","error");return}try{const S=vu(i);if(S.type!==Ne.Quiz){c("The provided JSON is not a valid Quiz Deck format.","error");return}const A={id:crypto.randomUUID(),name:S.data.name,description:S.data.description,type:Ne.Quiz,questions:S.data.questions.map(_=>({..._,id:crypto.randomUUID(),questionType:"multipleChoice",dueDate:new Date().toISOString(),interval:0,easeFactor:2.5,suspended:!1,lapses:0,masteryLevel:0,detailedExplanation:_.detailedExplanation||"",options:_.options.map(E=>({id:E.id||crypto.randomUUID(),text:E.text,explanation:E.explanation}))}))};s(A),c(`Successfully created and added deck: "${A.name}"`,"success"),a()}catch(S){c(S instanceof Error?S.message:"Invalid JSON format.","error")}},h=v=>{if(v.key==="Tab"){v.preventDefault();const S=v.target,A=S.selectionStart,_=S.selectionEnd;S.value=S.value.substring(0,A)+"  "+S.value.substring(_),S.selectionStart=S.selectionEnd=A+2}};return n?u.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-[60] p-4",children:u.jsx("div",{ref:d,className:"bg-surface rounded-lg shadow-xl w-full max-w-2xl transform transition-all relative",children:u.jsxs("form",{onSubmit:p,children:[u.jsxs("div",{className:"flex justify-between items-center p-4 border-b border-border",children:[u.jsx("h2",{className:"text-xl font-bold",children:"Add New Deck to Series"}),u.jsx(qe,{type:"button",variant:"ghost",onClick:a,className:"p-1 h-auto",children:u.jsx(ze,{name:"x"})})]}),u.jsxs("div",{className:"p-6",children:[u.jsx("label",{htmlFor:"json-content",className:"block text-sm font-medium text-text-muted mb-1",children:"Paste a complete quiz deck object in JSON format."}),u.jsx("textarea",{id:"json-content",value:i,onChange:v=>l(v.target.value),onKeyDown:h,rows:15,className:"w-full p-2 bg-background border border-border rounded-md focus:ring-2 focus:ring-primary focus:outline-none font-mono text-sm",placeholder:m})]}),u.jsxs("div",{className:"flex justify-end p-4 bg-background/50 border-t border-border",children:[u.jsx(qe,{type:"button",variant:"secondary",onClick:a,className:"mr-2",children:"Cancel"}),u.jsx(qe,{type:"submit",variant:"primary",children:"Create & Add Deck"})]})]})})}):null},T2=({isOpen:n,onClose:a,badJson:s,onRetry:i,onCancel:l})=>{const[c,d]=G.useState(s),{addToast:m}=Nn(),p=G.useRef(null);On(p,n);const h=()=>{try{const A=JSON.parse(c);i(A),a()}catch(A){m(`Still not valid JSON. ${A.message}`,"error")}},v=()=>{l(),a()},S=A=>{if(A.key==="Tab"){A.preventDefault();const _=A.target,E=_.selectionStart,w=_.selectionEnd;_.value=_.value.substring(0,E)+"  "+_.value.substring(w),_.selectionStart=_.selectionEnd=E+2}};return n?u.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-[70] p-4",children:u.jsxs("div",{ref:p,className:"bg-surface rounded-lg shadow-xl w-full max-w-3xl transform transition-all relative max-h-[90vh] flex flex-col",children:[u.jsxs("div",{className:"flex-shrink-0 flex justify-between items-center p-4 border-b border-border",children:[u.jsx("h2",{className:"text-xl font-bold",children:"Fix AI Response"}),u.jsx(qe,{type:"button",variant:"ghost",onClick:v,className:"p-1 h-auto",children:u.jsx(ze,{name:"x"})})]}),u.jsxs("div",{className:"flex-grow p-6 space-y-4 overflow-y-auto",children:[u.jsxs("div",{className:"bg-yellow-900/10 border border-yellow-500/30 rounded-lg p-4 text-sm text-yellow-800 dark:text-yellow-200",children:[u.jsxs("p",{children:[u.jsx("strong",{className:"font-bold",children:"Error:"})," The AI returned malformed JSON. This can happen if the response is too long and gets cut off. You can try to fix it manually below."]}),u.jsx("p",{className:"mt-2",children:'Common fixes include adding a missing closing quote (`"`) or bracket/brace (`]` or `}`).'})]}),u.jsxs("div",{children:[u.jsx("label",{htmlFor:"json-fix-content",className:"block text-sm font-medium text-text-muted mb-1",children:"Edit JSON response:"}),u.jsx("textarea",{id:"json-fix-content",value:c,onChange:A=>d(A.target.value),onKeyDown:S,rows:20,className:"w-full p-2 bg-background border border-border rounded-md focus:ring-2 focus:ring-primary focus:outline-none font-mono text-sm"})]})]}),u.jsxs("div",{className:"flex-shrink-0 flex justify-end p-4 bg-background/50 border-t border-border",children:[u.jsx(qe,{type:"button",variant:"secondary",onClick:v,className:"mr-2",children:"Cancel"}),u.jsxs(qe,{type:"button",variant:"primary",onClick:h,children:[u.jsx(ze,{name:"refresh-ccw",className:"w-4 h-4 mr-2"}),"Retry with Fix"]})]})]})}):null},A2=({isOpen:n,onClose:a,params:s})=>{const[i,l]=G.useState([]),[c,d]=G.useState(!0),[m,p]=G.useState(""),[h,v]=G.useState({}),[S,A]=G.useState(""),{options:_}=Nu();oo();const{addToast:E}=Nn(),{dispatch:w,deckSeries:k}=Ke(),N=G.useRef(null),I=G.useRef(!1);G.useEffect(()=>{var Q;(Q=N.current)==null||Q.scrollIntoView({behavior:"smooth"})},[i]),G.useEffect(()=>{if(!n){I.current=!1;return}if(I.current)return;I.current=!0,(async()=>{d(!0),l([]);const U=_.personas.find(B=>B.id===s.persona)||_.personas[0],j=s.seriesId?k[s.seriesId]:null,O=j?{name:j.name,description:j.description}:void 0;try{const{outline:B,metadata:te}=await xw(s,U,O);p(B),v(te),l([{id:crypto.randomUUID(),role:"model",text:`Here is a draft outline for your ${s.generationType.startsWith("series-")?"series":"deck"} on "${s.topic}":

${B}`}])}catch(B){const te=B instanceof Error?B.message:"Failed to generate initial outline.";E(te,"error"),l([{id:crypto.randomUUID(),role:"model",text:`Sorry, I couldn't generate an outline. Error: ${te}`}])}finally{d(!1)}})()},[n,s,_.personas,E,k]);const M=async Q=>{Q.preventDefault();const U=S.trim();if(!U||c)return;A("");const j={id:crypto.randomUUID(),role:"user",text:U},O=[...i,j];l(O),d(!0);const B=_.personas.find(te=>te.id===s.persona)||_.personas[0];try{const te=await _w(O,s,B);p(te),l(L=>[...L,{id:crypto.randomUUID(),role:"model",text:`Here is the refined outline:

${te}`}])}catch(te){const L=te instanceof Error?te.message:"Failed to refine outline.";E(L,"error"),l(J=>[...J,{id:crypto.randomUUID(),role:"model",text:`Sorry, I had trouble with that request. Error: ${L}`}])}finally{d(!1)}},F=async()=>{const Q=crypto.randomUUID(),{generationType:U}=s;if(U.startsWith("series-")){const j={id:Q,type:"generateFullSeriesFromScaffold",payload:{outline:m,generationType:s.generationType},statusText:`Generating series structure for "${s.topic}"`};w({type:"ADD_AI_TASK_TO_QUEUE",payload:j}),E("Series generation started. Check the status indicator below.","info")}else if(["deck-flashcard","deck-vocab","deck-atomic"].includes(U)){const j={id:Q,type:"generateFlashcardDeckWithAI",payload:s,statusText:`Generating flashcards for "${s.topic}"`};w({type:"ADD_AI_TASK_TO_QUEUE",payload:j}),E("Flashcard generation started. Check the status indicator below.","info")}else if(["single-deck-learning","deck-course"].includes(U)){const j={id:Q,type:"generateLearningDeckWithAI",payload:s,statusText:`Generating learning content for "${s.topic}"`};w({type:"ADD_AI_TASK_TO_QUEUE",payload:j}),E("Learning content generation started. Check the status indicator below.","info")}else if(["single-deck-quiz","quiz-blooms"].includes(U)){const j={id:Q,type:"generateDeckFromOutline",payload:{outline:m,metadata:h,seriesId:s.seriesId,levelIndex:s.levelIndex},statusText:`Generating deck content for "${s.topic}"`};w({type:"ADD_AI_TASK_TO_QUEUE",payload:j}),E("Deck generation started. Check the status indicator below.","info")}a()},q=Q=>Q.replace(/^### (.*$)/gim,'<h3 class="text-lg font-bold mt-2">$1</h3>').replace(/^## (.*$)/gim,'<h2 class="text-xl font-bold mt-3 border-b border-border pb-1">$1</h2>').replace(/^# (.*$)/gim,'<h1 class="text-2xl font-bold mt-4 mb-2">$1</h1>').replace(/\*\*(.*?)\*\*/g,"<b>$1</b>").replace(/\*(.*?)\*/g,"<i>$1</i>").replace(/^- (.*$)/gim,'<li class="ml-4">$1</li>').replace(/```([\s\S]*?)```/g,'<pre class="bg-gray-800 text-white p-2 rounded my-2 overflow-x-auto text-xs"><code>$1</code></pre>').replace(/`([^`]+)`/g,'<code class="bg-gray-200 dark:bg-gray-700 px-1 rounded text-sm font-mono">$1</code>').replace(/\n/g,"<br />");return n?u.jsxs("div",{className:"fixed inset-0 bg-black/50 z-[70] flex flex-col items-center justify-end",onClick:a,children:[u.jsxs("div",{className:"bg-surface w-full max-w-3xl h-[85vh] max-h-[800px] rounded-t-2xl shadow-2xl flex flex-col transform transition-transform duration-300 animate-fade-in",style:{animationName:"slideUp",animationDuration:"0.3s"},onClick:Q=>Q.stopPropagation(),children:[u.jsxs("header",{className:"flex-shrink-0 flex items-center justify-between p-4 border-b border-border",children:[u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx(ze,{name:"bot",className:"w-6 h-6 text-primary"}),u.jsx("h2",{className:"text-xl font-bold text-text",children:"AI Content Generation"})]}),u.jsx(qe,{variant:"ghost",onClick:a,className:"p-1 h-auto",children:u.jsx(ze,{name:"x"})})]}),u.jsx("main",{className:"flex-grow p-4 overflow-y-auto",children:u.jsxs("div",{className:"space-y-4",children:[i.map(Q=>u.jsxs("div",{className:`flex gap-3 ${Q.role==="user"?"justify-end":"justify-start"}`,children:[Q.role==="model"&&u.jsx(ze,{name:"bot",className:"w-6 h-6 text-primary flex-shrink-0 mt-1"}),u.jsx("div",{className:`max-w-xl p-3 rounded-2xl ${Q.role==="user"?"bg-primary text-on-primary rounded-br-lg":"bg-background rounded-bl-lg"}`,children:u.jsx(S0,{html:q(Q.text),className:"prose dark:prose-invert max-w-none text-sm"})})]},Q.id)),c&&u.jsxs("div",{className:"flex justify-start gap-3",children:[u.jsx(ze,{name:"bot",className:"w-6 h-6 text-primary flex-shrink-0 mt-1"}),u.jsx("div",{className:"max-w-xl p-3 rounded-2xl bg-background rounded-bl-lg",children:u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx($r,{size:"sm"}),u.jsx("span",{className:"text-text-muted",children:"Thinking..."})]})})]}),u.jsx("div",{ref:N})]})}),u.jsxs("footer",{className:"flex-shrink-0 p-4 border-t border-border space-y-3",children:[u.jsxs("form",{onSubmit:M,className:"flex items-center gap-2",children:[u.jsx("input",{type:"text",value:S,onChange:Q=>A(Q.target.value),placeholder:"Refine the outline...",className:"flex-grow p-2 bg-background border border-border rounded-full focus:ring-2 focus:ring-primary focus:outline-none px-4",disabled:c}),u.jsx(qe,{type:"submit",variant:"secondary",className:"rounded-full w-10 h-10 p-0","aria-label":"Send message",disabled:c,children:u.jsx(ze,{name:"arrow-down",className:"w-5 h-5 -rotate-90"})})]}),u.jsxs("div",{className:"flex justify-end gap-2",children:[u.jsx(qe,{variant:"secondary",onClick:a,disabled:c,children:"Cancel"}),u.jsxs(qe,{variant:"primary",onClick:F,disabled:c||i.length===0,children:[u.jsx(ze,{name:"zap",className:"w-5 h-5 mr-2"}),`Generate ${s.generationType.startsWith("series-")?"Series":"Deck"}`]})]})]})]}),u.jsx("style",{children:`
              @keyframes slideUp {
                from { transform: translateY(100%); }
                to { transform: translateY(0); }
              }
            `})]}):null},N2=({isOpen:n,onClose:a,deck:s,onUpdateDeck:i})=>{const[l,c]=G.useState("analyzing"),[d,m]=G.useState([]),[p,h]=G.useState(new Set),{addToast:v}=Nn(),S=G.useRef(null);On(S,n),G.useEffect(()=>{n&&l==="analyzing"&&(async()=>{try{const N=await Rw(s);m(N),h(new Set(N.map(I=>I.id))),c("review")}catch{v("Analysis failed. Please try again.","error"),a()}})()},[n,s,v,a,l]);const A=k=>{const N=new Set(p);N.has(k)?N.delete(k):N.add(k),h(N)},_=async()=>{c("applying");try{const k=d.filter(I=>p.has(I.id)),N=await Mw(s,k);i(N,{toastMessage:"Deck improvements applied successfully!"}),a()}catch{v("Failed to apply improvements.","error"),c("review")}},E=G.useMemo(()=>{const k={general:{label:"General Improvements",icon:"zap",items:[]},chapters:{label:"Chapters (InfoCards)",icon:"book-open",items:[]},questions:{label:"Questions & Quizzes",icon:"help-circle",items:[]}};return d.forEach(N=>{if(!N.targetId){k.general.items.push(N);return}if(s.type===Ne.Learning&&s.infoCards.some(M=>M.id===N.targetId)){k.chapters.items.push(N);return}k.questions.items.push(N)}),Object.entries(k).filter(([N,I])=>I.items.length>0)},[d,s]),w=k=>{var M,F;if(!k)return null;if(s.type===Ne.Learning){const q=s.infoCards.find(Q=>Q.id===k);if(q)return`Chapter: ${ml(q.content).substring(0,40)}...`}const N=(M=s.questions)==null?void 0:M.find(q=>q.id===k);if(N)return`Question: ${ml(N.questionText).substring(0,40)}...`;const I=(F=s.cards)==null?void 0:F.find(q=>q.id===k);return I?`Card: ${ml(I.front).substring(0,40)}...`:null};return n?u.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-[70] p-4",children:u.jsxs("div",{ref:S,className:"bg-surface rounded-lg shadow-xl w-full max-w-2xl transform transition-all relative flex flex-col max-h-[90vh]",children:[u.jsxs("header",{className:"flex-shrink-0 flex justify-between items-center p-4 border-b border-border",children:[u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx(ze,{name:"zap",className:"w-6 h-6 text-primary"}),u.jsx("h2",{className:"text-xl font-bold text-text",children:"AI Deck Analyzer"})]}),u.jsx(qe,{type:"button",variant:"ghost",onClick:a,className:"p-1 h-auto","aria-label":"Close",children:u.jsx(ze,{name:"x"})})]}),u.jsxs("main",{className:"flex-grow p-6 overflow-y-auto no-scrollbar",children:[l==="analyzing"&&u.jsxs("div",{className:"flex flex-col items-center justify-center h-64 text-center",children:[u.jsx($r,{size:"lg"}),u.jsx("p",{className:"mt-4 text-lg font-medium text-text",children:"Analyzing deck content..."}),u.jsx("p",{className:"text-sm text-text-muted",children:"Checking for pedagogical alignment, accuracy, and clarity."})]}),l==="applying"&&u.jsxs("div",{className:"flex flex-col items-center justify-center h-64 text-center",children:[u.jsx($r,{size:"lg"}),u.jsx("p",{className:"mt-4 text-lg font-medium text-text",children:"Applying improvements..."}),u.jsx("p",{className:"text-sm text-text-muted",children:"Rewriting content and refining instructional flow."})]}),l==="review"&&u.jsxs("div",{className:"space-y-6",children:[u.jsxs("div",{className:"flex justify-between items-center bg-background p-3 rounded-lg border border-border",children:[u.jsxs("p",{className:"text-sm text-text-muted",children:["Pedagogical Review for ",u.jsx("b",{children:s.name})]}),u.jsxs("div",{className:"text-xs space-x-3",children:[u.jsx("button",{onClick:()=>h(new Set(d.map(k=>k.id))),className:"text-primary font-semibold hover:underline",children:"Select All"}),u.jsx("button",{onClick:()=>h(new Set),className:"text-text-muted font-semibold hover:underline",children:"Clear"})]})]}),d.length===0?u.jsxs("div",{className:"text-center py-10 border-2 border-dashed border-border rounded-lg",children:[u.jsx(ze,{name:"check-circle",className:"w-12 h-12 text-green-500 mx-auto mb-2"}),u.jsx("p",{className:"text-text font-medium",children:"No pedagogical issues found!"}),u.jsx("p",{className:"text-text-muted text-sm",children:"Your learning deck is structured perfectly."})]}):u.jsx("div",{className:"space-y-8",children:E.map(([k,N])=>u.jsxs("section",{className:"animate-fade-in",children:[u.jsxs("h3",{className:"text-xs font-bold text-text-muted uppercase tracking-widest mb-3 flex items-center gap-2",children:[u.jsx(ze,{name:N.icon,className:"w-4 h-4"}),N.label]}),u.jsx("ul",{className:"space-y-3",children:N.items.map(I=>{const M=w(I.targetId);return u.jsxs("li",{className:"p-4 bg-background rounded-lg border border-border flex gap-4 transition-all hover:border-primary/50 group",children:[u.jsx("div",{className:"pt-1",children:u.jsx("input",{type:"checkbox",checked:p.has(I.id),onChange:()=>A(I.id),className:"w-5 h-5 text-primary rounded border-gray-300 focus:ring-primary cursor-pointer"})}),u.jsxs("div",{className:"flex-grow min-w-0",children:[u.jsxs("div",{className:"flex justify-between items-start mb-1",children:[u.jsx("h4",{className:"font-bold text-text leading-tight",children:I.title}),u.jsx("span",{className:"text-[10px] px-2 py-0.5 rounded-full bg-surface border border-border font-bold uppercase tracking-tighter text-text-muted whitespace-nowrap ml-2",children:I.category})]}),M&&u.jsx("p",{className:"text-[10px] font-semibold text-primary/80 mb-2 truncate italic",children:M}),u.jsx("p",{className:"text-sm text-text leading-relaxed",children:I.description}),u.jsxs("div",{className:"mt-2 flex items-start gap-1 text-xs text-text-muted bg-primary/5 p-2 rounded italic",children:[u.jsx(ze,{name:"info",className:"w-3.5 h-3.5 flex-shrink-0 mt-0.5 text-primary"}),u.jsx("span",{children:I.rationale})]})]})]},I.id)})})]},k))})]})]}),u.jsx("footer",{className:"flex-shrink-0 p-4 border-t border-border flex justify-end gap-2 bg-background/50",children:l==="review"&&u.jsxs(u.Fragment,{children:[u.jsx(qe,{variant:"secondary",onClick:a,children:"Cancel"}),u.jsxs(qe,{variant:"primary",onClick:_,disabled:p.size===0,children:["Apply ",p.size," Improvement",p.size!==1?"s":""]})]})})]})}):null},D2=(n,a,s,i)=>{const l=[],c=[];n.forEach(p=>{if(p.suspended)return;const h={id:p.id,dueDate:p.dueDate,interval:p.interval,easeFactor:p.easeFactor,lapses:p.lapses,masteryLevel:p.masteryLevel||0,isNew:p.interval===0};h.isNew?c.push(h):l.push(h)});const d=[],m=new Date;m.setHours(0,0,0,0);for(let p=0;p<a;p++){const h=new Date(m);h.setDate(m.getDate()+p);const v=new Date(h).setHours(23,59,59,999),S=[],A=[];l.forEach(w=>{new Date(w.dueDate).getTime()<=v?S.push(w):A.push(w)});const _=[];S.forEach(w=>{const N=Math.random()<i?Sr.Good:Sr.Again;let I=0,M=w.easeFactor;N===Sr.Again?(I=1,M=Math.max(1.3,w.easeFactor-.2)):(M=w.easeFactor,w.interval===0?I=1:I=Math.ceil(w.interval*w.easeFactor));const F=new Date(h);F.setDate(h.getDate()+I);const q={...w,interval:I,easeFactor:M,dueDate:F.toISOString(),isNew:!1};_.push(q)}),_.forEach(w=>A.push(w)),l.length=0,A.forEach(w=>l.push(w));const E=Math.min(s,c.length);for(let w=0;w<E;w++){const k=c.shift();if(k){const N=new Date(h);N.setDate(h.getDate()+1);const I={...k,interval:1,dueDate:N.toISOString(),isNew:!1};l.push(I)}}d.push({day:p,date:h.toLocaleDateString(void 0,{month:"short",day:"numeric"}),reviewCount:S.length,newCount:E,totalLoad:S.length+E})}return d},C2=({data:n})=>{if(n.length===0)return null;const a=Math.max(...n.map(v=>v.totalLoad),10),s=500,i=250,l={top:20,right:10,bottom:30,left:40},c=s-l.left-l.right,d=i-l.top-l.bottom,m=n,p=Math.max(2,c/m.length-1),h=v=>d-v/a*d;return u.jsxs("svg",{viewBox:`0 0 ${s} ${i}`,className:"w-full h-full overflow-visible",children:[[0,.25,.5,.75,1].map(v=>{const S=Math.round(a*v),A=h(S)+l.top;return u.jsxs("g",{children:[u.jsx("line",{x1:l.left,y1:A,x2:s-l.right,y2:A,className:"stroke-border/50",strokeDasharray:"3,3"}),u.jsx("text",{x:l.left-5,y:A+4,className:"text-[10px] fill-text-muted",textAnchor:"end",children:S})]},v)}),m.map((v,S)=>{const A=l.left+S*(c/m.length),_=h(v.totalLoad)+l.top,E=d-h(v.totalLoad),w=v.newCount/v.totalLoad*E||0,k=E-w,N=_,I=_+w;return u.jsxs("g",{className:"group",children:[u.jsx("title",{children:`${v.date}: ${v.reviewCount} reviews + ${v.newCount} new = ${v.totalLoad} total`}),v.newCount>0&&u.jsx("rect",{x:A,y:N,width:p,height:w,className:"fill-blue-400 dark:fill-blue-500 hover:fill-blue-300 transition-colors"}),v.reviewCount>0&&u.jsx("rect",{x:A,y:I,width:p,height:k,className:"fill-green-500 dark:fill-green-600 hover:fill-green-400 transition-colors"})]},S)}),m.map((v,S)=>S%Math.ceil(m.length/5)===0?u.jsx("text",{x:l.left+S*(c/m.length)+p/2,y:i-10,className:"text-[10px] fill-text-muted",textAnchor:"middle",children:v.date},S):null)]})},O2=({isOpen:n,onClose:a,items:s})=>{const[i,l]=G.useState(30),[c,d]=G.useState(0),[m,p]=G.useState(90),[h,v]=G.useState(!1),[S,A]=G.useState([]),_=G.useRef(null);On(_,n),G.useEffect(()=>{if(!n)return;v(!0);const w=setTimeout(()=>{const k=D2(s,i,c,m/100);A(k),v(!1)},100);return()=>clearTimeout(w)},[i,c,m,s,n]);const E=G.useMemo(()=>{if(S.length===0)return null;const w=Math.max(...S.map(I=>I.totalLoad)),k=Math.round(S.reduce((I,M)=>I+M.totalLoad,0)/S.length),N=S.reduce((I,M)=>I+M.newCount,0);return{maxLoad:w,avgLoad:k,totalNew:N}},[S]);return n?u.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-[60] p-4",children:u.jsxs("div",{ref:_,className:"bg-surface rounded-lg shadow-xl w-full max-w-3xl transform transition-all relative max-h-[90vh] flex flex-col",children:[u.jsxs("div",{className:"flex justify-between items-center p-4 border-b border-border",children:[u.jsxs("h2",{className:"text-xl font-bold text-text flex items-center gap-2",children:[u.jsx(ze,{name:"trending-up",className:"text-primary"})," Workload Simulator"]}),u.jsx(qe,{type:"button",variant:"ghost",onClick:a,className:"p-1 h-auto",children:u.jsx(ze,{name:"x"})})]}),u.jsx("div",{className:"p-6 overflow-y-auto flex-grow space-y-6",children:u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[u.jsxs("div",{className:"space-y-4 md:col-span-1 border-b md:border-b-0 md:border-r border-border pb-4 md:pb-0 md:pr-4",children:[u.jsxs("div",{children:[u.jsxs("label",{className:"block text-sm font-medium text-text-muted mb-1",children:["Duration: ",i," days"]}),u.jsx("input",{type:"range",min:"7",max:"180",step:"7",value:i,onChange:w=>l(Number(w.target.value)),className:"w-full accent-primary"})]}),u.jsxs("div",{children:[u.jsxs("label",{className:"block text-sm font-medium text-text-muted mb-1",children:["New Cards / Day: ",c]}),u.jsx("input",{type:"range",min:"0",max:"50",step:"5",value:c,onChange:w=>d(Number(w.target.value)),className:"w-full accent-primary"})]}),u.jsxs("div",{children:[u.jsxs("label",{className:"block text-sm font-medium text-text-muted mb-1",children:["Est. Retention: ",m,"%"]}),u.jsx("input",{type:"range",min:"70",max:"99",step:"1",value:m,onChange:w=>p(Number(w.target.value)),className:"w-full accent-primary"})]}),E&&u.jsxs("div",{className:"bg-background rounded-lg p-3 space-y-2 text-sm border border-border",children:[u.jsxs("div",{className:"flex justify-between",children:[u.jsx("span",{className:"text-text-muted",children:"Peak Load:"}),u.jsx("span",{className:"font-bold text-text",children:E.maxLoad})]}),u.jsxs("div",{className:"flex justify-between",children:[u.jsx("span",{className:"text-text-muted",children:"Average Load:"}),u.jsx("span",{className:"font-bold text-text",children:E.avgLoad})]}),u.jsxs("div",{className:"flex justify-between",children:[u.jsx("span",{className:"text-text-muted",children:"Total New:"}),u.jsx("span",{className:"font-bold text-blue-500",children:E.totalNew})]})]})]}),u.jsxs("div",{className:"md:col-span-2 h-64 md:h-auto flex flex-col",children:[u.jsxs("div",{className:"flex items-center gap-4 text-xs text-text-muted mb-2 justify-end",children:[u.jsxs("div",{className:"flex items-center gap-1",children:[u.jsx("span",{className:"w-3 h-3 bg-blue-400 rounded-sm"})," New Cards"]}),u.jsxs("div",{className:"flex items-center gap-1",children:[u.jsx("span",{className:"w-3 h-3 bg-green-500 rounded-sm"})," Reviews"]})]}),u.jsx("div",{className:"flex-grow relative bg-background/50 rounded-lg border border-border p-2",children:h?u.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-surface/50 backdrop-blur-sm",children:u.jsx($r,{size:"lg"})}):u.jsx(C2,{data:S})}),u.jsx("p",{className:"text-xs text-text-muted mt-2 text-center",children:"This is a projection based on the SM-2 algorithm. Actual workload may vary."})]})]})}),u.jsx("div",{className:"flex justify-end p-4 bg-background/50 border-t border-border",children:u.jsx(qe,{type:"button",variant:"primary",onClick:a,children:"Done"})})]})}):null},j2=({driveFiles:n})=>{const{modalType:a,modalPayload:s,closeModal:i,openModal:l}=Cl(),c=oo(),{aiChatHistory:d}=Ke(),m=Uh(),{navigate:p}=Pa();if(!a)return null;const h=s||{},v=()=>m.reduce((S,A)=>A.type===Ne.Flashcard?S.concat(A.cards||[]):S.concat(A.questions||[]),[]);return u.jsxs(u.Fragment,{children:[a==="import"&&u.jsx(Hw,{isOpen:!0,onClose:i,onAddDecks:c.handleAddDecks,onAddSeriesWithDecks:c.handleAddSeriesWithDecks}),a==="restore"&&u.jsx(qw,{isOpen:!0,onClose:i,onCompare:c.handleCompareBackup,onRestoreSelected:c.handleRestoreSelectedItems,file:h.file,onFullRestore:c.onRestoreData,openConfirmModal:S=>l("confirm",S)}),a==="resetProgress"&&u.jsx(Pw,{isOpen:!0,onClose:i,onReset:c.handleResetDeckProgress,decks:m}),a==="confirm"&&u.jsx(Yw,{isOpen:!0,onClose:i,...h}),a==="folder"&&u.jsx($w,{isOpen:!0,onClose:i,onSave:c.handleSaveFolder,folder:h.folder==="new"?null:h.folder}),a==="series"&&u.jsx(Vw,{isOpen:!0,onClose:i,onSave:c.handleSaveSeries,series:h.series==="new"?null:h.series}),a==="aiGeneration"&&u.jsx(Jw,{isOpen:!0,onClose:i,onStartAIGeneration:c.handleStartAIGeneration,initialTopic:h.initialTopic,context:h.context}),a==="aiGenerationChat"&&u.jsx(A2,{isOpen:!0,onClose:i,params:h.params}),a==="aiStatus"&&u.jsx(Xw,{isOpen:!0,onClose:i,onCancel:c.handleCancelAIGeneration}),a==="serverBackup"&&u.jsx(KE,{isOpen:!0,onClose:i,onRestore:c.handleRestoreFromServerBackup,onDelete:c.handleDeleteServerBackup}),a==="droppedFile"&&u.jsx(JE,{isOpen:!0,onClose:i,onConfirm:c.handleDroppedFileConfirm,analysis:h.analysis}),a==="aiChat"&&u.jsx(_2,{isOpen:!0,onClose:i,onExecuteAction:c.handleExecuteAIAction,history:d}),a==="restoreFromDrive"&&u.jsx(S2,{isOpen:!0,onClose:i,onRestore:c.handleRestoreFromDrive,files:n}),a==="addDeckToSeries"&&u.jsx(k2,{isOpen:!0,onClose:i,onAddDeck:S=>c.handleAddDeckToSeries(h.seriesId,S)}),a==="mergeConflict"&&u.jsx(w2,{isOpen:!0,onClose:i,onResolve:c.handleMergeResolution,comparison:h.comparison,remoteData:h.remoteData}),a==="commandPalette"&&u.jsx(E2,{isOpen:!0,onClose:i,actions:[{id:"import",label:"Create / Import Deck",icon:"plus",action:()=>l("import"),keywords:["new","add"]},{id:"settings",label:"Settings",icon:"settings",action:()=>p("/settings")},{id:"trash",label:"View Trash",icon:"trash-2",action:()=>p("/trash")},{id:"archive",label:"View Archive",icon:"archive",action:()=>p("/archive")},{id:"progress",label:"View Progress",icon:"trending-up",action:()=>p("/progress")},{id:"simulate",label:"Simulate Workload",icon:"trending-up",action:()=>l("workloadSimulator")}]}),a==="aiResponseFix"&&u.jsx(T2,{isOpen:!0,onClose:i,...h}),a==="deckAnalysis"&&u.jsx(N2,{isOpen:!0,onClose:i,deck:h.deck,onUpdateDeck:c.handleUpdateDeck}),a==="workloadSimulator"&&u.jsx(O2,{isOpen:!0,onClose:i,items:v()})]})},I2=({onOpen:n,onCancel:a})=>{const{currentTask:s,queue:i}=Ke(h=>h.aiGenerationStatus),{aiFeaturesEnabled:l}=ii(),c=s!==null,d=(i==null?void 0:i.length)||0,m=(c?1:0)+d;if(!l||m===0)return null;const p=(s==null?void 0:s.statusText)||`${d} task(s) queued...`;return u.jsx("div",{className:"fixed bottom-6 left-6 z-40",children:u.jsxs("button",{onClick:n,className:"bg-surface rounded-lg shadow-lg flex items-center p-2 gap-3 transition-all hover:shadow-xl animate-fade-in","aria-label":"View AI generation status",children:[u.jsxs("div",{className:"relative w-10 h-10 flex items-center justify-center",children:[u.jsx("svg",{className:"absolute w-full h-full",style:{animation:c?"spin 1.5s linear infinite":"none"},viewBox:"0 0 24 24",children:u.jsx("circle",{cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"2",fill:"none",className:c?"text-primary/50":"text-text-muted/50",strokeDasharray:c?"40 100":"5 15"})}),u.jsx(ze,{name:"bot",className:`w-6 h-6 ${c?"text-primary":"text-text-muted"}`})]}),u.jsxs("div",{className:"flex flex-col text-left pr-2",children:[u.jsx("span",{className:"font-semibold text-sm text-text",children:c?"AI is working...":"AI Queue"}),u.jsx("span",{className:"text-xs text-text-muted truncate max-w-[200px]",title:p,children:p})]}),m>0&&u.jsx("div",{className:"bg-primary text-on-primary text-xs font-bold rounded-full h-6 w-6 flex items-center justify-center self-center mr-2",children:m})]})})},R2=()=>{const{openModal:n}=Cl(),{aiFeaturesEnabled:a}=ii(),s=()=>{n("aiChat")};return a?u.jsx("div",{className:"fixed bottom-6 right-6 z-40 animate-fade-in",children:u.jsx(qe,{variant:"primary",onClick:s,className:"rounded-full w-16 h-16 shadow-lg flex items-center justify-center","aria-label":"Open AI Assistant",children:u.jsx(ze,{name:"bot",className:"w-8 h-8"})})}):null},M2=()=>{const n=()=>{const i=navigator,l=i.connection;return{isOnline:i.onLine,isMetered:l?l.type==="cellular"||l.saveData===!0:!1}},[a,s]=G.useState(n);return G.useEffect(()=>{const i=()=>s(n()),c=navigator.connection;return window.addEventListener("online",i),window.addEventListener("offline",i),c==null||c.addEventListener("change",i),()=>{window.removeEventListener("online",i),window.removeEventListener("offline",i),c==null||c.removeEventListener("change",i)}},[]),a},U2=()=>{const{isOnline:n}=M2();return n?null:u.jsx("div",{role:"status","aria-live":"assertive",title:"You are currently offline",className:"fixed bottom-6 right-6 z-50 bg-surface rounded-full w-12 h-12 shadow-lg flex items-center justify-center border-2 border-border animate-fade-in",children:u.jsx(ze,{name:"wifi-off",className:"w-6 h-6 text-text-muted"})})},L2=({pullDistance:n,isRefreshing:a,threshold:s})=>{if(a)return u.jsx("div",{className:"fixed top-0 left-0 right-0 h-20 flex items-center justify-center z-50 transition-all duration-300",children:u.jsx($r,{size:"md"})});if(n<=0)return null;const i=Math.min(n/s,1),l=i>=1,c=Math.min(.5+i*.5,1),d=20,m=2*Math.PI*d,p=m-i*m;return u.jsx("div",{className:"fixed top-0 left-0 right-0 h-20 flex items-center justify-center z-10 pointer-events-none",style:{transform:`translateY(${Math.min(n,s*1.5)-80}px) scale(${c})`,opacity:Math.min(n/(s/2),1)},children:u.jsxs("div",{className:"relative w-12 h-12 flex items-center justify-center bg-white dark:bg-gray-800 rounded-full shadow-lg transition-transform duration-200",style:{transform:l?"scale(1.1)":"scale(1)"},children:[u.jsxs("svg",{className:"absolute w-full h-full transform -rotate-90",viewBox:"0 0 44 44",children:[u.jsx("circle",{className:"text-gray-300/50 dark:text-gray-600/50",stroke:"currentColor",strokeWidth:"4",fill:"transparent",r:d,cx:"22",cy:"22"}),u.jsx("circle",{className:"text-blue-500",stroke:"currentColor",strokeWidth:"4",strokeLinecap:"round",fill:"transparent",r:d,cx:"22",cy:"22",style:{strokeDasharray:m,strokeDashoffset:p,transition:l?"stroke-dashoffset 0.1s linear":"none"}})]}),u.jsx(ze,{name:l?"refresh-ccw":"arrow-down",className:`w-6 h-6 transition-colors duration-200 ${l?"text-blue-500":"text-gray-500 dark:text-gray-400"}`})]})})},z2=10,F2=()=>{const[n,a]=G.useState(!0),s=G.useRef(0),i=G.useRef(!1),l=G.useCallback(()=>{const c=window.scrollY;c<=0||c<s.current?a(!0):c>s.current&&c>z2&&a(!1),s.current=c},[]);return G.useEffect(()=>{const c=()=>{i.current||(window.requestAnimationFrame(()=>{l(),i.current=!1}),i.current=!0)};return window.addEventListener("scroll",c,{passive:!0}),()=>window.removeEventListener("scroll",c)},[l]),n},su=120,B2=()=>{const[n,a]=G.useState({startY:0,pullDistance:0,isRefreshing:!1,thresholdMet:!1}),{hapticsEnabled:s}=ii(),i=G.useCallback(d=>{if(d.touches.length===0)return;const m=d.target;window.scrollY===0&&!m.closest('input, textarea, button, a[href], select, [role="button"], [role="switch"]')?a(p=>({...p,startY:d.touches[0].clientY,pullDistance:0,isRefreshing:!1,thresholdMet:!1})):a(p=>({...p,startY:0}))},[]),l=G.useCallback(d=>{if(n.startY===0||d.touches.length===0)return;const m=d.touches[0].clientY-n.startY;m>5&&(d.preventDefault(),m>su&&!n.thresholdMet&&s&&"vibrate"in navigator&&navigator.vibrate(50),a(h=>({...h,pullDistance:m,thresholdMet:m>su})))},[n.startY,n.thresholdMet,s]),c=G.useCallback(()=>{n.startY!==0&&(n.pullDistance>su?(a(d=>({...d,isRefreshing:!0})),setTimeout(()=>{window.location.reload()},500)):a({startY:0,pullDistance:0,isRefreshing:!1,thresholdMet:!1}))},[n.startY,n.pullDistance]);return{pullToRefreshState:n,handleTouchStart:i,handleTouchMove:l,handleTouchEnd:c,REFRESH_THRESHOLD:su}},H2=()=>{const{dispatch:n,aiGenerationStatus:a,isLoading:s}=Ke(),i=oo(),l=F2(),{pullToRefreshState:c,handleTouchStart:d,handleTouchMove:m,handleTouchEnd:p,REFRESH_THRESHOLD:h}=B2(),[v,S]=G.useState(!1),[A,_]=G.useState([]),[E,w]=G.useState(!1);G.useEffect(()=>{(async()=>{const{currentTask:F,queue:q}=a;if(!F&&q&&q.length>0){const Q=q[0],U=new AbortController;n({type:"START_NEXT_AI_TASK",payload:{task:Q,abortController:U}});try{switch(Q.type){case"generateDeckFromOutline":await i.onGenerateDeckFromOutline(Q.payload.outline,Q.payload.metadata,Q.payload.seriesId,Q.payload.levelIndex,U.signal,Q.deckId);break;case"generateFullSeriesFromScaffold":await i.onGenerateFullSeriesFromScaffold(Q.payload,U.signal);break;case"generateFlashcardDeckWithAI":await i.onGenerateFlashcardDeck(Q.payload,U.signal);break;case"generateLearningDeckWithAI":await i.onGenerateLearningDeckWithAI(Q.payload,U.signal);break;case"autoPopulateSeries":await i.onAutoPopulateSeries(Q.payload,U.signal);break;case"autoPopulateLevel":await i.onAutoPopulateLevel(Q.payload,U.signal);break;case"generateQuestionsForDeck":await i.onGenerateQuestionsForDeck(Q.payload.deck,Q.payload.count,void 0,U.signal);break;case"generateSeriesLearningContentInBatches":await i.onGenerateLearningContentForDeck(Q.payload,U.signal);break;case"generateSeriesQuestionsInBatches":await i.onGenerateSeriesQuestionsInBatches(Q.payload,U.signal);break;case"regenerateQuestion":await i.onRegenerateQuestion(Q.payload,U.signal);break;case"upgradeDeckToLearning":await i.onUpgradeDeckToLearning(Q.payload,U.signal);break;case"hardenAllDistractors":await i.onHardenAllDistractors(Q.payload,U.signal);break;case"generateAudioForAllCards":await i.onGenerateAudioForAllCards(Q.payload,U.signal);break;case"rework-deck":await i.onReworkDeckContent(Q.payload,U.signal);break}}catch(j){j instanceof Error&&j.message!=="Cancelled by user"&&(console.error("AI Task Failed:",j),i.addToast(`Generation failed: ${j.message}`,"error"))}finally{n({type:"FINISH_CURRENT_AI_TASK"})}}})()},[a,n,i]);const k=G.useCallback(M=>{M.preventDefault(),M.stopPropagation(),M.dataTransfer.types.includes("Files")&&w(!0)},[]),N=G.useCallback(M=>{M.preventDefault(),M.stopPropagation(),(M.currentTarget===M.target||!M.currentTarget.contains(M.relatedTarget))&&w(!1)},[]),I=G.useCallback(async M=>{var Q;M.preventDefault(),M.stopPropagation(),w(!1);const F=(Q=M.dataTransfer.files)==null?void 0:Q[0];if(!F)return;const q=await Ib(F);q?i.openModal("droppedFile",{analysis:q}):i.addToast("Unrecognized file format. Please drop a JSON, Anki, or Image file.","error")},[i]);return s?null:u.jsxs("div",{className:"min-h-screen bg-background text-text selection:bg-primary selection:text-on-primary transition-colors duration-300 relative",onTouchStart:d,onTouchMove:m,onTouchEnd:p,onDragOver:k,onDragLeave:N,onDrop:I,children:[E&&u.jsxs("div",{className:"fixed inset-0 z-[100] bg-primary/20 backdrop-blur-sm border-4 border-dashed border-primary m-4 rounded-2xl flex flex-col items-center justify-center animate-fade-in pointer-events-none",children:[u.jsx("div",{className:"bg-surface p-8 rounded-full shadow-2xl scale-110 mb-6",children:u.jsx(ze,{name:"upload-cloud",className:"w-16 h-16 text-primary"})}),u.jsx("h2",{className:"text-3xl font-bold text-primary bg-surface/80 px-6 py-2 rounded-lg backdrop-blur-md",children:"Drop to Import"}),u.jsx("p",{className:"text-primary font-medium mt-2",children:"JSON, Anki, CSV, or Image"})]}),u.jsx(L2,{pullDistance:c.pullDistance,isRefreshing:c.isRefreshing,threshold:h}),u.jsx(W_,{onOpenMenu:()=>S(!0),onOpenCommandPalette:()=>i.openModal("commandPalette"),activeDeck:i.activeDeck,isVisible:l}),u.jsx(tS,{isOpen:v,onClose:()=>S(!1),onImport:()=>i.openModal("import"),onCreateSeries:()=>i.openModal("series",{series:"new"}),onGenerateAI:()=>i.openModal("aiGeneration"),onInstall:null}),u.jsx("main",{className:"container mx-auto px-4 pt-24 pb-20 sm:px-6 lg:px-8 max-w-7xl min-h-[calc(100vh-4rem)]",children:u.jsx(X_,{})}),u.jsx(j2,{driveFiles:A}),u.jsx(I2,{onOpen:()=>i.openModal("aiStatus"),onCancel:i.handleCancelAIGeneration}),u.jsx(R2,{}),u.jsx(U2,{})]})};class G2 extends Wi.Component{constructor(){super(...arguments),this.state={hasError:!1,error:null,errorInfo:null},this.handleReload=()=>{window.location.reload()},this.handleCopyReport=()=>{const{error:a,errorInfo:s}=this.state,i=`
Error Report
Date: ${new Date().toISOString()}
URL: ${window.location.href}
User Agent: ${navigator.userAgent}

Error: ${a==null?void 0:a.toString()}

Stack Trace:
${a==null?void 0:a.stack}

Component Stack:
${s==null?void 0:s.componentStack}
    `.trim();navigator.clipboard.writeText(i).then(()=>{alert("Error report copied to clipboard.")}).catch(l=>{console.error("Failed to copy report:",l),alert("Failed to copy report to clipboard.")})}}static getDerivedStateFromError(a){return{hasError:!0,error:a,errorInfo:null}}componentDidCatch(a,s){console.error("Uncaught error:",a,s),this.setState({errorInfo:s})}render(){const{hasError:a,error:s}=this.state,{children:i}=this.props;return a?u.jsx("div",{className:"min-h-screen flex items-center justify-center p-4 bg-background",children:u.jsxs("div",{className:"text-center bg-surface p-8 rounded-lg shadow-xl max-w-lg w-full border border-border",children:[u.jsx(ze,{name:"x-circle",className:"w-16 h-16 text-red-500 mx-auto mb-4"}),u.jsx("h1",{className:"text-3xl font-bold text-red-500 mb-4",children:"Something went wrong"}),u.jsx("p",{className:"text-text-muted mb-6",children:"An unexpected error occurred. Please try reloading the page."}),s&&u.jsxs("details",{className:"text-left bg-background p-4 rounded-md mb-6 overflow-auto max-h-64",children:[u.jsx("summary",{className:"cursor-pointer text-sm text-text-muted font-bold",children:"Error Details"}),u.jsx("pre",{className:"mt-2 text-xs text-red-400 whitespace-pre-wrap break-all",children:u.jsx("code",{children:s.toString()})})]}),u.jsxs("div",{className:"flex flex-wrap gap-4 justify-center",children:[u.jsxs(qe,{variant:"secondary",onClick:this.handleCopyReport,children:[u.jsx(ze,{name:"file-text",className:"w-4 h-4 mr-2"}),"Copy Report"]}),u.jsxs(qe,{variant:"danger",onClick:this.handleReload,children:[u.jsx(ze,{name:"refresh-ccw",className:"w-4 h-4 mr-2"}),"Reload Page"]})]})]})}):i}}const gh="cogniflow-themeId",ab="cogniflow-custom-themes",no=[{id:"system",name:"System",isDark:!1,metaColor:"#f9fafb",metaColorDark:"#111827",palette:{background:"249 250 251",surface:"255 255 255",primary:"37 99 235",text:"17 24 39"},paletteDark:{background:"17 24 39",surface:"31 41 55",primary:"37 99 235",text:"243 244 246"}},{id:"light",name:"Light",isDark:!1,metaColor:"#f9fafb",palette:{background:"249 250 251",surface:"255 255 255",primary:"37 99 235",text:"17 24 39"}},{id:"rose",name:"Rose",isDark:!1,metaColor:"#fff1f2",palette:{background:"255 241 242",surface:"254 226 226",primary:"225 29 72",text:"136 25 55"}},{id:"matcha",name:"Matcha",isDark:!1,metaColor:"#f0fdf4",palette:{background:"240 253 244",surface:"220 252 231",primary:"22 163 74",text:"21 94 53"}},{id:"latte",name:"Latte",isDark:!1,metaColor:"#fffbeb",palette:{background:"255 251 235",surface:"254 243 199",primary:"217 119 6",text:"113 63 18"}},{id:"sky",name:"Sky",isDark:!1,metaColor:"#f0f9ff",palette:{background:"240 249 255",surface:"224 242 254",primary:"14 165 233",text:"7 89 133"}},{id:"sunrise",name:"Sunrise",isDark:!1,metaColor:"#fffbeb",palette:{background:"255 251 235",surface:"254 243 199",primary:"249 115 22",text:"124 45 18"}},{id:"lavender",name:"Lavender",isDark:!1,metaColor:"#f5f3ff",palette:{background:"245 243 255",surface:"237 233 254",primary:"124 58 237",text:"76 29 149"}},{id:"terracotta",name:"Terracotta",isDark:!1,metaColor:"#faf3e8",palette:{background:"250 243 232",surface:"245 233 218",primary:"226 114 91",text:"93 64 55"}},{id:"alabaster",name:"Alabaster",isDark:!1,metaColor:"#fcfcfc",palette:{background:"252 252 252",surface:"255 255 255",primary:"96 165 250",text:"50 50 50"}},{id:"dark",name:"Dark",isDark:!0,metaColor:"#111827",palette:{background:"17 24 39",surface:"31 41 55",primary:"37 99 235",text:"243 244 246"}},{id:"espresso",name:"Espresso",isDark:!0,metaColor:"#211713",palette:{background:"33 23 19",surface:"58 45 39",primary:"196 154 108",text:"224 213 208"}},{id:"midnight",name:"Midnight",isDark:!0,metaColor:"#0c0d11",palette:{background:"12 13 17",surface:"26 27 38",primary:"133 137 230",text:"200 201 215"}}],w0=G.createContext(void 0),sb=(n,a=[])=>{let s=no.find(m=>m.id===n);s||(s=a.find(m=>m.id===n)),s||(s=no[0]);const i=window.document.documentElement,l=document.querySelector('meta[name="theme-color"]');let c,d;if(s.id==="system"?(c=window.matchMedia("(prefers-color-scheme: dark)").matches,d=c?s.metaColorDark:s.metaColor):(c=s.isDark,d=s.metaColor),no.forEach(m=>{m.id!=="system"&&i.classList.remove(`theme-${m.id}`)}),a.forEach(m=>i.classList.remove(`theme-${m.id}`)),i.classList.remove("theme-dark","theme-light"),i.classList.toggle("dark",c),l&&d&&l.setAttribute("content",d),s.isCustom){i.classList.add(`theme-${s.id}`);const m=s.palette;i.style.setProperty("--color-background",m.background),i.style.setProperty("--color-surface",m.surface),i.style.setProperty("--color-primary",m.primary),i.style.setProperty("--color-text",m.text),i.style.setProperty("--color-primary-hover",m.primary),i.style.setProperty("--color-text-muted",m.text),i.style.setProperty("--color-border",m.surface),m.onPrimary?i.style.setProperty("--color-on-primary",m.onPrimary):i.style.setProperty("--color-on-primary","255 255 255")}else i.style.removeProperty("--color-background"),i.style.removeProperty("--color-surface"),i.style.removeProperty("--color-primary"),i.style.removeProperty("--color-text"),i.style.removeProperty("--color-primary-hover"),i.style.removeProperty("--color-text-muted"),i.style.removeProperty("--color-border"),i.style.removeProperty("--color-on-primary"),s.id!=="system"&&i.classList.add(`theme-${s.id}`)},q2=({children:n})=>{const[a,s]=G.useState(()=>{try{const h=localStorage.getItem(ab);return h?JSON.parse(h):[]}catch{return[]}}),[i,l]=G.useState(()=>{try{const h=localStorage.getItem(gh);return no.some(v=>v.id===h)||a.some(v=>v.id===h)?h:"system"}catch(h){return console.error("Could not access localStorage. Defaulting to 'system'.",h),"system"}});G.useEffect(()=>{localStorage.setItem(ab,JSON.stringify(a))},[a]),G.useEffect(()=>{try{localStorage.setItem(gh,i)}catch(h){console.error("Could not set theme in localStorage.",h)}sb(i,a)},[i,a]),G.useEffect(()=>{const h=window.matchMedia("(prefers-color-scheme: dark)"),v=()=>{let S="system";try{S=localStorage.getItem(gh)||"system"}catch{}S==="system"&&sb("system",a)};return h.addEventListener("change",v),()=>h.removeEventListener("change",v)},[a]);const c=G.useCallback(h=>{l(h)},[]),d=G.useCallback(h=>{s(v=>[...v,h]),l(h.id)},[]),m=G.useCallback(h=>{s(v=>v.filter(S=>S.id!==h)),i===h&&l("system")},[i]),p=no.find(h=>h.id===i)||a.find(h=>h.id===i)||no[0];return u.jsx(w0.Provider,{value:{themeId:i,setThemeById:c,currentTheme:p,customThemes:a,addCustomTheme:d,deleteCustomTheme:m},children:n})},Ok=()=>{const n=G.useContext(w0);if(n===void 0)throw new Error("useTheme must be used within a ThemeProvider");return n},Xt={...HE},Pr=(n,a,s)=>{const i=new Date;i.setHours(0,0,0,0);const l=a.map(d=>({id:crypto.randomUUID(),text:d.text,explanation:d.explanation})),c=l[a.findIndex(d=>d.correct)];if(!c)throw new Error(`No correct option specified for question: "${n}"`);return{id:crypto.randomUUID(),questionType:"multipleChoice",questionText:n,tags:["nature","sample"],detailedExplanation:s,options:l,correctAnswerId:c.id,dueDate:i.toISOString(),interval:0,easeFactor:wr,suspended:!1,masteryLevel:0,lastReviewed:void 0,lapses:0}},P2=()=>{const n={id:crypto.randomUUID(),name:"Level 1.1: Simple Addition",description:"Practice basic addition problems.",type:Ne.Quiz,questions:[Pr("What is 1 + 1?",[{text:"2",correct:!0},{text:"1"},{text:"3"}],"1 plus 1 equals 2."),Pr("What is 2 + 3?",[{text:"5",correct:!0},{text:"4"},{text:"6"}],"2 plus 3 equals 5."),Pr("What is 5 + 4?",[{text:"9",correct:!0},{text:"8"},{text:"10"}],"5 plus 4 equals 9.")]},a={id:crypto.randomUUID(),name:"Level 1.2: Simple Subtraction",description:"Practice basic subtraction problems.",type:Ne.Quiz,questions:[Pr("What is 5 - 2?",[{text:"3",correct:!0},{text:"2"},{text:"4"}],"5 minus 2 equals 3."),Pr("What is 10 - 4?",[{text:"6",correct:!0},{text:"5"},{text:"7"}],"10 minus 4 equals 6.")]},s={id:crypto.randomUUID(),name:"Level 2.1: Simple Multiplication",description:"Practice basic multiplication problems.",type:Ne.Quiz,questions:[Pr("What is 2 * 3?",[{text:"6",correct:!0},{text:"5"},{text:"8"}],"2 times 3 is 6."),Pr("What is 4 * 5?",[{text:"20",correct:!0},{text:"15"},{text:"25"}],"4 times 5 is 20.")]},i=[n,a,s];return{series:{id:crypto.randomUUID(),type:"series",name:"Sample: Basic Math Series",description:"A sample series to demonstrate the progressive learning path feature. Complete each deck to unlock the next!",levels:[{title:"Level 1: Fundamentals",deckIds:[n.id,a.id]},{title:"Level 2: Next Steps",deckIds:[s.id]}],createdAt:new Date().toISOString()},decks:i}},ib=()=>{const n=[Pr("Which process allows plants to convert light energy into chemical energy?",[{text:"Respiration"},{text:"Photosynthesis",correct:!0},{text:"Transpiration"},{text:"Germination"}],"Photosynthesis is the vital process used by plants, algae, and certain bacteria to harness energy from sunlight and turn it into chemical energy in the form of glucose."),Pr("What is the largest rainforest in the world?",[{text:"The Congo Rainforest"},{text:"The Valdivian Temperate Rainforest"},{text:"The Daintree Rainforest"},{text:"The Amazon Rainforest",correct:!0}],"The Amazon Rainforest is the world's largest tropical rainforest, famed for its biodiversity. It spans across nine countries in South America."),Pr("What type of rock is formed from the cooling and solidification of magma or lava?",[{text:"Igneous Rock",correct:!0},{text:"Sedimentary Rock"},{text:"Metamorphic Rock"},{text:"Sandstone"}],"Igneous rock is formed through the cooling and solidification of magma (molten rock below the surface) or lava (molten rock on the surface). Examples include granite and basalt."),Pr("Which layer of the Earth's atmosphere is closest to the surface?",[{text:"Stratosphere"},{text:"Mesosphere"},{text:"Troposphere",correct:!0},{text:"Thermosphere"}],"The Troposphere is the lowest layer of Earth's atmosphere, and is also where nearly all weather conditions take place. It contains about 75% of the atmosphere's mass."),Pr("What is the name for the process of water movement through a plant and its evaporation from aerial parts, such as leaves, stems and flowers?",[{text:"Condensation"},{text:"Precipitation"},{text:"Transpiration",correct:!0},{text:"Photosynthesis"}],"Transpiration is essentially evaporation of water from plant leaves. It is a key part of the water cycle, and an important process in plant life.")];return{id:crypto.randomUUID(),name:"Sample: Wonders of Nature",description:"A sample quiz deck to introduce you to CogniFlow. Test your knowledge about the natural world!",type:Ne.Quiz,questions:n,lastOpened:new Date().toISOString()}},Y2=()=>({id:crypto.randomUUID(),name:"Sample: Spanish Basics",description:"Common Spanish words and phrases.",type:Ne.Flashcard,cards:[{id:crypto.randomUUID(),front:"Hola",back:"Hello",dueDate:new Date().toISOString(),interval:0,easeFactor:wr,masteryLevel:0,lapses:0},{id:crypto.randomUUID(),front:"Gracias",back:"Thank you",dueDate:new Date().toISOString(),interval:0,easeFactor:wr,masteryLevel:0,lapses:0},{id:crypto.randomUUID(),front:"Por favor",back:"Please",dueDate:new Date().toISOString(),interval:0,easeFactor:wr,masteryLevel:0,lapses:0},{id:crypto.randomUUID(),front:"Buenos das",back:"Good morning",dueDate:new Date().toISOString(),interval:0,easeFactor:wr,masteryLevel:0,lapses:0},{id:crypto.randomUUID(),front:"Amigo",back:"Friend",dueDate:new Date().toISOString(),interval:0,easeFactor:wr,masteryLevel:0,lapses:0}],lastOpened:new Date().toISOString()}),$2=()=>{const n=crypto.randomUUID(),a=crypto.randomUUID(),s=crypto.randomUUID(),i=crypto.randomUUID(),l=[{id:n,content:`<h3>Digital Photography: The Exposure Triangle</h3><p>Exposure is determined by three key elements, often called the "Exposure Triangle":</p><ul><li><b>Aperture:</b> The size of the lens opening (f-stop). Controls depth of field.</li><li><b>Shutter Speed:</b> How long the sensor is exposed to light. Controls motion blur.</li><li><b>ISO:</b> The sensor's sensitivity to light. Controls digital noise.</li></ul><p>Balancing these three is the key to a properly exposed image.</p>`,unlocksQuestionIds:[s]},{id:a,content:"<h3>Digital Photography: Composition</h3><p>Good composition guides the viewer's eye. One of the most fundamental rules is the <b>Rule of Thirds</b>.</p><p>Imagine breaking an image down into thirds (both horizontally and vertically) so that you have 9 parts. The rule suggests that you should place key elements of your scene along these lines or at their intersections.</p>",unlocksQuestionIds:[i]}],c=[{id:s,questionType:"multipleChoice",questionText:"Which element of the exposure triangle primarily controls depth of field (how much of the scene is in focus)?",options:[{id:crypto.randomUUID(),text:"ISO",explanation:"ISO controls sensitivity and noise."},{id:crypto.randomUUID(),text:"Shutter Speed",explanation:"Shutter speed controls motion blur."},{id:crypto.randomUUID(),text:"Aperture",explanation:"Correct! A wide aperture (low f-number) creates a shallow depth of field."}],correctAnswerId:"",detailedExplanation:"Aperture refers to the opening of the lens's diaphragm through which light travels. Large openings (small f-numbers) create a shallow depth of field (blurry background), while small openings (large f-numbers) keep more in focus.",dueDate:new Date().toISOString(),interval:0,easeFactor:wr,suspended:!1,masteryLevel:0,lapses:0,infoCardIds:[n]},{id:i,questionType:"multipleChoice",questionText:"According to the Rule of Thirds, where is the best place to put your main subject?",options:[{id:crypto.randomUUID(),text:"Dead center",explanation:"Centering is valid but can be static. The Rule of Thirds suggests off-center placement."},{id:crypto.randomUUID(),text:"At the intersections of the grid lines",explanation:'Correct! These "power points" create a more balanced and interesting image.'},{id:crypto.randomUUID(),text:"In the extreme corner",explanation:"This can make the subject feel like it is falling out of the frame."}],correctAnswerId:"",detailedExplanation:"The Rule of Thirds grid creates four intersection points. Placing your subject on one of these points generally creates a more energetic and interesting composition than simply centering the subject.",dueDate:new Date().toISOString(),interval:0,easeFactor:wr,suspended:!1,masteryLevel:0,lapses:0,infoCardIds:[a]}];return c[0].correctAnswerId=c[0].options[2].id,c[1].correctAnswerId=c[1].options[1].id,{id:crypto.randomUUID(),name:"Sample: Photography Basics",description:"A mini-course covering exposure and composition fundamentals.",type:Ne.Learning,infoCards:l,questions:c,learningMode:"separate",lastOpened:new Date().toISOString()}};function Qh(n,a,s){const i=new Blob([n],{type:s}),l=URL.createObjectURL(i),c=document.createElement("a");c.style.display="none",c.href=l,c.download=a,document.body.appendChild(c),c.click(),window.URL.revokeObjectURL(l),document.body.removeChild(c)}function Kh(n){return n.replace(/[^a-z0-9 -]/gi,"_").replace(/\s+/g,"-").toLowerCase().substring(0,30)}const V2=n=>{let a;const s=`cogniflow-deck-${Kh(n.name)}.json`;if(n.type===Ne.Flashcard)a=(n.cards||[]).map(d=>({front:d.front,back:d.back}));else if(n.type===Ne.Quiz||n.type===Ne.Learning){const l=n,c={name:l.name,description:l.description,type:l.type,questions:(l.questions||[]).map(d=>({questionType:d.questionType,questionText:d.questionText,options:(d.options||[]).map(m=>({id:m.id,text:m.text,explanation:m.explanation})),correctAnswerId:d.correctAnswerId,detailedExplanation:d.detailedExplanation,tags:d.tags}))};if(n.type===Ne.Learning){const d=n;c.infoCards=d.infoCards,c.learningMode=d.learningMode}a=c}else throw new Error(`Unsupported deck type for export: ${n.type}`);const i=JSON.stringify(a,null,2);Qh(i,s,"application/json")},Z2=n=>{if(n.type!==Ne.Flashcard)throw new Error("CSV export is currently only supported for Flashcard decks.");const s=(n.cards||[]).map(c=>({Front:c.front,Back:c.back})),i=jb.unparse(s),l=`cogniflow-deck-${Kh(n.name)}.csv`;Qh(i,l,"text/csv")},Q2=(n,a)=>{const s=new Map,i=new Set((n.levels||[]).flatMap(p=>(p==null?void 0:p.deckIds)||[]));a.forEach(p=>{i.has(p.id)&&s.set(p.id,p)});const l=(n.levels||[]).map(p=>{const h=(p.deckIds||[]).map(v=>s.get(v)).filter(v=>!!v).map(v=>{if(v.type===Ne.Flashcard){const S=v;return{type:Ne.Flashcard,name:S.name,description:S.description,cards:(S.cards||[]).map(A=>({front:A.front,back:A.back}))}}else if(v.type===Ne.Quiz||v.type===Ne.Learning){const S=v,A={type:S.type,name:S.name,description:S.description,questions:(S.questions||[]).map(_=>({questionType:_.questionType,questionText:_.questionText,options:(_.options||[]).map(E=>({id:E.id,text:E.text,explanation:E.explanation})),correctAnswerId:_.correctAnswerId,detailedExplanation:_.detailedExplanation,tags:_.tags}))};if(v.type===Ne.Learning){const _=v;A.infoCards=_.infoCards,A.learningMode=_.learningMode}return A}return null}).filter(Boolean);return{title:p.title,decks:h}}),c={seriesName:n.name,seriesDescription:n.description,levels:l},d=`cogniflow-series-${Kh(n.name)}.json`,m=JSON.stringify(c,null,2);Qh(m,d,"application/json")},K2=({triggerSync:n,openConfirmModal:a})=>{const{dispatch:s}=Ke(),{addToast:i}=Nn(),l=G.useCallback(async U=>{const j=Object.values(Ke.getState().decks),O=new Set(j.map(te=>te.name)),B=U.map(te=>{let L=te.name,J=1;for(;O.has(L);)L=`${te.name} (Copy ${J})`,J++;return O.add(L),{...te,name:L}});s({type:"ADD_DECKS",payload:B});try{await Xt.addDecks(B),n({isManual:!1})}catch(te){i("Error saving new deck(s).","error"),console.error(te)}},[s,i,n]),c=G.useCallback(async(U,j)=>{const O={...U,lastModified:Date.now()};s({type:"UPDATE_DECK",payload:O});try{await Xt.updateDeck(O),j!=null&&j.silent||(j!=null&&j.toastMessage&&i(j.toastMessage,"success"),n({isManual:!1}))}catch(B){i(`Error updating deck "${U.name}".`,"error"),console.error(B)}},[s,i,n]),d=G.useCallback(async(U,j)=>{const O=U.map(B=>({...B,lastModified:Date.now()}));s({type:"BULK_UPDATE_DECKS",payload:O});try{await Xt.bulkUpdateDecks(O),j!=null&&j.silent||n({isManual:!1})}catch{i("Error updating decks.","error")}},[s,n,i]),m=G.useCallback(async(U,j)=>{const O=Ke.getState().decks[U];O&&(await c({...O,folderId:j}),i("Deck moved.","success"))},[c,i]),p=G.useCallback(async U=>{const j=Ke.getState().decks[U];if(j){const O={...j,deletedAt:new Date().toISOString(),archived:!1};await c(O,{toastMessage:`Deck "${j.name}" moved to trash.`})}},[c]),h=G.useCallback(async U=>{const j=Ke.getState().decks[U];j&&await c({...j,deletedAt:null},{toastMessage:`Deck "${j.name}" restored.`})},[c]),v=G.useCallback(async U=>{s({type:"DELETE_DECK",payload:U});try{await Xt.deleteDeck(U),i("Deck permanently deleted.","success"),n({isManual:!1})}catch{i("Error deleting deck permanently.","error")}},[s,i,n]),S=G.useCallback(async U=>{if(U.id){const j={id:U.id,name:U.name};s({type:"UPDATE_FOLDER",payload:j});try{await Xt.updateFolder(j),i(`Folder renamed to "${j.name}".`,"success"),n({isManual:!1})}catch{i("Error renaming folder.","error")}}else{const j={id:crypto.randomUUID(),name:U.name};s({type:"ADD_FOLDER",payload:j});try{await Xt.addFolder(j),i(`Folder "${j.name}" created.`,"success"),n({isManual:!1})}catch{i("Error creating folder.","error")}}},[s,i,n]),A=G.useCallback(async U=>{const j=Ke.getState().folders[U];j&&a({title:"Delete Folder",message:`Are you sure you want to delete the folder "${j.name}"? Decks inside will be moved to the main list.`,onConfirm:async()=>{s({type:"DELETE_FOLDER",payload:U});try{await Xt.deleteFolder(U);const O=Object.values(Ke.getState().decks).filter(B=>B.folderId===U);O.length>0&&await Xt.bulkUpdateDecks(O.map(B=>({...B,folderId:null}))),i(`Folder "${j.name}" deleted.`,"success"),n({isManual:!1})}catch{i("Error deleting folder.","error")}}})},[s,i,n,a]),_=G.useCallback(U=>{const j=Ke.getState().decks[U];if(j&&j.id!=="general-study-deck"){const O=new Date,B=j.lastOpened?new Date(j.lastOpened):new Date(0);O.getTime()-B.getTime()>5e3&&c({...j,lastOpened:O.toISOString()},{silent:!0})}},[c]),E=G.useCallback(()=>{const U=ib();l([U]),i(`Sample quiz "${U.name}" created.`,"success")},[l,i]),w=G.useCallback(()=>{const U=ib();l([U]),i(`Sample quiz "${U.name}" created.`,"success")},[l,i]),k=G.useCallback(()=>{const U=Y2();l([U]),i(`Sample flashcard deck "${U.name}" created.`,"success")},[l,i]),N=G.useCallback(()=>{const U=$2();l([U]),i(`Sample learning deck "${U.name}" created.`,"success")},[l,i]),I=G.useCallback(async(U,j)=>{const O=Ke.getState().decks[U];if(!O)return;const B=O.infoCards||[],L=B.some(Z=>Z.id===j.infoCard.id)?B.map(Z=>Z.id===j.infoCard.id?j.infoCard:Z):[...B,j.infoCard],J=O.questions||[],D=new Map(J.map(Z=>[Z.id,Z]));j.questions.forEach(Z=>D.set(Z.id,Z));const ie={...O,infoCards:L,questions:Array.from(D.values())};await c(ie,{toastMessage:"Learning block saved."})},[c]),M=G.useCallback(async(U,j)=>{var ie;const O=Ke.getState().decks[U];if(!O)return;const B=O.infoCards||[],te=B.filter(Z=>Z.id!==j),L=new Set(((ie=B.find(Z=>Z.id===j))==null?void 0:ie.unlocksQuestionIds)||[]),J=(O.questions||[]).filter(Z=>!L.has(Z.id)),D={...O,infoCards:te,questions:J};await c(D,{toastMessage:"Learning block deleted."})},[c]),F=G.useCallback(U=>{try{V2(U),i(`Deck "${U.name}" exported as JSON.`,"success")}catch(j){i(`Failed to export deck: ${j.message}`,"error")}},[i]),q=G.useCallback(U=>{try{Z2(U),i(`Deck "${U.name}" exported as CSV.`,"success")}catch(j){i(`Failed to export deck: ${j.message}`,"error")}},[i]),Q=G.useCallback(async U=>{a({title:"Shift Schedule",message:`Are you sure you want to shift all due dates forward by ${U} day(s)? This affects all active cards in all decks.`,confirmText:"Shift Schedule",onConfirm:async()=>{const j=Object.values(Ke.getState().decks),O=[];let B=0;j.forEach(te=>{let L=!1,J={...te};if(te.type===Ne.Flashcard){const D=te,ie=D.cards.map(Z=>{if(!Z.suspended&&Z.dueDate){const Y=new Date(Z.dueDate);return Y.setDate(Y.getDate()+U),B++,L=!0,{...Z,dueDate:Y.toISOString()}}return Z});L&&(J={...D,cards:ie})}else{const D=te,ie=D.questions.map(Z=>{if(!Z.suspended&&Z.dueDate){const Y=new Date(Z.dueDate);return Y.setDate(Y.getDate()+U),B++,L=!0,{...Z,dueDate:Y.toISOString()}}return Z});L&&(J={...D,questions:ie})}L&&O.push(J)}),O.length>0?(await d(O),i(`Schedule shifted! ${B} items moved forward by ${U} days.`,"success")):i("No active items found to shift.","info")}})},[a,d,i]);return G.useMemo(()=>({handleAddDecks:l,handleUpdateDeck:c,handleBulkUpdateDecks:d,handleMoveDeck:m,handleDeleteDeck:p,handleRestoreDeck:h,handleDeleteDeckPermanently:v,handleSaveFolder:S,handleDeleteFolder:A,updateLastOpened:_,handleCreateSampleDeck:E,handleCreateSampleQuizDeck:w,handleCreateSampleFlashcardDeck:k,handleCreateSampleLearningDeck:N,handleSaveLearningBlock:I,handleDeleteLearningBlock:M,handleExportDeck:F,handleExportDeckCSV:q,handleShiftSchedule:Q}),[l,c,d,m,p,h,v,S,A,_,E,w,k,N,I,M,F,q,Q])},J2=({triggerSync:n,handleAddDecks:a,handleUpdateDeck:s})=>{const{dispatch:i}=Ke(),{addToast:l}=Nn(),{navigate:c}=Pa(),d=G.useCallback(async(k,N)=>{i({type:"ADD_SERIES_WITH_DECKS",payload:{series:k,decks:N}});try{await Xt.addDeckSeries([k]),await Xt.addDecks(N),l(`Series "${k.name}" created with ${N.length} deck(s).`,"success"),c(`/series/${k.id}`),n({isManual:!1})}catch{l("Error creating new series.","error")}},[i,l,c,n]),m=G.useCallback(async(k,N)=>{const I={...k,lastModified:Date.now()};i({type:"UPDATE_SERIES",payload:I});try{await Xt.updateDeckSeries(I),N!=null&&N.silent||(N!=null&&N.toastMessage&&l(N.toastMessage,"success"),n({isManual:!1}))}catch{l(`Error updating series "${k.name}".`,"error")}},[i,l,n]),p=G.useCallback(async k=>{const N=Ke.getState().deckSeries[k];if(N){const I={...N,deletedAt:new Date().toISOString(),archived:!1};m(I,{toastMessage:`Series "${N.name}" moved to trash.`});const M=new Set((N.levels||[]).flatMap(q=>(q==null?void 0:q.deckIds)||[])),F=Object.values(Ke.getState().decks).filter(q=>M.has(q.id));for(const q of F)s({...q,deletedAt:new Date().toISOString(),archived:!1},{silent:!0})}},[m,s]),h=G.useCallback(async k=>{const N=Ke.getState().deckSeries[k];if(N){m({...N,deletedAt:null},{toastMessage:`Series "${N.name}" restored.`});const I=new Set((N.levels||[]).flatMap(F=>(F==null?void 0:F.deckIds)||[])),M=Object.values(Ke.getState().decks).filter(F=>I.has(F.id));for(const F of M)F.deletedAt&&s({...F,deletedAt:null},{silent:!0})}},[m,s]),v=G.useCallback(async k=>{const N=Ke.getState().deckSeries[k];if(!N)return;const I=new Set((N.levels||[]).flatMap(F=>(F==null?void 0:F.deckIds)||[])),M=Object.values(Ke.getState().decks).filter(F=>I.has(F.id));i({type:"DELETE_SERIES",payload:k});for(const F of M)i({type:"DELETE_DECK",payload:F.id});try{await Xt.deleteDeckSeries(k);for(const F of M)await Xt.deleteDeck(F.id);l("Series and its decks permanently deleted.","success"),n({isManual:!1})}catch{l("Error deleting series permanently.","error")}},[i,l,n]),S=G.useCallback(async k=>{if(k.id){const N=Ke.getState().deckSeries[k.id];N&&m({...N,name:k.name,description:k.description})}else if(k.scaffold){const{seriesName:N,seriesDescription:I,levels:M}=k.scaffold,F=[],q=(M||[]).map(U=>{const j=(U.decks||[]).map(O=>{const B={id:crypto.randomUUID(),name:O.name,description:O.description};return O.type===Ne.Quiz?{...B,type:Ne.Quiz,questions:O.questions||[]}:O.type===Ne.Learning?{...B,type:Ne.Learning,questions:O.questions||[],infoCards:O.infoCards||[],learningMode:O.learningMode||"separate"}:O.type===Ne.Flashcard?{...B,type:Ne.Flashcard,cards:O.cards||[]}:null}).filter(O=>O!==null);return F.push(...j),{title:U.title,deckIds:j.map(O=>O.id)}}),Q={id:crypto.randomUUID(),type:"series",name:N,description:I,levels:q,archived:!1,createdAt:new Date().toISOString()};await d(Q,F)}else{const N={id:crypto.randomUUID(),type:"series",name:k.name,description:k.description,levels:[],createdAt:new Date().toISOString(),archived:!1};i({type:"ADD_SERIES",payload:N});try{await Xt.addDeckSeries([N]),l(`Series "${N.name}" created.`,"success"),c(`/series/${N.id}`)}catch{l("Error saving new series.","error")}}},[i,l,c,m,d]),A=G.useCallback(()=>{const{series:k,decks:N}=P2();d(k,N)},[d]),_=G.useCallback(k=>{const N=Ke.getState().deckSeries[k];if(N){const I=new Date,M=new Date(N.lastOpened||0);I.getTime()-M.getTime()>5e3&&m({...N,lastOpened:I.toISOString()},{silent:!0})}},[m]),E=G.useCallback(async(k,N)=>{const I=Ke.getState().deckSeries[k];if(!I){l("Could not find the series to add the deck to.","error");return}await a([N]);const M=I.levels[I.levels.length-1];if(M){const F={...I,levels:[...I.levels.slice(0,-1),{...M,deckIds:[...M.deckIds,N.id]}]};m(F)}},[a,m,l]),w=G.useCallback(k=>{try{const N=Object.values(Ke.getState().decks);Q2(k,N),l(`Series "${k.name}" exported.`,"success")}catch(N){l(`Failed to export series: ${N.message}`,"error")}},[l]);return G.useMemo(()=>({handleAddSeriesWithDecks:d,handleUpdateSeries:m,handleDeleteSeries:p,handleRestoreSeries:h,handleDeleteSeriesPermanently:v,handleSaveSeries:S,handleCreateSampleSeries:A,updateLastOpenedSeries:_,handleAddDeckToSeries:E,handleExportSeries:w}),[d,m,p,h,v,S,A,_,E,w])};function X2(n,a){const s=new Date(n);return s.setDate(s.getDate()+a),s}const jk=(n,a)=>{const s=new Date;s.setHours(0,0,0,0);let i=n.lapses||0;a===Sr.Again?i++:i>0&&(i=0);let l=iS[a];a===Sr.Again&&i>2&&(l-=(i-2)*.05);let c=n.easeFactor+l;c<Sh&&(c=Sh);let d;if(a===Sr.Again)d=rS;else if(n.interval===0)switch(a){case Sr.Hard:d=1;break;case Sr.Good:d=3;break;case Sr.Easy:d=5;break;default:d=1}else{let h=1;a===Sr.Hard&&(h=aS),a===Sr.Easy&&(h=sS),d=Math.ceil(n.interval*c*h)}const m=X2(s,d),p=Math.min(1,Math.log1p(d)/Math.log1p(90));return{...n,interval:d,easeFactor:c,dueDate:m.toISOString(),lastReviewed:s.toISOString(),masteryLevel:p,lapses:i}},ob=n=>{const a=new Date;return a.setHours(0,0,0,0),{...n,dueDate:a.toISOString(),interval:0,easeFactor:wr,suspended:!1,masteryLevel:0,lastReviewed:void 0,lapses:0}},W2=n=>{const a=n.masteryLevel||0;if(a===0||!n.lastReviewed||n.suspended)return 0;const s=(n.interval||1)*2,i=new Date(n.lastReviewed),c=Math.max(0,(new Date().getTime()-i.getTime())/(1e3*60*60*24));if(c<=0)return a;const d=Math.pow(.5,c/s);return a*d},ll=n=>{const a=new Date;a.setHours(23,59,59,999);const s=(n.type===Ne.Quiz||n.type===Ne.Learning?n.questions:n.cards)||[];return Array.isArray(s)?s.filter(i=>!i.suspended&&new Date(i.dueDate)<=a).length:0},ek=({sessionsToResume:n,setSessionsToResume:a,setGeneralStudyDeck:s,handleUpdateDeck:i})=>{const{navigate:l,path:c}=Pa(),{dispatch:d}=Ke(),{addToast:m}=Nn(),p=G.useCallback(async(w,k)=>{const N=`session_deck_${w}`;if(n.has(w)){const I=new Set(n);I.delete(w),a(I)}try{await Xt.deleteSessionState(N)}catch(I){console.error(`Failed to clean up session state for ${N} from DB`,I)}w==="general-study-deck"&&s(null),l(k?`/series/${k}`:"/")},[l,n,a,s]),h=G.useCallback(async(w,k,N)=>{const I=`session_deck_${w}`;if(n.has(w)){const M=new Set(n);M.delete(w),a(M)}try{await Xt.deleteSessionState(I)}catch(M){console.error(`Failed to clean up session state for ${I} from DB`,M)}w==="general-study-deck"&&s(null),l(`/decks/${N}/study?seriesId=${k}`)},[l,n,a,s]),v=G.useCallback(async(w,k,N,I)=>{const{decks:M,deckSeries:F,seriesProgress:q}=Ke.getState(),Q=M[w];if(!Q)return;let U;const{id:j,dueDate:O,interval:B,easeFactor:te,suspended:L,masteryLevel:J,lastReviewed:D,lapses:ie}=k,Z={dueDate:O,interval:B,easeFactor:te,suspended:L,masteryLevel:J,lastReviewed:D,lapses:ie};Q.type===Ne.Flashcard?U={...Q,cards:(Q.cards||[]).map(Y=>Y.id===j?{...Y,...Z}:Y)}:Q.type===Ne.Learning?U={...Q,questions:(Q.questions||[]).map(Y=>Y.id===j?{...Y,...Z}:Y)}:U={...Q,questions:(Q.questions||[]).map(Y=>Y.id===j?{...Y,...Z}:Y)},await i(U,{silent:!0});try{const Y={itemId:k.id,deckId:w,seriesId:I,timestamp:new Date().toISOString(),rating:N,newInterval:k.interval,easeFactor:k.easeFactor,masteryLevel:k.masteryLevel||0};await Xt.addReviewLog(Y)}catch(Y){console.error("Failed to log review:",Y)}if(I){const Y=U,me="cards"in Y?Y.cards:Y.questions,W=Array.isArray(me)&&me.some(z=>!z.suspended&&z.interval===0),be=(q.get(I)||new Set).has(w);if(!W&&!be&&(me==null?void 0:me.length)>0){const z=new Map(q),R=z.get(I),re=new Set(R instanceof Set?R:[]);re.add(w),z.set(I,re);try{await Xt.saveSeriesProgress(I,re);const oe=F[I],he=((oe==null?void 0:oe.levels)||[]).flatMap(Me=>(Me==null?void 0:Me.deckIds)||[]);he.indexOf(w)===he.length-1&&he.length>0?m(`Congratulations! You've completed the series: "${oe==null?void 0:oe.name}"!`,"success"):m(`Deck "${Y.name}" completed! Next chapter unlocked.`,"success"),d({type:"SET_SERIES_PROGRESS",payload:z})}catch(oe){console.error("Could not save series progress",oe)}}}},[i,m,d]),S=G.useCallback(async w=>{const k=Ke.getState().decks[w];if(!k)return;let N;k.type===Ne.Flashcard?N={...k,cards:(k.cards||[]).map(I=>ob(I))}:N={...k,questions:(k.questions||[]).map(I=>ob(I))},await i(N,{toastMessage:`Progress for deck "${N.name}" has been reset.`})},[i]),A=G.useCallback(()=>{const{decks:w,deckSeries:k,seriesProgress:N}=Ke.getState(),I=new Set;Object.values(k).forEach(U=>(U.levels||[]).filter(Boolean).forEach(j=>(j.deckIds||[]).forEach(O=>I.add(O))));const M=new Set;Object.values(k).forEach(U=>{var j;if(!U.archived&&!U.deletedAt){const O=((j=N.get(U.id))==null?void 0:j.size)||0;let B=0;(U.levels||[]).filter(Boolean).forEach(te=>{(te.deckIds||[]).forEach(L=>{B<=O&&M.add(L),B++})})}});const F=new Date;F.setHours(23,59,59,999);const q=Object.values(w).filter(U=>!(U.type!==Ne.Quiz||U.archived||U.deletedAt||I.has(U.id)&&!M.has(U.id))).flatMap(U=>{const j=Object.values(k).find(O=>(O.levels||[]).some(B=>(B.deckIds||[]).includes(U.id)));return(U.questions||[]).filter(O=>!O.suspended&&new Date(O.dueDate)<=F).map(O=>({...O,originalDeckId:U.id,originalDeckName:U.name,originalSeriesName:j==null?void 0:j.name,originalSeriesId:j==null?void 0:j.id}))}).sort(()=>Math.random()-.5),Q={id:"general-study-deck",name:"General Study Session",description:"A mix of all due questions.",type:Ne.Quiz,questions:q};s(Q),l(`/study/general?from=${encodeURIComponent(c)}`)},[l,s,c]),_=G.useCallback(async w=>{var te;const{decks:k,deckSeries:N,seriesProgress:I}=Ke.getState(),M=N[w];if(!M)return;const F=new Set,q=((te=I.get(M.id))==null?void 0:te.size)||0;let Q=0;(M.levels||[]).filter(Boolean).forEach(L=>{(L.deckIds||[]).forEach(J=>{Q<=q&&F.add(J),Q++})});const U=new Date;U.setHours(23,59,59,999);const O=(M.levels||[]).filter(Boolean).flatMap(L=>L.deckIds||[]).map(L=>k[L]).filter(L=>!!(L&&(L.type===Ne.Quiz||L.type===Ne.Learning))).filter(L=>F.has(L.id)).flatMap(L=>(L.questions||[]).filter(J=>!J.suspended&&new Date(J.dueDate)<=U).map(J=>({...J,originalDeckId:L.id,originalDeckName:L.name}))).sort(()=>Math.random()-.5),B={id:"general-study-deck",name:`${M.name} - Study Session`,description:`A study session for due items in the series: ${M.name}`,type:Ne.Quiz,questions:O};s(B),l(`/study/general?seriesId=${w}&from=${encodeURIComponent(c)}`)},[l,s,c]),E=G.useCallback(async w=>{d({type:"UPDATE_LEARNING_PROGRESS",payload:w});try{await Xt.saveLearningProgress(w)}catch(k){console.error("Failed to save learning progress",k)}},[d]);return G.useMemo(()=>({handleSessionEnd:p,handleStudyNextDeckInSeries:h,handleItemReviewed:v,handleResetDeckProgress:S,handleStartGeneralStudy:A,handleStartSeriesStudy:_,handleUpdateLearningProgress:E}),[p,h,v,S,A,_,E])},lb=(n,a,s)=>{var A;const i={...a,decks:[...a.decks],deckSeries:[...a.deckSeries],seriesProgress:{...a.seriesProgress}},l=new Map(a.decks.map(_=>[_.id,_])),c=new Map(n.decks.map(_=>[_.id,_])),d=[];a.decks.forEach(_=>{s.decks[_.id]==="local"&&c.has(_.id)?d.push(c.get(_.id)):d.push(_)}),n.decks.forEach(_=>{l.has(_.id)||d.push(_)}),i.decks=d;const m=new Map(a.deckSeries.map(_=>[_.id,_])),p=new Map(n.deckSeries.map(_=>[_.id,_])),h=[];a.deckSeries.forEach(_=>{s.series[_.id]==="local"&&p.has(_.id)?(h.push(p.get(_.id)),n.seriesProgress&&n.seriesProgress[_.id]&&(i.seriesProgress[_.id]=n.seriesProgress[_.id])):h.push(_)}),n.deckSeries.forEach(_=>{m.has(_.id)||(h.push(_),n.seriesProgress&&n.seriesProgress[_.id]&&(i.seriesProgress[_.id]=n.seriesProgress[_.id]))}),i.deckSeries=h;const v=new Set((A=a.reviews)==null?void 0:A.map(_=>_.timestamp+_.itemId)),S=(n.reviews||[]).filter(_=>!v.has(_.timestamp+_.itemId));return i.reviews=[...i.reviews||[],...S],i.sessions=n.sessions,i},tk=({addToast:n,openModal:a,closeModal:s,dispatch:i,setLastSyncStatus:l,setIsSyncing:c,backupEnabled:d})=>{const m=U=>!U||U.length===0?0:U.reduce((j,O)=>j+W2(O),0)/U.length,p=G.useCallback(U=>{const j=Ke.getState().decks,O=Ke.getState().deckSeries,B=[],te=[],L=[],J=[],D=new Map,ie=new Map;return U.decks.forEach(Z=>{const Y=j[Z.id];if(!Y)B.push(Z),D.set(Z.id,ll(Z));else if(Y.lastModified!==Z.lastModified){const me=(Y.type===Ne.Flashcard?Y.cards:(Y.type===Ne.Learning,Y.questions))||[],W=(Z.type===Ne.Flashcard?Z.cards:Z.type===Ne.Learning||Z.type===Ne.Quiz?Z.questions:[])||[],be={content:me.length!==W.length,dueCount:ll(Y)!==ll(Z),mastery:!1};L.push({local:Y,backup:Z,diff:be}),D.set(`local-${Y.id}`,ll(Y)),D.set(Z.id,ll(Z));const z=me,R=W,re=m(z),oe=m(R);ie.set(`local-${Y.id}`,re),ie.set(Z.id,oe),be.mastery=Math.abs(re-oe)>.01}}),U.deckSeries.forEach(Z=>{const Y=O[Z.id];if(!Y)te.push(Z);else if(Y.lastModified!==Z.lastModified){const me={structure:JSON.stringify(Y.levels)!==JSON.stringify(Z.levels),completion:!1,mastery:!1};J.push({local:Y,backup:Z,diff:me})}}),{newDecks:B,newSeries:te,changedDecks:L,changedSeries:J,dueCounts:D,masteryLevels:ie}},[]),h=G.useCallback(async(U={})=>{if(!d){U.isManual&&n("Backup is disabled in settings.","info");return}c(!0),l("Syncing...");try{const{timestamp:j}=await lh(void 0,U.force),O=new Date(j);l(`Synced: ${O.toLocaleTimeString()}`),U.isManual&&n("Sync successful.","success")}catch(j){if(console.error("Sync failed",j),j.status===412||j.status===409){l("Sync Conflict");try{const O=await ch(),B=p(O);a("mergeConflict",{comparison:B,remoteData:O})}catch{n("Sync failed and could not read server data for resolution.","error")}}else l("Sync Failed"),U.isManual&&n(`Sync failed: ${j.message}`,"error")}finally{c(!1)}},[d,n,c,l,p,a]),v=G.useCallback(async U=>{try{await fl(U),i({type:"RESTORE_DATA",payload:U}),U.aiChatHistory&&i({type:"SET_AI_CHAT_HISTORY",payload:U.aiChatHistory}),n("Data restored successfully.","success"),d&&h({isManual:!1,force:!0})}catch(j){console.error(j),n("Failed to restore data.","error")}},[i,n,h,d]),S=G.useCallback(()=>{h({isManual:!0})},[h]),A=G.useCallback(async()=>{c(!0);try{const U=await Ns();localStorage.setItem("cogniflow-pre-fetch-backup",JSON.stringify(U));const j=await ch();await fl(j),i({type:"RESTORE_DATA",payload:j}),j.aiChatHistory&&i({type:"SET_AI_CHAT_HISTORY",payload:j.aiChatHistory}),n("Force fetch successful.","success"),l(`Fetched: ${new Date().toLocaleTimeString()}`)}catch(U){n(`Force fetch failed: ${U.message}`,"error")}finally{c(!1)}},[i,c,n,l]),_=G.useCallback(async()=>{const U=localStorage.getItem("cogniflow-pre-fetch-backup");if(!U){n("No backup found to revert to.","error");return}try{const j=JSON.parse(U);await v(j),n("Reverted to state before last fetch.","success")}catch{n("Failed to revert.","error")}},[v,n]),E=G.useCallback(async()=>{c(!0);try{await lh(void 0,!0),n("Force upload successful.","success"),l(`Synced: ${new Date().toLocaleTimeString()}`)}catch(U){n(`Force upload failed: ${U.message}`,"error")}finally{c(!1)}},[c,n,l]),w=G.useCallback(async()=>{c(!0);try{const U=await VE();n(`Backup created: ${U.filename}`,"success")}catch(U){n(`Backup failed: ${U.message}`,"error")}finally{c(!1)}},[c,n]),k=G.useCallback(async U=>{c(!0);try{await ZE(U);const j=await ch();await fl(j),i({type:"RESTORE_DATA",payload:j}),j.aiChatHistory&&i({type:"SET_AI_CHAT_HISTORY",payload:j.aiChatHistory}),n("Restored from server backup.","success"),l(`Restored: ${new Date().toLocaleTimeString()}`)}catch(j){n(`Restore failed: ${j.message}`,"error")}finally{c(!1)}},[c,n,i,l]),N=G.useCallback(async U=>{try{await QE(U)}catch(j){throw n(`Delete failed: ${j.message}`,"error"),j}},[n]),I=G.useCallback(async({selectedIds:U,backupData:j})=>{const O=await Ns(),B={decks:{},series:{}};j.decks.forEach(L=>{U.has(L.id)?B.decks[L.id]="remote":B.decks[L.id]="local"}),j.deckSeries.forEach(L=>{U.has(L.id)?B.series[L.id]="remote":B.series[L.id]="local"});const te=lb({...O},j,B);await v(te)},[v]),M=G.useCallback(async(U,j)=>{s();const O=await Ns(),B=lb({...O},j,U);await fl(B),i({type:"RESTORE_DATA",payload:B}),B.aiChatHistory&&i({type:"SET_AI_CHAT_HISTORY",payload:B.aiChatHistory}),c(!0);try{await lh(B,!0),n("Sync conflict resolved.","success"),l(`Synced: ${new Date().toLocaleTimeString()}`)}catch{n("Failed to push resolved data to server.","error")}finally{c(!1)}},[s,i,n,c,l]),F=G.useCallback(async()=>{try{await d0(),n("Export started.","info")}catch(U){n(`Export failed: ${U.message}`,"error")}},[n]),q=G.useCallback(()=>{"serviceWorker"in navigator&&navigator.serviceWorker.controller?(navigator.serviceWorker.controller.postMessage({type:"CLEAR_APP_CACHE"}),n("App cache cleared. Reloading...","success"),setTimeout(()=>window.location.reload(),1e3)):n("Service worker not active.","error")},[n]),Q=G.useCallback(()=>{"serviceWorker"in navigator&&navigator.serviceWorker.controller?(navigator.serviceWorker.controller.postMessage({type:"CLEAR_CDN_CACHE"}),n("CDN cache cleared.","success")):n("Service worker not active.","error")},[n]);return{triggerSync:h,handleManualSync:S,onRestoreData:v,handleCompareBackup:p,handleRestoreSelectedItems:I,handleForceFetchFromServer:A,handleForceUploadToServer:E,handleCreateServerBackup:w,handleRestoreFromServerBackup:k,handleDeleteServerBackup:N,handleMergeResolution:M,handleExportData:F,handleClearAppCache:q,handleClearCdnCache:Q,handleRevertLastFetch:_}};var nk={};const E0=n=>{try{return typeof process<"u"?nk[n]:void 0}catch{return}};E0("GDRIVE_API_KEY");E0("GDRIVE_CLIENT_ID");let rk=!1,cu=[],yh=[];const ak=(n,a)=>{cu.forEach(s=>s(n,a))},sk=n=>(yh.push(n),n(rk),()=>{yh=yh.filter(a=>a!==n)}),ik=n=>(cu.push(n),()=>{cu=cu.filter(a=>a!==n)}),ok=()=>{{console.error("Google services not ready for sign-in.");return}},lk=()=>{const n=gapi.client.getToken();gapi.client.setToken(null),localStorage.removeItem("gdrive-previously-signed-in"),ak(!1),n!==null&&google.accounts.oauth2.revoke(n.access_token,()=>{console.log("Google token revoked.")})},ck=async()=>{const n=await Ns();if(n.decks.length===0&&n.folders.length===0&&n.deckSeries.length===0)throw new Error("There is no data to back up.");const a={version:7,...n},s=JSON.stringify(a),c={name:`cogniflow-backup-${$h()}.json`,parents:["appDataFolder"]},d="-------314159265358979323846",m=`\r
--${d}\r
`,p=`\r
--${d}--`,h=m+`Content-Type: application/json; charset=UTF-8\r
\r
`+JSON.stringify(c)+m+`Content-Type: application/json; charset=UTF-8\r
\r
`+s+p,v=await gapi.client.request({path:"https://www.googleapis.com/upload/drive/v3/files",method:"POST",params:{uploadType:"multipart",fields:"id, name, modifiedTime"},headers:{"Content-Type":`multipart/related; boundary=${d}`},body:h});if(v.status!==200)throw new Error("Failed to upload backup file.");return v.result},uk=async()=>(await gapi.client.drive.files.list({spaces:"appDataFolder",fields:"files(id, name, modifiedTime)",orderBy:"modifiedTime desc"})).result.files,dk=async n=>{const a=await gapi.client.drive.files.get({fileId:n,alt:"media"});if(a.status!==200)throw new Error("Failed to download backup file.");const s=typeof a.body=="string"?a.body:JSON.stringify(a.result);return await Eu(s)},fk=({openConfirmModal:n,openRestoreFromDriveModal:a,setDriveFiles:s,onRestoreData:i})=>{const{addToast:l}=Nn(),c=G.useCallback(()=>{ok()},[]),d=G.useCallback(()=>{lk(),l("Signed out of Google Drive.","info")},[l]),m=G.useCallback(()=>{n({title:"Backup to Google Drive",message:"This will create a new backup file in a private application folder in your Google Drive. Are you sure?",onConfirm:async()=>{try{const v=await ck();l(`Successfully created backup: ${v.name}`,"success")}catch(v){const S=v instanceof Error?v.message:"Failed to create backup.";l(S,"error")}}})},[l,n]),p=G.useCallback(async()=>{try{const v=await uk();s(v),a()}catch(v){const S=v instanceof Error?v.message:"Failed to list files from Google Drive.";l(S,"error")}},[l,s,a]),h=G.useCallback(async v=>{n({title:"Restore from Google Drive",message:"Restoring will merge and overwrite data. Are you sure?",onConfirm:async()=>{try{const S=await dk(v);await i(S)}catch(S){const A=S instanceof Error?S.message:"Failed to restore from backup.";l(A,"error")}}})},[l,n,i]);return G.useMemo(()=>({handleGoogleSignIn:c,handleGoogleSignOut:d,handleBackupToDrive:m,handleListDriveFiles:p,handleRestoreFromDrive:h,openRestoreFromDriveModal:p}),[c,d,m,p,h])},hk=({handleUpdateDeck:n,handleBulkUpdateDecks:a,handleAddDecks:s,handleAddSeriesWithDecks:i,handleUpdateSeries:l,openConfirmModal:c,openModal:d,closeModal:m})=>{const{dispatch:p}=Ke(),{addToast:h}=Nn(),v=G.useCallback(ue=>{d("aiGenerationChat",{params:ue})},[d]),S=G.useCallback(ue=>{const de=crypto.randomUUID(),{generationType:x}=ue;let se;x.startsWith("series-")?se={id:de,type:"autoPopulateSeries",payload:{topic:ue.topic,comprehensiveness:ue.comprehensiveness},statusText:`Generating series structure for "${ue.topic}"`}:["deck-flashcard","deck-vocab","deck-atomic"].includes(x)?se={id:de,type:"generateFlashcardDeckWithAI",payload:ue,statusText:`Generating flashcards for "${ue.topic}"`}:["single-deck-learning","deck-course"].includes(x)?se={id:de,type:"generateLearningDeckWithAI",payload:ue,statusText:`Generating course content for "${ue.topic}"`}:x==="rework-deck"?se={id:de,type:"rework-deck",payload:ue,statusText:`Reworking "${ue.topic}"`}:se={id:de,type:"generateDeckFromOutline",payload:{immediate:!0,topic:ue.topic,understanding:ue.understanding,count:ue.count},statusText:`Generating quiz for "${ue.topic}"`},p({type:"ADD_AI_TASK_TO_QUEUE",payload:se}),h("Task added to queue.","info")},[p,h]),A=G.useCallback(ue=>{p({type:"CANCEL_AI_TASK",payload:{taskId:ue}}),h("Generation cancelled.","info")},[p,h]),_=G.useCallback(async ue=>{try{switch(ue.action){case uu.CREATE_DECK:await s([{id:crypto.randomUUID(),name:ue.payload.name,type:Ne.Flashcard,cards:[],folderId:ue.payload.folderId||null,description:"Created by AI"}]),h(`Deck "${ue.payload.name}" created.`,"success");break;case uu.UPGRADE_TO_LEARNING:const de=Ke.getState().decks[ue.payload.deckId];de&&I(de);break;default:console.log("Action not implemented yet:",ue.action),h("This action is not fully implemented yet.","info")}}catch(de){h(`Failed to execute action: ${de.message}`,"error")}},[s,h]),E=G.useCallback(ue=>{d("aiGeneration",{context:{deckId:ue.id,deckName:ue.name,deckType:ue.type,mode:"expand"}})},[d]),w=G.useCallback(ue=>{d("aiGeneration",{context:{deckId:ue.id,deckName:ue.name,deckType:ue.type,mode:"rework"}})},[d]),k=G.useCallback((ue,de)=>{const x=Ke.getState().deckSeries[ue];d("aiGeneration",{initialGenerationType:"single-deck-quiz",context:{seriesId:ue,seriesName:x==null?void 0:x.name,seriesDescription:x==null?void 0:x.description,levelIndex:de}})},[d]),N=G.useCallback(ue=>{const de=Ke.getState().deckSeries[ue];d("aiGeneration",{initialGenerationType:"series-auto-fill",context:{seriesId:ue,seriesName:de==null?void 0:de.name,seriesDescription:de==null?void 0:de.description}})},[d]),I=G.useCallback(ue=>{const de={id:crypto.randomUUID(),type:"upgradeDeckToLearning",payload:{deckId:ue.id},statusText:`Transforming "${ue.name}" into a course...`,deckId:ue.id};p({type:"ADD_AI_TASK_TO_QUEUE",payload:de}),h("Curriculum generation added to queue.","info")},[p,h]),M=G.useCallback(ue=>{const de={id:crypto.randomUUID(),type:"hardenAllDistractors",payload:{deckId:ue.id},statusText:`Hardening distractors in "${ue.name}"...`,deckId:ue.id};p({type:"ADD_AI_TASK_TO_QUEUE",payload:de}),h("Batch distractor hardening added to queue.","info")},[p,h]),F=G.useCallback(ue=>{const de={id:crypto.randomUUID(),type:"generateAudioForAllCards",payload:{deckId:ue.id},statusText:`Generating audio for "${ue.name}"...`,deckId:ue.id};p({type:"ADD_AI_TASK_TO_QUEUE",payload:de}),h("Batch audio generation added to queue.","info")},[p,h]),q=G.useCallback(async(ue,de)=>{p({type:"UPDATE_CURRENT_AI_TASK_STATUS",payload:{statusText:"Structuring series..."}});const{outline:x,generationType:se}=ue;let X=Ne.Quiz;se&&(se.includes("flashcard")||se.includes("vocab"))?X=Ne.Flashcard:se&&(se.includes("course")||se.includes("learning"))&&(X=Ne.Learning);const $=await ww(x);if(de.aborted)throw new Error("Cancelled by user");const{seriesName:P,seriesDescription:K,levels:ye}=$,ve=[],ne=(ye||[]).map(Oe=>{const Te=(Oe.decks||[]).map(He=>He.type==="quiz"||!He.type&&X===Ne.Quiz?{id:crypto.randomUUID(),name:He.name,description:He.description,type:Ne.Quiz,questions:qr(He.questions||[])}:He.type==="flashcard"||!He.type&&X===Ne.Flashcard?{id:crypto.randomUUID(),name:He.name,description:He.description,type:Ne.Flashcard,cards:ha(He.cards||[])}:He.type==="learning"||!He.type&&X===Ne.Learning?{id:crypto.randomUUID(),name:He.name,description:He.description,type:Ne.Learning,questions:[],infoCards:[],learningMode:"separate"}:null).filter(He=>He!==null);return ve.push(...Te),{title:Oe.title,deckIds:Te.map(He=>He.id)}}),ke={id:crypto.randomUUID(),type:"series",name:P,description:K,levels:ne,archived:!1,createdAt:new Date().toISOString()};await i(ke,ve),h(`Series "${ke.name}" generated!`,"success")},[p,h,i]),Q=G.useCallback(async(ue,de,x)=>{try{const X=(x==="front"?de.front:de.back).replace(/<[^>]+>/g,"").trim();if(!X)return;h("Generating audio...","info");const $=await sh(X),P=Ke.getState().decks[ue];if(P&&P.type===Ne.Flashcard){const K=P,ye=(K.cards||[]).map(ve=>ve.id===de.id?{...ve,[x==="front"?"frontAudio":"backAudio"]:$}:ve);return await n({...K,cards:ye},{silent:!0}),$}}catch(se){h(`Audio generation failed: ${se.message}`,"error")}},[n,h]),U=G.useCallback(async ue=>{try{h("Analyzing deck for icon...","info");const de=await Nw(ue.name,ue.description);await n({...ue,icon:de}),h("Icon updated!","success")}catch{h("Failed to suggest icon.","error")}},[n,h]),j=G.useCallback(ue=>{d("deckAnalysis",{deck:ue})},[d]),O=G.useCallback(async ue=>{try{h("Generating tags...","info");const de=ue.questions.map(X=>({id:X.id,text:X.questionText})),x=await Dw(de),se=ue.questions.map(X=>{if(x[X.id]){const $=Array.from(new Set([...X.tags||[],...x[X.id]]));return{...X,tags:$}}return X});await n({...ue,questions:se}),h("Questions tagged!","success")}catch(de){h(`Tagging failed: ${de.message}`,"error")}},[n,h]),B=G.useCallback(async(ue,de,x)=>await Cw(ue,de,x),[]),te=G.useCallback(async(ue,de)=>{var P;const x=ue.options.filter(K=>K.id!==ue.correctAnswerId).map(K=>K.text),se=((P=ue.options.find(K=>K.id===ue.correctAnswerId))==null?void 0:P.text)||"",X=await Vv(ue.questionText,se,x,de),$=ue.options.find(K=>K.id===ue.correctAnswerId);if(!$)throw new Error("Correct answer not found in options");return[$,...X.map(K=>({id:crypto.randomUUID(),text:K.text,explanation:K.explanation}))].sort(()=>Math.random()-.5)},[]),L=G.useCallback(async ue=>{const de=Ke.getState().deckSeries[ue];if(!de)return;const x={id:crypto.randomUUID(),type:"autoPopulateSeries",payload:{seriesId:ue},statusText:`Expanding series "${de.name}"...`,seriesId:ue};p({type:"ADD_AI_TASK_TO_QUEUE",payload:x}),h("Series expansion added to queue.","info")},[p,h]),J=G.useCallback(async(ue,de)=>{const x={id:crypto.randomUUID(),type:"autoPopulateLevel",payload:{seriesId:ue,levelIndex:de},statusText:`Adding decks to level ${de+1}...`,seriesId:ue};p({type:"ADD_AI_TASK_TO_QUEUE",payload:x}),h("Level population added to queue.","info")},[p,h]),D=G.useCallback((ue,de=5)=>{const x={id:crypto.randomUUID(),type:"generateQuestionsForDeck",payload:{deck:ue,count:de},statusText:`Generating questions for "${ue.name}"...`,deckId:ue.id};p({type:"ADD_AI_TASK_TO_QUEUE",payload:x}),h("Question generation added to queue.","info")},[p,h]),ie=G.useCallback(ue=>{const de={id:crypto.randomUUID(),type:"generateSeriesLearningContentInBatches",payload:{deck:ue},statusText:`Generating content for "${ue.name}"...`,deckId:ue.id};p({type:"ADD_AI_TASK_TO_QUEUE",payload:de}),h("Content generation added to queue.","info")},[p,h]),Z=G.useCallback(ue=>{const de={id:crypto.randomUUID(),type:"generateSeriesQuestionsInBatches",payload:{seriesId:ue},statusText:"Generating questions for empty decks...",seriesId:ue};p({type:"ADD_AI_TASK_TO_QUEUE",payload:de}),h("Batch generation added to queue.","info")},[p,h]),Y=G.useCallback(async(ue,de)=>{const x={id:crypto.randomUUID(),type:"regenerateQuestion",payload:{deckId:ue.id,questionId:de.id},statusText:"Regenerating question...",deckId:ue.id};p({type:"ADD_AI_TASK_TO_QUEUE",payload:x})},[p]),me=G.useCallback(async(ue,de,x)=>await Ow(ue,de,x),[]),W=G.useCallback(async(ue,de)=>{var P;const x=Ke.getState().decks[ue.deckId];if(!x||x.type!==Ne.Quiz&&x.type!==Ne.Learning)return;const se=x,X=se.questions.length,$=[...se.questions];for(let K=0;K<X;K++){if(de.aborted)throw new Error("Cancelled by user");const ye=$[K];p({type:"UPDATE_CURRENT_AI_TASK_STATUS",payload:{statusText:`Hardening question ${K+1}/${X}...`}});try{const ve=ye.options.filter(Te=>Te.id!==ye.correctAnswerId).map(Te=>Te.text),ne=((P=ye.options.find(Te=>Te.id===ye.correctAnswerId))==null?void 0:P.text)||"",ke=await Vv(ye.questionText,ne,ve,x.name),Oe=ye.options.find(Te=>Te.id===ye.correctAnswerId);$[K]={...ye,options:[Oe,...ke.map(Te=>({id:crypto.randomUUID(),text:Te.text,explanation:Te.explanation}))].sort(()=>Math.random()-.5)}}catch(ve){console.error(`Failed to harden question ${ye.id}`,ve)}}await n({...x,questions:$}),h(`Hardened distractors for all ${X} questions!`,"success")},[p,n,h]),be=G.useCallback(async(ue,de)=>{const x=Ke.getState().decks[ue.deckId];if(!x||x.type!==Ne.Flashcard)return;const se=x,X=se.cards.length,$=[...se.cards];let P=0;for(let K=0;K<X;K++){if(de.aborted)throw new Error("Cancelled by user");const ye=$[K];if(!ye.frontAudio||!ye.backAudio){p({type:"UPDATE_CURRENT_AI_TASK_STATUS",payload:{statusText:`Generating audio for card ${K+1}/${X}...`}});try{const ve=ye.front.replace(/<[^>]+>/g,"").trim(),ne=ye.back.replace(/<[^>]+>/g,"").trim(),[ke,Oe]=await Promise.all([ye.frontAudio?Promise.resolve(ye.frontAudio):sh(ve),ye.backAudio?Promise.resolve(ye.backAudio):sh(ne)]);$[K]={...ye,frontAudio:ke,backAudio:Oe},P++}catch(ve){console.error(`Failed to generate audio for card ${ye.id}`,ve)}}}await n({...x,cards:$}),h(`Audio generated for ${P} card sides!`,"success")},[p,n,h]),z=G.useCallback(async(ue,de)=>{const{seriesId:x,topic:se,comprehensiveness:X}=ue;let $=null;if(x)$=Ke.getState().deckSeries[x];else if(se){p({type:"UPDATE_CURRENT_AI_TASK_STATUS",payload:{statusText:"Designing full curriculum..."}});const P=await Zv(se,`A comprehensive course about ${se} at ${X} depth.`);if(de.aborted)return;const K=[],ye=(P.levels||[]).map(ve=>{const ne=(ve.decks||[]).map(ke=>({id:crypto.randomUUID(),name:ke.name,description:ke.description,type:Ne.Quiz,questions:[]}));return K.push(...ne),{title:ve.title,deckIds:ne.map(ke=>ke.id)}});$={id:crypto.randomUUID(),type:"series",name:P.seriesName||se,description:P.seriesDescription||"",levels:ye,createdAt:new Date().toISOString(),archived:!1},await i($,K)}if($&&$.levels.length>0&&x){p({type:"UPDATE_CURRENT_AI_TASK_STATUS",payload:{statusText:"Expanding series with new levels..."}}),$.levels.map(K=>`${K.title}: ${(K.deckIds||[]).length} decks`).join(`
`);const P=await Zv($.name,$.description);if(de.aborted)return;if(P.levels&&P.levels.length>0){const K=[],ye=(P.levels||[]).map(ne=>{const ke=(ne.decks||[]).map(Oe=>({id:crypto.randomUUID(),name:Oe.name,description:Oe.description,type:Ne.Quiz,questions:[]}));return K.push(...ke),{title:ne.title,deckIds:ke.map(Oe=>Oe.id)}}),ve={...$,levels:[...$.levels,...ye]};await i(ve,K)}}},[p,i]),R=G.useCallback(async(ue,de)=>{const{seriesId:x,levelIndex:se}=ue,X=Ke.getState().deckSeries[x];if(!X||!X.levels[se])return;const $=X.levels[se];$.deckIds.map(ve=>{var ne;return(ne=Ke.getState().decks[ve])==null?void 0:ne.name}).filter(Boolean);const P=await jw(X.name,X.description,$.title);if(de.aborted)return;const K=P.map(ve=>({id:crypto.randomUUID(),name:ve.name,description:ve.description,type:Ne.Quiz,questions:[]}));await s(K);const ye={...X,levels:X.levels.map((ve,ne)=>ne===se?{...ve,deckIds:[...ve.deckIds,...K.map(ke=>ke.id)]}:ve)};await l(ye,{silent:!0})},[s,l]),re=G.useCallback(async(ue,de,x,se)=>{const X=await Tw(ue,de||5);if(se.aborted)return;const $=qr(X),P={...ue,questions:[...ue.questions||[],...$]};await n(P,{silent:!0})},[n]),oe=G.useCallback(async(ue,de)=>{const{deck:x,comprehensiveness:se}=ue,{infoCards:X,questions:$,name:P,description:K}=await ah(x.name,se||"Standard");if(de.aborted)return;const ye=new Date().toISOString(),ve=(X||[]).map(Oe=>({...Oe,unlocksQuestionIds:Oe.unlocksQuestionIds||[]})),ne=($||[]).map(Oe=>({...Oe,id:Oe.id||crypto.randomUUID(),questionType:"multipleChoice",dueDate:ye,interval:0,easeFactor:2.5,lapses:0,masteryLevel:0,suspended:!1,options:(Oe.options||[]).map(Te=>({...Te,id:crypto.randomUUID()}))}));ne.forEach(Oe=>{(Oe.infoCardIds||[]).forEach(Te=>{const He=ve.find(it=>it.id===Te);He&&(He.unlocksQuestionIds=Array.from(new Set([...He.unlocksQuestionIds||[],Oe.id])))})});const ke={...x,name:P||x.name,description:K||x.description,infoCards:[...x.infoCards||[],...ve],questions:[...x.questions||[],...ne]};await n(ke,{silent:!0})},[n]),he=G.useCallback(async(ue,de)=>{const x=Ke.getState().decks[ue.deckId];if(!x)return;p({type:"UPDATE_CURRENT_AI_TASK_STATUS",payload:{statusText:"Analyzing concepts..."}});const se=await Aw(x);if(de.aborted)throw new Error("Cancelled by user");p({type:"UPDATE_CURRENT_AI_TASK_STATUS",payload:{statusText:"Structuring course..."}});let X=[];if(x.type===Ne.Flashcard){const P=x.cards.map(K=>({id:K.id,questionType:"multipleChoice",questionText:K.front,options:[{id:crypto.randomUUID(),text:K.back},{id:crypto.randomUUID(),text:"Incorrect Option A"},{id:crypto.randomUUID(),text:"Incorrect Option B"}].sort(()=>Math.random()-.5),correctAnswerId:"",detailedExplanation:`Concept: ${K.front} is ${K.back}`,dueDate:K.dueDate,interval:K.interval,easeFactor:K.easeFactor,lapses:K.lapses,masteryLevel:K.masteryLevel,suspended:K.suspended,lastReviewed:K.lastReviewed}));P.forEach(K=>{const ye=K.options.find(ve=>{var ne;return ve.text===((ne=x.cards.find(ke=>ke.id===K.id))==null?void 0:ne.back)});K.correctAnswerId=(ye==null?void 0:ye.id)||K.options[0].id}),X=P}else X=x.questions;const $={...x,type:Ne.Learning,infoCards:se.infoCards.map(P=>({...P,id:P.id||crypto.randomUUID(),unlocksQuestionIds:P.unlocksQuestionIds||[]})),questions:X,learningMode:"separate"};await n($,{toastMessage:`"${x.name}" is now a Learning Deck!`})},[p,n]),fe=G.useCallback(async(ue,de)=>{if(!ue.deckId)return;const x=Ke.getState().decks[ue.deckId];if(x){p({type:"UPDATE_CURRENT_AI_TASK_STATUS",payload:{statusText:`Reworking "${x.name}" content...`}});try{const se=await kw(x,ue);if(de.aborted)throw new Error("Cancelled by user");let X;x.type===Ne.Flashcard?X={...x,name:se.name||x.name,description:se.description||x.description,cards:ha(se.cards||[])}:x.type===Ne.Quiz?X={...x,name:se.name||x.name,description:se.description||x.description,questions:qr(se.questions||[])}:X={...x,name:se.name||x.name,description:se.description||x.description,infoCards:(se.infoCards||[]).map($=>({...$,id:$.id||crypto.randomUUID()})),questions:qr(se.questions||[])},await n(X,{toastMessage:`"${x.name}" has been reworked!`})}catch(se){console.error("Rework failed:",se),h(`Failed to rework deck: ${se.message}`,"error")}}},[p,n,h]),Me=G.useCallback(async(ue,de)=>{const{seriesId:x}=ue,se=Ke.getState().deckSeries[x];if(!se)return;const X=(se.levels||[]).flatMap(P=>P.deckIds),$=Ke.getState().decks;for(const P of X){if(de.aborted)return;const K=$[P];K&&K.type===Ne.Quiz&&K.questions.length===0&&(p({type:"UPDATE_CURRENT_AI_TASK_STATUS",payload:{statusText:`Generating questions for "${K.name}"...`}}),await re(K,5,{name:se.name,description:se.description},de))}},[re,p]),Fe=G.useCallback(async(ue,de)=>{const{deckId:x,questionId:se}=ue,X=Ke.getState().decks[x];if(!X)return;const $=X.questions,P=$.find(ne=>ne.id===se);if(!P)return;const K=await Iw(P,X.name);if(de.aborted)return;const ye={...P,...K},ve={...X,questions:$.map(ne=>ne.id===se?ye:ne)};await n(ve,{silent:!0})},[n]),Ce=G.useCallback(async(ue,de)=>{p({type:"UPDATE_CURRENT_AI_TASK_STATUS",payload:{statusText:"Generating deck content..."}});let x;if(ue.immediate?x=await ah(ue.topic,"Standard",!1):x=await Sw(ue.outline,ue.metadata),de.aborted)throw new Error("Cancelled by user");const se=ue.deckId;if(se){const K=Ke.getState().decks[se];if(K){const ye=qr(x.questions||[]),ve={...K,questions:[...K.questions||[],...ye]};await n(ve,{silent:!0}),h(`Added content to "${K.name}"!`,"success");return}}const X={id:crypto.randomUUID(),name:x.name||ue.topic||"New Quiz",description:x.description||"",type:Ne.Quiz,questions:qr(x.questions||[])};await s([X]);const{seriesId:$,levelIndex:P}=ue;if($&&P!==void 0){const K=Ke.getState().deckSeries[$];if(K&&K.levels[P]){const ye={...K,levels:K.levels.map((ve,ne)=>ne===P?{...ve,deckIds:[...ve.deckIds,X.id]}:ve)};await l(ye,{silent:!0})}}h(`Deck "${X.name}" generated!`,"success")},[p,s,l,h,n]),Ve=G.useCallback(async(ue,de)=>{p({type:"UPDATE_CURRENT_AI_TASK_STATUS",payload:{statusText:"Generating flashcards..."}});const{persona:x,deckId:se}=ue,X=localStorage.getItem("cogniflow-ai-options");let $=[];X&&($=JSON.parse(X).personas||[]);const P=$.find(ve=>ve.id===x)||{instruction:"You are a helpful assistant."},K=await Ew(ue,P);if(de.aborted)throw new Error("Cancelled by user");if(se){const ve=Ke.getState().decks[se];if(ve&&ve.type===Ne.Flashcard){const ne=ha(K.cards||[]),ke={...ve,cards:[...ve.cards||[],...ne]};await n(ke,{silent:!0}),h(`Added cards to "${ve.name}"!`,"success");return}}const ye={id:crypto.randomUUID(),name:K.name||ue.topic,description:K.description||"",type:Ne.Flashcard,cards:ha(K.cards||[])};await s([ye]),h(`Deck "${ye.name}" generated!`,"success")},[p,s,h,n]),Qe=G.useCallback(async(ue,de)=>{p({type:"UPDATE_CURRENT_AI_TASK_STATUS",payload:{statusText:"Generating course content..."}});const x=ue.generationType==="deck-course"||ue.generationType==="single-deck-learning",{infoCards:se,questions:X,name:$,description:P}=await ah(ue.topic,ue.comprehensiveness,x);if(de.aborted)throw new Error("Cancelled by user");const K=(se||[]).map(ne=>({...ne,id:ne.id||crypto.randomUUID(),unlocksQuestionIds:ne.unlocksQuestionIds||[]})),ye=qr(X||[]);if(ue.deckId){const ne=Ke.getState().decks[ue.deckId];if(ne&&ne.type===Ne.Learning){const ke={...ne,infoCards:[...ne.infoCards||[],...K],questions:[...ne.questions||[],...ye]};await n(ke,{silent:!0}),h(`Added content to "${ne.name}"!`,"success");return}}const ve={id:crypto.randomUUID(),name:$||ue.topic,description:P||`Generated ${x?"course":"learning guide"} on ${ue.topic}`,type:Ne.Learning,infoCards:K,questions:ye,learningMode:"separate"};await s([ve]),h("Learning Deck generated!","success")},[p,s,h,n]);return{handleStartAIGeneration:v,handleImmediateAIGeneration:S,handleCancelAIGeneration:A,handleExecuteAIAction:_,handleOpenAIGenerationForDeck:E,handleOpenAIReworkForDeck:w,handleOpenAIGenerationForSeriesLevel:k,handleOpenAIAutoExpandSeries:N,handleGenerateAudioForCard:Q,handleSuggestDeckIcon:U,handleOpenDeckAnalysis:j,handleAutoTagQuestions:O,handleGenerateCardExamples:B,handleHardenDistractorsForQuestion:te,handleHardenAllDistractors:M,handleGenerateAudioForAllCards:F,handleAiAddLevelsToSeries:L,handleAiAddDecksToLevel:J,handleGenerateQuestionsForDeck:D,handleGenerateContentForLearningDeck:ie,handleGenerateQuestionsForEmptyDecksInSeries:Z,handleRegenerateQuestion:Y,handleExpandText:me,handleUpgradeDeckToLearning:I,onAutoPopulateSeries:z,onAutoPopulateLevel:R,onGenerateQuestionsForDeck:re,onGenerateLearningContentForDeck:oe,onGenerateSeriesQuestionsInBatches:Me,onRegenerateQuestion:Fe,onGenerateFullSeriesFromScaffold:q,onGenerateDeckFromOutline:Ce,onGenerateFlashcardDeck:Ve,onGenerateLearningDeckWithAI:Qe,onUpgradeDeckToLearning:he,onHardenAllDistractors:W,onGenerateAudioForAllCards:be,onReworkDeckContent:fe}};var vh={exports:{}};const mk={},pk=Object.freeze(Object.defineProperty({__proto__:null,default:mk},Symbol.toStringTag,{value:"Module"})),bh=Wx(pk);var cb;function gk(){return cb||(cb=1,(function(n,a){var s=void 0,i=function(l){return s||(s=new Promise(function(c,d){var m=typeof l<"u"?l:{},p=m.onAbort;m.onAbort=function(y){d(new Error(y)),p&&p(y)},m.postRun=m.postRun||[],m.postRun.push(function(){c(m)}),n=void 0;var h;h||(h=typeof m<"u"?m:{}),h.onRuntimeInitialized=function(){function y(xe,Ue){switch(typeof Ue){case"boolean":zs(xe,Ue?1:0);break;case"number":Vu(xe,Ue);break;case"string":Zu(xe,Ue,-1,-1);break;case"object":if(Ue===null)Hl(xe);else if(Ue.length!=null){var We=pi(Ue,es);yo(xe,We,Ue.length,-1),oa(We)}else yi(xe,"Wrong API use : tried to return a value of an unknown type ("+Ue+").",-1);break;default:Hl(xe)}}function b(xe,Ue){for(var We=[],ot=0;ot<xe;ot+=1){var xt=X(Ue+4*ot,"i32"),Pt=Gu(xt);if(Pt===1||Pt===2)xt=$u(xt);else if(Pt===3)xt=Pu(xt);else if(Pt===4){Pt=xt,xt=qu(Pt),Pt=Yu(Pt);for(var mr=new Uint8Array(xt),Kn=0;Kn<xt;Kn+=1)mr[Kn]=B[Pt+Kn];xt=mr}else xt=null;We.push(xt)}return We}function C(xe,Ue){this.La=xe,this.db=Ue,this.Ja=1,this.fb=[]}function V(xe,Ue){if(this.db=Ue,Ue=Ot(xe)+1,this.Ya=Ms(Ue),this.Ya===null)throw Error("Unable to allocate memory for the SQL string");Zt(xe,te,this.Ya,Ue),this.eb=this.Ya,this.Ua=this.ib=null}function ee(xe){if(this.filename="dbfile_"+(4294967295*Math.random()>>>0),xe!=null){var Ue=this.filename,We="/",ot=Ue;if(We&&(We=typeof We=="string"?We:fr(We),ot=Ue?ne(We+"/"+Ue):We),Ue=Ya(!0,!0),ot=Xe(ot,(Ue!==void 0?Ue:438)&4095|32768,0),xe){if(typeof xe=="string"){We=Array(xe.length);for(var xt=0,Pt=xe.length;xt<Pt;++xt)We[xt]=xe.charCodeAt(xt);xe=We}hr(ot,Ue|146),We=Pn(ot,577),jl(We,xe,0,xe.length,0),Ka(We),hr(ot,Ue)}}this.handleError(st(this.filename,Ee)),this.db=X(Ee,"i32"),bo(this.db),this.Za={},this.Na={}}var Ee=Mn(4),je=h.cwrap,st=je("sqlite3_open","number",["string","number"]),Dt=je("sqlite3_close_v2","number",["number"]),mt=je("sqlite3_exec","number",["number","string","number","number","number"]),an=je("sqlite3_changes","number",["number"]),sn=je("sqlite3_prepare_v2","number",["number","string","number","number","number"]),Ls=je("sqlite3_sql","string",["number"]),Rl=je("sqlite3_normalized_sql","string",["number"]),Ml=je("sqlite3_prepare_v2","number",["number","number","number","number","number"]),Cu=je("sqlite3_bind_text","number",["number","number","number","number","number"]),Ul=je("sqlite3_bind_blob","number",["number","number","number","number","number"]),po=je("sqlite3_bind_double","number",["number","number","number"]),Ou=je("sqlite3_bind_int","number",["number","number","number"]),ju=je("sqlite3_bind_parameter_index","number",["number","string"]),Iu=je("sqlite3_step","number",["number"]),Ru=je("sqlite3_errmsg","string",["number"]),Mu=je("sqlite3_column_count","number",["number"]),Ll=je("sqlite3_data_count","number",["number"]),Uu=je("sqlite3_column_double","number",["number","number"]),zl=je("sqlite3_column_text","string",["number","number"]),Lu=je("sqlite3_column_blob","number",["number","number"]),zu=je("sqlite3_column_bytes","number",["number","number"]),go=je("sqlite3_column_type","number",["number","number"]),Fu=je("sqlite3_column_name","string",["number","number"]),Bu=je("sqlite3_reset","number",["number"]),Hu=je("sqlite3_clear_bindings","number",["number"]),Fl=je("sqlite3_finalize","number",["number"]),Bl=je("sqlite3_create_function_v2","number","number string number number number number number number number".split(" ")),Gu=je("sqlite3_value_type","number",["number"]),qu=je("sqlite3_value_bytes","number",["number"]),Pu=je("sqlite3_value_text","string",["number"]),Yu=je("sqlite3_value_blob","number",["number"]),$u=je("sqlite3_value_double","number",["number"]),Vu=je("sqlite3_result_double","",["number","number"]),Hl=je("sqlite3_result_null","",["number"]),Zu=je("sqlite3_result_text","",["number","string","number","number"]),yo=je("sqlite3_result_blob","",["number","number","number","number"]),zs=je("sqlite3_result_int","",["number","number"]),yi=je("sqlite3_result_error","",["number","string","number"]),vo=je("sqlite3_aggregate_context","number",["number","number"]),bo=je("RegisterExtensionFunctions","number",["number"]);C.prototype.bind=function(xe){if(!this.La)throw"Statement closed";return this.reset(),Array.isArray(xe)?this.wb(xe):xe!=null&&typeof xe=="object"?this.xb(xe):!0},C.prototype.step=function(){if(!this.La)throw"Statement closed";this.Ja=1;var xe=Iu(this.La);switch(xe){case 100:return!0;case 101:return!1;default:throw this.db.handleError(xe)}},C.prototype.rb=function(xe){return xe==null&&(xe=this.Ja,this.Ja+=1),Uu(this.La,xe)},C.prototype.Ab=function(xe){if(xe==null&&(xe=this.Ja,this.Ja+=1),xe=zl(this.La,xe),typeof BigInt!="function")throw Error("BigInt is not supported");return BigInt(xe)},C.prototype.Bb=function(xe){return xe==null&&(xe=this.Ja,this.Ja+=1),zl(this.La,xe)},C.prototype.getBlob=function(xe){xe==null&&(xe=this.Ja,this.Ja+=1);var Ue=zu(this.La,xe);xe=Lu(this.La,xe);for(var We=new Uint8Array(Ue),ot=0;ot<Ue;ot+=1)We[ot]=B[xe+ot];return We},C.prototype.get=function(xe,Ue){Ue=Ue||{},xe!=null&&this.bind(xe)&&this.step(),xe=[];for(var We=Ll(this.La),ot=0;ot<We;ot+=1)switch(go(this.La,ot)){case 1:var xt=Ue.useBigInt?this.Ab(ot):this.rb(ot);xe.push(xt);break;case 2:xe.push(this.rb(ot));break;case 3:xe.push(this.Bb(ot));break;case 4:xe.push(this.getBlob(ot));break;default:xe.push(null)}return xe},C.prototype.getColumnNames=function(){for(var xe=[],Ue=Mu(this.La),We=0;We<Ue;We+=1)xe.push(Fu(this.La,We));return xe},C.prototype.getAsObject=function(xe,Ue){xe=this.get(xe,Ue),Ue=this.getColumnNames();for(var We={},ot=0;ot<Ue.length;ot+=1)We[Ue[ot]]=xe[ot];return We},C.prototype.getSQL=function(){return Ls(this.La)},C.prototype.getNormalizedSQL=function(){return Rl(this.La)},C.prototype.run=function(xe){return xe!=null&&this.bind(xe),this.step(),this.reset()},C.prototype.nb=function(xe,Ue){Ue==null&&(Ue=this.Ja,this.Ja+=1),xe=zt(xe);var We=pi(xe,es);this.fb.push(We),this.db.handleError(Cu(this.La,Ue,We,xe.length-1,0))},C.prototype.vb=function(xe,Ue){Ue==null&&(Ue=this.Ja,this.Ja+=1);var We=pi(xe,es);this.fb.push(We),this.db.handleError(Ul(this.La,Ue,We,xe.length,0))},C.prototype.mb=function(xe,Ue){Ue==null&&(Ue=this.Ja,this.Ja+=1),this.db.handleError((xe===(xe|0)?Ou:po)(this.La,Ue,xe))},C.prototype.yb=function(xe){xe==null&&(xe=this.Ja,this.Ja+=1),Ul(this.La,xe,0,0,0)},C.prototype.ob=function(xe,Ue){switch(Ue==null&&(Ue=this.Ja,this.Ja+=1),typeof xe){case"string":this.nb(xe,Ue);return;case"number":this.mb(xe,Ue);return;case"bigint":this.nb(xe.toString(),Ue);return;case"boolean":this.mb(xe+0,Ue);return;case"object":if(xe===null){this.yb(Ue);return}if(xe.length!=null){this.vb(xe,Ue);return}}throw"Wrong API use : tried to bind a value of an unknown type ("+xe+")."},C.prototype.xb=function(xe){var Ue=this;return Object.keys(xe).forEach(function(We){var ot=ju(Ue.La,We);ot!==0&&Ue.ob(xe[We],ot)}),!0},C.prototype.wb=function(xe){for(var Ue=0;Ue<xe.length;Ue+=1)this.ob(xe[Ue],Ue+1);return!0},C.prototype.reset=function(){return this.freemem(),Hu(this.La)===0&&Bu(this.La)===0},C.prototype.freemem=function(){for(var xe;(xe=this.fb.pop())!==void 0;)oa(xe)},C.prototype.free=function(){this.freemem();var xe=Fl(this.La)===0;return delete this.db.Za[this.La],this.La=0,xe},V.prototype.next=function(){if(this.Ya===null)return{done:!0};if(this.Ua!==null&&(this.Ua.free(),this.Ua=null),!this.db.db)throw this.gb(),Error("Database closed");var xe=Ea(),Ue=Mn(4);$(Ee),$(Ue);try{this.db.handleError(Ml(this.db.db,this.eb,-1,Ee,Ue)),this.eb=X(Ue,"i32");var We=X(Ee,"i32");return We===0?(this.gb(),{done:!0}):(this.Ua=new C(We,this.db),this.db.Za[We]=this.Ua,{value:this.Ua,done:!1})}catch(ot){throw this.ib=ye(this.eb),this.gb(),ot}finally{Qr(xe)}},V.prototype.gb=function(){oa(this.Ya),this.Ya=null},V.prototype.getRemainingSQL=function(){return this.ib!==null?this.ib:ye(this.eb)},typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"&&(V.prototype[Symbol.iterator]=function(){return this}),ee.prototype.run=function(xe,Ue){if(!this.db)throw"Database closed";if(Ue){xe=this.prepare(xe,Ue);try{xe.step()}finally{xe.free()}}else this.handleError(mt(this.db,xe,0,0,Ee));return this},ee.prototype.exec=function(xe,Ue,We){if(!this.db)throw"Database closed";var ot=Ea(),xt=null;try{var Pt=mi(xe),mr=Mn(4);for(xe=[];X(Pt,"i8")!==0;){$(Ee),$(mr),this.handleError(Ml(this.db,Pt,-1,Ee,mr));var Kn=X(Ee,"i32");if(Pt=X(mr,"i32"),Kn!==0){var Yn=null;for(xt=new C(Kn,this),Ue!=null&&xt.bind(Ue);xt.step();)Yn===null&&(Yn={columns:xt.getColumnNames(),values:[]},xe.push(Yn)),Yn.values.push(xt.get(null,We));xt.free()}}return xe}catch(Un){throw xt&&xt.free(),Un}finally{Qr(ot)}},ee.prototype.each=function(xe,Ue,We,ot,xt){typeof Ue=="function"&&(ot=We,We=Ue,Ue=void 0),xe=this.prepare(xe,Ue);try{for(;xe.step();)We(xe.getAsObject(null,xt))}finally{xe.free()}if(typeof ot=="function")return ot()},ee.prototype.prepare=function(xe,Ue){if($(Ee),this.handleError(sn(this.db,xe,-1,Ee,0)),xe=X(Ee,"i32"),xe===0)throw"Nothing to prepare";var We=new C(xe,this);return Ue!=null&&We.bind(Ue),this.Za[xe]=We},ee.prototype.iterateStatements=function(xe){return new V(xe,this)},ee.prototype.export=function(){Object.values(this.Za).forEach(function(Ue){Ue.free()}),Object.values(this.Na).forEach(ia),this.Na={},this.handleError(Dt(this.db));var xe=ui(this.filename);return this.handleError(st(this.filename,Ee)),this.db=X(Ee,"i32"),bo(this.db),xe},ee.prototype.close=function(){this.db!==null&&(Object.values(this.Za).forEach(function(xe){xe.free()}),Object.values(this.Na).forEach(ia),this.Na={},this.handleError(Dt(this.db)),Wt("/"+this.filename),this.db=null)},ee.prototype.handleError=function(xe){if(xe===0)return null;throw xe=Ru(this.db),Error(xe)},ee.prototype.getRowsModified=function(){return an(this.db)},ee.prototype.create_function=function(xe,Ue){Object.prototype.hasOwnProperty.call(this.Na,xe)&&(ia(this.Na[xe]),delete this.Na[xe]);var We=ns(function(ot,xt,Pt){xt=b(xt,Pt);try{var mr=Ue.apply(null,xt)}catch(Kn){yi(ot,Kn,-1);return}y(ot,mr)},"viii");return this.Na[xe]=We,this.handleError(Bl(this.db,xe,Ue.length,1,0,We,0,0,0)),this},ee.prototype.create_aggregate=function(xe,Ue){var We=Ue.init||function(){return null},ot=Ue.finalize||function(Yn){return Yn},xt=Ue.step;if(!xt)throw"An aggregate function must have a step function in "+xe;var Pt={};Object.hasOwnProperty.call(this.Na,xe)&&(ia(this.Na[xe]),delete this.Na[xe]),Ue=xe+"__finalize",Object.hasOwnProperty.call(this.Na,Ue)&&(ia(this.Na[Ue]),delete this.Na[Ue]);var mr=ns(function(Yn,Un,ka){var Ta=vo(Yn,1);Object.hasOwnProperty.call(Pt,Ta)||(Pt[Ta]=We()),Un=b(Un,ka),Un=[Pt[Ta]].concat(Un);try{Pt[Ta]=xt.apply(null,Un)}catch(vi){delete Pt[Ta],yi(Yn,vi,-1)}},"viii"),Kn=ns(function(Yn){var Un=vo(Yn,1);try{var ka=ot(Pt[Un])}catch(Ta){delete Pt[Un],yi(Yn,Ta,-1);return}y(Yn,ka),delete Pt[Un]},"vi");return this.Na[xe]=mr,this.Na[Ue]=Kn,this.handleError(Bl(this.db,xe,xt.length-1,1,0,0,mr,Kn,0)),this},h.Database=ee};var v=Object.assign({},h),S="./this.program",A=typeof window=="object",_=typeof importScripts=="function",E=typeof process=="object"&&typeof process.versions=="object"&&typeof process.versions.node=="string",w="",k,N,I;if(E){var M=bh,F=bh;w=_?F.dirname(w)+"/":__dirname+"/",k=(y,b)=>(y=fe(y)?new URL(y):F.normalize(y),M.readFileSync(y,b?void 0:"utf8")),I=y=>(y=k(y,!0),y.buffer||(y=new Uint8Array(y)),y),N=(y,b,C,V=!0)=>{y=fe(y)?new URL(y):F.normalize(y),M.readFile(y,V?void 0:"utf8",(ee,Ee)=>{ee?C(ee):b(V?Ee.buffer:Ee)})},!h.thisProgram&&1<process.argv.length&&(S=process.argv[1].replace(/\\/g,"/")),process.argv.slice(2),n.exports=h,h.inspect=()=>"[Emscripten Module object]"}else(A||_)&&(_?w=self.location.href:typeof document<"u"&&document.currentScript&&(w=document.currentScript.src),w=w.indexOf("blob:")!==0?w.substr(0,w.replace(/[?#].*/,"").lastIndexOf("/")+1):"",k=y=>{var b=new XMLHttpRequest;return b.open("GET",y,!1),b.send(null),b.responseText},_&&(I=y=>{var b=new XMLHttpRequest;return b.open("GET",y,!1),b.responseType="arraybuffer",b.send(null),new Uint8Array(b.response)}),N=(y,b,C)=>{var V=new XMLHttpRequest;V.open("GET",y,!0),V.responseType="arraybuffer",V.onload=()=>{V.status==200||V.status==0&&V.response?b(V.response):C()},V.onerror=C,V.send(null)});var q=h.print||console.log.bind(console),Q=h.printErr||console.error.bind(console);Object.assign(h,v),v=null,h.thisProgram&&(S=h.thisProgram);var U;h.wasmBinary&&(U=h.wasmBinary),typeof WebAssembly!="object"&&oe("no native wasm support detected");var j,O=!1,B,te,L,J,D,ie,Z;function Y(){var y=j.buffer;h.HEAP8=B=new Int8Array(y),h.HEAP16=L=new Int16Array(y),h.HEAPU8=te=new Uint8Array(y),h.HEAPU16=new Uint16Array(y),h.HEAP32=J=new Int32Array(y),h.HEAPU32=D=new Uint32Array(y),h.HEAPF32=ie=new Float32Array(y),h.HEAPF64=Z=new Float64Array(y)}var me=[],W=[],be=[];function z(){var y=h.preRun.shift();me.unshift(y)}var R=0,re=null;function oe(y){var b;throw(b=h.onAbort)==null||b.call(h,y),y="Aborted("+y+")",Q(y),O=!0,new WebAssembly.RuntimeError(y+". Build with -sASSERTIONS for more info.")}var he=y=>y.startsWith("data:application/octet-stream;base64,"),fe=y=>y.startsWith("file://"),Me;if(Me="sql-wasm.wasm",!he(Me)){var Fe=Me;Me=h.locateFile?h.locateFile(Fe,w):w+Fe}function Ce(y){if(y==Me&&U)return new Uint8Array(U);if(I)return I(y);throw"both async and sync fetching of the wasm failed"}function Ve(y){if(!U&&(A||_)){if(typeof fetch=="function"&&!fe(y))return fetch(y,{credentials:"same-origin"}).then(b=>{if(!b.ok)throw"failed to load wasm binary file at '"+y+"'";return b.arrayBuffer()}).catch(()=>Ce(y));if(N)return new Promise((b,C)=>{N(y,V=>b(new Uint8Array(V)),C)})}return Promise.resolve().then(()=>Ce(y))}function Qe(y,b,C){return Ve(y).then(V=>WebAssembly.instantiate(V,b)).then(V=>V).then(C,V=>{Q(`failed to asynchronously prepare wasm: ${V}`),oe(V)})}function ue(y,b){var C=Me;U||typeof WebAssembly.instantiateStreaming!="function"||he(C)||fe(C)||E||typeof fetch!="function"?Qe(C,y,b):fetch(C,{credentials:"same-origin"}).then(V=>WebAssembly.instantiateStreaming(V,y).then(b,function(ee){return Q(`wasm streaming compile failed: ${ee}`),Q("falling back to ArrayBuffer instantiation"),Qe(C,y,b)}))}var de,x,se=y=>{for(;0<y.length;)y.shift()(h)};function X(y,b="i8"){switch(b.endsWith("*")&&(b="*"),b){case"i1":return B[y>>0];case"i8":return B[y>>0];case"i16":return L[y>>1];case"i32":return J[y>>2];case"i64":oe("to do getValue(i64) use WASM_BIGINT");case"float":return ie[y>>2];case"double":return Z[y>>3];case"*":return D[y>>2];default:oe(`invalid type for getValue: ${b}`)}}function $(y){var b="i32";switch(b.endsWith("*")&&(b="*"),b){case"i1":B[y>>0]=0;break;case"i8":B[y>>0]=0;break;case"i16":L[y>>1]=0;break;case"i32":J[y>>2]=0;break;case"i64":oe("to do setValue(i64) use WASM_BIGINT");case"float":ie[y>>2]=0;break;case"double":Z[y>>3]=0;break;case"*":D[y>>2]=0;break;default:oe(`invalid type for setValue: ${b}`)}}var P=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0,K=(y,b,C)=>{var V=b+C;for(C=b;y[C]&&!(C>=V);)++C;if(16<C-b&&y.buffer&&P)return P.decode(y.subarray(b,C));for(V="";b<C;){var ee=y[b++];if(ee&128){var Ee=y[b++]&63;if((ee&224)==192)V+=String.fromCharCode((ee&31)<<6|Ee);else{var je=y[b++]&63;ee=(ee&240)==224?(ee&15)<<12|Ee<<6|je:(ee&7)<<18|Ee<<12|je<<6|y[b++]&63,65536>ee?V+=String.fromCharCode(ee):(ee-=65536,V+=String.fromCharCode(55296|ee>>10,56320|ee&1023))}}else V+=String.fromCharCode(ee)}return V},ye=(y,b)=>y?K(te,y,b):"",ve=(y,b)=>{for(var C=0,V=y.length-1;0<=V;V--){var ee=y[V];ee==="."?y.splice(V,1):ee===".."?(y.splice(V,1),C++):C&&(y.splice(V,1),C--)}if(b)for(;C;C--)y.unshift("..");return y},ne=y=>{var b=y.charAt(0)==="/",C=y.substr(-1)==="/";return(y=ve(y.split("/").filter(V=>!!V),!b).join("/"))||b||(y="."),y&&C&&(y+="/"),(b?"/":"")+y},ke=y=>{var b=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/.exec(y).slice(1);return y=b[0],b=b[1],!y&&!b?".":(b&&(b=b.substr(0,b.length-1)),y+b)},Oe=y=>{if(y==="/")return"/";y=ne(y),y=y.replace(/\/$/,"");var b=y.lastIndexOf("/");return b===-1?y:y.substr(b+1)},Te=()=>{if(typeof crypto=="object"&&typeof crypto.getRandomValues=="function")return C=>crypto.getRandomValues(C);if(E)try{var y=bh;if(y.randomFillSync)return C=>y.randomFillSync(C);var b=y.randomBytes;return C=>(C.set(b(C.byteLength)),C)}catch{}oe("initRandomDevice")},He=y=>(He=Te())(y);function it(){for(var y="",b=!1,C=arguments.length-1;-1<=C&&!b;C--){if(b=0<=C?arguments[C]:"/",typeof b!="string")throw new TypeError("Arguments to path.resolve must be strings");if(!b)return"";y=b+"/"+y,b=b.charAt(0)==="/"}return y=ve(y.split("/").filter(V=>!!V),!b).join("/"),(b?"/":"")+y||"."}var at=[],Ot=y=>{for(var b=0,C=0;C<y.length;++C){var V=y.charCodeAt(C);127>=V?b++:2047>=V?b+=2:55296<=V&&57343>=V?(b+=4,++C):b+=3}return b},Zt=(y,b,C,V)=>{if(!(0<V))return 0;var ee=C;V=C+V-1;for(var Ee=0;Ee<y.length;++Ee){var je=y.charCodeAt(Ee);if(55296<=je&&57343>=je){var st=y.charCodeAt(++Ee);je=65536+((je&1023)<<10)|st&1023}if(127>=je){if(C>=V)break;b[C++]=je}else{if(2047>=je){if(C+1>=V)break;b[C++]=192|je>>6}else{if(65535>=je){if(C+2>=V)break;b[C++]=224|je>>12}else{if(C+3>=V)break;b[C++]=240|je>>18,b[C++]=128|je>>12&63}b[C++]=128|je>>6&63}b[C++]=128|je&63}}return b[C]=0,C-ee};function zt(y,b){var C=Array(Ot(y)+1);return y=Zt(y,C,0,C.length),b&&(C.length=y),C}var qt=[];function ht(y,b){qt[y]={input:[],output:[],Xa:b},Qa(y,bt)}var bt={open(y){var b=qt[y.node.rdev];if(!b)throw new Ge(43);y.tty=b,y.seekable=!1},close(y){y.tty.Xa.fsync(y.tty)},fsync(y){y.tty.Xa.fsync(y.tty)},read(y,b,C,V){if(!y.tty||!y.tty.Xa.sb)throw new Ge(60);for(var ee=0,Ee=0;Ee<V;Ee++){try{var je=y.tty.Xa.sb(y.tty)}catch{throw new Ge(29)}if(je===void 0&&ee===0)throw new Ge(6);if(je==null)break;ee++,b[C+Ee]=je}return ee&&(y.node.timestamp=Date.now()),ee},write(y,b,C,V){if(!y.tty||!y.tty.Xa.jb)throw new Ge(60);try{for(var ee=0;ee<V;ee++)y.tty.Xa.jb(y.tty,b[C+ee])}catch{throw new Ge(29)}return V&&(y.node.timestamp=Date.now()),ee}},pn={sb(){e:{if(!at.length){var y=null;if(E){var b=Buffer.alloc(256),C=0,V=process.stdin.fd;try{C=M.readSync(V,b)}catch(ee){if(ee.toString().includes("EOF"))C=0;else throw ee}0<C?y=b.slice(0,C).toString("utf-8"):y=null}else typeof window<"u"&&typeof window.prompt=="function"?(y=window.prompt("Input: "),y!==null&&(y+=`
`)):typeof readline=="function"&&(y=readline(),y!==null&&(y+=`
`));if(!y){y=null;break e}at=zt(y,!0)}y=at.shift()}return y},jb(y,b){b===null||b===10?(q(K(y.output,0)),y.output=[]):b!=0&&y.output.push(b)},fsync(y){y.output&&0<y.output.length&&(q(K(y.output,0)),y.output=[])},Mb(){return{Ib:25856,Kb:5,Hb:191,Jb:35387,Gb:[3,28,127,21,4,0,1,0,17,19,26,0,18,15,23,22,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]}},Nb(){return 0},Ob(){return[24,80]}},It={jb(y,b){b===null||b===10?(Q(K(y.output,0)),y.output=[]):b!=0&&y.output.push(b)},fsync(y){y.output&&0<y.output.length&&(Q(K(y.output,0)),y.output=[])}};function ya(y,b){var C=y.Ia?y.Ia.length:0;C>=b||(b=Math.max(b,C*(1048576>C?2:1.125)>>>0),C!=0&&(b=Math.max(b,256)),C=y.Ia,y.Ia=new Uint8Array(b),0<y.Ma&&y.Ia.set(C.subarray(0,y.Ma),0))}var dt={Qa:null,Ra(){return dt.createNode(null,"/",16895,0)},createNode(y,b,C,V){if((C&61440)===24576||(C&61440)===4096)throw new Ge(63);return dt.Qa||(dt.Qa={dir:{node:{Pa:dt.Ga.Pa,Oa:dt.Ga.Oa,lookup:dt.Ga.lookup,ab:dt.Ga.ab,rename:dt.Ga.rename,unlink:dt.Ga.unlink,rmdir:dt.Ga.rmdir,readdir:dt.Ga.readdir,symlink:dt.Ga.symlink},stream:{Ta:dt.Ha.Ta}},file:{node:{Pa:dt.Ga.Pa,Oa:dt.Ga.Oa},stream:{Ta:dt.Ha.Ta,read:dt.Ha.read,write:dt.Ha.write,lb:dt.Ha.lb,bb:dt.Ha.bb,cb:dt.Ha.cb}},link:{node:{Pa:dt.Ga.Pa,Oa:dt.Ga.Oa,readlink:dt.Ga.readlink},stream:{}},pb:{node:{Pa:dt.Ga.Pa,Oa:dt.Ga.Oa},stream:Za}}),C=In(y,b,C,V),xn(C.mode)?(C.Ga=dt.Qa.dir.node,C.Ha=dt.Qa.dir.stream,C.Ia={}):(C.mode&61440)===32768?(C.Ga=dt.Qa.file.node,C.Ha=dt.Qa.file.stream,C.Ma=0,C.Ia=null):(C.mode&61440)===40960?(C.Ga=dt.Qa.link.node,C.Ha=dt.Qa.link.stream):(C.mode&61440)===8192&&(C.Ga=dt.Qa.pb.node,C.Ha=dt.Qa.pb.stream),C.timestamp=Date.now(),y&&(y.Ia[b]=C,y.timestamp=C.timestamp),C},Lb(y){return y.Ia?y.Ia.subarray?y.Ia.subarray(0,y.Ma):new Uint8Array(y.Ia):new Uint8Array(0)},Ga:{Pa(y){var b={};return b.dev=(y.mode&61440)===8192?y.id:1,b.ino=y.id,b.mode=y.mode,b.nlink=1,b.uid=0,b.gid=0,b.rdev=y.rdev,xn(y.mode)?b.size=4096:(y.mode&61440)===32768?b.size=y.Ma:(y.mode&61440)===40960?b.size=y.link.length:b.size=0,b.atime=new Date(y.timestamp),b.mtime=new Date(y.timestamp),b.ctime=new Date(y.timestamp),b.zb=4096,b.blocks=Math.ceil(b.size/b.zb),b},Oa(y,b){if(b.mode!==void 0&&(y.mode=b.mode),b.timestamp!==void 0&&(y.timestamp=b.timestamp),b.size!==void 0&&(b=b.size,y.Ma!=b))if(b==0)y.Ia=null,y.Ma=0;else{var C=y.Ia;y.Ia=new Uint8Array(b),C&&y.Ia.set(C.subarray(0,Math.min(b,y.Ma))),y.Ma=b}},lookup(){throw va[44]},ab(y,b,C,V){return dt.createNode(y,b,C,V)},rename(y,b,C){if(xn(y.mode)){try{var V=Dr(b,C)}catch{}if(V)for(var ee in V.Ia)throw new Ge(55)}delete y.parent.Ia[y.name],y.parent.timestamp=Date.now(),y.name=C,b.Ia[C]=y,b.timestamp=y.parent.timestamp,y.parent=b},unlink(y,b){delete y.Ia[b],y.timestamp=Date.now()},rmdir(y,b){var C=Dr(y,b),V;for(V in C.Ia)throw new Ge(55);delete y.Ia[b],y.timestamp=Date.now()},readdir(y){var b=[".",".."],C;for(C of Object.keys(y.Ia))b.push(C);return b},symlink(y,b,C){return y=dt.createNode(y,b,41471,0),y.link=C,y},readlink(y){if((y.mode&61440)!==40960)throw new Ge(28);return y.link}},Ha:{read(y,b,C,V,ee){var Ee=y.node.Ia;if(ee>=y.node.Ma)return 0;if(y=Math.min(y.node.Ma-ee,V),8<y&&Ee.subarray)b.set(Ee.subarray(ee,ee+y),C);else for(V=0;V<y;V++)b[C+V]=Ee[ee+V];return y},write(y,b,C,V,ee,Ee){if(b.buffer===B.buffer&&(Ee=!1),!V)return 0;if(y=y.node,y.timestamp=Date.now(),b.subarray&&(!y.Ia||y.Ia.subarray)){if(Ee)return y.Ia=b.subarray(C,C+V),y.Ma=V;if(y.Ma===0&&ee===0)return y.Ia=b.slice(C,C+V),y.Ma=V;if(ee+V<=y.Ma)return y.Ia.set(b.subarray(C,C+V),ee),V}if(ya(y,ee+V),y.Ia.subarray&&b.subarray)y.Ia.set(b.subarray(C,C+V),ee);else for(Ee=0;Ee<V;Ee++)y.Ia[ee+Ee]=b[C+Ee];return y.Ma=Math.max(y.Ma,ee+V),V},Ta(y,b,C){if(C===1?b+=y.position:C===2&&(y.node.mode&61440)===32768&&(b+=y.node.Ma),0>b)throw new Ge(28);return b},lb(y,b,C){ya(y.node,b+C),y.node.Ma=Math.max(y.node.Ma,b+C)},bb(y,b,C,V,ee){if((y.node.mode&61440)!==32768)throw new Ge(43);if(y=y.node.Ia,ee&2||y.buffer!==B.buffer){if((0<C||C+b<y.length)&&(y.subarray?y=y.subarray(C,C+b):y=Array.prototype.slice.call(y,C,C+b)),C=!0,b=65536*Math.ceil(b/65536),(ee=Rr(65536,b))?(te.fill(0,ee,ee+b),b=ee):b=0,!b)throw new Ge(48);B.set(y,b)}else C=!1,b=y.byteOffset;return{Db:b,ub:C}},cb(y,b,C,V){return dt.Ha.write(y,b,0,V,C,!1),0}}},Ya=(y,b)=>{var C=0;return y&&(C|=365),b&&(C|=146),C},Nr=null,Ft={},cn=[],jn=1,Qn=null,Zr=!0,Ge=null,va={};function gn(y,b={}){if(y=it(y),!y)return{path:"",node:null};if(b=Object.assign({qb:!0,kb:0},b),8<b.kb)throw new Ge(32);y=y.split("/").filter(je=>!!je);for(var C=Nr,V="/",ee=0;ee<y.length;ee++){var Ee=ee===y.length-1;if(Ee&&b.parent)break;if(C=Dr(C,y[ee]),V=ne(V+"/"+y[ee]),C.Va&&(!Ee||Ee&&b.qb)&&(C=C.Va.root),!Ee||b.Sa){for(Ee=0;(C.mode&61440)===40960;)if(C=Jt(V),V=it(ke(V),C),C=gn(V,{kb:b.kb+1}).node,40<Ee++)throw new Ge(32)}}return{path:V,node:C}}function fr(y){for(var b;;){if(y===y.parent)return y=y.Ra.tb,b?y[y.length-1]!=="/"?`${y}/${b}`:y+b:y;b=b?`${y.name}/${b}`:y.name,y=y.parent}}function $a(y,b){for(var C=0,V=0;V<b.length;V++)C=(C<<5)-C+b.charCodeAt(V)|0;return(y+C>>>0)%Qn.length}function Va(y){var b=$a(y.parent.id,y.name);if(Qn[b]===y)Qn[b]=y.Wa;else for(b=Qn[b];b;){if(b.Wa===y){b.Wa=y.Wa;break}b=b.Wa}}function Dr(y,b){var C;if(C=(C=Cr(y,"x"))?C:y.Ga.lookup?0:2)throw new Ge(C,y);for(C=Qn[$a(y.id,b)];C;C=C.Wa){var V=C.name;if(C.parent.id===y.id&&V===b)return C}return y.Ga.lookup(y,b)}function In(y,b,C,V){return y=new wa(y,b,C,V),b=$a(y.parent.id,y.name),y.Wa=Qn[b],Qn[b]=y}function xn(y){return(y&61440)===16384}function ba(y){var b=["r","w","rw"][y&3];return y&512&&(b+="w"),b}function Cr(y,b){if(Zr)return 0;if(!b.includes("r")||y.mode&292){if(b.includes("w")&&!(y.mode&146)||b.includes("x")&&!(y.mode&73))return 2}else return 2;return 0}function Is(y,b){try{return Dr(y,b),20}catch{}return Cr(y,"wx")}function ar(y,b,C){try{var V=Dr(y,b)}catch(ee){return ee.Ka}if(y=Cr(y,"wx"))return y;if(C){if(!xn(V.mode))return 54;if(V===V.parent||fr(V)==="/")return 10}else if(xn(V.mode))return 31;return 0}function Bt(){for(var y=0;4096>=y;y++)if(!cn[y])return y;throw new Ge(33)}function Rt(y){if(y=cn[y],!y)throw new Ge(8);return y}function Or(y,b=-1){return xa||(xa=function(){this.$a={}},xa.prototype={},Object.defineProperties(xa.prototype,{object:{get(){return this.node},set(C){this.node=C}},flags:{get(){return this.$a.flags},set(C){this.$a.flags=C}},position:{get(){return this.$a.position},set(C){this.$a.position=C}}})),y=Object.assign(new xa,y),b==-1&&(b=Bt()),y.fd=b,cn[b]=y}var Za={open(y){var b,C;y.Ha=Ft[y.node.rdev].Ha,(C=(b=y.Ha).open)==null||C.call(b,y)},Ta(){throw new Ge(70)}};function Qa(y,b){Ft[y]={Ha:b}}function ci(y,b){var C=b==="/",V=!b;if(C&&Nr)throw new Ge(10);if(!C&&!V){var ee=gn(b,{qb:!1});if(b=ee.path,ee=ee.node,ee.Va)throw new Ge(10);if(!xn(ee.mode))throw new Ge(54)}b={type:y,Pb:{},tb:b,Cb:[]},y=y.Ra(b),y.Ra=b,b.root=y,C?Nr=y:ee&&(ee.Va=b,ee.Ra&&ee.Ra.Cb.push(b))}function Xe(y,b,C){var V=gn(y,{parent:!0}).node;if(y=Oe(y),!y||y==="."||y==="..")throw new Ge(28);var ee=Is(V,y);if(ee)throw new Ge(ee);if(!V.Ga.ab)throw new Ge(63);return V.Ga.ab(V,y,b,C)}function le(y,b){return Xe(y,(b!==void 0?b:511)&1023|16384,0)}function Le(y,b,C){typeof C>"u"&&(C=b,b=438),Xe(y,b|8192,C)}function $e(y,b){if(!it(y))throw new Ge(44);var C=gn(b,{parent:!0}).node;if(!C)throw new Ge(44);b=Oe(b);var V=Is(C,b);if(V)throw new Ge(V);if(!C.Ga.symlink)throw new Ge(63);C.Ga.symlink(C,b,y)}function ct(y){var b=gn(y,{parent:!0}).node;y=Oe(y);var C=Dr(b,y),V=ar(b,y,!0);if(V)throw new Ge(V);if(!b.Ga.rmdir)throw new Ge(63);if(C.Va)throw new Ge(10);b.Ga.rmdir(b,y),Va(C)}function Wt(y){var b=gn(y,{parent:!0}).node;if(!b)throw new Ge(44);y=Oe(y);var C=Dr(b,y),V=ar(b,y,!1);if(V)throw new Ge(V);if(!b.Ga.unlink)throw new Ge(63);if(C.Va)throw new Ge(10);b.Ga.unlink(b,y),Va(C)}function Jt(y){if(y=gn(y).node,!y)throw new Ge(44);if(!y.Ga.readlink)throw new Ge(28);return it(fr(y.parent),y.Ga.readlink(y))}function wt(y,b){if(y=gn(y,{Sa:!b}).node,!y)throw new Ge(44);if(!y.Ga.Pa)throw new Ge(63);return y.Ga.Pa(y)}function _n(y){return wt(y,!0)}function hr(y,b){if(y=typeof y=="string"?gn(y,{Sa:!0}).node:y,!y.Ga.Oa)throw new Ge(63);y.Ga.Oa(y,{mode:b&4095|y.mode&-4096,timestamp:Date.now()})}function en(y,b){if(0>b)throw new Ge(28);if(y=typeof y=="string"?gn(y,{Sa:!0}).node:y,!y.Ga.Oa)throw new Ge(63);if(xn(y.mode))throw new Ge(31);if((y.mode&61440)!==32768)throw new Ge(28);var C=Cr(y,"w");if(C)throw new Ge(C);y.Ga.Oa(y,{size:b,timestamp:Date.now()})}function Pn(y,b,C){if(y==="")throw new Ge(44);if(typeof b=="string"){var V={r:0,"r+":2,w:577,"w+":578,a:1089,"a+":1090}[b];if(typeof V>"u")throw Error(`Unknown file open mode: ${b}`);b=V}if(C=b&64?(typeof C>"u"?438:C)&4095|32768:0,typeof y=="object")var ee=y;else{y=ne(y);try{ee=gn(y,{Sa:!(b&131072)}).node}catch{}}if(V=!1,b&64)if(ee){if(b&128)throw new Ge(20)}else ee=Xe(y,C,0),V=!0;if(!ee)throw new Ge(44);if((ee.mode&61440)===8192&&(b&=-513),b&65536&&!xn(ee.mode))throw new Ge(54);if(!V&&(C=ee?(ee.mode&61440)===40960?32:xn(ee.mode)&&(ba(b)!=="r"||b&512)?31:Cr(ee,ba(b)):44))throw new Ge(C);return b&512&&!V&&en(ee,0),b&=-131713,ee=Or({node:ee,path:fr(ee),flags:b,seekable:!0,position:0,Ha:ee.Ha,Fb:[],error:!1}),ee.Ha.open&&ee.Ha.open(ee),!h.logReadFiles||b&1||(di||(di={}),y in di||(di[y]=1)),ee}function Ka(y){if(y.fd===null)throw new Ge(8);y.hb&&(y.hb=null);try{y.Ha.close&&y.Ha.close(y)}catch(b){throw b}finally{cn[y.fd]=null}y.fd=null}function lo(y,b,C){if(y.fd===null)throw new Ge(8);if(!y.seekable||!y.Ha.Ta)throw new Ge(70);if(C!=0&&C!=1&&C!=2)throw new Ge(28);y.position=y.Ha.Ta(y,b,C),y.Fb=[]}function co(y,b,C,V,ee){if(0>V||0>ee)throw new Ge(28);if(y.fd===null)throw new Ge(8);if((y.flags&2097155)===1)throw new Ge(8);if(xn(y.node.mode))throw new Ge(31);if(!y.Ha.read)throw new Ge(28);var Ee=typeof ee<"u";if(!Ee)ee=y.position;else if(!y.seekable)throw new Ge(70);return b=y.Ha.read(y,b,C,V,ee),Ee||(y.position+=b),b}function jl(y,b,C,V,ee){if(0>V||0>ee)throw new Ge(28);if(y.fd===null)throw new Ge(8);if((y.flags&2097155)===0)throw new Ge(8);if(xn(y.node.mode))throw new Ge(31);if(!y.Ha.write)throw new Ge(28);y.seekable&&y.flags&1024&&lo(y,0,2);var Ee=typeof ee<"u";if(!Ee)ee=y.position;else if(!y.seekable)throw new Ge(70);return b=y.Ha.write(y,b,C,V,ee,void 0),Ee||(y.position+=b),b}function ui(y){var b,C=Pn(y,C||0);y=wt(y).size;var V=new Uint8Array(y);return co(C,V,0,y,0),b=V,Ka(C),b}function Rs(){Ge||(Ge=function(y,b){this.name="ErrnoError",this.node=b,this.Eb=function(C){this.Ka=C},this.Eb(y),this.message="FS error"},Ge.prototype=Error(),Ge.prototype.constructor=Ge,[44].forEach(y=>{va[y]=new Ge(y),va[y].stack="<generic error, no stack>"}))}var jr;function Dn(y,b,C){y=ne("/dev/"+y);var V=Ya(!!b,!!C);uo||(uo=64);var ee=uo++<<8|0;Qa(ee,{open(Ee){Ee.seekable=!1},close(){var Ee;(Ee=C==null?void 0:C.buffer)!=null&&Ee.length&&C(10)},read(Ee,je,st,Dt){for(var mt=0,an=0;an<Dt;an++){try{var sn=b()}catch{throw new Ge(29)}if(sn===void 0&&mt===0)throw new Ge(6);if(sn==null)break;mt++,je[st+an]=sn}return mt&&(Ee.node.timestamp=Date.now()),mt},write(Ee,je,st,Dt){for(var mt=0;mt<Dt;mt++)try{C(je[st+mt])}catch{throw new Ge(29)}return Dt&&(Ee.node.timestamp=Date.now()),mt}}),Le(y,V,ee)}var uo,Qt={},xa,di;function Ir(y,b,C){if(b.charAt(0)==="/")return b;if(y=y===-100?"/":Rt(y).path,b.length==0){if(!C)throw new Ge(44);return y}return ne(y+"/"+b)}function fi(y,b,C){try{var V=y(b)}catch(Ee){if(Ee&&Ee.node&&ne(b)!==ne(fr(Ee.node)))return-54;throw Ee}J[C>>2]=V.dev,J[C+4>>2]=V.mode,D[C+8>>2]=V.nlink,J[C+12>>2]=V.uid,J[C+16>>2]=V.gid,J[C+20>>2]=V.rdev,x=[V.size>>>0,(de=V.size,1<=+Math.abs(de)?0<de?+Math.floor(de/4294967296)>>>0:~~+Math.ceil((de-+(~~de>>>0))/4294967296)>>>0:0)],J[C+24>>2]=x[0],J[C+28>>2]=x[1],J[C+32>>2]=4096,J[C+36>>2]=V.blocks,y=V.atime.getTime(),b=V.mtime.getTime();var ee=V.ctime.getTime();return x=[Math.floor(y/1e3)>>>0,(de=Math.floor(y/1e3),1<=+Math.abs(de)?0<de?+Math.floor(de/4294967296)>>>0:~~+Math.ceil((de-+(~~de>>>0))/4294967296)>>>0:0)],J[C+40>>2]=x[0],J[C+44>>2]=x[1],D[C+48>>2]=y%1e3*1e3,x=[Math.floor(b/1e3)>>>0,(de=Math.floor(b/1e3),1<=+Math.abs(de)?0<de?+Math.floor(de/4294967296)>>>0:~~+Math.ceil((de-+(~~de>>>0))/4294967296)>>>0:0)],J[C+56>>2]=x[0],J[C+60>>2]=x[1],D[C+64>>2]=b%1e3*1e3,x=[Math.floor(ee/1e3)>>>0,(de=Math.floor(ee/1e3),1<=+Math.abs(de)?0<de?+Math.floor(de/4294967296)>>>0:~~+Math.ceil((de-+(~~de>>>0))/4294967296)>>>0:0)],J[C+72>>2]=x[0],J[C+76>>2]=x[1],D[C+80>>2]=ee%1e3*1e3,x=[V.ino>>>0,(de=V.ino,1<=+Math.abs(de)?0<de?+Math.floor(de/4294967296)>>>0:~~+Math.ceil((de-+(~~de>>>0))/4294967296)>>>0:0)],J[C+88>>2]=x[0],J[C+92>>2]=x[1],0}var Rn=void 0;function Ja(){var y=J[+Rn>>2];return Rn+=4,y}var Xa=(y,b)=>b+2097152>>>0<4194305-!!y?(y>>>0)+4294967296*b:NaN,fo=[0,31,60,91,121,152,182,213,244,274,305,335],Wa=[0,31,59,90,120,151,181,212,243,273,304,334],ho=y=>{var b=Ot(y)+1,C=Ms(b);return C&&Zt(y,te,C,b),C},hi={},_a=()=>{if(!mo){var y={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:(typeof navigator=="object"&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8",_:S||"./this.program"},b;for(b in hi)hi[b]===void 0?delete y[b]:y[b]=hi[b];var C=[];for(b in y)C.push(`${b}=${y[b]}`);mo=C}return mo},mo,mi=y=>{var b=Ot(y)+1,C=Mn(b);return Zt(y,te,C,b),C},Il=(y,b,C,V)=>{var ee={string:mt=>{var an=0;return mt!=null&&mt!==0&&(an=mi(mt)),an},array:mt=>{var an=Mn(mt.length);return B.set(mt,an),an}};y=h["_"+y];var Ee=[],je=0;if(V)for(var st=0;st<V.length;st++){var Dt=ee[C[st]];Dt?(je===0&&(je=Ea()),Ee[st]=Dt(V[st])):Ee[st]=V[st]}return C=y.apply(null,Ee),C=(function(mt){return je!==0&&Qr(je),b==="string"?mt?K(te,mt):"":b==="boolean"?!!mt:mt})(C)},es=0,pi=(y,b)=>(b=b==1?Mn(y.length):Ms(y.length),y.subarray||y.slice||(y=new Uint8Array(y)),te.set(y,b),b),Sa,ts=[],Tn,ia=y=>{Sa.delete(Tn.get(y)),Tn.set(y,null),ts.push(y)},ns=(y,b)=>{if(!Sa){Sa=new WeakMap;var C=Tn.length;if(Sa)for(var V=0;V<0+C;V++){var ee=Tn.get(V);ee&&Sa.set(ee,V)}}if(C=Sa.get(y)||0)return C;if(ts.length)C=ts.pop();else{try{Tn.grow(1)}catch(st){throw st instanceof RangeError?"Unable to grow wasm table. Set ALLOW_TABLE_GROWTH.":st}C=Tn.length-1}try{Tn.set(C,y)}catch(st){if(!(st instanceof TypeError))throw st;if(typeof WebAssembly.Function=="function"){V=WebAssembly.Function,ee={i:"i32",j:"i64",f:"f32",d:"f64",e:"externref",p:"i32"};for(var Ee={parameters:[],results:b[0]=="v"?[]:[ee[b[0]]]},je=1;je<b.length;++je)Ee.parameters.push(ee[b[je]]);b=new V(Ee,y)}else{for(V=[1],ee=b.slice(0,1),b=b.slice(1),Ee={i:127,p:127,j:126,f:125,d:124,e:111},V.push(96),je=b.length,128>je?V.push(je):V.push(je%128|128,je>>7),je=0;je<b.length;++je)V.push(Ee[b[je]]);ee=="v"?V.push(0):V.push(1,Ee[ee]),b=[0,97,115,109,1,0,0,0,1],ee=V.length,128>ee?b.push(ee):b.push(ee%128|128,ee>>7),b.push.apply(b,V),b.push(2,7,1,1,101,1,102,0,0,7,5,1,1,102,0,0),b=new WebAssembly.Module(new Uint8Array(b)),b=new WebAssembly.Instance(b,{e:{f:y}}).exports.f}Tn.set(C,b)}return Sa.set(y,C),C};function wa(y,b,C,V){y||(y=this),this.parent=y,this.Ra=y.Ra,this.Va=null,this.id=jn++,this.name=b,this.mode=C,this.Ga={},this.Ha={},this.rdev=V}Object.defineProperties(wa.prototype,{read:{get:function(){return(this.mode&365)===365},set:function(y){y?this.mode|=365:this.mode&=-366}},write:{get:function(){return(this.mode&146)===146},set:function(y){y?this.mode|=146:this.mode&=-147}}}),Rs(),Qn=Array(4096),ci(dt,"/"),le("/tmp"),le("/home"),le("/home/web_user"),(function(){le("/dev"),Qa(259,{read:()=>0,write:(V,ee,Ee,je)=>je}),Le("/dev/null",259),ht(1280,pn),ht(1536,It),Le("/dev/tty",1280),Le("/dev/tty1",1536);var y=new Uint8Array(1024),b=0,C=()=>(b===0&&(b=He(y).byteLength),y[--b]);Dn("random",C),Dn("urandom",C),le("/dev/shm"),le("/dev/shm/tmp")})(),(function(){le("/proc");var y=le("/proc/self");le("/proc/self/fd"),ci({Ra(){var b=In(y,"fd",16895,73);return b.Ga={lookup(C,V){var ee=Rt(+V);return C={parent:null,Ra:{tb:"fake"},Ga:{readlink:()=>ee.path}},C.parent=C}},b}},"/proc/self/fd")})();var rs={a:(y,b,C,V)=>{oe(`Assertion failed: ${y?K(te,y):""}, at: `+[b?b?K(te,b):"":"unknown filename",C,V?V?K(te,V):"":"unknown function"])},h:function(y,b){try{return y=y?K(te,y):"",hr(y,b),0}catch(C){if(typeof Qt>"u"||C.name!=="ErrnoError")throw C;return-C.Ka}},H:function(y,b,C){try{if(b=b?K(te,b):"",b=Ir(y,b),C&-8)return-28;var V=gn(b,{Sa:!0}).node;return V?(y="",C&4&&(y+="r"),C&2&&(y+="w"),C&1&&(y+="x"),y&&Cr(V,y)?-2:0):-44}catch(ee){if(typeof Qt>"u"||ee.name!=="ErrnoError")throw ee;return-ee.Ka}},i:function(y,b){try{var C=Rt(y);return hr(C.node,b),0}catch(V){if(typeof Qt>"u"||V.name!=="ErrnoError")throw V;return-V.Ka}},g:function(y){try{var b=Rt(y).node,C=typeof b=="string"?gn(b,{Sa:!0}).node:b;if(!C.Ga.Oa)throw new Ge(63);return C.Ga.Oa(C,{timestamp:Date.now()}),0}catch(V){if(typeof Qt>"u"||V.name!=="ErrnoError")throw V;return-V.Ka}},b:function(y,b,C){Rn=C;try{var V=Rt(y);switch(b){case 0:var ee=Ja();if(0>ee)return-28;for(;cn[ee];)ee++;return Or(V,ee).fd;case 1:case 2:return 0;case 3:return V.flags;case 4:return ee=Ja(),V.flags|=ee,0;case 5:return ee=Ja(),L[ee+0>>1]=2,0;case 6:case 7:return 0;case 16:case 8:return-28;case 9:return J[gi()>>2]=28,-1;default:return-28}}catch(Ee){if(typeof Qt>"u"||Ee.name!=="ErrnoError")throw Ee;return-Ee.Ka}},f:function(y,b){try{var C=Rt(y);return fi(wt,C.path,b)}catch(V){if(typeof Qt>"u"||V.name!=="ErrnoError")throw V;return-V.Ka}},n:function(y,b,C){b=Xa(b,C);try{if(isNaN(b))return 61;var V=Rt(y);if((V.flags&2097155)===0)throw new Ge(28);return en(V.node,b),0}catch(ee){if(typeof Qt>"u"||ee.name!=="ErrnoError")throw ee;return-ee.Ka}},C:function(y,b){try{if(b===0)return-28;var C=Ot("/")+1;return b<C?-68:(Zt("/",te,y,b),C)}catch(V){if(typeof Qt>"u"||V.name!=="ErrnoError")throw V;return-V.Ka}},F:function(y,b){try{return y=y?K(te,y):"",fi(_n,y,b)}catch(C){if(typeof Qt>"u"||C.name!=="ErrnoError")throw C;return-C.Ka}},z:function(y,b,C){try{return b=b?K(te,b):"",b=Ir(y,b),b=ne(b),b[b.length-1]==="/"&&(b=b.substr(0,b.length-1)),le(b,C),0}catch(V){if(typeof Qt>"u"||V.name!=="ErrnoError")throw V;return-V.Ka}},E:function(y,b,C,V){try{b=b?K(te,b):"";var ee=V&256;return b=Ir(y,b,V&4096),fi(ee?_n:wt,b,C)}catch(Ee){if(typeof Qt>"u"||Ee.name!=="ErrnoError")throw Ee;return-Ee.Ka}},y:function(y,b,C,V){Rn=V;try{b=b?K(te,b):"",b=Ir(y,b);var ee=V?Ja():0;return Pn(b,C,ee).fd}catch(Ee){if(typeof Qt>"u"||Ee.name!=="ErrnoError")throw Ee;return-Ee.Ka}},w:function(y,b,C,V){try{if(b=b?K(te,b):"",b=Ir(y,b),0>=V)return-28;var ee=Jt(b),Ee=Math.min(V,Ot(ee)),je=B[C+Ee];return Zt(ee,te,C,V+1),B[C+Ee]=je,Ee}catch(st){if(typeof Qt>"u"||st.name!=="ErrnoError")throw st;return-st.Ka}},v:function(y){try{return y=y?K(te,y):"",ct(y),0}catch(b){if(typeof Qt>"u"||b.name!=="ErrnoError")throw b;return-b.Ka}},G:function(y,b){try{return y=y?K(te,y):"",fi(wt,y,b)}catch(C){if(typeof Qt>"u"||C.name!=="ErrnoError")throw C;return-C.Ka}},r:function(y,b,C){try{return b=b?K(te,b):"",b=Ir(y,b),C===0?Wt(b):C===512?ct(b):oe("Invalid flags passed to unlinkat"),0}catch(V){if(typeof Qt>"u"||V.name!=="ErrnoError")throw V;return-V.Ka}},q:function(y,b,C){try{if(b=b?K(te,b):"",b=Ir(y,b,!0),C){var V=D[C>>2]+4294967296*J[C+4>>2],ee=J[C+8>>2];Ee=1e3*V+ee/1e6,C+=16,V=D[C>>2]+4294967296*J[C+4>>2],ee=J[C+8>>2],je=1e3*V+ee/1e6}else var Ee=Date.now(),je=Ee;y=Ee;var st=gn(b,{Sa:!0}).node;return st.Ga.Oa(st,{timestamp:Math.max(y,je)}),0}catch(Dt){if(typeof Qt>"u"||Dt.name!=="ErrnoError")throw Dt;return-Dt.Ka}},l:function(y,b,C){y=new Date(1e3*Xa(y,b)),J[C>>2]=y.getSeconds(),J[C+4>>2]=y.getMinutes(),J[C+8>>2]=y.getHours(),J[C+12>>2]=y.getDate(),J[C+16>>2]=y.getMonth(),J[C+20>>2]=y.getFullYear()-1900,J[C+24>>2]=y.getDay(),b=y.getFullYear(),J[C+28>>2]=(b%4!==0||b%100===0&&b%400!==0?Wa:fo)[y.getMonth()]+y.getDate()-1|0,J[C+36>>2]=-(60*y.getTimezoneOffset()),b=new Date(y.getFullYear(),6,1).getTimezoneOffset();var V=new Date(y.getFullYear(),0,1).getTimezoneOffset();J[C+32>>2]=(b!=V&&y.getTimezoneOffset()==Math.min(V,b))|0},j:function(y,b,C,V,ee,Ee,je,st){ee=Xa(ee,Ee);try{if(isNaN(ee))return 61;var Dt=Rt(V);if((b&2)!==0&&(C&2)===0&&(Dt.flags&2097155)!==2)throw new Ge(2);if((Dt.flags&2097155)===1)throw new Ge(2);if(!Dt.Ha.bb)throw new Ge(43);var mt=Dt.Ha.bb(Dt,y,ee,b,C),an=mt.Db;return J[je>>2]=mt.ub,D[st>>2]=an,0}catch(sn){if(typeof Qt>"u"||sn.name!=="ErrnoError")throw sn;return-sn.Ka}},k:function(y,b,C,V,ee,Ee,je){Ee=Xa(Ee,je);try{if(isNaN(Ee))return 61;var st=Rt(ee);if(C&2){if((st.node.mode&61440)!==32768)throw new Ge(43);if(!(V&2)){var Dt=te.slice(y,y+b);st.Ha.cb&&st.Ha.cb(st,Dt,Ee,b,V)}}}catch(mt){if(typeof Qt>"u"||mt.name!=="ErrnoError")throw mt;return-mt.Ka}},s:(y,b,C)=>{function V(Dt){return(Dt=Dt.toTimeString().match(/\(([A-Za-z ]+)\)$/))?Dt[1]:"GMT"}var ee=new Date().getFullYear(),Ee=new Date(ee,0,1),je=new Date(ee,6,1);ee=Ee.getTimezoneOffset();var st=je.getTimezoneOffset();D[y>>2]=60*Math.max(ee,st),J[b>>2]=+(ee!=st),y=V(Ee),b=V(je),y=ho(y),b=ho(b),st<ee?(D[C>>2]=y,D[C+4>>2]=b):(D[C>>2]=b,D[C+4>>2]=y)},d:()=>Date.now(),t:()=>2147483648,c:()=>performance.now(),o:y=>{var b=te.length;if(y>>>=0,2147483648<y)return!1;for(var C=1;4>=C;C*=2){var V=b*(1+.2/C);V=Math.min(V,y+100663296);var ee=Math;V=Math.max(y,V);e:{ee=(ee.min.call(ee,2147483648,V+(65536-V%65536)%65536)-j.buffer.byteLength+65535)/65536;try{j.grow(ee),Y();var Ee=1;break e}catch{}Ee=void 0}if(Ee)return!0}return!1},A:(y,b)=>{var C=0;return _a().forEach((V,ee)=>{var Ee=b+C;for(ee=D[y+4*ee>>2]=Ee,Ee=0;Ee<V.length;++Ee)B[ee++>>0]=V.charCodeAt(Ee);B[ee>>0]=0,C+=V.length+1}),0},B:(y,b)=>{var C=_a();D[y>>2]=C.length;var V=0;return C.forEach(ee=>V+=ee.length+1),D[b>>2]=V,0},e:function(y){try{var b=Rt(y);return Ka(b),0}catch(C){if(typeof Qt>"u"||C.name!=="ErrnoError")throw C;return C.Ka}},p:function(y,b){try{var C=Rt(y);return B[b>>0]=C.tty?2:xn(C.mode)?3:(C.mode&61440)===40960?7:4,L[b+2>>1]=0,x=[0,(de=0,1<=+Math.abs(de)?0<de?+Math.floor(de/4294967296)>>>0:~~+Math.ceil((de-+(~~de>>>0))/4294967296)>>>0:0)],J[b+8>>2]=x[0],J[b+12>>2]=x[1],x=[0,(de=0,1<=+Math.abs(de)?0<de?+Math.floor(de/4294967296)>>>0:~~+Math.ceil((de-+(~~de>>>0))/4294967296)>>>0:0)],J[b+16>>2]=x[0],J[b+20>>2]=x[1],0}catch(V){if(typeof Qt>"u"||V.name!=="ErrnoError")throw V;return V.Ka}},x:function(y,b,C,V){try{e:{var ee=Rt(y);y=b;for(var Ee,je=b=0;je<C;je++){var st=D[y>>2],Dt=D[y+4>>2];y+=8;var mt=co(ee,B,st,Dt,Ee);if(0>mt){var an=-1;break e}if(b+=mt,mt<Dt)break;typeof Ee<"u"&&(Ee+=mt)}an=b}return D[V>>2]=an,0}catch(sn){if(typeof Qt>"u"||sn.name!=="ErrnoError")throw sn;return sn.Ka}},m:function(y,b,C,V,ee){b=Xa(b,C);try{if(isNaN(b))return 61;var Ee=Rt(y);return lo(Ee,b,V),x=[Ee.position>>>0,(de=Ee.position,1<=+Math.abs(de)?0<de?+Math.floor(de/4294967296)>>>0:~~+Math.ceil((de-+(~~de>>>0))/4294967296)>>>0:0)],J[ee>>2]=x[0],J[ee+4>>2]=x[1],Ee.hb&&b===0&&V===0&&(Ee.hb=null),0}catch(je){if(typeof Qt>"u"||je.name!=="ErrnoError")throw je;return je.Ka}},D:function(y){var C;try{var b=Rt(y);return(C=b.Ha)!=null&&C.fsync?b.Ha.fsync(b):0}catch(V){if(typeof Qt>"u"||V.name!=="ErrnoError")throw V;return V.Ka}},u:function(y,b,C,V){try{e:{var ee=Rt(y);y=b;for(var Ee,je=b=0;je<C;je++){var st=D[y>>2],Dt=D[y+4>>2];y+=8;var mt=jl(ee,B,st,Dt,Ee);if(0>mt){var an=-1;break e}b+=mt,typeof Ee<"u"&&(Ee+=mt)}an=b}return D[V>>2]=an,0}catch(sn){if(typeof Qt>"u"||sn.name!=="ErrnoError")throw sn;return sn.Ka}}},tt=(function(){var C;function y(V){var ee;return tt=V.exports,j=tt.I,Y(),Tn=tt.Aa,W.unshift(tt.J),R--,(ee=h.monitorRunDependencies)==null||ee.call(h,R),R==0&&re&&(V=re,re=null,V()),tt}var b={a:rs};if(R++,(C=h.monitorRunDependencies)==null||C.call(h,R),h.instantiateWasm)try{return h.instantiateWasm(b,y)}catch(V){return Q(`Module.instantiateWasm callback failed with error: ${V}`),!1}return ue(b,function(V){y(V.instance)}),{}})();h._sqlite3_free=y=>(h._sqlite3_free=tt.K)(y),h._sqlite3_value_text=y=>(h._sqlite3_value_text=tt.L)(y);var gi=()=>(gi=tt.M)();h._sqlite3_prepare_v2=(y,b,C,V,ee)=>(h._sqlite3_prepare_v2=tt.N)(y,b,C,V,ee),h._sqlite3_step=y=>(h._sqlite3_step=tt.O)(y),h._sqlite3_reset=y=>(h._sqlite3_reset=tt.P)(y),h._sqlite3_exec=(y,b,C,V,ee)=>(h._sqlite3_exec=tt.Q)(y,b,C,V,ee),h._sqlite3_finalize=y=>(h._sqlite3_finalize=tt.R)(y),h._sqlite3_column_name=(y,b)=>(h._sqlite3_column_name=tt.S)(y,b),h._sqlite3_column_text=(y,b)=>(h._sqlite3_column_text=tt.T)(y,b),h._sqlite3_column_type=(y,b)=>(h._sqlite3_column_type=tt.U)(y,b),h._sqlite3_errmsg=y=>(h._sqlite3_errmsg=tt.V)(y),h._sqlite3_clear_bindings=y=>(h._sqlite3_clear_bindings=tt.W)(y),h._sqlite3_value_blob=y=>(h._sqlite3_value_blob=tt.X)(y),h._sqlite3_value_bytes=y=>(h._sqlite3_value_bytes=tt.Y)(y),h._sqlite3_value_double=y=>(h._sqlite3_value_double=tt.Z)(y),h._sqlite3_value_int=y=>(h._sqlite3_value_int=tt._)(y),h._sqlite3_value_type=y=>(h._sqlite3_value_type=tt.$)(y),h._sqlite3_result_blob=(y,b,C,V)=>(h._sqlite3_result_blob=tt.aa)(y,b,C,V),h._sqlite3_result_double=(y,b)=>(h._sqlite3_result_double=tt.ba)(y,b),h._sqlite3_result_error=(y,b,C)=>(h._sqlite3_result_error=tt.ca)(y,b,C),h._sqlite3_result_int=(y,b)=>(h._sqlite3_result_int=tt.da)(y,b),h._sqlite3_result_int64=(y,b,C)=>(h._sqlite3_result_int64=tt.ea)(y,b,C),h._sqlite3_result_null=y=>(h._sqlite3_result_null=tt.fa)(y),h._sqlite3_result_text=(y,b,C,V)=>(h._sqlite3_result_text=tt.ga)(y,b,C,V),h._sqlite3_aggregate_context=(y,b)=>(h._sqlite3_aggregate_context=tt.ha)(y,b),h._sqlite3_column_count=y=>(h._sqlite3_column_count=tt.ia)(y),h._sqlite3_data_count=y=>(h._sqlite3_data_count=tt.ja)(y),h._sqlite3_column_blob=(y,b)=>(h._sqlite3_column_blob=tt.ka)(y,b),h._sqlite3_column_bytes=(y,b)=>(h._sqlite3_column_bytes=tt.la)(y,b),h._sqlite3_column_double=(y,b)=>(h._sqlite3_column_double=tt.ma)(y,b),h._sqlite3_bind_blob=(y,b,C,V,ee)=>(h._sqlite3_bind_blob=tt.na)(y,b,C,V,ee),h._sqlite3_bind_double=(y,b,C)=>(h._sqlite3_bind_double=tt.oa)(y,b,C),h._sqlite3_bind_int=(y,b,C)=>(h._sqlite3_bind_int=tt.pa)(y,b,C),h._sqlite3_bind_text=(y,b,C,V,ee)=>(h._sqlite3_bind_text=tt.qa)(y,b,C,V,ee),h._sqlite3_bind_parameter_index=(y,b)=>(h._sqlite3_bind_parameter_index=tt.ra)(y,b),h._sqlite3_sql=y=>(h._sqlite3_sql=tt.sa)(y),h._sqlite3_normalized_sql=y=>(h._sqlite3_normalized_sql=tt.ta)(y),h._sqlite3_changes=y=>(h._sqlite3_changes=tt.ua)(y),h._sqlite3_close_v2=y=>(h._sqlite3_close_v2=tt.va)(y),h._sqlite3_create_function_v2=(y,b,C,V,ee,Ee,je,st,Dt)=>(h._sqlite3_create_function_v2=tt.wa)(y,b,C,V,ee,Ee,je,st,Dt),h._sqlite3_open=(y,b)=>(h._sqlite3_open=tt.xa)(y,b);var Ms=h._malloc=y=>(Ms=h._malloc=tt.ya)(y),oa=h._free=y=>(oa=h._free=tt.za)(y);h._RegisterExtensionFunctions=y=>(h._RegisterExtensionFunctions=tt.Ba)(y);var Rr=(y,b)=>(Rr=tt.Ca)(y,b),Ea=()=>(Ea=tt.Da)(),Qr=y=>(Qr=tt.Ea)(y),Mn=y=>(Mn=tt.Fa)(y);h.stackAlloc=Mn,h.stackSave=Ea,h.stackRestore=Qr,h.cwrap=(y,b,C,V)=>{var ee=!C||C.every(Ee=>Ee==="number"||Ee==="boolean");return b!=="string"&&ee&&!V?h["_"+y]:function(){return Il(y,b,C,arguments)}},h.addFunction=ns,h.removeFunction=ia,h.UTF8ToString=ye,h.ALLOC_NORMAL=es,h.allocate=pi,h.allocateUTF8OnStack=mi;var as;re=function y(){as||Us(),as||(re=y)};function Us(){function y(){if(!as&&(as=!0,h.calledRun=!0,!O)){if(h.noFSInit||jr||(jr=!0,Rs(),h.stdin=h.stdin,h.stdout=h.stdout,h.stderr=h.stderr,h.stdin?Dn("stdin",h.stdin):$e("/dev/tty","/dev/stdin"),h.stdout?Dn("stdout",null,h.stdout):$e("/dev/tty","/dev/stdout"),h.stderr?Dn("stderr",null,h.stderr):$e("/dev/tty1","/dev/stderr"),Pn("/dev/stdin",0),Pn("/dev/stdout",1),Pn("/dev/stderr",1)),Zr=!1,se(W),h.onRuntimeInitialized&&h.onRuntimeInitialized(),h.postRun)for(typeof h.postRun=="function"&&(h.postRun=[h.postRun]);h.postRun.length;){var b=h.postRun.shift();be.unshift(b)}se(be)}}if(!(0<R)){if(h.preRun)for(typeof h.preRun=="function"&&(h.preRun=[h.preRun]);h.preRun.length;)z();se(me),0<R||(h.setStatus?(h.setStatus("Running..."),setTimeout(function(){setTimeout(function(){h.setStatus("")},1),y()},1)):y())}}if(h.preInit)for(typeof h.preInit=="function"&&(h.preInit=[h.preInit]);0<h.preInit.length;)h.preInit.pop()();return Us(),m}),s)};n.exports=i,n.exports.default=i})(vh)),vh.exports}var yk=gk();const vk=io(yk);function bk(n){return new Promise((a,s)=>{const i=new Worker(new URL("/assets/ankiImport.worker-DXXYc2v4.js",import.meta.url),{type:"module"});i.onmessage=l=>{const{status:c,decks:d,error:m}=l.data;c==="success"?a(d):s(new Error(m)),i.terminate()},i.onerror=l=>{console.error("Worker error:",l);const c=l.message||"The worker script could not be loaded or an unexpected error occurred.";s(new Error(`Anki import worker failed: ${c}`)),i.terminate()},i.postMessage(n,[n])})}let xh=null;async function xk(){return xh||(xh=await vk({locateFile:n=>`https://esm.sh/sql.js@1.10.3/dist/${n}`})),xh}function ub(n,a){let s=n;return s=s.replace(/<img\s[^>]*?src=(["'])(.*?)\1[^>]*?>/gi,(i,l,c)=>{const d=decodeURIComponent(c),m=a.get(d);if(m){const p=btoa(new Uint8Array(m.data).reduce((v,S)=>v+String.fromCharCode(S),"")),h=`src="data:${m.type};base64,${p}"`;return i.replace(/src=(["']).*?\1/i,h)}return i}),s=s.replace(/\[sound:(.*?)\]/g,(i,l)=>{const c=decodeURIComponent(l.trim()),d=a.get(c);if(d){const m=btoa(new Uint8Array(d.data).reduce((p,h)=>p+String.fromCharCode(h),""));return d.type.startsWith("video/")?`<video controls playsinline src="data:${d.type};base64,${m}"></video>`:`<audio controls src="data:${d.type};base64,${m}"></audio>`}return""}),s}function db(n,a,s,i,l){let c=n;const d=/{{c(\d+)::(.*?)(?:::(.*?))?}}/gs;c=c.replace(d,(v,S,A,_)=>{const E=parseInt(S,10);return i?E===s+1?`<span class="cloze">[${_||"..."}]</span>`:`<span class="cloze-inactive">${A}</span>`:E===s+1?`<span class="cloze"><b>${A}</b></span>`:`<span class="cloze-inactive">${A}</span>`}),l&&(c=c.replace(/<hr id=answer>/g,"").replace(/{{FrontSide}}/g,l));const m=/{{#([^}]+?)}}(.*?){{\/\1}}/gs;let p;do p=c,c=c.replace(m,(v,S,A)=>{const _=a.get(S.trim());return _&&_.trim()!==""?A:""});while(c!==p);const h=/{{\^([^}]+?)}}(.*?){{\/\1}}/gs;do p=c,c=c.replace(h,(v,S,A)=>{const _=a.get(S.trim());return!_||_.trim()===""?A:""});while(c!==p);return a.forEach((v,S)=>{const A=new RegExp(`{{${S}}}`,"g");c=c.replace(A,v)}),c=c.replace(/{{(.*?)}}/g,""),c}async function _k(n){var F;const a=await xk(),s=await qh.loadAsync(n),i=s.file(/collection.anki2[1]?/);if(!i||i.length===0)throw new Error("collection.anki2 or .anki21 file not found.");const l=await i[0].async("uint8array"),c=new a.Database(l),d=s.file("media");let m={};if(d)try{m=JSON.parse(await d.async("string"))}catch(q){console.warn("Could not parse media file.",q)}const p=new Map;for(const q in m){const Q=m[q],U=s.file(q);if(U){const j=await U.async("uint8array"),O=((F=Q.split(".").pop())==null?void 0:F.toLowerCase())||"";let B="application/octet-stream";["jpg","jpeg"].includes(O)?B="image/jpeg":O==="png"?B="image/png":O==="gif"?B="image/gif":O==="svg"?B="image/svg+xml":O==="mp3"?B="audio/mpeg":O==="ogg"?B="audio/ogg":O==="wav"?B="audio/wav":O==="m4a"?B="audio/mp4":O==="opus"?B="audio/opus":O==="mp4"?B="video/mp4":O==="webm"?B="video/webm":O==="ogv"&&(B="video/ogg"),p.set(Q,{data:j,type:B})}}const h=c.exec("SELECT models, decks, crt FROM col");if(!h[0])throw new Error("Could not read collection data.");const[v,S,A]=h[0].values[0],_=JSON.parse(v),E=JSON.parse(S),w=c.exec("SELECT id, mid, flds FROM notes"),k=new Map(w[0].values.map(q=>[q[0],{mid:q[1],flds:q[2].split("")}])),I=c.exec("SELECT id, nid, did, ord, due, ivl, factor, type, lapses FROM cards")[0].values,M=new Map;for(const q in E){const Q=E[q];M.set(q,{id:crypto.randomUUID(),name:Q.name,description:Q.desc||"Imported Anki deck.",type:Ne.Flashcard,cards:[]})}for(const q of I){const[Q,U,j,O,B,te,L,J,D]=q,ie=k.get(U);if(!ie)continue;const Z=_[ie.mid];if(!(Z!=null&&Z.tmpls))continue;const Y=M.get(j.toString());if(!Y)continue;const me=Z.tmpls[O];if(!me)continue;const W=new Map((Z.flds||[]).map((he,fe)=>[he.name,ie.flds[fe]||""]));let be=db(me.qfmt,W,O,!0),z=db(me.afmt,W,O,!1,be);be=ub(be,p),z=ub(z,p);let R,re;J===2&&te>0?(R=new Date(A*1e3),R.setDate(R.getDate()+B),re=new Date(R.getTime()),re.setDate(re.getDate()-te)):(R=new Date,R.setHours(0,0,0,0));const oe=Math.min(1,Math.log1p(te)/Math.log1p(90));Y.cards.push({id:Q.toString(),front:be,back:z,css:Z.css?`<style>${Z.css}</style>`:"",dueDate:R.toISOString(),interval:te,easeFactor:L?Math.max(L/1e3,Sh):wr,masteryLevel:oe,lastReviewed:re==null?void 0:re.toISOString(),lapses:D||0})}return c.close(),Array.from(M.values()).filter(q=>q.cards.length>0)}const Sk=n=>{const{dispatch:a}=Ke(),{openModal:s,closeModal:i}=Cl(),{addToast:l}=Nn(),{navigate:c}=Pa(),d=tk({...n,addToast:l,openModal:s,closeModal:i,dispatch:a}),{triggerSync:m}=d,p=K2({triggerSync:m,openConfirmModal:E=>s("confirm",E)}),h=J2({triggerSync:m,handleAddDecks:p.handleAddDecks,handleUpdateDeck:p.handleUpdateDeck}),v=ek({...n,handleUpdateDeck:p.handleUpdateDeck}),S=fk({...n,openConfirmModal:E=>s("confirm",E),openRestoreFromDriveModal:()=>s("restoreFromDrive"),onRestoreData:d.onRestoreData}),A=hk({handleUpdateDeck:p.handleUpdateDeck,handleAddDecks:p.handleAddDecks,handleAddSeriesWithDecks:h.handleAddSeriesWithDecks,handleUpdateSeries:h.handleUpdateSeries,openConfirmModal:E=>s("confirm",E),openModal:s,closeModal:i}),_=G.useCallback(async(E,w={})=>{if(i(),!E)return;const{deckName:k,imageHint:N}=w;try{if(E.type==="series"){const{seriesName:I,seriesDescription:M,levels:F}=E.data,q=[],Q=(F||[]).map(j=>{const O=(j.decks||[]).map(B=>B.type==="quiz"?{id:crypto.randomUUID(),name:B.name,description:B.description,type:Ne.Quiz,questions:qr(B.questions||[])}:B.type==="flashcard"?{id:crypto.randomUUID(),name:B.name,description:B.description,type:Ne.Flashcard,cards:ha(B.cards||[])}:null).filter(B=>B!==null);return q.push(...O),{title:j.title,deckIds:O.map(B=>B.id)}}),U={id:crypto.randomUUID(),type:"series",name:I,description:M,levels:Q,archived:!1,createdAt:new Date().toISOString()};await h.handleAddSeriesWithDecks(U,q)}else if(E.type==="quiz"){const I={id:crypto.randomUUID(),name:k||E.data.name,description:E.data.description,type:Ne.Quiz,questions:qr(E.data.questions)};await p.handleAddDecks([I]),l(`Deck "${I.name}" imported successfully.`,"success")}else if(E.type==="learning"){const I={id:crypto.randomUUID(),name:k||E.data.name,description:E.data.description||"",type:Ne.Learning,infoCards:E.data.infoCards||[],questions:qr(E.data.questions||[]),learningMode:E.data.learningMode||"separate"};await p.handleAddDecks([I]),l(`Learning Deck "${I.name}" imported successfully.`,"success")}else if(E.type==="flashcard"){if(!k){l("Deck name is required for flashcard import.","error");return}const I=ha(E.data),M={id:crypto.randomUUID(),name:k,type:Ne.Flashcard,cards:I,description:`${I.length} imported flashcard${I.length===1?"":"s"}.`};await p.handleAddDecks([M]),l(`Deck "${M.name}" imported successfully.`,"success")}else if(E.type==="anki"&&E.file){l("Processing Anki package...","info");const I=await E.file.arrayBuffer();let M=[];try{M=await bk(I)}catch(F){console.warn("Anki worker failed, trying fallback:",F);const q=await E.file.arrayBuffer();M=await _k(q)}M.length>0?(await p.handleAddDecks(M),l(`Successfully imported ${M.length} deck(s) from Anki package.`,"success")):l("No valid decks found in the Anki package.","error")}else if(E.type==="image"&&E.file){l("Analyzing image with AI...","info");const I=new FileReader;I.readAsDataURL(E.file),I.onload=async()=>{try{const M=I.result.split(",")[1],{name:F,description:q,cards:Q}=await e0(M,E.file.type,N),U={id:crypto.randomUUID(),name:F||`Image Deck - ${E.file.name}`,description:q||`Generated from ${E.file.name}`,type:Ne.Flashcard,cards:ha(Q)};await p.handleAddDecks([U]),l(`Deck "${U.name}" generated successfully.`,"success")}catch(M){console.error(M),l(`Image generation failed: ${M.message}`,"error")}},I.onerror=()=>l("Failed to read image file.","error")}else E.type==="backup"&&E.data&&await d.onRestoreData(E.data)}catch(I){l(I.message,"error")}},[h,p,d,l,i]);return G.useMemo(()=>({...n,...p,...h,...v,...d,...S,...A,openModal:s,closeModal:i,handleDroppedFileConfirm:_,openConfirmModal:E=>s("confirm",E),addToast:l}),[n,p,h,v,d,S,A,s,i,_,l])},wk=({children:n})=>{const{path:a}=Pa(),{dispatch:s,decks:i,deckSeries:l}=Ke(),{addToast:c}=Nn(),{openModal:d}=Cl(),{backupEnabled:m}=ii(),[p,h]=G.useState(!1),[v,S]=G.useState("Not synced"),[A,_]=G.useState(new Set),[E,w]=G.useState(null),[k,N]=G.useState("recent"),[I,M]=G.useState(null),[F,q]=G.useState(new Set),Q=Y=>{q(me=>{const W=new Set(me);return W.has(Y)?W.delete(Y):W.add(Y),W})},[U,j]=G.useState(!1),[O,B]=G.useState(!1),[te,L]=G.useState(null),J=G.useCallback(async()=>{try{const[Y,me,W,be,z,R,re]=await Promise.all([Xt.getAllDecks(),Xt.getAllFolders(),Xt.getAllDeckSeries(),Xt.getAllSeriesProgress(),Xt.getAllLearningProgress(),Xt.getAIChatHistory(),Xt.getAllSessionKeys()]),oe=new Map;Object.entries(be).forEach(([fe,Me])=>{oe.set(fe,new Set(Me))}),s({type:"LOAD_DATA",payload:{decks:Y,folders:me,deckSeries:W}}),s({type:"SET_SERIES_PROGRESS",payload:oe}),s({type:"SET_LEARNING_PROGRESS",payload:z}),s({type:"SET_AI_CHAT_HISTORY",payload:R});const he=new Set;re.forEach(fe=>{fe.startsWith("session_deck_")&&he.add(fe.replace("session_deck_",""))}),_(he)}catch(Y){console.error("Critical error during data initialization:",Y),c("Failed to load your data. Please check browser permissions and reload.","error")}},[s,c]);G.useEffect(()=>{J();const Y=eE(()=>{console.log("Data changed in another tab, reloading..."),J()});return()=>{Y()}},[J]),G.useEffect(()=>{const Y=sk(j),me=ik((W,be)=>{B(W),L(be||null)});return()=>{Y(),me()}},[]);const D=G.useMemo(()=>{const Y=a.match(/^\/decks\/([^/?]+)/);return Y?i[Y[1]]:null},[a,i]),ie=G.useMemo(()=>{const Y=a.match(/^\/series\/([^/?]+)/);return Y?l[Y[1]]:null},[a,l]),Z=Sk({activeDeck:D,activeSeries:ie,generalStudyDeck:E,setGeneralStudyDeck:w,sessionsToResume:A,setSessionsToResume:_,isSyncing:p,setIsSyncing:h,lastSyncStatus:v,setLastSyncStatus:S,backupEnabled:m,isGapiReady:U,isGapiSignedIn:O,gapiUser:te,sortPreference:k,setSortPreference:N,draggedDeckId:I,setDraggedDeckId:M,openFolderIds:F,onToggleFolder:Q});return u.jsx(j_,{value:Z,children:n})};function k0(n,a,s={}){const i=a instanceof Error;console.groupCollapsed(`%c[${n}] ${i?a.message:"An error occurred"}`,"color: red; font-weight: bold;"),console.error(a),Object.keys(s).length>0&&console.log("Additional Info:",s),i&&a.stack&&console.log("Stack Trace:",a.stack),console.groupEnd()}window.addEventListener("error",n=>{k0("Unhandled Global Error",n.error||n.message,{message:n.message,filename:n.filename,lineno:n.lineno,colno:n.colno})});window.addEventListener("unhandledrejection",n=>{k0("Unhandled Promise Rejection",n.reason)});const T0=document.getElementById("root");if(!T0)throw new Error("Could not find root element to mount to");const Ek=u_.createRoot(T0);Ek.render(u.jsx(Wi.StrictMode,{children:u.jsx(q2,{children:u.jsx(Fw,{children:u.jsx(L_,{children:u.jsx(M_,{children:u.jsx(nS,{children:u.jsx(wk,{children:u.jsx(G2,{children:u.jsx(H2,{})})})})})})})})}));export{Gw as A,qe as B,Yw as C,S0 as D,Pa as E,Lh as F,ll as G,kk as H,ze as I,Ak as J,ha as K,ea as L,qr as M,RE as N,Uh as O,N_ as P,C_ as Q,Sr as R,$r as S,Cl as T,DE as U,Nn as a,Nk as b,On as c,Ke as d,Ne as e,gE as f,W2 as g,xE as h,oo as i,u as j,pE as k,jk as l,Dk as m,Ok as n,Xc as o,Ck as p,Wc as q,G as r,ml as s,no as t,ii as u,eu as v,Wi as w,Tk as x,wr as y,ln as z};
