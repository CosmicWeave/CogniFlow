const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/StudySession-C_65d3xF.js","assets/MasteryBar-DwmeWyCF.js","assets/ProgressBar-CYETKUCm.js","assets/useKeyboardShortcuts-BOc8y4wx.js","assets/ReaderSession-Bk0rZ_BY.js","assets/DeckDetailsPage-CpZRUDPK.js","assets/TruncatedText-bWIIOVrb.js","assets/SeriesOverviewPage-DZl4cgEk.js","assets/DeckListItem-DmB3d2g6.js","assets/DashboardPage-BMD4tPmZ.js","assets/SeriesListItem-Ds8D_cW7.js","assets/AllDecksPage-BOu3D0l2.js","assets/DeckSortControl-DGoLPL46.js","assets/AllSeriesPage-CneIUalb.js"])))=>i.map(i=>d[i]);
(function(){const a=document.createElement("link").relList;if(a&&a.supports&&a.supports("modulepreload"))return;for(const c of document.querySelectorAll('link[rel="modulepreload"]'))i(c);new MutationObserver(c=>{for(const u of c)if(u.type==="childList")for(const f of u.addedNodes)f.tagName==="LINK"&&f.rel==="modulepreload"&&i(f)}).observe(document,{childList:!0,subtree:!0});function s(c){const u={};return c.integrity&&(u.integrity=c.integrity),c.referrerPolicy&&(u.referrerPolicy=c.referrerPolicy),c.crossOrigin==="use-credentials"?u.credentials="include":c.crossOrigin==="anonymous"?u.credentials="omit":u.credentials="same-origin",u}function i(c){if(c.ep)return;c.ep=!0;const u=s(c);fetch(c.href,u)}})();var mc=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Co(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}function Xx(n){if(Object.prototype.hasOwnProperty.call(n,"__esModule"))return n;var a=n.default;if(typeof a=="function"){var s=function i(){return this instanceof i?Reflect.construct(a,arguments,this.constructor):a.apply(this,arguments)};s.prototype=a.prototype}else s={};return Object.defineProperty(s,"__esModule",{value:!0}),Object.keys(n).forEach(function(i){var c=Object.getOwnPropertyDescriptor(n,i);Object.defineProperty(s,i,c.get?c:{enumerable:!0,get:function(){return n[i]}})}),s}var ch={exports:{}},ic={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var yy;function Wx(){if(yy)return ic;yy=1;var n=Symbol.for("react.transitional.element"),a=Symbol.for("react.fragment");function s(i,c,u){var f=null;if(u!==void 0&&(f=""+u),c.key!==void 0&&(f=""+c.key),"key"in c){u={};for(var p in c)p!=="key"&&(u[p]=c[p])}else u=c;return c=u.ref,{$$typeof:n,type:i,key:f,ref:c!==void 0?c:null,props:u}}return ic.Fragment=a,ic.jsx=s,ic.jsxs=s,ic}var vy;function e_(){return vy||(vy=1,ch.exports=Wx()),ch.exports}var l=e_(),uh={exports:{}},Jt={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var by;function t_(){if(by)return Jt;by=1;var n=Symbol.for("react.transitional.element"),a=Symbol.for("react.portal"),s=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),c=Symbol.for("react.profiler"),u=Symbol.for("react.consumer"),f=Symbol.for("react.context"),p=Symbol.for("react.forward_ref"),b=Symbol.for("react.suspense"),m=Symbol.for("react.memo"),_=Symbol.for("react.lazy"),E=Symbol.for("react.activity"),N=Symbol.iterator;function S(T){return T===null||typeof T!="object"?null:(T=N&&T[N]||T["@@iterator"],typeof T=="function"?T:null)}var I={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},A=Object.assign,k={};function R(T,z,ne){this.props=T,this.context=z,this.refs=k,this.updater=ne||I}R.prototype.isReactComponent={},R.prototype.setState=function(T,z){if(typeof T!="object"&&typeof T!="function"&&T!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,T,z,"setState")},R.prototype.forceUpdate=function(T){this.updater.enqueueForceUpdate(this,T,"forceUpdate")};function P(){}P.prototype=R.prototype;function q(T,z,ne){this.props=T,this.context=z,this.refs=k,this.updater=ne||I}var G=q.prototype=new P;G.constructor=q,A(G,R.prototype),G.isPureReactComponent=!0;var Y=Array.isArray;function W(){}var H={H:null,A:null,T:null,S:null},L=Object.prototype.hasOwnProperty;function U(T,z,ne){var se=ne.ref;return{$$typeof:n,type:T,key:z,ref:se!==void 0?se:null,props:ne}}function Q(T,z){return U(T.type,z,T.props)}function le(T){return typeof T=="object"&&T!==null&&T.$$typeof===n}function F(T){var z={"=":"=0",":":"=2"};return"$"+T.replace(/[=:]/g,function(ne){return z[ne]})}var te=/\/+/g;function j(T,z){return typeof T=="object"&&T!==null&&T.key!=null?F(""+T.key):z.toString(36)}function he(T){switch(T.status){case"fulfilled":return T.value;case"rejected":throw T.reason;default:switch(typeof T.status=="string"?T.then(W,W):(T.status="pending",T.then(function(z){T.status==="pending"&&(T.status="fulfilled",T.value=z)},function(z){T.status==="pending"&&(T.status="rejected",T.reason=z)})),T.status){case"fulfilled":return T.value;case"rejected":throw T.reason}}throw T}function J(T,z,ne,se,ue){var de=typeof T;(de==="undefined"||de==="boolean")&&(T=null);var oe=!1;if(T===null)oe=!0;else switch(de){case"bigint":case"string":case"number":oe=!0;break;case"object":switch(T.$$typeof){case n:case a:oe=!0;break;case _:return oe=T._init,J(oe(T._payload),z,ne,se,ue)}}if(oe)return ue=ue(T),oe=se===""?"."+j(T,0):se,Y(ue)?(ne="",oe!=null&&(ne=oe.replace(te,"$&/")+"/"),J(ue,z,ne,"",function(We){return We})):ue!=null&&(le(ue)&&(ue=Q(ue,ne+(ue.key==null||T&&T.key===ue.key?"":(""+ue.key).replace(te,"$&/")+"/")+oe)),z.push(ue)),1;oe=0;var ye=se===""?".":se+":";if(Y(T))for(var ie=0;ie<T.length;ie++)se=T[ie],de=ye+j(se,ie),oe+=J(se,z,ne,de,ue);else if(ie=S(T),typeof ie=="function")for(T=ie.call(T),ie=0;!(se=T.next()).done;)se=se.value,de=ye+j(se,ie++),oe+=J(se,z,ne,de,ue);else if(de==="object"){if(typeof T.then=="function")return J(he(T),z,ne,se,ue);throw z=String(T),Error("Objects are not valid as a React child (found: "+(z==="[object Object]"?"object with keys {"+Object.keys(T).join(", ")+"}":z)+"). If you meant to render a collection of children, use an array instead.")}return oe}function Z(T,z,ne){if(T==null)return T;var se=[],ue=0;return J(T,se,"","",function(de){return z.call(ne,de,ue++)}),se}function De(T){if(T._status===-1){var z=T._result;z=z(),z.then(function(ne){(T._status===0||T._status===-1)&&(T._status=1,T._result=ne)},function(ne){(T._status===0||T._status===-1)&&(T._status=2,T._result=ne)}),T._status===-1&&(T._status=0,T._result=z)}if(T._status===1)return T._result.default;throw T._result}var ve=typeof reportError=="function"?reportError:function(T){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var z=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof T=="object"&&T!==null&&typeof T.message=="string"?String(T.message):String(T),error:T});if(!window.dispatchEvent(z))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",T);return}console.error(T)},Be={map:Z,forEach:function(T,z,ne){Z(T,function(){z.apply(this,arguments)},ne)},count:function(T){var z=0;return Z(T,function(){z++}),z},toArray:function(T){return Z(T,function(z){return z})||[]},only:function(T){if(!le(T))throw Error("React.Children.only expected to receive a single React element child.");return T}};return Jt.Activity=E,Jt.Children=Be,Jt.Component=R,Jt.Fragment=s,Jt.Profiler=c,Jt.PureComponent=q,Jt.StrictMode=i,Jt.Suspense=b,Jt.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=H,Jt.__COMPILER_RUNTIME={__proto__:null,c:function(T){return H.H.useMemoCache(T)}},Jt.cache=function(T){return function(){return T.apply(null,arguments)}},Jt.cacheSignal=function(){return null},Jt.cloneElement=function(T,z,ne){if(T==null)throw Error("The argument must be a React element, but you passed "+T+".");var se=A({},T.props),ue=T.key;if(z!=null)for(de in z.key!==void 0&&(ue=""+z.key),z)!L.call(z,de)||de==="key"||de==="__self"||de==="__source"||de==="ref"&&z.ref===void 0||(se[de]=z[de]);var de=arguments.length-2;if(de===1)se.children=ne;else if(1<de){for(var oe=Array(de),ye=0;ye<de;ye++)oe[ye]=arguments[ye+2];se.children=oe}return U(T.type,ue,se)},Jt.createContext=function(T){return T={$$typeof:f,_currentValue:T,_currentValue2:T,_threadCount:0,Provider:null,Consumer:null},T.Provider=T,T.Consumer={$$typeof:u,_context:T},T},Jt.createElement=function(T,z,ne){var se,ue={},de=null;if(z!=null)for(se in z.key!==void 0&&(de=""+z.key),z)L.call(z,se)&&se!=="key"&&se!=="__self"&&se!=="__source"&&(ue[se]=z[se]);var oe=arguments.length-2;if(oe===1)ue.children=ne;else if(1<oe){for(var ye=Array(oe),ie=0;ie<oe;ie++)ye[ie]=arguments[ie+2];ue.children=ye}if(T&&T.defaultProps)for(se in oe=T.defaultProps,oe)ue[se]===void 0&&(ue[se]=oe[se]);return U(T,de,ue)},Jt.createRef=function(){return{current:null}},Jt.forwardRef=function(T){return{$$typeof:p,render:T}},Jt.isValidElement=le,Jt.lazy=function(T){return{$$typeof:_,_payload:{_status:-1,_result:T},_init:De}},Jt.memo=function(T,z){return{$$typeof:m,type:T,compare:z===void 0?null:z}},Jt.startTransition=function(T){var z=H.T,ne={};H.T=ne;try{var se=T(),ue=H.S;ue!==null&&ue(ne,se),typeof se=="object"&&se!==null&&typeof se.then=="function"&&se.then(W,ve)}catch(de){ve(de)}finally{z!==null&&ne.types!==null&&(z.types=ne.types),H.T=z}},Jt.unstable_useCacheRefresh=function(){return H.H.useCacheRefresh()},Jt.use=function(T){return H.H.use(T)},Jt.useActionState=function(T,z,ne){return H.H.useActionState(T,z,ne)},Jt.useCallback=function(T,z){return H.H.useCallback(T,z)},Jt.useContext=function(T){return H.H.useContext(T)},Jt.useDebugValue=function(){},Jt.useDeferredValue=function(T,z){return H.H.useDeferredValue(T,z)},Jt.useEffect=function(T,z){return H.H.useEffect(T,z)},Jt.useEffectEvent=function(T){return H.H.useEffectEvent(T)},Jt.useId=function(){return H.H.useId()},Jt.useImperativeHandle=function(T,z,ne){return H.H.useImperativeHandle(T,z,ne)},Jt.useInsertionEffect=function(T,z){return H.H.useInsertionEffect(T,z)},Jt.useLayoutEffect=function(T,z){return H.H.useLayoutEffect(T,z)},Jt.useMemo=function(T,z){return H.H.useMemo(T,z)},Jt.useOptimistic=function(T,z){return H.H.useOptimistic(T,z)},Jt.useReducer=function(T,z,ne){return H.H.useReducer(T,z,ne)},Jt.useRef=function(T){return H.H.useRef(T)},Jt.useState=function(T){return H.H.useState(T)},Jt.useSyncExternalStore=function(T,z,ne){return H.H.useSyncExternalStore(T,z,ne)},Jt.useTransition=function(){return H.H.useTransition()},Jt.version="19.2.3",Jt}var xy;function Lc(){return xy||(xy=1,uh.exports=t_()),uh.exports}var $=Lc();const Yi=Co($);var dh={exports:{}},oc={},fh={exports:{}},hh={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var _y;function n_(){return _y||(_y=1,(function(n){function a(J,Z){var De=J.length;J.push(Z);e:for(;0<De;){var ve=De-1>>>1,Be=J[ve];if(0<c(Be,Z))J[ve]=Z,J[De]=Be,De=ve;else break e}}function s(J){return J.length===0?null:J[0]}function i(J){if(J.length===0)return null;var Z=J[0],De=J.pop();if(De!==Z){J[0]=De;e:for(var ve=0,Be=J.length,T=Be>>>1;ve<T;){var z=2*(ve+1)-1,ne=J[z],se=z+1,ue=J[se];if(0>c(ne,De))se<Be&&0>c(ue,ne)?(J[ve]=ue,J[se]=De,ve=se):(J[ve]=ne,J[z]=De,ve=z);else if(se<Be&&0>c(ue,De))J[ve]=ue,J[se]=De,ve=se;else break e}}return Z}function c(J,Z){var De=J.sortIndex-Z.sortIndex;return De!==0?De:J.id-Z.id}if(n.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var u=performance;n.unstable_now=function(){return u.now()}}else{var f=Date,p=f.now();n.unstable_now=function(){return f.now()-p}}var b=[],m=[],_=1,E=null,N=3,S=!1,I=!1,A=!1,k=!1,R=typeof setTimeout=="function"?setTimeout:null,P=typeof clearTimeout=="function"?clearTimeout:null,q=typeof setImmediate<"u"?setImmediate:null;function G(J){for(var Z=s(m);Z!==null;){if(Z.callback===null)i(m);else if(Z.startTime<=J)i(m),Z.sortIndex=Z.expirationTime,a(b,Z);else break;Z=s(m)}}function Y(J){if(A=!1,G(J),!I)if(s(b)!==null)I=!0,W||(W=!0,F());else{var Z=s(m);Z!==null&&he(Y,Z.startTime-J)}}var W=!1,H=-1,L=5,U=-1;function Q(){return k?!0:!(n.unstable_now()-U<L)}function le(){if(k=!1,W){var J=n.unstable_now();U=J;var Z=!0;try{e:{I=!1,A&&(A=!1,P(H),H=-1),S=!0;var De=N;try{t:{for(G(J),E=s(b);E!==null&&!(E.expirationTime>J&&Q());){var ve=E.callback;if(typeof ve=="function"){E.callback=null,N=E.priorityLevel;var Be=ve(E.expirationTime<=J);if(J=n.unstable_now(),typeof Be=="function"){E.callback=Be,G(J),Z=!0;break t}E===s(b)&&i(b),G(J)}else i(b);E=s(b)}if(E!==null)Z=!0;else{var T=s(m);T!==null&&he(Y,T.startTime-J),Z=!1}}break e}finally{E=null,N=De,S=!1}Z=void 0}}finally{Z?F():W=!1}}}var F;if(typeof q=="function")F=function(){q(le)};else if(typeof MessageChannel<"u"){var te=new MessageChannel,j=te.port2;te.port1.onmessage=le,F=function(){j.postMessage(null)}}else F=function(){R(le,0)};function he(J,Z){H=R(function(){J(n.unstable_now())},Z)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(J){J.callback=null},n.unstable_forceFrameRate=function(J){0>J||125<J?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):L=0<J?Math.floor(1e3/J):5},n.unstable_getCurrentPriorityLevel=function(){return N},n.unstable_next=function(J){switch(N){case 1:case 2:case 3:var Z=3;break;default:Z=N}var De=N;N=Z;try{return J()}finally{N=De}},n.unstable_requestPaint=function(){k=!0},n.unstable_runWithPriority=function(J,Z){switch(J){case 1:case 2:case 3:case 4:case 5:break;default:J=3}var De=N;N=J;try{return Z()}finally{N=De}},n.unstable_scheduleCallback=function(J,Z,De){var ve=n.unstable_now();switch(typeof De=="object"&&De!==null?(De=De.delay,De=typeof De=="number"&&0<De?ve+De:ve):De=ve,J){case 1:var Be=-1;break;case 2:Be=250;break;case 5:Be=1073741823;break;case 4:Be=1e4;break;default:Be=5e3}return Be=De+Be,J={id:_++,callback:Z,priorityLevel:J,startTime:De,expirationTime:Be,sortIndex:-1},De>ve?(J.sortIndex=De,a(m,J),s(b)===null&&J===s(m)&&(A?(P(H),H=-1):A=!0,he(Y,De-ve))):(J.sortIndex=Be,a(b,J),I||S||(I=!0,W||(W=!0,F()))),J},n.unstable_shouldYield=Q,n.unstable_wrapCallback=function(J){var Z=N;return function(){var De=N;N=Z;try{return J.apply(this,arguments)}finally{N=De}}}})(hh)),hh}var wy;function r_(){return wy||(wy=1,fh.exports=n_()),fh.exports}var ph={exports:{}},ta={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Sy;function a_(){if(Sy)return ta;Sy=1;var n=Lc();function a(b){var m="https://react.dev/errors/"+b;if(1<arguments.length){m+="?args[]="+encodeURIComponent(arguments[1]);for(var _=2;_<arguments.length;_++)m+="&args[]="+encodeURIComponent(arguments[_])}return"Minified React error #"+b+"; visit "+m+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function s(){}var i={d:{f:s,r:function(){throw Error(a(522))},D:s,C:s,L:s,m:s,X:s,S:s,M:s},p:0,findDOMNode:null},c=Symbol.for("react.portal");function u(b,m,_){var E=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:c,key:E==null?null:""+E,children:b,containerInfo:m,implementation:_}}var f=n.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function p(b,m){if(b==="font")return"";if(typeof m=="string")return m==="use-credentials"?m:""}return ta.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=i,ta.createPortal=function(b,m){var _=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!m||m.nodeType!==1&&m.nodeType!==9&&m.nodeType!==11)throw Error(a(299));return u(b,m,null,_)},ta.flushSync=function(b){var m=f.T,_=i.p;try{if(f.T=null,i.p=2,b)return b()}finally{f.T=m,i.p=_,i.d.f()}},ta.preconnect=function(b,m){typeof b=="string"&&(m?(m=m.crossOrigin,m=typeof m=="string"?m==="use-credentials"?m:"":void 0):m=null,i.d.C(b,m))},ta.prefetchDNS=function(b){typeof b=="string"&&i.d.D(b)},ta.preinit=function(b,m){if(typeof b=="string"&&m&&typeof m.as=="string"){var _=m.as,E=p(_,m.crossOrigin),N=typeof m.integrity=="string"?m.integrity:void 0,S=typeof m.fetchPriority=="string"?m.fetchPriority:void 0;_==="style"?i.d.S(b,typeof m.precedence=="string"?m.precedence:void 0,{crossOrigin:E,integrity:N,fetchPriority:S}):_==="script"&&i.d.X(b,{crossOrigin:E,integrity:N,fetchPriority:S,nonce:typeof m.nonce=="string"?m.nonce:void 0})}},ta.preinitModule=function(b,m){if(typeof b=="string")if(typeof m=="object"&&m!==null){if(m.as==null||m.as==="script"){var _=p(m.as,m.crossOrigin);i.d.M(b,{crossOrigin:_,integrity:typeof m.integrity=="string"?m.integrity:void 0,nonce:typeof m.nonce=="string"?m.nonce:void 0})}}else m==null&&i.d.M(b)},ta.preload=function(b,m){if(typeof b=="string"&&typeof m=="object"&&m!==null&&typeof m.as=="string"){var _=m.as,E=p(_,m.crossOrigin);i.d.L(b,_,{crossOrigin:E,integrity:typeof m.integrity=="string"?m.integrity:void 0,nonce:typeof m.nonce=="string"?m.nonce:void 0,type:typeof m.type=="string"?m.type:void 0,fetchPriority:typeof m.fetchPriority=="string"?m.fetchPriority:void 0,referrerPolicy:typeof m.referrerPolicy=="string"?m.referrerPolicy:void 0,imageSrcSet:typeof m.imageSrcSet=="string"?m.imageSrcSet:void 0,imageSizes:typeof m.imageSizes=="string"?m.imageSizes:void 0,media:typeof m.media=="string"?m.media:void 0})}},ta.preloadModule=function(b,m){if(typeof b=="string")if(m){var _=p(m.as,m.crossOrigin);i.d.m(b,{as:typeof m.as=="string"&&m.as!=="script"?m.as:void 0,crossOrigin:_,integrity:typeof m.integrity=="string"?m.integrity:void 0})}else i.d.m(b)},ta.requestFormReset=function(b){i.d.r(b)},ta.unstable_batchedUpdates=function(b,m){return b(m)},ta.useFormState=function(b,m,_){return f.H.useFormState(b,m,_)},ta.useFormStatus=function(){return f.H.useHostTransitionStatus()},ta.version="19.2.3",ta}var Ey;function s_(){if(Ey)return ph.exports;Ey=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(a){console.error(a)}}return n(),ph.exports=a_(),ph.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ky;function i_(){if(ky)return oc;ky=1;var n=r_(),a=Lc(),s=s_();function i(e){var t="https://react.dev/errors/"+e;if(1<arguments.length){t+="?args[]="+encodeURIComponent(arguments[1]);for(var r=2;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r])}return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function c(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function u(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,(t.flags&4098)!==0&&(r=t.return),e=t.return;while(e)}return t.tag===3?r:null}function f(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function p(e){if(e.tag===31){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function b(e){if(u(e)!==e)throw Error(i(188))}function m(e){var t=e.alternate;if(!t){if(t=u(e),t===null)throw Error(i(188));return t!==e?null:e}for(var r=e,o=t;;){var h=r.return;if(h===null)break;var y=h.alternate;if(y===null){if(o=h.return,o!==null){r=o;continue}break}if(h.child===y.child){for(y=h.child;y;){if(y===r)return b(h),e;if(y===o)return b(h),t;y=y.sibling}throw Error(i(188))}if(r.return!==o.return)r=h,o=y;else{for(var O=!1,V=h.child;V;){if(V===r){O=!0,r=h,o=y;break}if(V===o){O=!0,o=h,r=y;break}V=V.sibling}if(!O){for(V=y.child;V;){if(V===r){O=!0,r=y,o=h;break}if(V===o){O=!0,o=y,r=h;break}V=V.sibling}if(!O)throw Error(i(189))}}if(r.alternate!==o)throw Error(i(190))}if(r.tag!==3)throw Error(i(188));return r.stateNode.current===r?e:t}function _(e){var t=e.tag;if(t===5||t===26||t===27||t===6)return e;for(e=e.child;e!==null;){if(t=_(e),t!==null)return t;e=e.sibling}return null}var E=Object.assign,N=Symbol.for("react.element"),S=Symbol.for("react.transitional.element"),I=Symbol.for("react.portal"),A=Symbol.for("react.fragment"),k=Symbol.for("react.strict_mode"),R=Symbol.for("react.profiler"),P=Symbol.for("react.consumer"),q=Symbol.for("react.context"),G=Symbol.for("react.forward_ref"),Y=Symbol.for("react.suspense"),W=Symbol.for("react.suspense_list"),H=Symbol.for("react.memo"),L=Symbol.for("react.lazy"),U=Symbol.for("react.activity"),Q=Symbol.for("react.memo_cache_sentinel"),le=Symbol.iterator;function F(e){return e===null||typeof e!="object"?null:(e=le&&e[le]||e["@@iterator"],typeof e=="function"?e:null)}var te=Symbol.for("react.client.reference");function j(e){if(e==null)return null;if(typeof e=="function")return e.$$typeof===te?null:e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case A:return"Fragment";case R:return"Profiler";case k:return"StrictMode";case Y:return"Suspense";case W:return"SuspenseList";case U:return"Activity"}if(typeof e=="object")switch(e.$$typeof){case I:return"Portal";case q:return e.displayName||"Context";case P:return(e._context.displayName||"Context")+".Consumer";case G:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case H:return t=e.displayName||null,t!==null?t:j(e.type)||"Memo";case L:t=e._payload,e=e._init;try{return j(e(t))}catch{}}return null}var he=Array.isArray,J=a.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Z=s.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,De={pending:!1,data:null,method:null,action:null},ve=[],Be=-1;function T(e){return{current:e}}function z(e){0>Be||(e.current=ve[Be],ve[Be]=null,Be--)}function ne(e,t){Be++,ve[Be]=e.current,e.current=t}var se=T(null),ue=T(null),de=T(null),oe=T(null);function ye(e,t){switch(ne(de,t),ne(ue,e),ne(se,null),t.nodeType){case 9:case 11:e=(e=t.documentElement)&&(e=e.namespaceURI)?Fg(e):0;break;default:if(e=t.tagName,t=t.namespaceURI)t=Fg(t),e=Hg(t,e);else switch(e){case"svg":e=1;break;case"math":e=2;break;default:e=0}}z(se),ne(se,e)}function ie(){z(se),z(ue),z(de)}function We(e){e.memoizedState!==null&&ne(oe,e);var t=se.current,r=Hg(t,e.type);t!==r&&(ne(ue,e),ne(se,r))}function ot(e){ue.current===e&&(z(se),z(ue)),oe.current===e&&(z(oe),nc._currentValue=De)}var ft,$e;function C(e){if(ft===void 0)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);ft=t&&t[1]||"",$e=-1<r.stack.indexOf(`
    at`)?" (<anonymous>)":-1<r.stack.indexOf("@")?"@unknown:0:0":""}return`
`+ft+e+$e}var Ne=!1;function Ce(e,t){if(!e||Ne)return"";Ne=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var o={DetermineComponentFrameRoot:function(){try{if(t){var nt=function(){throw Error()};if(Object.defineProperty(nt.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(nt,[])}catch(Ke){var Pe=Ke}Reflect.construct(e,[],nt)}else{try{nt.call()}catch(Ke){Pe=Ke}e.call(nt.prototype)}}else{try{throw Error()}catch(Ke){Pe=Ke}(nt=e())&&typeof nt.catch=="function"&&nt.catch(function(){})}}catch(Ke){if(Ke&&Pe&&typeof Ke.stack=="string")return[Ke.stack,Pe.stack]}return[null,null]}};o.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var h=Object.getOwnPropertyDescriptor(o.DetermineComponentFrameRoot,"name");h&&h.configurable&&Object.defineProperty(o.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var y=o.DetermineComponentFrameRoot(),O=y[0],V=y[1];if(O&&V){var pe=O.split(`
`),ze=V.split(`
`);for(h=o=0;o<pe.length&&!pe[o].includes("DetermineComponentFrameRoot");)o++;for(;h<ze.length&&!ze[h].includes("DetermineComponentFrameRoot");)h++;if(o===pe.length||h===ze.length)for(o=pe.length-1,h=ze.length-1;1<=o&&0<=h&&pe[o]!==ze[h];)h--;for(;1<=o&&0<=h;o--,h--)if(pe[o]!==ze[h]){if(o!==1||h!==1)do if(o--,h--,0>h||pe[o]!==ze[h]){var Qe=`
`+pe[o].replace(" at new "," at ");return e.displayName&&Qe.includes("<anonymous>")&&(Qe=Qe.replace("<anonymous>",e.displayName)),Qe}while(1<=o&&0<=h);break}}}finally{Ne=!1,Error.prepareStackTrace=r}return(r=e?e.displayName||e.name:"")?C(r):""}function re(e,t){switch(e.tag){case 26:case 27:case 5:return C(e.type);case 16:return C("Lazy");case 13:return e.child!==t&&t!==null?C("Suspense Fallback"):C("Suspense");case 19:return C("SuspenseList");case 0:case 15:return Ce(e.type,!1);case 11:return Ce(e.type.render,!1);case 1:return Ce(e.type,!0);case 31:return C("Activity");default:return""}}function ee(e){try{var t="",r=null;do t+=re(e,r),r=e,e=e.return;while(e);return t}catch(o){return`
Error generating stack: `+o.message+`
`+o.stack}}var me=Object.prototype.hasOwnProperty,Ve=n.unstable_scheduleCallback,Ye=n.unstable_cancelCallback,be=n.unstable_shouldYield,Ze=n.unstable_requestPaint,at=n.unstable_now,Ue=n.unstable_getCurrentPriorityLevel,_t=n.unstable_ImmediatePriority,It=n.unstable_UserBlockingPriority,Nt=n.unstable_NormalPriority,on=n.unstable_LowPriority,Zt=n.unstable_IdlePriority,cn=n.log,bn=n.unstable_setDisableYieldValue,zt=null,Ht=null;function yt(e){if(typeof cn=="function"&&bn(e),Ht&&typeof Ht.setStrictMode=="function")try{Ht.setStrictMode(zt,e)}catch{}}var tn=Math.clz32?Math.clz32:gt,or=Math.log,At=Math.LN2;function gt(e){return e>>>=0,e===0?32:31-(or(e)/At|0)|0}var jr=256,An=262144,qn=4194304;function vr(e){var t=e&42;if(t!==0)return t;switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return e&261888;case 262144:case 524288:case 1048576:case 2097152:return e&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return e&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return e}}function Tr(e,t,r){var o=e.pendingLanes;if(o===0)return 0;var h=0,y=e.suspendedLanes,O=e.pingedLanes;e=e.warmLanes;var V=o&134217727;return V!==0?(o=V&~y,o!==0?h=vr(o):(O&=V,O!==0?h=vr(O):r||(r=V&~e,r!==0&&(h=vr(r))))):(V=o&~y,V!==0?h=vr(V):O!==0?h=vr(O):r||(r=o&~e,r!==0&&(h=vr(r)))),h===0?0:t!==0&&t!==h&&(t&y)===0&&(y=h&-h,r=t&-t,y>=r||y===32&&(r&4194048)!==0)?t:h}function ka(e,t){return(e.pendingLanes&~(e.suspendedLanes&~e.pingedLanes)&t)===0}function mt(e,t){switch(e){case 1:case 2:case 4:case 8:case 64:return t+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Vr(){var e=qn;return qn<<=1,(qn&62914560)===0&&(qn=4194304),e}function zn(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function Lr(e,t){e.pendingLanes|=t,t!==268435456&&(e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0)}function Aa(e,t,r,o,h,y){var O=e.pendingLanes;e.pendingLanes=r,e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0,e.expiredLanes&=r,e.entangledLanes&=r,e.errorRecoveryDisabledLanes&=r,e.shellSuspendCounter=0;var V=e.entanglements,pe=e.expirationTimes,ze=e.hiddenUpdates;for(r=O&~r;0<r;){var Qe=31-tn(r),nt=1<<Qe;V[Qe]=0,pe[Qe]=-1;var Pe=ze[Qe];if(Pe!==null)for(ze[Qe]=null,Qe=0;Qe<Pe.length;Qe++){var Ke=Pe[Qe];Ke!==null&&(Ke.lane&=-536870913)}r&=~nt}o!==0&&En(e,o,0),y!==0&&h===0&&e.tag!==0&&(e.suspendedLanes|=y&~(O&~t))}function En(e,t,r){e.pendingLanes|=t,e.suspendedLanes&=~t;var o=31-tn(t);e.entangledLanes|=t,e.entanglements[o]=e.entanglements[o]|1073741824|r&261930}function Dn(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var o=31-tn(r),h=1<<o;h&t|e[o]&t&&(e[o]|=t),r&=~h}}function Cr(e,t){var r=t&-t;return r=(r&42)!==0?1:Vn(r),(r&(e.suspendedLanes|t))!==0?0:r}function Vn(e){switch(e){case 2:e=1;break;case 8:e=4;break;case 32:e=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:e=128;break;case 268435456:e=134217728;break;default:e=0}return e}function da(e){return e&=-e,2<e?8<e?(e&134217727)!==0?32:268435456:8:2}function zr(){var e=Z.p;return e!==0?e:(e=window.event,e===void 0?32:uy(e.type))}function Ms(e,t){var r=Z.p;try{return Z.p=e,t()}finally{Z.p=r}}var nr=Math.random().toString(36).slice(2),gn="__reactFiber$"+nr,nn="__reactProps$"+nr,Br="__reactContainer$"+nr,ms="__reactEvents$"+nr,Fr="__reactListeners$"+nr,Us="__reactHandles$"+nr,St="__reactResources$"+nr,_e="__reactMarker$"+nr;function st(e){delete e[gn],delete e[nn],delete e[ms],delete e[Fr],delete e[Us]}function ut(e){var t=e[gn];if(t)return t;for(var r=e.parentNode;r;){if(t=r[Br]||r[gn]){if(r=t.alternate,t.child!==null||r!==null&&r.child!==null)for(e=Vg(e);e!==null;){if(r=e[gn])return r;e=Vg(e)}return t}e=r,r=e.parentNode}return null}function Rt(e){if(e=e[gn]||e[Br]){var t=e.tag;if(t===5||t===6||t===13||t===31||t===26||t===27||t===3)return e}return null}function xn(e){var t=e.tag;if(t===5||t===26||t===27||t===6)return e.stateNode;throw Error(i(33))}function Rn(e){var t=e[St];return t||(t=e[St]={hoistableStyles:new Map,hoistableScripts:new Map}),t}function $t(e){e[_e]=!0}var Zn=new Set,Hr={};function Mn(e,t){Xn(e,t),Xn(e+"Capture",t)}function Xn(e,t){for(Hr[e]=t,e=0;e<t.length;e++)Zn.add(t[e])}var es=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),gs={},ii={};function dn(e){return me.call(ii,e)?!0:me.call(gs,e)?!1:es.test(e)?ii[e]=!0:(gs[e]=!0,!1)}function Ls(e,t,r){if(dn(t))if(r===null)e.removeAttribute(t);else{switch(typeof r){case"undefined":case"function":case"symbol":e.removeAttribute(t);return;case"boolean":var o=t.toLowerCase().slice(0,5);if(o!=="data-"&&o!=="aria-"){e.removeAttribute(t);return}}e.setAttribute(t,""+r)}}function ys(e,t,r){if(r===null)e.removeAttribute(t);else{switch(typeof r){case"undefined":case"function":case"symbol":case"boolean":e.removeAttribute(t);return}e.setAttribute(t,""+r)}}function aa(e,t,r,o){if(o===null)e.removeAttribute(r);else{switch(typeof o){case"undefined":case"function":case"symbol":case"boolean":e.removeAttribute(r);return}e.setAttributeNS(t,r,""+o)}}function Qt(e){switch(typeof e){case"bigint":case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function ts(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function kn(e,t,r){var o=Object.getOwnPropertyDescriptor(e.constructor.prototype,t);if(!e.hasOwnProperty(t)&&typeof o<"u"&&typeof o.get=="function"&&typeof o.set=="function"){var h=o.get,y=o.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return h.call(this)},set:function(O){r=""+O,y.call(this,O)}}),Object.defineProperty(e,t,{enumerable:o.enumerable}),{getValue:function(){return r},setValue:function(O){r=""+O},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function Zr(e){if(!e._valueTracker){var t=ts(e)?"checked":"value";e._valueTracker=kn(e,t,""+e[t])}}function vs(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),o="";return e&&(o=ts(e)?e.checked?"true":"false":e.value),e=o,e!==r?(t.setValue(e),!0):!1}function Qr(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}var ns=/[\n"\\]/g;function br(e){return e.replace(ns,function(t){return"\\"+t.charCodeAt(0).toString(16)+" "})}function Ta(e,t,r,o,h,y,O,V){e.name="",O!=null&&typeof O!="function"&&typeof O!="symbol"&&typeof O!="boolean"?e.type=O:e.removeAttribute("type"),t!=null?O==="number"?(t===0&&e.value===""||e.value!=t)&&(e.value=""+Qt(t)):e.value!==""+Qt(t)&&(e.value=""+Qt(t)):O!=="submit"&&O!=="reset"||e.removeAttribute("value"),t!=null?sa(e,O,Qt(t)):r!=null?sa(e,O,Qt(r)):o!=null&&e.removeAttribute("value"),h==null&&y!=null&&(e.defaultChecked=!!y),h!=null&&(e.checked=h&&typeof h!="function"&&typeof h!="symbol"),V!=null&&typeof V!="function"&&typeof V!="symbol"&&typeof V!="boolean"?e.name=""+Qt(V):e.removeAttribute("name")}function rs(e,t,r,o,h,y,O,V){if(y!=null&&typeof y!="function"&&typeof y!="symbol"&&typeof y!="boolean"&&(e.type=y),t!=null||r!=null){if(!(y!=="submit"&&y!=="reset"||t!=null)){Zr(e);return}r=r!=null?""+Qt(r):"",t=t!=null?""+Qt(t):r,V||t===e.value||(e.value=t),e.defaultValue=t}o=o??h,o=typeof o!="function"&&typeof o!="symbol"&&!!o,e.checked=V?e.checked:!!o,e.defaultChecked=!!o,O!=null&&typeof O!="function"&&typeof O!="symbol"&&typeof O!="boolean"&&(e.name=O),Zr(e)}function sa(e,t,r){t==="number"&&Qr(e.ownerDocument)===e||e.defaultValue===""+r||(e.defaultValue=""+r)}function fa(e,t,r,o){if(e=e.options,t){t={};for(var h=0;h<r.length;h++)t["$"+r[h]]=!0;for(r=0;r<e.length;r++)h=t.hasOwnProperty("$"+e[r].value),e[r].selected!==h&&(e[r].selected=h),h&&o&&(e[r].defaultSelected=!0)}else{for(r=""+Qt(r),t=null,h=0;h<e.length;h++){if(e[h].value===r){e[h].selected=!0,o&&(e[h].defaultSelected=!0);return}t!==null||e[h].disabled||(t=e[h])}t!==null&&(t.selected=!0)}}function oi(e,t,r){if(t!=null&&(t=""+Qt(t),t!==e.value&&(e.value=t),r==null)){e.defaultValue!==t&&(e.defaultValue=t);return}e.defaultValue=r!=null?""+Qt(r):""}function li(e,t,r,o){if(t==null){if(o!=null){if(r!=null)throw Error(i(92));if(he(o)){if(1<o.length)throw Error(i(93));o=o[0]}r=o}r==null&&(r=""),t=r}r=Qt(t),e.defaultValue=r,o=e.textContent,o===r&&o!==""&&o!==null&&(e.value=o),Zr(e)}function rn(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&r.nodeType===3){r.nodeValue=t;return}}e.textContent=t}var zs=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function ci(e,t,r){var o=t.indexOf("--")===0;r==null||typeof r=="boolean"||r===""?o?e.setProperty(t,""):t==="float"?e.cssFloat="":e[t]="":o?e.setProperty(t,r):typeof r!="number"||r===0||zs.has(t)?t==="float"?e.cssFloat=r:e[t]=(""+r).trim():e[t]=r+"px"}function Oo(e,t,r){if(t!=null&&typeof t!="object")throw Error(i(62));if(e=e.style,r!=null){for(var o in r)!r.hasOwnProperty(o)||t!=null&&t.hasOwnProperty(o)||(o.indexOf("--")===0?e.setProperty(o,""):o==="float"?e.cssFloat="":e[o]="");for(var h in t)o=t[h],t.hasOwnProperty(h)&&r[h]!==o&&ci(e,h,o)}else for(var y in t)t.hasOwnProperty(y)&&ci(e,y,t[y])}function lr(e){if(e.indexOf("-")===-1)return!1;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Ca=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),ha=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Pr(e){return ha.test(""+e)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":e}function cr(){}var Na=null;function Gn(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var xr=null,pa=null;function Ot(e){var t=Rt(e);if(t&&(e=t.stateNode)){var r=e[nn]||null;e:switch(e=t.stateNode,t.type){case"input":if(Ta(e,r.value,r.defaultValue,r.defaultValue,r.checked,r.defaultChecked,r.type,r.name),t=r.name,r.type==="radio"&&t!=null){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll('input[name="'+br(""+t)+'"][type="radio"]'),t=0;t<r.length;t++){var o=r[t];if(o!==e&&o.form===e.form){var h=o[nn]||null;if(!h)throw Error(i(90));Ta(o,h.value,h.defaultValue,h.defaultValue,h.checked,h.defaultChecked,h.type,h.name)}}for(t=0;t<r.length;t++)o=r[t],o.form===e.form&&vs(o)}break e;case"textarea":oi(e,r.value,r.defaultValue);break e;case"select":t=r.value,t!=null&&fa(e,!!r.multiple,t,!1)}}}var bs=!1;function Jr(e,t,r){if(bs)return e(t,r);bs=!0;try{var o=e(t);return o}finally{if(bs=!1,(xr!==null||pa!==null)&&(vu(),xr&&(t=xr,e=pa,pa=xr=null,Ot(t),e)))for(t=0;t<e.length;t++)Ot(e[t])}}function Pa(e,t){var r=e.stateNode;if(r===null)return null;var o=r[nn]||null;if(o===null)return null;r=o[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(o=!o.disabled)||(e=e.type,o=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!o;break e;default:e=!1}if(e)return null;if(r&&typeof r!="function")throw Error(i(231,t,typeof r));return r}var rr=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Da=!1;if(rr)try{var ma={};Object.defineProperty(ma,"passive",{get:function(){Da=!0}}),window.addEventListener("test",ma,ma),window.removeEventListener("test",ma,ma)}catch{Da=!1}var hr=null,ga=null,as=null;function v(){if(as)return as;var e,t=ga,r=t.length,o,h="value"in hr?hr.value:hr.textContent,y=h.length;for(e=0;e<r&&t[e]===h[e];e++);var O=r-e;for(o=1;o<=O&&t[r-o]===h[y-o];o++);return as=h.slice(e,1<o?1-o:void 0)}function x(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function M(){return!0}function X(){return!1}function ce(e){function t(r,o,h,y,O){this._reactName=r,this._targetInst=h,this.type=o,this.nativeEvent=y,this.target=O,this.currentTarget=null;for(var V in e)e.hasOwnProperty(V)&&(r=e[V],this[V]=r?r(y):y[V]);return this.isDefaultPrevented=(y.defaultPrevented!=null?y.defaultPrevented:y.returnValue===!1)?M:X,this.isPropagationStopped=X,this}return E(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=M)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=M)},persist:function(){},isPersistent:M}),t}var He={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Je=ce(He),Mt=E({},He,{view:0,detail:0}),fn=ce(Mt),Vt,Yn,Bn,ss=E({},Mt,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:_s,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Bn&&(Bn&&e.type==="mousemove"?(Vt=e.screenX-Bn.screenX,Yn=e.screenY-Bn.screenY):Yn=Vt=0,Bn=e),Vt)},movementY:function(e){return"movementY"in e?e.movementY:Yn}}),Wi=ce(ss),Bs=E({},ss,{dataTransfer:0}),ui=ce(Bs),Fs=E({},Mt,{relatedTarget:0}),di=ce(Fs),Sl=E({},He,{animationName:0,elapsedTime:0,pseudoElement:0}),fi=ce(Sl),eo=E({},He,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),to=ce(eo),no=E({},He,{data:0}),hi=ce(no),Nr={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},xs={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Hs={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function jo(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=Hs[e])?!!t[e]:!1}function _s(){return jo}var Io=E({},Mt,{key:function(e){if(e.key){var t=Nr[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=x(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?xs[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:_s,charCode:function(e){return e.type==="keypress"?x(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?x(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),Ro=ce(Io),pi=E({},ss,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),mi=ce(pi),qa=E({},Mt,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:_s}),ro=ce(qa),ao=E({},He,{propertyName:0,elapsedTime:0,pseudoElement:0}),gi=ce(ao),so=E({},ss,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Mo=ce(so),El=E({},He,{newState:0,oldState:0}),yi=ce(El),vi=[9,13,27,32],io=rr&&"CompositionEvent"in window,is=null;rr&&"documentMode"in document&&(is=document.documentMode);var ws=rr&&"TextEvent"in window&&!is,oo=rr&&(!io||is&&8<is&&11>=is),bi=" ",Me=!1;function it(e,t){switch(e){case"keyup":return vi.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Dt(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Bt=!1;function Xt(e,t){switch(e){case"compositionend":return Dt(t);case"keypress":return t.which!==32?null:(Me=!0,bi);case"textInput":return e=t.data,e===bi&&Me?null:e;default:return null}}function Tn(e,t){if(Bt)return e==="compositionend"||!io&&it(e,t)?(e=v(),as=ga=hr=null,Bt=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return oo&&t.locale!=="ko"?null:t.data;default:return null}}var Xr={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Ir(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!Xr[e.type]:t==="textarea"}function Rr(e,t,r,o){xr?pa?pa.push(o):pa=[o]:xr=o,t=ku(t,"onChange"),0<t.length&&(r=new Je("onChange","change",null,r,o),e.push({event:r,listeners:t}))}var Dr=null,os=null;function ya(e){Rg(e,0)}function Wr(e){var t=xn(e);if(vs(t))return e}function Wn(e,t){if(e==="change")return t}var lo=!1;if(rr){var ea;if(rr){var kl="oninput"in document;if(!kl){var Uo=document.createElement("div");Uo.setAttribute("oninput","return;"),kl=typeof Uo.oninput=="function"}ea=kl}else ea=!1;lo=ea&&(!document.documentMode||9<document.documentMode)}function Al(){Dr&&(Dr.detachEvent("onpropertychange",Ss),os=Dr=null)}function Ss(e){if(e.propertyName==="value"&&Wr(os)){var t=[];Rr(t,os,e,Gn(e)),Jr(ya,t)}}function Tl(e,t,r){e==="focusin"?(Al(),Dr=t,os=r,Dr.attachEvent("onpropertychange",Ss)):e==="focusout"&&Al()}function xi(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return Wr(os)}function Es(e,t){if(e==="click")return Wr(t)}function Hc(e,t){if(e==="input"||e==="change")return Wr(t)}function d(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var g=typeof Object.is=="function"?Object.is:d;function w(e,t){if(g(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var r=Object.keys(e),o=Object.keys(t);if(r.length!==o.length)return!1;for(o=0;o<r.length;o++){var h=r[o];if(!me.call(t,h)||!g(e[h],t[h]))return!1}return!0}function D(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function B(e,t){var r=D(e);e=0;for(var o;r;){if(r.nodeType===3){if(o=e+r.textContent.length,e<=t&&o>=t)return{node:r,offset:t-e};e=o}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=D(r)}}function K(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?K(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function ae(e){e=e!=null&&e.ownerDocument!=null&&e.ownerDocument.defaultView!=null?e.ownerDocument.defaultView:window;for(var t=Qr(e.document);t instanceof e.HTMLIFrameElement;){try{var r=typeof t.contentWindow.location.href=="string"}catch{r=!1}if(r)e=t.contentWindow;else break;t=Qr(e.document)}return t}function fe(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}var ke=rr&&"documentMode"in document&&11>=document.documentMode,xe=null,je=null,ge=null,Re=!1;function Ee(e,t,r){var o=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;Re||xe==null||xe!==Qr(o)||(o=xe,"selectionStart"in o&&fe(o)?o={start:o.selectionStart,end:o.selectionEnd}:(o=(o.ownerDocument&&o.ownerDocument.defaultView||window).getSelection(),o={anchorNode:o.anchorNode,anchorOffset:o.anchorOffset,focusNode:o.focusNode,focusOffset:o.focusOffset}),ge&&w(ge,o)||(ge=o,o=ku(je,"onSelect"),0<o.length&&(t=new Je("onSelect","select",null,t,r),e.push({event:t,listeners:o}),t.target=xe)))}function Ae(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var Oe={animationend:Ae("Animation","AnimationEnd"),animationiteration:Ae("Animation","AnimationIteration"),animationstart:Ae("Animation","AnimationStart"),transitionrun:Ae("Transition","TransitionRun"),transitionstart:Ae("Transition","TransitionStart"),transitioncancel:Ae("Transition","TransitionCancel"),transitionend:Ae("Transition","TransitionEnd")},Te={},Fe={};rr&&(Fe=document.createElement("div").style,"AnimationEvent"in window||(delete Oe.animationend.animation,delete Oe.animationiteration.animation,delete Oe.animationstart.animation),"TransitionEvent"in window||delete Oe.transitionend.transition);function qe(e){if(Te[e])return Te[e];if(!Oe[e])return e;var t=Oe[e],r;for(r in t)if(t.hasOwnProperty(r)&&r in Fe)return Te[e]=t[r];return e}var Ge=qe("animationend"),Xe=qe("animationiteration"),ct=qe("animationstart"),bt=qe("transitionrun"),dt=qe("transitionstart"),vt=qe("transitioncancel"),xt=qe("transitionend"),lt=new Map,Yt="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Yt.push("scrollEnd");function Ft(e,t){lt.set(e,t),Mn(t,[e])}var Wt=typeof reportError=="function"?reportError:function(e){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var t=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof e=="object"&&e!==null&&typeof e.message=="string"?String(e.message):String(e),error:e});if(!window.dispatchEvent(t))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",e);return}console.error(e)},Pt=[],Mr=0,en=0;function pr(){for(var e=Mr,t=en=Mr=0;t<e;){var r=Pt[t];Pt[t++]=null;var o=Pt[t];Pt[t++]=null;var h=Pt[t];Pt[t++]=null;var y=Pt[t];if(Pt[t++]=null,o!==null&&h!==null){var O=o.pending;O===null?h.next=h:(h.next=O.next,O.next=h),o.pending=h}y!==0&&ks(r,h,y)}}function mr(e,t,r,o){Pt[Mr++]=e,Pt[Mr++]=t,Pt[Mr++]=r,Pt[Mr++]=o,en|=o,e.lanes|=o,e=e.alternate,e!==null&&(e.lanes|=o)}function _i(e,t,r,o){return mr(e,t,r,o),wi(e)}function ar(e,t){return mr(e,null,null,t),wi(e)}function ks(e,t,r){e.lanes|=r;var o=e.alternate;o!==null&&(o.lanes|=r);for(var h=!1,y=e.return;y!==null;)y.childLanes|=r,o=y.alternate,o!==null&&(o.childLanes|=r),y.tag===22&&(e=y.stateNode,e===null||e._visibility&1||(h=!0)),e=y,y=y.return;return e.tag===3?(y=e.stateNode,h&&t!==null&&(h=31-tn(r),e=y.hiddenUpdates,o=e[h],o===null?e[h]=[t]:o.push(t),t.lane=r|536870912),y):null}function wi(e){if(50<Zl)throw Zl=0,If=null,Error(i(185));for(var t=e.return;t!==null;)e=t,t=e.return;return e.tag===3?e.stateNode:null}var Lo={};function M0(e,t,r,o){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=o,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Oa(e,t,r,o){return new M0(e,t,r,o)}function Ed(e){return e=e.prototype,!(!e||!e.isReactComponent)}function Ps(e,t){var r=e.alternate;return r===null?(r=Oa(e.tag,t,e.key,e.mode),r.elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=e.flags&65011712,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r.refCleanup=e.refCleanup,r}function gp(e,t){e.flags&=65011714;var r=e.alternate;return r===null?(e.childLanes=0,e.lanes=t,e.child=null,e.subtreeFlags=0,e.memoizedProps=null,e.memoizedState=null,e.updateQueue=null,e.dependencies=null,e.stateNode=null):(e.childLanes=r.childLanes,e.lanes=r.lanes,e.child=r.child,e.subtreeFlags=0,e.deletions=null,e.memoizedProps=r.memoizedProps,e.memoizedState=r.memoizedState,e.updateQueue=r.updateQueue,e.type=r.type,t=r.dependencies,e.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),e}function Pc(e,t,r,o,h,y){var O=0;if(o=e,typeof e=="function")Ed(e)&&(O=1);else if(typeof e=="string")O=Fx(e,r,se.current)?26:e==="html"||e==="head"||e==="body"?27:5;else e:switch(e){case U:return e=Oa(31,r,t,h),e.elementType=U,e.lanes=y,e;case A:return co(r.children,h,y,t);case k:O=8,h|=24;break;case R:return e=Oa(12,r,t,h|2),e.elementType=R,e.lanes=y,e;case Y:return e=Oa(13,r,t,h),e.elementType=Y,e.lanes=y,e;case W:return e=Oa(19,r,t,h),e.elementType=W,e.lanes=y,e;default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case q:O=10;break e;case P:O=9;break e;case G:O=11;break e;case H:O=14;break e;case L:O=16,o=null;break e}O=29,r=Error(i(130,e===null?"null":typeof e,"")),o=null}return t=Oa(O,r,t,h),t.elementType=e,t.type=o,t.lanes=y,t}function co(e,t,r,o){return e=Oa(7,e,o,t),e.lanes=r,e}function kd(e,t,r){return e=Oa(6,e,null,t),e.lanes=r,e}function yp(e){var t=Oa(18,null,null,0);return t.stateNode=e,t}function Ad(e,t,r){return t=Oa(4,e.children!==null?e.children:[],e.key,t),t.lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}var vp=new WeakMap;function Ga(e,t){if(typeof e=="object"&&e!==null){var r=vp.get(e);return r!==void 0?r:(t={value:e,source:t,stack:ee(t)},vp.set(e,t),t)}return{value:e,source:t,stack:ee(t)}}var zo=[],Bo=0,qc=null,Cl=0,Ka=[],Ya=0,Si=null,As=1,Ts="";function qs(e,t){zo[Bo++]=Cl,zo[Bo++]=qc,qc=e,Cl=t}function bp(e,t,r){Ka[Ya++]=As,Ka[Ya++]=Ts,Ka[Ya++]=Si,Si=e;var o=As;e=Ts;var h=32-tn(o)-1;o&=~(1<<h),r+=1;var y=32-tn(t)+h;if(30<y){var O=h-h%5;y=(o&(1<<O)-1).toString(32),o>>=O,h-=O,As=1<<32-tn(t)+h|r<<h|o,Ts=y+e}else As=1<<y|r<<h|o,Ts=e}function Td(e){e.return!==null&&(qs(e,1),bp(e,1,0))}function Cd(e){for(;e===qc;)qc=zo[--Bo],zo[Bo]=null,Cl=zo[--Bo],zo[Bo]=null;for(;e===Si;)Si=Ka[--Ya],Ka[Ya]=null,Ts=Ka[--Ya],Ka[Ya]=null,As=Ka[--Ya],Ka[Ya]=null}function xp(e,t){Ka[Ya++]=As,Ka[Ya++]=Ts,Ka[Ya++]=Si,As=t.id,Ts=t.overflow,Si=e}var qr=null,Qn=null,_n=!1,Ei=null,$a=!1,Nd=Error(i(519));function ki(e){var t=Error(i(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw Nl(Ga(t,e)),Nd}function _p(e){var t=e.stateNode,r=e.type,o=e.memoizedProps;switch(t[gn]=e,t[nn]=o,r){case"dialog":pn("cancel",t),pn("close",t);break;case"iframe":case"object":case"embed":pn("load",t);break;case"video":case"audio":for(r=0;r<Jl.length;r++)pn(Jl[r],t);break;case"source":pn("error",t);break;case"img":case"image":case"link":pn("error",t),pn("load",t);break;case"details":pn("toggle",t);break;case"input":pn("invalid",t),rs(t,o.value,o.defaultValue,o.checked,o.defaultChecked,o.type,o.name,!0);break;case"select":pn("invalid",t);break;case"textarea":pn("invalid",t),li(t,o.value,o.defaultValue,o.children)}r=o.children,typeof r!="string"&&typeof r!="number"&&typeof r!="bigint"||t.textContent===""+r||o.suppressHydrationWarning===!0||zg(t.textContent,r)?(o.popover!=null&&(pn("beforetoggle",t),pn("toggle",t)),o.onScroll!=null&&pn("scroll",t),o.onScrollEnd!=null&&pn("scrollend",t),o.onClick!=null&&(t.onclick=cr),t=!0):t=!1,t||ki(e,!0)}function wp(e){for(qr=e.return;qr;)switch(qr.tag){case 5:case 31:case 13:$a=!1;return;case 27:case 3:$a=!0;return;default:qr=qr.return}}function Fo(e){if(e!==qr)return!1;if(!_n)return wp(e),_n=!0,!1;var t=e.tag,r;if((r=t!==3&&t!==27)&&((r=t===5)&&(r=e.type,r=!(r!=="form"&&r!=="button")||Vf(e.type,e.memoizedProps)),r=!r),r&&Qn&&ki(e),wp(e),t===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(i(317));Qn=$g(e)}else if(t===31){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(i(317));Qn=$g(e)}else t===27?(t=Qn,Bi(e.type)?(e=Wf,Wf=null,Qn=e):Qn=t):Qn=qr?Za(e.stateNode.nextSibling):null;return!0}function uo(){Qn=qr=null,_n=!1}function Dd(){var e=Ei;return e!==null&&(_a===null?_a=e:_a.push.apply(_a,e),Ei=null),e}function Nl(e){Ei===null?Ei=[e]:Ei.push(e)}var Od=T(null),fo=null,Gs=null;function Ai(e,t,r){ne(Od,t._currentValue),t._currentValue=r}function Ks(e){e._currentValue=Od.current,z(Od)}function jd(e,t,r){for(;e!==null;){var o=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,o!==null&&(o.childLanes|=t)):o!==null&&(o.childLanes&t)!==t&&(o.childLanes|=t),e===r)break;e=e.return}}function Id(e,t,r,o){var h=e.child;for(h!==null&&(h.return=e);h!==null;){var y=h.dependencies;if(y!==null){var O=h.child;y=y.firstContext;e:for(;y!==null;){var V=y;y=h;for(var pe=0;pe<t.length;pe++)if(V.context===t[pe]){y.lanes|=r,V=y.alternate,V!==null&&(V.lanes|=r),jd(y.return,r,e),o||(O=null);break e}y=V.next}}else if(h.tag===18){if(O=h.return,O===null)throw Error(i(341));O.lanes|=r,y=O.alternate,y!==null&&(y.lanes|=r),jd(O,r,e),O=null}else O=h.child;if(O!==null)O.return=h;else for(O=h;O!==null;){if(O===e){O=null;break}if(h=O.sibling,h!==null){h.return=O.return,O=h;break}O=O.return}h=O}}function Ho(e,t,r,o){e=null;for(var h=t,y=!1;h!==null;){if(!y){if((h.flags&524288)!==0)y=!0;else if((h.flags&262144)!==0)break}if(h.tag===10){var O=h.alternate;if(O===null)throw Error(i(387));if(O=O.memoizedProps,O!==null){var V=h.type;g(h.pendingProps.value,O.value)||(e!==null?e.push(V):e=[V])}}else if(h===oe.current){if(O=h.alternate,O===null)throw Error(i(387));O.memoizedState.memoizedState!==h.memoizedState.memoizedState&&(e!==null?e.push(nc):e=[nc])}h=h.return}e!==null&&Id(t,e,r,o),t.flags|=262144}function Gc(e){for(e=e.firstContext;e!==null;){if(!g(e.context._currentValue,e.memoizedValue))return!0;e=e.next}return!1}function ho(e){fo=e,Gs=null,e=e.dependencies,e!==null&&(e.firstContext=null)}function Gr(e){return Sp(fo,e)}function Kc(e,t){return fo===null&&ho(e),Sp(e,t)}function Sp(e,t){var r=t._currentValue;if(t={context:t,memoizedValue:r,next:null},Gs===null){if(e===null)throw Error(i(308));Gs=t,e.dependencies={lanes:0,firstContext:t},e.flags|=524288}else Gs=Gs.next=t;return r}var U0=typeof AbortController<"u"?AbortController:function(){var e=[],t=this.signal={aborted:!1,addEventListener:function(r,o){e.push(o)}};this.abort=function(){t.aborted=!0,e.forEach(function(r){return r()})}},L0=n.unstable_scheduleCallback,z0=n.unstable_NormalPriority,_r={$$typeof:q,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Rd(){return{controller:new U0,data:new Map,refCount:0}}function Dl(e){e.refCount--,e.refCount===0&&L0(z0,function(){e.controller.abort()})}var Ol=null,Md=0,Po=0,qo=null;function B0(e,t){if(Ol===null){var r=Ol=[];Md=0,Po=Bf(),qo={status:"pending",value:void 0,then:function(o){r.push(o)}}}return Md++,t.then(Ep,Ep),t}function Ep(){if(--Md===0&&Ol!==null){qo!==null&&(qo.status="fulfilled");var e=Ol;Ol=null,Po=0,qo=null;for(var t=0;t<e.length;t++)(0,e[t])()}}function F0(e,t){var r=[],o={status:"pending",value:null,reason:null,then:function(h){r.push(h)}};return e.then(function(){o.status="fulfilled",o.value=t;for(var h=0;h<r.length;h++)(0,r[h])(t)},function(h){for(o.status="rejected",o.reason=h,h=0;h<r.length;h++)(0,r[h])(void 0)}),o}var kp=J.S;J.S=function(e,t){lg=at(),typeof t=="object"&&t!==null&&typeof t.then=="function"&&B0(e,t),kp!==null&&kp(e,t)};var po=T(null);function Ud(){var e=po.current;return e!==null?e:Kn.pooledCache}function Yc(e,t){t===null?ne(po,po.current):ne(po,t.pool)}function Ap(){var e=Ud();return e===null?null:{parent:_r._currentValue,pool:e}}var Go=Error(i(460)),Ld=Error(i(474)),$c=Error(i(542)),Vc={then:function(){}};function Tp(e){return e=e.status,e==="fulfilled"||e==="rejected"}function Cp(e,t,r){switch(r=e[r],r===void 0?e.push(t):r!==t&&(t.then(cr,cr),t=r),t.status){case"fulfilled":return t.value;case"rejected":throw e=t.reason,Dp(e),e;default:if(typeof t.status=="string")t.then(cr,cr);else{if(e=Kn,e!==null&&100<e.shellSuspendCounter)throw Error(i(482));e=t,e.status="pending",e.then(function(o){if(t.status==="pending"){var h=t;h.status="fulfilled",h.value=o}},function(o){if(t.status==="pending"){var h=t;h.status="rejected",h.reason=o}})}switch(t.status){case"fulfilled":return t.value;case"rejected":throw e=t.reason,Dp(e),e}throw go=t,Go}}function mo(e){try{var t=e._init;return t(e._payload)}catch(r){throw r!==null&&typeof r=="object"&&typeof r.then=="function"?(go=r,Go):r}}var go=null;function Np(){if(go===null)throw Error(i(459));var e=go;return go=null,e}function Dp(e){if(e===Go||e===$c)throw Error(i(483))}var Ko=null,jl=0;function Zc(e){var t=jl;return jl+=1,Ko===null&&(Ko=[]),Cp(Ko,e,t)}function Il(e,t){t=t.props.ref,e.ref=t!==void 0?t:null}function Qc(e,t){throw t.$$typeof===N?Error(i(525)):(e=Object.prototype.toString.call(t),Error(i(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)))}function Op(e){function t(Ie,Se){if(e){var Le=Ie.deletions;Le===null?(Ie.deletions=[Se],Ie.flags|=16):Le.push(Se)}}function r(Ie,Se){if(!e)return null;for(;Se!==null;)t(Ie,Se),Se=Se.sibling;return null}function o(Ie){for(var Se=new Map;Ie!==null;)Ie.key!==null?Se.set(Ie.key,Ie):Se.set(Ie.index,Ie),Ie=Ie.sibling;return Se}function h(Ie,Se){return Ie=Ps(Ie,Se),Ie.index=0,Ie.sibling=null,Ie}function y(Ie,Se,Le){return Ie.index=Le,e?(Le=Ie.alternate,Le!==null?(Le=Le.index,Le<Se?(Ie.flags|=67108866,Se):Le):(Ie.flags|=67108866,Se)):(Ie.flags|=1048576,Se)}function O(Ie){return e&&Ie.alternate===null&&(Ie.flags|=67108866),Ie}function V(Ie,Se,Le,tt){return Se===null||Se.tag!==6?(Se=kd(Le,Ie.mode,tt),Se.return=Ie,Se):(Se=h(Se,Le),Se.return=Ie,Se)}function pe(Ie,Se,Le,tt){var Lt=Le.type;return Lt===A?Qe(Ie,Se,Le.props.children,tt,Le.key):Se!==null&&(Se.elementType===Lt||typeof Lt=="object"&&Lt!==null&&Lt.$$typeof===L&&mo(Lt)===Se.type)?(Se=h(Se,Le.props),Il(Se,Le),Se.return=Ie,Se):(Se=Pc(Le.type,Le.key,Le.props,null,Ie.mode,tt),Il(Se,Le),Se.return=Ie,Se)}function ze(Ie,Se,Le,tt){return Se===null||Se.tag!==4||Se.stateNode.containerInfo!==Le.containerInfo||Se.stateNode.implementation!==Le.implementation?(Se=Ad(Le,Ie.mode,tt),Se.return=Ie,Se):(Se=h(Se,Le.children||[]),Se.return=Ie,Se)}function Qe(Ie,Se,Le,tt,Lt){return Se===null||Se.tag!==7?(Se=co(Le,Ie.mode,tt,Lt),Se.return=Ie,Se):(Se=h(Se,Le),Se.return=Ie,Se)}function nt(Ie,Se,Le){if(typeof Se=="string"&&Se!==""||typeof Se=="number"||typeof Se=="bigint")return Se=kd(""+Se,Ie.mode,Le),Se.return=Ie,Se;if(typeof Se=="object"&&Se!==null){switch(Se.$$typeof){case S:return Le=Pc(Se.type,Se.key,Se.props,null,Ie.mode,Le),Il(Le,Se),Le.return=Ie,Le;case I:return Se=Ad(Se,Ie.mode,Le),Se.return=Ie,Se;case L:return Se=mo(Se),nt(Ie,Se,Le)}if(he(Se)||F(Se))return Se=co(Se,Ie.mode,Le,null),Se.return=Ie,Se;if(typeof Se.then=="function")return nt(Ie,Zc(Se),Le);if(Se.$$typeof===q)return nt(Ie,Kc(Ie,Se),Le);Qc(Ie,Se)}return null}function Pe(Ie,Se,Le,tt){var Lt=Se!==null?Se.key:null;if(typeof Le=="string"&&Le!==""||typeof Le=="number"||typeof Le=="bigint")return Lt!==null?null:V(Ie,Se,""+Le,tt);if(typeof Le=="object"&&Le!==null){switch(Le.$$typeof){case S:return Le.key===Lt?pe(Ie,Se,Le,tt):null;case I:return Le.key===Lt?ze(Ie,Se,Le,tt):null;case L:return Le=mo(Le),Pe(Ie,Se,Le,tt)}if(he(Le)||F(Le))return Lt!==null?null:Qe(Ie,Se,Le,tt,null);if(typeof Le.then=="function")return Pe(Ie,Se,Zc(Le),tt);if(Le.$$typeof===q)return Pe(Ie,Se,Kc(Ie,Le),tt);Qc(Ie,Le)}return null}function Ke(Ie,Se,Le,tt,Lt){if(typeof tt=="string"&&tt!==""||typeof tt=="number"||typeof tt=="bigint")return Ie=Ie.get(Le)||null,V(Se,Ie,""+tt,Lt);if(typeof tt=="object"&&tt!==null){switch(tt.$$typeof){case S:return Ie=Ie.get(tt.key===null?Le:tt.key)||null,pe(Se,Ie,tt,Lt);case I:return Ie=Ie.get(tt.key===null?Le:tt.key)||null,ze(Se,Ie,tt,Lt);case L:return tt=mo(tt),Ke(Ie,Se,Le,tt,Lt)}if(he(tt)||F(tt))return Ie=Ie.get(Le)||null,Qe(Se,Ie,tt,Lt,null);if(typeof tt.then=="function")return Ke(Ie,Se,Le,Zc(tt),Lt);if(tt.$$typeof===q)return Ke(Ie,Se,Le,Kc(Se,tt),Lt);Qc(Se,tt)}return null}function Ct(Ie,Se,Le,tt){for(var Lt=null,Cn=null,jt=Se,ln=Se=0,vn=null;jt!==null&&ln<Le.length;ln++){jt.index>ln?(vn=jt,jt=null):vn=jt.sibling;var Nn=Pe(Ie,jt,Le[ln],tt);if(Nn===null){jt===null&&(jt=vn);break}e&&jt&&Nn.alternate===null&&t(Ie,jt),Se=y(Nn,Se,ln),Cn===null?Lt=Nn:Cn.sibling=Nn,Cn=Nn,jt=vn}if(ln===Le.length)return r(Ie,jt),_n&&qs(Ie,ln),Lt;if(jt===null){for(;ln<Le.length;ln++)jt=nt(Ie,Le[ln],tt),jt!==null&&(Se=y(jt,Se,ln),Cn===null?Lt=jt:Cn.sibling=jt,Cn=jt);return _n&&qs(Ie,ln),Lt}for(jt=o(jt);ln<Le.length;ln++)vn=Ke(jt,Ie,ln,Le[ln],tt),vn!==null&&(e&&vn.alternate!==null&&jt.delete(vn.key===null?ln:vn.key),Se=y(vn,Se,ln),Cn===null?Lt=vn:Cn.sibling=vn,Cn=vn);return e&&jt.forEach(function(Gi){return t(Ie,Gi)}),_n&&qs(Ie,ln),Lt}function qt(Ie,Se,Le,tt){if(Le==null)throw Error(i(151));for(var Lt=null,Cn=null,jt=Se,ln=Se=0,vn=null,Nn=Le.next();jt!==null&&!Nn.done;ln++,Nn=Le.next()){jt.index>ln?(vn=jt,jt=null):vn=jt.sibling;var Gi=Pe(Ie,jt,Nn.value,tt);if(Gi===null){jt===null&&(jt=vn);break}e&&jt&&Gi.alternate===null&&t(Ie,jt),Se=y(Gi,Se,ln),Cn===null?Lt=Gi:Cn.sibling=Gi,Cn=Gi,jt=vn}if(Nn.done)return r(Ie,jt),_n&&qs(Ie,ln),Lt;if(jt===null){for(;!Nn.done;ln++,Nn=Le.next())Nn=nt(Ie,Nn.value,tt),Nn!==null&&(Se=y(Nn,Se,ln),Cn===null?Lt=Nn:Cn.sibling=Nn,Cn=Nn);return _n&&qs(Ie,ln),Lt}for(jt=o(jt);!Nn.done;ln++,Nn=Le.next())Nn=Ke(jt,Ie,ln,Nn.value,tt),Nn!==null&&(e&&Nn.alternate!==null&&jt.delete(Nn.key===null?ln:Nn.key),Se=y(Nn,Se,ln),Cn===null?Lt=Nn:Cn.sibling=Nn,Cn=Nn);return e&&jt.forEach(function(Jx){return t(Ie,Jx)}),_n&&qs(Ie,ln),Lt}function Pn(Ie,Se,Le,tt){if(typeof Le=="object"&&Le!==null&&Le.type===A&&Le.key===null&&(Le=Le.props.children),typeof Le=="object"&&Le!==null){switch(Le.$$typeof){case S:e:{for(var Lt=Le.key;Se!==null;){if(Se.key===Lt){if(Lt=Le.type,Lt===A){if(Se.tag===7){r(Ie,Se.sibling),tt=h(Se,Le.props.children),tt.return=Ie,Ie=tt;break e}}else if(Se.elementType===Lt||typeof Lt=="object"&&Lt!==null&&Lt.$$typeof===L&&mo(Lt)===Se.type){r(Ie,Se.sibling),tt=h(Se,Le.props),Il(tt,Le),tt.return=Ie,Ie=tt;break e}r(Ie,Se);break}else t(Ie,Se);Se=Se.sibling}Le.type===A?(tt=co(Le.props.children,Ie.mode,tt,Le.key),tt.return=Ie,Ie=tt):(tt=Pc(Le.type,Le.key,Le.props,null,Ie.mode,tt),Il(tt,Le),tt.return=Ie,Ie=tt)}return O(Ie);case I:e:{for(Lt=Le.key;Se!==null;){if(Se.key===Lt)if(Se.tag===4&&Se.stateNode.containerInfo===Le.containerInfo&&Se.stateNode.implementation===Le.implementation){r(Ie,Se.sibling),tt=h(Se,Le.children||[]),tt.return=Ie,Ie=tt;break e}else{r(Ie,Se);break}else t(Ie,Se);Se=Se.sibling}tt=Ad(Le,Ie.mode,tt),tt.return=Ie,Ie=tt}return O(Ie);case L:return Le=mo(Le),Pn(Ie,Se,Le,tt)}if(he(Le))return Ct(Ie,Se,Le,tt);if(F(Le)){if(Lt=F(Le),typeof Lt!="function")throw Error(i(150));return Le=Lt.call(Le),qt(Ie,Se,Le,tt)}if(typeof Le.then=="function")return Pn(Ie,Se,Zc(Le),tt);if(Le.$$typeof===q)return Pn(Ie,Se,Kc(Ie,Le),tt);Qc(Ie,Le)}return typeof Le=="string"&&Le!==""||typeof Le=="number"||typeof Le=="bigint"?(Le=""+Le,Se!==null&&Se.tag===6?(r(Ie,Se.sibling),tt=h(Se,Le),tt.return=Ie,Ie=tt):(r(Ie,Se),tt=kd(Le,Ie.mode,tt),tt.return=Ie,Ie=tt),O(Ie)):r(Ie,Se)}return function(Ie,Se,Le,tt){try{jl=0;var Lt=Pn(Ie,Se,Le,tt);return Ko=null,Lt}catch(jt){if(jt===Go||jt===$c)throw jt;var Cn=Oa(29,jt,null,Ie.mode);return Cn.lanes=tt,Cn.return=Ie,Cn}finally{}}}var yo=Op(!0),jp=Op(!1),Ti=!1;function zd(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Bd(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,callbacks:null})}function Ci(e){return{lane:e,tag:0,payload:null,callback:null,next:null}}function Ni(e,t,r){var o=e.updateQueue;if(o===null)return null;if(o=o.shared,(On&2)!==0){var h=o.pending;return h===null?t.next=t:(t.next=h.next,h.next=t),o.pending=t,t=wi(e),ks(e,null,r),t}return mr(e,o,t,r),wi(e)}function Rl(e,t,r){if(t=t.updateQueue,t!==null&&(t=t.shared,(r&4194048)!==0)){var o=t.lanes;o&=e.pendingLanes,r|=o,t.lanes=r,Dn(e,r)}}function Fd(e,t){var r=e.updateQueue,o=e.alternate;if(o!==null&&(o=o.updateQueue,r===o)){var h=null,y=null;if(r=r.firstBaseUpdate,r!==null){do{var O={lane:r.lane,tag:r.tag,payload:r.payload,callback:null,next:null};y===null?h=y=O:y=y.next=O,r=r.next}while(r!==null);y===null?h=y=t:y=y.next=t}else h=y=t;r={baseState:o.baseState,firstBaseUpdate:h,lastBaseUpdate:y,shared:o.shared,callbacks:o.callbacks},e.updateQueue=r;return}e=r.lastBaseUpdate,e===null?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}var Hd=!1;function Ml(){if(Hd){var e=qo;if(e!==null)throw e}}function Ul(e,t,r,o){Hd=!1;var h=e.updateQueue;Ti=!1;var y=h.firstBaseUpdate,O=h.lastBaseUpdate,V=h.shared.pending;if(V!==null){h.shared.pending=null;var pe=V,ze=pe.next;pe.next=null,O===null?y=ze:O.next=ze,O=pe;var Qe=e.alternate;Qe!==null&&(Qe=Qe.updateQueue,V=Qe.lastBaseUpdate,V!==O&&(V===null?Qe.firstBaseUpdate=ze:V.next=ze,Qe.lastBaseUpdate=pe))}if(y!==null){var nt=h.baseState;O=0,Qe=ze=pe=null,V=y;do{var Pe=V.lane&-536870913,Ke=Pe!==V.lane;if(Ke?(yn&Pe)===Pe:(o&Pe)===Pe){Pe!==0&&Pe===Po&&(Hd=!0),Qe!==null&&(Qe=Qe.next={lane:0,tag:V.tag,payload:V.payload,callback:null,next:null});e:{var Ct=e,qt=V;Pe=t;var Pn=r;switch(qt.tag){case 1:if(Ct=qt.payload,typeof Ct=="function"){nt=Ct.call(Pn,nt,Pe);break e}nt=Ct;break e;case 3:Ct.flags=Ct.flags&-65537|128;case 0:if(Ct=qt.payload,Pe=typeof Ct=="function"?Ct.call(Pn,nt,Pe):Ct,Pe==null)break e;nt=E({},nt,Pe);break e;case 2:Ti=!0}}Pe=V.callback,Pe!==null&&(e.flags|=64,Ke&&(e.flags|=8192),Ke=h.callbacks,Ke===null?h.callbacks=[Pe]:Ke.push(Pe))}else Ke={lane:Pe,tag:V.tag,payload:V.payload,callback:V.callback,next:null},Qe===null?(ze=Qe=Ke,pe=nt):Qe=Qe.next=Ke,O|=Pe;if(V=V.next,V===null){if(V=h.shared.pending,V===null)break;Ke=V,V=Ke.next,Ke.next=null,h.lastBaseUpdate=Ke,h.shared.pending=null}}while(!0);Qe===null&&(pe=nt),h.baseState=pe,h.firstBaseUpdate=ze,h.lastBaseUpdate=Qe,y===null&&(h.shared.lanes=0),Ri|=O,e.lanes=O,e.memoizedState=nt}}function Ip(e,t){if(typeof e!="function")throw Error(i(191,e));e.call(t)}function Rp(e,t){var r=e.callbacks;if(r!==null)for(e.callbacks=null,e=0;e<r.length;e++)Ip(r[e],t)}var Yo=T(null),Jc=T(0);function Mp(e,t){e=ei,ne(Jc,e),ne(Yo,t),ei=e|t.baseLanes}function Pd(){ne(Jc,ei),ne(Yo,Yo.current)}function qd(){ei=Jc.current,z(Yo),z(Jc)}var ja=T(null),Va=null;function Di(e){var t=e.alternate;ne(gr,gr.current&1),ne(ja,e),Va===null&&(t===null||Yo.current!==null||t.memoizedState!==null)&&(Va=e)}function Gd(e){ne(gr,gr.current),ne(ja,e),Va===null&&(Va=e)}function Up(e){e.tag===22?(ne(gr,gr.current),ne(ja,e),Va===null&&(Va=e)):Oi()}function Oi(){ne(gr,gr.current),ne(ja,ja.current)}function Ia(e){z(ja),Va===e&&(Va=null),z(gr)}var gr=T(0);function Xc(e){for(var t=e;t!==null;){if(t.tag===13){var r=t.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||Jf(r)||Xf(r)))return t}else if(t.tag===19&&(t.memoizedProps.revealOrder==="forwards"||t.memoizedProps.revealOrder==="backwards"||t.memoizedProps.revealOrder==="unstable_legacy-backwards"||t.memoizedProps.revealOrder==="together")){if((t.flags&128)!==0)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var Ys=0,an=null,Fn=null,wr=null,Wc=!1,$o=!1,vo=!1,eu=0,Ll=0,Vo=null,H0=0;function ur(){throw Error(i(321))}function Kd(e,t){if(t===null)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!g(e[r],t[r]))return!1;return!0}function Yd(e,t,r,o,h,y){return Ys=y,an=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,J.H=e===null||e.memoizedState===null?bm:lf,vo=!1,y=r(o,h),vo=!1,$o&&(y=zp(t,r,o,h)),Lp(e),y}function Lp(e){J.H=Fl;var t=Fn!==null&&Fn.next!==null;if(Ys=0,wr=Fn=an=null,Wc=!1,Ll=0,Vo=null,t)throw Error(i(300));e===null||Sr||(e=e.dependencies,e!==null&&Gc(e)&&(Sr=!0))}function zp(e,t,r,o){an=e;var h=0;do{if($o&&(Vo=null),Ll=0,$o=!1,25<=h)throw Error(i(301));if(h+=1,wr=Fn=null,e.updateQueue!=null){var y=e.updateQueue;y.lastEffect=null,y.events=null,y.stores=null,y.memoCache!=null&&(y.memoCache.index=0)}J.H=xm,y=t(r,o)}while($o);return y}function P0(){var e=J.H,t=e.useState()[0];return t=typeof t.then=="function"?zl(t):t,e=e.useState()[0],(Fn!==null?Fn.memoizedState:null)!==e&&(an.flags|=1024),t}function $d(){var e=eu!==0;return eu=0,e}function Vd(e,t,r){t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~r}function Zd(e){if(Wc){for(e=e.memoizedState;e!==null;){var t=e.queue;t!==null&&(t.pending=null),e=e.next}Wc=!1}Ys=0,wr=Fn=an=null,$o=!1,Ll=eu=0,Vo=null}function ia(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return wr===null?an.memoizedState=wr=e:wr=wr.next=e,wr}function yr(){if(Fn===null){var e=an.alternate;e=e!==null?e.memoizedState:null}else e=Fn.next;var t=wr===null?an.memoizedState:wr.next;if(t!==null)wr=t,Fn=e;else{if(e===null)throw an.alternate===null?Error(i(467)):Error(i(310));Fn=e,e={memoizedState:Fn.memoizedState,baseState:Fn.baseState,baseQueue:Fn.baseQueue,queue:Fn.queue,next:null},wr===null?an.memoizedState=wr=e:wr=wr.next=e}return wr}function tu(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function zl(e){var t=Ll;return Ll+=1,Vo===null&&(Vo=[]),e=Cp(Vo,e,t),t=an,(wr===null?t.memoizedState:wr.next)===null&&(t=t.alternate,J.H=t===null||t.memoizedState===null?bm:lf),e}function nu(e){if(e!==null&&typeof e=="object"){if(typeof e.then=="function")return zl(e);if(e.$$typeof===q)return Gr(e)}throw Error(i(438,String(e)))}function Qd(e){var t=null,r=an.updateQueue;if(r!==null&&(t=r.memoCache),t==null){var o=an.alternate;o!==null&&(o=o.updateQueue,o!==null&&(o=o.memoCache,o!=null&&(t={data:o.data.map(function(h){return h.slice()}),index:0})))}if(t==null&&(t={data:[],index:0}),r===null&&(r=tu(),an.updateQueue=r),r.memoCache=t,r=t.data[t.index],r===void 0)for(r=t.data[t.index]=Array(e),o=0;o<e;o++)r[o]=Q;return t.index++,r}function $s(e,t){return typeof t=="function"?t(e):t}function ru(e){var t=yr();return Jd(t,Fn,e)}function Jd(e,t,r){var o=e.queue;if(o===null)throw Error(i(311));o.lastRenderedReducer=r;var h=e.baseQueue,y=o.pending;if(y!==null){if(h!==null){var O=h.next;h.next=y.next,y.next=O}t.baseQueue=h=y,o.pending=null}if(y=e.baseState,h===null)e.memoizedState=y;else{t=h.next;var V=O=null,pe=null,ze=t,Qe=!1;do{var nt=ze.lane&-536870913;if(nt!==ze.lane?(yn&nt)===nt:(Ys&nt)===nt){var Pe=ze.revertLane;if(Pe===0)pe!==null&&(pe=pe.next={lane:0,revertLane:0,gesture:null,action:ze.action,hasEagerState:ze.hasEagerState,eagerState:ze.eagerState,next:null}),nt===Po&&(Qe=!0);else if((Ys&Pe)===Pe){ze=ze.next,Pe===Po&&(Qe=!0);continue}else nt={lane:0,revertLane:ze.revertLane,gesture:null,action:ze.action,hasEagerState:ze.hasEagerState,eagerState:ze.eagerState,next:null},pe===null?(V=pe=nt,O=y):pe=pe.next=nt,an.lanes|=Pe,Ri|=Pe;nt=ze.action,vo&&r(y,nt),y=ze.hasEagerState?ze.eagerState:r(y,nt)}else Pe={lane:nt,revertLane:ze.revertLane,gesture:ze.gesture,action:ze.action,hasEagerState:ze.hasEagerState,eagerState:ze.eagerState,next:null},pe===null?(V=pe=Pe,O=y):pe=pe.next=Pe,an.lanes|=nt,Ri|=nt;ze=ze.next}while(ze!==null&&ze!==t);if(pe===null?O=y:pe.next=V,!g(y,e.memoizedState)&&(Sr=!0,Qe&&(r=qo,r!==null)))throw r;e.memoizedState=y,e.baseState=O,e.baseQueue=pe,o.lastRenderedState=y}return h===null&&(o.lanes=0),[e.memoizedState,o.dispatch]}function Xd(e){var t=yr(),r=t.queue;if(r===null)throw Error(i(311));r.lastRenderedReducer=e;var o=r.dispatch,h=r.pending,y=t.memoizedState;if(h!==null){r.pending=null;var O=h=h.next;do y=e(y,O.action),O=O.next;while(O!==h);g(y,t.memoizedState)||(Sr=!0),t.memoizedState=y,t.baseQueue===null&&(t.baseState=y),r.lastRenderedState=y}return[y,o]}function Bp(e,t,r){var o=an,h=yr(),y=_n;if(y){if(r===void 0)throw Error(i(407));r=r()}else r=t();var O=!g((Fn||h).memoizedState,r);if(O&&(h.memoizedState=r,Sr=!0),h=h.queue,tf(Pp.bind(null,o,h,e),[e]),h.getSnapshot!==t||O||wr!==null&&wr.memoizedState.tag&1){if(o.flags|=2048,Zo(9,{destroy:void 0},Hp.bind(null,o,h,r,t),null),Kn===null)throw Error(i(349));y||(Ys&127)!==0||Fp(o,t,r)}return r}function Fp(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},t=an.updateQueue,t===null?(t=tu(),an.updateQueue=t,t.stores=[e]):(r=t.stores,r===null?t.stores=[e]:r.push(e))}function Hp(e,t,r,o){t.value=r,t.getSnapshot=o,qp(t)&&Gp(e)}function Pp(e,t,r){return r(function(){qp(t)&&Gp(e)})}function qp(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!g(e,r)}catch{return!0}}function Gp(e){var t=ar(e,2);t!==null&&wa(t,e,2)}function Wd(e){var t=ia();if(typeof e=="function"){var r=e;if(e=r(),vo){yt(!0);try{r()}finally{yt(!1)}}}return t.memoizedState=t.baseState=e,t.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:$s,lastRenderedState:e},t}function Kp(e,t,r,o){return e.baseState=r,Jd(e,Fn,typeof o=="function"?o:$s)}function q0(e,t,r,o,h){if(iu(e))throw Error(i(485));if(e=t.action,e!==null){var y={payload:h,action:e,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(O){y.listeners.push(O)}};J.T!==null?r(!0):y.isTransition=!1,o(y),r=t.pending,r===null?(y.next=t.pending=y,Yp(t,y)):(y.next=r.next,t.pending=r.next=y)}}function Yp(e,t){var r=t.action,o=t.payload,h=e.state;if(t.isTransition){var y=J.T,O={};J.T=O;try{var V=r(h,o),pe=J.S;pe!==null&&pe(O,V),$p(e,t,V)}catch(ze){ef(e,t,ze)}finally{y!==null&&O.types!==null&&(y.types=O.types),J.T=y}}else try{y=r(h,o),$p(e,t,y)}catch(ze){ef(e,t,ze)}}function $p(e,t,r){r!==null&&typeof r=="object"&&typeof r.then=="function"?r.then(function(o){Vp(e,t,o)},function(o){return ef(e,t,o)}):Vp(e,t,r)}function Vp(e,t,r){t.status="fulfilled",t.value=r,Zp(t),e.state=r,t=e.pending,t!==null&&(r=t.next,r===t?e.pending=null:(r=r.next,t.next=r,Yp(e,r)))}function ef(e,t,r){var o=e.pending;if(e.pending=null,o!==null){o=o.next;do t.status="rejected",t.reason=r,Zp(t),t=t.next;while(t!==o)}e.action=null}function Zp(e){e=e.listeners;for(var t=0;t<e.length;t++)(0,e[t])()}function Qp(e,t){return t}function Jp(e,t){if(_n){var r=Kn.formState;if(r!==null){e:{var o=an;if(_n){if(Qn){t:{for(var h=Qn,y=$a;h.nodeType!==8;){if(!y){h=null;break t}if(h=Za(h.nextSibling),h===null){h=null;break t}}y=h.data,h=y==="F!"||y==="F"?h:null}if(h){Qn=Za(h.nextSibling),o=h.data==="F!";break e}}ki(o)}o=!1}o&&(t=r[0])}}return r=ia(),r.memoizedState=r.baseState=t,o={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Qp,lastRenderedState:t},r.queue=o,r=gm.bind(null,an,o),o.dispatch=r,o=Wd(!1),y=of.bind(null,an,!1,o.queue),o=ia(),h={state:t,dispatch:null,action:e,pending:null},o.queue=h,r=q0.bind(null,an,h,y,r),h.dispatch=r,o.memoizedState=e,[t,r,!1]}function Xp(e){var t=yr();return Wp(t,Fn,e)}function Wp(e,t,r){if(t=Jd(e,t,Qp)[0],e=ru($s)[0],typeof t=="object"&&t!==null&&typeof t.then=="function")try{var o=zl(t)}catch(O){throw O===Go?$c:O}else o=t;t=yr();var h=t.queue,y=h.dispatch;return r!==t.memoizedState&&(an.flags|=2048,Zo(9,{destroy:void 0},G0.bind(null,h,r),null)),[o,y,e]}function G0(e,t){e.action=t}function em(e){var t=yr(),r=Fn;if(r!==null)return Wp(t,r,e);yr(),t=t.memoizedState,r=yr();var o=r.queue.dispatch;return r.memoizedState=e,[t,o,!1]}function Zo(e,t,r,o){return e={tag:e,create:r,deps:o,inst:t,next:null},t=an.updateQueue,t===null&&(t=tu(),an.updateQueue=t),r=t.lastEffect,r===null?t.lastEffect=e.next=e:(o=r.next,r.next=e,e.next=o,t.lastEffect=e),e}function tm(){return yr().memoizedState}function au(e,t,r,o){var h=ia();an.flags|=e,h.memoizedState=Zo(1|t,{destroy:void 0},r,o===void 0?null:o)}function su(e,t,r,o){var h=yr();o=o===void 0?null:o;var y=h.memoizedState.inst;Fn!==null&&o!==null&&Kd(o,Fn.memoizedState.deps)?h.memoizedState=Zo(t,y,r,o):(an.flags|=e,h.memoizedState=Zo(1|t,y,r,o))}function nm(e,t){au(8390656,8,e,t)}function tf(e,t){su(2048,8,e,t)}function K0(e){an.flags|=4;var t=an.updateQueue;if(t===null)t=tu(),an.updateQueue=t,t.events=[e];else{var r=t.events;r===null?t.events=[e]:r.push(e)}}function rm(e){var t=yr().memoizedState;return K0({ref:t,nextImpl:e}),function(){if((On&2)!==0)throw Error(i(440));return t.impl.apply(void 0,arguments)}}function am(e,t){return su(4,2,e,t)}function sm(e,t){return su(4,4,e,t)}function im(e,t){if(typeof t=="function"){e=e();var r=t(e);return function(){typeof r=="function"?r():t(null)}}if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function om(e,t,r){r=r!=null?r.concat([e]):null,su(4,4,im.bind(null,t,e),r)}function nf(){}function lm(e,t){var r=yr();t=t===void 0?null:t;var o=r.memoizedState;return t!==null&&Kd(t,o[1])?o[0]:(r.memoizedState=[e,t],e)}function cm(e,t){var r=yr();t=t===void 0?null:t;var o=r.memoizedState;if(t!==null&&Kd(t,o[1]))return o[0];if(o=e(),vo){yt(!0);try{e()}finally{yt(!1)}}return r.memoizedState=[o,t],o}function rf(e,t,r){return r===void 0||(Ys&1073741824)!==0&&(yn&261930)===0?e.memoizedState=t:(e.memoizedState=r,e=ug(),an.lanes|=e,Ri|=e,r)}function um(e,t,r,o){return g(r,t)?r:Yo.current!==null?(e=rf(e,r,o),g(e,t)||(Sr=!0),e):(Ys&42)===0||(Ys&1073741824)!==0&&(yn&261930)===0?(Sr=!0,e.memoizedState=r):(e=ug(),an.lanes|=e,Ri|=e,t)}function dm(e,t,r,o,h){var y=Z.p;Z.p=y!==0&&8>y?y:8;var O=J.T,V={};J.T=V,of(e,!1,t,r);try{var pe=h(),ze=J.S;if(ze!==null&&ze(V,pe),pe!==null&&typeof pe=="object"&&typeof pe.then=="function"){var Qe=F0(pe,o);Bl(e,t,Qe,Ua(e))}else Bl(e,t,o,Ua(e))}catch(nt){Bl(e,t,{then:function(){},status:"rejected",reason:nt},Ua())}finally{Z.p=y,O!==null&&V.types!==null&&(O.types=V.types),J.T=O}}function Y0(){}function af(e,t,r,o){if(e.tag!==5)throw Error(i(476));var h=fm(e).queue;dm(e,h,t,De,r===null?Y0:function(){return hm(e),r(o)})}function fm(e){var t=e.memoizedState;if(t!==null)return t;t={memoizedState:De,baseState:De,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:$s,lastRenderedState:De},next:null};var r={};return t.next={memoizedState:r,baseState:r,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:$s,lastRenderedState:r},next:null},e.memoizedState=t,e=e.alternate,e!==null&&(e.memoizedState=t),t}function hm(e){var t=fm(e);t.next===null&&(t=e.alternate.memoizedState),Bl(e,t.next.queue,{},Ua())}function sf(){return Gr(nc)}function pm(){return yr().memoizedState}function mm(){return yr().memoizedState}function $0(e){for(var t=e.return;t!==null;){switch(t.tag){case 24:case 3:var r=Ua();e=Ci(r);var o=Ni(t,e,r);o!==null&&(wa(o,t,r),Rl(o,t,r)),t={cache:Rd()},e.payload=t;return}t=t.return}}function V0(e,t,r){var o=Ua();r={lane:o,revertLane:0,gesture:null,action:r,hasEagerState:!1,eagerState:null,next:null},iu(e)?ym(t,r):(r=_i(e,t,r,o),r!==null&&(wa(r,e,o),vm(r,t,o)))}function gm(e,t,r){var o=Ua();Bl(e,t,r,o)}function Bl(e,t,r,o){var h={lane:o,revertLane:0,gesture:null,action:r,hasEagerState:!1,eagerState:null,next:null};if(iu(e))ym(t,h);else{var y=e.alternate;if(e.lanes===0&&(y===null||y.lanes===0)&&(y=t.lastRenderedReducer,y!==null))try{var O=t.lastRenderedState,V=y(O,r);if(h.hasEagerState=!0,h.eagerState=V,g(V,O))return mr(e,t,h,0),Kn===null&&pr(),!1}catch{}finally{}if(r=_i(e,t,h,o),r!==null)return wa(r,e,o),vm(r,t,o),!0}return!1}function of(e,t,r,o){if(o={lane:2,revertLane:Bf(),gesture:null,action:o,hasEagerState:!1,eagerState:null,next:null},iu(e)){if(t)throw Error(i(479))}else t=_i(e,r,o,2),t!==null&&wa(t,e,2)}function iu(e){var t=e.alternate;return e===an||t!==null&&t===an}function ym(e,t){$o=Wc=!0;var r=e.pending;r===null?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function vm(e,t,r){if((r&4194048)!==0){var o=t.lanes;o&=e.pendingLanes,r|=o,t.lanes=r,Dn(e,r)}}var Fl={readContext:Gr,use:nu,useCallback:ur,useContext:ur,useEffect:ur,useImperativeHandle:ur,useLayoutEffect:ur,useInsertionEffect:ur,useMemo:ur,useReducer:ur,useRef:ur,useState:ur,useDebugValue:ur,useDeferredValue:ur,useTransition:ur,useSyncExternalStore:ur,useId:ur,useHostTransitionStatus:ur,useFormState:ur,useActionState:ur,useOptimistic:ur,useMemoCache:ur,useCacheRefresh:ur};Fl.useEffectEvent=ur;var bm={readContext:Gr,use:nu,useCallback:function(e,t){return ia().memoizedState=[e,t===void 0?null:t],e},useContext:Gr,useEffect:nm,useImperativeHandle:function(e,t,r){r=r!=null?r.concat([e]):null,au(4194308,4,im.bind(null,t,e),r)},useLayoutEffect:function(e,t){return au(4194308,4,e,t)},useInsertionEffect:function(e,t){au(4,2,e,t)},useMemo:function(e,t){var r=ia();t=t===void 0?null:t;var o=e();if(vo){yt(!0);try{e()}finally{yt(!1)}}return r.memoizedState=[o,t],o},useReducer:function(e,t,r){var o=ia();if(r!==void 0){var h=r(t);if(vo){yt(!0);try{r(t)}finally{yt(!1)}}}else h=t;return o.memoizedState=o.baseState=h,e={pending:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:h},o.queue=e,e=e.dispatch=V0.bind(null,an,e),[o.memoizedState,e]},useRef:function(e){var t=ia();return e={current:e},t.memoizedState=e},useState:function(e){e=Wd(e);var t=e.queue,r=gm.bind(null,an,t);return t.dispatch=r,[e.memoizedState,r]},useDebugValue:nf,useDeferredValue:function(e,t){var r=ia();return rf(r,e,t)},useTransition:function(){var e=Wd(!1);return e=dm.bind(null,an,e.queue,!0,!1),ia().memoizedState=e,[!1,e]},useSyncExternalStore:function(e,t,r){var o=an,h=ia();if(_n){if(r===void 0)throw Error(i(407));r=r()}else{if(r=t(),Kn===null)throw Error(i(349));(yn&127)!==0||Fp(o,t,r)}h.memoizedState=r;var y={value:r,getSnapshot:t};return h.queue=y,nm(Pp.bind(null,o,y,e),[e]),o.flags|=2048,Zo(9,{destroy:void 0},Hp.bind(null,o,y,r,t),null),r},useId:function(){var e=ia(),t=Kn.identifierPrefix;if(_n){var r=Ts,o=As;r=(o&~(1<<32-tn(o)-1)).toString(32)+r,t="_"+t+"R_"+r,r=eu++,0<r&&(t+="H"+r.toString(32)),t+="_"}else r=H0++,t="_"+t+"r_"+r.toString(32)+"_";return e.memoizedState=t},useHostTransitionStatus:sf,useFormState:Jp,useActionState:Jp,useOptimistic:function(e){var t=ia();t.memoizedState=t.baseState=e;var r={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return t.queue=r,t=of.bind(null,an,!0,r),r.dispatch=t,[e,t]},useMemoCache:Qd,useCacheRefresh:function(){return ia().memoizedState=$0.bind(null,an)},useEffectEvent:function(e){var t=ia(),r={impl:e};return t.memoizedState=r,function(){if((On&2)!==0)throw Error(i(440));return r.impl.apply(void 0,arguments)}}},lf={readContext:Gr,use:nu,useCallback:lm,useContext:Gr,useEffect:tf,useImperativeHandle:om,useInsertionEffect:am,useLayoutEffect:sm,useMemo:cm,useReducer:ru,useRef:tm,useState:function(){return ru($s)},useDebugValue:nf,useDeferredValue:function(e,t){var r=yr();return um(r,Fn.memoizedState,e,t)},useTransition:function(){var e=ru($s)[0],t=yr().memoizedState;return[typeof e=="boolean"?e:zl(e),t]},useSyncExternalStore:Bp,useId:pm,useHostTransitionStatus:sf,useFormState:Xp,useActionState:Xp,useOptimistic:function(e,t){var r=yr();return Kp(r,Fn,e,t)},useMemoCache:Qd,useCacheRefresh:mm};lf.useEffectEvent=rm;var xm={readContext:Gr,use:nu,useCallback:lm,useContext:Gr,useEffect:tf,useImperativeHandle:om,useInsertionEffect:am,useLayoutEffect:sm,useMemo:cm,useReducer:Xd,useRef:tm,useState:function(){return Xd($s)},useDebugValue:nf,useDeferredValue:function(e,t){var r=yr();return Fn===null?rf(r,e,t):um(r,Fn.memoizedState,e,t)},useTransition:function(){var e=Xd($s)[0],t=yr().memoizedState;return[typeof e=="boolean"?e:zl(e),t]},useSyncExternalStore:Bp,useId:pm,useHostTransitionStatus:sf,useFormState:em,useActionState:em,useOptimistic:function(e,t){var r=yr();return Fn!==null?Kp(r,Fn,e,t):(r.baseState=e,[e,r.queue.dispatch])},useMemoCache:Qd,useCacheRefresh:mm};xm.useEffectEvent=rm;function cf(e,t,r,o){t=e.memoizedState,r=r(o,t),r=r==null?t:E({},t,r),e.memoizedState=r,e.lanes===0&&(e.updateQueue.baseState=r)}var uf={enqueueSetState:function(e,t,r){e=e._reactInternals;var o=Ua(),h=Ci(o);h.payload=t,r!=null&&(h.callback=r),t=Ni(e,h,o),t!==null&&(wa(t,e,o),Rl(t,e,o))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var o=Ua(),h=Ci(o);h.tag=1,h.payload=t,r!=null&&(h.callback=r),t=Ni(e,h,o),t!==null&&(wa(t,e,o),Rl(t,e,o))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=Ua(),o=Ci(r);o.tag=2,t!=null&&(o.callback=t),t=Ni(e,o,r),t!==null&&(wa(t,e,r),Rl(t,e,r))}};function _m(e,t,r,o,h,y,O){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(o,y,O):t.prototype&&t.prototype.isPureReactComponent?!w(r,o)||!w(h,y):!0}function wm(e,t,r,o){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(r,o),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(r,o),t.state!==e&&uf.enqueueReplaceState(t,t.state,null)}function bo(e,t){var r=t;if("ref"in t){r={};for(var o in t)o!=="ref"&&(r[o]=t[o])}if(e=e.defaultProps){r===t&&(r=E({},r));for(var h in e)r[h]===void 0&&(r[h]=e[h])}return r}function Sm(e){Wt(e)}function Em(e){console.error(e)}function km(e){Wt(e)}function ou(e,t){try{var r=e.onUncaughtError;r(t.value,{componentStack:t.stack})}catch(o){setTimeout(function(){throw o})}}function Am(e,t,r){try{var o=e.onCaughtError;o(r.value,{componentStack:r.stack,errorBoundary:t.tag===1?t.stateNode:null})}catch(h){setTimeout(function(){throw h})}}function df(e,t,r){return r=Ci(r),r.tag=3,r.payload={element:null},r.callback=function(){ou(e,t)},r}function Tm(e){return e=Ci(e),e.tag=3,e}function Cm(e,t,r,o){var h=r.type.getDerivedStateFromError;if(typeof h=="function"){var y=o.value;e.payload=function(){return h(y)},e.callback=function(){Am(t,r,o)}}var O=r.stateNode;O!==null&&typeof O.componentDidCatch=="function"&&(e.callback=function(){Am(t,r,o),typeof h!="function"&&(Mi===null?Mi=new Set([this]):Mi.add(this));var V=o.stack;this.componentDidCatch(o.value,{componentStack:V!==null?V:""})})}function Z0(e,t,r,o,h){if(r.flags|=32768,o!==null&&typeof o=="object"&&typeof o.then=="function"){if(t=r.alternate,t!==null&&Ho(t,r,h,!0),r=ja.current,r!==null){switch(r.tag){case 31:case 13:return Va===null?bu():r.alternate===null&&dr===0&&(dr=3),r.flags&=-257,r.flags|=65536,r.lanes=h,o===Vc?r.flags|=16384:(t=r.updateQueue,t===null?r.updateQueue=new Set([o]):t.add(o),Uf(e,o,h)),!1;case 22:return r.flags|=65536,o===Vc?r.flags|=16384:(t=r.updateQueue,t===null?(t={transitions:null,markerInstances:null,retryQueue:new Set([o])},r.updateQueue=t):(r=t.retryQueue,r===null?t.retryQueue=new Set([o]):r.add(o)),Uf(e,o,h)),!1}throw Error(i(435,r.tag))}return Uf(e,o,h),bu(),!1}if(_n)return t=ja.current,t!==null?((t.flags&65536)===0&&(t.flags|=256),t.flags|=65536,t.lanes=h,o!==Nd&&(e=Error(i(422),{cause:o}),Nl(Ga(e,r)))):(o!==Nd&&(t=Error(i(423),{cause:o}),Nl(Ga(t,r))),e=e.current.alternate,e.flags|=65536,h&=-h,e.lanes|=h,o=Ga(o,r),h=df(e.stateNode,o,h),Fd(e,h),dr!==4&&(dr=2)),!1;var y=Error(i(520),{cause:o});if(y=Ga(y,r),Vl===null?Vl=[y]:Vl.push(y),dr!==4&&(dr=2),t===null)return!0;o=Ga(o,r),r=t;do{switch(r.tag){case 3:return r.flags|=65536,e=h&-h,r.lanes|=e,e=df(r.stateNode,o,e),Fd(r,e),!1;case 1:if(t=r.type,y=r.stateNode,(r.flags&128)===0&&(typeof t.getDerivedStateFromError=="function"||y!==null&&typeof y.componentDidCatch=="function"&&(Mi===null||!Mi.has(y))))return r.flags|=65536,h&=-h,r.lanes|=h,h=Tm(h),Cm(h,e,r,o),Fd(r,h),!1}r=r.return}while(r!==null);return!1}var ff=Error(i(461)),Sr=!1;function Kr(e,t,r,o){t.child=e===null?jp(t,null,r,o):yo(t,e.child,r,o)}function Nm(e,t,r,o,h){r=r.render;var y=t.ref;if("ref"in o){var O={};for(var V in o)V!=="ref"&&(O[V]=o[V])}else O=o;return ho(t),o=Yd(e,t,r,O,y,h),V=$d(),e!==null&&!Sr?(Vd(e,t,h),Vs(e,t,h)):(_n&&V&&Td(t),t.flags|=1,Kr(e,t,o,h),t.child)}function Dm(e,t,r,o,h){if(e===null){var y=r.type;return typeof y=="function"&&!Ed(y)&&y.defaultProps===void 0&&r.compare===null?(t.tag=15,t.type=y,Om(e,t,y,o,h)):(e=Pc(r.type,null,o,t,t.mode,h),e.ref=t.ref,e.return=t,t.child=e)}if(y=e.child,!xf(e,h)){var O=y.memoizedProps;if(r=r.compare,r=r!==null?r:w,r(O,o)&&e.ref===t.ref)return Vs(e,t,h)}return t.flags|=1,e=Ps(y,o),e.ref=t.ref,e.return=t,t.child=e}function Om(e,t,r,o,h){if(e!==null){var y=e.memoizedProps;if(w(y,o)&&e.ref===t.ref)if(Sr=!1,t.pendingProps=o=y,xf(e,h))(e.flags&131072)!==0&&(Sr=!0);else return t.lanes=e.lanes,Vs(e,t,h)}return hf(e,t,r,o,h)}function jm(e,t,r,o){var h=o.children,y=e!==null?e.memoizedState:null;if(e===null&&t.stateNode===null&&(t.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),o.mode==="hidden"){if((t.flags&128)!==0){if(y=y!==null?y.baseLanes|r:r,e!==null){for(o=t.child=e.child,h=0;o!==null;)h=h|o.lanes|o.childLanes,o=o.sibling;o=h&~y}else o=0,t.child=null;return Im(e,t,y,r,o)}if((r&536870912)!==0)t.memoizedState={baseLanes:0,cachePool:null},e!==null&&Yc(t,y!==null?y.cachePool:null),y!==null?Mp(t,y):Pd(),Up(t);else return o=t.lanes=536870912,Im(e,t,y!==null?y.baseLanes|r:r,r,o)}else y!==null?(Yc(t,y.cachePool),Mp(t,y),Oi(),t.memoizedState=null):(e!==null&&Yc(t,null),Pd(),Oi());return Kr(e,t,h,r),t.child}function Hl(e,t){return e!==null&&e.tag===22||t.stateNode!==null||(t.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),t.sibling}function Im(e,t,r,o,h){var y=Ud();return y=y===null?null:{parent:_r._currentValue,pool:y},t.memoizedState={baseLanes:r,cachePool:y},e!==null&&Yc(t,null),Pd(),Up(t),e!==null&&Ho(e,t,o,!0),t.childLanes=h,null}function lu(e,t){return t=uu({mode:t.mode,children:t.children},e.mode),t.ref=e.ref,e.child=t,t.return=e,t}function Rm(e,t,r){return yo(t,e.child,null,r),e=lu(t,t.pendingProps),e.flags|=2,Ia(t),t.memoizedState=null,e}function Q0(e,t,r){var o=t.pendingProps,h=(t.flags&128)!==0;if(t.flags&=-129,e===null){if(_n){if(o.mode==="hidden")return e=lu(t,o),t.lanes=536870912,Hl(null,e);if(Gd(t),(e=Qn)?(e=Yg(e,$a),e=e!==null&&e.data==="&"?e:null,e!==null&&(t.memoizedState={dehydrated:e,treeContext:Si!==null?{id:As,overflow:Ts}:null,retryLane:536870912,hydrationErrors:null},r=yp(e),r.return=t,t.child=r,qr=t,Qn=null)):e=null,e===null)throw ki(t);return t.lanes=536870912,null}return lu(t,o)}var y=e.memoizedState;if(y!==null){var O=y.dehydrated;if(Gd(t),h)if(t.flags&256)t.flags&=-257,t=Rm(e,t,r);else if(t.memoizedState!==null)t.child=e.child,t.flags|=128,t=null;else throw Error(i(558));else if(Sr||Ho(e,t,r,!1),h=(r&e.childLanes)!==0,Sr||h){if(o=Kn,o!==null&&(O=Cr(o,r),O!==0&&O!==y.retryLane))throw y.retryLane=O,ar(e,O),wa(o,e,O),ff;bu(),t=Rm(e,t,r)}else e=y.treeContext,Qn=Za(O.nextSibling),qr=t,_n=!0,Ei=null,$a=!1,e!==null&&xp(t,e),t=lu(t,o),t.flags|=4096;return t}return e=Ps(e.child,{mode:o.mode,children:o.children}),e.ref=t.ref,t.child=e,e.return=t,e}function cu(e,t){var r=t.ref;if(r===null)e!==null&&e.ref!==null&&(t.flags|=4194816);else{if(typeof r!="function"&&typeof r!="object")throw Error(i(284));(e===null||e.ref!==r)&&(t.flags|=4194816)}}function hf(e,t,r,o,h){return ho(t),r=Yd(e,t,r,o,void 0,h),o=$d(),e!==null&&!Sr?(Vd(e,t,h),Vs(e,t,h)):(_n&&o&&Td(t),t.flags|=1,Kr(e,t,r,h),t.child)}function Mm(e,t,r,o,h,y){return ho(t),t.updateQueue=null,r=zp(t,o,r,h),Lp(e),o=$d(),e!==null&&!Sr?(Vd(e,t,y),Vs(e,t,y)):(_n&&o&&Td(t),t.flags|=1,Kr(e,t,r,y),t.child)}function Um(e,t,r,o,h){if(ho(t),t.stateNode===null){var y=Lo,O=r.contextType;typeof O=="object"&&O!==null&&(y=Gr(O)),y=new r(o,y),t.memoizedState=y.state!==null&&y.state!==void 0?y.state:null,y.updater=uf,t.stateNode=y,y._reactInternals=t,y=t.stateNode,y.props=o,y.state=t.memoizedState,y.refs={},zd(t),O=r.contextType,y.context=typeof O=="object"&&O!==null?Gr(O):Lo,y.state=t.memoizedState,O=r.getDerivedStateFromProps,typeof O=="function"&&(cf(t,r,O,o),y.state=t.memoizedState),typeof r.getDerivedStateFromProps=="function"||typeof y.getSnapshotBeforeUpdate=="function"||typeof y.UNSAFE_componentWillMount!="function"&&typeof y.componentWillMount!="function"||(O=y.state,typeof y.componentWillMount=="function"&&y.componentWillMount(),typeof y.UNSAFE_componentWillMount=="function"&&y.UNSAFE_componentWillMount(),O!==y.state&&uf.enqueueReplaceState(y,y.state,null),Ul(t,o,y,h),Ml(),y.state=t.memoizedState),typeof y.componentDidMount=="function"&&(t.flags|=4194308),o=!0}else if(e===null){y=t.stateNode;var V=t.memoizedProps,pe=bo(r,V);y.props=pe;var ze=y.context,Qe=r.contextType;O=Lo,typeof Qe=="object"&&Qe!==null&&(O=Gr(Qe));var nt=r.getDerivedStateFromProps;Qe=typeof nt=="function"||typeof y.getSnapshotBeforeUpdate=="function",V=t.pendingProps!==V,Qe||typeof y.UNSAFE_componentWillReceiveProps!="function"&&typeof y.componentWillReceiveProps!="function"||(V||ze!==O)&&wm(t,y,o,O),Ti=!1;var Pe=t.memoizedState;y.state=Pe,Ul(t,o,y,h),Ml(),ze=t.memoizedState,V||Pe!==ze||Ti?(typeof nt=="function"&&(cf(t,r,nt,o),ze=t.memoizedState),(pe=Ti||_m(t,r,pe,o,Pe,ze,O))?(Qe||typeof y.UNSAFE_componentWillMount!="function"&&typeof y.componentWillMount!="function"||(typeof y.componentWillMount=="function"&&y.componentWillMount(),typeof y.UNSAFE_componentWillMount=="function"&&y.UNSAFE_componentWillMount()),typeof y.componentDidMount=="function"&&(t.flags|=4194308)):(typeof y.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=o,t.memoizedState=ze),y.props=o,y.state=ze,y.context=O,o=pe):(typeof y.componentDidMount=="function"&&(t.flags|=4194308),o=!1)}else{y=t.stateNode,Bd(e,t),O=t.memoizedProps,Qe=bo(r,O),y.props=Qe,nt=t.pendingProps,Pe=y.context,ze=r.contextType,pe=Lo,typeof ze=="object"&&ze!==null&&(pe=Gr(ze)),V=r.getDerivedStateFromProps,(ze=typeof V=="function"||typeof y.getSnapshotBeforeUpdate=="function")||typeof y.UNSAFE_componentWillReceiveProps!="function"&&typeof y.componentWillReceiveProps!="function"||(O!==nt||Pe!==pe)&&wm(t,y,o,pe),Ti=!1,Pe=t.memoizedState,y.state=Pe,Ul(t,o,y,h),Ml();var Ke=t.memoizedState;O!==nt||Pe!==Ke||Ti||e!==null&&e.dependencies!==null&&Gc(e.dependencies)?(typeof V=="function"&&(cf(t,r,V,o),Ke=t.memoizedState),(Qe=Ti||_m(t,r,Qe,o,Pe,Ke,pe)||e!==null&&e.dependencies!==null&&Gc(e.dependencies))?(ze||typeof y.UNSAFE_componentWillUpdate!="function"&&typeof y.componentWillUpdate!="function"||(typeof y.componentWillUpdate=="function"&&y.componentWillUpdate(o,Ke,pe),typeof y.UNSAFE_componentWillUpdate=="function"&&y.UNSAFE_componentWillUpdate(o,Ke,pe)),typeof y.componentDidUpdate=="function"&&(t.flags|=4),typeof y.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof y.componentDidUpdate!="function"||O===e.memoizedProps&&Pe===e.memoizedState||(t.flags|=4),typeof y.getSnapshotBeforeUpdate!="function"||O===e.memoizedProps&&Pe===e.memoizedState||(t.flags|=1024),t.memoizedProps=o,t.memoizedState=Ke),y.props=o,y.state=Ke,y.context=pe,o=Qe):(typeof y.componentDidUpdate!="function"||O===e.memoizedProps&&Pe===e.memoizedState||(t.flags|=4),typeof y.getSnapshotBeforeUpdate!="function"||O===e.memoizedProps&&Pe===e.memoizedState||(t.flags|=1024),o=!1)}return y=o,cu(e,t),o=(t.flags&128)!==0,y||o?(y=t.stateNode,r=o&&typeof r.getDerivedStateFromError!="function"?null:y.render(),t.flags|=1,e!==null&&o?(t.child=yo(t,e.child,null,h),t.child=yo(t,null,r,h)):Kr(e,t,r,h),t.memoizedState=y.state,e=t.child):e=Vs(e,t,h),e}function Lm(e,t,r,o){return uo(),t.flags|=256,Kr(e,t,r,o),t.child}var pf={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function mf(e){return{baseLanes:e,cachePool:Ap()}}function gf(e,t,r){return e=e!==null?e.childLanes&~r:0,t&&(e|=Ma),e}function zm(e,t,r){var o=t.pendingProps,h=!1,y=(t.flags&128)!==0,O;if((O=y)||(O=e!==null&&e.memoizedState===null?!1:(gr.current&2)!==0),O&&(h=!0,t.flags&=-129),O=(t.flags&32)!==0,t.flags&=-33,e===null){if(_n){if(h?Di(t):Oi(),(e=Qn)?(e=Yg(e,$a),e=e!==null&&e.data!=="&"?e:null,e!==null&&(t.memoizedState={dehydrated:e,treeContext:Si!==null?{id:As,overflow:Ts}:null,retryLane:536870912,hydrationErrors:null},r=yp(e),r.return=t,t.child=r,qr=t,Qn=null)):e=null,e===null)throw ki(t);return Xf(e)?t.lanes=32:t.lanes=536870912,null}var V=o.children;return o=o.fallback,h?(Oi(),h=t.mode,V=uu({mode:"hidden",children:V},h),o=co(o,h,r,null),V.return=t,o.return=t,V.sibling=o,t.child=V,o=t.child,o.memoizedState=mf(r),o.childLanes=gf(e,O,r),t.memoizedState=pf,Hl(null,o)):(Di(t),yf(t,V))}var pe=e.memoizedState;if(pe!==null&&(V=pe.dehydrated,V!==null)){if(y)t.flags&256?(Di(t),t.flags&=-257,t=vf(e,t,r)):t.memoizedState!==null?(Oi(),t.child=e.child,t.flags|=128,t=null):(Oi(),V=o.fallback,h=t.mode,o=uu({mode:"visible",children:o.children},h),V=co(V,h,r,null),V.flags|=2,o.return=t,V.return=t,o.sibling=V,t.child=o,yo(t,e.child,null,r),o=t.child,o.memoizedState=mf(r),o.childLanes=gf(e,O,r),t.memoizedState=pf,t=Hl(null,o));else if(Di(t),Xf(V)){if(O=V.nextSibling&&V.nextSibling.dataset,O)var ze=O.dgst;O=ze,o=Error(i(419)),o.stack="",o.digest=O,Nl({value:o,source:null,stack:null}),t=vf(e,t,r)}else if(Sr||Ho(e,t,r,!1),O=(r&e.childLanes)!==0,Sr||O){if(O=Kn,O!==null&&(o=Cr(O,r),o!==0&&o!==pe.retryLane))throw pe.retryLane=o,ar(e,o),wa(O,e,o),ff;Jf(V)||bu(),t=vf(e,t,r)}else Jf(V)?(t.flags|=192,t.child=e.child,t=null):(e=pe.treeContext,Qn=Za(V.nextSibling),qr=t,_n=!0,Ei=null,$a=!1,e!==null&&xp(t,e),t=yf(t,o.children),t.flags|=4096);return t}return h?(Oi(),V=o.fallback,h=t.mode,pe=e.child,ze=pe.sibling,o=Ps(pe,{mode:"hidden",children:o.children}),o.subtreeFlags=pe.subtreeFlags&65011712,ze!==null?V=Ps(ze,V):(V=co(V,h,r,null),V.flags|=2),V.return=t,o.return=t,o.sibling=V,t.child=o,Hl(null,o),o=t.child,V=e.child.memoizedState,V===null?V=mf(r):(h=V.cachePool,h!==null?(pe=_r._currentValue,h=h.parent!==pe?{parent:pe,pool:pe}:h):h=Ap(),V={baseLanes:V.baseLanes|r,cachePool:h}),o.memoizedState=V,o.childLanes=gf(e,O,r),t.memoizedState=pf,Hl(e.child,o)):(Di(t),r=e.child,e=r.sibling,r=Ps(r,{mode:"visible",children:o.children}),r.return=t,r.sibling=null,e!==null&&(O=t.deletions,O===null?(t.deletions=[e],t.flags|=16):O.push(e)),t.child=r,t.memoizedState=null,r)}function yf(e,t){return t=uu({mode:"visible",children:t},e.mode),t.return=e,e.child=t}function uu(e,t){return e=Oa(22,e,null,t),e.lanes=0,e}function vf(e,t,r){return yo(t,e.child,null,r),e=yf(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function Bm(e,t,r){e.lanes|=t;var o=e.alternate;o!==null&&(o.lanes|=t),jd(e.return,t,r)}function bf(e,t,r,o,h,y){var O=e.memoizedState;O===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:o,tail:r,tailMode:h,treeForkCount:y}:(O.isBackwards=t,O.rendering=null,O.renderingStartTime=0,O.last=o,O.tail=r,O.tailMode=h,O.treeForkCount=y)}function Fm(e,t,r){var o=t.pendingProps,h=o.revealOrder,y=o.tail;o=o.children;var O=gr.current,V=(O&2)!==0;if(V?(O=O&1|2,t.flags|=128):O&=1,ne(gr,O),Kr(e,t,o,r),o=_n?Cl:0,!V&&e!==null&&(e.flags&128)!==0)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&Bm(e,r,t);else if(e.tag===19)Bm(e,r,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}switch(h){case"forwards":for(r=t.child,h=null;r!==null;)e=r.alternate,e!==null&&Xc(e)===null&&(h=r),r=r.sibling;r=h,r===null?(h=t.child,t.child=null):(h=r.sibling,r.sibling=null),bf(t,!1,h,r,y,o);break;case"backwards":case"unstable_legacy-backwards":for(r=null,h=t.child,t.child=null;h!==null;){if(e=h.alternate,e!==null&&Xc(e)===null){t.child=h;break}e=h.sibling,h.sibling=r,r=h,h=e}bf(t,!0,r,null,y,o);break;case"together":bf(t,!1,null,null,void 0,o);break;default:t.memoizedState=null}return t.child}function Vs(e,t,r){if(e!==null&&(t.dependencies=e.dependencies),Ri|=t.lanes,(r&t.childLanes)===0)if(e!==null){if(Ho(e,t,r,!1),(r&t.childLanes)===0)return null}else return null;if(e!==null&&t.child!==e.child)throw Error(i(153));if(t.child!==null){for(e=t.child,r=Ps(e,e.pendingProps),t.child=r,r.return=t;e.sibling!==null;)e=e.sibling,r=r.sibling=Ps(e,e.pendingProps),r.return=t;r.sibling=null}return t.child}function xf(e,t){return(e.lanes&t)!==0?!0:(e=e.dependencies,!!(e!==null&&Gc(e)))}function J0(e,t,r){switch(t.tag){case 3:ye(t,t.stateNode.containerInfo),Ai(t,_r,e.memoizedState.cache),uo();break;case 27:case 5:We(t);break;case 4:ye(t,t.stateNode.containerInfo);break;case 10:Ai(t,t.type,t.memoizedProps.value);break;case 31:if(t.memoizedState!==null)return t.flags|=128,Gd(t),null;break;case 13:var o=t.memoizedState;if(o!==null)return o.dehydrated!==null?(Di(t),t.flags|=128,null):(r&t.child.childLanes)!==0?zm(e,t,r):(Di(t),e=Vs(e,t,r),e!==null?e.sibling:null);Di(t);break;case 19:var h=(e.flags&128)!==0;if(o=(r&t.childLanes)!==0,o||(Ho(e,t,r,!1),o=(r&t.childLanes)!==0),h){if(o)return Fm(e,t,r);t.flags|=128}if(h=t.memoizedState,h!==null&&(h.rendering=null,h.tail=null,h.lastEffect=null),ne(gr,gr.current),o)break;return null;case 22:return t.lanes=0,jm(e,t,r,t.pendingProps);case 24:Ai(t,_r,e.memoizedState.cache)}return Vs(e,t,r)}function Hm(e,t,r){if(e!==null)if(e.memoizedProps!==t.pendingProps)Sr=!0;else{if(!xf(e,r)&&(t.flags&128)===0)return Sr=!1,J0(e,t,r);Sr=(e.flags&131072)!==0}else Sr=!1,_n&&(t.flags&1048576)!==0&&bp(t,Cl,t.index);switch(t.lanes=0,t.tag){case 16:e:{var o=t.pendingProps;if(e=mo(t.elementType),t.type=e,typeof e=="function")Ed(e)?(o=bo(e,o),t.tag=1,t=Um(null,t,e,o,r)):(t.tag=0,t=hf(null,t,e,o,r));else{if(e!=null){var h=e.$$typeof;if(h===G){t.tag=11,t=Nm(null,t,e,o,r);break e}else if(h===H){t.tag=14,t=Dm(null,t,e,o,r);break e}}throw t=j(e)||e,Error(i(306,t,""))}}return t;case 0:return hf(e,t,t.type,t.pendingProps,r);case 1:return o=t.type,h=bo(o,t.pendingProps),Um(e,t,o,h,r);case 3:e:{if(ye(t,t.stateNode.containerInfo),e===null)throw Error(i(387));o=t.pendingProps;var y=t.memoizedState;h=y.element,Bd(e,t),Ul(t,o,null,r);var O=t.memoizedState;if(o=O.cache,Ai(t,_r,o),o!==y.cache&&Id(t,[_r],r,!0),Ml(),o=O.element,y.isDehydrated)if(y={element:o,isDehydrated:!1,cache:O.cache},t.updateQueue.baseState=y,t.memoizedState=y,t.flags&256){t=Lm(e,t,o,r);break e}else if(o!==h){h=Ga(Error(i(424)),t),Nl(h),t=Lm(e,t,o,r);break e}else{switch(e=t.stateNode.containerInfo,e.nodeType){case 9:e=e.body;break;default:e=e.nodeName==="HTML"?e.ownerDocument.body:e}for(Qn=Za(e.firstChild),qr=t,_n=!0,Ei=null,$a=!0,r=jp(t,null,o,r),t.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling}else{if(uo(),o===h){t=Vs(e,t,r);break e}Kr(e,t,o,r)}t=t.child}return t;case 26:return cu(e,t),e===null?(r=Xg(t.type,null,t.pendingProps,null))?t.memoizedState=r:_n||(r=t.type,e=t.pendingProps,o=Au(de.current).createElement(r),o[gn]=t,o[nn]=e,Yr(o,r,e),$t(o),t.stateNode=o):t.memoizedState=Xg(t.type,e.memoizedProps,t.pendingProps,e.memoizedState),null;case 27:return We(t),e===null&&_n&&(o=t.stateNode=Zg(t.type,t.pendingProps,de.current),qr=t,$a=!0,h=Qn,Bi(t.type)?(Wf=h,Qn=Za(o.firstChild)):Qn=h),Kr(e,t,t.pendingProps.children,r),cu(e,t),e===null&&(t.flags|=4194304),t.child;case 5:return e===null&&_n&&((h=o=Qn)&&(o=Tx(o,t.type,t.pendingProps,$a),o!==null?(t.stateNode=o,qr=t,Qn=Za(o.firstChild),$a=!1,h=!0):h=!1),h||ki(t)),We(t),h=t.type,y=t.pendingProps,O=e!==null?e.memoizedProps:null,o=y.children,Vf(h,y)?o=null:O!==null&&Vf(h,O)&&(t.flags|=32),t.memoizedState!==null&&(h=Yd(e,t,P0,null,null,r),nc._currentValue=h),cu(e,t),Kr(e,t,o,r),t.child;case 6:return e===null&&_n&&((e=r=Qn)&&(r=Cx(r,t.pendingProps,$a),r!==null?(t.stateNode=r,qr=t,Qn=null,e=!0):e=!1),e||ki(t)),null;case 13:return zm(e,t,r);case 4:return ye(t,t.stateNode.containerInfo),o=t.pendingProps,e===null?t.child=yo(t,null,o,r):Kr(e,t,o,r),t.child;case 11:return Nm(e,t,t.type,t.pendingProps,r);case 7:return Kr(e,t,t.pendingProps,r),t.child;case 8:return Kr(e,t,t.pendingProps.children,r),t.child;case 12:return Kr(e,t,t.pendingProps.children,r),t.child;case 10:return o=t.pendingProps,Ai(t,t.type,o.value),Kr(e,t,o.children,r),t.child;case 9:return h=t.type._context,o=t.pendingProps.children,ho(t),h=Gr(h),o=o(h),t.flags|=1,Kr(e,t,o,r),t.child;case 14:return Dm(e,t,t.type,t.pendingProps,r);case 15:return Om(e,t,t.type,t.pendingProps,r);case 19:return Fm(e,t,r);case 31:return Q0(e,t,r);case 22:return jm(e,t,r,t.pendingProps);case 24:return ho(t),o=Gr(_r),e===null?(h=Ud(),h===null&&(h=Kn,y=Rd(),h.pooledCache=y,y.refCount++,y!==null&&(h.pooledCacheLanes|=r),h=y),t.memoizedState={parent:o,cache:h},zd(t),Ai(t,_r,h)):((e.lanes&r)!==0&&(Bd(e,t),Ul(t,null,null,r),Ml()),h=e.memoizedState,y=t.memoizedState,h.parent!==o?(h={parent:o,cache:o},t.memoizedState=h,t.lanes===0&&(t.memoizedState=t.updateQueue.baseState=h),Ai(t,_r,o)):(o=y.cache,Ai(t,_r,o),o!==h.cache&&Id(t,[_r],r,!0))),Kr(e,t,t.pendingProps.children,r),t.child;case 29:throw t.pendingProps}throw Error(i(156,t.tag))}function Zs(e){e.flags|=4}function _f(e,t,r,o,h){if((t=(e.mode&32)!==0)&&(t=!1),t){if(e.flags|=16777216,(h&335544128)===h)if(e.stateNode.complete)e.flags|=8192;else if(pg())e.flags|=8192;else throw go=Vc,Ld}else e.flags&=-16777217}function Pm(e,t){if(t.type!=="stylesheet"||(t.state.loading&4)!==0)e.flags&=-16777217;else if(e.flags|=16777216,!ry(t))if(pg())e.flags|=8192;else throw go=Vc,Ld}function du(e,t){t!==null&&(e.flags|=4),e.flags&16384&&(t=e.tag!==22?Vr():536870912,e.lanes|=t,Wo|=t)}function Pl(e,t){if(!_n)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var o=null;r!==null;)r.alternate!==null&&(o=r),r=r.sibling;o===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:o.sibling=null}}function Jn(e){var t=e.alternate!==null&&e.alternate.child===e.child,r=0,o=0;if(t)for(var h=e.child;h!==null;)r|=h.lanes|h.childLanes,o|=h.subtreeFlags&65011712,o|=h.flags&65011712,h.return=e,h=h.sibling;else for(h=e.child;h!==null;)r|=h.lanes|h.childLanes,o|=h.subtreeFlags,o|=h.flags,h.return=e,h=h.sibling;return e.subtreeFlags|=o,e.childLanes=r,t}function X0(e,t,r){var o=t.pendingProps;switch(Cd(t),t.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Jn(t),null;case 1:return Jn(t),null;case 3:return r=t.stateNode,o=null,e!==null&&(o=e.memoizedState.cache),t.memoizedState.cache!==o&&(t.flags|=2048),Ks(_r),ie(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(e===null||e.child===null)&&(Fo(t)?Zs(t):e===null||e.memoizedState.isDehydrated&&(t.flags&256)===0||(t.flags|=1024,Dd())),Jn(t),null;case 26:var h=t.type,y=t.memoizedState;return e===null?(Zs(t),y!==null?(Jn(t),Pm(t,y)):(Jn(t),_f(t,h,null,o,r))):y?y!==e.memoizedState?(Zs(t),Jn(t),Pm(t,y)):(Jn(t),t.flags&=-16777217):(e=e.memoizedProps,e!==o&&Zs(t),Jn(t),_f(t,h,e,o,r)),null;case 27:if(ot(t),r=de.current,h=t.type,e!==null&&t.stateNode!=null)e.memoizedProps!==o&&Zs(t);else{if(!o){if(t.stateNode===null)throw Error(i(166));return Jn(t),null}e=se.current,Fo(t)?_p(t):(e=Zg(h,o,r),t.stateNode=e,Zs(t))}return Jn(t),null;case 5:if(ot(t),h=t.type,e!==null&&t.stateNode!=null)e.memoizedProps!==o&&Zs(t);else{if(!o){if(t.stateNode===null)throw Error(i(166));return Jn(t),null}if(y=se.current,Fo(t))_p(t);else{var O=Au(de.current);switch(y){case 1:y=O.createElementNS("http://www.w3.org/2000/svg",h);break;case 2:y=O.createElementNS("http://www.w3.org/1998/Math/MathML",h);break;default:switch(h){case"svg":y=O.createElementNS("http://www.w3.org/2000/svg",h);break;case"math":y=O.createElementNS("http://www.w3.org/1998/Math/MathML",h);break;case"script":y=O.createElement("div"),y.innerHTML="<script><\/script>",y=y.removeChild(y.firstChild);break;case"select":y=typeof o.is=="string"?O.createElement("select",{is:o.is}):O.createElement("select"),o.multiple?y.multiple=!0:o.size&&(y.size=o.size);break;default:y=typeof o.is=="string"?O.createElement(h,{is:o.is}):O.createElement(h)}}y[gn]=t,y[nn]=o;e:for(O=t.child;O!==null;){if(O.tag===5||O.tag===6)y.appendChild(O.stateNode);else if(O.tag!==4&&O.tag!==27&&O.child!==null){O.child.return=O,O=O.child;continue}if(O===t)break e;for(;O.sibling===null;){if(O.return===null||O.return===t)break e;O=O.return}O.sibling.return=O.return,O=O.sibling}t.stateNode=y;e:switch(Yr(y,h,o),h){case"button":case"input":case"select":case"textarea":o=!!o.autoFocus;break e;case"img":o=!0;break e;default:o=!1}o&&Zs(t)}}return Jn(t),_f(t,t.type,e===null?null:e.memoizedProps,t.pendingProps,r),null;case 6:if(e&&t.stateNode!=null)e.memoizedProps!==o&&Zs(t);else{if(typeof o!="string"&&t.stateNode===null)throw Error(i(166));if(e=de.current,Fo(t)){if(e=t.stateNode,r=t.memoizedProps,o=null,h=qr,h!==null)switch(h.tag){case 27:case 5:o=h.memoizedProps}e[gn]=t,e=!!(e.nodeValue===r||o!==null&&o.suppressHydrationWarning===!0||zg(e.nodeValue,r)),e||ki(t,!0)}else e=Au(e).createTextNode(o),e[gn]=t,t.stateNode=e}return Jn(t),null;case 31:if(r=t.memoizedState,e===null||e.memoizedState!==null){if(o=Fo(t),r!==null){if(e===null){if(!o)throw Error(i(318));if(e=t.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(i(557));e[gn]=t}else uo(),(t.flags&128)===0&&(t.memoizedState=null),t.flags|=4;Jn(t),e=!1}else r=Dd(),e!==null&&e.memoizedState!==null&&(e.memoizedState.hydrationErrors=r),e=!0;if(!e)return t.flags&256?(Ia(t),t):(Ia(t),null);if((t.flags&128)!==0)throw Error(i(558))}return Jn(t),null;case 13:if(o=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(h=Fo(t),o!==null&&o.dehydrated!==null){if(e===null){if(!h)throw Error(i(318));if(h=t.memoizedState,h=h!==null?h.dehydrated:null,!h)throw Error(i(317));h[gn]=t}else uo(),(t.flags&128)===0&&(t.memoizedState=null),t.flags|=4;Jn(t),h=!1}else h=Dd(),e!==null&&e.memoizedState!==null&&(e.memoizedState.hydrationErrors=h),h=!0;if(!h)return t.flags&256?(Ia(t),t):(Ia(t),null)}return Ia(t),(t.flags&128)!==0?(t.lanes=r,t):(r=o!==null,e=e!==null&&e.memoizedState!==null,r&&(o=t.child,h=null,o.alternate!==null&&o.alternate.memoizedState!==null&&o.alternate.memoizedState.cachePool!==null&&(h=o.alternate.memoizedState.cachePool.pool),y=null,o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(y=o.memoizedState.cachePool.pool),y!==h&&(o.flags|=2048)),r!==e&&r&&(t.child.flags|=8192),du(t,t.updateQueue),Jn(t),null);case 4:return ie(),e===null&&qf(t.stateNode.containerInfo),Jn(t),null;case 10:return Ks(t.type),Jn(t),null;case 19:if(z(gr),o=t.memoizedState,o===null)return Jn(t),null;if(h=(t.flags&128)!==0,y=o.rendering,y===null)if(h)Pl(o,!1);else{if(dr!==0||e!==null&&(e.flags&128)!==0)for(e=t.child;e!==null;){if(y=Xc(e),y!==null){for(t.flags|=128,Pl(o,!1),e=y.updateQueue,t.updateQueue=e,du(t,e),t.subtreeFlags=0,e=r,r=t.child;r!==null;)gp(r,e),r=r.sibling;return ne(gr,gr.current&1|2),_n&&qs(t,o.treeForkCount),t.child}e=e.sibling}o.tail!==null&&at()>gu&&(t.flags|=128,h=!0,Pl(o,!1),t.lanes=4194304)}else{if(!h)if(e=Xc(y),e!==null){if(t.flags|=128,h=!0,e=e.updateQueue,t.updateQueue=e,du(t,e),Pl(o,!0),o.tail===null&&o.tailMode==="hidden"&&!y.alternate&&!_n)return Jn(t),null}else 2*at()-o.renderingStartTime>gu&&r!==536870912&&(t.flags|=128,h=!0,Pl(o,!1),t.lanes=4194304);o.isBackwards?(y.sibling=t.child,t.child=y):(e=o.last,e!==null?e.sibling=y:t.child=y,o.last=y)}return o.tail!==null?(e=o.tail,o.rendering=e,o.tail=e.sibling,o.renderingStartTime=at(),e.sibling=null,r=gr.current,ne(gr,h?r&1|2:r&1),_n&&qs(t,o.treeForkCount),e):(Jn(t),null);case 22:case 23:return Ia(t),qd(),o=t.memoizedState!==null,e!==null?e.memoizedState!==null!==o&&(t.flags|=8192):o&&(t.flags|=8192),o?(r&536870912)!==0&&(t.flags&128)===0&&(Jn(t),t.subtreeFlags&6&&(t.flags|=8192)):Jn(t),r=t.updateQueue,r!==null&&du(t,r.retryQueue),r=null,e!==null&&e.memoizedState!==null&&e.memoizedState.cachePool!==null&&(r=e.memoizedState.cachePool.pool),o=null,t.memoizedState!==null&&t.memoizedState.cachePool!==null&&(o=t.memoizedState.cachePool.pool),o!==r&&(t.flags|=2048),e!==null&&z(po),null;case 24:return r=null,e!==null&&(r=e.memoizedState.cache),t.memoizedState.cache!==r&&(t.flags|=2048),Ks(_r),Jn(t),null;case 25:return null;case 30:return null}throw Error(i(156,t.tag))}function W0(e,t){switch(Cd(t),t.tag){case 1:return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return Ks(_r),ie(),e=t.flags,(e&65536)!==0&&(e&128)===0?(t.flags=e&-65537|128,t):null;case 26:case 27:case 5:return ot(t),null;case 31:if(t.memoizedState!==null){if(Ia(t),t.alternate===null)throw Error(i(340));uo()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 13:if(Ia(t),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(i(340));uo()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return z(gr),null;case 4:return ie(),null;case 10:return Ks(t.type),null;case 22:case 23:return Ia(t),qd(),e!==null&&z(po),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 24:return Ks(_r),null;case 25:return null;default:return null}}function qm(e,t){switch(Cd(t),t.tag){case 3:Ks(_r),ie();break;case 26:case 27:case 5:ot(t);break;case 4:ie();break;case 31:t.memoizedState!==null&&Ia(t);break;case 13:Ia(t);break;case 19:z(gr);break;case 10:Ks(t.type);break;case 22:case 23:Ia(t),qd(),e!==null&&z(po);break;case 24:Ks(_r)}}function ql(e,t){try{var r=t.updateQueue,o=r!==null?r.lastEffect:null;if(o!==null){var h=o.next;r=h;do{if((r.tag&e)===e){o=void 0;var y=r.create,O=r.inst;o=y(),O.destroy=o}r=r.next}while(r!==h)}}catch(V){Ln(t,t.return,V)}}function ji(e,t,r){try{var o=t.updateQueue,h=o!==null?o.lastEffect:null;if(h!==null){var y=h.next;o=y;do{if((o.tag&e)===e){var O=o.inst,V=O.destroy;if(V!==void 0){O.destroy=void 0,h=t;var pe=r,ze=V;try{ze()}catch(Qe){Ln(h,pe,Qe)}}}o=o.next}while(o!==y)}}catch(Qe){Ln(t,t.return,Qe)}}function Gm(e){var t=e.updateQueue;if(t!==null){var r=e.stateNode;try{Rp(t,r)}catch(o){Ln(e,e.return,o)}}}function Km(e,t,r){r.props=bo(e.type,e.memoizedProps),r.state=e.memoizedState;try{r.componentWillUnmount()}catch(o){Ln(e,t,o)}}function Gl(e,t){try{var r=e.ref;if(r!==null){switch(e.tag){case 26:case 27:case 5:var o=e.stateNode;break;case 30:o=e.stateNode;break;default:o=e.stateNode}typeof r=="function"?e.refCleanup=r(o):r.current=o}}catch(h){Ln(e,t,h)}}function Cs(e,t){var r=e.ref,o=e.refCleanup;if(r!==null)if(typeof o=="function")try{o()}catch(h){Ln(e,t,h)}finally{e.refCleanup=null,e=e.alternate,e!=null&&(e.refCleanup=null)}else if(typeof r=="function")try{r(null)}catch(h){Ln(e,t,h)}else r.current=null}function Ym(e){var t=e.type,r=e.memoizedProps,o=e.stateNode;try{e:switch(t){case"button":case"input":case"select":case"textarea":r.autoFocus&&o.focus();break e;case"img":r.src?o.src=r.src:r.srcSet&&(o.srcset=r.srcSet)}}catch(h){Ln(e,e.return,h)}}function wf(e,t,r){try{var o=e.stateNode;_x(o,e.type,r,t),o[nn]=t}catch(h){Ln(e,e.return,h)}}function $m(e){return e.tag===5||e.tag===3||e.tag===26||e.tag===27&&Bi(e.type)||e.tag===4}function Sf(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||$m(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.tag===27&&Bi(e.type)||e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function Ef(e,t,r){var o=e.tag;if(o===5||o===6)e=e.stateNode,t?(r.nodeType===9?r.body:r.nodeName==="HTML"?r.ownerDocument.body:r).insertBefore(e,t):(t=r.nodeType===9?r.body:r.nodeName==="HTML"?r.ownerDocument.body:r,t.appendChild(e),r=r._reactRootContainer,r!=null||t.onclick!==null||(t.onclick=cr));else if(o!==4&&(o===27&&Bi(e.type)&&(r=e.stateNode,t=null),e=e.child,e!==null))for(Ef(e,t,r),e=e.sibling;e!==null;)Ef(e,t,r),e=e.sibling}function fu(e,t,r){var o=e.tag;if(o===5||o===6)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(o!==4&&(o===27&&Bi(e.type)&&(r=e.stateNode),e=e.child,e!==null))for(fu(e,t,r),e=e.sibling;e!==null;)fu(e,t,r),e=e.sibling}function Vm(e){var t=e.stateNode,r=e.memoizedProps;try{for(var o=e.type,h=t.attributes;h.length;)t.removeAttributeNode(h[0]);Yr(t,o,r),t[gn]=e,t[nn]=r}catch(y){Ln(e,e.return,y)}}var Qs=!1,Er=!1,kf=!1,Zm=typeof WeakSet=="function"?WeakSet:Set,Ur=null;function ex(e,t){if(e=e.containerInfo,Yf=Iu,e=ae(e),fe(e)){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{r=(r=e.ownerDocument)&&r.defaultView||window;var o=r.getSelection&&r.getSelection();if(o&&o.rangeCount!==0){r=o.anchorNode;var h=o.anchorOffset,y=o.focusNode;o=o.focusOffset;try{r.nodeType,y.nodeType}catch{r=null;break e}var O=0,V=-1,pe=-1,ze=0,Qe=0,nt=e,Pe=null;t:for(;;){for(var Ke;nt!==r||h!==0&&nt.nodeType!==3||(V=O+h),nt!==y||o!==0&&nt.nodeType!==3||(pe=O+o),nt.nodeType===3&&(O+=nt.nodeValue.length),(Ke=nt.firstChild)!==null;)Pe=nt,nt=Ke;for(;;){if(nt===e)break t;if(Pe===r&&++ze===h&&(V=O),Pe===y&&++Qe===o&&(pe=O),(Ke=nt.nextSibling)!==null)break;nt=Pe,Pe=nt.parentNode}nt=Ke}r=V===-1||pe===-1?null:{start:V,end:pe}}else r=null}r=r||{start:0,end:0}}else r=null;for($f={focusedElem:e,selectionRange:r},Iu=!1,Ur=t;Ur!==null;)if(t=Ur,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,Ur=e;else for(;Ur!==null;){switch(t=Ur,y=t.alternate,e=t.flags,t.tag){case 0:if((e&4)!==0&&(e=t.updateQueue,e=e!==null?e.events:null,e!==null))for(r=0;r<e.length;r++)h=e[r],h.ref.impl=h.nextImpl;break;case 11:case 15:break;case 1:if((e&1024)!==0&&y!==null){e=void 0,r=t,h=y.memoizedProps,y=y.memoizedState,o=r.stateNode;try{var Ct=bo(r.type,h);e=o.getSnapshotBeforeUpdate(Ct,y),o.__reactInternalSnapshotBeforeUpdate=e}catch(qt){Ln(r,r.return,qt)}}break;case 3:if((e&1024)!==0){if(e=t.stateNode.containerInfo,r=e.nodeType,r===9)Qf(e);else if(r===1)switch(e.nodeName){case"HEAD":case"HTML":case"BODY":Qf(e);break;default:e.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((e&1024)!==0)throw Error(i(163))}if(e=t.sibling,e!==null){e.return=t.return,Ur=e;break}Ur=t.return}}function Qm(e,t,r){var o=r.flags;switch(r.tag){case 0:case 11:case 15:Xs(e,r),o&4&&ql(5,r);break;case 1:if(Xs(e,r),o&4)if(e=r.stateNode,t===null)try{e.componentDidMount()}catch(O){Ln(r,r.return,O)}else{var h=bo(r.type,t.memoizedProps);t=t.memoizedState;try{e.componentDidUpdate(h,t,e.__reactInternalSnapshotBeforeUpdate)}catch(O){Ln(r,r.return,O)}}o&64&&Gm(r),o&512&&Gl(r,r.return);break;case 3:if(Xs(e,r),o&64&&(e=r.updateQueue,e!==null)){if(t=null,r.child!==null)switch(r.child.tag){case 27:case 5:t=r.child.stateNode;break;case 1:t=r.child.stateNode}try{Rp(e,t)}catch(O){Ln(r,r.return,O)}}break;case 27:t===null&&o&4&&Vm(r);case 26:case 5:Xs(e,r),t===null&&o&4&&Ym(r),o&512&&Gl(r,r.return);break;case 12:Xs(e,r);break;case 31:Xs(e,r),o&4&&Wm(e,r);break;case 13:Xs(e,r),o&4&&eg(e,r),o&64&&(e=r.memoizedState,e!==null&&(e=e.dehydrated,e!==null&&(r=cx.bind(null,r),Nx(e,r))));break;case 22:if(o=r.memoizedState!==null||Qs,!o){t=t!==null&&t.memoizedState!==null||Er,h=Qs;var y=Er;Qs=o,(Er=t)&&!y?Ws(e,r,(r.subtreeFlags&8772)!==0):Xs(e,r),Qs=h,Er=y}break;case 30:break;default:Xs(e,r)}}function Jm(e){var t=e.alternate;t!==null&&(e.alternate=null,Jm(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&st(t)),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}var er=null,va=!1;function Js(e,t,r){for(r=r.child;r!==null;)Xm(e,t,r),r=r.sibling}function Xm(e,t,r){if(Ht&&typeof Ht.onCommitFiberUnmount=="function")try{Ht.onCommitFiberUnmount(zt,r)}catch{}switch(r.tag){case 26:Er||Cs(r,t),Js(e,t,r),r.memoizedState?r.memoizedState.count--:r.stateNode&&(r=r.stateNode,r.parentNode.removeChild(r));break;case 27:Er||Cs(r,t);var o=er,h=va;Bi(r.type)&&(er=r.stateNode,va=!1),Js(e,t,r),Wl(r.stateNode),er=o,va=h;break;case 5:Er||Cs(r,t);case 6:if(o=er,h=va,er=null,Js(e,t,r),er=o,va=h,er!==null)if(va)try{(er.nodeType===9?er.body:er.nodeName==="HTML"?er.ownerDocument.body:er).removeChild(r.stateNode)}catch(y){Ln(r,t,y)}else try{er.removeChild(r.stateNode)}catch(y){Ln(r,t,y)}break;case 18:er!==null&&(va?(e=er,Gg(e.nodeType===9?e.body:e.nodeName==="HTML"?e.ownerDocument.body:e,r.stateNode),ol(e)):Gg(er,r.stateNode));break;case 4:o=er,h=va,er=r.stateNode.containerInfo,va=!0,Js(e,t,r),er=o,va=h;break;case 0:case 11:case 14:case 15:ji(2,r,t),Er||ji(4,r,t),Js(e,t,r);break;case 1:Er||(Cs(r,t),o=r.stateNode,typeof o.componentWillUnmount=="function"&&Km(r,t,o)),Js(e,t,r);break;case 21:Js(e,t,r);break;case 22:Er=(o=Er)||r.memoizedState!==null,Js(e,t,r),Er=o;break;default:Js(e,t,r)}}function Wm(e,t){if(t.memoizedState===null&&(e=t.alternate,e!==null&&(e=e.memoizedState,e!==null))){e=e.dehydrated;try{ol(e)}catch(r){Ln(t,t.return,r)}}}function eg(e,t){if(t.memoizedState===null&&(e=t.alternate,e!==null&&(e=e.memoizedState,e!==null&&(e=e.dehydrated,e!==null))))try{ol(e)}catch(r){Ln(t,t.return,r)}}function tx(e){switch(e.tag){case 31:case 13:case 19:var t=e.stateNode;return t===null&&(t=e.stateNode=new Zm),t;case 22:return e=e.stateNode,t=e._retryCache,t===null&&(t=e._retryCache=new Zm),t;default:throw Error(i(435,e.tag))}}function hu(e,t){var r=tx(e);t.forEach(function(o){if(!r.has(o)){r.add(o);var h=ux.bind(null,e,o);o.then(h,h)}})}function ba(e,t){var r=t.deletions;if(r!==null)for(var o=0;o<r.length;o++){var h=r[o],y=e,O=t,V=O;e:for(;V!==null;){switch(V.tag){case 27:if(Bi(V.type)){er=V.stateNode,va=!1;break e}break;case 5:er=V.stateNode,va=!1;break e;case 3:case 4:er=V.stateNode.containerInfo,va=!0;break e}V=V.return}if(er===null)throw Error(i(160));Xm(y,O,h),er=null,va=!1,y=h.alternate,y!==null&&(y.return=null),h.return=null}if(t.subtreeFlags&13886)for(t=t.child;t!==null;)tg(t,e),t=t.sibling}var ls=null;function tg(e,t){var r=e.alternate,o=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:ba(t,e),xa(e),o&4&&(ji(3,e,e.return),ql(3,e),ji(5,e,e.return));break;case 1:ba(t,e),xa(e),o&512&&(Er||r===null||Cs(r,r.return)),o&64&&Qs&&(e=e.updateQueue,e!==null&&(o=e.callbacks,o!==null&&(r=e.shared.hiddenCallbacks,e.shared.hiddenCallbacks=r===null?o:r.concat(o))));break;case 26:var h=ls;if(ba(t,e),xa(e),o&512&&(Er||r===null||Cs(r,r.return)),o&4){var y=r!==null?r.memoizedState:null;if(o=e.memoizedState,r===null)if(o===null)if(e.stateNode===null){e:{o=e.type,r=e.memoizedProps,h=h.ownerDocument||h;t:switch(o){case"title":y=h.getElementsByTagName("title")[0],(!y||y[_e]||y[gn]||y.namespaceURI==="http://www.w3.org/2000/svg"||y.hasAttribute("itemprop"))&&(y=h.createElement(o),h.head.insertBefore(y,h.querySelector("head > title"))),Yr(y,o,r),y[gn]=e,$t(y),o=y;break e;case"link":var O=ty("link","href",h).get(o+(r.href||""));if(O){for(var V=0;V<O.length;V++)if(y=O[V],y.getAttribute("href")===(r.href==null||r.href===""?null:r.href)&&y.getAttribute("rel")===(r.rel==null?null:r.rel)&&y.getAttribute("title")===(r.title==null?null:r.title)&&y.getAttribute("crossorigin")===(r.crossOrigin==null?null:r.crossOrigin)){O.splice(V,1);break t}}y=h.createElement(o),Yr(y,o,r),h.head.appendChild(y);break;case"meta":if(O=ty("meta","content",h).get(o+(r.content||""))){for(V=0;V<O.length;V++)if(y=O[V],y.getAttribute("content")===(r.content==null?null:""+r.content)&&y.getAttribute("name")===(r.name==null?null:r.name)&&y.getAttribute("property")===(r.property==null?null:r.property)&&y.getAttribute("http-equiv")===(r.httpEquiv==null?null:r.httpEquiv)&&y.getAttribute("charset")===(r.charSet==null?null:r.charSet)){O.splice(V,1);break t}}y=h.createElement(o),Yr(y,o,r),h.head.appendChild(y);break;default:throw Error(i(468,o))}y[gn]=e,$t(y),o=y}e.stateNode=o}else ny(h,e.type,e.stateNode);else e.stateNode=ey(h,o,e.memoizedProps);else y!==o?(y===null?r.stateNode!==null&&(r=r.stateNode,r.parentNode.removeChild(r)):y.count--,o===null?ny(h,e.type,e.stateNode):ey(h,o,e.memoizedProps)):o===null&&e.stateNode!==null&&wf(e,e.memoizedProps,r.memoizedProps)}break;case 27:ba(t,e),xa(e),o&512&&(Er||r===null||Cs(r,r.return)),r!==null&&o&4&&wf(e,e.memoizedProps,r.memoizedProps);break;case 5:if(ba(t,e),xa(e),o&512&&(Er||r===null||Cs(r,r.return)),e.flags&32){h=e.stateNode;try{rn(h,"")}catch(Ct){Ln(e,e.return,Ct)}}o&4&&e.stateNode!=null&&(h=e.memoizedProps,wf(e,h,r!==null?r.memoizedProps:h)),o&1024&&(kf=!0);break;case 6:if(ba(t,e),xa(e),o&4){if(e.stateNode===null)throw Error(i(162));o=e.memoizedProps,r=e.stateNode;try{r.nodeValue=o}catch(Ct){Ln(e,e.return,Ct)}}break;case 3:if(Nu=null,h=ls,ls=Tu(t.containerInfo),ba(t,e),ls=h,xa(e),o&4&&r!==null&&r.memoizedState.isDehydrated)try{ol(t.containerInfo)}catch(Ct){Ln(e,e.return,Ct)}kf&&(kf=!1,ng(e));break;case 4:o=ls,ls=Tu(e.stateNode.containerInfo),ba(t,e),xa(e),ls=o;break;case 12:ba(t,e),xa(e);break;case 31:ba(t,e),xa(e),o&4&&(o=e.updateQueue,o!==null&&(e.updateQueue=null,hu(e,o)));break;case 13:ba(t,e),xa(e),e.child.flags&8192&&e.memoizedState!==null!=(r!==null&&r.memoizedState!==null)&&(mu=at()),o&4&&(o=e.updateQueue,o!==null&&(e.updateQueue=null,hu(e,o)));break;case 22:h=e.memoizedState!==null;var pe=r!==null&&r.memoizedState!==null,ze=Qs,Qe=Er;if(Qs=ze||h,Er=Qe||pe,ba(t,e),Er=Qe,Qs=ze,xa(e),o&8192)e:for(t=e.stateNode,t._visibility=h?t._visibility&-2:t._visibility|1,h&&(r===null||pe||Qs||Er||xo(e)),r=null,t=e;;){if(t.tag===5||t.tag===26){if(r===null){pe=r=t;try{if(y=pe.stateNode,h)O=y.style,typeof O.setProperty=="function"?O.setProperty("display","none","important"):O.display="none";else{V=pe.stateNode;var nt=pe.memoizedProps.style,Pe=nt!=null&&nt.hasOwnProperty("display")?nt.display:null;V.style.display=Pe==null||typeof Pe=="boolean"?"":(""+Pe).trim()}}catch(Ct){Ln(pe,pe.return,Ct)}}}else if(t.tag===6){if(r===null){pe=t;try{pe.stateNode.nodeValue=h?"":pe.memoizedProps}catch(Ct){Ln(pe,pe.return,Ct)}}}else if(t.tag===18){if(r===null){pe=t;try{var Ke=pe.stateNode;h?Kg(Ke,!0):Kg(pe.stateNode,!1)}catch(Ct){Ln(pe,pe.return,Ct)}}}else if((t.tag!==22&&t.tag!==23||t.memoizedState===null||t===e)&&t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;r===t&&(r=null),t=t.return}r===t&&(r=null),t.sibling.return=t.return,t=t.sibling}o&4&&(o=e.updateQueue,o!==null&&(r=o.retryQueue,r!==null&&(o.retryQueue=null,hu(e,r))));break;case 19:ba(t,e),xa(e),o&4&&(o=e.updateQueue,o!==null&&(e.updateQueue=null,hu(e,o)));break;case 30:break;case 21:break;default:ba(t,e),xa(e)}}function xa(e){var t=e.flags;if(t&2){try{for(var r,o=e.return;o!==null;){if($m(o)){r=o;break}o=o.return}if(r==null)throw Error(i(160));switch(r.tag){case 27:var h=r.stateNode,y=Sf(e);fu(e,y,h);break;case 5:var O=r.stateNode;r.flags&32&&(rn(O,""),r.flags&=-33);var V=Sf(e);fu(e,V,O);break;case 3:case 4:var pe=r.stateNode.containerInfo,ze=Sf(e);Ef(e,ze,pe);break;default:throw Error(i(161))}}catch(Qe){Ln(e,e.return,Qe)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function ng(e){if(e.subtreeFlags&1024)for(e=e.child;e!==null;){var t=e;ng(t),t.tag===5&&t.flags&1024&&t.stateNode.reset(),e=e.sibling}}function Xs(e,t){if(t.subtreeFlags&8772)for(t=t.child;t!==null;)Qm(e,t.alternate,t),t=t.sibling}function xo(e){for(e=e.child;e!==null;){var t=e;switch(t.tag){case 0:case 11:case 14:case 15:ji(4,t,t.return),xo(t);break;case 1:Cs(t,t.return);var r=t.stateNode;typeof r.componentWillUnmount=="function"&&Km(t,t.return,r),xo(t);break;case 27:Wl(t.stateNode);case 26:case 5:Cs(t,t.return),xo(t);break;case 22:t.memoizedState===null&&xo(t);break;case 30:xo(t);break;default:xo(t)}e=e.sibling}}function Ws(e,t,r){for(r=r&&(t.subtreeFlags&8772)!==0,t=t.child;t!==null;){var o=t.alternate,h=e,y=t,O=y.flags;switch(y.tag){case 0:case 11:case 15:Ws(h,y,r),ql(4,y);break;case 1:if(Ws(h,y,r),o=y,h=o.stateNode,typeof h.componentDidMount=="function")try{h.componentDidMount()}catch(ze){Ln(o,o.return,ze)}if(o=y,h=o.updateQueue,h!==null){var V=o.stateNode;try{var pe=h.shared.hiddenCallbacks;if(pe!==null)for(h.shared.hiddenCallbacks=null,h=0;h<pe.length;h++)Ip(pe[h],V)}catch(ze){Ln(o,o.return,ze)}}r&&O&64&&Gm(y),Gl(y,y.return);break;case 27:Vm(y);case 26:case 5:Ws(h,y,r),r&&o===null&&O&4&&Ym(y),Gl(y,y.return);break;case 12:Ws(h,y,r);break;case 31:Ws(h,y,r),r&&O&4&&Wm(h,y);break;case 13:Ws(h,y,r),r&&O&4&&eg(h,y);break;case 22:y.memoizedState===null&&Ws(h,y,r),Gl(y,y.return);break;case 30:break;default:Ws(h,y,r)}t=t.sibling}}function Af(e,t){var r=null;e!==null&&e.memoizedState!==null&&e.memoizedState.cachePool!==null&&(r=e.memoizedState.cachePool.pool),e=null,t.memoizedState!==null&&t.memoizedState.cachePool!==null&&(e=t.memoizedState.cachePool.pool),e!==r&&(e!=null&&e.refCount++,r!=null&&Dl(r))}function Tf(e,t){e=null,t.alternate!==null&&(e=t.alternate.memoizedState.cache),t=t.memoizedState.cache,t!==e&&(t.refCount++,e!=null&&Dl(e))}function cs(e,t,r,o){if(t.subtreeFlags&10256)for(t=t.child;t!==null;)rg(e,t,r,o),t=t.sibling}function rg(e,t,r,o){var h=t.flags;switch(t.tag){case 0:case 11:case 15:cs(e,t,r,o),h&2048&&ql(9,t);break;case 1:cs(e,t,r,o);break;case 3:cs(e,t,r,o),h&2048&&(e=null,t.alternate!==null&&(e=t.alternate.memoizedState.cache),t=t.memoizedState.cache,t!==e&&(t.refCount++,e!=null&&Dl(e)));break;case 12:if(h&2048){cs(e,t,r,o),e=t.stateNode;try{var y=t.memoizedProps,O=y.id,V=y.onPostCommit;typeof V=="function"&&V(O,t.alternate===null?"mount":"update",e.passiveEffectDuration,-0)}catch(pe){Ln(t,t.return,pe)}}else cs(e,t,r,o);break;case 31:cs(e,t,r,o);break;case 13:cs(e,t,r,o);break;case 23:break;case 22:y=t.stateNode,O=t.alternate,t.memoizedState!==null?y._visibility&2?cs(e,t,r,o):Kl(e,t):y._visibility&2?cs(e,t,r,o):(y._visibility|=2,Qo(e,t,r,o,(t.subtreeFlags&10256)!==0||!1)),h&2048&&Af(O,t);break;case 24:cs(e,t,r,o),h&2048&&Tf(t.alternate,t);break;default:cs(e,t,r,o)}}function Qo(e,t,r,o,h){for(h=h&&((t.subtreeFlags&10256)!==0||!1),t=t.child;t!==null;){var y=e,O=t,V=r,pe=o,ze=O.flags;switch(O.tag){case 0:case 11:case 15:Qo(y,O,V,pe,h),ql(8,O);break;case 23:break;case 22:var Qe=O.stateNode;O.memoizedState!==null?Qe._visibility&2?Qo(y,O,V,pe,h):Kl(y,O):(Qe._visibility|=2,Qo(y,O,V,pe,h)),h&&ze&2048&&Af(O.alternate,O);break;case 24:Qo(y,O,V,pe,h),h&&ze&2048&&Tf(O.alternate,O);break;default:Qo(y,O,V,pe,h)}t=t.sibling}}function Kl(e,t){if(t.subtreeFlags&10256)for(t=t.child;t!==null;){var r=e,o=t,h=o.flags;switch(o.tag){case 22:Kl(r,o),h&2048&&Af(o.alternate,o);break;case 24:Kl(r,o),h&2048&&Tf(o.alternate,o);break;default:Kl(r,o)}t=t.sibling}}var Yl=8192;function Jo(e,t,r){if(e.subtreeFlags&Yl)for(e=e.child;e!==null;)ag(e,t,r),e=e.sibling}function ag(e,t,r){switch(e.tag){case 26:Jo(e,t,r),e.flags&Yl&&e.memoizedState!==null&&Hx(r,ls,e.memoizedState,e.memoizedProps);break;case 5:Jo(e,t,r);break;case 3:case 4:var o=ls;ls=Tu(e.stateNode.containerInfo),Jo(e,t,r),ls=o;break;case 22:e.memoizedState===null&&(o=e.alternate,o!==null&&o.memoizedState!==null?(o=Yl,Yl=16777216,Jo(e,t,r),Yl=o):Jo(e,t,r));break;default:Jo(e,t,r)}}function sg(e){var t=e.alternate;if(t!==null&&(e=t.child,e!==null)){t.child=null;do t=e.sibling,e.sibling=null,e=t;while(e!==null)}}function $l(e){var t=e.deletions;if((e.flags&16)!==0){if(t!==null)for(var r=0;r<t.length;r++){var o=t[r];Ur=o,og(o,e)}sg(e)}if(e.subtreeFlags&10256)for(e=e.child;e!==null;)ig(e),e=e.sibling}function ig(e){switch(e.tag){case 0:case 11:case 15:$l(e),e.flags&2048&&ji(9,e,e.return);break;case 3:$l(e);break;case 12:$l(e);break;case 22:var t=e.stateNode;e.memoizedState!==null&&t._visibility&2&&(e.return===null||e.return.tag!==13)?(t._visibility&=-3,pu(e)):$l(e);break;default:$l(e)}}function pu(e){var t=e.deletions;if((e.flags&16)!==0){if(t!==null)for(var r=0;r<t.length;r++){var o=t[r];Ur=o,og(o,e)}sg(e)}for(e=e.child;e!==null;){switch(t=e,t.tag){case 0:case 11:case 15:ji(8,t,t.return),pu(t);break;case 22:r=t.stateNode,r._visibility&2&&(r._visibility&=-3,pu(t));break;default:pu(t)}e=e.sibling}}function og(e,t){for(;Ur!==null;){var r=Ur;switch(r.tag){case 0:case 11:case 15:ji(8,r,t);break;case 23:case 22:if(r.memoizedState!==null&&r.memoizedState.cachePool!==null){var o=r.memoizedState.cachePool.pool;o!=null&&o.refCount++}break;case 24:Dl(r.memoizedState.cache)}if(o=r.child,o!==null)o.return=r,Ur=o;else e:for(r=e;Ur!==null;){o=Ur;var h=o.sibling,y=o.return;if(Jm(o),o===r){Ur=null;break e}if(h!==null){h.return=y,Ur=h;break e}Ur=y}}}var nx={getCacheForType:function(e){var t=Gr(_r),r=t.data.get(e);return r===void 0&&(r=e(),t.data.set(e,r)),r},cacheSignal:function(){return Gr(_r).controller.signal}},rx=typeof WeakMap=="function"?WeakMap:Map,On=0,Kn=null,hn=null,yn=0,Un=0,Ra=null,Ii=!1,Xo=!1,Cf=!1,ei=0,dr=0,Ri=0,_o=0,Nf=0,Ma=0,Wo=0,Vl=null,_a=null,Df=!1,mu=0,lg=0,gu=1/0,yu=null,Mi=null,Or=0,Ui=null,el=null,ti=0,Of=0,jf=null,cg=null,Zl=0,If=null;function Ua(){return(On&2)!==0&&yn!==0?yn&-yn:J.T!==null?Bf():zr()}function ug(){if(Ma===0)if((yn&536870912)===0||_n){var e=An;An<<=1,(An&3932160)===0&&(An=262144),Ma=e}else Ma=536870912;return e=ja.current,e!==null&&(e.flags|=32),Ma}function wa(e,t,r){(e===Kn&&(Un===2||Un===9)||e.cancelPendingCommit!==null)&&(tl(e,0),Li(e,yn,Ma,!1)),Lr(e,r),((On&2)===0||e!==Kn)&&(e===Kn&&((On&2)===0&&(_o|=r),dr===4&&Li(e,yn,Ma,!1)),Ns(e))}function dg(e,t,r){if((On&6)!==0)throw Error(i(327));var o=!r&&(t&127)===0&&(t&e.expiredLanes)===0||ka(e,t),h=o?ix(e,t):Mf(e,t,!0),y=o;do{if(h===0){Xo&&!o&&Li(e,t,0,!1);break}else{if(r=e.current.alternate,y&&!ax(r)){h=Mf(e,t,!1),y=!1;continue}if(h===2){if(y=t,e.errorRecoveryDisabledLanes&y)var O=0;else O=e.pendingLanes&-536870913,O=O!==0?O:O&536870912?536870912:0;if(O!==0){t=O;e:{var V=e;h=Vl;var pe=V.current.memoizedState.isDehydrated;if(pe&&(tl(V,O).flags|=256),O=Mf(V,O,!1),O!==2){if(Cf&&!pe){V.errorRecoveryDisabledLanes|=y,_o|=y,h=4;break e}y=_a,_a=h,y!==null&&(_a===null?_a=y:_a.push.apply(_a,y))}h=O}if(y=!1,h!==2)continue}}if(h===1){tl(e,0),Li(e,t,0,!0);break}e:{switch(o=e,y=h,y){case 0:case 1:throw Error(i(345));case 4:if((t&4194048)!==t)break;case 6:Li(o,t,Ma,!Ii);break e;case 2:_a=null;break;case 3:case 5:break;default:throw Error(i(329))}if((t&62914560)===t&&(h=mu+300-at(),10<h)){if(Li(o,t,Ma,!Ii),Tr(o,0,!0)!==0)break e;ti=t,o.timeoutHandle=Pg(fg.bind(null,o,r,_a,yu,Df,t,Ma,_o,Wo,Ii,y,"Throttled",-0,0),h);break e}fg(o,r,_a,yu,Df,t,Ma,_o,Wo,Ii,y,null,-0,0)}}break}while(!0);Ns(e)}function fg(e,t,r,o,h,y,O,V,pe,ze,Qe,nt,Pe,Ke){if(e.timeoutHandle=-1,nt=t.subtreeFlags,nt&8192||(nt&16785408)===16785408){nt={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:cr},ag(t,y,nt);var Ct=(y&62914560)===y?mu-at():(y&4194048)===y?lg-at():0;if(Ct=Px(nt,Ct),Ct!==null){ti=y,e.cancelPendingCommit=Ct(xg.bind(null,e,t,y,r,o,h,O,V,pe,Qe,nt,null,Pe,Ke)),Li(e,y,O,!ze);return}}xg(e,t,y,r,o,h,O,V,pe)}function ax(e){for(var t=e;;){var r=t.tag;if((r===0||r===11||r===15)&&t.flags&16384&&(r=t.updateQueue,r!==null&&(r=r.stores,r!==null)))for(var o=0;o<r.length;o++){var h=r[o],y=h.getSnapshot;h=h.value;try{if(!g(y(),h))return!1}catch{return!1}}if(r=t.child,t.subtreeFlags&16384&&r!==null)r.return=t,t=r;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Li(e,t,r,o){t&=~Nf,t&=~_o,e.suspendedLanes|=t,e.pingedLanes&=~t,o&&(e.warmLanes|=t),o=e.expirationTimes;for(var h=t;0<h;){var y=31-tn(h),O=1<<y;o[y]=-1,h&=~O}r!==0&&En(e,r,t)}function vu(){return(On&6)===0?(Ql(0),!1):!0}function Rf(){if(hn!==null){if(Un===0)var e=hn.return;else e=hn,Gs=fo=null,Zd(e),Ko=null,jl=0,e=hn;for(;e!==null;)qm(e.alternate,e),e=e.return;hn=null}}function tl(e,t){var r=e.timeoutHandle;r!==-1&&(e.timeoutHandle=-1,Ex(r)),r=e.cancelPendingCommit,r!==null&&(e.cancelPendingCommit=null,r()),ti=0,Rf(),Kn=e,hn=r=Ps(e.current,null),yn=t,Un=0,Ra=null,Ii=!1,Xo=ka(e,t),Cf=!1,Wo=Ma=Nf=_o=Ri=dr=0,_a=Vl=null,Df=!1,(t&8)!==0&&(t|=t&32);var o=e.entangledLanes;if(o!==0)for(e=e.entanglements,o&=t;0<o;){var h=31-tn(o),y=1<<h;t|=e[h],o&=~y}return ei=t,pr(),r}function hg(e,t){an=null,J.H=Fl,t===Go||t===$c?(t=Np(),Un=3):t===Ld?(t=Np(),Un=4):Un=t===ff?8:t!==null&&typeof t=="object"&&typeof t.then=="function"?6:1,Ra=t,hn===null&&(dr=1,ou(e,Ga(t,e.current)))}function pg(){var e=ja.current;return e===null?!0:(yn&4194048)===yn?Va===null:(yn&62914560)===yn||(yn&536870912)!==0?e===Va:!1}function mg(){var e=J.H;return J.H=Fl,e===null?Fl:e}function gg(){var e=J.A;return J.A=nx,e}function bu(){dr=4,Ii||(yn&4194048)!==yn&&ja.current!==null||(Xo=!0),(Ri&134217727)===0&&(_o&134217727)===0||Kn===null||Li(Kn,yn,Ma,!1)}function Mf(e,t,r){var o=On;On|=2;var h=mg(),y=gg();(Kn!==e||yn!==t)&&(yu=null,tl(e,t)),t=!1;var O=dr;e:do try{if(Un!==0&&hn!==null){var V=hn,pe=Ra;switch(Un){case 8:Rf(),O=6;break e;case 3:case 2:case 9:case 6:ja.current===null&&(t=!0);var ze=Un;if(Un=0,Ra=null,nl(e,V,pe,ze),r&&Xo){O=0;break e}break;default:ze=Un,Un=0,Ra=null,nl(e,V,pe,ze)}}sx(),O=dr;break}catch(Qe){hg(e,Qe)}while(!0);return t&&e.shellSuspendCounter++,Gs=fo=null,On=o,J.H=h,J.A=y,hn===null&&(Kn=null,yn=0,pr()),O}function sx(){for(;hn!==null;)yg(hn)}function ix(e,t){var r=On;On|=2;var o=mg(),h=gg();Kn!==e||yn!==t?(yu=null,gu=at()+500,tl(e,t)):Xo=ka(e,t);e:do try{if(Un!==0&&hn!==null){t=hn;var y=Ra;t:switch(Un){case 1:Un=0,Ra=null,nl(e,t,y,1);break;case 2:case 9:if(Tp(y)){Un=0,Ra=null,vg(t);break}t=function(){Un!==2&&Un!==9||Kn!==e||(Un=7),Ns(e)},y.then(t,t);break e;case 3:Un=7;break e;case 4:Un=5;break e;case 7:Tp(y)?(Un=0,Ra=null,vg(t)):(Un=0,Ra=null,nl(e,t,y,7));break;case 5:var O=null;switch(hn.tag){case 26:O=hn.memoizedState;case 5:case 27:var V=hn;if(O?ry(O):V.stateNode.complete){Un=0,Ra=null;var pe=V.sibling;if(pe!==null)hn=pe;else{var ze=V.return;ze!==null?(hn=ze,xu(ze)):hn=null}break t}}Un=0,Ra=null,nl(e,t,y,5);break;case 6:Un=0,Ra=null,nl(e,t,y,6);break;case 8:Rf(),dr=6;break e;default:throw Error(i(462))}}ox();break}catch(Qe){hg(e,Qe)}while(!0);return Gs=fo=null,J.H=o,J.A=h,On=r,hn!==null?0:(Kn=null,yn=0,pr(),dr)}function ox(){for(;hn!==null&&!be();)yg(hn)}function yg(e){var t=Hm(e.alternate,e,ei);e.memoizedProps=e.pendingProps,t===null?xu(e):hn=t}function vg(e){var t=e,r=t.alternate;switch(t.tag){case 15:case 0:t=Mm(r,t,t.pendingProps,t.type,void 0,yn);break;case 11:t=Mm(r,t,t.pendingProps,t.type.render,t.ref,yn);break;case 5:Zd(t);default:qm(r,t),t=hn=gp(t,ei),t=Hm(r,t,ei)}e.memoizedProps=e.pendingProps,t===null?xu(e):hn=t}function nl(e,t,r,o){Gs=fo=null,Zd(t),Ko=null,jl=0;var h=t.return;try{if(Z0(e,h,t,r,yn)){dr=1,ou(e,Ga(r,e.current)),hn=null;return}}catch(y){if(h!==null)throw hn=h,y;dr=1,ou(e,Ga(r,e.current)),hn=null;return}t.flags&32768?(_n||o===1?e=!0:Xo||(yn&536870912)!==0?e=!1:(Ii=e=!0,(o===2||o===9||o===3||o===6)&&(o=ja.current,o!==null&&o.tag===13&&(o.flags|=16384))),bg(t,e)):xu(t)}function xu(e){var t=e;do{if((t.flags&32768)!==0){bg(t,Ii);return}e=t.return;var r=X0(t.alternate,t,ei);if(r!==null){hn=r;return}if(t=t.sibling,t!==null){hn=t;return}hn=t=e}while(t!==null);dr===0&&(dr=5)}function bg(e,t){do{var r=W0(e.alternate,e);if(r!==null){r.flags&=32767,hn=r;return}if(r=e.return,r!==null&&(r.flags|=32768,r.subtreeFlags=0,r.deletions=null),!t&&(e=e.sibling,e!==null)){hn=e;return}hn=e=r}while(e!==null);dr=6,hn=null}function xg(e,t,r,o,h,y,O,V,pe){e.cancelPendingCommit=null;do _u();while(Or!==0);if((On&6)!==0)throw Error(i(327));if(t!==null){if(t===e.current)throw Error(i(177));if(y=t.lanes|t.childLanes,y|=en,Aa(e,r,y,O,V,pe),e===Kn&&(hn=Kn=null,yn=0),el=t,Ui=e,ti=r,Of=y,jf=h,cg=o,(t.subtreeFlags&10256)!==0||(t.flags&10256)!==0?(e.callbackNode=null,e.callbackPriority=0,dx(Nt,function(){return kg(),null})):(e.callbackNode=null,e.callbackPriority=0),o=(t.flags&13878)!==0,(t.subtreeFlags&13878)!==0||o){o=J.T,J.T=null,h=Z.p,Z.p=2,O=On,On|=4;try{ex(e,t,r)}finally{On=O,Z.p=h,J.T=o}}Or=1,_g(),wg(),Sg()}}function _g(){if(Or===1){Or=0;var e=Ui,t=el,r=(t.flags&13878)!==0;if((t.subtreeFlags&13878)!==0||r){r=J.T,J.T=null;var o=Z.p;Z.p=2;var h=On;On|=4;try{tg(t,e);var y=$f,O=ae(e.containerInfo),V=y.focusedElem,pe=y.selectionRange;if(O!==V&&V&&V.ownerDocument&&K(V.ownerDocument.documentElement,V)){if(pe!==null&&fe(V)){var ze=pe.start,Qe=pe.end;if(Qe===void 0&&(Qe=ze),"selectionStart"in V)V.selectionStart=ze,V.selectionEnd=Math.min(Qe,V.value.length);else{var nt=V.ownerDocument||document,Pe=nt&&nt.defaultView||window;if(Pe.getSelection){var Ke=Pe.getSelection(),Ct=V.textContent.length,qt=Math.min(pe.start,Ct),Pn=pe.end===void 0?qt:Math.min(pe.end,Ct);!Ke.extend&&qt>Pn&&(O=Pn,Pn=qt,qt=O);var Ie=B(V,qt),Se=B(V,Pn);if(Ie&&Se&&(Ke.rangeCount!==1||Ke.anchorNode!==Ie.node||Ke.anchorOffset!==Ie.offset||Ke.focusNode!==Se.node||Ke.focusOffset!==Se.offset)){var Le=nt.createRange();Le.setStart(Ie.node,Ie.offset),Ke.removeAllRanges(),qt>Pn?(Ke.addRange(Le),Ke.extend(Se.node,Se.offset)):(Le.setEnd(Se.node,Se.offset),Ke.addRange(Le))}}}}for(nt=[],Ke=V;Ke=Ke.parentNode;)Ke.nodeType===1&&nt.push({element:Ke,left:Ke.scrollLeft,top:Ke.scrollTop});for(typeof V.focus=="function"&&V.focus(),V=0;V<nt.length;V++){var tt=nt[V];tt.element.scrollLeft=tt.left,tt.element.scrollTop=tt.top}}Iu=!!Yf,$f=Yf=null}finally{On=h,Z.p=o,J.T=r}}e.current=t,Or=2}}function wg(){if(Or===2){Or=0;var e=Ui,t=el,r=(t.flags&8772)!==0;if((t.subtreeFlags&8772)!==0||r){r=J.T,J.T=null;var o=Z.p;Z.p=2;var h=On;On|=4;try{Qm(e,t.alternate,t)}finally{On=h,Z.p=o,J.T=r}}Or=3}}function Sg(){if(Or===4||Or===3){Or=0,Ze();var e=Ui,t=el,r=ti,o=cg;(t.subtreeFlags&10256)!==0||(t.flags&10256)!==0?Or=5:(Or=0,el=Ui=null,Eg(e,e.pendingLanes));var h=e.pendingLanes;if(h===0&&(Mi=null),da(r),t=t.stateNode,Ht&&typeof Ht.onCommitFiberRoot=="function")try{Ht.onCommitFiberRoot(zt,t,void 0,(t.current.flags&128)===128)}catch{}if(o!==null){t=J.T,h=Z.p,Z.p=2,J.T=null;try{for(var y=e.onRecoverableError,O=0;O<o.length;O++){var V=o[O];y(V.value,{componentStack:V.stack})}}finally{J.T=t,Z.p=h}}(ti&3)!==0&&_u(),Ns(e),h=e.pendingLanes,(r&261930)!==0&&(h&42)!==0?e===If?Zl++:(Zl=0,If=e):Zl=0,Ql(0)}}function Eg(e,t){(e.pooledCacheLanes&=t)===0&&(t=e.pooledCache,t!=null&&(e.pooledCache=null,Dl(t)))}function _u(){return _g(),wg(),Sg(),kg()}function kg(){if(Or!==5)return!1;var e=Ui,t=Of;Of=0;var r=da(ti),o=J.T,h=Z.p;try{Z.p=32>r?32:r,J.T=null,r=jf,jf=null;var y=Ui,O=ti;if(Or=0,el=Ui=null,ti=0,(On&6)!==0)throw Error(i(331));var V=On;if(On|=4,ig(y.current),rg(y,y.current,O,r),On=V,Ql(0,!1),Ht&&typeof Ht.onPostCommitFiberRoot=="function")try{Ht.onPostCommitFiberRoot(zt,y)}catch{}return!0}finally{Z.p=h,J.T=o,Eg(e,t)}}function Ag(e,t,r){t=Ga(r,t),t=df(e.stateNode,t,2),e=Ni(e,t,2),e!==null&&(Lr(e,2),Ns(e))}function Ln(e,t,r){if(e.tag===3)Ag(e,e,r);else for(;t!==null;){if(t.tag===3){Ag(t,e,r);break}else if(t.tag===1){var o=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof o.componentDidCatch=="function"&&(Mi===null||!Mi.has(o))){e=Ga(r,e),r=Tm(2),o=Ni(t,r,2),o!==null&&(Cm(r,o,t,e),Lr(o,2),Ns(o));break}}t=t.return}}function Uf(e,t,r){var o=e.pingCache;if(o===null){o=e.pingCache=new rx;var h=new Set;o.set(t,h)}else h=o.get(t),h===void 0&&(h=new Set,o.set(t,h));h.has(r)||(Cf=!0,h.add(r),e=lx.bind(null,e,t,r),t.then(e,e))}function lx(e,t,r){var o=e.pingCache;o!==null&&o.delete(t),e.pingedLanes|=e.suspendedLanes&r,e.warmLanes&=~r,Kn===e&&(yn&r)===r&&(dr===4||dr===3&&(yn&62914560)===yn&&300>at()-mu?(On&2)===0&&tl(e,0):Nf|=r,Wo===yn&&(Wo=0)),Ns(e)}function Tg(e,t){t===0&&(t=Vr()),e=ar(e,t),e!==null&&(Lr(e,t),Ns(e))}function cx(e){var t=e.memoizedState,r=0;t!==null&&(r=t.retryLane),Tg(e,r)}function ux(e,t){var r=0;switch(e.tag){case 31:case 13:var o=e.stateNode,h=e.memoizedState;h!==null&&(r=h.retryLane);break;case 19:o=e.stateNode;break;case 22:o=e.stateNode._retryCache;break;default:throw Error(i(314))}o!==null&&o.delete(t),Tg(e,r)}function dx(e,t){return Ve(e,t)}var wu=null,rl=null,Lf=!1,Su=!1,zf=!1,zi=0;function Ns(e){e!==rl&&e.next===null&&(rl===null?wu=rl=e:rl=rl.next=e),Su=!0,Lf||(Lf=!0,hx())}function Ql(e,t){if(!zf&&Su){zf=!0;do for(var r=!1,o=wu;o!==null;){if(e!==0){var h=o.pendingLanes;if(h===0)var y=0;else{var O=o.suspendedLanes,V=o.pingedLanes;y=(1<<31-tn(42|e)+1)-1,y&=h&~(O&~V),y=y&201326741?y&201326741|1:y?y|2:0}y!==0&&(r=!0,Og(o,y))}else y=yn,y=Tr(o,o===Kn?y:0,o.cancelPendingCommit!==null||o.timeoutHandle!==-1),(y&3)===0||ka(o,y)||(r=!0,Og(o,y));o=o.next}while(r);zf=!1}}function fx(){Cg()}function Cg(){Su=Lf=!1;var e=0;zi!==0&&Sx()&&(e=zi);for(var t=at(),r=null,o=wu;o!==null;){var h=o.next,y=Ng(o,t);y===0?(o.next=null,r===null?wu=h:r.next=h,h===null&&(rl=r)):(r=o,(e!==0||(y&3)!==0)&&(Su=!0)),o=h}Or!==0&&Or!==5||Ql(e),zi!==0&&(zi=0)}function Ng(e,t){for(var r=e.suspendedLanes,o=e.pingedLanes,h=e.expirationTimes,y=e.pendingLanes&-62914561;0<y;){var O=31-tn(y),V=1<<O,pe=h[O];pe===-1?((V&r)===0||(V&o)!==0)&&(h[O]=mt(V,t)):pe<=t&&(e.expiredLanes|=V),y&=~V}if(t=Kn,r=yn,r=Tr(e,e===t?r:0,e.cancelPendingCommit!==null||e.timeoutHandle!==-1),o=e.callbackNode,r===0||e===t&&(Un===2||Un===9)||e.cancelPendingCommit!==null)return o!==null&&o!==null&&Ye(o),e.callbackNode=null,e.callbackPriority=0;if((r&3)===0||ka(e,r)){if(t=r&-r,t===e.callbackPriority)return t;switch(o!==null&&Ye(o),da(r)){case 2:case 8:r=It;break;case 32:r=Nt;break;case 268435456:r=Zt;break;default:r=Nt}return o=Dg.bind(null,e),r=Ve(r,o),e.callbackPriority=t,e.callbackNode=r,t}return o!==null&&o!==null&&Ye(o),e.callbackPriority=2,e.callbackNode=null,2}function Dg(e,t){if(Or!==0&&Or!==5)return e.callbackNode=null,e.callbackPriority=0,null;var r=e.callbackNode;if(_u()&&e.callbackNode!==r)return null;var o=yn;return o=Tr(e,e===Kn?o:0,e.cancelPendingCommit!==null||e.timeoutHandle!==-1),o===0?null:(dg(e,o,t),Ng(e,at()),e.callbackNode!=null&&e.callbackNode===r?Dg.bind(null,e):null)}function Og(e,t){if(_u())return null;dg(e,t,!0)}function hx(){kx(function(){(On&6)!==0?Ve(_t,fx):Cg()})}function Bf(){if(zi===0){var e=Po;e===0&&(e=jr,jr<<=1,(jr&261888)===0&&(jr=256)),zi=e}return zi}function jg(e){return e==null||typeof e=="symbol"||typeof e=="boolean"?null:typeof e=="function"?e:Pr(""+e)}function Ig(e,t){var r=t.ownerDocument.createElement("input");return r.name=t.name,r.value=t.value,e.id&&r.setAttribute("form",e.id),t.parentNode.insertBefore(r,t),e=new FormData(e),r.parentNode.removeChild(r),e}function px(e,t,r,o,h){if(t==="submit"&&r&&r.stateNode===h){var y=jg((h[nn]||null).action),O=o.submitter;O&&(t=(t=O[nn]||null)?jg(t.formAction):O.getAttribute("formAction"),t!==null&&(y=t,O=null));var V=new Je("action","action",null,o,h);e.push({event:V,listeners:[{instance:null,listener:function(){if(o.defaultPrevented){if(zi!==0){var pe=O?Ig(h,O):new FormData(h);af(r,{pending:!0,data:pe,method:h.method,action:y},null,pe)}}else typeof y=="function"&&(V.preventDefault(),pe=O?Ig(h,O):new FormData(h),af(r,{pending:!0,data:pe,method:h.method,action:y},y,pe))},currentTarget:h}]})}}for(var Ff=0;Ff<Yt.length;Ff++){var Hf=Yt[Ff],mx=Hf.toLowerCase(),gx=Hf[0].toUpperCase()+Hf.slice(1);Ft(mx,"on"+gx)}Ft(Ge,"onAnimationEnd"),Ft(Xe,"onAnimationIteration"),Ft(ct,"onAnimationStart"),Ft("dblclick","onDoubleClick"),Ft("focusin","onFocus"),Ft("focusout","onBlur"),Ft(bt,"onTransitionRun"),Ft(dt,"onTransitionStart"),Ft(vt,"onTransitionCancel"),Ft(xt,"onTransitionEnd"),Xn("onMouseEnter",["mouseout","mouseover"]),Xn("onMouseLeave",["mouseout","mouseover"]),Xn("onPointerEnter",["pointerout","pointerover"]),Xn("onPointerLeave",["pointerout","pointerover"]),Mn("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Mn("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Mn("onBeforeInput",["compositionend","keypress","textInput","paste"]),Mn("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Mn("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Mn("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Jl="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),yx=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Jl));function Rg(e,t){t=(t&4)!==0;for(var r=0;r<e.length;r++){var o=e[r],h=o.event;o=o.listeners;e:{var y=void 0;if(t)for(var O=o.length-1;0<=O;O--){var V=o[O],pe=V.instance,ze=V.currentTarget;if(V=V.listener,pe!==y&&h.isPropagationStopped())break e;y=V,h.currentTarget=ze;try{y(h)}catch(Qe){Wt(Qe)}h.currentTarget=null,y=pe}else for(O=0;O<o.length;O++){if(V=o[O],pe=V.instance,ze=V.currentTarget,V=V.listener,pe!==y&&h.isPropagationStopped())break e;y=V,h.currentTarget=ze;try{y(h)}catch(Qe){Wt(Qe)}h.currentTarget=null,y=pe}}}}function pn(e,t){var r=t[ms];r===void 0&&(r=t[ms]=new Set);var o=e+"__bubble";r.has(o)||(Mg(t,e,2,!1),r.add(o))}function Pf(e,t,r){var o=0;t&&(o|=4),Mg(r,e,o,t)}var Eu="_reactListening"+Math.random().toString(36).slice(2);function qf(e){if(!e[Eu]){e[Eu]=!0,Zn.forEach(function(r){r!=="selectionchange"&&(yx.has(r)||Pf(r,!1,e),Pf(r,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[Eu]||(t[Eu]=!0,Pf("selectionchange",!1,t))}}function Mg(e,t,r,o){switch(uy(t)){case 2:var h=Kx;break;case 8:h=Yx;break;default:h=ah}r=h.bind(null,t,r,e),h=void 0,!Da||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(h=!0),o?h!==void 0?e.addEventListener(t,r,{capture:!0,passive:h}):e.addEventListener(t,r,!0):h!==void 0?e.addEventListener(t,r,{passive:h}):e.addEventListener(t,r,!1)}function Gf(e,t,r,o,h){var y=o;if((t&1)===0&&(t&2)===0&&o!==null)e:for(;;){if(o===null)return;var O=o.tag;if(O===3||O===4){var V=o.stateNode.containerInfo;if(V===h)break;if(O===4)for(O=o.return;O!==null;){var pe=O.tag;if((pe===3||pe===4)&&O.stateNode.containerInfo===h)return;O=O.return}for(;V!==null;){if(O=ut(V),O===null)return;if(pe=O.tag,pe===5||pe===6||pe===26||pe===27){o=y=O;continue e}V=V.parentNode}}o=o.return}Jr(function(){var ze=y,Qe=Gn(r),nt=[];e:{var Pe=lt.get(e);if(Pe!==void 0){var Ke=Je,Ct=e;switch(e){case"keypress":if(x(r)===0)break e;case"keydown":case"keyup":Ke=Ro;break;case"focusin":Ct="focus",Ke=di;break;case"focusout":Ct="blur",Ke=di;break;case"beforeblur":case"afterblur":Ke=di;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Ke=Wi;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Ke=ui;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Ke=ro;break;case Ge:case Xe:case ct:Ke=fi;break;case xt:Ke=gi;break;case"scroll":case"scrollend":Ke=fn;break;case"wheel":Ke=Mo;break;case"copy":case"cut":case"paste":Ke=to;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Ke=mi;break;case"toggle":case"beforetoggle":Ke=yi}var qt=(t&4)!==0,Pn=!qt&&(e==="scroll"||e==="scrollend"),Ie=qt?Pe!==null?Pe+"Capture":null:Pe;qt=[];for(var Se=ze,Le;Se!==null;){var tt=Se;if(Le=tt.stateNode,tt=tt.tag,tt!==5&&tt!==26&&tt!==27||Le===null||Ie===null||(tt=Pa(Se,Ie),tt!=null&&qt.push(Xl(Se,tt,Le))),Pn)break;Se=Se.return}0<qt.length&&(Pe=new Ke(Pe,Ct,null,r,Qe),nt.push({event:Pe,listeners:qt}))}}if((t&7)===0){e:{if(Pe=e==="mouseover"||e==="pointerover",Ke=e==="mouseout"||e==="pointerout",Pe&&r!==Na&&(Ct=r.relatedTarget||r.fromElement)&&(ut(Ct)||Ct[Br]))break e;if((Ke||Pe)&&(Pe=Qe.window===Qe?Qe:(Pe=Qe.ownerDocument)?Pe.defaultView||Pe.parentWindow:window,Ke?(Ct=r.relatedTarget||r.toElement,Ke=ze,Ct=Ct?ut(Ct):null,Ct!==null&&(Pn=u(Ct),qt=Ct.tag,Ct!==Pn||qt!==5&&qt!==27&&qt!==6)&&(Ct=null)):(Ke=null,Ct=ze),Ke!==Ct)){if(qt=Wi,tt="onMouseLeave",Ie="onMouseEnter",Se="mouse",(e==="pointerout"||e==="pointerover")&&(qt=mi,tt="onPointerLeave",Ie="onPointerEnter",Se="pointer"),Pn=Ke==null?Pe:xn(Ke),Le=Ct==null?Pe:xn(Ct),Pe=new qt(tt,Se+"leave",Ke,r,Qe),Pe.target=Pn,Pe.relatedTarget=Le,tt=null,ut(Qe)===ze&&(qt=new qt(Ie,Se+"enter",Ct,r,Qe),qt.target=Le,qt.relatedTarget=Pn,tt=qt),Pn=tt,Ke&&Ct)t:{for(qt=vx,Ie=Ke,Se=Ct,Le=0,tt=Ie;tt;tt=qt(tt))Le++;tt=0;for(var Lt=Se;Lt;Lt=qt(Lt))tt++;for(;0<Le-tt;)Ie=qt(Ie),Le--;for(;0<tt-Le;)Se=qt(Se),tt--;for(;Le--;){if(Ie===Se||Se!==null&&Ie===Se.alternate){qt=Ie;break t}Ie=qt(Ie),Se=qt(Se)}qt=null}else qt=null;Ke!==null&&Ug(nt,Pe,Ke,qt,!1),Ct!==null&&Pn!==null&&Ug(nt,Pn,Ct,qt,!0)}}e:{if(Pe=ze?xn(ze):window,Ke=Pe.nodeName&&Pe.nodeName.toLowerCase(),Ke==="select"||Ke==="input"&&Pe.type==="file")var Cn=Wn;else if(Ir(Pe))if(lo)Cn=Hc;else{Cn=xi;var jt=Tl}else Ke=Pe.nodeName,!Ke||Ke.toLowerCase()!=="input"||Pe.type!=="checkbox"&&Pe.type!=="radio"?ze&&lr(ze.elementType)&&(Cn=Wn):Cn=Es;if(Cn&&(Cn=Cn(e,ze))){Rr(nt,Cn,r,Qe);break e}jt&&jt(e,Pe,ze),e==="focusout"&&ze&&Pe.type==="number"&&ze.memoizedProps.value!=null&&sa(Pe,"number",Pe.value)}switch(jt=ze?xn(ze):window,e){case"focusin":(Ir(jt)||jt.contentEditable==="true")&&(xe=jt,je=ze,ge=null);break;case"focusout":ge=je=xe=null;break;case"mousedown":Re=!0;break;case"contextmenu":case"mouseup":case"dragend":Re=!1,Ee(nt,r,Qe);break;case"selectionchange":if(ke)break;case"keydown":case"keyup":Ee(nt,r,Qe)}var ln;if(io)e:{switch(e){case"compositionstart":var vn="onCompositionStart";break e;case"compositionend":vn="onCompositionEnd";break e;case"compositionupdate":vn="onCompositionUpdate";break e}vn=void 0}else Bt?it(e,r)&&(vn="onCompositionEnd"):e==="keydown"&&r.keyCode===229&&(vn="onCompositionStart");vn&&(oo&&r.locale!=="ko"&&(Bt||vn!=="onCompositionStart"?vn==="onCompositionEnd"&&Bt&&(ln=v()):(hr=Qe,ga="value"in hr?hr.value:hr.textContent,Bt=!0)),jt=ku(ze,vn),0<jt.length&&(vn=new hi(vn,e,null,r,Qe),nt.push({event:vn,listeners:jt}),ln?vn.data=ln:(ln=Dt(r),ln!==null&&(vn.data=ln)))),(ln=ws?Xt(e,r):Tn(e,r))&&(vn=ku(ze,"onBeforeInput"),0<vn.length&&(jt=new hi("onBeforeInput","beforeinput",null,r,Qe),nt.push({event:jt,listeners:vn}),jt.data=ln)),px(nt,e,ze,r,Qe)}Rg(nt,t)})}function Xl(e,t,r){return{instance:e,listener:t,currentTarget:r}}function ku(e,t){for(var r=t+"Capture",o=[];e!==null;){var h=e,y=h.stateNode;if(h=h.tag,h!==5&&h!==26&&h!==27||y===null||(h=Pa(e,r),h!=null&&o.unshift(Xl(e,h,y)),h=Pa(e,t),h!=null&&o.push(Xl(e,h,y))),e.tag===3)return o;e=e.return}return[]}function vx(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5&&e.tag!==27);return e||null}function Ug(e,t,r,o,h){for(var y=t._reactName,O=[];r!==null&&r!==o;){var V=r,pe=V.alternate,ze=V.stateNode;if(V=V.tag,pe!==null&&pe===o)break;V!==5&&V!==26&&V!==27||ze===null||(pe=ze,h?(ze=Pa(r,y),ze!=null&&O.unshift(Xl(r,ze,pe))):h||(ze=Pa(r,y),ze!=null&&O.push(Xl(r,ze,pe)))),r=r.return}O.length!==0&&e.push({event:t,listeners:O})}var bx=/\r\n?/g,xx=/\u0000|\uFFFD/g;function Lg(e){return(typeof e=="string"?e:""+e).replace(bx,`
`).replace(xx,"")}function zg(e,t){return t=Lg(t),Lg(e)===t}function Hn(e,t,r,o,h,y){switch(r){case"children":typeof o=="string"?t==="body"||t==="textarea"&&o===""||rn(e,o):(typeof o=="number"||typeof o=="bigint")&&t!=="body"&&rn(e,""+o);break;case"className":ys(e,"class",o);break;case"tabIndex":ys(e,"tabindex",o);break;case"dir":case"role":case"viewBox":case"width":case"height":ys(e,r,o);break;case"style":Oo(e,o,y);break;case"data":if(t!=="object"){ys(e,"data",o);break}case"src":case"href":if(o===""&&(t!=="a"||r!=="href")){e.removeAttribute(r);break}if(o==null||typeof o=="function"||typeof o=="symbol"||typeof o=="boolean"){e.removeAttribute(r);break}o=Pr(""+o),e.setAttribute(r,o);break;case"action":case"formAction":if(typeof o=="function"){e.setAttribute(r,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof y=="function"&&(r==="formAction"?(t!=="input"&&Hn(e,t,"name",h.name,h,null),Hn(e,t,"formEncType",h.formEncType,h,null),Hn(e,t,"formMethod",h.formMethod,h,null),Hn(e,t,"formTarget",h.formTarget,h,null)):(Hn(e,t,"encType",h.encType,h,null),Hn(e,t,"method",h.method,h,null),Hn(e,t,"target",h.target,h,null)));if(o==null||typeof o=="symbol"||typeof o=="boolean"){e.removeAttribute(r);break}o=Pr(""+o),e.setAttribute(r,o);break;case"onClick":o!=null&&(e.onclick=cr);break;case"onScroll":o!=null&&pn("scroll",e);break;case"onScrollEnd":o!=null&&pn("scrollend",e);break;case"dangerouslySetInnerHTML":if(o!=null){if(typeof o!="object"||!("__html"in o))throw Error(i(61));if(r=o.__html,r!=null){if(h.children!=null)throw Error(i(60));e.innerHTML=r}}break;case"multiple":e.multiple=o&&typeof o!="function"&&typeof o!="symbol";break;case"muted":e.muted=o&&typeof o!="function"&&typeof o!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(o==null||typeof o=="function"||typeof o=="boolean"||typeof o=="symbol"){e.removeAttribute("xlink:href");break}r=Pr(""+o),e.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",r);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":o!=null&&typeof o!="function"&&typeof o!="symbol"?e.setAttribute(r,""+o):e.removeAttribute(r);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":o&&typeof o!="function"&&typeof o!="symbol"?e.setAttribute(r,""):e.removeAttribute(r);break;case"capture":case"download":o===!0?e.setAttribute(r,""):o!==!1&&o!=null&&typeof o!="function"&&typeof o!="symbol"?e.setAttribute(r,o):e.removeAttribute(r);break;case"cols":case"rows":case"size":case"span":o!=null&&typeof o!="function"&&typeof o!="symbol"&&!isNaN(o)&&1<=o?e.setAttribute(r,o):e.removeAttribute(r);break;case"rowSpan":case"start":o==null||typeof o=="function"||typeof o=="symbol"||isNaN(o)?e.removeAttribute(r):e.setAttribute(r,o);break;case"popover":pn("beforetoggle",e),pn("toggle",e),Ls(e,"popover",o);break;case"xlinkActuate":aa(e,"http://www.w3.org/1999/xlink","xlink:actuate",o);break;case"xlinkArcrole":aa(e,"http://www.w3.org/1999/xlink","xlink:arcrole",o);break;case"xlinkRole":aa(e,"http://www.w3.org/1999/xlink","xlink:role",o);break;case"xlinkShow":aa(e,"http://www.w3.org/1999/xlink","xlink:show",o);break;case"xlinkTitle":aa(e,"http://www.w3.org/1999/xlink","xlink:title",o);break;case"xlinkType":aa(e,"http://www.w3.org/1999/xlink","xlink:type",o);break;case"xmlBase":aa(e,"http://www.w3.org/XML/1998/namespace","xml:base",o);break;case"xmlLang":aa(e,"http://www.w3.org/XML/1998/namespace","xml:lang",o);break;case"xmlSpace":aa(e,"http://www.w3.org/XML/1998/namespace","xml:space",o);break;case"is":Ls(e,"is",o);break;case"innerText":case"textContent":break;default:(!(2<r.length)||r[0]!=="o"&&r[0]!=="O"||r[1]!=="n"&&r[1]!=="N")&&(r=Ca.get(r)||r,Ls(e,r,o))}}function Kf(e,t,r,o,h,y){switch(r){case"style":Oo(e,o,y);break;case"dangerouslySetInnerHTML":if(o!=null){if(typeof o!="object"||!("__html"in o))throw Error(i(61));if(r=o.__html,r!=null){if(h.children!=null)throw Error(i(60));e.innerHTML=r}}break;case"children":typeof o=="string"?rn(e,o):(typeof o=="number"||typeof o=="bigint")&&rn(e,""+o);break;case"onScroll":o!=null&&pn("scroll",e);break;case"onScrollEnd":o!=null&&pn("scrollend",e);break;case"onClick":o!=null&&(e.onclick=cr);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Hr.hasOwnProperty(r))e:{if(r[0]==="o"&&r[1]==="n"&&(h=r.endsWith("Capture"),t=r.slice(2,h?r.length-7:void 0),y=e[nn]||null,y=y!=null?y[r]:null,typeof y=="function"&&e.removeEventListener(t,y,h),typeof o=="function")){typeof y!="function"&&y!==null&&(r in e?e[r]=null:e.hasAttribute(r)&&e.removeAttribute(r)),e.addEventListener(t,o,h);break e}r in e?e[r]=o:o===!0?e.setAttribute(r,""):Ls(e,r,o)}}}function Yr(e,t,r){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":pn("error",e),pn("load",e);var o=!1,h=!1,y;for(y in r)if(r.hasOwnProperty(y)){var O=r[y];if(O!=null)switch(y){case"src":o=!0;break;case"srcSet":h=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(i(137,t));default:Hn(e,t,y,O,r,null)}}h&&Hn(e,t,"srcSet",r.srcSet,r,null),o&&Hn(e,t,"src",r.src,r,null);return;case"input":pn("invalid",e);var V=y=O=h=null,pe=null,ze=null;for(o in r)if(r.hasOwnProperty(o)){var Qe=r[o];if(Qe!=null)switch(o){case"name":h=Qe;break;case"type":O=Qe;break;case"checked":pe=Qe;break;case"defaultChecked":ze=Qe;break;case"value":y=Qe;break;case"defaultValue":V=Qe;break;case"children":case"dangerouslySetInnerHTML":if(Qe!=null)throw Error(i(137,t));break;default:Hn(e,t,o,Qe,r,null)}}rs(e,y,V,pe,ze,O,h,!1);return;case"select":pn("invalid",e),o=O=y=null;for(h in r)if(r.hasOwnProperty(h)&&(V=r[h],V!=null))switch(h){case"value":y=V;break;case"defaultValue":O=V;break;case"multiple":o=V;default:Hn(e,t,h,V,r,null)}t=y,r=O,e.multiple=!!o,t!=null?fa(e,!!o,t,!1):r!=null&&fa(e,!!o,r,!0);return;case"textarea":pn("invalid",e),y=h=o=null;for(O in r)if(r.hasOwnProperty(O)&&(V=r[O],V!=null))switch(O){case"value":o=V;break;case"defaultValue":h=V;break;case"children":y=V;break;case"dangerouslySetInnerHTML":if(V!=null)throw Error(i(91));break;default:Hn(e,t,O,V,r,null)}li(e,o,h,y);return;case"option":for(pe in r)if(r.hasOwnProperty(pe)&&(o=r[pe],o!=null))switch(pe){case"selected":e.selected=o&&typeof o!="function"&&typeof o!="symbol";break;default:Hn(e,t,pe,o,r,null)}return;case"dialog":pn("beforetoggle",e),pn("toggle",e),pn("cancel",e),pn("close",e);break;case"iframe":case"object":pn("load",e);break;case"video":case"audio":for(o=0;o<Jl.length;o++)pn(Jl[o],e);break;case"image":pn("error",e),pn("load",e);break;case"details":pn("toggle",e);break;case"embed":case"source":case"link":pn("error",e),pn("load",e);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(ze in r)if(r.hasOwnProperty(ze)&&(o=r[ze],o!=null))switch(ze){case"children":case"dangerouslySetInnerHTML":throw Error(i(137,t));default:Hn(e,t,ze,o,r,null)}return;default:if(lr(t)){for(Qe in r)r.hasOwnProperty(Qe)&&(o=r[Qe],o!==void 0&&Kf(e,t,Qe,o,r,void 0));return}}for(V in r)r.hasOwnProperty(V)&&(o=r[V],o!=null&&Hn(e,t,V,o,r,null))}function _x(e,t,r,o){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var h=null,y=null,O=null,V=null,pe=null,ze=null,Qe=null;for(Ke in r){var nt=r[Ke];if(r.hasOwnProperty(Ke)&&nt!=null)switch(Ke){case"checked":break;case"value":break;case"defaultValue":pe=nt;default:o.hasOwnProperty(Ke)||Hn(e,t,Ke,null,o,nt)}}for(var Pe in o){var Ke=o[Pe];if(nt=r[Pe],o.hasOwnProperty(Pe)&&(Ke!=null||nt!=null))switch(Pe){case"type":y=Ke;break;case"name":h=Ke;break;case"checked":ze=Ke;break;case"defaultChecked":Qe=Ke;break;case"value":O=Ke;break;case"defaultValue":V=Ke;break;case"children":case"dangerouslySetInnerHTML":if(Ke!=null)throw Error(i(137,t));break;default:Ke!==nt&&Hn(e,t,Pe,Ke,o,nt)}}Ta(e,O,V,pe,ze,Qe,y,h);return;case"select":Ke=O=V=Pe=null;for(y in r)if(pe=r[y],r.hasOwnProperty(y)&&pe!=null)switch(y){case"value":break;case"multiple":Ke=pe;default:o.hasOwnProperty(y)||Hn(e,t,y,null,o,pe)}for(h in o)if(y=o[h],pe=r[h],o.hasOwnProperty(h)&&(y!=null||pe!=null))switch(h){case"value":Pe=y;break;case"defaultValue":V=y;break;case"multiple":O=y;default:y!==pe&&Hn(e,t,h,y,o,pe)}t=V,r=O,o=Ke,Pe!=null?fa(e,!!r,Pe,!1):!!o!=!!r&&(t!=null?fa(e,!!r,t,!0):fa(e,!!r,r?[]:"",!1));return;case"textarea":Ke=Pe=null;for(V in r)if(h=r[V],r.hasOwnProperty(V)&&h!=null&&!o.hasOwnProperty(V))switch(V){case"value":break;case"children":break;default:Hn(e,t,V,null,o,h)}for(O in o)if(h=o[O],y=r[O],o.hasOwnProperty(O)&&(h!=null||y!=null))switch(O){case"value":Pe=h;break;case"defaultValue":Ke=h;break;case"children":break;case"dangerouslySetInnerHTML":if(h!=null)throw Error(i(91));break;default:h!==y&&Hn(e,t,O,h,o,y)}oi(e,Pe,Ke);return;case"option":for(var Ct in r)if(Pe=r[Ct],r.hasOwnProperty(Ct)&&Pe!=null&&!o.hasOwnProperty(Ct))switch(Ct){case"selected":e.selected=!1;break;default:Hn(e,t,Ct,null,o,Pe)}for(pe in o)if(Pe=o[pe],Ke=r[pe],o.hasOwnProperty(pe)&&Pe!==Ke&&(Pe!=null||Ke!=null))switch(pe){case"selected":e.selected=Pe&&typeof Pe!="function"&&typeof Pe!="symbol";break;default:Hn(e,t,pe,Pe,o,Ke)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var qt in r)Pe=r[qt],r.hasOwnProperty(qt)&&Pe!=null&&!o.hasOwnProperty(qt)&&Hn(e,t,qt,null,o,Pe);for(ze in o)if(Pe=o[ze],Ke=r[ze],o.hasOwnProperty(ze)&&Pe!==Ke&&(Pe!=null||Ke!=null))switch(ze){case"children":case"dangerouslySetInnerHTML":if(Pe!=null)throw Error(i(137,t));break;default:Hn(e,t,ze,Pe,o,Ke)}return;default:if(lr(t)){for(var Pn in r)Pe=r[Pn],r.hasOwnProperty(Pn)&&Pe!==void 0&&!o.hasOwnProperty(Pn)&&Kf(e,t,Pn,void 0,o,Pe);for(Qe in o)Pe=o[Qe],Ke=r[Qe],!o.hasOwnProperty(Qe)||Pe===Ke||Pe===void 0&&Ke===void 0||Kf(e,t,Qe,Pe,o,Ke);return}}for(var Ie in r)Pe=r[Ie],r.hasOwnProperty(Ie)&&Pe!=null&&!o.hasOwnProperty(Ie)&&Hn(e,t,Ie,null,o,Pe);for(nt in o)Pe=o[nt],Ke=r[nt],!o.hasOwnProperty(nt)||Pe===Ke||Pe==null&&Ke==null||Hn(e,t,nt,Pe,o,Ke)}function Bg(e){switch(e){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function wx(){if(typeof performance.getEntriesByType=="function"){for(var e=0,t=0,r=performance.getEntriesByType("resource"),o=0;o<r.length;o++){var h=r[o],y=h.transferSize,O=h.initiatorType,V=h.duration;if(y&&V&&Bg(O)){for(O=0,V=h.responseEnd,o+=1;o<r.length;o++){var pe=r[o],ze=pe.startTime;if(ze>V)break;var Qe=pe.transferSize,nt=pe.initiatorType;Qe&&Bg(nt)&&(pe=pe.responseEnd,O+=Qe*(pe<V?1:(V-ze)/(pe-ze)))}if(--o,t+=8*(y+O)/(h.duration/1e3),e++,10<e)break}}if(0<e)return t/e/1e6}return navigator.connection&&(e=navigator.connection.downlink,typeof e=="number")?e:5}var Yf=null,$f=null;function Au(e){return e.nodeType===9?e:e.ownerDocument}function Fg(e){switch(e){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function Hg(e,t){if(e===0)switch(t){case"svg":return 1;case"math":return 2;default:return 0}return e===1&&t==="foreignObject"?0:e}function Vf(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.children=="bigint"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var Zf=null;function Sx(){var e=window.event;return e&&e.type==="popstate"?e===Zf?!1:(Zf=e,!0):(Zf=null,!1)}var Pg=typeof setTimeout=="function"?setTimeout:void 0,Ex=typeof clearTimeout=="function"?clearTimeout:void 0,qg=typeof Promise=="function"?Promise:void 0,kx=typeof queueMicrotask=="function"?queueMicrotask:typeof qg<"u"?function(e){return qg.resolve(null).then(e).catch(Ax)}:Pg;function Ax(e){setTimeout(function(){throw e})}function Bi(e){return e==="head"}function Gg(e,t){var r=t,o=0;do{var h=r.nextSibling;if(e.removeChild(r),h&&h.nodeType===8)if(r=h.data,r==="/$"||r==="/&"){if(o===0){e.removeChild(h),ol(t);return}o--}else if(r==="$"||r==="$?"||r==="$~"||r==="$!"||r==="&")o++;else if(r==="html")Wl(e.ownerDocument.documentElement);else if(r==="head"){r=e.ownerDocument.head,Wl(r);for(var y=r.firstChild;y;){var O=y.nextSibling,V=y.nodeName;y[_e]||V==="SCRIPT"||V==="STYLE"||V==="LINK"&&y.rel.toLowerCase()==="stylesheet"||r.removeChild(y),y=O}}else r==="body"&&Wl(e.ownerDocument.body);r=h}while(r);ol(t)}function Kg(e,t){var r=e;e=0;do{var o=r.nextSibling;if(r.nodeType===1?t?(r._stashedDisplay=r.style.display,r.style.display="none"):(r.style.display=r._stashedDisplay||"",r.getAttribute("style")===""&&r.removeAttribute("style")):r.nodeType===3&&(t?(r._stashedText=r.nodeValue,r.nodeValue=""):r.nodeValue=r._stashedText||""),o&&o.nodeType===8)if(r=o.data,r==="/$"){if(e===0)break;e--}else r!=="$"&&r!=="$?"&&r!=="$~"&&r!=="$!"||e++;r=o}while(r)}function Qf(e){var t=e.firstChild;for(t&&t.nodeType===10&&(t=t.nextSibling);t;){var r=t;switch(t=t.nextSibling,r.nodeName){case"HTML":case"HEAD":case"BODY":Qf(r),st(r);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(r.rel.toLowerCase()==="stylesheet")continue}e.removeChild(r)}}function Tx(e,t,r,o){for(;e.nodeType===1;){var h=r;if(e.nodeName.toLowerCase()!==t.toLowerCase()){if(!o&&(e.nodeName!=="INPUT"||e.type!=="hidden"))break}else if(o){if(!e[_e])switch(t){case"meta":if(!e.hasAttribute("itemprop"))break;return e;case"link":if(y=e.getAttribute("rel"),y==="stylesheet"&&e.hasAttribute("data-precedence"))break;if(y!==h.rel||e.getAttribute("href")!==(h.href==null||h.href===""?null:h.href)||e.getAttribute("crossorigin")!==(h.crossOrigin==null?null:h.crossOrigin)||e.getAttribute("title")!==(h.title==null?null:h.title))break;return e;case"style":if(e.hasAttribute("data-precedence"))break;return e;case"script":if(y=e.getAttribute("src"),(y!==(h.src==null?null:h.src)||e.getAttribute("type")!==(h.type==null?null:h.type)||e.getAttribute("crossorigin")!==(h.crossOrigin==null?null:h.crossOrigin))&&y&&e.hasAttribute("async")&&!e.hasAttribute("itemprop"))break;return e;default:return e}}else if(t==="input"&&e.type==="hidden"){var y=h.name==null?null:""+h.name;if(h.type==="hidden"&&e.getAttribute("name")===y)return e}else return e;if(e=Za(e.nextSibling),e===null)break}return null}function Cx(e,t,r){if(t==="")return null;for(;e.nodeType!==3;)if((e.nodeType!==1||e.nodeName!=="INPUT"||e.type!=="hidden")&&!r||(e=Za(e.nextSibling),e===null))return null;return e}function Yg(e,t){for(;e.nodeType!==8;)if((e.nodeType!==1||e.nodeName!=="INPUT"||e.type!=="hidden")&&!t||(e=Za(e.nextSibling),e===null))return null;return e}function Jf(e){return e.data==="$?"||e.data==="$~"}function Xf(e){return e.data==="$!"||e.data==="$?"&&e.ownerDocument.readyState!=="loading"}function Nx(e,t){var r=e.ownerDocument;if(e.data==="$~")e._reactRetry=t;else if(e.data!=="$?"||r.readyState!=="loading")t();else{var o=function(){t(),r.removeEventListener("DOMContentLoaded",o)};r.addEventListener("DOMContentLoaded",o),e._reactRetry=o}}function Za(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?"||t==="$~"||t==="&"||t==="F!"||t==="F")break;if(t==="/$"||t==="/&")return null}}return e}var Wf=null;function $g(e){e=e.nextSibling;for(var t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="/$"||r==="/&"){if(t===0)return Za(e.nextSibling);t--}else r!=="$"&&r!=="$!"&&r!=="$?"&&r!=="$~"&&r!=="&"||t++}e=e.nextSibling}return null}function Vg(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="$"||r==="$!"||r==="$?"||r==="$~"||r==="&"){if(t===0)return e;t--}else r!=="/$"&&r!=="/&"||t++}e=e.previousSibling}return null}function Zg(e,t,r){switch(t=Au(r),e){case"html":if(e=t.documentElement,!e)throw Error(i(452));return e;case"head":if(e=t.head,!e)throw Error(i(453));return e;case"body":if(e=t.body,!e)throw Error(i(454));return e;default:throw Error(i(451))}}function Wl(e){for(var t=e.attributes;t.length;)e.removeAttributeNode(t[0]);st(e)}var Qa=new Map,Qg=new Set;function Tu(e){return typeof e.getRootNode=="function"?e.getRootNode():e.nodeType===9?e:e.ownerDocument}var ni=Z.d;Z.d={f:Dx,r:Ox,D:jx,C:Ix,L:Rx,m:Mx,X:Lx,S:Ux,M:zx};function Dx(){var e=ni.f(),t=vu();return e||t}function Ox(e){var t=Rt(e);t!==null&&t.tag===5&&t.type==="form"?hm(t):ni.r(e)}var al=typeof document>"u"?null:document;function Jg(e,t,r){var o=al;if(o&&typeof t=="string"&&t){var h=br(t);h='link[rel="'+e+'"][href="'+h+'"]',typeof r=="string"&&(h+='[crossorigin="'+r+'"]'),Qg.has(h)||(Qg.add(h),e={rel:e,crossOrigin:r,href:t},o.querySelector(h)===null&&(t=o.createElement("link"),Yr(t,"link",e),$t(t),o.head.appendChild(t)))}}function jx(e){ni.D(e),Jg("dns-prefetch",e,null)}function Ix(e,t){ni.C(e,t),Jg("preconnect",e,t)}function Rx(e,t,r){ni.L(e,t,r);var o=al;if(o&&e&&t){var h='link[rel="preload"][as="'+br(t)+'"]';t==="image"&&r&&r.imageSrcSet?(h+='[imagesrcset="'+br(r.imageSrcSet)+'"]',typeof r.imageSizes=="string"&&(h+='[imagesizes="'+br(r.imageSizes)+'"]')):h+='[href="'+br(e)+'"]';var y=h;switch(t){case"style":y=sl(e);break;case"script":y=il(e)}Qa.has(y)||(e=E({rel:"preload",href:t==="image"&&r&&r.imageSrcSet?void 0:e,as:t},r),Qa.set(y,e),o.querySelector(h)!==null||t==="style"&&o.querySelector(ec(y))||t==="script"&&o.querySelector(tc(y))||(t=o.createElement("link"),Yr(t,"link",e),$t(t),o.head.appendChild(t)))}}function Mx(e,t){ni.m(e,t);var r=al;if(r&&e){var o=t&&typeof t.as=="string"?t.as:"script",h='link[rel="modulepreload"][as="'+br(o)+'"][href="'+br(e)+'"]',y=h;switch(o){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":y=il(e)}if(!Qa.has(y)&&(e=E({rel:"modulepreload",href:e},t),Qa.set(y,e),r.querySelector(h)===null)){switch(o){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(r.querySelector(tc(y)))return}o=r.createElement("link"),Yr(o,"link",e),$t(o),r.head.appendChild(o)}}}function Ux(e,t,r){ni.S(e,t,r);var o=al;if(o&&e){var h=Rn(o).hoistableStyles,y=sl(e);t=t||"default";var O=h.get(y);if(!O){var V={loading:0,preload:null};if(O=o.querySelector(ec(y)))V.loading=5;else{e=E({rel:"stylesheet",href:e,"data-precedence":t},r),(r=Qa.get(y))&&eh(e,r);var pe=O=o.createElement("link");$t(pe),Yr(pe,"link",e),pe._p=new Promise(function(ze,Qe){pe.onload=ze,pe.onerror=Qe}),pe.addEventListener("load",function(){V.loading|=1}),pe.addEventListener("error",function(){V.loading|=2}),V.loading|=4,Cu(O,t,o)}O={type:"stylesheet",instance:O,count:1,state:V},h.set(y,O)}}}function Lx(e,t){ni.X(e,t);var r=al;if(r&&e){var o=Rn(r).hoistableScripts,h=il(e),y=o.get(h);y||(y=r.querySelector(tc(h)),y||(e=E({src:e,async:!0},t),(t=Qa.get(h))&&th(e,t),y=r.createElement("script"),$t(y),Yr(y,"link",e),r.head.appendChild(y)),y={type:"script",instance:y,count:1,state:null},o.set(h,y))}}function zx(e,t){ni.M(e,t);var r=al;if(r&&e){var o=Rn(r).hoistableScripts,h=il(e),y=o.get(h);y||(y=r.querySelector(tc(h)),y||(e=E({src:e,async:!0,type:"module"},t),(t=Qa.get(h))&&th(e,t),y=r.createElement("script"),$t(y),Yr(y,"link",e),r.head.appendChild(y)),y={type:"script",instance:y,count:1,state:null},o.set(h,y))}}function Xg(e,t,r,o){var h=(h=de.current)?Tu(h):null;if(!h)throw Error(i(446));switch(e){case"meta":case"title":return null;case"style":return typeof r.precedence=="string"&&typeof r.href=="string"?(t=sl(r.href),r=Rn(h).hoistableStyles,o=r.get(t),o||(o={type:"style",instance:null,count:0,state:null},r.set(t,o)),o):{type:"void",instance:null,count:0,state:null};case"link":if(r.rel==="stylesheet"&&typeof r.href=="string"&&typeof r.precedence=="string"){e=sl(r.href);var y=Rn(h).hoistableStyles,O=y.get(e);if(O||(h=h.ownerDocument||h,O={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},y.set(e,O),(y=h.querySelector(ec(e)))&&!y._p&&(O.instance=y,O.state.loading=5),Qa.has(e)||(r={rel:"preload",as:"style",href:r.href,crossOrigin:r.crossOrigin,integrity:r.integrity,media:r.media,hrefLang:r.hrefLang,referrerPolicy:r.referrerPolicy},Qa.set(e,r),y||Bx(h,e,r,O.state))),t&&o===null)throw Error(i(528,""));return O}if(t&&o!==null)throw Error(i(529,""));return null;case"script":return t=r.async,r=r.src,typeof r=="string"&&t&&typeof t!="function"&&typeof t!="symbol"?(t=il(r),r=Rn(h).hoistableScripts,o=r.get(t),o||(o={type:"script",instance:null,count:0,state:null},r.set(t,o)),o):{type:"void",instance:null,count:0,state:null};default:throw Error(i(444,e))}}function sl(e){return'href="'+br(e)+'"'}function ec(e){return'link[rel="stylesheet"]['+e+"]"}function Wg(e){return E({},e,{"data-precedence":e.precedence,precedence:null})}function Bx(e,t,r,o){e.querySelector('link[rel="preload"][as="style"]['+t+"]")?o.loading=1:(t=e.createElement("link"),o.preload=t,t.addEventListener("load",function(){return o.loading|=1}),t.addEventListener("error",function(){return o.loading|=2}),Yr(t,"link",r),$t(t),e.head.appendChild(t))}function il(e){return'[src="'+br(e)+'"]'}function tc(e){return"script[async]"+e}function ey(e,t,r){if(t.count++,t.instance===null)switch(t.type){case"style":var o=e.querySelector('style[data-href~="'+br(r.href)+'"]');if(o)return t.instance=o,$t(o),o;var h=E({},r,{"data-href":r.href,"data-precedence":r.precedence,href:null,precedence:null});return o=(e.ownerDocument||e).createElement("style"),$t(o),Yr(o,"style",h),Cu(o,r.precedence,e),t.instance=o;case"stylesheet":h=sl(r.href);var y=e.querySelector(ec(h));if(y)return t.state.loading|=4,t.instance=y,$t(y),y;o=Wg(r),(h=Qa.get(h))&&eh(o,h),y=(e.ownerDocument||e).createElement("link"),$t(y);var O=y;return O._p=new Promise(function(V,pe){O.onload=V,O.onerror=pe}),Yr(y,"link",o),t.state.loading|=4,Cu(y,r.precedence,e),t.instance=y;case"script":return y=il(r.src),(h=e.querySelector(tc(y)))?(t.instance=h,$t(h),h):(o=r,(h=Qa.get(y))&&(o=E({},r),th(o,h)),e=e.ownerDocument||e,h=e.createElement("script"),$t(h),Yr(h,"link",o),e.head.appendChild(h),t.instance=h);case"void":return null;default:throw Error(i(443,t.type))}else t.type==="stylesheet"&&(t.state.loading&4)===0&&(o=t.instance,t.state.loading|=4,Cu(o,r.precedence,e));return t.instance}function Cu(e,t,r){for(var o=r.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),h=o.length?o[o.length-1]:null,y=h,O=0;O<o.length;O++){var V=o[O];if(V.dataset.precedence===t)y=V;else if(y!==h)break}y?y.parentNode.insertBefore(e,y.nextSibling):(t=r.nodeType===9?r.head:r,t.insertBefore(e,t.firstChild))}function eh(e,t){e.crossOrigin==null&&(e.crossOrigin=t.crossOrigin),e.referrerPolicy==null&&(e.referrerPolicy=t.referrerPolicy),e.title==null&&(e.title=t.title)}function th(e,t){e.crossOrigin==null&&(e.crossOrigin=t.crossOrigin),e.referrerPolicy==null&&(e.referrerPolicy=t.referrerPolicy),e.integrity==null&&(e.integrity=t.integrity)}var Nu=null;function ty(e,t,r){if(Nu===null){var o=new Map,h=Nu=new Map;h.set(r,o)}else h=Nu,o=h.get(r),o||(o=new Map,h.set(r,o));if(o.has(e))return o;for(o.set(e,null),r=r.getElementsByTagName(e),h=0;h<r.length;h++){var y=r[h];if(!(y[_e]||y[gn]||e==="link"&&y.getAttribute("rel")==="stylesheet")&&y.namespaceURI!=="http://www.w3.org/2000/svg"){var O=y.getAttribute(t)||"";O=e+O;var V=o.get(O);V?V.push(y):o.set(O,[y])}}return o}function ny(e,t,r){e=e.ownerDocument||e,e.head.insertBefore(r,t==="title"?e.querySelector("head > title"):null)}function Fx(e,t,r){if(r===1||t.itemProp!=null)return!1;switch(e){case"meta":case"title":return!0;case"style":if(typeof t.precedence!="string"||typeof t.href!="string"||t.href==="")break;return!0;case"link":if(typeof t.rel!="string"||typeof t.href!="string"||t.href===""||t.onLoad||t.onError)break;switch(t.rel){case"stylesheet":return e=t.disabled,typeof t.precedence=="string"&&e==null;default:return!0}case"script":if(t.async&&typeof t.async!="function"&&typeof t.async!="symbol"&&!t.onLoad&&!t.onError&&t.src&&typeof t.src=="string")return!0}return!1}function ry(e){return!(e.type==="stylesheet"&&(e.state.loading&3)===0)}function Hx(e,t,r,o){if(r.type==="stylesheet"&&(typeof o.media!="string"||matchMedia(o.media).matches!==!1)&&(r.state.loading&4)===0){if(r.instance===null){var h=sl(o.href),y=t.querySelector(ec(h));if(y){t=y._p,t!==null&&typeof t=="object"&&typeof t.then=="function"&&(e.count++,e=Du.bind(e),t.then(e,e)),r.state.loading|=4,r.instance=y,$t(y);return}y=t.ownerDocument||t,o=Wg(o),(h=Qa.get(h))&&eh(o,h),y=y.createElement("link"),$t(y);var O=y;O._p=new Promise(function(V,pe){O.onload=V,O.onerror=pe}),Yr(y,"link",o),r.instance=y}e.stylesheets===null&&(e.stylesheets=new Map),e.stylesheets.set(r,t),(t=r.state.preload)&&(r.state.loading&3)===0&&(e.count++,r=Du.bind(e),t.addEventListener("load",r),t.addEventListener("error",r))}}var nh=0;function Px(e,t){return e.stylesheets&&e.count===0&&ju(e,e.stylesheets),0<e.count||0<e.imgCount?function(r){var o=setTimeout(function(){if(e.stylesheets&&ju(e,e.stylesheets),e.unsuspend){var y=e.unsuspend;e.unsuspend=null,y()}},6e4+t);0<e.imgBytes&&nh===0&&(nh=62500*wx());var h=setTimeout(function(){if(e.waitingForImages=!1,e.count===0&&(e.stylesheets&&ju(e,e.stylesheets),e.unsuspend)){var y=e.unsuspend;e.unsuspend=null,y()}},(e.imgBytes>nh?50:800)+t);return e.unsuspend=r,function(){e.unsuspend=null,clearTimeout(o),clearTimeout(h)}}:null}function Du(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)ju(this,this.stylesheets);else if(this.unsuspend){var e=this.unsuspend;this.unsuspend=null,e()}}}var Ou=null;function ju(e,t){e.stylesheets=null,e.unsuspend!==null&&(e.count++,Ou=new Map,t.forEach(qx,e),Ou=null,Du.call(e))}function qx(e,t){if(!(t.state.loading&4)){var r=Ou.get(e);if(r)var o=r.get(null);else{r=new Map,Ou.set(e,r);for(var h=e.querySelectorAll("link[data-precedence],style[data-precedence]"),y=0;y<h.length;y++){var O=h[y];(O.nodeName==="LINK"||O.getAttribute("media")!=="not all")&&(r.set(O.dataset.precedence,O),o=O)}o&&r.set(null,o)}h=t.instance,O=h.getAttribute("data-precedence"),y=r.get(O)||o,y===o&&r.set(null,h),r.set(O,h),this.count++,o=Du.bind(this),h.addEventListener("load",o),h.addEventListener("error",o),y?y.parentNode.insertBefore(h,y.nextSibling):(e=e.nodeType===9?e.head:e,e.insertBefore(h,e.firstChild)),t.state.loading|=4}}var nc={$$typeof:q,Provider:null,Consumer:null,_currentValue:De,_currentValue2:De,_threadCount:0};function Gx(e,t,r,o,h,y,O,V,pe){this.tag=1,this.containerInfo=e,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=zn(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=zn(0),this.hiddenUpdates=zn(null),this.identifierPrefix=o,this.onUncaughtError=h,this.onCaughtError=y,this.onRecoverableError=O,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=pe,this.incompleteTransitions=new Map}function ay(e,t,r,o,h,y,O,V,pe,ze,Qe,nt){return e=new Gx(e,t,r,O,pe,ze,Qe,nt,V),t=1,y===!0&&(t|=24),y=Oa(3,null,null,t),e.current=y,y.stateNode=e,t=Rd(),t.refCount++,e.pooledCache=t,t.refCount++,y.memoizedState={element:o,isDehydrated:r,cache:t},zd(y),e}function sy(e){return e?(e=Lo,e):Lo}function iy(e,t,r,o,h,y){h=sy(h),o.context===null?o.context=h:o.pendingContext=h,o=Ci(t),o.payload={element:r},y=y===void 0?null:y,y!==null&&(o.callback=y),r=Ni(e,o,t),r!==null&&(wa(r,e,t),Rl(r,e,t))}function oy(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var r=e.retryLane;e.retryLane=r!==0&&r<t?r:t}}function rh(e,t){oy(e,t),(e=e.alternate)&&oy(e,t)}function ly(e){if(e.tag===13||e.tag===31){var t=ar(e,67108864);t!==null&&wa(t,e,67108864),rh(e,67108864)}}function cy(e){if(e.tag===13||e.tag===31){var t=Ua();t=Vn(t);var r=ar(e,t);r!==null&&wa(r,e,t),rh(e,t)}}var Iu=!0;function Kx(e,t,r,o){var h=J.T;J.T=null;var y=Z.p;try{Z.p=2,ah(e,t,r,o)}finally{Z.p=y,J.T=h}}function Yx(e,t,r,o){var h=J.T;J.T=null;var y=Z.p;try{Z.p=8,ah(e,t,r,o)}finally{Z.p=y,J.T=h}}function ah(e,t,r,o){if(Iu){var h=sh(o);if(h===null)Gf(e,t,o,Ru,r),dy(e,o);else if(Vx(h,e,t,r,o))o.stopPropagation();else if(dy(e,o),t&4&&-1<$x.indexOf(e)){for(;h!==null;){var y=Rt(h);if(y!==null)switch(y.tag){case 3:if(y=y.stateNode,y.current.memoizedState.isDehydrated){var O=vr(y.pendingLanes);if(O!==0){var V=y;for(V.pendingLanes|=2,V.entangledLanes|=2;O;){var pe=1<<31-tn(O);V.entanglements[1]|=pe,O&=~pe}Ns(y),(On&6)===0&&(gu=at()+500,Ql(0))}}break;case 31:case 13:V=ar(y,2),V!==null&&wa(V,y,2),vu(),rh(y,2)}if(y=sh(o),y===null&&Gf(e,t,o,Ru,r),y===h)break;h=y}h!==null&&o.stopPropagation()}else Gf(e,t,o,null,r)}}function sh(e){return e=Gn(e),ih(e)}var Ru=null;function ih(e){if(Ru=null,e=ut(e),e!==null){var t=u(e);if(t===null)e=null;else{var r=t.tag;if(r===13){if(e=f(t),e!==null)return e;e=null}else if(r===31){if(e=p(t),e!==null)return e;e=null}else if(r===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null)}}return Ru=e,null}function uy(e){switch(e){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Ue()){case _t:return 2;case It:return 8;case Nt:case on:return 32;case Zt:return 268435456;default:return 32}default:return 32}}var oh=!1,Fi=null,Hi=null,Pi=null,rc=new Map,ac=new Map,qi=[],$x="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function dy(e,t){switch(e){case"focusin":case"focusout":Fi=null;break;case"dragenter":case"dragleave":Hi=null;break;case"mouseover":case"mouseout":Pi=null;break;case"pointerover":case"pointerout":rc.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":ac.delete(t.pointerId)}}function sc(e,t,r,o,h,y){return e===null||e.nativeEvent!==y?(e={blockedOn:t,domEventName:r,eventSystemFlags:o,nativeEvent:y,targetContainers:[h]},t!==null&&(t=Rt(t),t!==null&&ly(t)),e):(e.eventSystemFlags|=o,t=e.targetContainers,h!==null&&t.indexOf(h)===-1&&t.push(h),e)}function Vx(e,t,r,o,h){switch(t){case"focusin":return Fi=sc(Fi,e,t,r,o,h),!0;case"dragenter":return Hi=sc(Hi,e,t,r,o,h),!0;case"mouseover":return Pi=sc(Pi,e,t,r,o,h),!0;case"pointerover":var y=h.pointerId;return rc.set(y,sc(rc.get(y)||null,e,t,r,o,h)),!0;case"gotpointercapture":return y=h.pointerId,ac.set(y,sc(ac.get(y)||null,e,t,r,o,h)),!0}return!1}function fy(e){var t=ut(e.target);if(t!==null){var r=u(t);if(r!==null){if(t=r.tag,t===13){if(t=f(r),t!==null){e.blockedOn=t,Ms(e.priority,function(){cy(r)});return}}else if(t===31){if(t=p(r),t!==null){e.blockedOn=t,Ms(e.priority,function(){cy(r)});return}}else if(t===3&&r.stateNode.current.memoizedState.isDehydrated){e.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Mu(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var r=sh(e.nativeEvent);if(r===null){r=e.nativeEvent;var o=new r.constructor(r.type,r);Na=o,r.target.dispatchEvent(o),Na=null}else return t=Rt(r),t!==null&&ly(t),e.blockedOn=r,!1;t.shift()}return!0}function hy(e,t,r){Mu(e)&&r.delete(t)}function Zx(){oh=!1,Fi!==null&&Mu(Fi)&&(Fi=null),Hi!==null&&Mu(Hi)&&(Hi=null),Pi!==null&&Mu(Pi)&&(Pi=null),rc.forEach(hy),ac.forEach(hy)}function Uu(e,t){e.blockedOn===t&&(e.blockedOn=null,oh||(oh=!0,n.unstable_scheduleCallback(n.unstable_NormalPriority,Zx)))}var Lu=null;function py(e){Lu!==e&&(Lu=e,n.unstable_scheduleCallback(n.unstable_NormalPriority,function(){Lu===e&&(Lu=null);for(var t=0;t<e.length;t+=3){var r=e[t],o=e[t+1],h=e[t+2];if(typeof o!="function"){if(ih(o||r)===null)continue;break}var y=Rt(r);y!==null&&(e.splice(t,3),t-=3,af(y,{pending:!0,data:h,method:r.method,action:o},o,h))}}))}function ol(e){function t(pe){return Uu(pe,e)}Fi!==null&&Uu(Fi,e),Hi!==null&&Uu(Hi,e),Pi!==null&&Uu(Pi,e),rc.forEach(t),ac.forEach(t);for(var r=0;r<qi.length;r++){var o=qi[r];o.blockedOn===e&&(o.blockedOn=null)}for(;0<qi.length&&(r=qi[0],r.blockedOn===null);)fy(r),r.blockedOn===null&&qi.shift();if(r=(e.ownerDocument||e).$$reactFormReplay,r!=null)for(o=0;o<r.length;o+=3){var h=r[o],y=r[o+1],O=h[nn]||null;if(typeof y=="function")O||py(r);else if(O){var V=null;if(y&&y.hasAttribute("formAction")){if(h=y,O=y[nn]||null)V=O.formAction;else if(ih(h)!==null)continue}else V=O.action;typeof V=="function"?r[o+1]=V:(r.splice(o,3),o-=3),py(r)}}}function my(){function e(y){y.canIntercept&&y.info==="react-transition"&&y.intercept({handler:function(){return new Promise(function(O){return h=O})},focusReset:"manual",scroll:"manual"})}function t(){h!==null&&(h(),h=null),o||setTimeout(r,20)}function r(){if(!o&&!navigation.transition){var y=navigation.currentEntry;y&&y.url!=null&&navigation.navigate(y.url,{state:y.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var o=!1,h=null;return navigation.addEventListener("navigate",e),navigation.addEventListener("navigatesuccess",t),navigation.addEventListener("navigateerror",t),setTimeout(r,100),function(){o=!0,navigation.removeEventListener("navigate",e),navigation.removeEventListener("navigatesuccess",t),navigation.removeEventListener("navigateerror",t),h!==null&&(h(),h=null)}}}function lh(e){this._internalRoot=e}zu.prototype.render=lh.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(i(409));var r=t.current,o=Ua();iy(r,o,e,t,null,null)},zu.prototype.unmount=lh.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;iy(e.current,2,null,e,null,null),vu(),t[Br]=null}};function zu(e){this._internalRoot=e}zu.prototype.unstable_scheduleHydration=function(e){if(e){var t=zr();e={blockedOn:null,target:e,priority:t};for(var r=0;r<qi.length&&t!==0&&t<qi[r].priority;r++);qi.splice(r,0,e),r===0&&fy(e)}};var gy=a.version;if(gy!=="19.2.3")throw Error(i(527,gy,"19.2.3"));Z.findDOMNode=function(e){var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(i(188)):(e=Object.keys(e).join(","),Error(i(268,e)));return e=m(t),e=e!==null?_(e):null,e=e===null?null:e.stateNode,e};var Qx={bundleType:0,version:"19.2.3",rendererPackageName:"react-dom",currentDispatcherRef:J,reconcilerVersion:"19.2.3"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Bu=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Bu.isDisabled&&Bu.supportsFiber)try{zt=Bu.inject(Qx),Ht=Bu}catch{}}return oc.createRoot=function(e,t){if(!c(e))throw Error(i(299));var r=!1,o="",h=Sm,y=Em,O=km;return t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(o=t.identifierPrefix),t.onUncaughtError!==void 0&&(h=t.onUncaughtError),t.onCaughtError!==void 0&&(y=t.onCaughtError),t.onRecoverableError!==void 0&&(O=t.onRecoverableError)),t=ay(e,1,!1,null,null,r,o,null,h,y,O,my),e[Br]=t.current,qf(e),new lh(t)},oc.hydrateRoot=function(e,t,r){if(!c(e))throw Error(i(299));var o=!1,h="",y=Sm,O=Em,V=km,pe=null;return r!=null&&(r.unstable_strictMode===!0&&(o=!0),r.identifierPrefix!==void 0&&(h=r.identifierPrefix),r.onUncaughtError!==void 0&&(y=r.onUncaughtError),r.onCaughtError!==void 0&&(O=r.onCaughtError),r.onRecoverableError!==void 0&&(V=r.onRecoverableError),r.formState!==void 0&&(pe=r.formState)),t=ay(e,1,!0,t,r??null,o,h,pe,y,O,V,my),t.context=sy(null),r=t.current,o=Ua(),o=Vn(o),h=Ci(o),h.callback=null,Ni(r,h,o),r=o,t.current.lanes=r,Lr(t,r),Ns(t),e[Br]=t.current,qf(e),new zu(t)},oc.version="19.2.3",oc}var Ay;function o_(){if(Ay)return dh.exports;Ay=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(a){console.error(a)}}return n(),dh.exports=i_(),dh.exports}var l_=o_();const c_=Co(l_),u_={},Ty=n=>{let a;const s=new Set,i=(_,E)=>{const N=typeof _=="function"?_(a):_;if(!Object.is(N,a)){const S=a;a=E??(typeof N!="object"||N===null)?N:Object.assign({},a,N),s.forEach(I=>I(a,S))}},c=()=>a,b={setState:i,getState:c,getInitialState:()=>m,subscribe:_=>(s.add(_),()=>s.delete(_)),destroy:()=>{(u_?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),s.clear()}},m=a=n(i,c,b);return b},d_=n=>n?Ty(n):Ty;var mh={exports:{}},gh={},yh={exports:{}},vh={};/**
 * @license React
 * use-sync-external-store-shim.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Cy;function f_(){if(Cy)return vh;Cy=1;var n=Lc();function a(E,N){return E===N&&(E!==0||1/E===1/N)||E!==E&&N!==N}var s=typeof Object.is=="function"?Object.is:a,i=n.useState,c=n.useEffect,u=n.useLayoutEffect,f=n.useDebugValue;function p(E,N){var S=N(),I=i({inst:{value:S,getSnapshot:N}}),A=I[0].inst,k=I[1];return u(function(){A.value=S,A.getSnapshot=N,b(A)&&k({inst:A})},[E,S,N]),c(function(){return b(A)&&k({inst:A}),E(function(){b(A)&&k({inst:A})})},[E]),f(S),S}function b(E){var N=E.getSnapshot;E=E.value;try{var S=N();return!s(E,S)}catch{return!0}}function m(E,N){return N()}var _=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?m:p;return vh.useSyncExternalStore=n.useSyncExternalStore!==void 0?n.useSyncExternalStore:_,vh}var Ny;function h_(){return Ny||(Ny=1,yh.exports=f_()),yh.exports}/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Dy;function p_(){if(Dy)return gh;Dy=1;var n=Lc(),a=h_();function s(m,_){return m===_&&(m!==0||1/m===1/_)||m!==m&&_!==_}var i=typeof Object.is=="function"?Object.is:s,c=a.useSyncExternalStore,u=n.useRef,f=n.useEffect,p=n.useMemo,b=n.useDebugValue;return gh.useSyncExternalStoreWithSelector=function(m,_,E,N,S){var I=u(null);if(I.current===null){var A={hasValue:!1,value:null};I.current=A}else A=I.current;I=p(function(){function R(W){if(!P){if(P=!0,q=W,W=N(W),S!==void 0&&A.hasValue){var H=A.value;if(S(H,W))return G=H}return G=W}if(H=G,i(q,W))return H;var L=N(W);return S!==void 0&&S(H,L)?H:(q=W,G=L)}var P=!1,q,G,Y=E===void 0?null:E;return[function(){return R(_())},Y===null?void 0:function(){return R(Y())}]},[_,E,N,S]);var k=c(m,I[0],I[1]);return f(function(){A.hasValue=!0,A.value=k},[k]),b(k),k},gh}var Oy;function m_(){return Oy||(Oy=1,mh.exports=p_()),mh.exports}var g_=m_();const y_=Co(g_),vb={},{useDebugValue:v_}=Yi,{useSyncExternalStoreWithSelector:b_}=y_;let jy=!1;const x_=n=>n;function __(n,a=x_,s){(vb?"production":void 0)!=="production"&&s&&!jy&&(console.warn("[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"),jy=!0);const i=b_(n.subscribe,n.getState,n.getServerState||n.getInitialState,a,s);return v_(i),i}const w_=n=>{(vb?"production":void 0)!=="production"&&typeof n!="function"&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");const a=typeof n=="function"?d_(n):n,s=(i,c)=>__(a,i,c);return Object.assign(s,a),s},S_=n=>w_;var et=(n=>(n.Flashcard="flashcard",n.Quiz="quiz",n.Learning="learning",n))(et||{}),La=(n=>(n[n.Again=1]="Again",n[n.Hard=2]="Hard",n[n.Good=3]="Good",n[n.Easy=4]="Easy",n))(La||{}),xc=(n=>(n.CREATE_DECK="CREATE_DECK",n.RENAME_DECK="RENAME_DECK",n.DELETE_DECK="DELETE_DECK",n.MOVE_DECK_TO_FOLDER="MOVE_DECK_TO_FOLDER",n.CREATE_FOLDER="CREATE_FOLDER",n.RENAME_FOLDER="RENAME_FOLDER",n.DELETE_FOLDER="DELETE_FOLDER",n.EXPAND_SERIES_ADD_LEVELS="EXPAND_SERIES_ADD_LEVELS",n.EXPAND_SERIES_ADD_DECKS="EXPAND_SERIES_ADD_DECKS",n.GENERATE_QUESTIONS_FOR_DECK="GENERATE_QUESTIONS_FOR_DECK",n.UPGRADE_TO_LEARNING="UPGRADE_TO_LEARNING",n.REWORK_DECK="REWORK_DECK",n.NO_ACTION="NO_ACTION",n))(xc||{});function E_(n,a){var i,c;const s={...n,lastModified:Date.now()};switch(a.type){case"SET_LOADING":return{...n,isLoading:a.payload};case"SET_SERIES_PROGRESS":return{...n,seriesProgress:a.payload};case"SET_LEARNING_PROGRESS":return{...n,learningProgress:a.payload};case"UPDATE_LEARNING_PROGRESS":return{...n,learningProgress:{...n.learningProgress,[a.payload.deckId]:a.payload}};case"LOAD_DATA":{const u={};a.payload.decks.forEach(b=>u[b.id]=b);const f={};a.payload.folders.forEach(b=>f[b.id]=b);const p={};return a.payload.deckSeries.forEach(b=>p[b.id]=b),{...n,decks:u,folders:f,deckSeries:p,isLoading:!1,lastModified:null}}case"SET_AI_GENERATION_STATUS":return{...n,aiGenerationStatus:{...n.aiGenerationStatus,...a.payload}};case"ADD_AI_TASK_TO_QUEUE":{const u=Array.isArray(n.aiGenerationStatus.queue)?n.aiGenerationStatus.queue:[],f=u.findIndex(p=>p.id===a.payload.id);if(f!==-1){const p=[...u];return p[f]=a.payload,{...n,aiGenerationStatus:{...n.aiGenerationStatus,queue:p}}}return{...n,aiGenerationStatus:{...n.aiGenerationStatus,queue:[...u,a.payload]}}}case"START_NEXT_AI_TASK":{const f=(Array.isArray(n.aiGenerationStatus.queue)?n.aiGenerationStatus.queue:[]).slice(1),{task:p,abortController:b}=a.payload;return{...n,aiGenerationStatus:{...n.aiGenerationStatus,queue:f,currentTask:{...p,abortController:b},isGenerating:!0,chapterPhases:{}}}}case"UPDATE_CURRENT_AI_TASK_STATUS":{if(!n.aiGenerationStatus.currentTask)return n;const{statusText:u,deckId:f,seriesId:p,payload:b}=a.payload,m={...n.aiGenerationStatus.currentTask,statusText:u!==void 0?u:n.aiGenerationStatus.currentTask.statusText,deckId:f!==void 0?f:n.aiGenerationStatus.currentTask.deckId,seriesId:p!==void 0?p:n.aiGenerationStatus.currentTask.seriesId,payload:b!==void 0?b:n.aiGenerationStatus.currentTask.payload};return{...n,aiGenerationStatus:{...n.aiGenerationStatus,currentTask:m}}}case"UPDATE_STREAMING_DRAFT":{const{chapterId:u,text:f}=a.payload;return{...n,aiGenerationStatus:{...n.aiGenerationStatus,streamingDrafts:{...n.aiGenerationStatus.streamingDrafts,[u]:f}}}}case"UPDATE_CHAPTER_PHASE":{const{chapterId:u,phase:f}=a.payload;return{...n,aiGenerationStatus:{...n.aiGenerationStatus,chapterPhases:{...n.aiGenerationStatus.chapterPhases,[u]:f}}}}case"CLEAR_STREAMING_DRAFTS":return{...n,aiGenerationStatus:{...n.aiGenerationStatus,streamingDrafts:{},chapterPhases:{}}};case"FINISH_CURRENT_AI_TASK":return{...n,aiGenerationStatus:{...n.aiGenerationStatus,currentTask:null,isGenerating:!1}};case"CANCEL_AI_TASK":if((i=a.payload)!=null&&i.taskId){const u=Array.isArray(n.aiGenerationStatus.queue)?n.aiGenerationStatus.queue:[];return{...n,aiGenerationStatus:{...n.aiGenerationStatus,queue:u.filter(f=>f.id!==a.payload.taskId)}}}else return(c=n.aiGenerationStatus.currentTask)==null||c.abortController.abort(),{...n,aiGenerationStatus:{...n.aiGenerationStatus,currentTask:null,isGenerating:!1}};case"SET_AI_CHAT_HISTORY":return{...n,aiChatHistory:a.payload};case"ADD_DECKS":{const u={...n.decks};return a.payload.forEach(f=>u[f.id]=f),{...s,decks:u}}case"RESTORE_DATA":{const{decks:u,folders:f,deckSeries:p}=a.payload,b={};u.forEach(E=>b[E.id]=E);const m={};f.forEach(E=>m[E.id]=E);const _={};return p.forEach(E=>_[E.id]=E),{...s,decks:b,folders:m,deckSeries:_,isLoading:!1,lastModified:null}}case"DELETE_DECK":{const u={...n.decks};delete u[a.payload];const f={...n.deckSeries};return Object.keys(f).forEach(p=>{const b=f[p];b.levels&&(f[p]={...b,levels:b.levels.map(m=>({...m,deckIds:(m.deckIds||[]).filter(_=>_!==a.payload)}))})}),{...s,decks:u,deckSeries:f}}case"UPDATE_DECK":return{...s,decks:{...n.decks,[a.payload.id]:a.payload}};case"BULK_UPDATE_DECKS":{const u={...n.decks};return a.payload.forEach(f=>u[f.id]=f),{...s,decks:u}}case"ADD_FOLDER":return{...s,folders:{...n.folders,[a.payload.id]:a.payload}};case"ADD_FOLDERS":{const u={...n.folders};return a.payload.forEach(f=>u[f.id]=f),{...s,folders:u}}case"UPDATE_FOLDER":return{...s,folders:{...n.folders,[a.payload.id]:a.payload}};case"DELETE_FOLDER":{const u={...n.folders};delete u[a.payload];const f={...n.decks};return Object.values(f).forEach(p=>{p.folderId===a.payload&&(f[p.id]={...p,folderId:null})}),{...s,folders:u,decks:f}}case"ADD_SERIES":return{...s,deckSeries:{...n.deckSeries,[a.payload.id]:a.payload}};case"ADD_SERIES_WITH_DECKS":{const{series:u,decks:f}=a.payload,p={...n.decks};return f.forEach(b=>p[b.id]=b),{...s,decks:p,deckSeries:{...n.deckSeries,[u.id]:u}}}case"UPDATE_SERIES":return{...s,deckSeries:{...n.deckSeries,[a.payload.id]:a.payload}};case"DELETE_SERIES":{const u={...n.deckSeries};return delete u[a.payload],{...s,deckSeries:u}}default:return n}}const k_={decks:{},folders:{},deckSeries:{},seriesProgress:new Map,learningProgress:{},isLoading:!0,lastModified:null,aiGenerationStatus:{isGenerating:!1,statusText:null,generatingDeckId:null,generatingSeriesId:null,queue:[],currentTask:null,streamingDrafts:{},chapterPhases:{}},aiChatHistory:[]},kt=S_()(n=>({...k_,dispatch:a=>n(s=>E_(s,a))})),A_=n=>{const a=new Date;a.setHours(23,59,59,999);const s=(n.type===et.Quiz||n.type==="learning"?n.questions:n.cards)||[];return Array.isArray(s)?s.filter(i=>!i.suspended&&new Date(i.dueDate).getTime()<=a.getTime()).length:0},np=()=>kt(n=>Object.values(n.decks)),T_=()=>kt(n=>Object.values(n.folders)),rp=()=>kt(n=>Object.values(n.deckSeries)),C_=()=>kt(n=>Object.values(n.deckSeries).filter(a=>!a.archived&&!a.deletedAt)),N_=()=>kt(n=>{const a=new Set;return Object.values(n.deckSeries).forEach(s=>{(s.levels||[]).forEach(i=>((i==null?void 0:i.deckIds)||[]).forEach(c=>a.add(c)))}),Object.values(n.decks).filter(s=>!s.archived&&!s.deletedAt&&!a.has(s.id))}),D_=()=>kt(n=>{const a=new Set;return Object.values(n.deckSeries).forEach(s=>{var i;if(!s.archived&&!s.deletedAt){const c=((i=n.seriesProgress.get(s.id))==null?void 0:i.size)||0;let u=0;(s.levels||[]).filter(Boolean).forEach(f=>{(f.deckIds||[]).forEach(p=>{u<=c&&a.add(p),u++})})}}),Object.values(n.decks).reduce((s,i)=>{if(i.archived||i.deletedAt)return s;if(i.type===et.Learning){const u=n.learningProgress[i.id];if(u&&u.unlockedQuestionIds){const f=new Set(u.unlockedQuestionIds),b=(i.questions||[]).filter(m=>f.has(m.id)&&!m.suspended&&new Date(m.dueDate).getTime()<=new Date().setHours(23,59,59,999)).length;return s+b}}return(i.type===et.Quiz||i.type===et.Learning)&&Object.values(n.deckSeries).some(u=>(u.levels||[]).some(f=>{var p;return(p=f.deckIds)==null?void 0:p.includes(i.id)}))&&!a.has(i.id)?s:s+A_(i)},0)}),bb=$.createContext(null),_l=()=>{const n=$.useContext(bb);if(!n)throw new Error("useData must be used within a DataManagementProvider");return n},O_=({children:n,value:a})=>l.jsx(bb.Provider,{value:a,children:n}),j_="modulepreload",I_=function(n){return"/CogniFlow/"+n},Iy={},Ha=function(a,s,i){let c=Promise.resolve();if(s&&s.length>0){let f=function(m){return Promise.all(m.map(_=>Promise.resolve(_).then(E=>({status:"fulfilled",value:E}),E=>({status:"rejected",reason:E}))))};document.getElementsByTagName("link");const p=document.querySelector("meta[property=csp-nonce]"),b=(p==null?void 0:p.nonce)||(p==null?void 0:p.getAttribute("nonce"));c=f(s.map(m=>{if(m=I_(m),m in Iy)return;Iy[m]=!0;const _=m.endsWith(".css"),E=_?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${m}"]${E}`))return;const N=document.createElement("link");if(N.rel=_?"stylesheet":j_,_||(N.as="script"),N.crossOrigin="",N.href=m,b&&N.setAttribute("nonce",b),document.head.appendChild(N),_)return new Promise((S,I)=>{N.addEventListener("load",S),N.addEventListener("error",()=>I(new Error(`Unable to preload CSS for ${m}`)))})}))}function u(f){const p=new Event("vite:preloadError",{cancelable:!0});if(p.payload=f,window.dispatchEvent(p),!p.defaultPrevented)throw f}return c.then(f=>{for(const p of f||[])p.status==="rejected"&&u(p.reason);return a().catch(u)})},xb=$.createContext(void 0),bh=()=>window.location.hash.startsWith("#/")?window.location.hash.substring(1):"/",R_=({children:n})=>{const[a,s]=$.useState(bh()),i=$.useRef([bh()]),[c,u]=$.useState(1),f=$.useCallback(()=>{const _=bh();s(_);const E=i.current,N=E[E.length-1],S=E[E.length-2];let I=E;_===S?I=E.slice(0,-1):_!==N&&(I=[...E,_]),i.current=I,u(I.length)},[]);$.useEffect(()=>(window.addEventListener("hashchange",f),()=>{window.removeEventListener("hashchange",f)}),[f]);const p=$.useCallback((_,E)=>{const N=`#${_}`;if(E!=null&&E.replace){const S=i.current;if(S.length>0){const I=new URL(window.location.href);I.hash=N,window.location.replace(I.toString());const A=[...S];A[A.length-1]=_,i.current=A;return}}window.location.hash=N},[]),b=$.useCallback(()=>{const _=i.current;if(_.length>1){const E=_[_.length-2];window.location.hash=`#${E}`}else p("/")},[p]),m={path:a,navigate:p,goBack:b,canGoBack:c>1};return l.jsx(xb.Provider,{value:m,children:n})},si=()=>{const n=$.useContext(xb);if(n===void 0)throw new Error("useRouter must be used within a RouterProvider");return n},_b=$.createContext(void 0),Ds=(n,a)=>{if(typeof window>"u")return a;try{const s=window.localStorage.getItem(n);return s?JSON.parse(s):a}catch(s){return console.error(`Error reading ${n} from localStorage`,s),a}},M_=()=>{if(typeof window>"u")return!1;try{const n=window.localStorage.getItem("cogniflow-aiFeaturesEnabled");return n!==null?JSON.parse(n)===!0:!!(window.location.origin.endsWith("aistudio.google.com")||window.location.origin.endsWith("scf.usercontent.goog"))}catch(n){return console.error("Error reading cogniflow-aiFeaturesEnabled from localStorage",n),!1}},U_=({children:n})=>{const[a,s]=$.useState(()=>Ds("cogniflow-disableAnimations",!1)),[i,c]=$.useState(()=>Ds("cogniflow-hapticsEnabled",!0)),[u,f]=$.useState(M_),[p,b]=$.useState(()=>Ds("cogniflow-veoEnabled",!1)),[m,_]=$.useState(()=>Ds("cogniflow-groundedImagesEnabled",!1)),[E,N]=$.useState(()=>Ds("cogniflow-searchAuditsEnabled",!1)),[S,I]=$.useState(()=>Ds("cogniflow-backupEnabled",!0)),[A,k]=$.useState(()=>{try{return window.localStorage.getItem("cogniflow-backupApiKey")||"qRt+gU/57GHKhxTZeRnRi+dfT274iSkKKq2UnTr9Bxs="}catch{return"qRt+gU/57GHKhxTZeRnRi+dfT274iSkKKq2UnTr9Bxs="}}),[R,P]=$.useState(()=>{try{return window.localStorage.getItem("cogniflow-encryptionPassword")||""}catch{return""}}),[q,G]=$.useState(()=>Ds("cogniflow-syncOnCellular",!0)),[Y,W]=$.useState(()=>{try{return window.localStorage.getItem("cogniflow-fontFamily")||"sans"}catch{return"sans"}}),[H,L]=$.useState(()=>Ds("cogniflow-notificationsEnabled",!1)),[U,Q]=$.useState(()=>Ds("cogniflow-leechThreshold",8)),[le,F]=$.useState(()=>Ds("cogniflow-leechAction","suspend")),te=$.useCallback(ye=>{s(ye);try{window.localStorage.setItem("cogniflow-disableAnimations",JSON.stringify(ye))}catch(ie){console.error("Error writing animation setting to localStorage",ie)}},[]),j=$.useCallback(ye=>{c(ye);try{window.localStorage.setItem("cogniflow-hapticsEnabled",JSON.stringify(ye))}catch(ie){console.error("Error writing haptics setting to localStorage",ie)}},[]),he=$.useCallback(ye=>{f(ye);try{window.localStorage.setItem("cogniflow-aiFeaturesEnabled",JSON.stringify(ye))}catch(ie){console.error("Error writing AI features setting to localStorage",ie)}},[]),J=$.useCallback(ye=>{b(ye);try{window.localStorage.setItem("cogniflow-veoEnabled",JSON.stringify(ye))}catch(ie){console.error("Error writing veo setting to localStorage",ie)}},[]),Z=$.useCallback(ye=>{_(ye);try{window.localStorage.setItem("cogniflow-groundedImagesEnabled",JSON.stringify(ye))}catch(ie){console.error("Error writing groundedImages setting to localStorage",ie)}},[]),De=$.useCallback(ye=>{N(ye);try{window.localStorage.setItem("cogniflow-searchAuditsEnabled",JSON.stringify(ye))}catch(ie){console.error("Error writing searchAudits setting to localStorage",ie)}},[]),ve=$.useCallback(ye=>{I(ye);try{window.localStorage.setItem("cogniflow-backupEnabled",JSON.stringify(ye))}catch(ie){console.error("Error writing backup enabled setting to localStorage",ie)}},[]),Be=$.useCallback(ye=>{k(ye);try{window.localStorage.setItem("cogniflow-backupApiKey",ye)}catch(ie){console.error("Error writing backup API key to localStorage",ie)}},[]),T=$.useCallback(ye=>{P(ye);try{ye?window.localStorage.setItem("cogniflow-encryptionPassword",ye):window.localStorage.removeItem("cogniflow-encryptionPassword")}catch(ie){console.error("Error writing encryption password to localStorage",ie)}},[]),z=$.useCallback(ye=>{G(ye);try{window.localStorage.setItem("cogniflow-syncOnCellular",JSON.stringify(ye))}catch(ie){console.error("Error writing syncOnCellular setting to localStorage",ie)}},[]),ne=$.useCallback(ye=>{W(ye);try{window.localStorage.setItem("cogniflow-fontFamily",ye)}catch(ie){console.error("Error writing fontFamily setting to localStorage",ie)}},[]),se=$.useCallback(ye=>{L(ye);try{window.localStorage.setItem("cogniflow-notificationsEnabled",JSON.stringify(ye)),ye&&"Notification"in window&&Notification.permission!=="granted"&&Notification.requestPermission().then(ie=>{ie!=="granted"&&(L(!1),window.localStorage.setItem("cogniflow-notificationsEnabled",JSON.stringify(!1)))})}catch(ie){console.error("Error writing notifications setting to localStorage",ie)}},[]),ue=$.useCallback(ye=>{Q(ye);try{window.localStorage.setItem("cogniflow-leechThreshold",JSON.stringify(ye))}catch(ie){console.error("Error writing leechThreshold to localStorage",ie)}},[]),de=$.useCallback(ye=>{F(ye);try{window.localStorage.setItem("cogniflow-leechAction",JSON.stringify(ye))}catch(ie){console.error("Error writing leechAction to localStorage",ie)}},[]),oe={disableAnimations:a,setDisableAnimations:te,hapticsEnabled:i,setHapticsEnabled:j,aiFeaturesEnabled:u,setAiFeaturesEnabled:he,veoEnabled:p,setVeoEnabled:J,groundedImagesEnabled:m,setGroundedImagesEnabled:Z,searchAuditsEnabled:E,setSearchAuditsEnabled:De,backupEnabled:S,setBackupEnabled:ve,backupApiKey:A,setBackupApiKey:Be,encryptionPassword:R,setEncryptionPassword:T,syncOnCellular:q,setSyncOnCellular:z,fontFamily:Y,setFontFamily:ne,notificationsEnabled:H,setNotificationsEnabled:se,leechThreshold:U,setLeechThreshold:ue,leechAction:le,setLeechAction:de};return l.jsx(_b.Provider,{value:oe,children:n})},Xi=()=>{const n=$.useContext(_b);if(n===void 0)throw new Error("useSettings must be used within a SettingsProvider");return n},ds=({href:n,children:a,passAs:s,...i})=>{const{navigate:c}=si(),u=p=>{p.currentTarget.tagName==="A"&&(p.metaKey||p.ctrlKey)||(p.preventDefault(),i.onClick&&i.onClick(p),c(n))},f=`#${n}`;return s?l.jsx(s,{...i,onClick:u,children:a}):l.jsx("a",{...i,href:f,onClick:u,children:a})},zh={plus:l.jsxs(l.Fragment,{children:[l.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),l.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]}),"upload-cloud":l.jsxs(l.Fragment,{children:[l.jsx("path",{d:"M20 16.58A5 5 0 0 0 18 7h-1.26A8 8 0 1 0 4 15.25"}),l.jsx("polyline",{points:"16 16 12 12 8 16"}),l.jsx("line",{x1:"12",y1:"12",x2:"12",y2:"21"})]}),x:l.jsxs(l.Fragment,{children:[l.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),l.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]}),"chevron-left":l.jsx(l.Fragment,{children:l.jsx("polyline",{points:"15 18 9 12 15 6"})}),"trash-2":l.jsxs(l.Fragment,{children:[l.jsx("polyline",{points:"3 6 5 6 21 6"}),l.jsx("path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"}),l.jsx("line",{x1:"10",y1:"11",x2:"10",y2:"17"}),l.jsx("line",{x1:"14",y1:"11",x2:"14",y2:"17"})]}),"check-circle":l.jsxs(l.Fragment,{children:[l.jsx("path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14"}),l.jsx("polyline",{points:"22 4 12 14.01 9 11.01"})]}),"x-circle":l.jsxs(l.Fragment,{children:[l.jsx("circle",{cx:"12",cy:"12",r:"10"}),l.jsx("line",{x1:"15",y1:"9",x2:"9",y2:"15"}),l.jsx("line",{x1:"9",y1:"9",x2:"15",y2:"15"})]}),download:l.jsxs(l.Fragment,{children:[l.jsx("path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"}),l.jsx("polyline",{points:"7 10 12 15 17 10"}),l.jsx("line",{x1:"12",y1:"15",x2:"12",y2:"3"})]}),laptop:l.jsxs(l.Fragment,{children:[l.jsx("path",{d:"M20 16V7a2 2 0 0 0-2-2H6a2 2 0 0 0-2 2v9h16z"}),l.jsx("rect",{x:"2",y:"17",width:"20",height:"4",rx:"1"})]}),menu:l.jsxs(l.Fragment,{children:[l.jsx("line",{x1:"3",y1:"12",x2:"21",y2:"12"}),l.jsx("line",{x1:"3",y1:"6",x2:"21",y2:"6"}),l.jsx("line",{x1:"3",y1:"18",x2:"21",y2:"18"})]}),edit:l.jsxs(l.Fragment,{children:[l.jsx("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"}),l.jsx("path",{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"})]}),save:l.jsxs(l.Fragment,{children:[l.jsx("path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"}),l.jsx("polyline",{points:"17 21 17 13 7 13 7 21"}),l.jsx("polyline",{points:"7 3 7 8 15 8"})]}),sun:l.jsxs(l.Fragment,{children:[l.jsx("circle",{cx:"12",cy:"12",r:"5"}),l.jsx("line",{x1:"12",y1:"1",x2:"12",y2:"3"}),l.jsx("line",{x1:"12",y1:"21",x2:"12",y2:"23"}),l.jsx("line",{x1:"4.22",y1:"4.22",x2:"5.64",y2:"5.64"}),l.jsx("line",{x1:"18.36",y1:"18.36",x2:"19.78",y2:"19.78"}),l.jsx("line",{x1:"1",y1:"12",x2:"3",y2:"12"}),l.jsx("line",{x1:"21",y1:"12",x2:"23",y2:"12"}),l.jsx("line",{x1:"4.22",y1:"19.78",x2:"5.64",y2:"18.36"}),l.jsx("line",{x1:"18.36",y1:"5.64",x2:"19.78",y2:"4.22"})]}),moon:l.jsx(l.Fragment,{children:l.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})}),code:l.jsxs(l.Fragment,{children:[l.jsx("polyline",{points:"16 18 22 12 16 6"}),l.jsx("polyline",{points:"8 6 2 12 8 18"})]}),"refresh-ccw":l.jsxs(l.Fragment,{children:[l.jsx("polyline",{points:"1 4 1 10 7 10"}),l.jsx("polyline",{points:"23 20 23 14 17 14"}),l.jsx("path",{d:"M20.49 9A9 9 0 0 0 7.2 6.51"}),l.jsx("path",{d:"M3.51 15A9 9 0 0 0 16.8 17.49"})]}),broom:l.jsx(l.Fragment,{children:l.jsx("path",{d:"M9.59 4.59A2 2 0 1 1 11 8H2m10.59 11.41A2 2 0 1 0 14 16H2m15.73-8.27A2.5 2.5 0 1 1 19.5 12H2"})}),settings:l.jsxs(l.Fragment,{children:[l.jsx("circle",{cx:"12",cy:"12",r:"3"}),l.jsx("path",{d:"M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"})]}),info:l.jsxs(l.Fragment,{children:[l.jsx("circle",{cx:"12",cy:"12",r:"10"}),l.jsx("line",{x1:"12",y1:"16",x2:"12",y2:"12"}),l.jsx("line",{x1:"12",y1:"8",x2:"12.01",y2:"8"})]}),"chevron-down":l.jsx(l.Fragment,{children:l.jsx("polyline",{points:"6 9 12 15 18 9"})}),eye:l.jsxs(l.Fragment,{children:[l.jsx("path",{d:"M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"}),l.jsx("circle",{cx:"12",cy:"12",r:"3"})]}),"eye-off":l.jsxs(l.Fragment,{children:[l.jsx("path",{d:"M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24"}),l.jsx("line",{x1:"1",y1:"1",x2:"23",y2:"23"})]}),zap:l.jsx(l.Fragment,{children:l.jsx("polygon",{points:"13 2 3 14 12 14 11 22 21 10 12 10 13 2"})}),"help-circle":l.jsxs(l.Fragment,{children:[l.jsx("circle",{cx:"12",cy:"12",r:"10"}),l.jsx("path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"}),l.jsx("line",{x1:"12",y1:"17",x2:"12.01",y2:"17"})]}),google:l.jsxs(l.Fragment,{children:[l.jsx("path",{d:"M17.64 9.2c0-.63-.06-1.25-.16-1.84H9v3.48h4.84c-.2 1.12-.84 2.08-1.74 2.71v2.26h2.92c1.7-1.56 2.68-3.88 2.68-6.61z"}),l.jsx("path",{d:"M9 18c2.43 0 4.47-.8 5.96-2.18l-2.92-2.26c-.8.54-1.82.86-3.04.86-2.34 0-4.32-1.58-5.04-3.7H1v2.34C2.64 16.32 5.57 18 9 18z"}),l.jsx("path",{d:"M3.96 10.71c-.18-.54-.28-1.12-.28-1.71s.1-1.17.28-1.71V4.96H1c-.64 1.28-1 2.74-1 4.34s.36 3.06 1 4.34l2.96-2.34z"}),l.jsx("path",{d:"M9 3.6c1.32 0 2.52.45 3.44 1.34l2.6-2.6C13.46.8 11.43 0 9 0 5.57 0 2.64 1.68 1 4.34l2.96 2.34C4.68 4.54 6.66 3.6 9 3.6z"})]}),folder:l.jsx(l.Fragment,{children:l.jsx("path",{d:"M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"})}),"folder-plus":l.jsxs(l.Fragment,{children:[l.jsx("path",{d:"M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"}),l.jsx("line",{x1:"12",y1:"11",x2:"12",y2:"17"}),l.jsx("line",{x1:"9",y1:"14",x2:"15",y2:"14"})]}),"folder-edit":l.jsxs(l.Fragment,{children:[l.jsx("path",{d:"M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"}),l.jsx("path",{d:"M14 13.5l2 2-4 4-2-2 4-4zm-1.5 2.5l2-2"})]}),list:l.jsxs(l.Fragment,{children:[l.jsx("line",{x1:"8",y1:"6",x2:"21",y2:"6"}),l.jsx("line",{x1:"8",y1:"12",x2:"21",y2:"12"}),l.jsx("line",{x1:"8",y1:"18",x2:"21",y2:"18"}),l.jsx("line",{x1:"3",y1:"6",x2:"3.01",y2:"6"}),l.jsx("line",{x1:"3",y1:"12",x2:"3.01",y2:"12"}),l.jsx("line",{x1:"3",y1:"18",x2:"3.01",y2:"18"})]}),lock:l.jsxs(l.Fragment,{children:[l.jsx("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"}),l.jsx("path",{d:"M7 11V7a5 5 0 0 1 10 0v4"})]}),unlock:l.jsxs(l.Fragment,{children:[l.jsx("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"}),l.jsx("path",{d:"M7 11V7a5 5 0 0 1 9.9-1"})]}),archive:l.jsxs(l.Fragment,{children:[l.jsx("polyline",{points:"21 8 21 21 3 21 3 8"}),l.jsx("rect",{x:"1",y:"3",width:"22",height:"5"}),l.jsx("line",{x1:"10",y1:"12",x2:"14",y2:"12"})]}),unarchive:l.jsxs(l.Fragment,{children:[l.jsx("polyline",{points:"21 8 21 21 3 21 3 8"}),l.jsx("rect",{x:"1",y:"3",width:"22",height:"5"}),l.jsx("polyline",{points:"10 13 12 11 14 13"}),l.jsx("line",{x1:"12",y1:"11",x2:"12",y2:"17"})]}),"arrow-down":l.jsxs(l.Fragment,{children:[l.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),l.jsx("polyline",{points:"19 12 12 19 5 12"})]}),monitor:l.jsxs(l.Fragment,{children:[l.jsx("rect",{x:"2",y:"3",width:"20",height:"14",rx:"2",ry:"2"}),l.jsx("line",{x1:"8",y1:"21",x2:"16",y2:"21"}),l.jsx("line",{x1:"12",y1:"17",x2:"12",y2:"21"})]}),"more-vertical":l.jsxs(l.Fragment,{children:[l.jsx("circle",{cx:"12",cy:"12",r:"1"}),l.jsx("circle",{cx:"12",cy:"5",r:"1"}),l.jsx("circle",{cx:"12",cy:"19",r:"1"})]}),search:l.jsxs(l.Fragment,{children:[l.jsx("circle",{cx:"11",cy:"11",r:"8"}),l.jsx("line",{x1:"21",y1:"21",x2:"16.65",y2:"16.65"})]}),filter:l.jsx(l.Fragment,{children:l.jsx("polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3"})}),layers:l.jsxs(l.Fragment,{children:[l.jsx("polygon",{points:"12 2 2 7 12 12 22 7 12 2"}),l.jsx("polyline",{points:"2 17 12 22 22 17"}),l.jsx("polyline",{points:"2 12 12 17 22 12"})]}),terminal:l.jsxs(l.Fragment,{children:[l.jsx("polyline",{points:"4 17 10 11 4 5"}),l.jsx("line",{x1:"12",y1:"19",x2:"20",y2:"19"})]}),"trending-up":l.jsxs(l.Fragment,{children:[l.jsx("polyline",{points:"23 6 13.5 15.5 8.5 10.5 1 18"}),l.jsx("polyline",{points:"17 6 23 6 23 12"})]}),"grip-vertical":l.jsxs(l.Fragment,{children:[l.jsx("circle",{cx:"9",cy:"12",r:"1"}),l.jsx("circle",{cx:"9",cy:"5",r:"1"}),l.jsx("circle",{cx:"9",cy:"19",r:"1"}),l.jsx("circle",{cx:"15",cy:"12",r:"1"}),l.jsx("circle",{cx:"15",cy:"5",r:"1"}),l.jsx("circle",{cx:"15",cy:"19",r:"1"})]}),repeat:l.jsxs(l.Fragment,{children:[l.jsx("polyline",{points:"17 1 21 5 17 9"}),l.jsx("path",{d:"M3 11V9a4 4 0 0 1 4-4h14"}),l.jsx("polyline",{points:"7 23 3 19 7 15"}),l.jsx("path",{d:"M21 13v2a4 4 0 0 1-4 4H3"})]}),bot:l.jsxs(l.Fragment,{children:[l.jsx("rect",{x:"5",y:"10",width:"14",height:"10",rx:"2"}),l.jsx("circle",{cx:"8.5",cy:"15",r:"1"}),l.jsx("circle",{cx:"15.5",cy:"15",r:"1"}),l.jsx("path",{d:"M9 10V4m6 6V4"}),l.jsx("line",{x1:"9",y1:"4",x2:"15",y2:"4"})]}),"book-open":l.jsxs(l.Fragment,{children:[l.jsx("path",{d:"M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z"}),l.jsx("path",{d:"M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z"})]}),"wifi-off":l.jsxs(l.Fragment,{children:[l.jsx("line",{x1:"1",y1:"1",x2:"23",y2:"23"}),l.jsx("path",{d:"M16.72 11.06A10.94 10.94 0 0 1 19 12.55"}),l.jsx("path",{d:"M5 12.55a10.94 10.94 0 0 1 5.17-2.39"}),l.jsx("path",{d:"M10.71 5.05A16 16 0 0 1 22.58 9"}),l.jsx("path",{d:"M1.42 9a15.91 15.91 0 0 1 4.7-2.88"}),l.jsx("path",{d:"M8.53 16.11a6 6 0 0 1 6.95 0"}),l.jsx("line",{x1:"12",y1:"20",x2:"12.01",y2:"20"})]}),link:l.jsxs(l.Fragment,{children:[l.jsx("path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.72"}),l.jsx("path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.72-1.72"})]}),"file-text":l.jsxs(l.Fragment,{children:[l.jsx("path",{d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"}),l.jsx("polyline",{points:"14 2 14 8 20 8"}),l.jsx("line",{x1:"16",y1:"13",x2:"8",y2:"13"}),l.jsx("line",{x1:"16",y1:"17",x2:"8",y2:"17"}),l.jsx("polyline",{points:"10 9 9 9 8 9"})]}),"volume-2":l.jsxs(l.Fragment,{children:[l.jsx("polygon",{points:"11 5 6 9 2 9 2 15 6 15 11 19 11 5"}),l.jsx("path",{d:"M19.07 4.93a10 10 0 0 1 0 14.14M15.54 8.46a5 5 0 0 1 0 7.07"})]}),mic:l.jsxs(l.Fragment,{children:[l.jsx("path",{d:"M12 1a3 3 0 0 0-3 3v8a3 3 0 0 0 6 0V4a3 3 0 0 0-3-3z"}),l.jsx("path",{d:"M19 10v2a7 7 0 0 1-14 0v-2"}),l.jsx("line",{x1:"12",y1:"19",x2:"12",y2:"23"}),l.jsx("line",{x1:"8",y1:"23",x2:"16",y2:"23"})]}),keyboard:l.jsxs(l.Fragment,{children:[l.jsx("rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",ry:"2"}),l.jsx("line",{x1:"6",y1:"12",x2:"6",y2:"12"}),l.jsx("line",{x1:"10",y1:"12",x2:"10",y2:"12"}),l.jsx("line",{x1:"14",y1:"12",x2:"14",y2:"12"}),l.jsx("line",{x1:"18",y1:"12",x2:"18",y2:"12"}),l.jsx("line",{x1:"6",y1:"16",x2:"6",y2:"16"}),l.jsx("line",{x1:"10",y1:"16",x2:"10",y2:"16"}),l.jsx("line",{x1:"14",y1:"16",x2:"14",y2:"16"}),l.jsx("line",{x1:"18",y1:"16",x2:"18",y2:"16"}),l.jsx("line",{x1:"6",y1:"8",x2:"6",y2:"8"}),l.jsx("line",{x1:"10",y1:"8",x2:"10",y2:"8"}),l.jsx("line",{x1:"14",y1:"8",x2:"14",y2:"8"}),l.jsx("line",{x1:"18",y1:"8",x2:"18",y2:"8"})]}),type:l.jsxs(l.Fragment,{children:[l.jsx("polyline",{points:"4 7 4 4 20 4 20 7"}),l.jsx("line",{x1:"9",y1:"20",x2:"15",y2:"20"}),l.jsx("line",{x1:"12",y1:"4",x2:"12",y2:"20"})]}),maximize:l.jsx(l.Fragment,{children:l.jsx("path",{d:"M8 3H5a2 2 0 0 0-2 2v3m18 0V5a2 2 0 0 0-2-2h-3m0 18h3a2 2 0 0 0 2-2v-3M3 16v3a2 2 0 0 0 2 2h3"})}),minimize:l.jsx(l.Fragment,{children:l.jsx("path",{d:"M8 3v3a2 2 0 0 1-2 2H3m18 0h-3a2 2 0 0 1-2-2V3m0 18v-3a2 2 0 0 1 2-2h3M3 16h3a2 2 0 0 1 2 2v3"})}),calendar:l.jsxs(l.Fragment,{children:[l.jsx("rect",{x:"3",y:"4",width:"18",height:"18",rx:"2",ry:"2"}),l.jsx("line",{x1:"16",y1:"2",x2:"16",y2:"6"}),l.jsx("line",{x1:"8",y1:"2",x2:"8",y2:"6"}),l.jsx("line",{x1:"3",y1:"10",x2:"21",y2:"10"})]}),printer:l.jsxs(l.Fragment,{children:[l.jsx("polyline",{points:"6 9 6 2 18 2 18 9"}),l.jsx("path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2"}),l.jsx("rect",{x:"6",y:"14",width:"12",height:"8"})]}),columns:l.jsx(l.Fragment,{children:l.jsx("path",{d:"M12 3h7a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-7m0-18H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h7m0-18v18"})})},P2=Object.keys(zh),rt=({name:n,className:a="w-6 h-6",...s})=>l.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:`${a} pointer-events-none`,...s,children:zh[n]||zh["help-circle"]}),Ry=(n,a)=>{if(!n)return"";const s=String(n);return s.length>a?s.substring(0,a)+"...":s},L_=({items:n})=>{if(!n||n.length<=1)return null;const a=s=>l.jsxs(l.Fragment,{children:[l.jsx("span",{className:"sm:hidden",title:s,children:Ry(s,8)}),l.jsx("span",{className:"hidden sm:inline",title:s,children:Ry(s,25)})]});return l.jsx("nav",{"aria-label":"Breadcrumb",className:"mb-4 sm:mb-6",children:l.jsx("ol",{className:"flex items-center space-x-1 sm:space-x-2 text-xs sm:text-sm text-text-muted flex-wrap",children:n.map((s,i)=>{const c=i===n.length-1;return l.jsxs("li",{className:"flex items-center",children:[i>0&&l.jsx(rt,{name:"chevron-left",className:"w-3 h-3 sm:w-4 sm:h-4 rotate-180 mx-1 sm:mx-2 flex-shrink-0"}),c?l.jsx("span",{className:"font-semibold text-text","aria-current":"page",children:a(s.label)}):l.jsx(ds,{href:s.href,className:"hover:underline hover:text-primary whitespace-nowrap",children:a(s.label)})]},i)})})})},z_=({children:n})=>l.jsx("div",{className:"animate-fade-in-up",children:n}),tr=({className:n="",variant:a="text",width:s,height:i})=>{const c="animate-pulse bg-gray-200 dark:bg-gray-700/50",u={text:"rounded h-4 w-full",circular:"rounded-full",rectangular:"rounded-md"},f={};return s&&(f.width=s),i&&(f.height=i),l.jsx("div",{className:`${c} ${u[a]} ${n}`,style:f,"aria-hidden":"true"})},My=()=>l.jsxs("div",{className:"min-h-screen bg-background",children:[l.jsx("div",{className:"bg-surface/80 border-b border-border h-16 fixed top-0 left-0 right-0 z-20",children:l.jsxs("div",{className:"container mx-auto px-4 h-full flex items-center justify-between",children:[l.jsx(tr,{width:120,height:24}),l.jsxs("div",{className:"flex gap-2",children:[l.jsx(tr,{variant:"circular",width:32,height:32}),l.jsx(tr,{variant:"circular",width:32,height:32})]})]})}),l.jsxs("main",{className:"container mx-auto px-4 pt-24 pb-20",children:[l.jsxs("div",{className:"mb-8 flex flex-wrap gap-4",children:[l.jsx(tr,{variant:"rectangular",width:200,height:48,className:"rounded-lg"}),l.jsx(tr,{variant:"rectangular",width:160,height:48,className:"rounded-lg"})]}),l.jsxs("div",{className:"mb-8",children:[l.jsxs("div",{className:"flex justify-between mb-4",children:[l.jsx(tr,{width:150,height:32}),l.jsx(tr,{width:80,height:32})]}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[l.jsxs("div",{className:"bg-surface rounded-lg shadow-md p-4 border border-transparent h-48 flex flex-col justify-between",children:[l.jsxs("div",{className:"flex gap-4",children:[l.jsx(tr,{variant:"rectangular",width:40,height:40}),l.jsxs("div",{className:"flex-1 space-y-2",children:[l.jsx(tr,{width:"70%",height:24}),l.jsx(tr,{width:"90%",height:16}),l.jsx(tr,{width:"60%",height:16})]})]}),l.jsxs("div",{className:"space-y-2 mt-4",children:[l.jsx(tr,{variant:"rectangular",height:8,className:"rounded-full"}),l.jsx(tr,{variant:"rectangular",height:8,className:"rounded-full"})]})]}),l.jsxs("div",{className:"bg-surface rounded-lg shadow-md p-4 border border-transparent h-48 flex flex-col justify-between",children:[l.jsxs("div",{className:"flex gap-4",children:[l.jsx(tr,{variant:"rectangular",width:40,height:40}),l.jsxs("div",{className:"flex-1 space-y-2",children:[l.jsx(tr,{width:"60%",height:24}),l.jsx(tr,{width:"80%",height:16})]})]}),l.jsxs("div",{className:"space-y-2 mt-4",children:[l.jsx(tr,{variant:"rectangular",height:8,className:"rounded-full"}),l.jsx(tr,{variant:"rectangular",height:8,className:"rounded-full"})]})]})]})]}),l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{className:"flex justify-between mb-4",children:[l.jsx(tr,{width:150,height:32}),l.jsx(tr,{width:80,height:32})]}),[1,2,3].map(n=>l.jsxs("div",{className:"bg-surface rounded-lg shadow-md p-4 flex justify-between items-center h-24",children:[l.jsxs("div",{className:"flex gap-4 items-center flex-1",children:[l.jsx(tr,{variant:"circular",width:24,height:24}),l.jsxs("div",{className:"space-y-2 flex-1 max-w-md",children:[l.jsx(tr,{width:"50%",height:20}),l.jsx(tr,{width:"80%",height:14})]})]}),l.jsx(tr,{variant:"rectangular",width:80,height:32,className:"rounded-md"})]},n))]})]})]}),pt=({children:n,variant:a="primary",size:s="md",className:i="",...c})=>{const u="inline-flex items-center justify-center rounded-md font-medium transition-colors focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-background disabled:opacity-50 disabled:pointer-events-none",f={primary:"bg-primary text-on-primary hover:bg-primary-hover focus:ring-primary",secondary:"bg-surface text-text border border-border hover:bg-border/20 focus:ring-primary",danger:"bg-red-600 text-white hover:bg-red-700 focus:ring-red-500",ghost:"text-text-muted hover:bg-border/50 hover:text-text focus:ring-primary"},p={sm:"px-2 py-1 text-xs",md:"px-4 py-2 text-sm",lg:"px-6 py-3 text-base"};return l.jsx("button",{className:`${u} ${f[a]} ${p[s]} ${i}`,...c,children:n})},lc=$.lazy(()=>Ha(()=>import("./StudySession-C_65d3xF.js"),__vite__mapDeps([0,1,2,3]))),B_=$.lazy(()=>Ha(()=>import("./ReaderSession-Bk0rZ_BY.js"),__vite__mapDeps([4,3]))),F_=$.lazy(()=>Ha(()=>import("./SettingsPage-4IMp1fwg.js"),[]).then(n=>({default:n.SettingsPage}))),H_=$.lazy(()=>Ha(()=>import("./DeckDetailsPage-CpZRUDPK.js"),__vite__mapDeps([5,1,6]))),P_=$.lazy(()=>Ha(()=>import("./JsonInstructionsPage-B65-tnyG.js"),[])),q_=$.lazy(()=>Ha(()=>import("./SeriesOverviewPage-DZl4cgEk.js"),__vite__mapDeps([7,8,1,6]))),G_=$.lazy(()=>Ha(()=>import("./ArchivePage-D4Fnli1W.js"),[]).then(n=>({default:n.ArchivePage}))),K_=$.lazy(()=>Ha(()=>import("./TrashPage-C-Adr5F2.js"),[])),Y_=$.lazy(()=>Ha(()=>import("./DashboardPage-BMD4tPmZ.js"),__vite__mapDeps([9,10,1,2,8]))),$_=$.lazy(()=>Ha(()=>import("./AllDecksPage-BOu3D0l2.js"),__vite__mapDeps([11,8,1,12]))),V_=$.lazy(()=>Ha(()=>import("./AllSeriesPage-CneIUalb.js"),__vite__mapDeps([13,10,1,2,12]))),Z_=$.lazy(()=>Ha(()=>import("./ProgressPage-CohAPSU5.js"),[])),Q_=$.lazy(()=>Ha(()=>import("./DeckPrintView-CDlT1K2K.js"),[])),J_=()=>{const{path:n,navigate:a}=si(),s=_l(),{activeDeck:i,activeSeries:c,generalStudyDeck:u,sessionsToResume:f,isSyncing:p,lastSyncStatus:b,isGapiReady:m,isGapiSignedIn:_,gapiUser:E,sortPreference:N,setSortPreference:S,draggedDeckId:I,setDraggedDeckId:A,openFolderIds:k,onToggleFolder:R}=s,{aiFeaturesEnabled:P}=Xi(),[q]=n.split("?"),G=rp(),Y=N_(),W=C_(),H=D_(),L=$.useMemo(()=>q.startsWith("/study/")||q.endsWith("/study")||q.endsWith("/cram")||q.endsWith("/study-reversed")||q.endsWith("/study-flip")||q.endsWith("/read"),[q]),U=q.endsWith("/print"),Q=$.useMemo(()=>{if(U)return[];const F=[{label:"Home",href:"/"}],te=new URLSearchParams(window.location.hash.split("?")[1]);if(q==="/series")F.push({label:"Series"});else if(q.startsWith("/series/")&&c)F.push({label:"Series",href:"/series"}),F.push({label:c.name||"Series"});else if(q==="/decks")F.push({label:"Decks"});else if(q.startsWith("/decks/")&&i){let j=null;const he=te.get("seriesId");he&&(j=G.find(J=>J.id===he)),j||(j=G.find(J=>!J.deletedAt&&(J.levels||[]).some(Z=>{var De;return(De=Z.deckIds)==null?void 0:De.includes(i.id)}))),j?(F.push({label:"Series",href:"/series"}),F.push({label:j.name||"Series",href:`/series/${j.id}`})):F.push({label:"Decks",href:"/decks"}),F.push({label:i.name||"Deck"})}else q==="/settings"?F.push({label:"Settings"}):q==="/trash"?F.push({label:"Trash"}):q==="/archive"?F.push({label:"Archive"}):q==="/progress"?F.push({label:"Progress"}):q==="/instructions/json"&&F.push({label:"JSON Guide"});return F},[q,i,c,G,U]),le=()=>{if(q==="/settings")return l.jsx(F_,{onExport:s.handleExportData,onRestore:()=>s.openModal("restore"),onResetProgress:()=>s.openModal("resetProgress"),onFactoryReset:s.handleFactoryReset,onSync:s.handleManualSync,onForceFetch:s.handleForceFetchFromServer,onForceUpload:s.handleForceUploadToServer,isSyncing:p,lastSyncStatus:b,onManageServerBackups:()=>s.openModal("serverBackup"),onCreateServerBackup:s.handleCreateServerBackup,isGapiReady:m,isGapiSignedIn:_,gapiUser:E,onGoogleSignIn:s.handleGoogleSignIn,onGoogleSignOut:s.handleGoogleSignOut,onBackupToDrive:s.handleBackupToDrive,onRestoreFromDrive:s.openRestoreFromDriveModal,onClearAppCache:s.handleClearAppCache,onClearCdnCache:s.handleClearCdnCache,onRevertLastFetch:s.handleRevertLastFetch});if(q==="/trash")return l.jsx(K_,{onRestoreDeck:s.handleRestoreDeck,onRestoreSeries:s.handleRestoreSeries,onDeleteDeckPermanently:s.handleDeleteDeckPermanently,onDeleteSeriesPermanently:s.handleDeleteSeriesPermanently,openConfirmModal:s.openConfirmModal});if(q==="/archive")return l.jsx(G_,{onUpdateDeck:s.handleUpdateDeck,onUpdateSeries:s.handleUpdateSeries,onDeleteDeck:s.handleDeleteDeck,onDeleteSeries:s.handleDeleteSeries,openConfirmModal:s.openConfirmModal});if(q==="/progress")return l.jsx(Z_,{});if(q.startsWith("/series/")&&c)return l.jsx(q_,{series:c,sessionsToResume:f,onUpdateSeries:s.handleUpdateSeries,onDeleteSeries:s.handleDeleteSeries,onAddDeckToSeries:s.handleAddDeckToSeries,onUpdateDeck:s.handleUpdateDeck,onStartSeriesStudy:s.handleStartSeriesStudy,onUpdateLastOpened:s.updateLastOpenedSeries,openConfirmModal:s.openConfirmModal,onAiAddLevelsToSeries:s.handleAiAddLevelsToSeries,onAiAddDecksToLevel:s.handleAiAddDecksToLevel,handleGenerateQuestionsForEmptyDecksInSeries:s.handleGenerateQuestionsForEmptyDecksInSeries,handleGenerateQuestionsForDeck:s.handleGenerateQuestionsForDeck,onCancelAIGeneration:s.handleCancelAIGeneration,onExportSeries:s.handleExportSeries,onDeleteDeck:s.handleDeleteDeck,handleGenerateContentForLearningDeck:s.handleGenerateContentForLearningDeck,onGenerateDeckForLevel:s.handleOpenAIGenerationForSeriesLevel,onAutoExpandSeries:s.handleOpenAIAutoExpandSeries},c.id);if(q==="/study/general"){const F=new URLSearchParams(window.location.hash.split("?")[1]).get("seriesId")||void 0;return u&&l.jsx(lc,{deck:u,seriesId:F,onSessionEnd:s.handleSessionEnd,onItemReviewed:s.handleItemReviewed,onUpdateLastOpened:()=>{},onStudyNextDeck:s.handleStudyNextDeckInSeries},"general-study")}if(q.startsWith("/decks/")&&q.endsWith("/cram")){if(!i)return null;const F=new URLSearchParams(window.location.hash.split("?")[1]),te=F.get("sort")||"random",j=F.get("limit")||"all";let he=((i.type===et.Flashcard?i.cards:i.questions)||[]).filter(De=>!De.suspended);if(te==="hardest"?he.sort((De,ve)=>{const Be=(ve.lapses||0)-(De.lapses||0);return Be!==0?Be:(De.easeFactor||2.5)-(ve.easeFactor||2.5)}):te==="newest"?he.reverse():te==="oldest"||he.sort(()=>Math.random()-.5),j!=="all"){const De=parseInt(j,10);isNaN(De)||(he=he.slice(0,De))}const J=i.type===et.Flashcard?{...i,name:`${i.name} (Cram)`,cards:he}:{...i,name:`${i.name} (Cram)`,questions:he},Z=F.get("seriesId")||void 0;return l.jsx(lc,{deck:J,seriesId:Z,onSessionEnd:s.handleSessionEnd,onItemReviewed:s.handleItemReviewed,onUpdateLastOpened:s.updateLastOpened,sessionKeySuffix:"_cram",onStudyNextDeck:s.handleStudyNextDeckInSeries},`${i.id}-cram`)}if(q.startsWith("/decks/")&&q.endsWith("/study-reversed")){if(!i||i.type!=="flashcard")return null;const F={...i,name:`${i.name} (Reversed)`,cards:(i.cards||[]).map(j=>({...j,front:j.back,back:j.front}))},te=new URLSearchParams(window.location.hash.split("?")[1]).get("seriesId")||void 0;return l.jsx(lc,{deck:F,seriesId:te,onSessionEnd:s.handleSessionEnd,onItemReviewed:s.handleItemReviewed,onUpdateLastOpened:s.updateLastOpened,sessionKeySuffix:"_reversed",onStudyNextDeck:s.handleStudyNextDeckInSeries},`${i.id}-reversed`)}if(q.startsWith("/decks/")&&q.endsWith("/study-flip")){if(!i||i.type!=="quiz"&&i.type!=="learning")return null;const F=i,te=(F.questions||[]).filter(J=>!J.suspended).map(J=>{const Z=(J.options||[]).find(ve=>ve.id===J.correctAnswerId),De=`<div class="text-left w-full"><p class="text-xl"><b>Answer:</b> ${(Z==null?void 0:Z.text)||"N/A"}</p><hr class="my-4"/><div class="prose prose-sm dark:prose-invert max-w-none">${J.detailedExplanation}</div></div>`;return{...J,front:J.questionText,back:De}}),j={...F,name:`${F.name} (Review)`,type:et.Flashcard,cards:te.sort(()=>Math.random()-.5)},he=new URLSearchParams(window.location.hash.split("?")[1]).get("seriesId")||void 0;return l.jsx(lc,{deck:j,seriesId:he,onSessionEnd:s.handleSessionEnd,onItemReviewed:s.handleItemReviewed,onUpdateLastOpened:s.updateLastOpened,sessionKeySuffix:"_flip",onStudyNextDeck:s.handleStudyNextDeckInSeries},`${i.id}-flip`)}if(q.startsWith("/decks/")&&q.endsWith("/study")){const F=new URLSearchParams(window.location.hash.split("?")[1]).get("seriesId")||void 0;return i&&l.jsx(lc,{deck:i,seriesId:F,onSessionEnd:s.handleSessionEnd,onItemReviewed:s.handleItemReviewed,onUpdateLastOpened:s.updateLastOpened,onStudyNextDeck:s.handleStudyNextDeckInSeries},i.id)}return q.startsWith("/decks/")&&q.endsWith("/read")?!i||i.type!==et.Learning?null:l.jsx(B_,{deck:i,onExit:()=>a(`/decks/${i.id}`),onPractice:()=>a(`/decks/${i.id}/study`)}):q.startsWith("/decks/")&&q.endsWith("/print")?i&&l.jsx(Q_,{deck:i}):q.startsWith("/decks/")?i&&l.jsx(H_,{deck:i,sessionsToResume:f,onUpdateDeck:s.handleUpdateDeck,onDeleteDeck:s.handleDeleteDeck,onUpdateLastOpened:s.updateLastOpened,openConfirmModal:s.openConfirmModal,handleGenerateQuestionsForDeck:s.handleGenerateQuestionsForDeck,handleGenerateContentForLearningDeck:s.handleGenerateContentForLearningDeck,onCancelAIGeneration:s.handleCancelAIGeneration,onSaveLearningBlock:s.handleSaveLearningBlock,onDeleteLearningBlock:s.handleDeleteLearningBlock,onExportDeck:s.handleExportDeck,onRegenerateQuestion:s.handleRegenerateQuestion,onExpandText:s.handleExpandText,onGenerateAI:()=>s.handleOpenAIGenerationForDeck(i)},i.id):q==="/instructions/json"?l.jsx(P_,{}):q==="/decks"?l.jsx($_,{sessionsToResume:f,sortPreference:N,onSortChange:S,onUpdateLastOpened:s.updateLastOpened,onDeleteFolder:s.handleDeleteFolder,draggedDeckId:I,onDragStart:A,onDragEnd:()=>A(null),onMoveDeck:s.handleMoveDeck,openFolderIds:k,onToggleFolder:R,onUpdateDeck:s.handleUpdateDeck,onDeleteDeck:s.handleDeleteDeck,openConfirmModal:s.openConfirmModal,onNewFolder:()=>s.openModal("folder",{folder:"new"}),onImportDecks:()=>s.openModal("import"),onCreateSampleDeck:s.handleCreateSampleDeck,handleSaveFolder:s.handleSaveFolder,handleGenerateQuestionsForDeck:s.handleGenerateQuestionsForDeck,handleGenerateContentForLearningDeck:s.handleGenerateContentForLearningDeck,onCancelAIGeneration:s.handleCancelAIGeneration}):q==="/series"?l.jsx(V_,{onStartSeriesStudy:s.handleStartSeriesStudy,onCreateNewSeries:()=>s.openModal("series",{series:"new"}),onCreateSampleSeries:s.handleCreateSampleSeries,onGenerateAI:()=>s.openModal("aiGeneration"),handleGenerateQuestionsForEmptyDecksInSeries:s.handleGenerateQuestionsForEmptyDecksInSeries,onCancelAIGeneration:s.handleCancelAIGeneration}):Y.length>0||W.length>0?l.jsx(Y_,{onGenerateAI:()=>s.openModal("aiGeneration"),totalDueQuestions:H,onStartGeneralStudy:s.handleStartGeneralStudy,sessionsToResume:f,onUpdateLastOpened:s.updateLastOpened,onUpdateDeck:s.handleUpdateDeck,onDeleteDeck:s.handleDeleteDeck,openConfirmModal:s.openConfirmModal,seriesProgress:kt.getState().seriesProgress,onStartSeriesStudy:s.handleStartSeriesStudy,handleGenerateQuestionsForDeck:s.handleGenerateQuestionsForDeck,handleGenerateContentForLearningDeck:s.handleGenerateContentForLearningDeck,handleGenerateQuestionsForEmptyDecksInSeries:s.handleGenerateQuestionsForEmptyDecksInSeries,onCancelAIGeneration:s.handleCancelAIGeneration,onCreateSampleQuizDeck:s.handleCreateSampleQuizDeck,onCreateSampleFlashcardDeck:s.handleCreateSampleFlashcardDeck,onCreateSampleLearningDeck:s.handleCreateSampleLearningDeck,onCreateSampleSeries:s.handleCreateSampleSeries,onCreateSampleCourse:s.onCreateSampleCourse}):l.jsxs("div",{className:"text-center py-20 max-w-4xl mx-auto",children:[l.jsx("h2",{className:"text-3xl font-bold text-gray-600 dark:text-gray-400",children:"Welcome to CogniFlow"}),l.jsx("p",{className:"mt-4 text-gray-500 dark:text-gray-500",children:"Get started by creating or importing content."}),l.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-center gap-4 mt-8 flex-wrap",children:[P&&l.jsxs(pt,{onClick:()=>s.openModal("aiGeneration"),variant:"primary",children:[l.jsx(rt,{name:"zap",className:"w-5 h-5 mr-2"}),"Generate with AI"]}),l.jsxs(pt,{onClick:()=>s.openModal("import"),children:[l.jsx(rt,{name:"plus",className:"w-5 h-5 mr-2"}),"Create / Import"]}),l.jsxs(pt,{onClick:()=>s.openModal("series",{series:"new"}),variant:"secondary",children:[l.jsx(rt,{name:"layers",className:"w-5 h-5 mr-2"}),"New Series"]}),l.jsxs(pt,{onClick:()=>s.openModal("restore"),variant:"secondary",children:[l.jsx(rt,{name:"upload-cloud",className:"w-5 h-5 mr-2"}),"Restore Backup"]})]}),l.jsxs("div",{className:"mt-12 border-t border-border pt-8",children:[l.jsx("h3",{className:"text-lg font-semibold text-text-muted mb-4",children:"Or try a sample:"}),l.jsxs("div",{className:"flex flex-wrap justify-center gap-3",children:[l.jsxs(pt,{onClick:s.handleCreateSampleQuizDeck,variant:"ghost",size:"sm",children:[l.jsx(rt,{name:"help-circle",className:"w-4 h-4 mr-2"})," Quiz Deck"]}),l.jsxs(pt,{onClick:s.handleCreateSampleFlashcardDeck,variant:"ghost",size:"sm",children:[l.jsx(rt,{name:"laptop",className:"w-4 h-4 mr-2"})," Flashcard Deck"]}),l.jsxs(pt,{onClick:s.handleCreateSampleLearningDeck,variant:"ghost",size:"sm",children:[l.jsx(rt,{name:"book-open",className:"w-4 h-4 mr-2"})," Learning Deck"]}),l.jsxs(pt,{onClick:s.handleCreateSampleSeries,variant:"ghost",size:"sm",children:[l.jsx(rt,{name:"layers",className:"w-4 h-4 mr-2"})," Series"]})]})]})]})};return L||U?l.jsx($.Suspense,{fallback:l.jsx(My,{}),children:le()}):l.jsxs(l.Fragment,{children:[l.jsx(L_,{items:Q}),l.jsx(z_,{children:l.jsx($.Suspense,{fallback:l.jsx(My,{}),children:le()})},q)]})},X_=({onOpenMenu:n,onOpenCommandPalette:a,activeDeck:s,isVisible:i})=>{const{path:c,goBack:u,canGoBack:f}=si(),[p]=c.split("?"),b=p==="/";let m;if(b)m=l.jsx(ds,{href:"/",className:"no-underline",children:l.jsx("h1",{className:"text-2xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-blue-400 to-teal-300",children:"CogniFlow"})});else{let _="Back";s?_=s.name:p==="/study/general"?_="General Study":p==="/settings"&&(_="Settings"),m=l.jsxs(pt,{variant:"ghost",onClick:u,className:"flex items-center space-x-2 -ml-3 min-w-0","aria-label":"Go Back",children:[l.jsx(rt,{name:"chevron-left"}),l.jsx("span",{className:"truncate",children:_})]})}return l.jsx("header",{className:`bg-surface/80 backdrop-blur-sm fixed top-0 left-0 right-0 z-20 border-b border-border transition-transform duration-300 ease-in-out ${i?"translate-y-0":"-translate-y-full"}`,children:l.jsxs("nav",{className:"container mx-auto px-4 sm:px-6 lg:px-8 flex items-center justify-between h-16",children:[l.jsx("div",{className:"flex items-center flex-1 min-w-0",children:m}),l.jsxs("div",{className:"flex items-center space-x-1",children:[l.jsx(pt,{variant:"ghost",onClick:a,className:"p-1 h-auto","aria-label":"Open command palette",children:l.jsx(rt,{name:"search"})}),l.jsx(pt,{variant:"ghost",onClick:n,className:"p-1 h-auto","aria-label":"Open menu",children:l.jsx(rt,{name:"menu"})})]})]})})},W_='a[href], button:not([disabled]), textarea, input, select, [tabindex]:not([tabindex="-1"])',kr=(n,a)=>{const s=$.useRef([]);$.useEffect(()=>{if(a&&n.current){s.current=Array.from(n.current.querySelectorAll(W_));const i=s.current[0];i&&setTimeout(()=>i.focus(),100);const c=u=>{var b;if(u.key!=="Tab"||!((b=n.current)!=null&&b.contains(document.activeElement)))return;const f=s.current[0],p=s.current[s.current.length-1];u.shiftKey?document.activeElement===f&&(u.preventDefault(),p==null||p.focus()):document.activeElement===p&&(u.preventDefault(),f==null||f.focus())};return document.addEventListener("keydown",c),()=>{document.removeEventListener("keydown",c)}}},[a,n])},ew=({isOpen:n,onClose:a,onImport:s,onCreateSeries:i,onGenerateAI:c,onInstall:u})=>{const f=$.useRef(null),{aiFeaturesEnabled:p}=Xi();return kr(f,n),$.useEffect(()=>{const b=m=>{m.key==="Escape"&&a()};return n&&document.addEventListener("keydown",b),()=>{document.removeEventListener("keydown",b)}},[n,a]),l.jsxs(l.Fragment,{children:[l.jsx("div",{className:`fixed inset-0 bg-black bg-opacity-60 z-50 transition-opacity duration-300 ${n?"opacity-100":"opacity-0 pointer-events-none"}`,onClick:a,"aria-hidden":"true"}),l.jsx("div",{ref:f,className:`fixed top-0 right-0 h-full w-full max-w-xs z-[51] transform transition-transform duration-300 ease-in-out ${n?"translate-x-0":"translate-x-full"}`,role:"dialog","aria-modal":"true","aria-labelledby":"sidebar-title",children:l.jsxs("div",{className:"bg-surface shadow-xl h-full flex flex-col",children:[l.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-border",children:[l.jsx("h2",{id:"sidebar-title",className:"text-xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-blue-400 to-teal-300",children:"Menu"}),l.jsx(pt,{variant:"ghost",onClick:a,className:"p-1 h-auto","aria-label":"Close menu",children:l.jsx(rt,{name:"x"})})]}),l.jsxs("nav",{className:"flex-grow p-4 space-y-2",children:[l.jsxs(ds,{href:"/",onClick:a,className:"flex items-center px-3 py-2 text-text rounded-md hover:bg-border/30 text-lg",children:[l.jsx(rt,{name:"laptop",className:"w-6 h-6 mr-3"})," Home"]}),l.jsxs(ds,{href:"/series",onClick:a,className:"flex items-center px-3 py-2 text-text rounded-md hover:bg-border/30 text-lg",children:[l.jsx(rt,{name:"layers",className:"w-6 h-6 mr-3"})," Series"]}),l.jsxs(ds,{href:"/decks",onClick:a,className:"flex items-center px-3 py-2 text-text rounded-md hover:bg-border/30 text-lg",children:[l.jsx(rt,{name:"folder",className:"w-6 h-6 mr-3"})," Decks"]}),l.jsxs(ds,{href:"/progress",onClick:a,className:"flex items-center px-3 py-2 text-text rounded-md hover:bg-border/30 text-lg",children:[l.jsx(rt,{name:"trending-up",className:"w-6 h-6 mr-3"}),"Progress"]}),l.jsxs(ds,{href:"/archive",onClick:a,className:"flex items-center px-3 py-2 text-text rounded-md hover:bg-border/30 text-lg",children:[l.jsx(rt,{name:"archive",className:"w-6 h-6 mr-3"}),"Archive"]}),l.jsxs(ds,{href:"/trash",onClick:a,className:"flex items-center px-3 py-2 text-text rounded-md hover:bg-border/30 text-lg",children:[l.jsx(rt,{name:"trash-2",className:"w-6 h-6 mr-3"}),"Trash"]}),l.jsxs(ds,{href:"/settings",onClick:a,className:"flex items-center px-3 py-2 text-text rounded-md hover:bg-border/30 text-lg",children:[l.jsx(rt,{name:"settings",className:"w-6 h-6 mr-3"}),"Settings"]}),l.jsxs(ds,{href:"/instructions/json",onClick:a,className:"flex items-center px-3 py-2 text-text rounded-md hover:bg-border/30 text-lg",children:[l.jsx(rt,{name:"help-circle",className:"w-6 h-6 mr-3"}),"JSON Guide"]})]}),l.jsxs("div",{className:"p-4 border-t border-border space-y-2",children:[p&&l.jsxs(pt,{variant:"primary",onClick:c,className:"w-full",children:[l.jsx(rt,{name:"zap",className:"w-5 h-5 mr-2"}),"Generate with AI"]}),l.jsxs(pt,{variant:"secondary",onClick:i,className:"w-full",children:[l.jsx(rt,{name:"layers",className:"w-5 h-5 mr-2"}),"Create New Series"]}),l.jsxs(pt,{variant:"secondary",onClick:s,className:"w-full",children:[l.jsx(rt,{name:"plus",className:"w-5 h-5 mr-2"}),"Create / Import Deck"]}),u&&l.jsxs(pt,{variant:"secondary",onClick:u,className:"w-full",children:[l.jsx(rt,{name:"download",className:"w-5 h-5 mr-2"}),"Install App"]})]})]})})]})},wb=$.createContext(void 0),zc=()=>{const n=$.useContext(wb);if(!n)throw new Error("useModal must be used within a ModalProvider");return n},tw=({children:n})=>{const[a,s]=$.useState({type:null,payload:null}),i=$.useRef(null),c=$.useCallback((f,p={})=>{i.current=document.activeElement,s({type:f,payload:p})},[]),u=$.useCallback(()=>{s({type:null,payload:null}),setTimeout(()=>{var f;return(f=i.current)==null?void 0:f.focus()},100)},[]);return l.jsx(wb.Provider,{value:{modalType:a.type,modalPayload:a.payload,openModal:c,closeModal:u},children:n})},za=2.5,Bh=1.3,nw=1,rw=1.2,aw=1.3,sw={1:-.2,2:-.15,3:0,4:.15};function ap(n,a=null){const s={isValid:!1,parsed:null,errors:[],detailedErrors:[],suggestions:[],fixedJSON:null,schemaIssues:[]};if(!n||typeof n!="string"||n.trim()==="")return s.errors.push("Input must be a non-empty string"),s;let i=null;if(a)try{i=JSON.parse(a)}catch{s.schemaIssues.push({type:"error",path:"Template",message:"The provided Schema/Template JSON is itself invalid and cannot be used for comparison."})}let c=n;try{s.parsed=JSON.parse(c),s.isValid=!0,s.fixedJSON=JSON.stringify(s.parsed,null,2)}catch(u){const f=iw(u,c);s.errors.push(u.message),s.detailedErrors.push(f);const p=cw(c);if(p.success){s.fixedJSON=p.fixed,c=p.fixed,s.suggestions=p.suggestions;try{s.parsed=JSON.parse(c),s.isValid=!0}catch{}}else s.suggestions=p.suggestions}return i&&s.parsed&&s.schemaIssues.push(...Fh(s.parsed,i)),s}function Fh(n,a,s="$"){const i=[];if(Array.isArray(a))return Array.isArray(n)?(a.length>0&&n.length>0&&i.push(...Fh(n[0],a[0],`${s}[0]`)),i):(i.push({type:"error",path:s,message:`Type Mismatch: Expected an array but got ${typeof n}.`}),i);if(typeof a=="object"&&a!==null){if(typeof n!="object"||n===null||Array.isArray(n))return i.push({type:"error",path:s,message:`Type Mismatch: Expected an object but got ${Array.isArray(n)?"array":typeof n}.`}),i;const c=Object.keys(a),u=new Set(Object.keys(n));for(const f of c){const p=`${s}.${f}`;if(!u.has(f))i.push({type:"warning",path:p,message:`Missing Key: The key '${f}' is missing.`});else{const b=Array.isArray(a[f])?"array":typeof a[f],m=Array.isArray(n[f])?"array":typeof n[f];b!==m?i.push({type:"error",path:p,message:`Type Mismatch: Expected type '${b}' but got '${m}'.`}):typeof a[f]=="object"&&a[f]!==null&&i.push(...Fh(n[f],a[f],p))}}for(const f of Array.from(u))c.includes(f)||i.push({type:"info",path:`${s}.${f}`,message:`Extra Key: The key '${f}' is present but not in the schema.`});return i}return i}function iw(n,a){var S;const s=n.message,i=a.split(`
`);let c=null,u=null,f="Syntax Error",p="",b="",m="",_;const E=s.match(/at position (\d+)/),N=s.match(/at line (\d+) column (\d+)/i);if(E){const I=parseInt(E[1],10),{line:A,column:k}=ow(a,I);c=A,u=k,p=Fu(i,c-1,u-1);const R=a.substring(0,I).trim();s.includes("Expected property name or '}'")?(f="Invalid Object Key or Trailing Comma",R.endsWith(",")?_='A trailing comma was found. JSON does not allow a comma after the last item in an object. For example, `{"key": "value",}` is invalid. Remove the comma.':_='An object key might be missing or invalid. All keys in JSON must be strings enclosed in double quotes (e.g., `"key": "value"`). Check for unquoted keys or a missing comma.'):s.includes("Unexpected token")&&(m=((S=s.match(/Unexpected token (.+?) in JSON/))==null?void 0:S[1])||"",f="Unexpected Token",(m==="}"||m==="]")&&R.endsWith(",")?(f="Trailing Comma",_='A trailing comma was found. JSON format does not allow a comma after the last item in an array or object. For example, `[1, 2,]` and `{"key":"value",}` are invalid. Remove the final comma.'):m==="'"?(f="Invalid String Quote",_="JSON strings must use double quotes (`\"`). Single quotes (`'`) are not permitted. For example, change `'value'` to `\"value\"`."):m==="="?(f="Invalid Assignment",_="JSON uses a colon (`:`) to separate keys from values, not an equals sign (`=`). This may be a typo (e.g., `:=` instead of just `:`) that needs to be corrected."):m.toLowerCase()==="u"&&a.substring(I).startsWith("undefined")?(f="Invalid Value",_="The value `undefined` is not valid in JSON. This is common when converting JavaScript objects. Use `null` instead or remove the key-value pair."):m.match(/^[a-zA-Z]/)?(f="Unquoted String",_='This looks like an unquoted string, key, or value. All strings and object keys in JSON must be enclosed in double quotes. For example, `{ key: "value" }` should be `{ "key": "value" }`.'):_=`An unexpected character '${m}' was found. This is often caused by a missing comma, a missing colon, or a typo. Please check the syntax around this character.`)}else if(N)c=parseInt(N[1],10),u=parseInt(N[2],10),p=Fu(i,c-1,u-1),s.includes("trailing comma")?(f="Trailing Comma",_="A trailing comma was found. JSON format does not allow a comma after the last item in an object or array. For example, `[1, 2,]` is invalid. Remove the final comma."):s.includes("expected property name")?(f="Invalid Object Key",_='An object key is expected here. All keys in JSON must be strings enclosed in double quotes (e.g., `"key": "value"`). Check for missing quotes or a missing comma before this line.'):s.includes("expected a string")?(f="Invalid String",_="This value was expected to be a string, but it isn't. Remember to wrap all strings in double quotes (`\"`). Single quotes are not allowed. For example, use `\"text\"` instead of `'text'` or `text`."):(f="Syntax Error",_="There is a syntax error at this location. Please check for issues like missing commas (,), colons (:), or mismatched brackets/braces ([]/{}).");else if(s.match(/Unterminated string|Unexpected end of JSON input/i)){const I=lw(a);I.line!==null&&I.column!==null?(f="Unterminated String",c=I.line,u=I.column,p=Fu(i,c-1,u-1),_='An unclosed string was detected. All strings in JSON must be enclosed in double quotes. Check for a missing closing quote (`"`) on this line or a previous one.'):(f="Unexpected End of Input",p=Fu(i,i.length-1),_="The JSON ends unexpectedly. This usually means you are missing a closing brace `}` for an object or a closing bracket `]` for an array.")}return _||(_="The JSON structure is invalid. Please check for common syntax errors like missing commas, incorrect quotes, or mismatched brackets and braces."),{type:f,line:c,column:u,expected:b,actual:m,context:p,message:s,friendlyMessage:_}}function ow(n,a){const s=n.substring(0,a).split(`
`);return{line:s.length,column:s[s.length-1].length+1}}function Fu(n,a,s,i=2){const c=Math.max(0,a-i),u=Math.min(n.length,a+i+1),f=n.slice(c,u);if(s!==void 0&&s>=1&&a>=c&&a<u){const p=a-c,b=" ".repeat(s-1)+"^";f.splice(p+1,0,b)}return f.join(`
`)}function lw(n){const a=n.split(`
`);let s=!1,i="",c=!1,u={line:null,column:null};for(let f=0;f<a.length;f++){const p=a[f];for(let b=0;b<p.length;b++){const m=p[b];if(c){c=!1;continue}if(m==="\\"&&s){c=!0;continue}(m==='"'||m==="'")&&!s?(s=!0,i=m,u={line:f+1,column:b+1}):m===i&&s&&(s=!1)}}return s&&u.line!==null?{...u,context:""}:{line:null,column:null,context:""}}function cw(n){let a=n;const s=new Set,i=dw(a);i.fixes.length>0&&(a=i.fixed,i.fixes.forEach(c=>s.add(c)));try{const c=JSON.parse(a);return{success:!0,fixed:JSON.stringify(c,null,2),suggestions:Array.from(s)}}catch(c){let u=Array.from(s);return c.message.includes("Unterminated string")&&u.push("Attempted to fix an unterminated string. Please review the result."),u.length===0&&u.push("Could not automatically fix JSON errors."),{success:!1,fixed:null,suggestions:u}}}function uw(n){return n.replace(/[\u2018\u2019\u201C\u201D]/g,'"')}function dw(n){const a=[];let s=n.trim();const i=s;s=uw(s),i!==s&&a.push("Replaced smart/typographic quotes with standard double quotes");const c=[{regex:/(:\s*)=/g,replacement:"$1",description:"Replaced invalid assignment operator (e.g. `:=`) with a colon"},{regex:/,\s*([}\]])/g,replacement:"$1",description:"Removed trailing commas"},{regex:/([{,]\s*)([a-zA-Z_$][a-zA-Z0-9_$]*)\s*:/g,replacement:'$1"$2":',description:"Added quotes to unquoted keys"},{regex:/:\s*([^",\s\[\{][^,}\]]*?)(?=\s*[,}])/g,replacement:': "$1"',description:"Added quotes to an unquoted string value"},{regex:/:\s*(undefined|NaN|Infinity|-Infinity)/g,replacement:": null",description:"Replaced `undefined`, `NaN`, or `Infinity` with `null`"},{regex:/"(\s*)"(?!\s*[:],}])/g,replacement:'","',description:"Added missing comma between string values"},{regex:/}(\s*)"/g,replacement:'},"$1"',description:"Added missing comma between an object and a following key"},{regex:/\](\s*)"/g,replacement:'],"$1"',description:"Added missing comma between an array and a following key"},{regex:/\](\s*)\{/g,replacement:"], $1{",description:"Added missing comma between an array and an object"}];for(let u=0;u<3;u++)c.forEach(f=>{const p=s;s=s.replace(f.regex,f.replacement),p!==s&&!a.includes(f.description)&&a.push(f.description)});return{fixed:s,fixes:a}}var Sn;(function(n){n.assertEqual=c=>c;function a(c){}n.assertIs=a;function s(c){throw new Error}n.assertNever=s,n.arrayToEnum=c=>{const u={};for(const f of c)u[f]=f;return u},n.getValidEnumValues=c=>{const u=n.objectKeys(c).filter(p=>typeof c[c[p]]!="number"),f={};for(const p of u)f[p]=c[p];return n.objectValues(f)},n.objectValues=c=>n.objectKeys(c).map(function(u){return c[u]}),n.objectKeys=typeof Object.keys=="function"?c=>Object.keys(c):c=>{const u=[];for(const f in c)Object.prototype.hasOwnProperty.call(c,f)&&u.push(f);return u},n.find=(c,u)=>{for(const f of c)if(u(f))return f},n.isInteger=typeof Number.isInteger=="function"?c=>Number.isInteger(c):c=>typeof c=="number"&&isFinite(c)&&Math.floor(c)===c;function i(c,u=" | "){return c.map(f=>typeof f=="string"?`'${f}'`:f).join(u)}n.joinValues=i,n.jsonStringifyReplacer=(c,u)=>typeof u=="bigint"?u.toString():u})(Sn||(Sn={}));var Hh;(function(n){n.mergeShapes=(a,s)=>({...a,...s})})(Hh||(Hh={}));const Tt=Sn.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),Ki=n=>{switch(typeof n){case"undefined":return Tt.undefined;case"string":return Tt.string;case"number":return isNaN(n)?Tt.nan:Tt.number;case"boolean":return Tt.boolean;case"function":return Tt.function;case"bigint":return Tt.bigint;case"symbol":return Tt.symbol;case"object":return Array.isArray(n)?Tt.array:n===null?Tt.null:n.then&&typeof n.then=="function"&&n.catch&&typeof n.catch=="function"?Tt.promise:typeof Map<"u"&&n instanceof Map?Tt.map:typeof Set<"u"&&n instanceof Set?Tt.set:typeof Date<"u"&&n instanceof Date?Tt.date:Tt.object;default:return Tt.unknown}},ht=Sn.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]),fw=n=>JSON.stringify(n,null,2).replace(/"([^"]+)":/g,"$1:");class Ba extends Error{constructor(a){super(),this.issues=[],this.addIssue=i=>{this.issues=[...this.issues,i]},this.addIssues=(i=[])=>{this.issues=[...this.issues,...i]};const s=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,s):this.__proto__=s,this.name="ZodError",this.issues=a}get errors(){return this.issues}format(a){const s=a||function(u){return u.message},i={_errors:[]},c=u=>{for(const f of u.issues)if(f.code==="invalid_union")f.unionErrors.map(c);else if(f.code==="invalid_return_type")c(f.returnTypeError);else if(f.code==="invalid_arguments")c(f.argumentsError);else if(f.path.length===0)i._errors.push(s(f));else{let p=i,b=0;for(;b<f.path.length;){const m=f.path[b];b===f.path.length-1?(p[m]=p[m]||{_errors:[]},p[m]._errors.push(s(f))):p[m]=p[m]||{_errors:[]},p=p[m],b++}}};return c(this),i}static assert(a){if(!(a instanceof Ba))throw new Error(`Not a ZodError: ${a}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,Sn.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(a=s=>s.message){const s={},i=[];for(const c of this.issues)c.path.length>0?(s[c.path[0]]=s[c.path[0]]||[],s[c.path[0]].push(a(c))):i.push(a(c));return{formErrors:i,fieldErrors:s}}get formErrors(){return this.flatten()}}Ba.create=n=>new Ba(n);const vl=(n,a)=>{let s;switch(n.code){case ht.invalid_type:n.received===Tt.undefined?s="Required":s=`Expected ${n.expected}, received ${n.received}`;break;case ht.invalid_literal:s=`Invalid literal value, expected ${JSON.stringify(n.expected,Sn.jsonStringifyReplacer)}`;break;case ht.unrecognized_keys:s=`Unrecognized key(s) in object: ${Sn.joinValues(n.keys,", ")}`;break;case ht.invalid_union:s="Invalid input";break;case ht.invalid_union_discriminator:s=`Invalid discriminator value. Expected ${Sn.joinValues(n.options)}`;break;case ht.invalid_enum_value:s=`Invalid enum value. Expected ${Sn.joinValues(n.options)}, received '${n.received}'`;break;case ht.invalid_arguments:s="Invalid function arguments";break;case ht.invalid_return_type:s="Invalid function return type";break;case ht.invalid_date:s="Invalid date";break;case ht.invalid_string:typeof n.validation=="object"?"includes"in n.validation?(s=`Invalid input: must include "${n.validation.includes}"`,typeof n.validation.position=="number"&&(s=`${s} at one or more positions greater than or equal to ${n.validation.position}`)):"startsWith"in n.validation?s=`Invalid input: must start with "${n.validation.startsWith}"`:"endsWith"in n.validation?s=`Invalid input: must end with "${n.validation.endsWith}"`:Sn.assertNever(n.validation):n.validation!=="regex"?s=`Invalid ${n.validation}`:s="Invalid";break;case ht.too_small:n.type==="array"?s=`Array must contain ${n.exact?"exactly":n.inclusive?"at least":"more than"} ${n.minimum} element(s)`:n.type==="string"?s=`String must contain ${n.exact?"exactly":n.inclusive?"at least":"over"} ${n.minimum} character(s)`:n.type==="number"?s=`Number must be ${n.exact?"exactly equal to ":n.inclusive?"greater than or equal to ":"greater than "}${n.minimum}`:n.type==="date"?s=`Date must be ${n.exact?"exactly equal to ":n.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(n.minimum))}`:s="Invalid input";break;case ht.too_big:n.type==="array"?s=`Array must contain ${n.exact?"exactly":n.inclusive?"at most":"less than"} ${n.maximum} element(s)`:n.type==="string"?s=`String must contain ${n.exact?"exactly":n.inclusive?"at most":"under"} ${n.maximum} character(s)`:n.type==="number"?s=`Number must be ${n.exact?"exactly":n.inclusive?"less than or equal to":"less than"} ${n.maximum}`:n.type==="bigint"?s=`BigInt must be ${n.exact?"exactly":n.inclusive?"less than or equal to":"less than"} ${n.maximum}`:n.type==="date"?s=`Date must be ${n.exact?"exactly":n.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(n.maximum))}`:s="Invalid input";break;case ht.custom:s="Invalid input";break;case ht.invalid_intersection_types:s="Intersection results could not be merged";break;case ht.not_multiple_of:s=`Number must be a multiple of ${n.multipleOf}`;break;case ht.not_finite:s="Number must be finite";break;default:s=a.defaultError,Sn.assertNever(n)}return{message:s}};let Sb=vl;function hw(n){Sb=n}function id(){return Sb}const od=n=>{const{data:a,path:s,errorMaps:i,issueData:c}=n,u=[...s,...c.path||[]],f={...c,path:u};if(c.message!==void 0)return{...c,path:u,message:c.message};let p="";const b=i.filter(m=>!!m).slice().reverse();for(const m of b)p=m(f,{data:a,defaultError:p}).message;return{...c,path:u,message:p}},pw=[];function Et(n,a){const s=id(),i=od({issueData:a,data:n.data,path:n.path,errorMaps:[n.common.contextualErrorMap,n.schemaErrorMap,s,s===vl?void 0:vl].filter(c=>!!c)});n.common.issues.push(i)}class ra{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(a,s){const i=[];for(const c of s){if(c.status==="aborted")return Kt;c.status==="dirty"&&a.dirty(),i.push(c.value)}return{status:a.value,value:i}}static async mergeObjectAsync(a,s){const i=[];for(const c of s){const u=await c.key,f=await c.value;i.push({key:u,value:f})}return ra.mergeObjectSync(a,i)}static mergeObjectSync(a,s){const i={};for(const c of s){const{key:u,value:f}=c;if(u.status==="aborted"||f.status==="aborted")return Kt;u.status==="dirty"&&a.dirty(),f.status==="dirty"&&a.dirty(),u.value!=="__proto__"&&(typeof f.value<"u"||c.alwaysSet)&&(i[u.value]=f.value)}return{status:a.value,value:i}}}const Kt=Object.freeze({status:"aborted"}),hl=n=>({status:"dirty",value:n}),la=n=>({status:"valid",value:n}),Ph=n=>n.status==="aborted",qh=n=>n.status==="dirty",Sc=n=>n.status==="valid",Ec=n=>typeof Promise<"u"&&n instanceof Promise;function ld(n,a,s,i){if(typeof a=="function"?n!==a||!0:!a.has(n))throw new TypeError("Cannot read private member from an object whose class did not declare it");return a.get(n)}function Eb(n,a,s,i,c){if(typeof a=="function"?n!==a||!0:!a.has(n))throw new TypeError("Cannot write private member to an object whose class did not declare it");return a.set(n,s),s}var Ut;(function(n){n.errToObj=a=>typeof a=="string"?{message:a}:a||{},n.toString=a=>typeof a=="string"?a:a==null?void 0:a.message})(Ut||(Ut={}));var gc,yc;class js{constructor(a,s,i,c){this._cachedPath=[],this.parent=a,this.data=s,this._path=i,this._key=c}get path(){return this._cachedPath.length||(this._key instanceof Array?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const Uy=(n,a)=>{if(Sc(a))return{success:!0,data:a.value};if(!n.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const s=new Ba(n.common.issues);return this._error=s,this._error}}};function sn(n){if(!n)return{};const{errorMap:a,invalid_type_error:s,required_error:i,description:c}=n;if(a&&(s||i))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return a?{errorMap:a,description:c}:{errorMap:(f,p)=>{var b,m;const{message:_}=n;return f.code==="invalid_enum_value"?{message:_??p.defaultError}:typeof p.data>"u"?{message:(b=_??i)!==null&&b!==void 0?b:p.defaultError}:f.code!=="invalid_type"?{message:p.defaultError}:{message:(m=_??s)!==null&&m!==void 0?m:p.defaultError}},description:c}}class un{constructor(a){this.spa=this.safeParseAsync,this._def=a,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this)}get description(){return this._def.description}_getType(a){return Ki(a.data)}_getOrReturnCtx(a,s){return s||{common:a.parent.common,data:a.data,parsedType:Ki(a.data),schemaErrorMap:this._def.errorMap,path:a.path,parent:a.parent}}_processInputParams(a){return{status:new ra,ctx:{common:a.parent.common,data:a.data,parsedType:Ki(a.data),schemaErrorMap:this._def.errorMap,path:a.path,parent:a.parent}}}_parseSync(a){const s=this._parse(a);if(Ec(s))throw new Error("Synchronous parse encountered promise.");return s}_parseAsync(a){const s=this._parse(a);return Promise.resolve(s)}parse(a,s){const i=this.safeParse(a,s);if(i.success)return i.data;throw i.error}safeParse(a,s){var i;const c={common:{issues:[],async:(i=s==null?void 0:s.async)!==null&&i!==void 0?i:!1,contextualErrorMap:s==null?void 0:s.errorMap},path:(s==null?void 0:s.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:a,parsedType:Ki(a)},u=this._parseSync({data:a,path:c.path,parent:c});return Uy(c,u)}async parseAsync(a,s){const i=await this.safeParseAsync(a,s);if(i.success)return i.data;throw i.error}async safeParseAsync(a,s){const i={common:{issues:[],contextualErrorMap:s==null?void 0:s.errorMap,async:!0},path:(s==null?void 0:s.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:a,parsedType:Ki(a)},c=this._parse({data:a,path:i.path,parent:i}),u=await(Ec(c)?c:Promise.resolve(c));return Uy(i,u)}refine(a,s){const i=c=>typeof s=="string"||typeof s>"u"?{message:s}:typeof s=="function"?s(c):s;return this._refinement((c,u)=>{const f=a(c),p=()=>u.addIssue({code:ht.custom,...i(c)});return typeof Promise<"u"&&f instanceof Promise?f.then(b=>b?!0:(p(),!1)):f?!0:(p(),!1)})}refinement(a,s){return this._refinement((i,c)=>a(i)?!0:(c.addIssue(typeof s=="function"?s(i,c):s),!1))}_refinement(a){return new ps({schema:this,typeName:Gt.ZodEffects,effect:{type:"refinement",refinement:a}})}superRefine(a){return this._refinement(a)}optional(){return Os.create(this,this._def)}nullable(){return Ji.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return hs.create(this,this._def)}promise(){return xl.create(this,this._def)}or(a){return Cc.create([this,a],this._def)}and(a){return Nc.create(this,a,this._def)}transform(a){return new ps({...sn(this._def),schema:this,typeName:Gt.ZodEffects,effect:{type:"transform",transform:a}})}default(a){const s=typeof a=="function"?a:()=>a;return new Rc({...sn(this._def),innerType:this,defaultValue:s,typeName:Gt.ZodDefault})}brand(){return new sp({typeName:Gt.ZodBranded,type:this,...sn(this._def)})}catch(a){const s=typeof a=="function"?a:()=>a;return new Mc({...sn(this._def),innerType:this,catchValue:s,typeName:Gt.ZodCatch})}describe(a){const s=this.constructor;return new s({...this._def,description:a})}pipe(a){return Bc.create(this,a)}readonly(){return Uc.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const mw=/^c[^\s-]{8,}$/i,gw=/^[0-9a-z]+$/,yw=/^[0-9A-HJKMNP-TV-Z]{26}$/,vw=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,bw=/^[a-z0-9_-]{21}$/i,xw=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,_w=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,ww="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";let xh;const Sw=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,Ew=/^(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))$/,kw=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,kb="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",Aw=new RegExp(`^${kb}$`);function Ab(n){let a="([01]\\d|2[0-3]):[0-5]\\d:[0-5]\\d";return n.precision?a=`${a}\\.\\d{${n.precision}}`:n.precision==null&&(a=`${a}(\\.\\d+)?`),a}function Tw(n){return new RegExp(`^${Ab(n)}$`)}function Tb(n){let a=`${kb}T${Ab(n)}`;const s=[];return s.push(n.local?"Z?":"Z"),n.offset&&s.push("([+-]\\d{2}:?\\d{2})"),a=`${a}(${s.join("|")})`,new RegExp(`^${a}$`)}function Cw(n,a){return!!((a==="v4"||!a)&&Sw.test(n)||(a==="v6"||!a)&&Ew.test(n))}class fs extends un{_parse(a){if(this._def.coerce&&(a.data=String(a.data)),this._getType(a)!==Tt.string){const u=this._getOrReturnCtx(a);return Et(u,{code:ht.invalid_type,expected:Tt.string,received:u.parsedType}),Kt}const i=new ra;let c;for(const u of this._def.checks)if(u.kind==="min")a.data.length<u.value&&(c=this._getOrReturnCtx(a,c),Et(c,{code:ht.too_small,minimum:u.value,type:"string",inclusive:!0,exact:!1,message:u.message}),i.dirty());else if(u.kind==="max")a.data.length>u.value&&(c=this._getOrReturnCtx(a,c),Et(c,{code:ht.too_big,maximum:u.value,type:"string",inclusive:!0,exact:!1,message:u.message}),i.dirty());else if(u.kind==="length"){const f=a.data.length>u.value,p=a.data.length<u.value;(f||p)&&(c=this._getOrReturnCtx(a,c),f?Et(c,{code:ht.too_big,maximum:u.value,type:"string",inclusive:!0,exact:!0,message:u.message}):p&&Et(c,{code:ht.too_small,minimum:u.value,type:"string",inclusive:!0,exact:!0,message:u.message}),i.dirty())}else if(u.kind==="email")_w.test(a.data)||(c=this._getOrReturnCtx(a,c),Et(c,{validation:"email",code:ht.invalid_string,message:u.message}),i.dirty());else if(u.kind==="emoji")xh||(xh=new RegExp(ww,"u")),xh.test(a.data)||(c=this._getOrReturnCtx(a,c),Et(c,{validation:"emoji",code:ht.invalid_string,message:u.message}),i.dirty());else if(u.kind==="uuid")vw.test(a.data)||(c=this._getOrReturnCtx(a,c),Et(c,{validation:"uuid",code:ht.invalid_string,message:u.message}),i.dirty());else if(u.kind==="nanoid")bw.test(a.data)||(c=this._getOrReturnCtx(a,c),Et(c,{validation:"nanoid",code:ht.invalid_string,message:u.message}),i.dirty());else if(u.kind==="cuid")mw.test(a.data)||(c=this._getOrReturnCtx(a,c),Et(c,{validation:"cuid",code:ht.invalid_string,message:u.message}),i.dirty());else if(u.kind==="cuid2")gw.test(a.data)||(c=this._getOrReturnCtx(a,c),Et(c,{validation:"cuid2",code:ht.invalid_string,message:u.message}),i.dirty());else if(u.kind==="ulid")yw.test(a.data)||(c=this._getOrReturnCtx(a,c),Et(c,{validation:"ulid",code:ht.invalid_string,message:u.message}),i.dirty());else if(u.kind==="url")try{new URL(a.data)}catch{c=this._getOrReturnCtx(a,c),Et(c,{validation:"url",code:ht.invalid_string,message:u.message}),i.dirty()}else u.kind==="regex"?(u.regex.lastIndex=0,u.regex.test(a.data)||(c=this._getOrReturnCtx(a,c),Et(c,{validation:"regex",code:ht.invalid_string,message:u.message}),i.dirty())):u.kind==="trim"?a.data=a.data.trim():u.kind==="includes"?a.data.includes(u.value,u.position)||(c=this._getOrReturnCtx(a,c),Et(c,{code:ht.invalid_string,validation:{includes:u.value,position:u.position},message:u.message}),i.dirty()):u.kind==="toLowerCase"?a.data=a.data.toLowerCase():u.kind==="toUpperCase"?a.data=a.data.toUpperCase():u.kind==="startsWith"?a.data.startsWith(u.value)||(c=this._getOrReturnCtx(a,c),Et(c,{code:ht.invalid_string,validation:{startsWith:u.value},message:u.message}),i.dirty()):u.kind==="endsWith"?a.data.endsWith(u.value)||(c=this._getOrReturnCtx(a,c),Et(c,{code:ht.invalid_string,validation:{endsWith:u.value},message:u.message}),i.dirty()):u.kind==="datetime"?Tb(u).test(a.data)||(c=this._getOrReturnCtx(a,c),Et(c,{code:ht.invalid_string,validation:"datetime",message:u.message}),i.dirty()):u.kind==="date"?Aw.test(a.data)||(c=this._getOrReturnCtx(a,c),Et(c,{code:ht.invalid_string,validation:"date",message:u.message}),i.dirty()):u.kind==="time"?Tw(u).test(a.data)||(c=this._getOrReturnCtx(a,c),Et(c,{code:ht.invalid_string,validation:"time",message:u.message}),i.dirty()):u.kind==="duration"?xw.test(a.data)||(c=this._getOrReturnCtx(a,c),Et(c,{validation:"duration",code:ht.invalid_string,message:u.message}),i.dirty()):u.kind==="ip"?Cw(a.data,u.version)||(c=this._getOrReturnCtx(a,c),Et(c,{validation:"ip",code:ht.invalid_string,message:u.message}),i.dirty()):u.kind==="base64"?kw.test(a.data)||(c=this._getOrReturnCtx(a,c),Et(c,{validation:"base64",code:ht.invalid_string,message:u.message}),i.dirty()):Sn.assertNever(u);return{status:i.value,value:a.data}}_regex(a,s,i){return this.refinement(c=>a.test(c),{validation:s,code:ht.invalid_string,...Ut.errToObj(i)})}_addCheck(a){return new fs({...this._def,checks:[...this._def.checks,a]})}email(a){return this._addCheck({kind:"email",...Ut.errToObj(a)})}url(a){return this._addCheck({kind:"url",...Ut.errToObj(a)})}emoji(a){return this._addCheck({kind:"emoji",...Ut.errToObj(a)})}uuid(a){return this._addCheck({kind:"uuid",...Ut.errToObj(a)})}nanoid(a){return this._addCheck({kind:"nanoid",...Ut.errToObj(a)})}cuid(a){return this._addCheck({kind:"cuid",...Ut.errToObj(a)})}cuid2(a){return this._addCheck({kind:"cuid2",...Ut.errToObj(a)})}ulid(a){return this._addCheck({kind:"ulid",...Ut.errToObj(a)})}base64(a){return this._addCheck({kind:"base64",...Ut.errToObj(a)})}ip(a){return this._addCheck({kind:"ip",...Ut.errToObj(a)})}datetime(a){var s,i;return typeof a=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:a}):this._addCheck({kind:"datetime",precision:typeof(a==null?void 0:a.precision)>"u"?null:a==null?void 0:a.precision,offset:(s=a==null?void 0:a.offset)!==null&&s!==void 0?s:!1,local:(i=a==null?void 0:a.local)!==null&&i!==void 0?i:!1,...Ut.errToObj(a==null?void 0:a.message)})}date(a){return this._addCheck({kind:"date",message:a})}time(a){return typeof a=="string"?this._addCheck({kind:"time",precision:null,message:a}):this._addCheck({kind:"time",precision:typeof(a==null?void 0:a.precision)>"u"?null:a==null?void 0:a.precision,...Ut.errToObj(a==null?void 0:a.message)})}duration(a){return this._addCheck({kind:"duration",...Ut.errToObj(a)})}regex(a,s){return this._addCheck({kind:"regex",regex:a,...Ut.errToObj(s)})}includes(a,s){return this._addCheck({kind:"includes",value:a,position:s==null?void 0:s.position,...Ut.errToObj(s==null?void 0:s.message)})}startsWith(a,s){return this._addCheck({kind:"startsWith",value:a,...Ut.errToObj(s)})}endsWith(a,s){return this._addCheck({kind:"endsWith",value:a,...Ut.errToObj(s)})}min(a,s){return this._addCheck({kind:"min",value:a,...Ut.errToObj(s)})}max(a,s){return this._addCheck({kind:"max",value:a,...Ut.errToObj(s)})}length(a,s){return this._addCheck({kind:"length",value:a,...Ut.errToObj(s)})}nonempty(a){return this.min(1,Ut.errToObj(a))}trim(){return new fs({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new fs({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new fs({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(a=>a.kind==="datetime")}get isDate(){return!!this._def.checks.find(a=>a.kind==="date")}get isTime(){return!!this._def.checks.find(a=>a.kind==="time")}get isDuration(){return!!this._def.checks.find(a=>a.kind==="duration")}get isEmail(){return!!this._def.checks.find(a=>a.kind==="email")}get isURL(){return!!this._def.checks.find(a=>a.kind==="url")}get isEmoji(){return!!this._def.checks.find(a=>a.kind==="emoji")}get isUUID(){return!!this._def.checks.find(a=>a.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(a=>a.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(a=>a.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(a=>a.kind==="cuid2")}get isULID(){return!!this._def.checks.find(a=>a.kind==="ulid")}get isIP(){return!!this._def.checks.find(a=>a.kind==="ip")}get isBase64(){return!!this._def.checks.find(a=>a.kind==="base64")}get minLength(){let a=null;for(const s of this._def.checks)s.kind==="min"&&(a===null||s.value>a)&&(a=s.value);return a}get maxLength(){let a=null;for(const s of this._def.checks)s.kind==="max"&&(a===null||s.value<a)&&(a=s.value);return a}}fs.create=n=>{var a;return new fs({checks:[],typeName:Gt.ZodString,coerce:(a=n==null?void 0:n.coerce)!==null&&a!==void 0?a:!1,...sn(n)})};function Nw(n,a){const s=(n.toString().split(".")[1]||"").length,i=(a.toString().split(".")[1]||"").length,c=s>i?s:i,u=parseInt(n.toFixed(c).replace(".","")),f=parseInt(a.toFixed(c).replace(".",""));return u%f/Math.pow(10,c)}class Vi extends un{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(a){if(this._def.coerce&&(a.data=Number(a.data)),this._getType(a)!==Tt.number){const u=this._getOrReturnCtx(a);return Et(u,{code:ht.invalid_type,expected:Tt.number,received:u.parsedType}),Kt}let i;const c=new ra;for(const u of this._def.checks)u.kind==="int"?Sn.isInteger(a.data)||(i=this._getOrReturnCtx(a,i),Et(i,{code:ht.invalid_type,expected:"integer",received:"float",message:u.message}),c.dirty()):u.kind==="min"?(u.inclusive?a.data<u.value:a.data<=u.value)&&(i=this._getOrReturnCtx(a,i),Et(i,{code:ht.too_small,minimum:u.value,type:"number",inclusive:u.inclusive,exact:!1,message:u.message}),c.dirty()):u.kind==="max"?(u.inclusive?a.data>u.value:a.data>=u.value)&&(i=this._getOrReturnCtx(a,i),Et(i,{code:ht.too_big,maximum:u.value,type:"number",inclusive:u.inclusive,exact:!1,message:u.message}),c.dirty()):u.kind==="multipleOf"?Nw(a.data,u.value)!==0&&(i=this._getOrReturnCtx(a,i),Et(i,{code:ht.not_multiple_of,multipleOf:u.value,message:u.message}),c.dirty()):u.kind==="finite"?Number.isFinite(a.data)||(i=this._getOrReturnCtx(a,i),Et(i,{code:ht.not_finite,message:u.message}),c.dirty()):Sn.assertNever(u);return{status:c.value,value:a.data}}gte(a,s){return this.setLimit("min",a,!0,Ut.toString(s))}gt(a,s){return this.setLimit("min",a,!1,Ut.toString(s))}lte(a,s){return this.setLimit("max",a,!0,Ut.toString(s))}lt(a,s){return this.setLimit("max",a,!1,Ut.toString(s))}setLimit(a,s,i,c){return new Vi({...this._def,checks:[...this._def.checks,{kind:a,value:s,inclusive:i,message:Ut.toString(c)}]})}_addCheck(a){return new Vi({...this._def,checks:[...this._def.checks,a]})}int(a){return this._addCheck({kind:"int",message:Ut.toString(a)})}positive(a){return this._addCheck({kind:"min",value:0,inclusive:!1,message:Ut.toString(a)})}negative(a){return this._addCheck({kind:"max",value:0,inclusive:!1,message:Ut.toString(a)})}nonpositive(a){return this._addCheck({kind:"max",value:0,inclusive:!0,message:Ut.toString(a)})}nonnegative(a){return this._addCheck({kind:"min",value:0,inclusive:!0,message:Ut.toString(a)})}multipleOf(a,s){return this._addCheck({kind:"multipleOf",value:a,message:Ut.toString(s)})}finite(a){return this._addCheck({kind:"finite",message:Ut.toString(a)})}safe(a){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:Ut.toString(a)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:Ut.toString(a)})}get minValue(){let a=null;for(const s of this._def.checks)s.kind==="min"&&(a===null||s.value>a)&&(a=s.value);return a}get maxValue(){let a=null;for(const s of this._def.checks)s.kind==="max"&&(a===null||s.value<a)&&(a=s.value);return a}get isInt(){return!!this._def.checks.find(a=>a.kind==="int"||a.kind==="multipleOf"&&Sn.isInteger(a.value))}get isFinite(){let a=null,s=null;for(const i of this._def.checks){if(i.kind==="finite"||i.kind==="int"||i.kind==="multipleOf")return!0;i.kind==="min"?(s===null||i.value>s)&&(s=i.value):i.kind==="max"&&(a===null||i.value<a)&&(a=i.value)}return Number.isFinite(s)&&Number.isFinite(a)}}Vi.create=n=>new Vi({checks:[],typeName:Gt.ZodNumber,coerce:(n==null?void 0:n.coerce)||!1,...sn(n)});class Zi extends un{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(a){if(this._def.coerce&&(a.data=BigInt(a.data)),this._getType(a)!==Tt.bigint){const u=this._getOrReturnCtx(a);return Et(u,{code:ht.invalid_type,expected:Tt.bigint,received:u.parsedType}),Kt}let i;const c=new ra;for(const u of this._def.checks)u.kind==="min"?(u.inclusive?a.data<u.value:a.data<=u.value)&&(i=this._getOrReturnCtx(a,i),Et(i,{code:ht.too_small,type:"bigint",minimum:u.value,inclusive:u.inclusive,message:u.message}),c.dirty()):u.kind==="max"?(u.inclusive?a.data>u.value:a.data>=u.value)&&(i=this._getOrReturnCtx(a,i),Et(i,{code:ht.too_big,type:"bigint",maximum:u.value,inclusive:u.inclusive,message:u.message}),c.dirty()):u.kind==="multipleOf"?a.data%u.value!==BigInt(0)&&(i=this._getOrReturnCtx(a,i),Et(i,{code:ht.not_multiple_of,multipleOf:u.value,message:u.message}),c.dirty()):Sn.assertNever(u);return{status:c.value,value:a.data}}gte(a,s){return this.setLimit("min",a,!0,Ut.toString(s))}gt(a,s){return this.setLimit("min",a,!1,Ut.toString(s))}lte(a,s){return this.setLimit("max",a,!0,Ut.toString(s))}lt(a,s){return this.setLimit("max",a,!1,Ut.toString(s))}setLimit(a,s,i,c){return new Zi({...this._def,checks:[...this._def.checks,{kind:a,value:s,inclusive:i,message:Ut.toString(c)}]})}_addCheck(a){return new Zi({...this._def,checks:[...this._def.checks,a]})}positive(a){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:Ut.toString(a)})}negative(a){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:Ut.toString(a)})}nonpositive(a){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:Ut.toString(a)})}nonnegative(a){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:Ut.toString(a)})}multipleOf(a,s){return this._addCheck({kind:"multipleOf",value:a,message:Ut.toString(s)})}get minValue(){let a=null;for(const s of this._def.checks)s.kind==="min"&&(a===null||s.value>a)&&(a=s.value);return a}get maxValue(){let a=null;for(const s of this._def.checks)s.kind==="max"&&(a===null||s.value<a)&&(a=s.value);return a}}Zi.create=n=>{var a;return new Zi({checks:[],typeName:Gt.ZodBigInt,coerce:(a=n==null?void 0:n.coerce)!==null&&a!==void 0?a:!1,...sn(n)})};class kc extends un{_parse(a){if(this._def.coerce&&(a.data=!!a.data),this._getType(a)!==Tt.boolean){const i=this._getOrReturnCtx(a);return Et(i,{code:ht.invalid_type,expected:Tt.boolean,received:i.parsedType}),Kt}return la(a.data)}}kc.create=n=>new kc({typeName:Gt.ZodBoolean,coerce:(n==null?void 0:n.coerce)||!1,...sn(n)});class Ao extends un{_parse(a){if(this._def.coerce&&(a.data=new Date(a.data)),this._getType(a)!==Tt.date){const u=this._getOrReturnCtx(a);return Et(u,{code:ht.invalid_type,expected:Tt.date,received:u.parsedType}),Kt}if(isNaN(a.data.getTime())){const u=this._getOrReturnCtx(a);return Et(u,{code:ht.invalid_date}),Kt}const i=new ra;let c;for(const u of this._def.checks)u.kind==="min"?a.data.getTime()<u.value&&(c=this._getOrReturnCtx(a,c),Et(c,{code:ht.too_small,message:u.message,inclusive:!0,exact:!1,minimum:u.value,type:"date"}),i.dirty()):u.kind==="max"?a.data.getTime()>u.value&&(c=this._getOrReturnCtx(a,c),Et(c,{code:ht.too_big,message:u.message,inclusive:!0,exact:!1,maximum:u.value,type:"date"}),i.dirty()):Sn.assertNever(u);return{status:i.value,value:new Date(a.data.getTime())}}_addCheck(a){return new Ao({...this._def,checks:[...this._def.checks,a]})}min(a,s){return this._addCheck({kind:"min",value:a.getTime(),message:Ut.toString(s)})}max(a,s){return this._addCheck({kind:"max",value:a.getTime(),message:Ut.toString(s)})}get minDate(){let a=null;for(const s of this._def.checks)s.kind==="min"&&(a===null||s.value>a)&&(a=s.value);return a!=null?new Date(a):null}get maxDate(){let a=null;for(const s of this._def.checks)s.kind==="max"&&(a===null||s.value<a)&&(a=s.value);return a!=null?new Date(a):null}}Ao.create=n=>new Ao({checks:[],coerce:(n==null?void 0:n.coerce)||!1,typeName:Gt.ZodDate,...sn(n)});class cd extends un{_parse(a){if(this._getType(a)!==Tt.symbol){const i=this._getOrReturnCtx(a);return Et(i,{code:ht.invalid_type,expected:Tt.symbol,received:i.parsedType}),Kt}return la(a.data)}}cd.create=n=>new cd({typeName:Gt.ZodSymbol,...sn(n)});class Ac extends un{_parse(a){if(this._getType(a)!==Tt.undefined){const i=this._getOrReturnCtx(a);return Et(i,{code:ht.invalid_type,expected:Tt.undefined,received:i.parsedType}),Kt}return la(a.data)}}Ac.create=n=>new Ac({typeName:Gt.ZodUndefined,...sn(n)});class Tc extends un{_parse(a){if(this._getType(a)!==Tt.null){const i=this._getOrReturnCtx(a);return Et(i,{code:ht.invalid_type,expected:Tt.null,received:i.parsedType}),Kt}return la(a.data)}}Tc.create=n=>new Tc({typeName:Gt.ZodNull,...sn(n)});class bl extends un{constructor(){super(...arguments),this._any=!0}_parse(a){return la(a.data)}}bl.create=n=>new bl({typeName:Gt.ZodAny,...sn(n)});class Eo extends un{constructor(){super(...arguments),this._unknown=!0}_parse(a){return la(a.data)}}Eo.create=n=>new Eo({typeName:Gt.ZodUnknown,...sn(n)});class ai extends un{_parse(a){const s=this._getOrReturnCtx(a);return Et(s,{code:ht.invalid_type,expected:Tt.never,received:s.parsedType}),Kt}}ai.create=n=>new ai({typeName:Gt.ZodNever,...sn(n)});class ud extends un{_parse(a){if(this._getType(a)!==Tt.undefined){const i=this._getOrReturnCtx(a);return Et(i,{code:ht.invalid_type,expected:Tt.void,received:i.parsedType}),Kt}return la(a.data)}}ud.create=n=>new ud({typeName:Gt.ZodVoid,...sn(n)});class hs extends un{_parse(a){const{ctx:s,status:i}=this._processInputParams(a),c=this._def;if(s.parsedType!==Tt.array)return Et(s,{code:ht.invalid_type,expected:Tt.array,received:s.parsedType}),Kt;if(c.exactLength!==null){const f=s.data.length>c.exactLength.value,p=s.data.length<c.exactLength.value;(f||p)&&(Et(s,{code:f?ht.too_big:ht.too_small,minimum:p?c.exactLength.value:void 0,maximum:f?c.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:c.exactLength.message}),i.dirty())}if(c.minLength!==null&&s.data.length<c.minLength.value&&(Et(s,{code:ht.too_small,minimum:c.minLength.value,type:"array",inclusive:!0,exact:!1,message:c.minLength.message}),i.dirty()),c.maxLength!==null&&s.data.length>c.maxLength.value&&(Et(s,{code:ht.too_big,maximum:c.maxLength.value,type:"array",inclusive:!0,exact:!1,message:c.maxLength.message}),i.dirty()),s.common.async)return Promise.all([...s.data].map((f,p)=>c.type._parseAsync(new js(s,f,s.path,p)))).then(f=>ra.mergeArray(i,f));const u=[...s.data].map((f,p)=>c.type._parseSync(new js(s,f,s.path,p)));return ra.mergeArray(i,u)}get element(){return this._def.type}min(a,s){return new hs({...this._def,minLength:{value:a,message:Ut.toString(s)}})}max(a,s){return new hs({...this._def,maxLength:{value:a,message:Ut.toString(s)}})}length(a,s){return new hs({...this._def,exactLength:{value:a,message:Ut.toString(s)}})}nonempty(a){return this.min(1,a)}}hs.create=(n,a)=>new hs({type:n,minLength:null,maxLength:null,exactLength:null,typeName:Gt.ZodArray,...sn(a)});function cl(n){if(n instanceof ir){const a={};for(const s in n.shape){const i=n.shape[s];a[s]=Os.create(cl(i))}return new ir({...n._def,shape:()=>a})}else return n instanceof hs?new hs({...n._def,type:cl(n.element)}):n instanceof Os?Os.create(cl(n.unwrap())):n instanceof Ji?Ji.create(cl(n.unwrap())):n instanceof Is?Is.create(n.items.map(a=>cl(a))):n}class ir extends un{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;const a=this._def.shape(),s=Sn.objectKeys(a);return this._cached={shape:a,keys:s}}_parse(a){if(this._getType(a)!==Tt.object){const m=this._getOrReturnCtx(a);return Et(m,{code:ht.invalid_type,expected:Tt.object,received:m.parsedType}),Kt}const{status:i,ctx:c}=this._processInputParams(a),{shape:u,keys:f}=this._getCached(),p=[];if(!(this._def.catchall instanceof ai&&this._def.unknownKeys==="strip"))for(const m in c.data)f.includes(m)||p.push(m);const b=[];for(const m of f){const _=u[m],E=c.data[m];b.push({key:{status:"valid",value:m},value:_._parse(new js(c,E,c.path,m)),alwaysSet:m in c.data})}if(this._def.catchall instanceof ai){const m=this._def.unknownKeys;if(m==="passthrough")for(const _ of p)b.push({key:{status:"valid",value:_},value:{status:"valid",value:c.data[_]}});else if(m==="strict")p.length>0&&(Et(c,{code:ht.unrecognized_keys,keys:p}),i.dirty());else if(m!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const m=this._def.catchall;for(const _ of p){const E=c.data[_];b.push({key:{status:"valid",value:_},value:m._parse(new js(c,E,c.path,_)),alwaysSet:_ in c.data})}}return c.common.async?Promise.resolve().then(async()=>{const m=[];for(const _ of b){const E=await _.key,N=await _.value;m.push({key:E,value:N,alwaysSet:_.alwaysSet})}return m}).then(m=>ra.mergeObjectSync(i,m)):ra.mergeObjectSync(i,b)}get shape(){return this._def.shape()}strict(a){return Ut.errToObj,new ir({...this._def,unknownKeys:"strict",...a!==void 0?{errorMap:(s,i)=>{var c,u,f,p;const b=(f=(u=(c=this._def).errorMap)===null||u===void 0?void 0:u.call(c,s,i).message)!==null&&f!==void 0?f:i.defaultError;return s.code==="unrecognized_keys"?{message:(p=Ut.errToObj(a).message)!==null&&p!==void 0?p:b}:{message:b}}}:{}})}strip(){return new ir({...this._def,unknownKeys:"strip"})}passthrough(){return new ir({...this._def,unknownKeys:"passthrough"})}extend(a){return new ir({...this._def,shape:()=>({...this._def.shape(),...a})})}merge(a){return new ir({unknownKeys:a._def.unknownKeys,catchall:a._def.catchall,shape:()=>({...this._def.shape(),...a._def.shape()}),typeName:Gt.ZodObject})}setKey(a,s){return this.augment({[a]:s})}catchall(a){return new ir({...this._def,catchall:a})}pick(a){const s={};return Sn.objectKeys(a).forEach(i=>{a[i]&&this.shape[i]&&(s[i]=this.shape[i])}),new ir({...this._def,shape:()=>s})}omit(a){const s={};return Sn.objectKeys(this.shape).forEach(i=>{a[i]||(s[i]=this.shape[i])}),new ir({...this._def,shape:()=>s})}deepPartial(){return cl(this)}partial(a){const s={};return Sn.objectKeys(this.shape).forEach(i=>{const c=this.shape[i];a&&!a[i]?s[i]=c:s[i]=c.optional()}),new ir({...this._def,shape:()=>s})}required(a){const s={};return Sn.objectKeys(this.shape).forEach(i=>{if(a&&!a[i])s[i]=this.shape[i];else{let u=this.shape[i];for(;u instanceof Os;)u=u._def.innerType;s[i]=u}}),new ir({...this._def,shape:()=>s})}keyof(){return Cb(Sn.objectKeys(this.shape))}}ir.create=(n,a)=>new ir({shape:()=>n,unknownKeys:"strip",catchall:ai.create(),typeName:Gt.ZodObject,...sn(a)});ir.strictCreate=(n,a)=>new ir({shape:()=>n,unknownKeys:"strict",catchall:ai.create(),typeName:Gt.ZodObject,...sn(a)});ir.lazycreate=(n,a)=>new ir({shape:n,unknownKeys:"strip",catchall:ai.create(),typeName:Gt.ZodObject,...sn(a)});class Cc extends un{_parse(a){const{ctx:s}=this._processInputParams(a),i=this._def.options;function c(u){for(const p of u)if(p.result.status==="valid")return p.result;for(const p of u)if(p.result.status==="dirty")return s.common.issues.push(...p.ctx.common.issues),p.result;const f=u.map(p=>new Ba(p.ctx.common.issues));return Et(s,{code:ht.invalid_union,unionErrors:f}),Kt}if(s.common.async)return Promise.all(i.map(async u=>{const f={...s,common:{...s.common,issues:[]},parent:null};return{result:await u._parseAsync({data:s.data,path:s.path,parent:f}),ctx:f}})).then(c);{let u;const f=[];for(const b of i){const m={...s,common:{...s.common,issues:[]},parent:null},_=b._parseSync({data:s.data,path:s.path,parent:m});if(_.status==="valid")return _;_.status==="dirty"&&!u&&(u={result:_,ctx:m}),m.common.issues.length&&f.push(m.common.issues)}if(u)return s.common.issues.push(...u.ctx.common.issues),u.result;const p=f.map(b=>new Ba(b));return Et(s,{code:ht.invalid_union,unionErrors:p}),Kt}}get options(){return this._def.options}}Cc.create=(n,a)=>new Cc({options:n,typeName:Gt.ZodUnion,...sn(a)});const ri=n=>n instanceof Oc?ri(n.schema):n instanceof ps?ri(n.innerType()):n instanceof jc?[n.value]:n instanceof Qi?n.options:n instanceof Ic?Sn.objectValues(n.enum):n instanceof Rc?ri(n._def.innerType):n instanceof Ac?[void 0]:n instanceof Tc?[null]:n instanceof Os?[void 0,...ri(n.unwrap())]:n instanceof Ji?[null,...ri(n.unwrap())]:n instanceof sp||n instanceof Uc?ri(n.unwrap()):n instanceof Mc?ri(n._def.innerType):[];class vd extends un{_parse(a){const{ctx:s}=this._processInputParams(a);if(s.parsedType!==Tt.object)return Et(s,{code:ht.invalid_type,expected:Tt.object,received:s.parsedType}),Kt;const i=this.discriminator,c=s.data[i],u=this.optionsMap.get(c);return u?s.common.async?u._parseAsync({data:s.data,path:s.path,parent:s}):u._parseSync({data:s.data,path:s.path,parent:s}):(Et(s,{code:ht.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[i]}),Kt)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(a,s,i){const c=new Map;for(const u of s){const f=ri(u.shape[a]);if(!f.length)throw new Error(`A discriminator value for key \`${a}\` could not be extracted from all schema options`);for(const p of f){if(c.has(p))throw new Error(`Discriminator property ${String(a)} has duplicate value ${String(p)}`);c.set(p,u)}}return new vd({typeName:Gt.ZodDiscriminatedUnion,discriminator:a,options:s,optionsMap:c,...sn(i)})}}function Gh(n,a){const s=Ki(n),i=Ki(a);if(n===a)return{valid:!0,data:n};if(s===Tt.object&&i===Tt.object){const c=Sn.objectKeys(a),u=Sn.objectKeys(n).filter(p=>c.indexOf(p)!==-1),f={...n,...a};for(const p of u){const b=Gh(n[p],a[p]);if(!b.valid)return{valid:!1};f[p]=b.data}return{valid:!0,data:f}}else if(s===Tt.array&&i===Tt.array){if(n.length!==a.length)return{valid:!1};const c=[];for(let u=0;u<n.length;u++){const f=n[u],p=a[u],b=Gh(f,p);if(!b.valid)return{valid:!1};c.push(b.data)}return{valid:!0,data:c}}else return s===Tt.date&&i===Tt.date&&+n==+a?{valid:!0,data:n}:{valid:!1}}class Nc extends un{_parse(a){const{status:s,ctx:i}=this._processInputParams(a),c=(u,f)=>{if(Ph(u)||Ph(f))return Kt;const p=Gh(u.value,f.value);return p.valid?((qh(u)||qh(f))&&s.dirty(),{status:s.value,value:p.data}):(Et(i,{code:ht.invalid_intersection_types}),Kt)};return i.common.async?Promise.all([this._def.left._parseAsync({data:i.data,path:i.path,parent:i}),this._def.right._parseAsync({data:i.data,path:i.path,parent:i})]).then(([u,f])=>c(u,f)):c(this._def.left._parseSync({data:i.data,path:i.path,parent:i}),this._def.right._parseSync({data:i.data,path:i.path,parent:i}))}}Nc.create=(n,a,s)=>new Nc({left:n,right:a,typeName:Gt.ZodIntersection,...sn(s)});class Is extends un{_parse(a){const{status:s,ctx:i}=this._processInputParams(a);if(i.parsedType!==Tt.array)return Et(i,{code:ht.invalid_type,expected:Tt.array,received:i.parsedType}),Kt;if(i.data.length<this._def.items.length)return Et(i,{code:ht.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),Kt;!this._def.rest&&i.data.length>this._def.items.length&&(Et(i,{code:ht.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),s.dirty());const u=[...i.data].map((f,p)=>{const b=this._def.items[p]||this._def.rest;return b?b._parse(new js(i,f,i.path,p)):null}).filter(f=>!!f);return i.common.async?Promise.all(u).then(f=>ra.mergeArray(s,f)):ra.mergeArray(s,u)}get items(){return this._def.items}rest(a){return new Is({...this._def,rest:a})}}Is.create=(n,a)=>{if(!Array.isArray(n))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new Is({items:n,typeName:Gt.ZodTuple,rest:null,...sn(a)})};class Dc extends un{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(a){const{status:s,ctx:i}=this._processInputParams(a);if(i.parsedType!==Tt.object)return Et(i,{code:ht.invalid_type,expected:Tt.object,received:i.parsedType}),Kt;const c=[],u=this._def.keyType,f=this._def.valueType;for(const p in i.data)c.push({key:u._parse(new js(i,p,i.path,p)),value:f._parse(new js(i,i.data[p],i.path,p)),alwaysSet:p in i.data});return i.common.async?ra.mergeObjectAsync(s,c):ra.mergeObjectSync(s,c)}get element(){return this._def.valueType}static create(a,s,i){return s instanceof un?new Dc({keyType:a,valueType:s,typeName:Gt.ZodRecord,...sn(i)}):new Dc({keyType:fs.create(),valueType:a,typeName:Gt.ZodRecord,...sn(s)})}}class dd extends un{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(a){const{status:s,ctx:i}=this._processInputParams(a);if(i.parsedType!==Tt.map)return Et(i,{code:ht.invalid_type,expected:Tt.map,received:i.parsedType}),Kt;const c=this._def.keyType,u=this._def.valueType,f=[...i.data.entries()].map(([p,b],m)=>({key:c._parse(new js(i,p,i.path,[m,"key"])),value:u._parse(new js(i,b,i.path,[m,"value"]))}));if(i.common.async){const p=new Map;return Promise.resolve().then(async()=>{for(const b of f){const m=await b.key,_=await b.value;if(m.status==="aborted"||_.status==="aborted")return Kt;(m.status==="dirty"||_.status==="dirty")&&s.dirty(),p.set(m.value,_.value)}return{status:s.value,value:p}})}else{const p=new Map;for(const b of f){const m=b.key,_=b.value;if(m.status==="aborted"||_.status==="aborted")return Kt;(m.status==="dirty"||_.status==="dirty")&&s.dirty(),p.set(m.value,_.value)}return{status:s.value,value:p}}}}dd.create=(n,a,s)=>new dd({valueType:a,keyType:n,typeName:Gt.ZodMap,...sn(s)});class To extends un{_parse(a){const{status:s,ctx:i}=this._processInputParams(a);if(i.parsedType!==Tt.set)return Et(i,{code:ht.invalid_type,expected:Tt.set,received:i.parsedType}),Kt;const c=this._def;c.minSize!==null&&i.data.size<c.minSize.value&&(Et(i,{code:ht.too_small,minimum:c.minSize.value,type:"set",inclusive:!0,exact:!1,message:c.minSize.message}),s.dirty()),c.maxSize!==null&&i.data.size>c.maxSize.value&&(Et(i,{code:ht.too_big,maximum:c.maxSize.value,type:"set",inclusive:!0,exact:!1,message:c.maxSize.message}),s.dirty());const u=this._def.valueType;function f(b){const m=new Set;for(const _ of b){if(_.status==="aborted")return Kt;_.status==="dirty"&&s.dirty(),m.add(_.value)}return{status:s.value,value:m}}const p=[...i.data.values()].map((b,m)=>u._parse(new js(i,b,i.path,m)));return i.common.async?Promise.all(p).then(b=>f(b)):f(p)}min(a,s){return new To({...this._def,minSize:{value:a,message:Ut.toString(s)}})}max(a,s){return new To({...this._def,maxSize:{value:a,message:Ut.toString(s)}})}size(a,s){return this.min(a,s).max(a,s)}nonempty(a){return this.min(1,a)}}To.create=(n,a)=>new To({valueType:n,minSize:null,maxSize:null,typeName:Gt.ZodSet,...sn(a)});class ml extends un{constructor(){super(...arguments),this.validate=this.implement}_parse(a){const{ctx:s}=this._processInputParams(a);if(s.parsedType!==Tt.function)return Et(s,{code:ht.invalid_type,expected:Tt.function,received:s.parsedType}),Kt;function i(p,b){return od({data:p,path:s.path,errorMaps:[s.common.contextualErrorMap,s.schemaErrorMap,id(),vl].filter(m=>!!m),issueData:{code:ht.invalid_arguments,argumentsError:b}})}function c(p,b){return od({data:p,path:s.path,errorMaps:[s.common.contextualErrorMap,s.schemaErrorMap,id(),vl].filter(m=>!!m),issueData:{code:ht.invalid_return_type,returnTypeError:b}})}const u={errorMap:s.common.contextualErrorMap},f=s.data;if(this._def.returns instanceof xl){const p=this;return la(async function(...b){const m=new Ba([]),_=await p._def.args.parseAsync(b,u).catch(S=>{throw m.addIssue(i(b,S)),m}),E=await Reflect.apply(f,this,_);return await p._def.returns._def.type.parseAsync(E,u).catch(S=>{throw m.addIssue(c(E,S)),m})})}else{const p=this;return la(function(...b){const m=p._def.args.safeParse(b,u);if(!m.success)throw new Ba([i(b,m.error)]);const _=Reflect.apply(f,this,m.data),E=p._def.returns.safeParse(_,u);if(!E.success)throw new Ba([c(_,E.error)]);return E.data})}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...a){return new ml({...this._def,args:Is.create(a).rest(Eo.create())})}returns(a){return new ml({...this._def,returns:a})}implement(a){return this.parse(a)}strictImplement(a){return this.parse(a)}static create(a,s,i){return new ml({args:a||Is.create([]).rest(Eo.create()),returns:s||Eo.create(),typeName:Gt.ZodFunction,...sn(i)})}}class Oc extends un{get schema(){return this._def.getter()}_parse(a){const{ctx:s}=this._processInputParams(a);return this._def.getter()._parse({data:s.data,path:s.path,parent:s})}}Oc.create=(n,a)=>new Oc({getter:n,typeName:Gt.ZodLazy,...sn(a)});class jc extends un{_parse(a){if(a.data!==this._def.value){const s=this._getOrReturnCtx(a);return Et(s,{received:s.data,code:ht.invalid_literal,expected:this._def.value}),Kt}return{status:"valid",value:a.data}}get value(){return this._def.value}}jc.create=(n,a)=>new jc({value:n,typeName:Gt.ZodLiteral,...sn(a)});function Cb(n,a){return new Qi({values:n,typeName:Gt.ZodEnum,...sn(a)})}class Qi extends un{constructor(){super(...arguments),gc.set(this,void 0)}_parse(a){if(typeof a.data!="string"){const s=this._getOrReturnCtx(a),i=this._def.values;return Et(s,{expected:Sn.joinValues(i),received:s.parsedType,code:ht.invalid_type}),Kt}if(ld(this,gc)||Eb(this,gc,new Set(this._def.values)),!ld(this,gc).has(a.data)){const s=this._getOrReturnCtx(a),i=this._def.values;return Et(s,{received:s.data,code:ht.invalid_enum_value,options:i}),Kt}return la(a.data)}get options(){return this._def.values}get enum(){const a={};for(const s of this._def.values)a[s]=s;return a}get Values(){const a={};for(const s of this._def.values)a[s]=s;return a}get Enum(){const a={};for(const s of this._def.values)a[s]=s;return a}extract(a,s=this._def){return Qi.create(a,{...this._def,...s})}exclude(a,s=this._def){return Qi.create(this.options.filter(i=>!a.includes(i)),{...this._def,...s})}}gc=new WeakMap;Qi.create=Cb;class Ic extends un{constructor(){super(...arguments),yc.set(this,void 0)}_parse(a){const s=Sn.getValidEnumValues(this._def.values),i=this._getOrReturnCtx(a);if(i.parsedType!==Tt.string&&i.parsedType!==Tt.number){const c=Sn.objectValues(s);return Et(i,{expected:Sn.joinValues(c),received:i.parsedType,code:ht.invalid_type}),Kt}if(ld(this,yc)||Eb(this,yc,new Set(Sn.getValidEnumValues(this._def.values))),!ld(this,yc).has(a.data)){const c=Sn.objectValues(s);return Et(i,{received:i.data,code:ht.invalid_enum_value,options:c}),Kt}return la(a.data)}get enum(){return this._def.values}}yc=new WeakMap;Ic.create=(n,a)=>new Ic({values:n,typeName:Gt.ZodNativeEnum,...sn(a)});class xl extends un{unwrap(){return this._def.type}_parse(a){const{ctx:s}=this._processInputParams(a);if(s.parsedType!==Tt.promise&&s.common.async===!1)return Et(s,{code:ht.invalid_type,expected:Tt.promise,received:s.parsedType}),Kt;const i=s.parsedType===Tt.promise?s.data:Promise.resolve(s.data);return la(i.then(c=>this._def.type.parseAsync(c,{path:s.path,errorMap:s.common.contextualErrorMap})))}}xl.create=(n,a)=>new xl({type:n,typeName:Gt.ZodPromise,...sn(a)});class ps extends un{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===Gt.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(a){const{status:s,ctx:i}=this._processInputParams(a),c=this._def.effect||null,u={addIssue:f=>{Et(i,f),f.fatal?s.abort():s.dirty()},get path(){return i.path}};if(u.addIssue=u.addIssue.bind(u),c.type==="preprocess"){const f=c.transform(i.data,u);if(i.common.async)return Promise.resolve(f).then(async p=>{if(s.value==="aborted")return Kt;const b=await this._def.schema._parseAsync({data:p,path:i.path,parent:i});return b.status==="aborted"?Kt:b.status==="dirty"||s.value==="dirty"?hl(b.value):b});{if(s.value==="aborted")return Kt;const p=this._def.schema._parseSync({data:f,path:i.path,parent:i});return p.status==="aborted"?Kt:p.status==="dirty"||s.value==="dirty"?hl(p.value):p}}if(c.type==="refinement"){const f=p=>{const b=c.refinement(p,u);if(i.common.async)return Promise.resolve(b);if(b instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return p};if(i.common.async===!1){const p=this._def.schema._parseSync({data:i.data,path:i.path,parent:i});return p.status==="aborted"?Kt:(p.status==="dirty"&&s.dirty(),f(p.value),{status:s.value,value:p.value})}else return this._def.schema._parseAsync({data:i.data,path:i.path,parent:i}).then(p=>p.status==="aborted"?Kt:(p.status==="dirty"&&s.dirty(),f(p.value).then(()=>({status:s.value,value:p.value}))))}if(c.type==="transform")if(i.common.async===!1){const f=this._def.schema._parseSync({data:i.data,path:i.path,parent:i});if(!Sc(f))return f;const p=c.transform(f.value,u);if(p instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:s.value,value:p}}else return this._def.schema._parseAsync({data:i.data,path:i.path,parent:i}).then(f=>Sc(f)?Promise.resolve(c.transform(f.value,u)).then(p=>({status:s.value,value:p})):f);Sn.assertNever(c)}}ps.create=(n,a,s)=>new ps({schema:n,typeName:Gt.ZodEffects,effect:a,...sn(s)});ps.createWithPreprocess=(n,a,s)=>new ps({schema:a,effect:{type:"preprocess",transform:n},typeName:Gt.ZodEffects,...sn(s)});class Os extends un{_parse(a){return this._getType(a)===Tt.undefined?la(void 0):this._def.innerType._parse(a)}unwrap(){return this._def.innerType}}Os.create=(n,a)=>new Os({innerType:n,typeName:Gt.ZodOptional,...sn(a)});class Ji extends un{_parse(a){return this._getType(a)===Tt.null?la(null):this._def.innerType._parse(a)}unwrap(){return this._def.innerType}}Ji.create=(n,a)=>new Ji({innerType:n,typeName:Gt.ZodNullable,...sn(a)});class Rc extends un{_parse(a){const{ctx:s}=this._processInputParams(a);let i=s.data;return s.parsedType===Tt.undefined&&(i=this._def.defaultValue()),this._def.innerType._parse({data:i,path:s.path,parent:s})}removeDefault(){return this._def.innerType}}Rc.create=(n,a)=>new Rc({innerType:n,typeName:Gt.ZodDefault,defaultValue:typeof a.default=="function"?a.default:()=>a.default,...sn(a)});class Mc extends un{_parse(a){const{ctx:s}=this._processInputParams(a),i={...s,common:{...s.common,issues:[]}},c=this._def.innerType._parse({data:i.data,path:i.path,parent:{...i}});return Ec(c)?c.then(u=>({status:"valid",value:u.status==="valid"?u.value:this._def.catchValue({get error(){return new Ba(i.common.issues)},input:i.data})})):{status:"valid",value:c.status==="valid"?c.value:this._def.catchValue({get error(){return new Ba(i.common.issues)},input:i.data})}}removeCatch(){return this._def.innerType}}Mc.create=(n,a)=>new Mc({innerType:n,typeName:Gt.ZodCatch,catchValue:typeof a.catch=="function"?a.catch:()=>a.catch,...sn(a)});class fd extends un{_parse(a){if(this._getType(a)!==Tt.nan){const i=this._getOrReturnCtx(a);return Et(i,{code:ht.invalid_type,expected:Tt.nan,received:i.parsedType}),Kt}return{status:"valid",value:a.data}}}fd.create=n=>new fd({typeName:Gt.ZodNaN,...sn(n)});const Dw=Symbol("zod_brand");class sp extends un{_parse(a){const{ctx:s}=this._processInputParams(a),i=s.data;return this._def.type._parse({data:i,path:s.path,parent:s})}unwrap(){return this._def.type}}class Bc extends un{_parse(a){const{status:s,ctx:i}=this._processInputParams(a);if(i.common.async)return(async()=>{const u=await this._def.in._parseAsync({data:i.data,path:i.path,parent:i});return u.status==="aborted"?Kt:u.status==="dirty"?(s.dirty(),hl(u.value)):this._def.out._parseAsync({data:u.value,path:i.path,parent:i})})();{const c=this._def.in._parseSync({data:i.data,path:i.path,parent:i});return c.status==="aborted"?Kt:c.status==="dirty"?(s.dirty(),{status:"dirty",value:c.value}):this._def.out._parseSync({data:c.value,path:i.path,parent:i})}}static create(a,s){return new Bc({in:a,out:s,typeName:Gt.ZodPipeline})}}class Uc extends un{_parse(a){const s=this._def.innerType._parse(a),i=c=>(Sc(c)&&(c.value=Object.freeze(c.value)),c);return Ec(s)?s.then(c=>i(c)):i(s)}unwrap(){return this._def.innerType}}Uc.create=(n,a)=>new Uc({innerType:n,typeName:Gt.ZodReadonly,...sn(a)});function Nb(n,a={},s){return n?bl.create().superRefine((i,c)=>{var u,f;if(!n(i)){const p=typeof a=="function"?a(i):typeof a=="string"?{message:a}:a,b=(f=(u=p.fatal)!==null&&u!==void 0?u:s)!==null&&f!==void 0?f:!0,m=typeof p=="string"?{message:p}:p;c.addIssue({code:"custom",...m,fatal:b})}}):bl.create()}const Ow={object:ir.lazycreate};var Gt;(function(n){n.ZodString="ZodString",n.ZodNumber="ZodNumber",n.ZodNaN="ZodNaN",n.ZodBigInt="ZodBigInt",n.ZodBoolean="ZodBoolean",n.ZodDate="ZodDate",n.ZodSymbol="ZodSymbol",n.ZodUndefined="ZodUndefined",n.ZodNull="ZodNull",n.ZodAny="ZodAny",n.ZodUnknown="ZodUnknown",n.ZodNever="ZodNever",n.ZodVoid="ZodVoid",n.ZodArray="ZodArray",n.ZodObject="ZodObject",n.ZodUnion="ZodUnion",n.ZodDiscriminatedUnion="ZodDiscriminatedUnion",n.ZodIntersection="ZodIntersection",n.ZodTuple="ZodTuple",n.ZodRecord="ZodRecord",n.ZodMap="ZodMap",n.ZodSet="ZodSet",n.ZodFunction="ZodFunction",n.ZodLazy="ZodLazy",n.ZodLiteral="ZodLiteral",n.ZodEnum="ZodEnum",n.ZodEffects="ZodEffects",n.ZodNativeEnum="ZodNativeEnum",n.ZodOptional="ZodOptional",n.ZodNullable="ZodNullable",n.ZodDefault="ZodDefault",n.ZodCatch="ZodCatch",n.ZodPromise="ZodPromise",n.ZodBranded="ZodBranded",n.ZodPipeline="ZodPipeline",n.ZodReadonly="ZodReadonly"})(Gt||(Gt={}));const jw=(n,a={message:`Input not instance of ${n.name}`})=>Nb(s=>s instanceof n,a),Db=fs.create,Ob=Vi.create,Iw=fd.create,Rw=Zi.create,jb=kc.create,Mw=Ao.create,Uw=cd.create,Lw=Ac.create,zw=Tc.create,Bw=bl.create,Fw=Eo.create,Hw=ai.create,Pw=ud.create,qw=hs.create,Gw=ir.create,Kw=ir.strictCreate,Yw=Cc.create,$w=vd.create,Vw=Nc.create,Zw=Is.create,Qw=Dc.create,Jw=dd.create,Xw=To.create,Ww=ml.create,eS=Oc.create,tS=jc.create,nS=Qi.create,rS=Ic.create,aS=xl.create,Ly=ps.create,sS=Os.create,iS=Ji.create,oS=ps.createWithPreprocess,lS=Bc.create,cS=()=>Db().optional(),uS=()=>Ob().optional(),dS=()=>jb().optional(),fS={string:(n=>fs.create({...n,coerce:!0})),number:(n=>Vi.create({...n,coerce:!0})),boolean:(n=>kc.create({...n,coerce:!0})),bigint:(n=>Zi.create({...n,coerce:!0})),date:(n=>Ao.create({...n,coerce:!0}))},hS=Kt;var we=Object.freeze({__proto__:null,defaultErrorMap:vl,setErrorMap:hw,getErrorMap:id,makeIssue:od,EMPTY_PATH:pw,addIssueToContext:Et,ParseStatus:ra,INVALID:Kt,DIRTY:hl,OK:la,isAborted:Ph,isDirty:qh,isValid:Sc,isAsync:Ec,get util(){return Sn},get objectUtil(){return Hh},ZodParsedType:Tt,getParsedType:Ki,ZodType:un,datetimeRegex:Tb,ZodString:fs,ZodNumber:Vi,ZodBigInt:Zi,ZodBoolean:kc,ZodDate:Ao,ZodSymbol:cd,ZodUndefined:Ac,ZodNull:Tc,ZodAny:bl,ZodUnknown:Eo,ZodNever:ai,ZodVoid:ud,ZodArray:hs,ZodObject:ir,ZodUnion:Cc,ZodDiscriminatedUnion:vd,ZodIntersection:Nc,ZodTuple:Is,ZodRecord:Dc,ZodMap:dd,ZodSet:To,ZodFunction:ml,ZodLazy:Oc,ZodLiteral:jc,ZodEnum:Qi,ZodNativeEnum:Ic,ZodPromise:xl,ZodEffects:ps,ZodTransformer:ps,ZodOptional:Os,ZodNullable:Ji,ZodDefault:Rc,ZodCatch:Mc,ZodNaN:fd,BRAND:Dw,ZodBranded:sp,ZodPipeline:Bc,ZodReadonly:Uc,custom:Nb,Schema:un,ZodSchema:un,late:Ow,get ZodFirstPartyTypeKind(){return Gt},coerce:fS,any:Bw,array:qw,bigint:Rw,boolean:jb,date:Mw,discriminatedUnion:$w,effect:Ly,enum:nS,function:Ww,instanceof:jw,intersection:Vw,lazy:eS,literal:tS,map:Jw,nan:Iw,nativeEnum:rS,never:Hw,null:zw,nullable:iS,number:Ob,object:Gw,oboolean:dS,onumber:uS,optional:sS,ostring:cS,pipeline:lS,preprocess:oS,promise:aS,record:Qw,set:Xw,strictObject:Kw,string:Db,symbol:Uw,transformer:Ly,tuple:Zw,undefined:Lw,union:Yw,unknown:Fw,void:Pw,NEVER:hS,ZodIssueCode:ht,quotelessJson:fw,ZodError:Ba});const Ib=we.object({id:we.union([we.string(),we.number()]).nullable().optional().transform(n=>n?String(n):crypto.randomUUID()),text:we.preprocess(n=>n??"",we.string()),explanation:we.string().nullable().optional().transform(n=>n??"")}),Rb=we.object({front:we.preprocess(n=>n??"",we.string()),back:we.preprocess(n=>n??"",we.string())}),pS=we.object({id:we.string().optional(),questionType:we.preprocess(n=>n??"multipleChoice",we.string()),questionText:we.preprocess(n=>n??"",we.string()),options:we.preprocess(n=>Array.isArray(n)?n:[],we.array(Ib)),correctAnswerId:we.preprocess(n=>n?String(n):"",we.string()),detailedExplanation:we.string().nullable().optional().transform(n=>n??""),tags:we.array(we.string()).optional(),infoCardIds:we.array(we.string()).optional(),bloomsLevel:we.string().optional()}),Mb=we.object({id:we.coerce.string(),content:we.string().nullable().optional().transform(n=>n??""),unlocksQuestionIds:we.array(we.string()).nullable().optional().transform(n=>n??[]),prerequisiteIds:we.array(we.string()).nullable().optional().transform(n=>n??[])}),mS=we.object({name:we.string(),description:we.preprocess(n=>n??"",we.string()),questions:we.array(we.any()),type:we.string().optional(),infoCards:we.array(we.any()).optional(),learningMode:we.string().optional(),curriculum:we.any().optional(),generationStatus:we.string().optional(),icon:we.string().optional()}),Ub=we.object({id:we.coerce.string(),dueDate:we.string().nullable().optional().transform(n=>n??new Date().toISOString()),interval:we.number().nullable().optional().transform(n=>n??0),easeFactor:we.number().nullable().optional().transform(n=>n??za),suspended:we.boolean().nullable().optional().transform(n=>n??!1),masteryLevel:we.number().nullable().optional().transform(n=>n??0),lastReviewed:we.string().nullable().optional(),lapses:we.number().nullable().optional().transform(n=>n??0)}),Lb=Ub.extend({front:we.string().nullable().optional().transform(n=>n??""),back:we.string().nullable().optional().transform(n=>n??""),css:we.string().nullable().optional(),frontAudio:we.string().nullable().optional(),backAudio:we.string().nullable().optional(),tags:we.array(we.string()).nullable().optional().transform(n=>n??[])}),ip=Ub.extend({questionType:we.literal("multipleChoice"),questionText:we.string().nullable().optional().transform(n=>n??""),options:we.array(Ib).nullable().optional().transform(n=>n??[]),correctAnswerId:we.string().nullable().optional().transform(n=>n??""),detailedExplanation:we.string().nullable().optional().transform(n=>n??""),tags:we.array(we.string()).nullable().optional().transform(n=>n??[]),infoCardIds:we.array(we.string()).nullable().optional().transform(n=>n??[]),userSelectedAnswerId:we.string().optional()}),op=we.object({id:we.coerce.string(),name:we.coerce.string(),description:we.string().nullable().optional().transform(n=>n??""),folderId:we.string().nullable().optional(),lastOpened:we.string().nullable().optional(),archived:we.boolean().nullable().optional(),deletedAt:we.string().nullable().optional(),lastModified:we.number().nullable().optional(),locked:we.boolean().nullable().optional(),icon:we.string().nullable().optional(),aiGenerationParams:we.any().optional(),suggestedQuestionCount:we.number().nullable().optional(),generationStatus:we.enum(["idle","generating","paused","error","complete"]).optional()}),gS=op.extend({type:we.literal(et.Flashcard),cards:we.array(Lb).nullable().optional().transform(n=>n??[])}),yS=op.extend({type:we.literal(et.Quiz),questions:we.array(ip).nullable().optional().transform(n=>n??[])}),vS=op.extend({type:we.literal(et.Learning),infoCards:we.array(Mb).nullable().optional().transform(n=>n??[]),questions:we.array(ip).nullable().optional().transform(n=>n??[]),learningMode:we.enum(["mixed","separate"]).optional().transform(n=>n??"separate"),curriculum:we.object({name:we.string(),description:we.string(),chapters:we.array(we.object({id:we.string(),title:we.string(),learningObjectives:we.array(we.string()),topics:we.array(we.string()),prerequisiteChapterIds:we.array(we.string()).optional()}))}).optional()}),bS=n=>{if(typeof n!="object"||n===null)return{id:crypto.randomUUID(),name:"Corrupted Deck Entry",type:et.Flashcard,cards:[],description:"This deck entry was corrupted in the source file."};const a={...n};a.id||(a.id=crypto.randomUUID()),a.id=String(a.id),(a.name===null||a.name===void 0)&&(a.name="Untitled Deck"),a.name=String(a.name),a.type&&typeof a.type=="string"&&(a.type=a.type.toLowerCase());const s=Object.values(et).map(c=>c.toString());(!a.type||!s.includes(a.type))&&(Array.isArray(a.infoCards)&&a.infoCards.length>0?a.type=et.Learning:Array.isArray(a.questions)&&a.questions.length>0?a.type=et.Quiz:a.type=et.Flashcard),(a.description===null||a.description===void 0)&&(a.description="");const i=c=>!c||typeof c!="object"?null:(c.id||(c.id=crypto.randomUUID()),c.id=String(c.id),a.type===et.Flashcard&&((c.front===null||c.front===void 0)&&(c.front=""),(c.back===null||c.back===void 0)&&(c.back="")),c);return Array.isArray(a.cards)?a.cards=a.cards.map(i).filter(c=>c!==null):a.cards=[],Array.isArray(a.questions)?a.questions=a.questions.map(c=>{const u=i(c);return u?(u.questionType||(u.questionType="multipleChoice"),u):null}).filter(c=>c!==null):a.questions=[],Array.isArray(a.infoCards)?a.infoCards=a.infoCards.map(i).filter(c=>c!==null):a.infoCards=[],a},xS=we.preprocess(bS,we.union([gS,yS,vS])),_S=we.object({id:we.coerce.string(),name:we.coerce.string()}),wS=we.object({title:we.string().nullable().optional().transform(n=>n??"Untitled Level"),deckIds:we.array(we.coerce.string()).nullable().optional().transform(n=>n??[])}),SS=we.object({id:we.coerce.string(),type:we.literal("series"),name:we.string(),description:we.string().nullable().optional().transform(n=>n??""),levels:we.array(wS).nullable().optional().transform(n=>n??[]),createdAt:we.string().nullable().optional().transform(n=>n??new Date().toISOString()),lastOpened:we.string().nullable().optional(),archived:we.boolean().nullable().optional(),deletedAt:we.string().nullable().optional(),lastModified:we.number().nullable().optional()}),ES=we.object({id:we.union([we.string(),we.number()]).optional(),itemId:we.coerce.string(),deckId:we.coerce.string(),seriesId:we.string().optional(),timestamp:we.string(),rating:we.nativeEnum(La).nullable().optional(),newInterval:we.number(),easeFactor:we.number(),masteryLevel:we.number().nullable().optional().transform(n=>n??0)}),kS=we.object({id:we.string(),reviewQueue:we.array(we.any()).transform(n=>Array.isArray(n)?n.map(a=>{if(!a||typeof a!="object")return null;if("questionType"in a){const i=ip.safeParse(a);return i.success?i.data:null}if("content"in a||"unlocksQuestionIds"in a){const i=Mb.safeParse(a);return i.success?i.data:null}const s=Lb.safeParse(a);return s.success?s.data:null}).filter(a=>a!==null):[]),currentIndex:we.number(),itemsCompleted:we.number().nullable().optional().transform(n=>n??0),readInfoCardIds:we.array(we.string()).optional(),unlockedQuestionIds:we.array(we.string()).optional()}),AS=we.object({id:we.string(),role:we.enum(["user","model"]),text:we.string(),actions:we.array(we.any()).optional(),isLoading:we.boolean().optional()}),TS=we.object({id:we.string(),type:we.string(),payload:we.any(),statusText:we.string().optional(),deckId:we.string().optional(),seriesId:we.string().optional()}),CS=we.object({deckId:we.string(),readInfoCardIds:we.array(we.string()).nullable().optional().transform(n=>n??[]),unlockedQuestionIds:we.array(we.string()).nullable().optional().transform(n=>n??[]),lastReadCardId:we.string().optional(),cardScrollIndices:we.record(we.string(),we.number()).nullable().optional().transform(n=>n??{})}),NS=we.object({version:we.number(),decks:we.array(xS),folders:we.array(_S).nullable().optional().transform(n=>n??[]),deckSeries:we.array(SS).nullable().optional().transform(n=>n??[]),reviews:we.array(ES).nullable().optional().transform(n=>n??[]),sessions:we.array(kS).nullable().optional().transform(n=>n??[]),seriesProgress:we.record(we.string(),we.array(we.string())).nullable().optional().transform(n=>n??{}),learningProgress:we.record(we.string(),CS).nullable().optional().transform(n=>n??{}),aiChatHistory:we.array(AS).nullable().optional().transform(n=>n??[]),aiTasks:we.array(TS).nullable().optional().transform(n=>n??[]),aiOptions:we.any().optional(),settings:we.any().optional()}),DS=we.object({title:we.string().nullable().optional().transform(n=>n??"Untitled Level"),decks:we.array(we.any())}),OS=we.object({seriesName:we.string(),seriesDescription:we.preprocess(n=>n??"",we.string()),levels:we.array(DS)});function Hu(n){throw new Error('Could not dynamically require "'+n+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var _h={exports:{}};/*!

JSZip v3.10.1 - A JavaScript class for generating and reading zip files
<http://stuartk.com/jszip>

(c) 2009-2016 Stuart Knightley <stuart [at] stuartk.com>
Dual licenced under the MIT license or GPLv3. See https://raw.github.com/Stuk/jszip/main/LICENSE.markdown.

JSZip uses the library pako released under the MIT license :
https://github.com/nodeca/pako/blob/main/LICENSE
*/var zy;function jS(){return zy||(zy=1,(function(n,a){(function(s){n.exports=s()})(function(){return(function s(i,c,u){function f(m,_){if(!c[m]){if(!i[m]){var E=typeof Hu=="function"&&Hu;if(!_&&E)return E(m,!0);if(p)return p(m,!0);var N=new Error("Cannot find module '"+m+"'");throw N.code="MODULE_NOT_FOUND",N}var S=c[m]={exports:{}};i[m][0].call(S.exports,function(I){var A=i[m][1][I];return f(A||I)},S,S.exports,s,i,c,u)}return c[m].exports}for(var p=typeof Hu=="function"&&Hu,b=0;b<u.length;b++)f(u[b]);return f})({1:[function(s,i,c){var u=s("./utils"),f=s("./support"),p="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";c.encode=function(b){for(var m,_,E,N,S,I,A,k=[],R=0,P=b.length,q=P,G=u.getTypeOf(b)!=="string";R<b.length;)q=P-R,E=G?(m=b[R++],_=R<P?b[R++]:0,R<P?b[R++]:0):(m=b.charCodeAt(R++),_=R<P?b.charCodeAt(R++):0,R<P?b.charCodeAt(R++):0),N=m>>2,S=(3&m)<<4|_>>4,I=1<q?(15&_)<<2|E>>6:64,A=2<q?63&E:64,k.push(p.charAt(N)+p.charAt(S)+p.charAt(I)+p.charAt(A));return k.join("")},c.decode=function(b){var m,_,E,N,S,I,A=0,k=0,R="data:";if(b.substr(0,R.length)===R)throw new Error("Invalid base64 input, it looks like a data url.");var P,q=3*(b=b.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(b.charAt(b.length-1)===p.charAt(64)&&q--,b.charAt(b.length-2)===p.charAt(64)&&q--,q%1!=0)throw new Error("Invalid base64 input, bad content length.");for(P=f.uint8array?new Uint8Array(0|q):new Array(0|q);A<b.length;)m=p.indexOf(b.charAt(A++))<<2|(N=p.indexOf(b.charAt(A++)))>>4,_=(15&N)<<4|(S=p.indexOf(b.charAt(A++)))>>2,E=(3&S)<<6|(I=p.indexOf(b.charAt(A++))),P[k++]=m,S!==64&&(P[k++]=_),I!==64&&(P[k++]=E);return P}},{"./support":30,"./utils":32}],2:[function(s,i,c){var u=s("./external"),f=s("./stream/DataWorker"),p=s("./stream/Crc32Probe"),b=s("./stream/DataLengthProbe");function m(_,E,N,S,I){this.compressedSize=_,this.uncompressedSize=E,this.crc32=N,this.compression=S,this.compressedContent=I}m.prototype={getContentWorker:function(){var _=new f(u.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new b("data_length")),E=this;return _.on("end",function(){if(this.streamInfo.data_length!==E.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),_},getCompressedWorker:function(){return new f(u.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},m.createWorkerFrom=function(_,E,N){return _.pipe(new p).pipe(new b("uncompressedSize")).pipe(E.compressWorker(N)).pipe(new b("compressedSize")).withStreamInfo("compression",E)},i.exports=m},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(s,i,c){var u=s("./stream/GenericWorker");c.STORE={magic:"\0\0",compressWorker:function(){return new u("STORE compression")},uncompressWorker:function(){return new u("STORE decompression")}},c.DEFLATE=s("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(s,i,c){var u=s("./utils"),f=(function(){for(var p,b=[],m=0;m<256;m++){p=m;for(var _=0;_<8;_++)p=1&p?3988292384^p>>>1:p>>>1;b[m]=p}return b})();i.exports=function(p,b){return p!==void 0&&p.length?u.getTypeOf(p)!=="string"?(function(m,_,E,N){var S=f,I=N+E;m^=-1;for(var A=N;A<I;A++)m=m>>>8^S[255&(m^_[A])];return-1^m})(0|b,p,p.length,0):(function(m,_,E,N){var S=f,I=N+E;m^=-1;for(var A=N;A<I;A++)m=m>>>8^S[255&(m^_.charCodeAt(A))];return-1^m})(0|b,p,p.length,0):0}},{"./utils":32}],5:[function(s,i,c){c.base64=!1,c.binary=!1,c.dir=!1,c.createFolders=!0,c.date=null,c.compression=null,c.compressionOptions=null,c.comment=null,c.unixPermissions=null,c.dosPermissions=null},{}],6:[function(s,i,c){var u=null;u=typeof Promise<"u"?Promise:s("lie"),i.exports={Promise:u}},{lie:37}],7:[function(s,i,c){var u=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Uint32Array<"u",f=s("pako"),p=s("./utils"),b=s("./stream/GenericWorker"),m=u?"uint8array":"array";function _(E,N){b.call(this,"FlateWorker/"+E),this._pako=null,this._pakoAction=E,this._pakoOptions=N,this.meta={}}c.magic="\b\0",p.inherits(_,b),_.prototype.processChunk=function(E){this.meta=E.meta,this._pako===null&&this._createPako(),this._pako.push(p.transformTo(m,E.data),!1)},_.prototype.flush=function(){b.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)},_.prototype.cleanUp=function(){b.prototype.cleanUp.call(this),this._pako=null},_.prototype._createPako=function(){this._pako=new f[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var E=this;this._pako.onData=function(N){E.push({data:N,meta:E.meta})}},c.compressWorker=function(E){return new _("Deflate",E)},c.uncompressWorker=function(){return new _("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(s,i,c){function u(S,I){var A,k="";for(A=0;A<I;A++)k+=String.fromCharCode(255&S),S>>>=8;return k}function f(S,I,A,k,R,P){var q,G,Y=S.file,W=S.compression,H=P!==m.utf8encode,L=p.transformTo("string",P(Y.name)),U=p.transformTo("string",m.utf8encode(Y.name)),Q=Y.comment,le=p.transformTo("string",P(Q)),F=p.transformTo("string",m.utf8encode(Q)),te=U.length!==Y.name.length,j=F.length!==Q.length,he="",J="",Z="",De=Y.dir,ve=Y.date,Be={crc32:0,compressedSize:0,uncompressedSize:0};I&&!A||(Be.crc32=S.crc32,Be.compressedSize=S.compressedSize,Be.uncompressedSize=S.uncompressedSize);var T=0;I&&(T|=8),H||!te&&!j||(T|=2048);var z=0,ne=0;De&&(z|=16),R==="UNIX"?(ne=798,z|=(function(ue,de){var oe=ue;return ue||(oe=de?16893:33204),(65535&oe)<<16})(Y.unixPermissions,De)):(ne=20,z|=(function(ue){return 63&(ue||0)})(Y.dosPermissions)),q=ve.getUTCHours(),q<<=6,q|=ve.getUTCMinutes(),q<<=5,q|=ve.getUTCSeconds()/2,G=ve.getUTCFullYear()-1980,G<<=4,G|=ve.getUTCMonth()+1,G<<=5,G|=ve.getUTCDate(),te&&(J=u(1,1)+u(_(L),4)+U,he+="up"+u(J.length,2)+J),j&&(Z=u(1,1)+u(_(le),4)+F,he+="uc"+u(Z.length,2)+Z);var se="";return se+=`
\0`,se+=u(T,2),se+=W.magic,se+=u(q,2),se+=u(G,2),se+=u(Be.crc32,4),se+=u(Be.compressedSize,4),se+=u(Be.uncompressedSize,4),se+=u(L.length,2),se+=u(he.length,2),{fileRecord:E.LOCAL_FILE_HEADER+se+L+he,dirRecord:E.CENTRAL_FILE_HEADER+u(ne,2)+se+u(le.length,2)+"\0\0\0\0"+u(z,4)+u(k,4)+L+he+le}}var p=s("../utils"),b=s("../stream/GenericWorker"),m=s("../utf8"),_=s("../crc32"),E=s("../signature");function N(S,I,A,k){b.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=I,this.zipPlatform=A,this.encodeFileName=k,this.streamFiles=S,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}p.inherits(N,b),N.prototype.push=function(S){var I=S.meta.percent||0,A=this.entriesCount,k=this._sources.length;this.accumulate?this.contentBuffer.push(S):(this.bytesWritten+=S.data.length,b.prototype.push.call(this,{data:S.data,meta:{currentFile:this.currentFile,percent:A?(I+100*(A-k-1))/A:100}}))},N.prototype.openedSource=function(S){this.currentSourceOffset=this.bytesWritten,this.currentFile=S.file.name;var I=this.streamFiles&&!S.file.dir;if(I){var A=f(S,I,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:A.fileRecord,meta:{percent:0}})}else this.accumulate=!0},N.prototype.closedSource=function(S){this.accumulate=!1;var I=this.streamFiles&&!S.file.dir,A=f(S,I,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(A.dirRecord),I)this.push({data:(function(k){return E.DATA_DESCRIPTOR+u(k.crc32,4)+u(k.compressedSize,4)+u(k.uncompressedSize,4)})(S),meta:{percent:100}});else for(this.push({data:A.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},N.prototype.flush=function(){for(var S=this.bytesWritten,I=0;I<this.dirRecords.length;I++)this.push({data:this.dirRecords[I],meta:{percent:100}});var A=this.bytesWritten-S,k=(function(R,P,q,G,Y){var W=p.transformTo("string",Y(G));return E.CENTRAL_DIRECTORY_END+"\0\0\0\0"+u(R,2)+u(R,2)+u(P,4)+u(q,4)+u(W.length,2)+W})(this.dirRecords.length,A,S,this.zipComment,this.encodeFileName);this.push({data:k,meta:{percent:100}})},N.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},N.prototype.registerPrevious=function(S){this._sources.push(S);var I=this;return S.on("data",function(A){I.processChunk(A)}),S.on("end",function(){I.closedSource(I.previous.streamInfo),I._sources.length?I.prepareNextSource():I.end()}),S.on("error",function(A){I.error(A)}),this},N.prototype.resume=function(){return!!b.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},N.prototype.error=function(S){var I=this._sources;if(!b.prototype.error.call(this,S))return!1;for(var A=0;A<I.length;A++)try{I[A].error(S)}catch{}return!0},N.prototype.lock=function(){b.prototype.lock.call(this);for(var S=this._sources,I=0;I<S.length;I++)S[I].lock()},i.exports=N},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(s,i,c){var u=s("../compressions"),f=s("./ZipFileWorker");c.generateWorker=function(p,b,m){var _=new f(b.streamFiles,m,b.platform,b.encodeFileName),E=0;try{p.forEach(function(N,S){E++;var I=(function(P,q){var G=P||q,Y=u[G];if(!Y)throw new Error(G+" is not a valid compression method !");return Y})(S.options.compression,b.compression),A=S.options.compressionOptions||b.compressionOptions||{},k=S.dir,R=S.date;S._compressWorker(I,A).withStreamInfo("file",{name:N,dir:k,date:R,comment:S.comment||"",unixPermissions:S.unixPermissions,dosPermissions:S.dosPermissions}).pipe(_)}),_.entriesCount=E}catch(N){_.error(N)}return _}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(s,i,c){function u(){if(!(this instanceof u))return new u;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var f=new u;for(var p in this)typeof this[p]!="function"&&(f[p]=this[p]);return f}}(u.prototype=s("./object")).loadAsync=s("./load"),u.support=s("./support"),u.defaults=s("./defaults"),u.version="3.10.1",u.loadAsync=function(f,p){return new u().loadAsync(f,p)},u.external=s("./external"),i.exports=u},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(s,i,c){var u=s("./utils"),f=s("./external"),p=s("./utf8"),b=s("./zipEntries"),m=s("./stream/Crc32Probe"),_=s("./nodejsUtils");function E(N){return new f.Promise(function(S,I){var A=N.decompressed.getContentWorker().pipe(new m);A.on("error",function(k){I(k)}).on("end",function(){A.streamInfo.crc32!==N.decompressed.crc32?I(new Error("Corrupted zip : CRC32 mismatch")):S()}).resume()})}i.exports=function(N,S){var I=this;return S=u.extend(S||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:p.utf8decode}),_.isNode&&_.isStream(N)?f.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):u.prepareContent("the loaded zip file",N,!0,S.optimizedBinaryString,S.base64).then(function(A){var k=new b(S);return k.load(A),k}).then(function(A){var k=[f.Promise.resolve(A)],R=A.files;if(S.checkCRC32)for(var P=0;P<R.length;P++)k.push(E(R[P]));return f.Promise.all(k)}).then(function(A){for(var k=A.shift(),R=k.files,P=0;P<R.length;P++){var q=R[P],G=q.fileNameStr,Y=u.resolve(q.fileNameStr);I.file(Y,q.decompressed,{binary:!0,optimizedBinaryString:!0,date:q.date,dir:q.dir,comment:q.fileCommentStr.length?q.fileCommentStr:null,unixPermissions:q.unixPermissions,dosPermissions:q.dosPermissions,createFolders:S.createFolders}),q.dir||(I.file(Y).unsafeOriginalName=G)}return k.zipComment.length&&(I.comment=k.zipComment),I})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(s,i,c){var u=s("../utils"),f=s("../stream/GenericWorker");function p(b,m){f.call(this,"Nodejs stream input adapter for "+b),this._upstreamEnded=!1,this._bindStream(m)}u.inherits(p,f),p.prototype._bindStream=function(b){var m=this;(this._stream=b).pause(),b.on("data",function(_){m.push({data:_,meta:{percent:0}})}).on("error",function(_){m.isPaused?this.generatedError=_:m.error(_)}).on("end",function(){m.isPaused?m._upstreamEnded=!0:m.end()})},p.prototype.pause=function(){return!!f.prototype.pause.call(this)&&(this._stream.pause(),!0)},p.prototype.resume=function(){return!!f.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},i.exports=p},{"../stream/GenericWorker":28,"../utils":32}],13:[function(s,i,c){var u=s("readable-stream").Readable;function f(p,b,m){u.call(this,b),this._helper=p;var _=this;p.on("data",function(E,N){_.push(E)||_._helper.pause(),m&&m(N)}).on("error",function(E){_.emit("error",E)}).on("end",function(){_.push(null)})}s("../utils").inherits(f,u),f.prototype._read=function(){this._helper.resume()},i.exports=f},{"../utils":32,"readable-stream":16}],14:[function(s,i,c){i.exports={isNode:typeof Buffer<"u",newBufferFrom:function(u,f){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(u,f);if(typeof u=="number")throw new Error('The "data" argument must not be a number');return new Buffer(u,f)},allocBuffer:function(u){if(Buffer.alloc)return Buffer.alloc(u);var f=new Buffer(u);return f.fill(0),f},isBuffer:function(u){return Buffer.isBuffer(u)},isStream:function(u){return u&&typeof u.on=="function"&&typeof u.pause=="function"&&typeof u.resume=="function"}}},{}],15:[function(s,i,c){function u(Y,W,H){var L,U=p.getTypeOf(W),Q=p.extend(H||{},_);Q.date=Q.date||new Date,Q.compression!==null&&(Q.compression=Q.compression.toUpperCase()),typeof Q.unixPermissions=="string"&&(Q.unixPermissions=parseInt(Q.unixPermissions,8)),Q.unixPermissions&&16384&Q.unixPermissions&&(Q.dir=!0),Q.dosPermissions&&16&Q.dosPermissions&&(Q.dir=!0),Q.dir&&(Y=R(Y)),Q.createFolders&&(L=k(Y))&&P.call(this,L,!0);var le=U==="string"&&Q.binary===!1&&Q.base64===!1;H&&H.binary!==void 0||(Q.binary=!le),(W instanceof E&&W.uncompressedSize===0||Q.dir||!W||W.length===0)&&(Q.base64=!1,Q.binary=!0,W="",Q.compression="STORE",U="string");var F=null;F=W instanceof E||W instanceof b?W:I.isNode&&I.isStream(W)?new A(Y,W):p.prepareContent(Y,W,Q.binary,Q.optimizedBinaryString,Q.base64);var te=new N(Y,F,Q);this.files[Y]=te}var f=s("./utf8"),p=s("./utils"),b=s("./stream/GenericWorker"),m=s("./stream/StreamHelper"),_=s("./defaults"),E=s("./compressedObject"),N=s("./zipObject"),S=s("./generate"),I=s("./nodejsUtils"),A=s("./nodejs/NodejsStreamInputAdapter"),k=function(Y){Y.slice(-1)==="/"&&(Y=Y.substring(0,Y.length-1));var W=Y.lastIndexOf("/");return 0<W?Y.substring(0,W):""},R=function(Y){return Y.slice(-1)!=="/"&&(Y+="/"),Y},P=function(Y,W){return W=W!==void 0?W:_.createFolders,Y=R(Y),this.files[Y]||u.call(this,Y,null,{dir:!0,createFolders:W}),this.files[Y]};function q(Y){return Object.prototype.toString.call(Y)==="[object RegExp]"}var G={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(Y){var W,H,L;for(W in this.files)L=this.files[W],(H=W.slice(this.root.length,W.length))&&W.slice(0,this.root.length)===this.root&&Y(H,L)},filter:function(Y){var W=[];return this.forEach(function(H,L){Y(H,L)&&W.push(L)}),W},file:function(Y,W,H){if(arguments.length!==1)return Y=this.root+Y,u.call(this,Y,W,H),this;if(q(Y)){var L=Y;return this.filter(function(Q,le){return!le.dir&&L.test(Q)})}var U=this.files[this.root+Y];return U&&!U.dir?U:null},folder:function(Y){if(!Y)return this;if(q(Y))return this.filter(function(U,Q){return Q.dir&&Y.test(U)});var W=this.root+Y,H=P.call(this,W),L=this.clone();return L.root=H.name,L},remove:function(Y){Y=this.root+Y;var W=this.files[Y];if(W||(Y.slice(-1)!=="/"&&(Y+="/"),W=this.files[Y]),W&&!W.dir)delete this.files[Y];else for(var H=this.filter(function(U,Q){return Q.name.slice(0,Y.length)===Y}),L=0;L<H.length;L++)delete this.files[H[L].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(Y){var W,H={};try{if((H=p.extend(Y||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:f.utf8encode})).type=H.type.toLowerCase(),H.compression=H.compression.toUpperCase(),H.type==="binarystring"&&(H.type="string"),!H.type)throw new Error("No output type specified.");p.checkSupport(H.type),H.platform!=="darwin"&&H.platform!=="freebsd"&&H.platform!=="linux"&&H.platform!=="sunos"||(H.platform="UNIX"),H.platform==="win32"&&(H.platform="DOS");var L=H.comment||this.comment||"";W=S.generateWorker(this,H,L)}catch(U){(W=new b("error")).error(U)}return new m(W,H.type||"string",H.mimeType)},generateAsync:function(Y,W){return this.generateInternalStream(Y).accumulate(W)},generateNodeStream:function(Y,W){return(Y=Y||{}).type||(Y.type="nodebuffer"),this.generateInternalStream(Y).toNodejsStream(W)}};i.exports=G},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(s,i,c){i.exports=s("stream")},{stream:void 0}],17:[function(s,i,c){var u=s("./DataReader");function f(p){u.call(this,p);for(var b=0;b<this.data.length;b++)p[b]=255&p[b]}s("../utils").inherits(f,u),f.prototype.byteAt=function(p){return this.data[this.zero+p]},f.prototype.lastIndexOfSignature=function(p){for(var b=p.charCodeAt(0),m=p.charCodeAt(1),_=p.charCodeAt(2),E=p.charCodeAt(3),N=this.length-4;0<=N;--N)if(this.data[N]===b&&this.data[N+1]===m&&this.data[N+2]===_&&this.data[N+3]===E)return N-this.zero;return-1},f.prototype.readAndCheckSignature=function(p){var b=p.charCodeAt(0),m=p.charCodeAt(1),_=p.charCodeAt(2),E=p.charCodeAt(3),N=this.readData(4);return b===N[0]&&m===N[1]&&_===N[2]&&E===N[3]},f.prototype.readData=function(p){if(this.checkOffset(p),p===0)return[];var b=this.data.slice(this.zero+this.index,this.zero+this.index+p);return this.index+=p,b},i.exports=f},{"../utils":32,"./DataReader":18}],18:[function(s,i,c){var u=s("../utils");function f(p){this.data=p,this.length=p.length,this.index=0,this.zero=0}f.prototype={checkOffset:function(p){this.checkIndex(this.index+p)},checkIndex:function(p){if(this.length<this.zero+p||p<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+p+"). Corrupted zip ?")},setIndex:function(p){this.checkIndex(p),this.index=p},skip:function(p){this.setIndex(this.index+p)},byteAt:function(){},readInt:function(p){var b,m=0;for(this.checkOffset(p),b=this.index+p-1;b>=this.index;b--)m=(m<<8)+this.byteAt(b);return this.index+=p,m},readString:function(p){return u.transformTo("string",this.readData(p))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var p=this.readInt(4);return new Date(Date.UTC(1980+(p>>25&127),(p>>21&15)-1,p>>16&31,p>>11&31,p>>5&63,(31&p)<<1))}},i.exports=f},{"../utils":32}],19:[function(s,i,c){var u=s("./Uint8ArrayReader");function f(p){u.call(this,p)}s("../utils").inherits(f,u),f.prototype.readData=function(p){this.checkOffset(p);var b=this.data.slice(this.zero+this.index,this.zero+this.index+p);return this.index+=p,b},i.exports=f},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(s,i,c){var u=s("./DataReader");function f(p){u.call(this,p)}s("../utils").inherits(f,u),f.prototype.byteAt=function(p){return this.data.charCodeAt(this.zero+p)},f.prototype.lastIndexOfSignature=function(p){return this.data.lastIndexOf(p)-this.zero},f.prototype.readAndCheckSignature=function(p){return p===this.readData(4)},f.prototype.readData=function(p){this.checkOffset(p);var b=this.data.slice(this.zero+this.index,this.zero+this.index+p);return this.index+=p,b},i.exports=f},{"../utils":32,"./DataReader":18}],21:[function(s,i,c){var u=s("./ArrayReader");function f(p){u.call(this,p)}s("../utils").inherits(f,u),f.prototype.readData=function(p){if(this.checkOffset(p),p===0)return new Uint8Array(0);var b=this.data.subarray(this.zero+this.index,this.zero+this.index+p);return this.index+=p,b},i.exports=f},{"../utils":32,"./ArrayReader":17}],22:[function(s,i,c){var u=s("../utils"),f=s("../support"),p=s("./ArrayReader"),b=s("./StringReader"),m=s("./NodeBufferReader"),_=s("./Uint8ArrayReader");i.exports=function(E){var N=u.getTypeOf(E);return u.checkSupport(N),N!=="string"||f.uint8array?N==="nodebuffer"?new m(E):f.uint8array?new _(u.transformTo("uint8array",E)):new p(u.transformTo("array",E)):new b(E)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(s,i,c){c.LOCAL_FILE_HEADER="PK",c.CENTRAL_FILE_HEADER="PK",c.CENTRAL_DIRECTORY_END="PK",c.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07",c.ZIP64_CENTRAL_DIRECTORY_END="PK",c.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(s,i,c){var u=s("./GenericWorker"),f=s("../utils");function p(b){u.call(this,"ConvertWorker to "+b),this.destType=b}f.inherits(p,u),p.prototype.processChunk=function(b){this.push({data:f.transformTo(this.destType,b.data),meta:b.meta})},i.exports=p},{"../utils":32,"./GenericWorker":28}],25:[function(s,i,c){var u=s("./GenericWorker"),f=s("../crc32");function p(){u.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}s("../utils").inherits(p,u),p.prototype.processChunk=function(b){this.streamInfo.crc32=f(b.data,this.streamInfo.crc32||0),this.push(b)},i.exports=p},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(s,i,c){var u=s("../utils"),f=s("./GenericWorker");function p(b){f.call(this,"DataLengthProbe for "+b),this.propName=b,this.withStreamInfo(b,0)}u.inherits(p,f),p.prototype.processChunk=function(b){if(b){var m=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=m+b.data.length}f.prototype.processChunk.call(this,b)},i.exports=p},{"../utils":32,"./GenericWorker":28}],27:[function(s,i,c){var u=s("../utils"),f=s("./GenericWorker");function p(b){f.call(this,"DataWorker");var m=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,b.then(function(_){m.dataIsReady=!0,m.data=_,m.max=_&&_.length||0,m.type=u.getTypeOf(_),m.isPaused||m._tickAndRepeat()},function(_){m.error(_)})}u.inherits(p,f),p.prototype.cleanUp=function(){f.prototype.cleanUp.call(this),this.data=null},p.prototype.resume=function(){return!!f.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,u.delay(this._tickAndRepeat,[],this)),!0)},p.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(u.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},p.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var b=null,m=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":b=this.data.substring(this.index,m);break;case"uint8array":b=this.data.subarray(this.index,m);break;case"array":case"nodebuffer":b=this.data.slice(this.index,m)}return this.index=m,this.push({data:b,meta:{percent:this.max?this.index/this.max*100:0}})},i.exports=p},{"../utils":32,"./GenericWorker":28}],28:[function(s,i,c){function u(f){this.name=f||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}u.prototype={push:function(f){this.emit("data",f)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(f){this.emit("error",f)}return!0},error:function(f){return!this.isFinished&&(this.isPaused?this.generatedError=f:(this.isFinished=!0,this.emit("error",f),this.previous&&this.previous.error(f),this.cleanUp()),!0)},on:function(f,p){return this._listeners[f].push(p),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(f,p){if(this._listeners[f])for(var b=0;b<this._listeners[f].length;b++)this._listeners[f][b].call(this,p)},pipe:function(f){return f.registerPrevious(this)},registerPrevious:function(f){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=f.streamInfo,this.mergeStreamInfo(),this.previous=f;var p=this;return f.on("data",function(b){p.processChunk(b)}),f.on("end",function(){p.end()}),f.on("error",function(b){p.error(b)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var f=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),f=!0),this.previous&&this.previous.resume(),!f},flush:function(){},processChunk:function(f){this.push(f)},withStreamInfo:function(f,p){return this.extraStreamInfo[f]=p,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var f in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,f)&&(this.streamInfo[f]=this.extraStreamInfo[f])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var f="Worker "+this.name;return this.previous?this.previous+" -> "+f:f}},i.exports=u},{}],29:[function(s,i,c){var u=s("../utils"),f=s("./ConvertWorker"),p=s("./GenericWorker"),b=s("../base64"),m=s("../support"),_=s("../external"),E=null;if(m.nodestream)try{E=s("../nodejs/NodejsStreamOutputAdapter")}catch{}function N(I,A){return new _.Promise(function(k,R){var P=[],q=I._internalType,G=I._outputType,Y=I._mimeType;I.on("data",function(W,H){P.push(W),A&&A(H)}).on("error",function(W){P=[],R(W)}).on("end",function(){try{var W=(function(H,L,U){switch(H){case"blob":return u.newBlob(u.transformTo("arraybuffer",L),U);case"base64":return b.encode(L);default:return u.transformTo(H,L)}})(G,(function(H,L){var U,Q=0,le=null,F=0;for(U=0;U<L.length;U++)F+=L[U].length;switch(H){case"string":return L.join("");case"array":return Array.prototype.concat.apply([],L);case"uint8array":for(le=new Uint8Array(F),U=0;U<L.length;U++)le.set(L[U],Q),Q+=L[U].length;return le;case"nodebuffer":return Buffer.concat(L);default:throw new Error("concat : unsupported type '"+H+"'")}})(q,P),Y);k(W)}catch(H){R(H)}P=[]}).resume()})}function S(I,A,k){var R=A;switch(A){case"blob":case"arraybuffer":R="uint8array";break;case"base64":R="string"}try{this._internalType=R,this._outputType=A,this._mimeType=k,u.checkSupport(R),this._worker=I.pipe(new f(R)),I.lock()}catch(P){this._worker=new p("error"),this._worker.error(P)}}S.prototype={accumulate:function(I){return N(this,I)},on:function(I,A){var k=this;return I==="data"?this._worker.on(I,function(R){A.call(k,R.data,R.meta)}):this._worker.on(I,function(){u.delay(A,arguments,k)}),this},resume:function(){return u.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(I){if(u.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new E(this,{objectMode:this._outputType!=="nodebuffer"},I)}},i.exports=S},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(s,i,c){if(c.base64=!0,c.array=!0,c.string=!0,c.arraybuffer=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u",c.nodebuffer=typeof Buffer<"u",c.uint8array=typeof Uint8Array<"u",typeof ArrayBuffer>"u")c.blob=!1;else{var u=new ArrayBuffer(0);try{c.blob=new Blob([u],{type:"application/zip"}).size===0}catch{try{var f=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);f.append(u),c.blob=f.getBlob("application/zip").size===0}catch{c.blob=!1}}}try{c.nodestream=!!s("readable-stream").Readable}catch{c.nodestream=!1}},{"readable-stream":16}],31:[function(s,i,c){for(var u=s("./utils"),f=s("./support"),p=s("./nodejsUtils"),b=s("./stream/GenericWorker"),m=new Array(256),_=0;_<256;_++)m[_]=252<=_?6:248<=_?5:240<=_?4:224<=_?3:192<=_?2:1;m[254]=m[254]=1;function E(){b.call(this,"utf-8 decode"),this.leftOver=null}function N(){b.call(this,"utf-8 encode")}c.utf8encode=function(S){return f.nodebuffer?p.newBufferFrom(S,"utf-8"):(function(I){var A,k,R,P,q,G=I.length,Y=0;for(P=0;P<G;P++)(64512&(k=I.charCodeAt(P)))==55296&&P+1<G&&(64512&(R=I.charCodeAt(P+1)))==56320&&(k=65536+(k-55296<<10)+(R-56320),P++),Y+=k<128?1:k<2048?2:k<65536?3:4;for(A=f.uint8array?new Uint8Array(Y):new Array(Y),P=q=0;q<Y;P++)(64512&(k=I.charCodeAt(P)))==55296&&P+1<G&&(64512&(R=I.charCodeAt(P+1)))==56320&&(k=65536+(k-55296<<10)+(R-56320),P++),k<128?A[q++]=k:(k<2048?A[q++]=192|k>>>6:(k<65536?A[q++]=224|k>>>12:(A[q++]=240|k>>>18,A[q++]=128|k>>>12&63),A[q++]=128|k>>>6&63),A[q++]=128|63&k);return A})(S)},c.utf8decode=function(S){return f.nodebuffer?u.transformTo("nodebuffer",S).toString("utf-8"):(function(I){var A,k,R,P,q=I.length,G=new Array(2*q);for(A=k=0;A<q;)if((R=I[A++])<128)G[k++]=R;else if(4<(P=m[R]))G[k++]=65533,A+=P-1;else{for(R&=P===2?31:P===3?15:7;1<P&&A<q;)R=R<<6|63&I[A++],P--;1<P?G[k++]=65533:R<65536?G[k++]=R:(R-=65536,G[k++]=55296|R>>10&1023,G[k++]=56320|1023&R)}return G.length!==k&&(G.subarray?G=G.subarray(0,k):G.length=k),u.applyFromCharCode(G)})(S=u.transformTo(f.uint8array?"uint8array":"array",S))},u.inherits(E,b),E.prototype.processChunk=function(S){var I=u.transformTo(f.uint8array?"uint8array":"array",S.data);if(this.leftOver&&this.leftOver.length){if(f.uint8array){var A=I;(I=new Uint8Array(A.length+this.leftOver.length)).set(this.leftOver,0),I.set(A,this.leftOver.length)}else I=this.leftOver.concat(I);this.leftOver=null}var k=(function(P,q){var G;for((q=q||P.length)>P.length&&(q=P.length),G=q-1;0<=G&&(192&P[G])==128;)G--;return G<0||G===0?q:G+m[P[G]]>q?G:q})(I),R=I;k!==I.length&&(f.uint8array?(R=I.subarray(0,k),this.leftOver=I.subarray(k,I.length)):(R=I.slice(0,k),this.leftOver=I.slice(k,I.length))),this.push({data:c.utf8decode(R),meta:S.meta})},E.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:c.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},c.Utf8DecodeWorker=E,u.inherits(N,b),N.prototype.processChunk=function(S){this.push({data:c.utf8encode(S.data),meta:S.meta})},c.Utf8EncodeWorker=N},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(s,i,c){var u=s("./support"),f=s("./base64"),p=s("./nodejsUtils"),b=s("./external");function m(A){return A}function _(A,k){for(var R=0;R<A.length;++R)k[R]=255&A.charCodeAt(R);return k}s("setimmediate"),c.newBlob=function(A,k){c.checkSupport("blob");try{return new Blob([A],{type:k})}catch{try{var R=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return R.append(A),R.getBlob(k)}catch{throw new Error("Bug : can't construct the Blob.")}}};var E={stringifyByChunk:function(A,k,R){var P=[],q=0,G=A.length;if(G<=R)return String.fromCharCode.apply(null,A);for(;q<G;)k==="array"||k==="nodebuffer"?P.push(String.fromCharCode.apply(null,A.slice(q,Math.min(q+R,G)))):P.push(String.fromCharCode.apply(null,A.subarray(q,Math.min(q+R,G)))),q+=R;return P.join("")},stringifyByChar:function(A){for(var k="",R=0;R<A.length;R++)k+=String.fromCharCode(A[R]);return k},applyCanBeUsed:{uint8array:(function(){try{return u.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch{return!1}})(),nodebuffer:(function(){try{return u.nodebuffer&&String.fromCharCode.apply(null,p.allocBuffer(1)).length===1}catch{return!1}})()}};function N(A){var k=65536,R=c.getTypeOf(A),P=!0;if(R==="uint8array"?P=E.applyCanBeUsed.uint8array:R==="nodebuffer"&&(P=E.applyCanBeUsed.nodebuffer),P)for(;1<k;)try{return E.stringifyByChunk(A,R,k)}catch{k=Math.floor(k/2)}return E.stringifyByChar(A)}function S(A,k){for(var R=0;R<A.length;R++)k[R]=A[R];return k}c.applyFromCharCode=N;var I={};I.string={string:m,array:function(A){return _(A,new Array(A.length))},arraybuffer:function(A){return I.string.uint8array(A).buffer},uint8array:function(A){return _(A,new Uint8Array(A.length))},nodebuffer:function(A){return _(A,p.allocBuffer(A.length))}},I.array={string:N,array:m,arraybuffer:function(A){return new Uint8Array(A).buffer},uint8array:function(A){return new Uint8Array(A)},nodebuffer:function(A){return p.newBufferFrom(A)}},I.arraybuffer={string:function(A){return N(new Uint8Array(A))},array:function(A){return S(new Uint8Array(A),new Array(A.byteLength))},arraybuffer:m,uint8array:function(A){return new Uint8Array(A)},nodebuffer:function(A){return p.newBufferFrom(new Uint8Array(A))}},I.uint8array={string:N,array:function(A){return S(A,new Array(A.length))},arraybuffer:function(A){return A.buffer},uint8array:m,nodebuffer:function(A){return p.newBufferFrom(A)}},I.nodebuffer={string:N,array:function(A){return S(A,new Array(A.length))},arraybuffer:function(A){return I.nodebuffer.uint8array(A).buffer},uint8array:function(A){return S(A,new Uint8Array(A.length))},nodebuffer:m},c.transformTo=function(A,k){if(k=k||"",!A)return k;c.checkSupport(A);var R=c.getTypeOf(k);return I[R][A](k)},c.resolve=function(A){for(var k=A.split("/"),R=[],P=0;P<k.length;P++){var q=k[P];q==="."||q===""&&P!==0&&P!==k.length-1||(q===".."?R.pop():R.push(q))}return R.join("/")},c.getTypeOf=function(A){return typeof A=="string"?"string":Object.prototype.toString.call(A)==="[object Array]"?"array":u.nodebuffer&&p.isBuffer(A)?"nodebuffer":u.uint8array&&A instanceof Uint8Array?"uint8array":u.arraybuffer&&A instanceof ArrayBuffer?"arraybuffer":void 0},c.checkSupport=function(A){if(!u[A.toLowerCase()])throw new Error(A+" is not supported by this platform")},c.MAX_VALUE_16BITS=65535,c.MAX_VALUE_32BITS=-1,c.pretty=function(A){var k,R,P="";for(R=0;R<(A||"").length;R++)P+="\\x"+((k=A.charCodeAt(R))<16?"0":"")+k.toString(16).toUpperCase();return P},c.delay=function(A,k,R){setImmediate(function(){A.apply(R||null,k||[])})},c.inherits=function(A,k){function R(){}R.prototype=k.prototype,A.prototype=new R},c.extend=function(){var A,k,R={};for(A=0;A<arguments.length;A++)for(k in arguments[A])Object.prototype.hasOwnProperty.call(arguments[A],k)&&R[k]===void 0&&(R[k]=arguments[A][k]);return R},c.prepareContent=function(A,k,R,P,q){return b.Promise.resolve(k).then(function(G){return u.blob&&(G instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(G))!==-1)&&typeof FileReader<"u"?new b.Promise(function(Y,W){var H=new FileReader;H.onload=function(L){Y(L.target.result)},H.onerror=function(L){W(L.target.error)},H.readAsArrayBuffer(G)}):G}).then(function(G){var Y=c.getTypeOf(G);return Y?(Y==="arraybuffer"?G=c.transformTo("uint8array",G):Y==="string"&&(q?G=f.decode(G):R&&P!==!0&&(G=(function(W){return _(W,u.uint8array?new Uint8Array(W.length):new Array(W.length))})(G))),G):b.Promise.reject(new Error("Can't read the data of '"+A+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(s,i,c){var u=s("./reader/readerFor"),f=s("./utils"),p=s("./signature"),b=s("./zipEntry"),m=s("./support");function _(E){this.files=[],this.loadOptions=E}_.prototype={checkSignature:function(E){if(!this.reader.readAndCheckSignature(E)){this.reader.index-=4;var N=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+f.pretty(N)+", expected "+f.pretty(E)+")")}},isSignature:function(E,N){var S=this.reader.index;this.reader.setIndex(E);var I=this.reader.readString(4)===N;return this.reader.setIndex(S),I},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var E=this.reader.readData(this.zipCommentLength),N=m.uint8array?"uint8array":"array",S=f.transformTo(N,E);this.zipComment=this.loadOptions.decodeFileName(S)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var E,N,S,I=this.zip64EndOfCentralSize-44;0<I;)E=this.reader.readInt(2),N=this.reader.readInt(4),S=this.reader.readData(N),this.zip64ExtensibleData[E]={id:E,length:N,value:S}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var E,N;for(E=0;E<this.files.length;E++)N=this.files[E],this.reader.setIndex(N.localHeaderOffset),this.checkSignature(p.LOCAL_FILE_HEADER),N.readLocalPart(this.reader),N.handleUTF8(),N.processAttributes()},readCentralDir:function(){var E;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(p.CENTRAL_FILE_HEADER);)(E=new b({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(E);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var E=this.reader.lastIndexOfSignature(p.CENTRAL_DIRECTORY_END);if(E<0)throw this.isSignature(0,p.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(E);var N=E;if(this.checkSignature(p.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===f.MAX_VALUE_16BITS||this.diskWithCentralDirStart===f.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===f.MAX_VALUE_16BITS||this.centralDirRecords===f.MAX_VALUE_16BITS||this.centralDirSize===f.MAX_VALUE_32BITS||this.centralDirOffset===f.MAX_VALUE_32BITS){if(this.zip64=!0,(E=this.reader.lastIndexOfSignature(p.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(E),this.checkSignature(p.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,p.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(p.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(p.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var S=this.centralDirOffset+this.centralDirSize;this.zip64&&(S+=20,S+=12+this.zip64EndOfCentralSize);var I=N-S;if(0<I)this.isSignature(N,p.CENTRAL_FILE_HEADER)||(this.reader.zero=I);else if(I<0)throw new Error("Corrupted zip: missing "+Math.abs(I)+" bytes.")},prepareReader:function(E){this.reader=u(E)},load:function(E){this.prepareReader(E),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},i.exports=_},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(s,i,c){var u=s("./reader/readerFor"),f=s("./utils"),p=s("./compressedObject"),b=s("./crc32"),m=s("./utf8"),_=s("./compressions"),E=s("./support");function N(S,I){this.options=S,this.loadOptions=I}N.prototype={isEncrypted:function(){return(1&this.bitFlag)==1},useUTF8:function(){return(2048&this.bitFlag)==2048},readLocalPart:function(S){var I,A;if(S.skip(22),this.fileNameLength=S.readInt(2),A=S.readInt(2),this.fileName=S.readData(this.fileNameLength),S.skip(A),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if((I=(function(k){for(var R in _)if(Object.prototype.hasOwnProperty.call(_,R)&&_[R].magic===k)return _[R];return null})(this.compressionMethod))===null)throw new Error("Corrupted zip : compression "+f.pretty(this.compressionMethod)+" unknown (inner file : "+f.transformTo("string",this.fileName)+")");this.decompressed=new p(this.compressedSize,this.uncompressedSize,this.crc32,I,S.readData(this.compressedSize))},readCentralPart:function(S){this.versionMadeBy=S.readInt(2),S.skip(2),this.bitFlag=S.readInt(2),this.compressionMethod=S.readString(2),this.date=S.readDate(),this.crc32=S.readInt(4),this.compressedSize=S.readInt(4),this.uncompressedSize=S.readInt(4);var I=S.readInt(2);if(this.extraFieldsLength=S.readInt(2),this.fileCommentLength=S.readInt(2),this.diskNumberStart=S.readInt(2),this.internalFileAttributes=S.readInt(2),this.externalFileAttributes=S.readInt(4),this.localHeaderOffset=S.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");S.skip(I),this.readExtraFields(S),this.parseZIP64ExtraField(S),this.fileComment=S.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var S=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),S==0&&(this.dosPermissions=63&this.externalFileAttributes),S==3&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||this.fileNameStr.slice(-1)!=="/"||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var S=u(this.extraFields[1].value);this.uncompressedSize===f.MAX_VALUE_32BITS&&(this.uncompressedSize=S.readInt(8)),this.compressedSize===f.MAX_VALUE_32BITS&&(this.compressedSize=S.readInt(8)),this.localHeaderOffset===f.MAX_VALUE_32BITS&&(this.localHeaderOffset=S.readInt(8)),this.diskNumberStart===f.MAX_VALUE_32BITS&&(this.diskNumberStart=S.readInt(4))}},readExtraFields:function(S){var I,A,k,R=S.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});S.index+4<R;)I=S.readInt(2),A=S.readInt(2),k=S.readData(A),this.extraFields[I]={id:I,length:A,value:k};S.setIndex(R)},handleUTF8:function(){var S=E.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=m.utf8decode(this.fileName),this.fileCommentStr=m.utf8decode(this.fileComment);else{var I=this.findExtraFieldUnicodePath();if(I!==null)this.fileNameStr=I;else{var A=f.transformTo(S,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(A)}var k=this.findExtraFieldUnicodeComment();if(k!==null)this.fileCommentStr=k;else{var R=f.transformTo(S,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(R)}}},findExtraFieldUnicodePath:function(){var S=this.extraFields[28789];if(S){var I=u(S.value);return I.readInt(1)!==1||b(this.fileName)!==I.readInt(4)?null:m.utf8decode(I.readData(S.length-5))}return null},findExtraFieldUnicodeComment:function(){var S=this.extraFields[25461];if(S){var I=u(S.value);return I.readInt(1)!==1||b(this.fileComment)!==I.readInt(4)?null:m.utf8decode(I.readData(S.length-5))}return null}},i.exports=N},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(s,i,c){function u(I,A,k){this.name=I,this.dir=k.dir,this.date=k.date,this.comment=k.comment,this.unixPermissions=k.unixPermissions,this.dosPermissions=k.dosPermissions,this._data=A,this._dataBinary=k.binary,this.options={compression:k.compression,compressionOptions:k.compressionOptions}}var f=s("./stream/StreamHelper"),p=s("./stream/DataWorker"),b=s("./utf8"),m=s("./compressedObject"),_=s("./stream/GenericWorker");u.prototype={internalStream:function(I){var A=null,k="string";try{if(!I)throw new Error("No output type specified.");var R=(k=I.toLowerCase())==="string"||k==="text";k!=="binarystring"&&k!=="text"||(k="string"),A=this._decompressWorker();var P=!this._dataBinary;P&&!R&&(A=A.pipe(new b.Utf8EncodeWorker)),!P&&R&&(A=A.pipe(new b.Utf8DecodeWorker))}catch(q){(A=new _("error")).error(q)}return new f(A,k,"")},async:function(I,A){return this.internalStream(I).accumulate(A)},nodeStream:function(I,A){return this.internalStream(I||"nodebuffer").toNodejsStream(A)},_compressWorker:function(I,A){if(this._data instanceof m&&this._data.compression.magic===I.magic)return this._data.getCompressedWorker();var k=this._decompressWorker();return this._dataBinary||(k=k.pipe(new b.Utf8EncodeWorker)),m.createWorkerFrom(k,I,A)},_decompressWorker:function(){return this._data instanceof m?this._data.getContentWorker():this._data instanceof _?this._data:new p(this._data)}};for(var E=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],N=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},S=0;S<E.length;S++)u.prototype[E[S]]=N;i.exports=u},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(s,i,c){(function(u){var f,p,b=u.MutationObserver||u.WebKitMutationObserver;if(b){var m=0,_=new b(I),E=u.document.createTextNode("");_.observe(E,{characterData:!0}),f=function(){E.data=m=++m%2}}else if(u.setImmediate||u.MessageChannel===void 0)f="document"in u&&"onreadystatechange"in u.document.createElement("script")?function(){var A=u.document.createElement("script");A.onreadystatechange=function(){I(),A.onreadystatechange=null,A.parentNode.removeChild(A),A=null},u.document.documentElement.appendChild(A)}:function(){setTimeout(I,0)};else{var N=new u.MessageChannel;N.port1.onmessage=I,f=function(){N.port2.postMessage(0)}}var S=[];function I(){var A,k;p=!0;for(var R=S.length;R;){for(k=S,S=[],A=-1;++A<R;)k[A]();R=S.length}p=!1}i.exports=function(A){S.push(A)!==1||p||f()}}).call(this,typeof mc<"u"?mc:typeof self<"u"?self:typeof window<"u"?window:{})},{}],37:[function(s,i,c){var u=s("immediate");function f(){}var p={},b=["REJECTED"],m=["FULFILLED"],_=["PENDING"];function E(R){if(typeof R!="function")throw new TypeError("resolver must be a function");this.state=_,this.queue=[],this.outcome=void 0,R!==f&&A(this,R)}function N(R,P,q){this.promise=R,typeof P=="function"&&(this.onFulfilled=P,this.callFulfilled=this.otherCallFulfilled),typeof q=="function"&&(this.onRejected=q,this.callRejected=this.otherCallRejected)}function S(R,P,q){u(function(){var G;try{G=P(q)}catch(Y){return p.reject(R,Y)}G===R?p.reject(R,new TypeError("Cannot resolve promise with itself")):p.resolve(R,G)})}function I(R){var P=R&&R.then;if(R&&(typeof R=="object"||typeof R=="function")&&typeof P=="function")return function(){P.apply(R,arguments)}}function A(R,P){var q=!1;function G(H){q||(q=!0,p.reject(R,H))}function Y(H){q||(q=!0,p.resolve(R,H))}var W=k(function(){P(Y,G)});W.status==="error"&&G(W.value)}function k(R,P){var q={};try{q.value=R(P),q.status="success"}catch(G){q.status="error",q.value=G}return q}(i.exports=E).prototype.finally=function(R){if(typeof R!="function")return this;var P=this.constructor;return this.then(function(q){return P.resolve(R()).then(function(){return q})},function(q){return P.resolve(R()).then(function(){throw q})})},E.prototype.catch=function(R){return this.then(null,R)},E.prototype.then=function(R,P){if(typeof R!="function"&&this.state===m||typeof P!="function"&&this.state===b)return this;var q=new this.constructor(f);return this.state!==_?S(q,this.state===m?R:P,this.outcome):this.queue.push(new N(q,R,P)),q},N.prototype.callFulfilled=function(R){p.resolve(this.promise,R)},N.prototype.otherCallFulfilled=function(R){S(this.promise,this.onFulfilled,R)},N.prototype.callRejected=function(R){p.reject(this.promise,R)},N.prototype.otherCallRejected=function(R){S(this.promise,this.onRejected,R)},p.resolve=function(R,P){var q=k(I,P);if(q.status==="error")return p.reject(R,q.value);var G=q.value;if(G)A(R,G);else{R.state=m,R.outcome=P;for(var Y=-1,W=R.queue.length;++Y<W;)R.queue[Y].callFulfilled(P)}return R},p.reject=function(R,P){R.state=b,R.outcome=P;for(var q=-1,G=R.queue.length;++q<G;)R.queue[q].callRejected(P);return R},E.resolve=function(R){return R instanceof this?R:p.resolve(new this(f),R)},E.reject=function(R){var P=new this(f);return p.reject(P,R)},E.all=function(R){var P=this;if(Object.prototype.toString.call(R)!=="[object Array]")return this.reject(new TypeError("must be an array"));var q=R.length,G=!1;if(!q)return this.resolve([]);for(var Y=new Array(q),W=0,H=-1,L=new this(f);++H<q;)U(R[H],H);return L;function U(Q,le){P.resolve(Q).then(function(F){Y[le]=F,++W!==q||G||(G=!0,p.resolve(L,Y))},function(F){G||(G=!0,p.reject(L,F))})}},E.race=function(R){var P=this;if(Object.prototype.toString.call(R)!=="[object Array]")return this.reject(new TypeError("must be an array"));var q=R.length,G=!1;if(!q)return this.resolve([]);for(var Y=-1,W=new this(f);++Y<q;)H=R[Y],P.resolve(H).then(function(L){G||(G=!0,p.resolve(W,L))},function(L){G||(G=!0,p.reject(W,L))});var H;return W}},{immediate:36}],38:[function(s,i,c){var u={};(0,s("./lib/utils/common").assign)(u,s("./lib/deflate"),s("./lib/inflate"),s("./lib/zlib/constants")),i.exports=u},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(s,i,c){var u=s("./zlib/deflate"),f=s("./utils/common"),p=s("./utils/strings"),b=s("./zlib/messages"),m=s("./zlib/zstream"),_=Object.prototype.toString,E=0,N=-1,S=0,I=8;function A(R){if(!(this instanceof A))return new A(R);this.options=f.assign({level:N,method:I,chunkSize:16384,windowBits:15,memLevel:8,strategy:S,to:""},R||{});var P=this.options;P.raw&&0<P.windowBits?P.windowBits=-P.windowBits:P.gzip&&0<P.windowBits&&P.windowBits<16&&(P.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new m,this.strm.avail_out=0;var q=u.deflateInit2(this.strm,P.level,P.method,P.windowBits,P.memLevel,P.strategy);if(q!==E)throw new Error(b[q]);if(P.header&&u.deflateSetHeader(this.strm,P.header),P.dictionary){var G;if(G=typeof P.dictionary=="string"?p.string2buf(P.dictionary):_.call(P.dictionary)==="[object ArrayBuffer]"?new Uint8Array(P.dictionary):P.dictionary,(q=u.deflateSetDictionary(this.strm,G))!==E)throw new Error(b[q]);this._dict_set=!0}}function k(R,P){var q=new A(P);if(q.push(R,!0),q.err)throw q.msg||b[q.err];return q.result}A.prototype.push=function(R,P){var q,G,Y=this.strm,W=this.options.chunkSize;if(this.ended)return!1;G=P===~~P?P:P===!0?4:0,typeof R=="string"?Y.input=p.string2buf(R):_.call(R)==="[object ArrayBuffer]"?Y.input=new Uint8Array(R):Y.input=R,Y.next_in=0,Y.avail_in=Y.input.length;do{if(Y.avail_out===0&&(Y.output=new f.Buf8(W),Y.next_out=0,Y.avail_out=W),(q=u.deflate(Y,G))!==1&&q!==E)return this.onEnd(q),!(this.ended=!0);Y.avail_out!==0&&(Y.avail_in!==0||G!==4&&G!==2)||(this.options.to==="string"?this.onData(p.buf2binstring(f.shrinkBuf(Y.output,Y.next_out))):this.onData(f.shrinkBuf(Y.output,Y.next_out)))}while((0<Y.avail_in||Y.avail_out===0)&&q!==1);return G===4?(q=u.deflateEnd(this.strm),this.onEnd(q),this.ended=!0,q===E):G!==2||(this.onEnd(E),!(Y.avail_out=0))},A.prototype.onData=function(R){this.chunks.push(R)},A.prototype.onEnd=function(R){R===E&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=f.flattenChunks(this.chunks)),this.chunks=[],this.err=R,this.msg=this.strm.msg},c.Deflate=A,c.deflate=k,c.deflateRaw=function(R,P){return(P=P||{}).raw=!0,k(R,P)},c.gzip=function(R,P){return(P=P||{}).gzip=!0,k(R,P)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(s,i,c){var u=s("./zlib/inflate"),f=s("./utils/common"),p=s("./utils/strings"),b=s("./zlib/constants"),m=s("./zlib/messages"),_=s("./zlib/zstream"),E=s("./zlib/gzheader"),N=Object.prototype.toString;function S(A){if(!(this instanceof S))return new S(A);this.options=f.assign({chunkSize:16384,windowBits:0,to:""},A||{});var k=this.options;k.raw&&0<=k.windowBits&&k.windowBits<16&&(k.windowBits=-k.windowBits,k.windowBits===0&&(k.windowBits=-15)),!(0<=k.windowBits&&k.windowBits<16)||A&&A.windowBits||(k.windowBits+=32),15<k.windowBits&&k.windowBits<48&&(15&k.windowBits)==0&&(k.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new _,this.strm.avail_out=0;var R=u.inflateInit2(this.strm,k.windowBits);if(R!==b.Z_OK)throw new Error(m[R]);this.header=new E,u.inflateGetHeader(this.strm,this.header)}function I(A,k){var R=new S(k);if(R.push(A,!0),R.err)throw R.msg||m[R.err];return R.result}S.prototype.push=function(A,k){var R,P,q,G,Y,W,H=this.strm,L=this.options.chunkSize,U=this.options.dictionary,Q=!1;if(this.ended)return!1;P=k===~~k?k:k===!0?b.Z_FINISH:b.Z_NO_FLUSH,typeof A=="string"?H.input=p.binstring2buf(A):N.call(A)==="[object ArrayBuffer]"?H.input=new Uint8Array(A):H.input=A,H.next_in=0,H.avail_in=H.input.length;do{if(H.avail_out===0&&(H.output=new f.Buf8(L),H.next_out=0,H.avail_out=L),(R=u.inflate(H,b.Z_NO_FLUSH))===b.Z_NEED_DICT&&U&&(W=typeof U=="string"?p.string2buf(U):N.call(U)==="[object ArrayBuffer]"?new Uint8Array(U):U,R=u.inflateSetDictionary(this.strm,W)),R===b.Z_BUF_ERROR&&Q===!0&&(R=b.Z_OK,Q=!1),R!==b.Z_STREAM_END&&R!==b.Z_OK)return this.onEnd(R),!(this.ended=!0);H.next_out&&(H.avail_out!==0&&R!==b.Z_STREAM_END&&(H.avail_in!==0||P!==b.Z_FINISH&&P!==b.Z_SYNC_FLUSH)||(this.options.to==="string"?(q=p.utf8border(H.output,H.next_out),G=H.next_out-q,Y=p.buf2string(H.output,q),H.next_out=G,H.avail_out=L-G,G&&f.arraySet(H.output,H.output,q,G,0),this.onData(Y)):this.onData(f.shrinkBuf(H.output,H.next_out)))),H.avail_in===0&&H.avail_out===0&&(Q=!0)}while((0<H.avail_in||H.avail_out===0)&&R!==b.Z_STREAM_END);return R===b.Z_STREAM_END&&(P=b.Z_FINISH),P===b.Z_FINISH?(R=u.inflateEnd(this.strm),this.onEnd(R),this.ended=!0,R===b.Z_OK):P!==b.Z_SYNC_FLUSH||(this.onEnd(b.Z_OK),!(H.avail_out=0))},S.prototype.onData=function(A){this.chunks.push(A)},S.prototype.onEnd=function(A){A===b.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=f.flattenChunks(this.chunks)),this.chunks=[],this.err=A,this.msg=this.strm.msg},c.Inflate=S,c.inflate=I,c.inflateRaw=function(A,k){return(k=k||{}).raw=!0,I(A,k)},c.ungzip=I},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(s,i,c){var u=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";c.assign=function(b){for(var m=Array.prototype.slice.call(arguments,1);m.length;){var _=m.shift();if(_){if(typeof _!="object")throw new TypeError(_+"must be non-object");for(var E in _)_.hasOwnProperty(E)&&(b[E]=_[E])}}return b},c.shrinkBuf=function(b,m){return b.length===m?b:b.subarray?b.subarray(0,m):(b.length=m,b)};var f={arraySet:function(b,m,_,E,N){if(m.subarray&&b.subarray)b.set(m.subarray(_,_+E),N);else for(var S=0;S<E;S++)b[N+S]=m[_+S]},flattenChunks:function(b){var m,_,E,N,S,I;for(m=E=0,_=b.length;m<_;m++)E+=b[m].length;for(I=new Uint8Array(E),m=N=0,_=b.length;m<_;m++)S=b[m],I.set(S,N),N+=S.length;return I}},p={arraySet:function(b,m,_,E,N){for(var S=0;S<E;S++)b[N+S]=m[_+S]},flattenChunks:function(b){return[].concat.apply([],b)}};c.setTyped=function(b){b?(c.Buf8=Uint8Array,c.Buf16=Uint16Array,c.Buf32=Int32Array,c.assign(c,f)):(c.Buf8=Array,c.Buf16=Array,c.Buf32=Array,c.assign(c,p))},c.setTyped(u)},{}],42:[function(s,i,c){var u=s("./common"),f=!0,p=!0;try{String.fromCharCode.apply(null,[0])}catch{f=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{p=!1}for(var b=new u.Buf8(256),m=0;m<256;m++)b[m]=252<=m?6:248<=m?5:240<=m?4:224<=m?3:192<=m?2:1;function _(E,N){if(N<65537&&(E.subarray&&p||!E.subarray&&f))return String.fromCharCode.apply(null,u.shrinkBuf(E,N));for(var S="",I=0;I<N;I++)S+=String.fromCharCode(E[I]);return S}b[254]=b[254]=1,c.string2buf=function(E){var N,S,I,A,k,R=E.length,P=0;for(A=0;A<R;A++)(64512&(S=E.charCodeAt(A)))==55296&&A+1<R&&(64512&(I=E.charCodeAt(A+1)))==56320&&(S=65536+(S-55296<<10)+(I-56320),A++),P+=S<128?1:S<2048?2:S<65536?3:4;for(N=new u.Buf8(P),A=k=0;k<P;A++)(64512&(S=E.charCodeAt(A)))==55296&&A+1<R&&(64512&(I=E.charCodeAt(A+1)))==56320&&(S=65536+(S-55296<<10)+(I-56320),A++),S<128?N[k++]=S:(S<2048?N[k++]=192|S>>>6:(S<65536?N[k++]=224|S>>>12:(N[k++]=240|S>>>18,N[k++]=128|S>>>12&63),N[k++]=128|S>>>6&63),N[k++]=128|63&S);return N},c.buf2binstring=function(E){return _(E,E.length)},c.binstring2buf=function(E){for(var N=new u.Buf8(E.length),S=0,I=N.length;S<I;S++)N[S]=E.charCodeAt(S);return N},c.buf2string=function(E,N){var S,I,A,k,R=N||E.length,P=new Array(2*R);for(S=I=0;S<R;)if((A=E[S++])<128)P[I++]=A;else if(4<(k=b[A]))P[I++]=65533,S+=k-1;else{for(A&=k===2?31:k===3?15:7;1<k&&S<R;)A=A<<6|63&E[S++],k--;1<k?P[I++]=65533:A<65536?P[I++]=A:(A-=65536,P[I++]=55296|A>>10&1023,P[I++]=56320|1023&A)}return _(P,I)},c.utf8border=function(E,N){var S;for((N=N||E.length)>E.length&&(N=E.length),S=N-1;0<=S&&(192&E[S])==128;)S--;return S<0||S===0?N:S+b[E[S]]>N?S:N}},{"./common":41}],43:[function(s,i,c){i.exports=function(u,f,p,b){for(var m=65535&u|0,_=u>>>16&65535|0,E=0;p!==0;){for(p-=E=2e3<p?2e3:p;_=_+(m=m+f[b++]|0)|0,--E;);m%=65521,_%=65521}return m|_<<16|0}},{}],44:[function(s,i,c){i.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(s,i,c){var u=(function(){for(var f,p=[],b=0;b<256;b++){f=b;for(var m=0;m<8;m++)f=1&f?3988292384^f>>>1:f>>>1;p[b]=f}return p})();i.exports=function(f,p,b,m){var _=u,E=m+b;f^=-1;for(var N=m;N<E;N++)f=f>>>8^_[255&(f^p[N])];return-1^f}},{}],46:[function(s,i,c){var u,f=s("../utils/common"),p=s("./trees"),b=s("./adler32"),m=s("./crc32"),_=s("./messages"),E=0,N=4,S=0,I=-2,A=-1,k=4,R=2,P=8,q=9,G=286,Y=30,W=19,H=2*G+1,L=15,U=3,Q=258,le=Q+U+1,F=42,te=113,j=1,he=2,J=3,Z=4;function De(C,Ne){return C.msg=_[Ne],Ne}function ve(C){return(C<<1)-(4<C?9:0)}function Be(C){for(var Ne=C.length;0<=--Ne;)C[Ne]=0}function T(C){var Ne=C.state,Ce=Ne.pending;Ce>C.avail_out&&(Ce=C.avail_out),Ce!==0&&(f.arraySet(C.output,Ne.pending_buf,Ne.pending_out,Ce,C.next_out),C.next_out+=Ce,Ne.pending_out+=Ce,C.total_out+=Ce,C.avail_out-=Ce,Ne.pending-=Ce,Ne.pending===0&&(Ne.pending_out=0))}function z(C,Ne){p._tr_flush_block(C,0<=C.block_start?C.block_start:-1,C.strstart-C.block_start,Ne),C.block_start=C.strstart,T(C.strm)}function ne(C,Ne){C.pending_buf[C.pending++]=Ne}function se(C,Ne){C.pending_buf[C.pending++]=Ne>>>8&255,C.pending_buf[C.pending++]=255&Ne}function ue(C,Ne){var Ce,re,ee=C.max_chain_length,me=C.strstart,Ve=C.prev_length,Ye=C.nice_match,be=C.strstart>C.w_size-le?C.strstart-(C.w_size-le):0,Ze=C.window,at=C.w_mask,Ue=C.prev,_t=C.strstart+Q,It=Ze[me+Ve-1],Nt=Ze[me+Ve];C.prev_length>=C.good_match&&(ee>>=2),Ye>C.lookahead&&(Ye=C.lookahead);do if(Ze[(Ce=Ne)+Ve]===Nt&&Ze[Ce+Ve-1]===It&&Ze[Ce]===Ze[me]&&Ze[++Ce]===Ze[me+1]){me+=2,Ce++;do;while(Ze[++me]===Ze[++Ce]&&Ze[++me]===Ze[++Ce]&&Ze[++me]===Ze[++Ce]&&Ze[++me]===Ze[++Ce]&&Ze[++me]===Ze[++Ce]&&Ze[++me]===Ze[++Ce]&&Ze[++me]===Ze[++Ce]&&Ze[++me]===Ze[++Ce]&&me<_t);if(re=Q-(_t-me),me=_t-Q,Ve<re){if(C.match_start=Ne,Ye<=(Ve=re))break;It=Ze[me+Ve-1],Nt=Ze[me+Ve]}}while((Ne=Ue[Ne&at])>be&&--ee!=0);return Ve<=C.lookahead?Ve:C.lookahead}function de(C){var Ne,Ce,re,ee,me,Ve,Ye,be,Ze,at,Ue=C.w_size;do{if(ee=C.window_size-C.lookahead-C.strstart,C.strstart>=Ue+(Ue-le)){for(f.arraySet(C.window,C.window,Ue,Ue,0),C.match_start-=Ue,C.strstart-=Ue,C.block_start-=Ue,Ne=Ce=C.hash_size;re=C.head[--Ne],C.head[Ne]=Ue<=re?re-Ue:0,--Ce;);for(Ne=Ce=Ue;re=C.prev[--Ne],C.prev[Ne]=Ue<=re?re-Ue:0,--Ce;);ee+=Ue}if(C.strm.avail_in===0)break;if(Ve=C.strm,Ye=C.window,be=C.strstart+C.lookahead,Ze=ee,at=void 0,at=Ve.avail_in,Ze<at&&(at=Ze),Ce=at===0?0:(Ve.avail_in-=at,f.arraySet(Ye,Ve.input,Ve.next_in,at,be),Ve.state.wrap===1?Ve.adler=b(Ve.adler,Ye,at,be):Ve.state.wrap===2&&(Ve.adler=m(Ve.adler,Ye,at,be)),Ve.next_in+=at,Ve.total_in+=at,at),C.lookahead+=Ce,C.lookahead+C.insert>=U)for(me=C.strstart-C.insert,C.ins_h=C.window[me],C.ins_h=(C.ins_h<<C.hash_shift^C.window[me+1])&C.hash_mask;C.insert&&(C.ins_h=(C.ins_h<<C.hash_shift^C.window[me+U-1])&C.hash_mask,C.prev[me&C.w_mask]=C.head[C.ins_h],C.head[C.ins_h]=me,me++,C.insert--,!(C.lookahead+C.insert<U)););}while(C.lookahead<le&&C.strm.avail_in!==0)}function oe(C,Ne){for(var Ce,re;;){if(C.lookahead<le){if(de(C),C.lookahead<le&&Ne===E)return j;if(C.lookahead===0)break}if(Ce=0,C.lookahead>=U&&(C.ins_h=(C.ins_h<<C.hash_shift^C.window[C.strstart+U-1])&C.hash_mask,Ce=C.prev[C.strstart&C.w_mask]=C.head[C.ins_h],C.head[C.ins_h]=C.strstart),Ce!==0&&C.strstart-Ce<=C.w_size-le&&(C.match_length=ue(C,Ce)),C.match_length>=U)if(re=p._tr_tally(C,C.strstart-C.match_start,C.match_length-U),C.lookahead-=C.match_length,C.match_length<=C.max_lazy_match&&C.lookahead>=U){for(C.match_length--;C.strstart++,C.ins_h=(C.ins_h<<C.hash_shift^C.window[C.strstart+U-1])&C.hash_mask,Ce=C.prev[C.strstart&C.w_mask]=C.head[C.ins_h],C.head[C.ins_h]=C.strstart,--C.match_length!=0;);C.strstart++}else C.strstart+=C.match_length,C.match_length=0,C.ins_h=C.window[C.strstart],C.ins_h=(C.ins_h<<C.hash_shift^C.window[C.strstart+1])&C.hash_mask;else re=p._tr_tally(C,0,C.window[C.strstart]),C.lookahead--,C.strstart++;if(re&&(z(C,!1),C.strm.avail_out===0))return j}return C.insert=C.strstart<U-1?C.strstart:U-1,Ne===N?(z(C,!0),C.strm.avail_out===0?J:Z):C.last_lit&&(z(C,!1),C.strm.avail_out===0)?j:he}function ye(C,Ne){for(var Ce,re,ee;;){if(C.lookahead<le){if(de(C),C.lookahead<le&&Ne===E)return j;if(C.lookahead===0)break}if(Ce=0,C.lookahead>=U&&(C.ins_h=(C.ins_h<<C.hash_shift^C.window[C.strstart+U-1])&C.hash_mask,Ce=C.prev[C.strstart&C.w_mask]=C.head[C.ins_h],C.head[C.ins_h]=C.strstart),C.prev_length=C.match_length,C.prev_match=C.match_start,C.match_length=U-1,Ce!==0&&C.prev_length<C.max_lazy_match&&C.strstart-Ce<=C.w_size-le&&(C.match_length=ue(C,Ce),C.match_length<=5&&(C.strategy===1||C.match_length===U&&4096<C.strstart-C.match_start)&&(C.match_length=U-1)),C.prev_length>=U&&C.match_length<=C.prev_length){for(ee=C.strstart+C.lookahead-U,re=p._tr_tally(C,C.strstart-1-C.prev_match,C.prev_length-U),C.lookahead-=C.prev_length-1,C.prev_length-=2;++C.strstart<=ee&&(C.ins_h=(C.ins_h<<C.hash_shift^C.window[C.strstart+U-1])&C.hash_mask,Ce=C.prev[C.strstart&C.w_mask]=C.head[C.ins_h],C.head[C.ins_h]=C.strstart),--C.prev_length!=0;);if(C.match_available=0,C.match_length=U-1,C.strstart++,re&&(z(C,!1),C.strm.avail_out===0))return j}else if(C.match_available){if((re=p._tr_tally(C,0,C.window[C.strstart-1]))&&z(C,!1),C.strstart++,C.lookahead--,C.strm.avail_out===0)return j}else C.match_available=1,C.strstart++,C.lookahead--}return C.match_available&&(re=p._tr_tally(C,0,C.window[C.strstart-1]),C.match_available=0),C.insert=C.strstart<U-1?C.strstart:U-1,Ne===N?(z(C,!0),C.strm.avail_out===0?J:Z):C.last_lit&&(z(C,!1),C.strm.avail_out===0)?j:he}function ie(C,Ne,Ce,re,ee){this.good_length=C,this.max_lazy=Ne,this.nice_length=Ce,this.max_chain=re,this.func=ee}function We(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=P,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new f.Buf16(2*H),this.dyn_dtree=new f.Buf16(2*(2*Y+1)),this.bl_tree=new f.Buf16(2*(2*W+1)),Be(this.dyn_ltree),Be(this.dyn_dtree),Be(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new f.Buf16(L+1),this.heap=new f.Buf16(2*G+1),Be(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new f.Buf16(2*G+1),Be(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function ot(C){var Ne;return C&&C.state?(C.total_in=C.total_out=0,C.data_type=R,(Ne=C.state).pending=0,Ne.pending_out=0,Ne.wrap<0&&(Ne.wrap=-Ne.wrap),Ne.status=Ne.wrap?F:te,C.adler=Ne.wrap===2?0:1,Ne.last_flush=E,p._tr_init(Ne),S):De(C,I)}function ft(C){var Ne=ot(C);return Ne===S&&(function(Ce){Ce.window_size=2*Ce.w_size,Be(Ce.head),Ce.max_lazy_match=u[Ce.level].max_lazy,Ce.good_match=u[Ce.level].good_length,Ce.nice_match=u[Ce.level].nice_length,Ce.max_chain_length=u[Ce.level].max_chain,Ce.strstart=0,Ce.block_start=0,Ce.lookahead=0,Ce.insert=0,Ce.match_length=Ce.prev_length=U-1,Ce.match_available=0,Ce.ins_h=0})(C.state),Ne}function $e(C,Ne,Ce,re,ee,me){if(!C)return I;var Ve=1;if(Ne===A&&(Ne=6),re<0?(Ve=0,re=-re):15<re&&(Ve=2,re-=16),ee<1||q<ee||Ce!==P||re<8||15<re||Ne<0||9<Ne||me<0||k<me)return De(C,I);re===8&&(re=9);var Ye=new We;return(C.state=Ye).strm=C,Ye.wrap=Ve,Ye.gzhead=null,Ye.w_bits=re,Ye.w_size=1<<Ye.w_bits,Ye.w_mask=Ye.w_size-1,Ye.hash_bits=ee+7,Ye.hash_size=1<<Ye.hash_bits,Ye.hash_mask=Ye.hash_size-1,Ye.hash_shift=~~((Ye.hash_bits+U-1)/U),Ye.window=new f.Buf8(2*Ye.w_size),Ye.head=new f.Buf16(Ye.hash_size),Ye.prev=new f.Buf16(Ye.w_size),Ye.lit_bufsize=1<<ee+6,Ye.pending_buf_size=4*Ye.lit_bufsize,Ye.pending_buf=new f.Buf8(Ye.pending_buf_size),Ye.d_buf=1*Ye.lit_bufsize,Ye.l_buf=3*Ye.lit_bufsize,Ye.level=Ne,Ye.strategy=me,Ye.method=Ce,ft(C)}u=[new ie(0,0,0,0,function(C,Ne){var Ce=65535;for(Ce>C.pending_buf_size-5&&(Ce=C.pending_buf_size-5);;){if(C.lookahead<=1){if(de(C),C.lookahead===0&&Ne===E)return j;if(C.lookahead===0)break}C.strstart+=C.lookahead,C.lookahead=0;var re=C.block_start+Ce;if((C.strstart===0||C.strstart>=re)&&(C.lookahead=C.strstart-re,C.strstart=re,z(C,!1),C.strm.avail_out===0)||C.strstart-C.block_start>=C.w_size-le&&(z(C,!1),C.strm.avail_out===0))return j}return C.insert=0,Ne===N?(z(C,!0),C.strm.avail_out===0?J:Z):(C.strstart>C.block_start&&(z(C,!1),C.strm.avail_out),j)}),new ie(4,4,8,4,oe),new ie(4,5,16,8,oe),new ie(4,6,32,32,oe),new ie(4,4,16,16,ye),new ie(8,16,32,32,ye),new ie(8,16,128,128,ye),new ie(8,32,128,256,ye),new ie(32,128,258,1024,ye),new ie(32,258,258,4096,ye)],c.deflateInit=function(C,Ne){return $e(C,Ne,P,15,8,0)},c.deflateInit2=$e,c.deflateReset=ft,c.deflateResetKeep=ot,c.deflateSetHeader=function(C,Ne){return C&&C.state?C.state.wrap!==2?I:(C.state.gzhead=Ne,S):I},c.deflate=function(C,Ne){var Ce,re,ee,me;if(!C||!C.state||5<Ne||Ne<0)return C?De(C,I):I;if(re=C.state,!C.output||!C.input&&C.avail_in!==0||re.status===666&&Ne!==N)return De(C,C.avail_out===0?-5:I);if(re.strm=C,Ce=re.last_flush,re.last_flush=Ne,re.status===F)if(re.wrap===2)C.adler=0,ne(re,31),ne(re,139),ne(re,8),re.gzhead?(ne(re,(re.gzhead.text?1:0)+(re.gzhead.hcrc?2:0)+(re.gzhead.extra?4:0)+(re.gzhead.name?8:0)+(re.gzhead.comment?16:0)),ne(re,255&re.gzhead.time),ne(re,re.gzhead.time>>8&255),ne(re,re.gzhead.time>>16&255),ne(re,re.gzhead.time>>24&255),ne(re,re.level===9?2:2<=re.strategy||re.level<2?4:0),ne(re,255&re.gzhead.os),re.gzhead.extra&&re.gzhead.extra.length&&(ne(re,255&re.gzhead.extra.length),ne(re,re.gzhead.extra.length>>8&255)),re.gzhead.hcrc&&(C.adler=m(C.adler,re.pending_buf,re.pending,0)),re.gzindex=0,re.status=69):(ne(re,0),ne(re,0),ne(re,0),ne(re,0),ne(re,0),ne(re,re.level===9?2:2<=re.strategy||re.level<2?4:0),ne(re,3),re.status=te);else{var Ve=P+(re.w_bits-8<<4)<<8;Ve|=(2<=re.strategy||re.level<2?0:re.level<6?1:re.level===6?2:3)<<6,re.strstart!==0&&(Ve|=32),Ve+=31-Ve%31,re.status=te,se(re,Ve),re.strstart!==0&&(se(re,C.adler>>>16),se(re,65535&C.adler)),C.adler=1}if(re.status===69)if(re.gzhead.extra){for(ee=re.pending;re.gzindex<(65535&re.gzhead.extra.length)&&(re.pending!==re.pending_buf_size||(re.gzhead.hcrc&&re.pending>ee&&(C.adler=m(C.adler,re.pending_buf,re.pending-ee,ee)),T(C),ee=re.pending,re.pending!==re.pending_buf_size));)ne(re,255&re.gzhead.extra[re.gzindex]),re.gzindex++;re.gzhead.hcrc&&re.pending>ee&&(C.adler=m(C.adler,re.pending_buf,re.pending-ee,ee)),re.gzindex===re.gzhead.extra.length&&(re.gzindex=0,re.status=73)}else re.status=73;if(re.status===73)if(re.gzhead.name){ee=re.pending;do{if(re.pending===re.pending_buf_size&&(re.gzhead.hcrc&&re.pending>ee&&(C.adler=m(C.adler,re.pending_buf,re.pending-ee,ee)),T(C),ee=re.pending,re.pending===re.pending_buf_size)){me=1;break}me=re.gzindex<re.gzhead.name.length?255&re.gzhead.name.charCodeAt(re.gzindex++):0,ne(re,me)}while(me!==0);re.gzhead.hcrc&&re.pending>ee&&(C.adler=m(C.adler,re.pending_buf,re.pending-ee,ee)),me===0&&(re.gzindex=0,re.status=91)}else re.status=91;if(re.status===91)if(re.gzhead.comment){ee=re.pending;do{if(re.pending===re.pending_buf_size&&(re.gzhead.hcrc&&re.pending>ee&&(C.adler=m(C.adler,re.pending_buf,re.pending-ee,ee)),T(C),ee=re.pending,re.pending===re.pending_buf_size)){me=1;break}me=re.gzindex<re.gzhead.comment.length?255&re.gzhead.comment.charCodeAt(re.gzindex++):0,ne(re,me)}while(me!==0);re.gzhead.hcrc&&re.pending>ee&&(C.adler=m(C.adler,re.pending_buf,re.pending-ee,ee)),me===0&&(re.status=103)}else re.status=103;if(re.status===103&&(re.gzhead.hcrc?(re.pending+2>re.pending_buf_size&&T(C),re.pending+2<=re.pending_buf_size&&(ne(re,255&C.adler),ne(re,C.adler>>8&255),C.adler=0,re.status=te)):re.status=te),re.pending!==0){if(T(C),C.avail_out===0)return re.last_flush=-1,S}else if(C.avail_in===0&&ve(Ne)<=ve(Ce)&&Ne!==N)return De(C,-5);if(re.status===666&&C.avail_in!==0)return De(C,-5);if(C.avail_in!==0||re.lookahead!==0||Ne!==E&&re.status!==666){var Ye=re.strategy===2?(function(be,Ze){for(var at;;){if(be.lookahead===0&&(de(be),be.lookahead===0)){if(Ze===E)return j;break}if(be.match_length=0,at=p._tr_tally(be,0,be.window[be.strstart]),be.lookahead--,be.strstart++,at&&(z(be,!1),be.strm.avail_out===0))return j}return be.insert=0,Ze===N?(z(be,!0),be.strm.avail_out===0?J:Z):be.last_lit&&(z(be,!1),be.strm.avail_out===0)?j:he})(re,Ne):re.strategy===3?(function(be,Ze){for(var at,Ue,_t,It,Nt=be.window;;){if(be.lookahead<=Q){if(de(be),be.lookahead<=Q&&Ze===E)return j;if(be.lookahead===0)break}if(be.match_length=0,be.lookahead>=U&&0<be.strstart&&(Ue=Nt[_t=be.strstart-1])===Nt[++_t]&&Ue===Nt[++_t]&&Ue===Nt[++_t]){It=be.strstart+Q;do;while(Ue===Nt[++_t]&&Ue===Nt[++_t]&&Ue===Nt[++_t]&&Ue===Nt[++_t]&&Ue===Nt[++_t]&&Ue===Nt[++_t]&&Ue===Nt[++_t]&&Ue===Nt[++_t]&&_t<It);be.match_length=Q-(It-_t),be.match_length>be.lookahead&&(be.match_length=be.lookahead)}if(be.match_length>=U?(at=p._tr_tally(be,1,be.match_length-U),be.lookahead-=be.match_length,be.strstart+=be.match_length,be.match_length=0):(at=p._tr_tally(be,0,be.window[be.strstart]),be.lookahead--,be.strstart++),at&&(z(be,!1),be.strm.avail_out===0))return j}return be.insert=0,Ze===N?(z(be,!0),be.strm.avail_out===0?J:Z):be.last_lit&&(z(be,!1),be.strm.avail_out===0)?j:he})(re,Ne):u[re.level].func(re,Ne);if(Ye!==J&&Ye!==Z||(re.status=666),Ye===j||Ye===J)return C.avail_out===0&&(re.last_flush=-1),S;if(Ye===he&&(Ne===1?p._tr_align(re):Ne!==5&&(p._tr_stored_block(re,0,0,!1),Ne===3&&(Be(re.head),re.lookahead===0&&(re.strstart=0,re.block_start=0,re.insert=0))),T(C),C.avail_out===0))return re.last_flush=-1,S}return Ne!==N?S:re.wrap<=0?1:(re.wrap===2?(ne(re,255&C.adler),ne(re,C.adler>>8&255),ne(re,C.adler>>16&255),ne(re,C.adler>>24&255),ne(re,255&C.total_in),ne(re,C.total_in>>8&255),ne(re,C.total_in>>16&255),ne(re,C.total_in>>24&255)):(se(re,C.adler>>>16),se(re,65535&C.adler)),T(C),0<re.wrap&&(re.wrap=-re.wrap),re.pending!==0?S:1)},c.deflateEnd=function(C){var Ne;return C&&C.state?(Ne=C.state.status)!==F&&Ne!==69&&Ne!==73&&Ne!==91&&Ne!==103&&Ne!==te&&Ne!==666?De(C,I):(C.state=null,Ne===te?De(C,-3):S):I},c.deflateSetDictionary=function(C,Ne){var Ce,re,ee,me,Ve,Ye,be,Ze,at=Ne.length;if(!C||!C.state||(me=(Ce=C.state).wrap)===2||me===1&&Ce.status!==F||Ce.lookahead)return I;for(me===1&&(C.adler=b(C.adler,Ne,at,0)),Ce.wrap=0,at>=Ce.w_size&&(me===0&&(Be(Ce.head),Ce.strstart=0,Ce.block_start=0,Ce.insert=0),Ze=new f.Buf8(Ce.w_size),f.arraySet(Ze,Ne,at-Ce.w_size,Ce.w_size,0),Ne=Ze,at=Ce.w_size),Ve=C.avail_in,Ye=C.next_in,be=C.input,C.avail_in=at,C.next_in=0,C.input=Ne,de(Ce);Ce.lookahead>=U;){for(re=Ce.strstart,ee=Ce.lookahead-(U-1);Ce.ins_h=(Ce.ins_h<<Ce.hash_shift^Ce.window[re+U-1])&Ce.hash_mask,Ce.prev[re&Ce.w_mask]=Ce.head[Ce.ins_h],Ce.head[Ce.ins_h]=re,re++,--ee;);Ce.strstart=re,Ce.lookahead=U-1,de(Ce)}return Ce.strstart+=Ce.lookahead,Ce.block_start=Ce.strstart,Ce.insert=Ce.lookahead,Ce.lookahead=0,Ce.match_length=Ce.prev_length=U-1,Ce.match_available=0,C.next_in=Ye,C.input=be,C.avail_in=Ve,Ce.wrap=me,S},c.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(s,i,c){i.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(s,i,c){i.exports=function(u,f){var p,b,m,_,E,N,S,I,A,k,R,P,q,G,Y,W,H,L,U,Q,le,F,te,j,he;p=u.state,b=u.next_in,j=u.input,m=b+(u.avail_in-5),_=u.next_out,he=u.output,E=_-(f-u.avail_out),N=_+(u.avail_out-257),S=p.dmax,I=p.wsize,A=p.whave,k=p.wnext,R=p.window,P=p.hold,q=p.bits,G=p.lencode,Y=p.distcode,W=(1<<p.lenbits)-1,H=(1<<p.distbits)-1;e:do{q<15&&(P+=j[b++]<<q,q+=8,P+=j[b++]<<q,q+=8),L=G[P&W];t:for(;;){if(P>>>=U=L>>>24,q-=U,(U=L>>>16&255)===0)he[_++]=65535&L;else{if(!(16&U)){if((64&U)==0){L=G[(65535&L)+(P&(1<<U)-1)];continue t}if(32&U){p.mode=12;break e}u.msg="invalid literal/length code",p.mode=30;break e}Q=65535&L,(U&=15)&&(q<U&&(P+=j[b++]<<q,q+=8),Q+=P&(1<<U)-1,P>>>=U,q-=U),q<15&&(P+=j[b++]<<q,q+=8,P+=j[b++]<<q,q+=8),L=Y[P&H];n:for(;;){if(P>>>=U=L>>>24,q-=U,!(16&(U=L>>>16&255))){if((64&U)==0){L=Y[(65535&L)+(P&(1<<U)-1)];continue n}u.msg="invalid distance code",p.mode=30;break e}if(le=65535&L,q<(U&=15)&&(P+=j[b++]<<q,(q+=8)<U&&(P+=j[b++]<<q,q+=8)),S<(le+=P&(1<<U)-1)){u.msg="invalid distance too far back",p.mode=30;break e}if(P>>>=U,q-=U,(U=_-E)<le){if(A<(U=le-U)&&p.sane){u.msg="invalid distance too far back",p.mode=30;break e}if(te=R,(F=0)===k){if(F+=I-U,U<Q){for(Q-=U;he[_++]=R[F++],--U;);F=_-le,te=he}}else if(k<U){if(F+=I+k-U,(U-=k)<Q){for(Q-=U;he[_++]=R[F++],--U;);if(F=0,k<Q){for(Q-=U=k;he[_++]=R[F++],--U;);F=_-le,te=he}}}else if(F+=k-U,U<Q){for(Q-=U;he[_++]=R[F++],--U;);F=_-le,te=he}for(;2<Q;)he[_++]=te[F++],he[_++]=te[F++],he[_++]=te[F++],Q-=3;Q&&(he[_++]=te[F++],1<Q&&(he[_++]=te[F++]))}else{for(F=_-le;he[_++]=he[F++],he[_++]=he[F++],he[_++]=he[F++],2<(Q-=3););Q&&(he[_++]=he[F++],1<Q&&(he[_++]=he[F++]))}break}}break}}while(b<m&&_<N);b-=Q=q>>3,P&=(1<<(q-=Q<<3))-1,u.next_in=b,u.next_out=_,u.avail_in=b<m?m-b+5:5-(b-m),u.avail_out=_<N?N-_+257:257-(_-N),p.hold=P,p.bits=q}},{}],49:[function(s,i,c){var u=s("../utils/common"),f=s("./adler32"),p=s("./crc32"),b=s("./inffast"),m=s("./inftrees"),_=1,E=2,N=0,S=-2,I=1,A=852,k=592;function R(F){return(F>>>24&255)+(F>>>8&65280)+((65280&F)<<8)+((255&F)<<24)}function P(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new u.Buf16(320),this.work=new u.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function q(F){var te;return F&&F.state?(te=F.state,F.total_in=F.total_out=te.total=0,F.msg="",te.wrap&&(F.adler=1&te.wrap),te.mode=I,te.last=0,te.havedict=0,te.dmax=32768,te.head=null,te.hold=0,te.bits=0,te.lencode=te.lendyn=new u.Buf32(A),te.distcode=te.distdyn=new u.Buf32(k),te.sane=1,te.back=-1,N):S}function G(F){var te;return F&&F.state?((te=F.state).wsize=0,te.whave=0,te.wnext=0,q(F)):S}function Y(F,te){var j,he;return F&&F.state?(he=F.state,te<0?(j=0,te=-te):(j=1+(te>>4),te<48&&(te&=15)),te&&(te<8||15<te)?S:(he.window!==null&&he.wbits!==te&&(he.window=null),he.wrap=j,he.wbits=te,G(F))):S}function W(F,te){var j,he;return F?(he=new P,(F.state=he).window=null,(j=Y(F,te))!==N&&(F.state=null),j):S}var H,L,U=!0;function Q(F){if(U){var te;for(H=new u.Buf32(512),L=new u.Buf32(32),te=0;te<144;)F.lens[te++]=8;for(;te<256;)F.lens[te++]=9;for(;te<280;)F.lens[te++]=7;for(;te<288;)F.lens[te++]=8;for(m(_,F.lens,0,288,H,0,F.work,{bits:9}),te=0;te<32;)F.lens[te++]=5;m(E,F.lens,0,32,L,0,F.work,{bits:5}),U=!1}F.lencode=H,F.lenbits=9,F.distcode=L,F.distbits=5}function le(F,te,j,he){var J,Z=F.state;return Z.window===null&&(Z.wsize=1<<Z.wbits,Z.wnext=0,Z.whave=0,Z.window=new u.Buf8(Z.wsize)),he>=Z.wsize?(u.arraySet(Z.window,te,j-Z.wsize,Z.wsize,0),Z.wnext=0,Z.whave=Z.wsize):(he<(J=Z.wsize-Z.wnext)&&(J=he),u.arraySet(Z.window,te,j-he,J,Z.wnext),(he-=J)?(u.arraySet(Z.window,te,j-he,he,0),Z.wnext=he,Z.whave=Z.wsize):(Z.wnext+=J,Z.wnext===Z.wsize&&(Z.wnext=0),Z.whave<Z.wsize&&(Z.whave+=J))),0}c.inflateReset=G,c.inflateReset2=Y,c.inflateResetKeep=q,c.inflateInit=function(F){return W(F,15)},c.inflateInit2=W,c.inflate=function(F,te){var j,he,J,Z,De,ve,Be,T,z,ne,se,ue,de,oe,ye,ie,We,ot,ft,$e,C,Ne,Ce,re,ee=0,me=new u.Buf8(4),Ve=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!F||!F.state||!F.output||!F.input&&F.avail_in!==0)return S;(j=F.state).mode===12&&(j.mode=13),De=F.next_out,J=F.output,Be=F.avail_out,Z=F.next_in,he=F.input,ve=F.avail_in,T=j.hold,z=j.bits,ne=ve,se=Be,Ne=N;e:for(;;)switch(j.mode){case I:if(j.wrap===0){j.mode=13;break}for(;z<16;){if(ve===0)break e;ve--,T+=he[Z++]<<z,z+=8}if(2&j.wrap&&T===35615){me[j.check=0]=255&T,me[1]=T>>>8&255,j.check=p(j.check,me,2,0),z=T=0,j.mode=2;break}if(j.flags=0,j.head&&(j.head.done=!1),!(1&j.wrap)||(((255&T)<<8)+(T>>8))%31){F.msg="incorrect header check",j.mode=30;break}if((15&T)!=8){F.msg="unknown compression method",j.mode=30;break}if(z-=4,C=8+(15&(T>>>=4)),j.wbits===0)j.wbits=C;else if(C>j.wbits){F.msg="invalid window size",j.mode=30;break}j.dmax=1<<C,F.adler=j.check=1,j.mode=512&T?10:12,z=T=0;break;case 2:for(;z<16;){if(ve===0)break e;ve--,T+=he[Z++]<<z,z+=8}if(j.flags=T,(255&j.flags)!=8){F.msg="unknown compression method",j.mode=30;break}if(57344&j.flags){F.msg="unknown header flags set",j.mode=30;break}j.head&&(j.head.text=T>>8&1),512&j.flags&&(me[0]=255&T,me[1]=T>>>8&255,j.check=p(j.check,me,2,0)),z=T=0,j.mode=3;case 3:for(;z<32;){if(ve===0)break e;ve--,T+=he[Z++]<<z,z+=8}j.head&&(j.head.time=T),512&j.flags&&(me[0]=255&T,me[1]=T>>>8&255,me[2]=T>>>16&255,me[3]=T>>>24&255,j.check=p(j.check,me,4,0)),z=T=0,j.mode=4;case 4:for(;z<16;){if(ve===0)break e;ve--,T+=he[Z++]<<z,z+=8}j.head&&(j.head.xflags=255&T,j.head.os=T>>8),512&j.flags&&(me[0]=255&T,me[1]=T>>>8&255,j.check=p(j.check,me,2,0)),z=T=0,j.mode=5;case 5:if(1024&j.flags){for(;z<16;){if(ve===0)break e;ve--,T+=he[Z++]<<z,z+=8}j.length=T,j.head&&(j.head.extra_len=T),512&j.flags&&(me[0]=255&T,me[1]=T>>>8&255,j.check=p(j.check,me,2,0)),z=T=0}else j.head&&(j.head.extra=null);j.mode=6;case 6:if(1024&j.flags&&(ve<(ue=j.length)&&(ue=ve),ue&&(j.head&&(C=j.head.extra_len-j.length,j.head.extra||(j.head.extra=new Array(j.head.extra_len)),u.arraySet(j.head.extra,he,Z,ue,C)),512&j.flags&&(j.check=p(j.check,he,ue,Z)),ve-=ue,Z+=ue,j.length-=ue),j.length))break e;j.length=0,j.mode=7;case 7:if(2048&j.flags){if(ve===0)break e;for(ue=0;C=he[Z+ue++],j.head&&C&&j.length<65536&&(j.head.name+=String.fromCharCode(C)),C&&ue<ve;);if(512&j.flags&&(j.check=p(j.check,he,ue,Z)),ve-=ue,Z+=ue,C)break e}else j.head&&(j.head.name=null);j.length=0,j.mode=8;case 8:if(4096&j.flags){if(ve===0)break e;for(ue=0;C=he[Z+ue++],j.head&&C&&j.length<65536&&(j.head.comment+=String.fromCharCode(C)),C&&ue<ve;);if(512&j.flags&&(j.check=p(j.check,he,ue,Z)),ve-=ue,Z+=ue,C)break e}else j.head&&(j.head.comment=null);j.mode=9;case 9:if(512&j.flags){for(;z<16;){if(ve===0)break e;ve--,T+=he[Z++]<<z,z+=8}if(T!==(65535&j.check)){F.msg="header crc mismatch",j.mode=30;break}z=T=0}j.head&&(j.head.hcrc=j.flags>>9&1,j.head.done=!0),F.adler=j.check=0,j.mode=12;break;case 10:for(;z<32;){if(ve===0)break e;ve--,T+=he[Z++]<<z,z+=8}F.adler=j.check=R(T),z=T=0,j.mode=11;case 11:if(j.havedict===0)return F.next_out=De,F.avail_out=Be,F.next_in=Z,F.avail_in=ve,j.hold=T,j.bits=z,2;F.adler=j.check=1,j.mode=12;case 12:if(te===5||te===6)break e;case 13:if(j.last){T>>>=7&z,z-=7&z,j.mode=27;break}for(;z<3;){if(ve===0)break e;ve--,T+=he[Z++]<<z,z+=8}switch(j.last=1&T,z-=1,3&(T>>>=1)){case 0:j.mode=14;break;case 1:if(Q(j),j.mode=20,te!==6)break;T>>>=2,z-=2;break e;case 2:j.mode=17;break;case 3:F.msg="invalid block type",j.mode=30}T>>>=2,z-=2;break;case 14:for(T>>>=7&z,z-=7&z;z<32;){if(ve===0)break e;ve--,T+=he[Z++]<<z,z+=8}if((65535&T)!=(T>>>16^65535)){F.msg="invalid stored block lengths",j.mode=30;break}if(j.length=65535&T,z=T=0,j.mode=15,te===6)break e;case 15:j.mode=16;case 16:if(ue=j.length){if(ve<ue&&(ue=ve),Be<ue&&(ue=Be),ue===0)break e;u.arraySet(J,he,Z,ue,De),ve-=ue,Z+=ue,Be-=ue,De+=ue,j.length-=ue;break}j.mode=12;break;case 17:for(;z<14;){if(ve===0)break e;ve--,T+=he[Z++]<<z,z+=8}if(j.nlen=257+(31&T),T>>>=5,z-=5,j.ndist=1+(31&T),T>>>=5,z-=5,j.ncode=4+(15&T),T>>>=4,z-=4,286<j.nlen||30<j.ndist){F.msg="too many length or distance symbols",j.mode=30;break}j.have=0,j.mode=18;case 18:for(;j.have<j.ncode;){for(;z<3;){if(ve===0)break e;ve--,T+=he[Z++]<<z,z+=8}j.lens[Ve[j.have++]]=7&T,T>>>=3,z-=3}for(;j.have<19;)j.lens[Ve[j.have++]]=0;if(j.lencode=j.lendyn,j.lenbits=7,Ce={bits:j.lenbits},Ne=m(0,j.lens,0,19,j.lencode,0,j.work,Ce),j.lenbits=Ce.bits,Ne){F.msg="invalid code lengths set",j.mode=30;break}j.have=0,j.mode=19;case 19:for(;j.have<j.nlen+j.ndist;){for(;ie=(ee=j.lencode[T&(1<<j.lenbits)-1])>>>16&255,We=65535&ee,!((ye=ee>>>24)<=z);){if(ve===0)break e;ve--,T+=he[Z++]<<z,z+=8}if(We<16)T>>>=ye,z-=ye,j.lens[j.have++]=We;else{if(We===16){for(re=ye+2;z<re;){if(ve===0)break e;ve--,T+=he[Z++]<<z,z+=8}if(T>>>=ye,z-=ye,j.have===0){F.msg="invalid bit length repeat",j.mode=30;break}C=j.lens[j.have-1],ue=3+(3&T),T>>>=2,z-=2}else if(We===17){for(re=ye+3;z<re;){if(ve===0)break e;ve--,T+=he[Z++]<<z,z+=8}z-=ye,C=0,ue=3+(7&(T>>>=ye)),T>>>=3,z-=3}else{for(re=ye+7;z<re;){if(ve===0)break e;ve--,T+=he[Z++]<<z,z+=8}z-=ye,C=0,ue=11+(127&(T>>>=ye)),T>>>=7,z-=7}if(j.have+ue>j.nlen+j.ndist){F.msg="invalid bit length repeat",j.mode=30;break}for(;ue--;)j.lens[j.have++]=C}}if(j.mode===30)break;if(j.lens[256]===0){F.msg="invalid code -- missing end-of-block",j.mode=30;break}if(j.lenbits=9,Ce={bits:j.lenbits},Ne=m(_,j.lens,0,j.nlen,j.lencode,0,j.work,Ce),j.lenbits=Ce.bits,Ne){F.msg="invalid literal/lengths set",j.mode=30;break}if(j.distbits=6,j.distcode=j.distdyn,Ce={bits:j.distbits},Ne=m(E,j.lens,j.nlen,j.ndist,j.distcode,0,j.work,Ce),j.distbits=Ce.bits,Ne){F.msg="invalid distances set",j.mode=30;break}if(j.mode=20,te===6)break e;case 20:j.mode=21;case 21:if(6<=ve&&258<=Be){F.next_out=De,F.avail_out=Be,F.next_in=Z,F.avail_in=ve,j.hold=T,j.bits=z,b(F,se),De=F.next_out,J=F.output,Be=F.avail_out,Z=F.next_in,he=F.input,ve=F.avail_in,T=j.hold,z=j.bits,j.mode===12&&(j.back=-1);break}for(j.back=0;ie=(ee=j.lencode[T&(1<<j.lenbits)-1])>>>16&255,We=65535&ee,!((ye=ee>>>24)<=z);){if(ve===0)break e;ve--,T+=he[Z++]<<z,z+=8}if(ie&&(240&ie)==0){for(ot=ye,ft=ie,$e=We;ie=(ee=j.lencode[$e+((T&(1<<ot+ft)-1)>>ot)])>>>16&255,We=65535&ee,!(ot+(ye=ee>>>24)<=z);){if(ve===0)break e;ve--,T+=he[Z++]<<z,z+=8}T>>>=ot,z-=ot,j.back+=ot}if(T>>>=ye,z-=ye,j.back+=ye,j.length=We,ie===0){j.mode=26;break}if(32&ie){j.back=-1,j.mode=12;break}if(64&ie){F.msg="invalid literal/length code",j.mode=30;break}j.extra=15&ie,j.mode=22;case 22:if(j.extra){for(re=j.extra;z<re;){if(ve===0)break e;ve--,T+=he[Z++]<<z,z+=8}j.length+=T&(1<<j.extra)-1,T>>>=j.extra,z-=j.extra,j.back+=j.extra}j.was=j.length,j.mode=23;case 23:for(;ie=(ee=j.distcode[T&(1<<j.distbits)-1])>>>16&255,We=65535&ee,!((ye=ee>>>24)<=z);){if(ve===0)break e;ve--,T+=he[Z++]<<z,z+=8}if((240&ie)==0){for(ot=ye,ft=ie,$e=We;ie=(ee=j.distcode[$e+((T&(1<<ot+ft)-1)>>ot)])>>>16&255,We=65535&ee,!(ot+(ye=ee>>>24)<=z);){if(ve===0)break e;ve--,T+=he[Z++]<<z,z+=8}T>>>=ot,z-=ot,j.back+=ot}if(T>>>=ye,z-=ye,j.back+=ye,64&ie){F.msg="invalid distance code",j.mode=30;break}j.offset=We,j.extra=15&ie,j.mode=24;case 24:if(j.extra){for(re=j.extra;z<re;){if(ve===0)break e;ve--,T+=he[Z++]<<z,z+=8}j.offset+=T&(1<<j.extra)-1,T>>>=j.extra,z-=j.extra,j.back+=j.extra}if(j.offset>j.dmax){F.msg="invalid distance too far back",j.mode=30;break}j.mode=25;case 25:if(Be===0)break e;if(ue=se-Be,j.offset>ue){if((ue=j.offset-ue)>j.whave&&j.sane){F.msg="invalid distance too far back",j.mode=30;break}de=ue>j.wnext?(ue-=j.wnext,j.wsize-ue):j.wnext-ue,ue>j.length&&(ue=j.length),oe=j.window}else oe=J,de=De-j.offset,ue=j.length;for(Be<ue&&(ue=Be),Be-=ue,j.length-=ue;J[De++]=oe[de++],--ue;);j.length===0&&(j.mode=21);break;case 26:if(Be===0)break e;J[De++]=j.length,Be--,j.mode=21;break;case 27:if(j.wrap){for(;z<32;){if(ve===0)break e;ve--,T|=he[Z++]<<z,z+=8}if(se-=Be,F.total_out+=se,j.total+=se,se&&(F.adler=j.check=j.flags?p(j.check,J,se,De-se):f(j.check,J,se,De-se)),se=Be,(j.flags?T:R(T))!==j.check){F.msg="incorrect data check",j.mode=30;break}z=T=0}j.mode=28;case 28:if(j.wrap&&j.flags){for(;z<32;){if(ve===0)break e;ve--,T+=he[Z++]<<z,z+=8}if(T!==(4294967295&j.total)){F.msg="incorrect length check",j.mode=30;break}z=T=0}j.mode=29;case 29:Ne=1;break e;case 30:Ne=-3;break e;case 31:return-4;case 32:default:return S}return F.next_out=De,F.avail_out=Be,F.next_in=Z,F.avail_in=ve,j.hold=T,j.bits=z,(j.wsize||se!==F.avail_out&&j.mode<30&&(j.mode<27||te!==4))&&le(F,F.output,F.next_out,se-F.avail_out)?(j.mode=31,-4):(ne-=F.avail_in,se-=F.avail_out,F.total_in+=ne,F.total_out+=se,j.total+=se,j.wrap&&se&&(F.adler=j.check=j.flags?p(j.check,J,se,F.next_out-se):f(j.check,J,se,F.next_out-se)),F.data_type=j.bits+(j.last?64:0)+(j.mode===12?128:0)+(j.mode===20||j.mode===15?256:0),(ne==0&&se===0||te===4)&&Ne===N&&(Ne=-5),Ne)},c.inflateEnd=function(F){if(!F||!F.state)return S;var te=F.state;return te.window&&(te.window=null),F.state=null,N},c.inflateGetHeader=function(F,te){var j;return F&&F.state?(2&(j=F.state).wrap)==0?S:((j.head=te).done=!1,N):S},c.inflateSetDictionary=function(F,te){var j,he=te.length;return F&&F.state?(j=F.state).wrap!==0&&j.mode!==11?S:j.mode===11&&f(1,te,he,0)!==j.check?-3:le(F,te,he,he)?(j.mode=31,-4):(j.havedict=1,N):S},c.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(s,i,c){var u=s("../utils/common"),f=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],p=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],b=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],m=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];i.exports=function(_,E,N,S,I,A,k,R){var P,q,G,Y,W,H,L,U,Q,le=R.bits,F=0,te=0,j=0,he=0,J=0,Z=0,De=0,ve=0,Be=0,T=0,z=null,ne=0,se=new u.Buf16(16),ue=new u.Buf16(16),de=null,oe=0;for(F=0;F<=15;F++)se[F]=0;for(te=0;te<S;te++)se[E[N+te]]++;for(J=le,he=15;1<=he&&se[he]===0;he--);if(he<J&&(J=he),he===0)return I[A++]=20971520,I[A++]=20971520,R.bits=1,0;for(j=1;j<he&&se[j]===0;j++);for(J<j&&(J=j),F=ve=1;F<=15;F++)if(ve<<=1,(ve-=se[F])<0)return-1;if(0<ve&&(_===0||he!==1))return-1;for(ue[1]=0,F=1;F<15;F++)ue[F+1]=ue[F]+se[F];for(te=0;te<S;te++)E[N+te]!==0&&(k[ue[E[N+te]]++]=te);if(H=_===0?(z=de=k,19):_===1?(z=f,ne-=257,de=p,oe-=257,256):(z=b,de=m,-1),F=j,W=A,De=te=T=0,G=-1,Y=(Be=1<<(Z=J))-1,_===1&&852<Be||_===2&&592<Be)return 1;for(;;){for(L=F-De,Q=k[te]<H?(U=0,k[te]):k[te]>H?(U=de[oe+k[te]],z[ne+k[te]]):(U=96,0),P=1<<F-De,j=q=1<<Z;I[W+(T>>De)+(q-=P)]=L<<24|U<<16|Q|0,q!==0;);for(P=1<<F-1;T&P;)P>>=1;if(P!==0?(T&=P-1,T+=P):T=0,te++,--se[F]==0){if(F===he)break;F=E[N+k[te]]}if(J<F&&(T&Y)!==G){for(De===0&&(De=J),W+=j,ve=1<<(Z=F-De);Z+De<he&&!((ve-=se[Z+De])<=0);)Z++,ve<<=1;if(Be+=1<<Z,_===1&&852<Be||_===2&&592<Be)return 1;I[G=T&Y]=J<<24|Z<<16|W-A|0}}return T!==0&&(I[W+T]=F-De<<24|64<<16|0),R.bits=J,0}},{"../utils/common":41}],51:[function(s,i,c){i.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(s,i,c){var u=s("../utils/common"),f=0,p=1;function b(ee){for(var me=ee.length;0<=--me;)ee[me]=0}var m=0,_=29,E=256,N=E+1+_,S=30,I=19,A=2*N+1,k=15,R=16,P=7,q=256,G=16,Y=17,W=18,H=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],L=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],U=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],Q=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],le=new Array(2*(N+2));b(le);var F=new Array(2*S);b(F);var te=new Array(512);b(te);var j=new Array(256);b(j);var he=new Array(_);b(he);var J,Z,De,ve=new Array(S);function Be(ee,me,Ve,Ye,be){this.static_tree=ee,this.extra_bits=me,this.extra_base=Ve,this.elems=Ye,this.max_length=be,this.has_stree=ee&&ee.length}function T(ee,me){this.dyn_tree=ee,this.max_code=0,this.stat_desc=me}function z(ee){return ee<256?te[ee]:te[256+(ee>>>7)]}function ne(ee,me){ee.pending_buf[ee.pending++]=255&me,ee.pending_buf[ee.pending++]=me>>>8&255}function se(ee,me,Ve){ee.bi_valid>R-Ve?(ee.bi_buf|=me<<ee.bi_valid&65535,ne(ee,ee.bi_buf),ee.bi_buf=me>>R-ee.bi_valid,ee.bi_valid+=Ve-R):(ee.bi_buf|=me<<ee.bi_valid&65535,ee.bi_valid+=Ve)}function ue(ee,me,Ve){se(ee,Ve[2*me],Ve[2*me+1])}function de(ee,me){for(var Ve=0;Ve|=1&ee,ee>>>=1,Ve<<=1,0<--me;);return Ve>>>1}function oe(ee,me,Ve){var Ye,be,Ze=new Array(k+1),at=0;for(Ye=1;Ye<=k;Ye++)Ze[Ye]=at=at+Ve[Ye-1]<<1;for(be=0;be<=me;be++){var Ue=ee[2*be+1];Ue!==0&&(ee[2*be]=de(Ze[Ue]++,Ue))}}function ye(ee){var me;for(me=0;me<N;me++)ee.dyn_ltree[2*me]=0;for(me=0;me<S;me++)ee.dyn_dtree[2*me]=0;for(me=0;me<I;me++)ee.bl_tree[2*me]=0;ee.dyn_ltree[2*q]=1,ee.opt_len=ee.static_len=0,ee.last_lit=ee.matches=0}function ie(ee){8<ee.bi_valid?ne(ee,ee.bi_buf):0<ee.bi_valid&&(ee.pending_buf[ee.pending++]=ee.bi_buf),ee.bi_buf=0,ee.bi_valid=0}function We(ee,me,Ve,Ye){var be=2*me,Ze=2*Ve;return ee[be]<ee[Ze]||ee[be]===ee[Ze]&&Ye[me]<=Ye[Ve]}function ot(ee,me,Ve){for(var Ye=ee.heap[Ve],be=Ve<<1;be<=ee.heap_len&&(be<ee.heap_len&&We(me,ee.heap[be+1],ee.heap[be],ee.depth)&&be++,!We(me,Ye,ee.heap[be],ee.depth));)ee.heap[Ve]=ee.heap[be],Ve=be,be<<=1;ee.heap[Ve]=Ye}function ft(ee,me,Ve){var Ye,be,Ze,at,Ue=0;if(ee.last_lit!==0)for(;Ye=ee.pending_buf[ee.d_buf+2*Ue]<<8|ee.pending_buf[ee.d_buf+2*Ue+1],be=ee.pending_buf[ee.l_buf+Ue],Ue++,Ye===0?ue(ee,be,me):(ue(ee,(Ze=j[be])+E+1,me),(at=H[Ze])!==0&&se(ee,be-=he[Ze],at),ue(ee,Ze=z(--Ye),Ve),(at=L[Ze])!==0&&se(ee,Ye-=ve[Ze],at)),Ue<ee.last_lit;);ue(ee,q,me)}function $e(ee,me){var Ve,Ye,be,Ze=me.dyn_tree,at=me.stat_desc.static_tree,Ue=me.stat_desc.has_stree,_t=me.stat_desc.elems,It=-1;for(ee.heap_len=0,ee.heap_max=A,Ve=0;Ve<_t;Ve++)Ze[2*Ve]!==0?(ee.heap[++ee.heap_len]=It=Ve,ee.depth[Ve]=0):Ze[2*Ve+1]=0;for(;ee.heap_len<2;)Ze[2*(be=ee.heap[++ee.heap_len]=It<2?++It:0)]=1,ee.depth[be]=0,ee.opt_len--,Ue&&(ee.static_len-=at[2*be+1]);for(me.max_code=It,Ve=ee.heap_len>>1;1<=Ve;Ve--)ot(ee,Ze,Ve);for(be=_t;Ve=ee.heap[1],ee.heap[1]=ee.heap[ee.heap_len--],ot(ee,Ze,1),Ye=ee.heap[1],ee.heap[--ee.heap_max]=Ve,ee.heap[--ee.heap_max]=Ye,Ze[2*be]=Ze[2*Ve]+Ze[2*Ye],ee.depth[be]=(ee.depth[Ve]>=ee.depth[Ye]?ee.depth[Ve]:ee.depth[Ye])+1,Ze[2*Ve+1]=Ze[2*Ye+1]=be,ee.heap[1]=be++,ot(ee,Ze,1),2<=ee.heap_len;);ee.heap[--ee.heap_max]=ee.heap[1],(function(Nt,on){var Zt,cn,bn,zt,Ht,yt,tn=on.dyn_tree,or=on.max_code,At=on.stat_desc.static_tree,gt=on.stat_desc.has_stree,jr=on.stat_desc.extra_bits,An=on.stat_desc.extra_base,qn=on.stat_desc.max_length,vr=0;for(zt=0;zt<=k;zt++)Nt.bl_count[zt]=0;for(tn[2*Nt.heap[Nt.heap_max]+1]=0,Zt=Nt.heap_max+1;Zt<A;Zt++)qn<(zt=tn[2*tn[2*(cn=Nt.heap[Zt])+1]+1]+1)&&(zt=qn,vr++),tn[2*cn+1]=zt,or<cn||(Nt.bl_count[zt]++,Ht=0,An<=cn&&(Ht=jr[cn-An]),yt=tn[2*cn],Nt.opt_len+=yt*(zt+Ht),gt&&(Nt.static_len+=yt*(At[2*cn+1]+Ht)));if(vr!==0){do{for(zt=qn-1;Nt.bl_count[zt]===0;)zt--;Nt.bl_count[zt]--,Nt.bl_count[zt+1]+=2,Nt.bl_count[qn]--,vr-=2}while(0<vr);for(zt=qn;zt!==0;zt--)for(cn=Nt.bl_count[zt];cn!==0;)or<(bn=Nt.heap[--Zt])||(tn[2*bn+1]!==zt&&(Nt.opt_len+=(zt-tn[2*bn+1])*tn[2*bn],tn[2*bn+1]=zt),cn--)}})(ee,me),oe(Ze,It,ee.bl_count)}function C(ee,me,Ve){var Ye,be,Ze=-1,at=me[1],Ue=0,_t=7,It=4;for(at===0&&(_t=138,It=3),me[2*(Ve+1)+1]=65535,Ye=0;Ye<=Ve;Ye++)be=at,at=me[2*(Ye+1)+1],++Ue<_t&&be===at||(Ue<It?ee.bl_tree[2*be]+=Ue:be!==0?(be!==Ze&&ee.bl_tree[2*be]++,ee.bl_tree[2*G]++):Ue<=10?ee.bl_tree[2*Y]++:ee.bl_tree[2*W]++,Ze=be,It=(Ue=0)===at?(_t=138,3):be===at?(_t=6,3):(_t=7,4))}function Ne(ee,me,Ve){var Ye,be,Ze=-1,at=me[1],Ue=0,_t=7,It=4;for(at===0&&(_t=138,It=3),Ye=0;Ye<=Ve;Ye++)if(be=at,at=me[2*(Ye+1)+1],!(++Ue<_t&&be===at)){if(Ue<It)for(;ue(ee,be,ee.bl_tree),--Ue!=0;);else be!==0?(be!==Ze&&(ue(ee,be,ee.bl_tree),Ue--),ue(ee,G,ee.bl_tree),se(ee,Ue-3,2)):Ue<=10?(ue(ee,Y,ee.bl_tree),se(ee,Ue-3,3)):(ue(ee,W,ee.bl_tree),se(ee,Ue-11,7));Ze=be,It=(Ue=0)===at?(_t=138,3):be===at?(_t=6,3):(_t=7,4)}}b(ve);var Ce=!1;function re(ee,me,Ve,Ye){se(ee,(m<<1)+(Ye?1:0),3),(function(be,Ze,at,Ue){ie(be),ne(be,at),ne(be,~at),u.arraySet(be.pending_buf,be.window,Ze,at,be.pending),be.pending+=at})(ee,me,Ve)}c._tr_init=function(ee){Ce||((function(){var me,Ve,Ye,be,Ze,at=new Array(k+1);for(be=Ye=0;be<_-1;be++)for(he[be]=Ye,me=0;me<1<<H[be];me++)j[Ye++]=be;for(j[Ye-1]=be,be=Ze=0;be<16;be++)for(ve[be]=Ze,me=0;me<1<<L[be];me++)te[Ze++]=be;for(Ze>>=7;be<S;be++)for(ve[be]=Ze<<7,me=0;me<1<<L[be]-7;me++)te[256+Ze++]=be;for(Ve=0;Ve<=k;Ve++)at[Ve]=0;for(me=0;me<=143;)le[2*me+1]=8,me++,at[8]++;for(;me<=255;)le[2*me+1]=9,me++,at[9]++;for(;me<=279;)le[2*me+1]=7,me++,at[7]++;for(;me<=287;)le[2*me+1]=8,me++,at[8]++;for(oe(le,N+1,at),me=0;me<S;me++)F[2*me+1]=5,F[2*me]=de(me,5);J=new Be(le,H,E+1,N,k),Z=new Be(F,L,0,S,k),De=new Be(new Array(0),U,0,I,P)})(),Ce=!0),ee.l_desc=new T(ee.dyn_ltree,J),ee.d_desc=new T(ee.dyn_dtree,Z),ee.bl_desc=new T(ee.bl_tree,De),ee.bi_buf=0,ee.bi_valid=0,ye(ee)},c._tr_stored_block=re,c._tr_flush_block=function(ee,me,Ve,Ye){var be,Ze,at=0;0<ee.level?(ee.strm.data_type===2&&(ee.strm.data_type=(function(Ue){var _t,It=4093624447;for(_t=0;_t<=31;_t++,It>>>=1)if(1&It&&Ue.dyn_ltree[2*_t]!==0)return f;if(Ue.dyn_ltree[18]!==0||Ue.dyn_ltree[20]!==0||Ue.dyn_ltree[26]!==0)return p;for(_t=32;_t<E;_t++)if(Ue.dyn_ltree[2*_t]!==0)return p;return f})(ee)),$e(ee,ee.l_desc),$e(ee,ee.d_desc),at=(function(Ue){var _t;for(C(Ue,Ue.dyn_ltree,Ue.l_desc.max_code),C(Ue,Ue.dyn_dtree,Ue.d_desc.max_code),$e(Ue,Ue.bl_desc),_t=I-1;3<=_t&&Ue.bl_tree[2*Q[_t]+1]===0;_t--);return Ue.opt_len+=3*(_t+1)+5+5+4,_t})(ee),be=ee.opt_len+3+7>>>3,(Ze=ee.static_len+3+7>>>3)<=be&&(be=Ze)):be=Ze=Ve+5,Ve+4<=be&&me!==-1?re(ee,me,Ve,Ye):ee.strategy===4||Ze===be?(se(ee,2+(Ye?1:0),3),ft(ee,le,F)):(se(ee,4+(Ye?1:0),3),(function(Ue,_t,It,Nt){var on;for(se(Ue,_t-257,5),se(Ue,It-1,5),se(Ue,Nt-4,4),on=0;on<Nt;on++)se(Ue,Ue.bl_tree[2*Q[on]+1],3);Ne(Ue,Ue.dyn_ltree,_t-1),Ne(Ue,Ue.dyn_dtree,It-1)})(ee,ee.l_desc.max_code+1,ee.d_desc.max_code+1,at+1),ft(ee,ee.dyn_ltree,ee.dyn_dtree)),ye(ee),Ye&&ie(ee)},c._tr_tally=function(ee,me,Ve){return ee.pending_buf[ee.d_buf+2*ee.last_lit]=me>>>8&255,ee.pending_buf[ee.d_buf+2*ee.last_lit+1]=255&me,ee.pending_buf[ee.l_buf+ee.last_lit]=255&Ve,ee.last_lit++,me===0?ee.dyn_ltree[2*Ve]++:(ee.matches++,me--,ee.dyn_ltree[2*(j[Ve]+E+1)]++,ee.dyn_dtree[2*z(me)]++),ee.last_lit===ee.lit_bufsize-1},c._tr_align=function(ee){se(ee,2,3),ue(ee,q,le),(function(me){me.bi_valid===16?(ne(me,me.bi_buf),me.bi_buf=0,me.bi_valid=0):8<=me.bi_valid&&(me.pending_buf[me.pending++]=255&me.bi_buf,me.bi_buf>>=8,me.bi_valid-=8)})(ee)}},{"../utils/common":41}],53:[function(s,i,c){i.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(s,i,c){(function(u){(function(f,p){if(!f.setImmediate){var b,m,_,E,N=1,S={},I=!1,A=f.document,k=Object.getPrototypeOf&&Object.getPrototypeOf(f);k=k&&k.setTimeout?k:f,b={}.toString.call(f.process)==="[object process]"?function(G){process.nextTick(function(){P(G)})}:(function(){if(f.postMessage&&!f.importScripts){var G=!0,Y=f.onmessage;return f.onmessage=function(){G=!1},f.postMessage("","*"),f.onmessage=Y,G}})()?(E="setImmediate$"+Math.random()+"$",f.addEventListener?f.addEventListener("message",q,!1):f.attachEvent("onmessage",q),function(G){f.postMessage(E+G,"*")}):f.MessageChannel?((_=new MessageChannel).port1.onmessage=function(G){P(G.data)},function(G){_.port2.postMessage(G)}):A&&"onreadystatechange"in A.createElement("script")?(m=A.documentElement,function(G){var Y=A.createElement("script");Y.onreadystatechange=function(){P(G),Y.onreadystatechange=null,m.removeChild(Y),Y=null},m.appendChild(Y)}):function(G){setTimeout(P,0,G)},k.setImmediate=function(G){typeof G!="function"&&(G=new Function(""+G));for(var Y=new Array(arguments.length-1),W=0;W<Y.length;W++)Y[W]=arguments[W+1];var H={callback:G,args:Y};return S[N]=H,b(N),N++},k.clearImmediate=R}function R(G){delete S[G]}function P(G){if(I)setTimeout(P,0,G);else{var Y=S[G];if(Y){I=!0;try{(function(W){var H=W.callback,L=W.args;switch(L.length){case 0:H();break;case 1:H(L[0]);break;case 2:H(L[0],L[1]);break;case 3:H(L[0],L[1],L[2]);break;default:H.apply(p,L)}})(Y)}finally{R(G),I=!1}}}}function q(G){G.source===f&&typeof G.data=="string"&&G.data.indexOf(E)===0&&P(+G.data.slice(E.length))}})(typeof self>"u"?u===void 0?this:u:self)}).call(this,typeof mc<"u"?mc:typeof self<"u"?self:typeof window<"u"?window:{})},{}]},{},[10])(10)})})(_h)),_h.exports}var IS=jS();const lp=Co(IS);var td={exports:{}};/* @license
Papa Parse
v5.4.1
https://github.com/mholt/PapaParse
License: MIT
*/var RS=td.exports,By;function MS(){return By||(By=1,(function(n,a){(function(s,i){n.exports=i()})(RS,function s(){var i=typeof self<"u"?self:typeof window<"u"?window:i!==void 0?i:{},c=!i.document&&!!i.postMessage,u=i.IS_PAPA_WORKER||!1,f={},p=0,b={parse:function(L,U){var Q=(U=U||{}).dynamicTyping||!1;if(H(Q)&&(U.dynamicTypingFunction=Q,Q={}),U.dynamicTyping=Q,U.transform=!!H(U.transform)&&U.transform,U.worker&&b.WORKERS_SUPPORTED){var le=(function(){if(!b.WORKERS_SUPPORTED)return!1;var te=(he=i.URL||i.webkitURL||null,J=s.toString(),b.BLOB_URL||(b.BLOB_URL=he.createObjectURL(new Blob(["var global = (function() { if (typeof self !== 'undefined') { return self; } if (typeof window !== 'undefined') { return window; } if (typeof global !== 'undefined') { return global; } return {}; })(); global.IS_PAPA_WORKER=true; ","(",J,")();"],{type:"text/javascript"})))),j=new i.Worker(te),he,J;return j.onmessage=P,j.id=p++,f[j.id]=j})();return le.userStep=U.step,le.userChunk=U.chunk,le.userComplete=U.complete,le.userError=U.error,U.step=H(U.step),U.chunk=H(U.chunk),U.complete=H(U.complete),U.error=H(U.error),delete U.worker,void le.postMessage({input:L,config:U,workerId:le.id})}var F=null;return b.NODE_STREAM_INPUT,typeof L=="string"?(L=(function(te){return te.charCodeAt(0)===65279?te.slice(1):te})(L),F=U.download?new E(U):new S(U)):L.readable===!0&&H(L.read)&&H(L.on)?F=new I(U):(i.File&&L instanceof File||L instanceof Object)&&(F=new N(U)),F.stream(L)},unparse:function(L,U){var Q=!1,le=!0,F=",",te=`\r
`,j='"',he=j+j,J=!1,Z=null,De=!1;(function(){if(typeof U=="object"){if(typeof U.delimiter!="string"||b.BAD_DELIMITERS.filter(function(z){return U.delimiter.indexOf(z)!==-1}).length||(F=U.delimiter),(typeof U.quotes=="boolean"||typeof U.quotes=="function"||Array.isArray(U.quotes))&&(Q=U.quotes),typeof U.skipEmptyLines!="boolean"&&typeof U.skipEmptyLines!="string"||(J=U.skipEmptyLines),typeof U.newline=="string"&&(te=U.newline),typeof U.quoteChar=="string"&&(j=U.quoteChar),typeof U.header=="boolean"&&(le=U.header),Array.isArray(U.columns)){if(U.columns.length===0)throw new Error("Option columns is empty");Z=U.columns}U.escapeChar!==void 0&&(he=U.escapeChar+j),(typeof U.escapeFormulae=="boolean"||U.escapeFormulae instanceof RegExp)&&(De=U.escapeFormulae instanceof RegExp?U.escapeFormulae:/^[=+\-@\t\r].*$/)}})();var ve=new RegExp(k(j),"g");if(typeof L=="string"&&(L=JSON.parse(L)),Array.isArray(L)){if(!L.length||Array.isArray(L[0]))return Be(null,L,J);if(typeof L[0]=="object")return Be(Z||Object.keys(L[0]),L,J)}else if(typeof L=="object")return typeof L.data=="string"&&(L.data=JSON.parse(L.data)),Array.isArray(L.data)&&(L.fields||(L.fields=L.meta&&L.meta.fields||Z),L.fields||(L.fields=Array.isArray(L.data[0])?L.fields:typeof L.data[0]=="object"?Object.keys(L.data[0]):[]),Array.isArray(L.data[0])||typeof L.data[0]=="object"||(L.data=[L.data])),Be(L.fields||[],L.data||[],J);throw new Error("Unable to serialize unrecognized input");function Be(z,ne,se){var ue="";typeof z=="string"&&(z=JSON.parse(z)),typeof ne=="string"&&(ne=JSON.parse(ne));var de=Array.isArray(z)&&0<z.length,oe=!Array.isArray(ne[0]);if(de&&le){for(var ye=0;ye<z.length;ye++)0<ye&&(ue+=F),ue+=T(z[ye],ye);0<ne.length&&(ue+=te)}for(var ie=0;ie<ne.length;ie++){var We=de?z.length:ne[ie].length,ot=!1,ft=de?Object.keys(ne[ie]).length===0:ne[ie].length===0;if(se&&!de&&(ot=se==="greedy"?ne[ie].join("").trim()==="":ne[ie].length===1&&ne[ie][0].length===0),se==="greedy"&&de){for(var $e=[],C=0;C<We;C++){var Ne=oe?z[C]:C;$e.push(ne[ie][Ne])}ot=$e.join("").trim()===""}if(!ot){for(var Ce=0;Ce<We;Ce++){0<Ce&&!ft&&(ue+=F);var re=de&&oe?z[Ce]:Ce;ue+=T(ne[ie][re],Ce)}ie<ne.length-1&&(!se||0<We&&!ft)&&(ue+=te)}}return ue}function T(z,ne){if(z==null)return"";if(z.constructor===Date)return JSON.stringify(z).slice(1,25);var se=!1;De&&typeof z=="string"&&De.test(z)&&(z="'"+z,se=!0);var ue=z.toString().replace(ve,he);return(se=se||Q===!0||typeof Q=="function"&&Q(z,ne)||Array.isArray(Q)&&Q[ne]||(function(de,oe){for(var ye=0;ye<oe.length;ye++)if(-1<de.indexOf(oe[ye]))return!0;return!1})(ue,b.BAD_DELIMITERS)||-1<ue.indexOf(F)||ue.charAt(0)===" "||ue.charAt(ue.length-1)===" ")?j+ue+j:ue}}};if(b.RECORD_SEP="",b.UNIT_SEP="",b.BYTE_ORDER_MARK="\uFEFF",b.BAD_DELIMITERS=["\r",`
`,'"',b.BYTE_ORDER_MARK],b.WORKERS_SUPPORTED=!c&&!!i.Worker,b.NODE_STREAM_INPUT=1,b.LocalChunkSize=10485760,b.RemoteChunkSize=5242880,b.DefaultDelimiter=",",b.Parser=R,b.ParserHandle=A,b.NetworkStreamer=E,b.FileStreamer=N,b.StringStreamer=S,b.ReadableStreamStreamer=I,i.jQuery){var m=i.jQuery;m.fn.parse=function(L){var U=L.config||{},Q=[];return this.each(function(te){if(!(m(this).prop("tagName").toUpperCase()==="INPUT"&&m(this).attr("type").toLowerCase()==="file"&&i.FileReader)||!this.files||this.files.length===0)return!0;for(var j=0;j<this.files.length;j++)Q.push({file:this.files[j],inputElem:this,instanceConfig:m.extend({},U)})}),le(),this;function le(){if(Q.length!==0){var te,j,he,J,Z=Q[0];if(H(L.before)){var De=L.before(Z.file,Z.inputElem);if(typeof De=="object"){if(De.action==="abort")return te="AbortError",j=Z.file,he=Z.inputElem,J=De.reason,void(H(L.error)&&L.error({name:te},j,he,J));if(De.action==="skip")return void F();typeof De.config=="object"&&(Z.instanceConfig=m.extend(Z.instanceConfig,De.config))}else if(De==="skip")return void F()}var ve=Z.instanceConfig.complete;Z.instanceConfig.complete=function(Be){H(ve)&&ve(Be,Z.file,Z.inputElem),F()},b.parse(Z.file,Z.instanceConfig)}else H(L.complete)&&L.complete()}function F(){Q.splice(0,1),le()}}}function _(L){this._handle=null,this._finished=!1,this._completed=!1,this._halted=!1,this._input=null,this._baseIndex=0,this._partialLine="",this._rowCount=0,this._start=0,this._nextChunk=null,this.isFirstChunk=!0,this._completeResults={data:[],errors:[],meta:{}},(function(U){var Q=Y(U);Q.chunkSize=parseInt(Q.chunkSize),U.step||U.chunk||(Q.chunkSize=null),this._handle=new A(Q),(this._handle.streamer=this)._config=Q}).call(this,L),this.parseChunk=function(U,Q){if(this.isFirstChunk&&H(this._config.beforeFirstChunk)){var le=this._config.beforeFirstChunk(U);le!==void 0&&(U=le)}this.isFirstChunk=!1,this._halted=!1;var F=this._partialLine+U;this._partialLine="";var te=this._handle.parse(F,this._baseIndex,!this._finished);if(!this._handle.paused()&&!this._handle.aborted()){var j=te.meta.cursor;this._finished||(this._partialLine=F.substring(j-this._baseIndex),this._baseIndex=j),te&&te.data&&(this._rowCount+=te.data.length);var he=this._finished||this._config.preview&&this._rowCount>=this._config.preview;if(u)i.postMessage({results:te,workerId:b.WORKER_ID,finished:he});else if(H(this._config.chunk)&&!Q){if(this._config.chunk(te,this._handle),this._handle.paused()||this._handle.aborted())return void(this._halted=!0);te=void 0,this._completeResults=void 0}return this._config.step||this._config.chunk||(this._completeResults.data=this._completeResults.data.concat(te.data),this._completeResults.errors=this._completeResults.errors.concat(te.errors),this._completeResults.meta=te.meta),this._completed||!he||!H(this._config.complete)||te&&te.meta.aborted||(this._config.complete(this._completeResults,this._input),this._completed=!0),he||te&&te.meta.paused||this._nextChunk(),te}this._halted=!0},this._sendError=function(U){H(this._config.error)?this._config.error(U):u&&this._config.error&&i.postMessage({workerId:b.WORKER_ID,error:U,finished:!1})}}function E(L){var U;(L=L||{}).chunkSize||(L.chunkSize=b.RemoteChunkSize),_.call(this,L),this._nextChunk=c?function(){this._readChunk(),this._chunkLoaded()}:function(){this._readChunk()},this.stream=function(Q){this._input=Q,this._nextChunk()},this._readChunk=function(){if(this._finished)this._chunkLoaded();else{if(U=new XMLHttpRequest,this._config.withCredentials&&(U.withCredentials=this._config.withCredentials),c||(U.onload=W(this._chunkLoaded,this),U.onerror=W(this._chunkError,this)),U.open(this._config.downloadRequestBody?"POST":"GET",this._input,!c),this._config.downloadRequestHeaders){var Q=this._config.downloadRequestHeaders;for(var le in Q)U.setRequestHeader(le,Q[le])}if(this._config.chunkSize){var F=this._start+this._config.chunkSize-1;U.setRequestHeader("Range","bytes="+this._start+"-"+F)}try{U.send(this._config.downloadRequestBody)}catch(te){this._chunkError(te.message)}c&&U.status===0&&this._chunkError()}},this._chunkLoaded=function(){U.readyState===4&&(U.status<200||400<=U.status?this._chunkError():(this._start+=this._config.chunkSize?this._config.chunkSize:U.responseText.length,this._finished=!this._config.chunkSize||this._start>=(function(Q){var le=Q.getResponseHeader("Content-Range");return le===null?-1:parseInt(le.substring(le.lastIndexOf("/")+1))})(U),this.parseChunk(U.responseText)))},this._chunkError=function(Q){var le=U.statusText||Q;this._sendError(new Error(le))}}function N(L){var U,Q;(L=L||{}).chunkSize||(L.chunkSize=b.LocalChunkSize),_.call(this,L);var le=typeof FileReader<"u";this.stream=function(F){this._input=F,Q=F.slice||F.webkitSlice||F.mozSlice,le?((U=new FileReader).onload=W(this._chunkLoaded,this),U.onerror=W(this._chunkError,this)):U=new FileReaderSync,this._nextChunk()},this._nextChunk=function(){this._finished||this._config.preview&&!(this._rowCount<this._config.preview)||this._readChunk()},this._readChunk=function(){var F=this._input;if(this._config.chunkSize){var te=Math.min(this._start+this._config.chunkSize,this._input.size);F=Q.call(F,this._start,te)}var j=U.readAsText(F,this._config.encoding);le||this._chunkLoaded({target:{result:j}})},this._chunkLoaded=function(F){this._start+=this._config.chunkSize,this._finished=!this._config.chunkSize||this._start>=this._input.size,this.parseChunk(F.target.result)},this._chunkError=function(){this._sendError(U.error)}}function S(L){var U;_.call(this,L=L||{}),this.stream=function(Q){return U=Q,this._nextChunk()},this._nextChunk=function(){if(!this._finished){var Q,le=this._config.chunkSize;return le?(Q=U.substring(0,le),U=U.substring(le)):(Q=U,U=""),this._finished=!U,this.parseChunk(Q)}}}function I(L){_.call(this,L=L||{});var U=[],Q=!0,le=!1;this.pause=function(){_.prototype.pause.apply(this,arguments),this._input.pause()},this.resume=function(){_.prototype.resume.apply(this,arguments),this._input.resume()},this.stream=function(F){this._input=F,this._input.on("data",this._streamData),this._input.on("end",this._streamEnd),this._input.on("error",this._streamError)},this._checkIsFinished=function(){le&&U.length===1&&(this._finished=!0)},this._nextChunk=function(){this._checkIsFinished(),U.length?this.parseChunk(U.shift()):Q=!0},this._streamData=W(function(F){try{U.push(typeof F=="string"?F:F.toString(this._config.encoding)),Q&&(Q=!1,this._checkIsFinished(),this.parseChunk(U.shift()))}catch(te){this._streamError(te)}},this),this._streamError=W(function(F){this._streamCleanUp(),this._sendError(F)},this),this._streamEnd=W(function(){this._streamCleanUp(),le=!0,this._streamData("")},this),this._streamCleanUp=W(function(){this._input.removeListener("data",this._streamData),this._input.removeListener("end",this._streamEnd),this._input.removeListener("error",this._streamError)},this)}function A(L){var U,Q,le,F=Math.pow(2,53),te=-F,j=/^\s*-?(\d+\.?|\.\d+|\d+\.\d+)([eE][-+]?\d+)?\s*$/,he=/^((\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z)))$/,J=this,Z=0,De=0,ve=!1,Be=!1,T=[],z={data:[],errors:[],meta:{}};if(H(L.step)){var ne=L.step;L.step=function(ie){if(z=ie,de())ue();else{if(ue(),z.data.length===0)return;Z+=ie.data.length,L.preview&&Z>L.preview?Q.abort():(z.data=z.data[0],ne(z,J))}}}function se(ie){return L.skipEmptyLines==="greedy"?ie.join("").trim()==="":ie.length===1&&ie[0].length===0}function ue(){return z&&le&&(ye("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to '"+b.DefaultDelimiter+"'"),le=!1),L.skipEmptyLines&&(z.data=z.data.filter(function(ie){return!se(ie)})),de()&&(function(){if(!z)return;function ie(ot,ft){H(L.transformHeader)&&(ot=L.transformHeader(ot,ft)),T.push(ot)}if(Array.isArray(z.data[0])){for(var We=0;de()&&We<z.data.length;We++)z.data[We].forEach(ie);z.data.splice(0,1)}else z.data.forEach(ie)})(),(function(){if(!z||!L.header&&!L.dynamicTyping&&!L.transform)return z;function ie(ot,ft){var $e,C=L.header?{}:[];for($e=0;$e<ot.length;$e++){var Ne=$e,Ce=ot[$e];L.header&&(Ne=$e>=T.length?"__parsed_extra":T[$e]),L.transform&&(Ce=L.transform(Ce,Ne)),Ce=oe(Ne,Ce),Ne==="__parsed_extra"?(C[Ne]=C[Ne]||[],C[Ne].push(Ce)):C[Ne]=Ce}return L.header&&($e>T.length?ye("FieldMismatch","TooManyFields","Too many fields: expected "+T.length+" fields but parsed "+$e,De+ft):$e<T.length&&ye("FieldMismatch","TooFewFields","Too few fields: expected "+T.length+" fields but parsed "+$e,De+ft)),C}var We=1;return!z.data.length||Array.isArray(z.data[0])?(z.data=z.data.map(ie),We=z.data.length):z.data=ie(z.data,0),L.header&&z.meta&&(z.meta.fields=T),De+=We,z})()}function de(){return L.header&&T.length===0}function oe(ie,We){return ot=ie,L.dynamicTypingFunction&&L.dynamicTyping[ot]===void 0&&(L.dynamicTyping[ot]=L.dynamicTypingFunction(ot)),(L.dynamicTyping[ot]||L.dynamicTyping)===!0?We==="true"||We==="TRUE"||We!=="false"&&We!=="FALSE"&&((function(ft){if(j.test(ft)){var $e=parseFloat(ft);if(te<$e&&$e<F)return!0}return!1})(We)?parseFloat(We):he.test(We)?new Date(We):We===""?null:We):We;var ot}function ye(ie,We,ot,ft){var $e={type:ie,code:We,message:ot};ft!==void 0&&($e.row=ft),z.errors.push($e)}this.parse=function(ie,We,ot){var ft=L.quoteChar||'"';if(L.newline||(L.newline=(function(Ne,Ce){Ne=Ne.substring(0,1048576);var re=new RegExp(k(Ce)+"([^]*?)"+k(Ce),"gm"),ee=(Ne=Ne.replace(re,"")).split("\r"),me=Ne.split(`
`),Ve=1<me.length&&me[0].length<ee[0].length;if(ee.length===1||Ve)return`
`;for(var Ye=0,be=0;be<ee.length;be++)ee[be][0]===`
`&&Ye++;return Ye>=ee.length/2?`\r
`:"\r"})(ie,ft)),le=!1,L.delimiter)H(L.delimiter)&&(L.delimiter=L.delimiter(ie),z.meta.delimiter=L.delimiter);else{var $e=(function(Ne,Ce,re,ee,me){var Ve,Ye,be,Ze;me=me||[",","	","|",";",b.RECORD_SEP,b.UNIT_SEP];for(var at=0;at<me.length;at++){var Ue=me[at],_t=0,It=0,Nt=0;be=void 0;for(var on=new R({comments:ee,delimiter:Ue,newline:Ce,preview:10}).parse(Ne),Zt=0;Zt<on.data.length;Zt++)if(re&&se(on.data[Zt]))Nt++;else{var cn=on.data[Zt].length;It+=cn,be!==void 0?0<cn&&(_t+=Math.abs(cn-be),be=cn):be=cn}0<on.data.length&&(It/=on.data.length-Nt),(Ye===void 0||_t<=Ye)&&(Ze===void 0||Ze<It)&&1.99<It&&(Ye=_t,Ve=Ue,Ze=It)}return{successful:!!(L.delimiter=Ve),bestDelimiter:Ve}})(ie,L.newline,L.skipEmptyLines,L.comments,L.delimitersToGuess);$e.successful?L.delimiter=$e.bestDelimiter:(le=!0,L.delimiter=b.DefaultDelimiter),z.meta.delimiter=L.delimiter}var C=Y(L);return L.preview&&L.header&&C.preview++,U=ie,Q=new R(C),z=Q.parse(U,We,ot),ue(),ve?{meta:{paused:!0}}:z||{meta:{paused:!1}}},this.paused=function(){return ve},this.pause=function(){ve=!0,Q.abort(),U=H(L.chunk)?"":U.substring(Q.getCharIndex())},this.resume=function(){J.streamer._halted?(ve=!1,J.streamer.parseChunk(U,!0)):setTimeout(J.resume,3)},this.aborted=function(){return Be},this.abort=function(){Be=!0,Q.abort(),z.meta.aborted=!0,H(L.complete)&&L.complete(z),U=""}}function k(L){return L.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function R(L){var U,Q=(L=L||{}).delimiter,le=L.newline,F=L.comments,te=L.step,j=L.preview,he=L.fastMode,J=U=L.quoteChar===void 0||L.quoteChar===null?'"':L.quoteChar;if(L.escapeChar!==void 0&&(J=L.escapeChar),(typeof Q!="string"||-1<b.BAD_DELIMITERS.indexOf(Q))&&(Q=","),F===Q)throw new Error("Comment character same as delimiter");F===!0?F="#":(typeof F!="string"||-1<b.BAD_DELIMITERS.indexOf(F))&&(F=!1),le!==`
`&&le!=="\r"&&le!==`\r
`&&(le=`
`);var Z=0,De=!1;this.parse=function(ve,Be,T){if(typeof ve!="string")throw new Error("Input must be a string");var z=ve.length,ne=Q.length,se=le.length,ue=F.length,de=H(te),oe=[],ye=[],ie=[],We=Z=0;if(!ve)return bn();if(L.header&&!Be){var ot=ve.split(le)[0].split(Q),ft=[],$e={},C=!1;for(var Ne in ot){var Ce=ot[Ne];H(L.transformHeader)&&(Ce=L.transformHeader(Ce,Ne));var re=Ce,ee=$e[Ce]||0;for(0<ee&&(C=!0,re=Ce+"_"+ee),$e[Ce]=ee+1;ft.includes(re);)re=re+"_"+ee;ft.push(re)}if(C){var me=ve.split(le);me[0]=ft.join(Q),ve=me.join(le)}}if(he||he!==!1&&ve.indexOf(U)===-1){for(var Ve=ve.split(le),Ye=0;Ye<Ve.length;Ye++){if(ie=Ve[Ye],Z+=ie.length,Ye!==Ve.length-1)Z+=le.length;else if(T)return bn();if(!F||ie.substring(0,ue)!==F){if(de){if(oe=[],Nt(ie.split(Q)),zt(),De)return bn()}else Nt(ie.split(Q));if(j&&j<=Ye)return oe=oe.slice(0,j),bn(!0)}}return bn()}for(var be=ve.indexOf(Q,Z),Ze=ve.indexOf(le,Z),at=new RegExp(k(J)+k(U),"g"),Ue=ve.indexOf(U,Z);;)if(ve[Z]!==U)if(F&&ie.length===0&&ve.substring(Z,Z+ue)===F){if(Ze===-1)return bn();Z=Ze+se,Ze=ve.indexOf(le,Z),be=ve.indexOf(Q,Z)}else if(be!==-1&&(be<Ze||Ze===-1))ie.push(ve.substring(Z,be)),Z=be+ne,be=ve.indexOf(Q,Z);else{if(Ze===-1)break;if(ie.push(ve.substring(Z,Ze)),cn(Ze+se),de&&(zt(),De))return bn();if(j&&oe.length>=j)return bn(!0)}else for(Ue=Z,Z++;;){if((Ue=ve.indexOf(U,Ue+1))===-1)return T||ye.push({type:"Quotes",code:"MissingQuotes",message:"Quoted field unterminated",row:oe.length,index:Z}),Zt();if(Ue===z-1)return Zt(ve.substring(Z,Ue).replace(at,U));if(U!==J||ve[Ue+1]!==J){if(U===J||Ue===0||ve[Ue-1]!==J){be!==-1&&be<Ue+1&&(be=ve.indexOf(Q,Ue+1)),Ze!==-1&&Ze<Ue+1&&(Ze=ve.indexOf(le,Ue+1));var _t=on(Ze===-1?be:Math.min(be,Ze));if(ve.substr(Ue+1+_t,ne)===Q){ie.push(ve.substring(Z,Ue).replace(at,U)),ve[Z=Ue+1+_t+ne]!==U&&(Ue=ve.indexOf(U,Z)),be=ve.indexOf(Q,Z),Ze=ve.indexOf(le,Z);break}var It=on(Ze);if(ve.substring(Ue+1+It,Ue+1+It+se)===le){if(ie.push(ve.substring(Z,Ue).replace(at,U)),cn(Ue+1+It+se),be=ve.indexOf(Q,Z),Ue=ve.indexOf(U,Z),de&&(zt(),De))return bn();if(j&&oe.length>=j)return bn(!0);break}ye.push({type:"Quotes",code:"InvalidQuotes",message:"Trailing quote on quoted field is malformed",row:oe.length,index:Z}),Ue++}}else Ue++}return Zt();function Nt(Ht){oe.push(Ht),We=Z}function on(Ht){var yt=0;if(Ht!==-1){var tn=ve.substring(Ue+1,Ht);tn&&tn.trim()===""&&(yt=tn.length)}return yt}function Zt(Ht){return T||(Ht===void 0&&(Ht=ve.substring(Z)),ie.push(Ht),Z=z,Nt(ie),de&&zt()),bn()}function cn(Ht){Z=Ht,Nt(ie),ie=[],Ze=ve.indexOf(le,Z)}function bn(Ht){return{data:oe,errors:ye,meta:{delimiter:Q,linebreak:le,aborted:De,truncated:!!Ht,cursor:We+(Be||0)}}}function zt(){te(bn()),oe=[],ye=[]}},this.abort=function(){De=!0},this.getCharIndex=function(){return Z}}function P(L){var U=L.data,Q=f[U.workerId],le=!1;if(U.error)Q.userError(U.error,U.file);else if(U.results&&U.results.data){var F={abort:function(){le=!0,q(U.workerId,{data:[],errors:[],meta:{aborted:!0}})},pause:G,resume:G};if(H(Q.userStep)){for(var te=0;te<U.results.data.length&&(Q.userStep({data:U.results.data[te],errors:U.results.errors,meta:U.results.meta},F),!le);te++);delete U.results}else H(Q.userChunk)&&(Q.userChunk(U.results,F,U.file),delete U.results)}U.finished&&!le&&q(U.workerId,U.results)}function q(L,U){var Q=f[L];H(Q.userComplete)&&Q.userComplete(U),Q.terminate(),delete f[L]}function G(){throw new Error("Not implemented.")}function Y(L){if(typeof L!="object"||L===null)return L;var U=Array.isArray(L)?[]:{};for(var Q in L)U[Q]=Y(L[Q]);return U}function W(L,U){return function(){L.apply(U,arguments)}}function H(L){return typeof L=="function"}return u&&(i.onmessage=function(L){var U=L.data;if(b.WORKER_ID===void 0&&U&&(b.WORKER_ID=U.workerId),typeof U.input=="string")i.postMessage({workerId:b.WORKER_ID,results:b.parse(U.input,U.config),finished:!0});else if(i.File&&U.input instanceof File||U.input instanceof Object){var Q=b.parse(U.input,U.config);Q&&i.postMessage({workerId:b.WORKER_ID,results:Q,finished:!0})}}),(E.prototype=Object.create(_.prototype)).constructor=E,(N.prototype=Object.create(_.prototype)).constructor=N,(S.prototype=Object.create(S.prototype)).constructor=S,(I.prototype=Object.create(_.prototype)).constructor=I,b})})(td)),td.exports}var US=MS();const zb=Co(US),Kh=async n=>{var i;const a=(i=n.name.split(".").pop())==null?void 0:i.toLowerCase();if(a==="txt"||a==="md"||a==="markdown"||a==="csv")return await n.text();if(a==="rtf")return(await n.text()).replace(/\{\\.*?\}/g,"").replace(/\\.*?\s/g,"").trim();const s=await n.text();if(s.includes("%PDF"))throw new Error("PDF text extraction requires a specialized library. Please copy-paste the text directly into the modal.");return s},Yh=n=>/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i.test(n),LS=n=>{var i,c;const a=new Map,s={...n};if(s.infoCards&&s.infoCards.forEach(u=>{const f=crypto.randomUUID();u.id&&a.set(String(u.id),f),u.id=f}),s.questions&&s.questions.forEach(u=>{const f=crypto.randomUUID();u.id&&a.set(String(u.id),f),u.id=f}),s.infoCards&&s.infoCards.forEach(u=>{u.unlocksQuestionIds&&(u.unlocksQuestionIds=u.unlocksQuestionIds.map(f=>a.get(String(f))||null).filter(f=>f!==null)),u.prerequisiteIds&&(u.prerequisiteIds=u.prerequisiteIds.map(f=>a.get(String(f))||null).filter(f=>f!==null))}),s.questions&&s.questions.forEach(u=>{if(u.infoCardIds&&(u.infoCardIds=u.infoCardIds.map(f=>a.get(String(f))||null).filter(f=>f!==null)),u.correctAnswerId&&!Yh(u.correctAnswerId)){const f=String(u.correctAnswerId).match(/^o(\d+)$/i);if(f&&u.options){const p=parseInt(f[1],10)-1;u.options[p]&&(u.options[p].id||(u.options[p].id=crypto.randomUUID()),u.correctAnswerId=u.options[p].id)}}}),(i=s.infoCards)!=null&&i.length&&((c=s.questions)!=null&&c.length)&&!s.infoCards.some(f=>{var p;return((p=f.unlocksQuestionIds)==null?void 0:p.length)>0})){const f=Math.ceil(s.questions.length/s.infoCards.length);s.infoCards.forEach((p,b)=>{const m=b*f,_=s.questions.slice(m,m+f);p.unlocksQuestionIds=_.map(E=>E.id),_.forEach(E=>{E.infoCardIds||(E.infoCardIds=[]),E.infoCardIds.push(p.id)})})}return s},zS=n=>{if(Array.isArray(n))return{version:9,decks:n.filter(Boolean).map(s=>(s.type||(s.type=Array.isArray(s.cards)?et.Flashcard:et.Quiz),s.type===et.Flashcard?s.cards=(s.cards||[]).filter(Boolean):s.type===et.Quiz&&(s.questions=(s.questions||[]).filter(Boolean)),s.id=String(s.id||crypto.randomUUID()),s.name||(s.name="Untitled Deck"),s)).filter(s=>s&&s.name),folders:[],deckSeries:[],reviews:[],sessions:[],seriesProgress:{},learningProgress:{},aiChatHistory:[]};if(typeof n=="object"&&n!==null){const a={...n};return a.version||(a.version=2),a.decks||(a.decks=[]),a.folders||(a.folders=[]),a.deckSeries||(a.deckSeries=[]),a.reviews||(a.reviews=[]),a.sessions||(a.sessions=[]),a.seriesProgress||(a.seriesProgress={}),a.learningProgress||(a.learningProgress={}),a.aiChatHistory||(a.aiChatHistory=[]),a.decks=a.decks.map(s=>{if(!s)return null;s.id?s.id=String(s.id):s.id=crypto.randomUUID(),s.type||(s.cards&&s.cards.length>0?s.type="flashcard":s.infoCards&&s.infoCards.length>0?s.type="learning":s.type="quiz"),s.cards||(s.cards=[]),s.questions||(s.questions=[]),s.infoCards||(s.infoCards=[]);const i=c=>c?(c.id=String(c.id||crypto.randomUUID()),(c.interval===void 0||c.interval===null)&&(c.interval=0),(c.easeFactor===void 0||c.easeFactor===null)&&(c.easeFactor=2.5),(c.lapses===void 0||c.lapses===null)&&(c.lapses=0),(c.masteryLevel===void 0||c.masteryLevel===null)&&(c.masteryLevel=0),c.dueDate||(c.dueDate=new Date().toISOString()),c):null;return s.type==="flashcard"?s.cards=s.cards.map(i).filter(Boolean):(s.questions=s.questions.map(c=>{const u=i(c);return u?(u.questionType||(u.questionType="multipleChoice"),u.options||(u.options=[]),u.options=u.options.map(f=>({...f,id:String(f.id||crypto.randomUUID())})),u):null}).filter(Boolean),s.type==="learning"&&(s.infoCards=s.infoCards.map(c=>c?(c.id=String(c.id||crypto.randomUUID()),c.unlocksQuestionIds||(c.unlocksQuestionIds=[]),c):null).filter(Boolean))),s}).filter(Boolean),a.version=9,a}return n},bd=async n=>{let a;try{a=JSON.parse(n)}catch{const i=ap(n);if(!i.isValid&&!i.fixedJSON)throw new Error("Failed to parse backup file.");a=i.parsed||JSON.parse(i.fixedJSON)}if(!a)throw new Error("The backup file appears to be empty or invalid.");if(typeof a=="string"&&(a=JSON.parse(a)),typeof a=="object"&&a!==null&&a.dataType==="cogniflow-compressed-backup-v1"&&typeof a.content=="string"){const i=(await lp.loadAsync(a.content,{base64:!0})).file("backup.json");i&&(a=JSON.parse(await i.async("string")))}if(a=zS(a),typeof a=="object"&&a!==null&&"version"in a){const s=NS.safeParse(a);if(!s.success)throw new Error(`Invalid backup data at ${s.error.issues[0].path.join(".")}`);return s.data}throw new Error("The file is not a valid CogniFlow backup file.")},hd=n=>{if(!n.trim())throw new Error("Pasted content is empty.");const a=ap(n);if(!a.isValid)throw new Error("Invalid JSON.");const s=a.parsed,i=OS.safeParse(s);if(i.success)return{type:"series",data:i.data};const c=we.array(Rb).safeParse(s);if(c.success)return{type:et.Flashcard,data:c.data};const u=mS.safeParse(s);if(u.success){let f=u.data;return f.type==="learning"||Array.isArray(f.infoCards)&&f.infoCards.length>0?(f=LS(f),{type:et.Learning,data:f}):{type:et.Quiz,data:f}}throw new Error("Unsupported JSON structure.")},q2=(n,a)=>{if(!n.trim())throw new Error("Pasted content is empty.");const s=ap(n);if(!s.isValid)throw new Error("Invalid JSON.");const i=s.parsed;if(!Array.isArray(i))throw new Error("JSON must be an array of items.");if(i.length===0)return[];if(a===et.Flashcard){const c=we.array(Rb).safeParse(i);if(!c.success)throw new Error("Invalid flashcard format.");return c.data}else{const c=we.array(pS).safeParse(i);if(!c.success)throw new Error(`Invalid question format: ${c.error.issues[0].message}`);return c.data}},ko=n=>{const a=new Date;return a.setHours(0,0,0,0),n.map(s=>({id:crypto.randomUUID(),front:s.front,back:s.back,dueDate:a.toISOString(),interval:0,easeFactor:za,masteryLevel:0,lapses:0}))},Ea=n=>{const a=new Date;return a.setHours(0,0,0,0),n.map(s=>{const i=s.correctAnswerId,c=(s.options||[]).map(f=>({...f,id:f.id&&Yh(String(f.id))?String(f.id):crypto.randomUUID(),text:f.text||"",explanation:f.explanation||""}));let u="";if(i){const f=c.find(p=>p.id===String(i));if(f)u=f.id;else{const p=String(i).match(/^o(\d+)$/i);p&&c[parseInt(p[1],10)-1]&&(u=c[parseInt(p[1],10)-1].id)}}if(!u){const f=c.find(p=>{var b,m;return((b=p.explanation)==null?void 0:b.toLowerCase().includes("correct"))||((m=p.text)==null?void 0:m.toLowerCase().startsWith("correct"))});f&&(u=f.id)}return!u&&c.length>0&&(u=c[0].id),{...s,id:s.id&&Yh(String(s.id))?String(s.id):crypto.randomUUID(),questionType:"multipleChoice",dueDate:a.toISOString(),interval:0,easeFactor:za,masteryLevel:0,lapses:0,detailedExplanation:s.detailedExplanation||"",correctAnswerId:u,options:c}})},BS=n=>{const{data:a,errors:s}=zb.parse(n,{header:!0,skipEmptyLines:!0,transformHeader:c=>c.trim().toLowerCase()});if(s.length>0)throw new Error(`CSV Parsing Error: ${s[0].message}`);const i=a.map(c=>{const u=c.front||c.question||c.term||c.en||Object.values(c)[0],f=c.back||c.answer||c.definition||c.translation||Object.values(c)[1];return!u||!f?null:{front:String(u).trim(),back:String(f).trim()}}).filter(c=>c!==null);if(i.length===0)throw new Error("No valid cards found in CSV.");return i},Bb=async n=>{const a=n.name.toLowerCase();if(a.endsWith(".apkg")||a.endsWith(".zip"))return{type:"anki",data:{name:n.name},file:n,fileName:n.name};if(a.match(/\.(png|jpg|jpeg|webp|gif)$/))return{type:"image",data:{name:n.name,mimeType:n.type},file:n,fileName:n.name};if(a.match(/\.(txt|md|markdown|rtf|pdf)$/))return{type:"document",data:{name:n.name},file:n,fileName:n.name};if(a.endsWith(".csv"))try{return{type:"flashcard",data:BS(await n.text()),fileName:n.name}}catch(s){console.error(s)}try{const s=await n.text(),i=s.trim();if(i.startsWith("{")||i.startsWith("[")){try{const c=hd(s);return{type:c.type,data:c.data,fileName:n.name}}catch{}try{return{type:"backup",data:await bd(s),fileName:n.name}}catch{}}}catch{}return null},FS={success:l.jsx(rt,{name:"check-circle",className:"w-6 h-6 text-green-500"}),error:l.jsx(rt,{name:"x-circle",className:"w-6 h-6 text-red-500"}),info:l.jsx(rt,{name:"info",className:"w-6 h-6 text-blue-500"}),warning:l.jsx(rt,{name:"info",className:"w-6 h-6 text-yellow-500"})},HS=({message:n,onDismiss:a})=>($.useEffect(()=>{const s=setTimeout(()=>{a(n.id)},5e3);return()=>{clearTimeout(s)}},[n.id,a]),l.jsx("div",{className:"bg-surface shadow-lg rounded-lg pointer-events-auto ring-1 ring-black ring-opacity-5 overflow-hidden animate-fade-in-right",children:l.jsx("div",{className:"p-4",children:l.jsxs("div",{className:"flex items-start",children:[l.jsx("div",{className:"flex-shrink-0",children:FS[n.type]}),l.jsx("div",{className:"ml-3 w-0 flex-1 pt-0.5",children:l.jsx("p",{className:"text-sm font-medium text-text break-words",children:n.message})}),l.jsx("div",{className:"ml-4 flex-shrink-0 flex",children:l.jsxs("button",{onClick:()=>a(n.id),className:"bg-surface rounded-md inline-flex text-text-muted hover:text-text focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-surface focus:ring-primary",children:[l.jsx("span",{className:"sr-only",children:"Close"}),l.jsx(rt,{name:"x",className:"h-5 w-5"})]})})]})})})),Fb=$.createContext(void 0),PS=({children:n})=>{const[a,s]=$.useState([]),i=$.useCallback((u,f)=>{const p=crypto.randomUUID();s(b=>[...b,{id:p,message:u,type:f}])},[]),c=$.useCallback(u=>{s(f=>f.filter(p=>p.id!==u))},[]);return l.jsxs(Fb.Provider,{value:{addToast:i},children:[n,l.jsx("div",{className:"fixed top-5 right-5 z-[100] w-full max-w-xs space-y-3",children:a.map(u=>l.jsx(HS,{message:u,onDismiss:c},u.id))})]})},Ar=()=>{const n=$.useContext(Fb);if(n===void 0)throw new Error("useToast must be used within a ToastProvider");return n},Hb="Europe/Stockholm",qS=()=>new Date().toLocaleDateString("sv-SE",{timeZone:Hb}),cp=()=>new Date().toLocaleString("sv-SE",{timeZone:Hb,year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1}).replace(/ /g,"_").replace(/:/g,"-"),GS=({isOpen:n,onClose:a,onAddDecks:s,onAddSeriesWithDecks:i})=>{const[c,u]=$.useState("create"),[f,p]=$.useState(""),[b,m]=$.useState(""),[_,E]=$.useState(""),[N,S]=$.useState(!1),[I,A]=$.useState(""),[k,R]=$.useState(""),[P,q]=$.useState(null),[G,Y]=$.useState(null),[W,H]=$.useState(""),L=$.useRef(null),U=$.useRef(null),Q=$.useRef(null),{addToast:le}=Ar(),{aiFeaturesEnabled:F}=Xi(),{openModal:te}=zc(),j=$.useRef(null);kr(j,n);const he=$.useCallback(()=>{u("create"),p(""),m(""),E(""),S(!1),q(null),Y(null),H(""),A(""),R("")},[]),J=$.useCallback(()=>{he(),a()},[he,a]),Z=$.useCallback(de=>{m(de);try{const oe=hd(de);(oe==null?void 0:oe.type)===et.Quiz||(oe==null?void 0:oe.type)===et.Learning?p(oe.data.name):(oe==null?void 0:oe.type)==="series"&&p(oe.data.seriesName)}catch{}},[]),De=$.useCallback(async de=>{if(de){E(de.name),S(!0);try{const oe=await Bb(de);if(!oe){le("Unsupported file type. Please upload a JSON, CSV, Anki package, or Image.","error"),E(""),S(!1);return}if(oe.type==="document"){S(!1);const ye=await Kh(de);A(ye),R(de.name),u("document"),le("Document text extracted. Choose a generation mode.","success");return}if(oe.type==="backup"||oe.type==="anki"||oe.type==="image"){S(!1),te("droppedFile",{analysis:oe});return}if(oe.type==="flashcard"||oe.type==="quiz"||oe.type==="series"||oe.type==="learning"){const ye=JSON.stringify(oe.data,null,2);Z(ye),S(!1),u("paste"),oe.type==="flashcard"&&oe.fileName&&p(oe.fileName.replace(/\.(csv|json)$/i,"")),le("File processed. Review content and click Import.","success");return}}catch(oe){le(`An error occurred: ${oe instanceof Error?oe.message:"Unknown error"}`,"error"),he()}}},[le,Z,te,he]),ve=$.useCallback(de=>{var ye;const oe=(ye=de.target.files)==null?void 0:ye[0];oe&&De(oe),de.target&&(de.target.value="")},[De]),Be=de=>{var ye;const oe=(ye=de.target.files)==null?void 0:ye[0];if(oe){q(oe);const ie=new FileReader;ie.onload=We=>{var ot;return Y((ot=We.target)==null?void 0:ot.result)},ie.readAsDataURL(oe)}de.target&&(de.target.value="")},T=async de=>{var ye;const oe=(ye=de.target.files)==null?void 0:ye[0];if(oe)try{const ie=await Kh(oe);A(ie),R(oe.name),le("Document text extracted.","success")}catch(ie){le(ie.message,"error")}de.target&&(de.target.value="")},z=de=>{I.trim()&&(te("aiGeneration",{initialTopic:k||"My Document",context:{mode:"generate",sourceMaterial:I}}),a())},ne=$.useCallback(()=>{if(c==="image"){le("Please use the Upload tab or drag an image directly for AI generation.","info");return}if(c==="create"){if(!f.trim()){le("Please enter a deck name.","error");return}const de={id:crypto.randomUUID(),name:f.trim(),type:et.Flashcard,cards:[],description:`Created on ${qS()}`};s([de]),le(`Deck "${de.name}" created.`,"success"),J();return}if(c==="paste"){if(!b){le("Please paste content.","error");return}try{const de=hd(b);if(!de)return;if(de.type==="series"){const{seriesName:oe,seriesDescription:ye,levels:ie}=de.data,We=[],ot=(ie||[]).map($e=>{const C=($e.decks||[]).map(Ne=>{const re={id:crypto.randomUUID(),name:Ne.name,description:Ne.description||"",icon:Ne.icon,generationStatus:Ne.generationStatus};return Ne.type==="learning"||Ne.infoCards?{...re,type:et.Learning,infoCards:Ne.infoCards||[],questions:Ea(Ne.questions||[]),learningMode:Ne.learningMode||"separate",curriculum:Ne.curriculum}:Ne.type==="flashcard"||Ne.cards?{...re,type:et.Flashcard,cards:ko(Ne.cards||[])}:{...re,type:et.Quiz,questions:Ea(Ne.questions||[])}}).filter(Ne=>Ne!==null);return We.push(...C),{title:$e.title,deckIds:C.map(Ne=>Ne.id)}}),ft={id:crypto.randomUUID(),type:"series",name:oe,description:ye,levels:ot,archived:!1,createdAt:new Date().toISOString()};i(ft,We),le(`Series "${ft.name}" imported.`,"success")}else if(de.type===et.Quiz||de.type===et.Learning){const oe=de.data,ie={id:crypto.randomUUID(),name:oe.name,description:oe.description||"",icon:oe.icon,generationStatus:oe.generationStatus};let We;de.type===et.Learning?We={...ie,type:et.Learning,infoCards:oe.infoCards||[],questions:Ea(oe.questions||[]),learningMode:oe.learningMode||"separate",curriculum:oe.curriculum}:We={...ie,type:et.Quiz,questions:Ea(oe.questions||[])},s([We]),le(`Deck "${We.name}" imported.`,"success")}else if(de.type===et.Flashcard){const oe=ko(de.data),ye={id:crypto.randomUUID(),name:f||"Imported Flashcards",type:et.Flashcard,cards:oe,description:`Imported on ${new Date().toLocaleDateString()}`};s([ye]),le(`Deck "${ye.name}" imported with ${oe.length} cards.`,"success")}J()}catch(de){le(de instanceof Error?de.message:"Invalid JSON content.","error")}}},[f,c,b,s,J,le,i]);if(!n)return null;const se=()=>{switch(c){case"document":return l.jsxs("div",{className:"space-y-4 animate-fade-in",children:[l.jsxs("div",{className:"flex flex-col items-center justify-center w-full h-48 border-2 border-dashed border-border rounded-lg bg-background/50 relative",children:[I?l.jsxs("div",{className:"p-4 w-full h-full flex flex-col items-center justify-center text-center",children:[l.jsx(rt,{name:"file-text",className:"w-10 h-10 text-primary mb-2"}),l.jsx("p",{className:"text-sm font-bold text-text truncate max-w-full px-4",children:k||"Pasted Content"}),l.jsxs("p",{className:"text-xs text-text-muted mt-1",children:[I.split(/\s+/).length," words detected"]}),l.jsx(pt,{variant:"ghost",size:"sm",onClick:()=>A(""),className:"mt-4 text-red-500",children:"Remove Source"})]}):l.jsxs("label",{className:"flex flex-col items-center justify-center w-full h-full cursor-pointer",onClick:()=>{var de;return(de=Q.current)==null?void 0:de.click()},children:[l.jsx(rt,{name:"upload-cloud",className:"w-10 h-10 text-text-muted mb-2"}),l.jsx("p",{className:"text-sm text-text-muted",children:l.jsx("span",{className:"font-semibold text-primary",children:"Click to upload document"})}),l.jsx("p",{className:"text-xs text-text-muted/70",children:"TXT, Markdown, MD, RTF"})]}),l.jsx("input",{type:"file",ref:Q,className:"hidden",accept:".txt,.md,.markdown,.rtf",onChange:T})]}),!I&&l.jsxs("div",{children:[l.jsx("label",{htmlFor:"paste-doc",className:"block text-sm font-medium text-text-muted mb-1",children:"Or paste source text here:"}),l.jsx("textarea",{id:"paste-doc",className:"w-full h-32 p-2 bg-background border border-border rounded-md focus:ring-2 focus:ring-primary focus:outline-none text-text text-sm",placeholder:"Paste text from a PDF, EPUB, or article to create a study guide...",value:I,onChange:de=>A(de.target.value)})]}),I&&l.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[l.jsxs("button",{onClick:()=>z(),className:"p-4 bg-primary/10 border border-primary/20 rounded-xl text-left hover:bg-primary/20 transition-all group",children:[l.jsx(rt,{name:"layers",className:"w-6 h-6 text-primary mb-2"}),l.jsx("h4",{className:"font-bold text-text text-sm",children:"Learning Deck"}),l.jsx("p",{className:"text-[10px] text-text-muted mt-1",children:"Single guide + Practice quiz"})]}),l.jsxs("button",{onClick:()=>z(),className:"p-4 bg-indigo-600 text-white rounded-xl text-left hover:bg-indigo-700 transition-all shadow-lg group",children:[l.jsx(rt,{name:"bot",className:"w-6 h-6 text-white mb-2"}),l.jsx("h4",{className:"font-bold text-sm",children:"Hyper-Course"}),l.jsx("p",{className:"text-[10px] text-white/80 mt-1",children:"Full curriculum synthesis"})]})]})]});case"image":return l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{className:"flex flex-col items-center justify-center w-full h-48 border-2 border-dashed border-border rounded-lg cursor-pointer hover:bg-background transition-colors relative overflow-hidden",children:[G?l.jsxs("div",{className:"relative w-full h-full group",children:[l.jsx("img",{src:G,alt:"Preview",className:"w-full h-full object-contain"}),l.jsx("div",{className:"absolute inset-0 bg-black/50 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center",children:l.jsx(pt,{variant:"danger",size:"sm",onClick:de=>{de.stopPropagation(),q(null),Y(null)},children:"Remove Image"})})]}):l.jsxs("label",{className:"flex flex-col items-center justify-center w-full h-full cursor-pointer",onClick:de=>{var oe;de.preventDefault(),(oe=U.current)==null||oe.click()},children:[l.jsx(rt,{name:"upload-cloud",className:"w-10 h-10 text-text-muted mb-2"}),l.jsx("p",{className:"text-sm text-text-muted",children:l.jsx("span",{className:"font-semibold text-primary",children:"Click to upload image"})}),l.jsx("p",{className:"text-xs text-text-muted/70",children:"PNG, JPG, WEBP"})]}),l.jsx("input",{type:"file",ref:U,className:"hidden",accept:"image/*",onChange:Be})]}),l.jsxs("div",{children:[l.jsx("label",{htmlFor:"image-hint",className:"block text-sm font-medium text-text-muted mb-1",children:"Topic / Hint (Optional)"}),l.jsx("input",{type:"text",id:"image-hint",value:W,onChange:de=>H(de.target.value),className:"w-full p-2 bg-background border border-border rounded-md focus:ring-2 focus:ring-primary focus:outline-none",placeholder:"e.g., Focus on the dates in the timeline"})]})]});case"paste":return l.jsxs("div",{className:"space-y-4 animate-fade-in",children:[l.jsxs("div",{children:[l.jsx("label",{htmlFor:"paste-json",className:"block text-sm font-medium text-text-muted mb-1",children:"Paste JSON Deck or Series Export:"}),l.jsx("textarea",{id:"paste-json",className:"w-full h-48 p-2 bg-background border border-border rounded-md focus:ring-2 focus:ring-primary focus:outline-none text-text font-mono text-xs",placeholder:'{ "name": "My Deck", "questions": [...] }',value:b,onChange:de=>Z(de.target.value)})]}),l.jsxs(ds,{href:"/instructions/json",onClick:a,className:"text-sm text-primary hover:underline mt-2 inline-flex items-center gap-1",children:[l.jsx(rt,{name:"help-circle",className:"w-4 h-4"})," View JSON format guide"]})]});case"upload":return l.jsxs("div",{className:"p-4 text-center",children:[l.jsx("input",{type:"file",ref:L,className:"hidden",accept:".json, .csv, .apkg, .zip, .txt, .md, .rtf",onChange:ve}),l.jsxs(pt,{variant:"secondary",onClick:()=>{var de;return(de=L.current)==null?void 0:de.click()},children:[l.jsx(rt,{name:"upload-cloud",className:"w-5 h-5 mr-2"}),"Choose File"]}),l.jsx("p",{className:"mt-2 text-xs text-text-muted",children:"JSON, CSV, Anki (.apkg), or Text documents"})]});case"create":default:return l.jsxs("div",{className:"space-y-4 animate-fade-in",children:[l.jsxs("div",{children:[l.jsx("label",{htmlFor:"new-deck-name",className:"block text-sm font-medium text-text-muted mb-1",children:"Deck Name"}),l.jsx("input",{id:"new-deck-name",type:"text",value:f,onChange:de=>p(de.target.value),className:"w-full p-2 bg-background border border-border rounded-md focus:ring-2 focus:ring-primary focus:outline-none",placeholder:"e.g., Anatomy 101",autoFocus:!0})]}),l.jsx("p",{className:"text-text-muted text-center py-4",children:"Create an empty flashcard deck to manually add cards later."})]})}},ue=["create","document","paste","upload"];return F&&ue.splice(2,0,"image"),l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-[60] p-4",children:l.jsxs("div",{ref:j,className:"bg-surface rounded-lg shadow-xl w-full max-w-lg overflow-hidden transform transition-all relative",children:[l.jsxs("div",{className:"flex justify-between items-center p-4 border-b border-border",children:[l.jsx("h2",{className:"text-xl font-bold text-text",children:"Create / Import"}),l.jsx(pt,{variant:"ghost",onClick:J,className:"p-1 h-auto",children:l.jsx(rt,{name:"x"})})]}),l.jsxs("div",{className:"p-6 space-y-4",children:[l.jsx("div",{className:"flex border-b border-border overflow-x-auto no-scrollbar",children:ue.map(de=>l.jsx("button",{onClick:()=>u(de),className:`capitalize px-4 py-2 text-sm font-medium transition-colors whitespace-nowrap ${c===de?"border-b-2 border-primary text-text":"text-text-muted hover:text-text"}`,children:de==="create"?"Create Empty":de==="document"?"From Document ":de},de))}),l.jsx("div",{className:"mt-4",children:se()})]}),c!=="document"&&l.jsxs("div",{className:"flex justify-end p-4 bg-background/50 border-t border-border",children:[l.jsx(pt,{variant:"secondary",onClick:J,className:"mr-2",children:"Cancel"}),l.jsx(pt,{variant:"primary",onClick:ne,disabled:N,children:c==="create"?"Create Deck":"Import"})]})]})})},Rs=({size:n="md"})=>{const a={sm:"h-6 w-6",md:"h-10 w-10",lg:"h-16 w-16"};return l.jsx("div",{className:"flex justify-center items-center",role:"status","aria-label":"Loading",children:l.jsxs("svg",{className:`animate-spin text-blue-500 dark:text-blue-400 ${a[n]}`,xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[l.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),l.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]})})},Pb=$.createContext(null),qb=()=>{const n=$.useContext(Pb);if(!n)throw new Error("Accordion components must be used within an <Accordion> component.");return n},Gb=$.createContext(null),Kb=()=>{const n=$.useContext(Gb);if(!n)throw new Error("AccordionTrigger/Content must be used within an <AccordionItem> component.");return n},KS=({children:n,type:a="single",defaultValue:s,className:i=""})=>{const[c,u]=$.useState(s||(a==="multiple"?[]:"")),f=p=>{u(a==="multiple"?b=>{const m=Array.isArray(b)?b:[];return m.includes(p)?m.filter(_=>_!==p):[...m,p]}:b=>b===p?"":p)};return $.useEffect(()=>{u(s===void 0?a==="multiple"?[]:"":s)},[s,a]),l.jsx(Pb.Provider,{value:{value:c,onValueChange:f,type:a},children:l.jsx("div",{className:i,children:n})})},Pu=({children:n,value:a,className:s=""})=>{const{value:i,type:c}=qb(),u=c==="multiple"?Array.isArray(i)&&i.includes(a):i===a;return l.jsx(Gb.Provider,{value:{value:a,isOpen:u},children:l.jsx("div",{className:s,children:n})})},qu=({children:n,className:a="",...s})=>{const{onValueChange:i}=qb(),{value:c,isOpen:u}=Kb(),f=`accordion-content-${c}`,p=`accordion-header-${c}`;return l.jsx("h3",{id:p,className:"m-0 font-medium",children:l.jsxs("button",{type:"button",onClick:()=>i(c),"aria-expanded":u,"aria-controls":f,className:`w-full flex justify-between items-center text-left p-4 bg-surface hover:bg-border/20 transition-colors ${a}`,...s,children:[n,l.jsx(rt,{name:"chevron-down",className:`w-5 h-5 transition-transform duration-300 ${u?"rotate-180":""} text-text-muted`})]})})},Gu=({children:n,className:a=""})=>{const{value:s,isOpen:i}=Kb(),c=`accordion-content-${s}`,u=`accordion-header-${s}`;return i?l.jsx("div",{id:c,role:"region","aria-labelledby":u,className:`animate-fade-in ${a}`,children:n}):null},cc=({label:n,localValue:a,backupValue:s,hasChanged:i})=>i?l.jsxs("div",{className:"text-xs",children:[l.jsxs("span",{className:"font-semibold",children:[n,": "]}),l.jsx("span",{className:"text-text-muted",children:a}),l.jsx(rt,{name:"arrow-down",className:"inline w-3 h-3 mx-1 rotate-[-90deg]"}),l.jsx("span",{className:"text-primary font-semibold",children:s})]}):null,YS=({isOpen:n,onClose:a,onCompare:s,onRestoreSelected:i,onFullRestore:c,openConfirmModal:u,file:f})=>{const[p,b]=$.useState("upload"),[m,_]=$.useState(""),[E,N]=$.useState(null),[S,I]=$.useState(null),[A,k]=$.useState(new Set),R=$.useRef(null),{addToast:P}=Ar(),q=$.useRef(null);kr(q,n);const{seriesProgress:G}=kt();$.useEffect(()=>{f&&n&&W(f)},[f,n]);const Y=()=>{b("upload"),_(""),N(null),I(null),k(new Set),a()},W=async he=>{if(he){b("loading"),_(he.name);try{const J=await he.text(),Z=await bd(J);N(Z);const De=s(Z);I(De);const ve=[...De.newSeries.map(Be=>Be.id),...De.newDecks.map(Be=>Be.id),...De.changedSeries.map(Be=>Be.backup.id),...De.changedDecks.map(Be=>Be.backup.id)];k(new Set(ve)),b("compare")}catch(J){P(`Restore failed: ${J instanceof Error?J.message:"Unknown error"}`,"error"),Y()}}},H=he=>{var Z;if(p==="loading")return;const J=(Z=he.target.files)==null?void 0:Z[0];J&&W(J),he.target&&(he.target.value="")},L=he=>{var Z;if(he.preventDefault(),p==="loading")return;const J=(Z=he.dataTransfer.files)==null?void 0:Z[0];J&&W(J)},U=he=>he.preventDefault(),Q=async()=>{E&&(b("loading"),await i({selectedIds:A,backupData:E}),Y())},le=()=>{E&&(a(),u({title:"Confirm Full Restore",message:"This will completely overwrite all your local data with the contents of the backup file. This action cannot be undone.",confirmText:"overwrite everything",onConfirm:()=>c(E)}))},F=he=>{k(J=>{const Z=new Set(J);return Z.has(he)?Z.delete(he):Z.add(he),Z})};if(!n)return null;const te=he=>{var J,Z;return he.type===et.Flashcard?((J=he.cards)==null?void 0:J.length)||0:((Z=he.questions)==null?void 0:Z.length)||0},j=()=>{if(p==="loading")return l.jsxs("div",{className:"absolute inset-0 bg-surface/80 flex flex-col items-center justify-center z-20",children:[l.jsx(Rs,{}),l.jsx("p",{className:"text-lg text-text mt-4",children:"Analyzing backup..."})]});if(p==="compare"&&S){const{newSeries:he,newDecks:J,changedSeries:Z,changedDecks:De,dueCounts:ve,masteryLevels:Be}=S,T=new Set(he.flatMap(de=>(de.levels||[]).flatMap(oe=>oe.deckIds||[]))),z=J.filter(de=>!T.has(de.id)),ne=he.length>0||z.length>0,se=Z.length>0||De.length>0,ue=[];return he.length>0&&ue.push("new-series"),z.length>0&&ue.push("new-decks"),Z.length>0&&ue.push("changed-series"),De.length>0&&ue.push("changed-decks"),l.jsx("div",{className:"p-6 space-y-4 max-h-[60vh] overflow-y-auto",children:!ne&&!se?l.jsxs("div",{className:"text-center py-8 text-text-muted",children:[l.jsx(rt,{name:"check-circle",className:"w-12 h-12 mx-auto text-green-500"}),l.jsx("p",{className:"mt-2 font-medium",children:"Everything is up-to-date!"}),l.jsx("p",{className:"text-sm",children:"Your local data already matches the contents of this backup file."})]}):l.jsxs(KS,{type:"multiple",defaultValue:ue,children:[he.length>0&&l.jsxs(Pu,{value:"new-series",className:"border-b",children:[l.jsxs(qu,{children:["New Series (",he.length,")"]}),l.jsx(Gu,{className:"p-2 space-y-2",children:he.map(de=>l.jsx("div",{className:"p-3 bg-background rounded-md border border-border",children:l.jsxs("label",{className:"flex items-start gap-3 cursor-pointer",children:[l.jsx("input",{type:"checkbox",checked:A.has(de.id),onChange:()=>F(de.id),className:"mt-1 h-4 w-4 rounded border-gray-300 text-primary focus:ring-primary"}),l.jsxs("div",{className:"flex-grow",children:[l.jsx("p",{className:"font-semibold text-text",children:de.name}),l.jsxs("p",{className:"text-xs text-text-muted",children:[(de.levels||[]).reduce((oe,ye)=>{var ie;return oe+(((ie=ye.deckIds)==null?void 0:ie.length)||0)},0)," deck(s)"]})]})]})},de.id))})]}),Z.length>0&&l.jsxs(Pu,{value:"changed-series",className:"border-b",children:[l.jsxs(qu,{children:["Changed Series (",Z.length,")"]}),l.jsx(Gu,{className:"p-2 space-y-2",children:Z.map(({local:de,backup:oe,diff:ye})=>{var $e,C;const ie=`${(($e=G.get(de.id))==null?void 0:$e.size)||0}/${(de.levels||[]).reduce((Ne,Ce)=>{var re;return Ne+(((re=Ce.deckIds)==null?void 0:re.length)||0)},0)}`,We=`${((C=((E==null?void 0:E.seriesProgress)||{})[oe.id])==null?void 0:C.length)||0}/${(oe.levels||[]).reduce((Ne,Ce)=>{var re;return Ne+(((re=Ce.deckIds)==null?void 0:re.length)||0)},0)}`,ot=Math.round((Be.get(`local-${de.id}`)||0)*100),ft=Math.round((Be.get(oe.id)||0)*100);return l.jsx("div",{className:"p-3 bg-background rounded-md border border-border",children:l.jsxs("label",{className:"flex items-start gap-3 cursor-pointer",children:[l.jsx("input",{type:"checkbox",checked:A.has(oe.id),onChange:()=>F(oe.id),className:"mt-1 h-4 w-4 rounded border-gray-300 text-primary focus:ring-primary"}),l.jsxs("div",{className:"flex-grow space-y-1",children:[l.jsx("p",{className:"font-semibold text-text",children:oe.name}),l.jsx(cc,{label:"Completion",localValue:ie,backupValue:We,hasChanged:ye.completion}),l.jsx(cc,{label:"Mastery",localValue:`${ot}%`,backupValue:`${ft}%`,hasChanged:ye.mastery}),ye.structure&&l.jsx("p",{className:"text-xs font-semibold text-primary",children:"Content/Structure updated"})]})]})},oe.id)})})]}),z.length>0&&l.jsxs(Pu,{value:"new-decks",className:"border-b",children:[l.jsxs(qu,{children:["New Standalone Decks (",z.length,")"]}),l.jsx(Gu,{className:"p-2 space-y-2",children:z.map(de=>l.jsx("div",{className:"p-3 bg-background rounded-md border border-border",children:l.jsxs("label",{className:"flex items-start gap-3 cursor-pointer",children:[l.jsx("input",{type:"checkbox",checked:A.has(de.id),onChange:()=>F(de.id),className:"mt-1 h-4 w-4 rounded border-gray-300 text-primary focus:ring-primary"}),l.jsxs("div",{className:"flex-grow",children:[l.jsx("p",{className:"font-semibold text-text",children:de.name}),l.jsxs("p",{className:"text-xs text-text-muted",children:[te(de)," item(s)  ",ve.get(de.id)||0," due"]})]})]})},de.id))})]}),De.length>0&&l.jsxs(Pu,{value:"changed-decks",className:"border-b",children:[l.jsxs(qu,{children:["Changed Decks (",De.length,")"]}),l.jsx(Gu,{className:"p-2 space-y-2",children:De.map(({local:de,backup:oe,diff:ye})=>{const ie=Math.round((Be.get(`local-${de.id}`)||0)*100),We=Math.round((Be.get(oe.id)||0)*100);return l.jsx("div",{className:"p-3 bg-background rounded-md border border-border",children:l.jsxs("label",{className:"flex items-start gap-3 cursor-pointer",children:[l.jsx("input",{type:"checkbox",checked:A.has(oe.id),onChange:()=>F(oe.id),className:"mt-1 h-4 w-4 rounded border-gray-300 text-primary focus:ring-primary"}),l.jsxs("div",{className:"flex-grow space-y-1",children:[l.jsx("p",{className:"font-semibold text-text",children:oe.name}),l.jsx(cc,{label:"Items",localValue:te(de),backupValue:te(oe),hasChanged:ye.content}),l.jsx(cc,{label:"Due",localValue:ve.get(`local-${de.id}`),backupValue:ve.get(oe.id),hasChanged:ye.dueCount}),l.jsx(cc,{label:"Mastery",localValue:`${ie}%`,backupValue:`${We}%`,hasChanged:ye.mastery}),ye.content&&l.jsx("p",{className:"text-xs font-semibold text-primary",children:"Content updated"})]})]})},oe.id)})})]})]})})}return l.jsxs("div",{className:"p-6 space-y-4",children:[l.jsx("input",{type:"file",ref:R,className:"hidden",accept:".json,application/json,.zip",onChange:H}),l.jsxs("label",{onDragOver:U,onDrop:L,className:"flex flex-col items-center justify-center w-full h-48 border-2 border-dashed border-border rounded-lg cursor-pointer hover:bg-background",children:[l.jsx(rt,{name:"upload-cloud",className:"w-10 h-10 text-text-muted mb-2"}),l.jsxs("p",{className:"text-sm text-text-muted",children:[l.jsx("span",{className:"font-semibold text-primary",onClick:he=>{var J;he.preventDefault(),(J=R.current)==null||J.click()},children:"Click to upload"})," or drag and drop"]}),l.jsx("p",{className:"text-xs text-text-muted/70",children:"CogniFlow Backup JSON file"})]})]})};return l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-[60] p-4",children:l.jsxs("div",{ref:q,className:"bg-surface rounded-lg shadow-xl w-full max-w-lg overflow-hidden transform transition-all relative",children:[l.jsxs("div",{className:"flex justify-between items-center p-4 border-b border-border",children:[l.jsx("h2",{className:"text-xl font-bold",children:"Restore from Backup"}),l.jsx(pt,{variant:"ghost",onClick:Y,className:"p-1 h-auto",disabled:p==="loading",children:l.jsx(rt,{name:"x"})})]}),j(),l.jsxs("div",{className:"flex justify-between items-center p-4 bg-background/50 border-t border-border",children:[l.jsx("div",{children:p==="compare"&&l.jsx(pt,{variant:"danger",onClick:le,children:"Full Restore"})}),l.jsxs("div",{className:"flex gap-2",children:[l.jsx(pt,{variant:"secondary",onClick:Y,disabled:p==="loading",children:"Cancel"}),p==="compare"&&l.jsxs(pt,{variant:"primary",onClick:Q,disabled:A.size===0,children:["Add/Update Selected (",A.size,")"]})]})]})]})})},$S=({isOpen:n,onClose:a,onReset:s,decks:i})=>{const[c,u]=$.useState(""),{addToast:f}=Ar(),p=$.useRef(null);kr(p,n);const m=!!$.useMemo(()=>i.find(N=>N.id===c),[i,c]),_=()=>{if(!m){f("Please select a deck to reset.","error");return}s(c),a()},E=()=>{u(""),a()};return n?l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-[60] p-4",children:l.jsxs("div",{ref:p,className:"bg-surface rounded-lg shadow-xl w-full max-w-lg transform transition-all relative",children:[l.jsxs("div",{className:"flex justify-between items-center p-4 border-b border-border",children:[l.jsx("h2",{className:"text-xl font-bold",children:"Reset Deck Progress"}),l.jsx(pt,{type:"button",variant:"ghost",onClick:E,className:"p-1 h-auto",children:l.jsx(rt,{name:"x"})})]}),l.jsxs("div",{className:"p-6 space-y-4",children:[l.jsx("div",{className:"bg-red-900/20 border border-red-500/30 rounded-lg p-4 text-sm text-red-700 dark:text-red-200",children:l.jsxs("p",{children:[l.jsx("strong",{className:"font-bold",children:"Warning:"})," This will reset all spaced repetition data (due dates, intervals) for the selected deck. The cards themselves will not be deleted. This action cannot be undone."]})}),l.jsxs("div",{children:[l.jsx("label",{htmlFor:"deck-select",className:"block text-sm font-medium text-text-muted mb-1",children:"Select Deck"}),l.jsxs("select",{id:"deck-select",value:c,onChange:N=>{u(N.target.value)},className:"w-full p-2 bg-background border border-border rounded-md focus:ring-2 focus:ring-primary focus:outline-none",children:[l.jsx("option",{value:"",disabled:!0,children:"-- Select a deck --"}),i.map(N=>l.jsx("option",{value:N.id,children:N.name},N.id))]})]})]}),l.jsxs("div",{className:"flex justify-end p-4 bg-background/50 border-t border-border",children:[l.jsx(pt,{type:"button",variant:"secondary",onClick:E,className:"mr-2",children:"Cancel"}),l.jsxs(pt,{type:"button",variant:"danger",onClick:_,disabled:!m,children:[l.jsx(rt,{name:"refresh-ccw",className:"w-5 h-5 mr-2"}),"Reset Progress"]})]})]})}):null},VS=({isOpen:n,onClose:a,onConfirm:s,title:i,message:c,confirmText:u})=>{const[f,p]=$.useState(!1),b=$.useRef(null);kr(b,n),$.useEffect(()=>{n&&p(!1)},[n]);const m=async()=>{p(!0);try{await Promise.resolve(s()),b.current&&a()}catch(_){console.error("Confirmation action failed:",_)}finally{b.current&&p(!1)}};return n?l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-[60] p-4",children:l.jsxs("div",{ref:b,className:"bg-surface rounded-lg shadow-xl w-full max-w-md transform transition-all relative",role:"alertdialog","aria-modal":"true","aria-labelledby":"confirm-title","aria-describedby":"confirm-message",children:[l.jsxs("div",{className:"flex justify-between items-center p-4 border-b border-border",children:[l.jsx("h2",{id:"confirm-title",className:"text-xl font-bold text-text",children:i}),l.jsx(pt,{type:"button",variant:"ghost",onClick:a,className:"p-1 h-auto","aria-label":"Close",disabled:f,children:l.jsx(rt,{name:"x"})})]}),l.jsx("div",{className:"p-6 space-y-4",children:l.jsx("p",{id:"confirm-message",className:"text-text-muted",children:c})}),l.jsxs("div",{className:"flex justify-end p-4 bg-background/50 border-t border-border",children:[l.jsx(pt,{type:"button",variant:"secondary",onClick:a,className:"mr-2",disabled:f,children:"Cancel"}),l.jsx(pt,{type:"button",variant:"danger",onClick:m,disabled:f,children:f?l.jsx(Rs,{size:"sm"}):u||"Confirm"})]})]})}):null},ZS=({folder:n,isOpen:a,onClose:s,onSave:i})=>{const[c,u]=$.useState(""),{addToast:f}=Ar(),p=$.useRef(null);kr(p,a),$.useEffect(()=>{u(n?n.name:"")},[n]);const b=m=>{if(m.preventDefault(),!c.trim()){f("Folder name cannot be empty.","error");return}i({id:(n==null?void 0:n.id)||null,name:c.trim()}),s()};return a?l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-[60] p-4",children:l.jsx("div",{ref:p,className:"bg-surface rounded-lg shadow-xl w-full max-w-md transform transition-all relative",children:l.jsxs("form",{onSubmit:b,children:[l.jsxs("div",{className:"flex justify-between items-center p-4 border-b border-border",children:[l.jsx("h2",{className:"text-xl font-bold",children:n?"Edit Folder":"Create New Folder"}),l.jsx(pt,{type:"button",variant:"ghost",onClick:s,className:"p-1 h-auto",children:l.jsx(rt,{name:"x"})})]}),l.jsx("div",{className:"p-6 space-y-4",children:l.jsxs("div",{children:[l.jsx("label",{htmlFor:"folder-name",className:"block text-sm font-medium text-text-muted mb-1",children:"Folder Name"}),l.jsx("input",{id:"folder-name",type:"text",value:c,onChange:m=>u(m.target.value),className:"w-full p-2 bg-background border border-border rounded-md focus:ring-2 focus:ring-primary focus:outline-none",placeholder:"e.g., University Courses",autoFocus:!0})]})}),l.jsxs("div",{className:"flex justify-end p-4 bg-background/50 border-t border-border",children:[l.jsx(pt,{type:"button",variant:"secondary",onClick:s,className:"mr-2",children:"Cancel"}),l.jsxs(pt,{type:"submit",variant:"primary",children:[l.jsx(rt,{name:"save",className:"w-4 h-4 mr-2"}),n?"Save Changes":"Create Folder"]})]})]})})}):null},QS=({series:n,isOpen:a,onClose:s,onSave:i})=>{const[c,u]=$.useState(""),[f,p]=$.useState(""),[b,m]=$.useState(null),{addToast:_}=Ar(),E=$.useRef(null);kr(E,a);const N=n===null;$.useEffect(()=>{n?(u(n.name),p(n.description),m(null)):(u(""),p(""),m(null))},[n]);const S=A=>{if(!N)return;const k=A.clipboardData.getData("text");if(k.trim().startsWith("{"))try{const R=JSON.parse(k);typeof R.seriesName=="string"&&typeof R.seriesDescription=="string"&&Array.isArray(R.levels)&&(A.preventDefault(),u(R.seriesName),p(R.seriesDescription),m(R),_("Series details and structure populated from JSON scaffold!","success"))}catch{}},I=A=>{if(A.preventDefault(),!c.trim()){_("Series name cannot be empty.","error");return}i({id:N?null:n.id,name:c.trim(),description:f.trim(),scaffold:N?b:null}),s()};return a?l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-[60] p-4",children:l.jsx("div",{ref:E,className:"bg-surface rounded-lg shadow-xl w-full max-w-lg transform transition-all relative",children:l.jsxs("form",{onSubmit:I,children:[l.jsxs("div",{className:"flex justify-between items-center p-4 border-b border-border",children:[l.jsx("h2",{className:"text-xl font-bold",children:N?"Create New Series":"Edit Series"}),l.jsx(pt,{type:"button",variant:"ghost",onClick:s,className:"p-1 h-auto",children:l.jsx(rt,{name:"x"})})]}),l.jsxs("div",{className:"p-6 space-y-4",children:[l.jsxs("div",{children:[l.jsx("label",{htmlFor:"series-name",className:"block text-sm font-medium text-text-muted mb-1",children:"Series Name"}),l.jsx("input",{id:"series-name",type:"text",value:c,onChange:A=>u(A.target.value),onPaste:S,className:"w-full p-2 bg-background border border-border rounded-md focus:ring-2 focus:ring-primary focus:outline-none",placeholder:"e.g., Introduction to Algebra",autoFocus:!0}),N&&l.jsx("p",{className:"text-xs text-text-muted mt-1",children:"You can paste a full JSON scaffold object here to auto-populate."})]}),l.jsxs("div",{children:[l.jsx("label",{htmlFor:"series-description",className:"block text-sm font-medium text-text-muted mb-1",children:"Description"}),l.jsx("textarea",{id:"series-description",value:f,onChange:A=>p(A.target.value),onPaste:S,rows:3,className:"w-full p-2 bg-background border border-border rounded-md focus:ring-2 focus:ring-primary focus:outline-none",placeholder:"A collection of decks covering core concepts."})]}),N&&b&&l.jsxs("div",{className:"space-y-2 animate-fade-in",children:[l.jsx("h4",{className:"text-sm font-semibold text-text-muted",children:"Structure Preview"}),l.jsx("div",{className:"bg-background border border-border rounded-md p-3 max-h-48 overflow-y-auto text-sm",children:l.jsx("ul",{className:"space-y-3",children:(b.levels||[]).filter(A=>!!A).map((A,k)=>{const R=A.decks||[];return l.jsxs("li",{children:[l.jsxs("div",{className:"flex items-center gap-2 font-medium text-text",children:[l.jsx(rt,{name:"layers",className:"w-4 h-4 text-purple-500 flex-shrink-0"}),l.jsx("span",{className:"font-semibold",children:A.title})]}),l.jsxs("ul",{className:"pl-6 mt-1 space-y-1",children:[R.map((P,q)=>l.jsxs("li",{className:"flex items-center gap-2 text-text-muted",children:[l.jsx(rt,{name:"help-circle",className:"w-3.5 h-3.5 flex-shrink-0"}),l.jsx("span",{children:P.name})]},q)),R.length===0&&l.jsx("li",{className:"flex items-center gap-2 text-xs text-text-muted/70 italic",children:"(No decks in this level)"})]})]},k)})})})]})]}),l.jsxs("div",{className:"flex justify-end p-4 bg-background/50 border-t border-border",children:[l.jsx(pt,{type:"button",variant:"secondary",onClick:s,className:"mr-2",children:"Cancel"}),l.jsxs(pt,{type:"submit",variant:"primary",children:[l.jsx(rt,{name:"save",className:"w-4 h-4 mr-2"}),N?"Create Series":"Save Changes"]})]})]})})}):null},Yb="cogniflow-ai-options",Ku={understandingLevels:["Auto","Novice","Beginner","Intermediate","Advanced","Expert"],comprehensivenessLevels:["Quick Overview","Standard","Comprehensive","Exhaustive"],learningGoalOptions:["Auto","Master a subject","Learn for the sake of curiosity","Explore a new interest","Become more informed","Understand a complex topic","Practically learn the topic"],learningStyleOptions:["Auto","Conceptual Understanding (Why & How)","Factual Recall (What, Who, When)","Practical Application & Scenarios"],languageOptions:["Auto","English","Swedish","Spanish","French","German","Japanese","Mandarin","Russian"],toneOptions:["Auto","Neutral","Formal","Casual","Academic","Enthusiastic","Humorous"],personas:[{id:"default",name:"Default Assistant",instruction:"You are a helpful and neutral AI assistant."},{id:"tutor",name:"Friendly Tutor",instruction:"You are a friendly and encouraging tutor. You use analogies and explain complex topics in a simple, easy-to-understand way."},{id:"professor",name:"University Professor",instruction:"You are an expert professor. Your tone is formal, academic, and you provide in-depth, precise information."},{id:"author",name:"Technical Author",instruction:"You are a technical author. Your style is concise, precise, and fact-focused. You avoid fluff and get straight to the point."},{id:"lindstrom",name:"Fredrik Lindstrm",instruction:'You are Fredrik Lindstrm. You explain topics with a focus on linguistics, history, and cultural nuances. You are witty, slightly dry, and love to find the "human" element in dry facts. You make connections between language, culture, and history that others miss.'},{id:"bryson",name:"Bill Bryson",instruction:'You are Bill Bryson. You write with an infectious sense of wonder, finding the "extraordinary in the ordinary." Your prose is conversational, witty, and avoids academic jargon. You use dry, self-deprecating humor and focus on the bizarre anecdotes and hidden history that textbooks leave out.'},{id:"feynman",name:"Richard Feynman",instruction:'You are Richard Feynman. You hate jargon and pseudo-intellectualism. Your goal is to explain complex topics using simple, physical analogies and plain language. You focus on the "why" and "how," not just the names of things. You are enthusiastic and radically curious.'},{id:"roach",name:"Mary Roach",instruction:"You are Mary Roach. You are intensely curious about the practical, slightly gross, or bizarre aspects of the topic. You focus on the human side of science and historythe sweat, the mistakes, and the awkward details. You are funny, fearless, and relatable."},{id:"great_teacher",name:"The Great Teacher",instruction:`You are "The Great Teacher." Your teaching style is built on narrative, humor, and relatability. You model "Radical Curiosity" and awe for the subject. You use storytelling to make facts stick, and you constantly relate the material back to the learner's life.`},{id:"the_master",name:"The Master",instruction:`You are "The Master," the ultimate educational companion. 
      
      CORE PHILOSOPHY: Facts are useless without context. Understanding requires "Radical Curiosity."
      
      YOUR 5 PILLARS OF TEACHING:
      1. THE STYLIST: Write with rhythm. Combine short, punchy sentences with lyrical descriptions. Avoid dry academic tone. You are a mentor, not a manual.
      2. THE STORYTELLER: Find the human struggle behind the fact. Gravity isn't just a force; it's Newton's obsession.
      3. THE ANALOGY ARCHITECT: Never explain a complex abstract concept without a concrete physical analogy. (e.g., "Voltage is water pressure").
      4. THE PROVOCATEUR (Keating Mode): Occasionally ask the user a question that has no right answer. Challenge their assumptions. Remind them that learning is an act of rebellion.
      5. THE FORMATTER: Use HTML tags (<b>, <i>, <br>) aggressively to structure your text. Key terms must be bold. Use italics for emphasis.
      
      When generating content, you must embody this persona completely.`}],customFields:[]},JS=()=>{try{const n=localStorage.getItem(Yb);if(n){const a=JSON.parse(n),s=[...Ku.personas,...(a.personas||[]).filter(i=>!Ku.personas.some(c=>c.id===i.id))];return{...Ku,...a,personas:s}}}catch(n){console.error("Failed to parse AI options from localStorage",n)}return Ku},Fc=()=>{const[n,a]=$.useState(JS),s=c=>{try{localStorage.setItem(Yb,JSON.stringify(c)),a(c)}catch(u){console.error("Failed to save AI options to localStorage",u)}},i=$.useCallback((c,u)=>{a(f=>{const p={...f,[c]:u};return s(p),p})},[]);return{options:n,updateCategory:i}},ll=({title:n,category:a})=>{const{options:s,updateCategory:i}=Fc(),[c,u]=$.useState(s[a]),[f,p]=$.useState(""),b=()=>{if(f.trim()){const _=[...c,f.trim()];u(_),i(a,_),p("")}},m=_=>{const E=c.filter((N,S)=>S!==_);u(E),i(a,E)};return l.jsxs("div",{className:"p-4 bg-background border border-border rounded-lg",children:[l.jsx("h4",{className:"font-semibold text-text mb-2",children:n}),l.jsx("ul",{className:"space-y-2",children:c.map((_,E)=>l.jsxs("li",{className:"flex items-center justify-between p-2 bg-surface rounded-md border border-border/50",children:[l.jsx("span",{className:"text-sm",children:_}),l.jsx(pt,{variant:"ghost",size:"sm",className:"p-1 h-auto",onClick:()=>m(E),children:l.jsx(rt,{name:"trash-2",className:"w-4 h-4 text-red-500"})})]},E))}),l.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[l.jsx("input",{type:"text",value:f,onChange:_=>p(_.target.value),onKeyDown:_=>{_.key==="Enter"&&(_.preventDefault(),b())},placeholder:"Add...",className:"flex-grow p-1.5 text-sm bg-surface border border-border rounded-md"}),l.jsx(pt,{variant:"secondary",size:"sm",onClick:b,children:"Add"})]})]})},XS=()=>{const{options:n,updateCategory:a}=Fc(),[s,i]=$.useState(()=>JSON.parse(JSON.stringify(n.personas))),{addToast:c}=Ar(),u=(m,_,E)=>{const N=[...s];N[m]={...N[m],[_]:E},i(N)},f=()=>{i([...s,{id:crypto.randomUUID(),name:"",instruction:""}])},p=m=>{s[m].id!=="default"&&i(s.filter((_,E)=>E!==m))},b=()=>{a("personas",s.filter(m=>m.name.trim()&&m.instruction.trim())),c("Personas saved!","success")};return l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{className:"flex justify-between items-center",children:[l.jsx("h4",{className:"font-semibold text-text",children:"AI Personas"}),l.jsx(pt,{variant:"secondary",size:"sm",onClick:b,children:"Save Personas"})]}),s.map((m,_)=>l.jsxs("div",{className:"space-y-2 p-3 bg-background border border-border rounded-md",children:[l.jsx("input",{type:"text",placeholder:"Persona Name (e.g., Cheerful Tutor)",value:m.name,onChange:E=>u(_,"name",E.target.value),className:"w-full p-2 text-sm bg-surface border border-border rounded-md",disabled:m.id==="default"}),l.jsx("textarea",{placeholder:"System instruction for this persona...",value:m.instruction,onChange:E=>u(_,"instruction",E.target.value),rows:3,className:"w-full p-2 text-sm bg-surface border border-border rounded-md"}),m.id!=="default"&&l.jsxs(pt,{variant:"ghost",size:"sm",onClick:()=>p(_),className:"text-red-500",children:[l.jsx(rt,{name:"trash-2",className:"w-4 h-4 mr-2"})," Remove Persona"]})]},m.id)),l.jsxs(pt,{variant:"ghost",size:"sm",onClick:f,children:[l.jsx(rt,{name:"plus",className:"w-4 h-4 mr-2"})," Add Persona"]})]})},WS=({onBack:n})=>l.jsxs("div",{className:"flex flex-col h-full overflow-hidden",children:[l.jsx("header",{className:"flex-shrink-0 flex justify-between items-center p-4 border-b border-border",children:l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(pt,{variant:"ghost",onClick:n,className:"p-1 h-auto",children:l.jsx(rt,{name:"chevron-left"})}),l.jsx("h2",{className:"text-xl font-bold",children:"Manage AI Options"})]})}),l.jsxs("main",{className:"flex-grow p-6 overflow-y-auto space-y-6 no-scrollbar",children:[l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[l.jsx(ll,{title:"Understanding Levels",category:"understandingLevels"}),l.jsx(ll,{title:"Comprehensiveness Levels",category:"comprehensivenessLevels"}),l.jsx(ll,{title:"Learning Goals",category:"learningGoalOptions"}),l.jsx(ll,{title:"Learning Styles",category:"learningStyleOptions"}),l.jsx(ll,{title:"Languages",category:"languageOptions"}),l.jsx(ll,{title:"Tones",category:"toneOptions"})]}),l.jsx("div",{className:"border-t border-border pt-6 pb-4",children:l.jsx(XS,{})})]})]}),e1=({isOpen:n,onClose:a,onStartAIGeneration:s,initialTopic:i,initialGenerationType:c,context:u})=>{const[f,p]=$.useState("main"),[b,m]=$.useState(i||(u==null?void 0:u.deckName)||""),[_,E]=$.useState(""),[N,S]=$.useState(u!=null&&u.sourceMaterial?"deep-course":u!=null&&u.seriesId?"series":"deck"),[I,A]=$.useState(u!=null&&u.sourceMaterial?"learning":"quiz"),[k,R]=$.useState(10),[P,q]=$.useState(12),[G,Y]=$.useState(1e4),[W,H]=$.useState("none"),[L,U]=$.useState("default"),[Q,le]=$.useState("Auto"),[F,te]=$.useState("Standard"),[j,he]=$.useState((u==null?void 0:u.sourceMaterial)||""),[J,Z]=$.useState(!!(u!=null&&u.sourceMaterial)),De=$.useRef(null),{options:ve}=Fc(),Be=$.useRef(null);kr(Be,n);const{addToast:T}=Ar(),z=_l(),ne=(u==null?void 0:u.mode)||"generate";$.useEffect(()=>{u!=null&&u.deckType&&(u.deckType===et.Flashcard?A("flashcard"):u.deckType===et.Learning&&A("learning"))},[u]);const se=()=>({generationType:ne==="rework"?"rework-deck":N==="deep-course"?"deep-course":N==="series"?"series-quiz":"single-deck-quiz",topic:b,persona:L,understanding:Q,comprehensiveness:F,count:k,imageStyle:I==="flashcard"?W:void 0,seriesId:u==null?void 0:u.seriesId,levelIndex:u==null?void 0:u.levelIndex,deckId:u==null?void 0:u.deckId,reworkInstructions:_.trim(),chapterCount:N==="deep-course"?P:void 0,targetWordCount:N==="deep-course"?G:void 0,sourceMaterial:j.trim()||void 0}),ue=()=>{b.trim()&&(z.handleImmediateAIGeneration(se()),a())},de=async oe=>{var ie;const ye=(ie=oe.target.files)==null?void 0:ie[0];if(ye)try{const We=await Kh(ye);he(We),b||m(ye.name.replace(/\.[^/.]+$/,"")),T("Material ingested successfully.","success")}catch(We){T(We.message,"error")}oe.target&&(oe.target.value="")};return n?l.jsx("div",{className:"fixed inset-0 bg-black/75 flex items-center justify-center z-[60] p-4",children:l.jsx("div",{ref:Be,className:"bg-surface rounded-lg shadow-xl w-full max-w-2xl transform transition-all relative h-full max-h-[95vh] overflow-hidden flex flex-col",children:f==="main"?l.jsxs("div",{className:"flex flex-col h-full overflow-hidden",children:[l.jsxs("header",{className:"flex-shrink-0 flex justify-between items-center p-4 border-b border-border",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(rt,{name:"bot",className:"w-6 h-6 text-primary"}),l.jsx("h2",{className:"text-xl font-bold",children:ne==="rework"?"Rework Content":"AI Content Studio"})]}),l.jsx(pt,{variant:"ghost",onClick:a,className:"p-1 h-auto",children:l.jsx(rt,{name:"x"})})]}),l.jsxs("main",{className:"flex-grow p-6 space-y-6 overflow-y-auto no-scrollbar",children:[l.jsxs("div",{className:"bg-primary/5 border border-primary/10 rounded-xl p-4 flex items-start gap-4",children:[l.jsx("div",{className:"bg-primary/10 p-2 rounded-lg text-primary",children:l.jsx(rt,{name:N==="deep-course"||N==="series"?"layers":"laptop",className:"w-6 h-6"})}),l.jsxs("div",{className:"flex-grow",children:[l.jsx("h3",{className:"font-bold text-sm text-text",children:"Target Goal"}),l.jsxs("p",{className:"text-xs text-text-muted",children:["Generating ",N==="deep-course"?"a comprehensive master course":N==="series"?"a multi-level series":"a standalone deck"," on your chosen topic."]})]})]}),l.jsxs("div",{className:"space-y-2",children:[l.jsx("label",{className:"block text-xs font-bold text-text-muted uppercase tracking-widest",children:"Generation Scope"}),l.jsxs("div",{className:"flex bg-background rounded-lg p-1 border border-border",children:[l.jsx("button",{onClick:()=>S("deck"),className:`flex-1 py-2 rounded-md text-sm font-medium transition-all ${N==="deck"?"bg-primary text-on-primary shadow-sm":"text-text-muted hover:text-text"}`,children:"Standalone Deck"}),l.jsx("button",{onClick:()=>S("series"),className:`flex-1 py-2 rounded-md text-sm font-medium transition-all ${N==="series"?"bg-primary text-on-primary shadow-sm":"text-text-muted hover:text-text"}`,children:"Full Series"}),l.jsx("button",{onClick:()=>S("deep-course"),className:`flex-1 py-2 rounded-md text-sm font-medium transition-all ${N==="deep-course"?"bg-indigo-600 text-on-primary shadow-sm":"text-text-muted hover:text-text"}`,children:"Hyper-Course "})]})]}),l.jsxs("div",{children:[l.jsx("label",{htmlFor:"topic",className:"block text-sm font-medium text-text-muted mb-1",children:"Concept Topic / Title"}),l.jsx("input",{id:"topic",type:"text",value:b,onChange:oe=>m(oe.target.value),placeholder:"e.g., Quantum Mechanics, Conversational Spanish, AWS Solutions Architect...",className:"w-full p-3 bg-background border border-border rounded-lg focus:ring-2 focus:ring-primary focus:outline-none text-lg font-bold"})]}),l.jsxs("div",{className:"space-y-3",children:[l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("label",{className:"flex items-center gap-2 text-sm font-semibold text-text",children:[l.jsx(rt,{name:"file-text",className:"w-4 h-4 text-indigo-500"}),"Knowledge Source"]}),l.jsx("button",{onClick:()=>Z(!J),className:`text-xs font-bold px-2 py-1 rounded-md transition-all ${J?"bg-indigo-100 text-indigo-600":"bg-background border border-border text-text-muted hover:border-indigo-300"}`,children:J?"Using Custom Source":"Use Generic AI Knowledge"})]}),J&&l.jsxs("div",{className:"animate-fade-in space-y-3 p-4 bg-indigo-50 dark:bg-indigo-950/20 border border-indigo-200 dark:border-indigo-800 rounded-xl",children:[l.jsx("p",{className:"text-[10px] text-indigo-600 dark:text-indigo-400 font-bold uppercase tracking-widest",children:"Ingested Material"}),l.jsx("textarea",{value:j,onChange:oe=>he(oe.target.value),placeholder:"Paste your text, notes, or article content here. The AI will strictly follow this material for all chapters and questions.",className:"w-full h-32 p-3 bg-background border border-indigo-100 dark:border-indigo-900 rounded-lg focus:ring-2 focus:ring-indigo-500 outline-none text-sm resize-none"}),l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsx("p",{className:"text-[10px] text-text-muted font-mono",children:j?`${j.split(/\s+/).length} words loaded`:"No text entered"}),l.jsxs(pt,{variant:"ghost",size:"sm",onClick:()=>{var oe;return(oe=De.current)==null?void 0:oe.click()},className:"text-indigo-600 hover:bg-indigo-100 h-auto py-1",children:[l.jsx(rt,{name:"upload-cloud",className:"w-3.5 h-3.5 mr-1.5"})," Upload Document"]}),l.jsx("input",{type:"file",ref:De,className:"hidden",accept:".txt,.md,.markdown,.rtf",onChange:de})]})]})]}),N==="deep-course"&&l.jsxs("div",{className:"space-y-4 p-5 bg-indigo-600 text-white rounded-xl shadow-lg animate-fade-in relative overflow-hidden",children:[l.jsx("div",{className:"absolute top-0 right-0 -mr-8 -mt-8 opacity-10",children:l.jsx(rt,{name:"zap",className:"w-32 h-32"})}),l.jsxs("div",{className:"relative flex flex-col gap-4",children:[l.jsxs("div",{children:[l.jsxs("div",{className:"flex justify-between items-center mb-2",children:[l.jsx("span",{className:"text-xs font-black uppercase tracking-tighter opacity-80",children:"Depth of Curriculum"}),l.jsxs("span",{className:"text-sm font-bold bg-white/20 px-2 py-0.5 rounded",children:[P," Chapters"]})]}),l.jsx("input",{type:"range",min:"5",max:"30",value:P,onChange:oe=>q(Number(oe.target.value)),className:"w-full accent-white"})]}),l.jsxs("div",{children:[l.jsxs("div",{className:"flex justify-between items-center mb-2",children:[l.jsx("span",{className:"text-xs font-black uppercase tracking-tighter opacity-80",children:"Word Density"}),l.jsxs("span",{className:"text-sm font-bold bg-white/20 px-2 py-0.5 rounded",children:["~",(G/1e3).toFixed(0),"k total words"]})]}),l.jsx("input",{type:"range",min:"3000",max:"30000",step:"1000",value:G,onChange:oe=>Y(Number(oe.target.value)),className:"w-full accent-white"})]})]})]}),l.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4 pt-4 border-t border-border",children:[l.jsxs("div",{className:"space-y-1",children:[l.jsx("label",{htmlFor:"persona",className:"block text-xs font-bold text-text-muted uppercase tracking-widest",children:"Instructional Persona"}),l.jsx("select",{id:"persona",value:L,onChange:oe=>U(oe.target.value),className:"w-full p-2.5 bg-background border border-border rounded-lg focus:ring-2 focus:ring-primary",children:ve.personas.map(oe=>l.jsx("option",{value:oe.id,children:oe.name},oe.id))})]}),l.jsxs("div",{className:"space-y-1",children:[l.jsx("label",{htmlFor:"understanding",className:"block text-xs font-bold text-text-muted uppercase tracking-widest",children:"Target Proficiency"}),l.jsx("select",{id:"understanding",value:Q,onChange:oe=>le(oe.target.value),className:"w-full p-2.5 bg-background border border-border rounded-lg focus:ring-2 focus:ring-primary",children:ve.understandingLevels.map(oe=>l.jsx("option",{value:oe,children:oe},oe))})]})]})]}),l.jsxs("footer",{className:"flex-shrink-0 flex justify-end items-center p-4 bg-background/50 border-t border-border gap-2",children:[l.jsx(pt,{variant:"secondary",onClick:a,children:"Cancel"}),l.jsxs(pt,{variant:"primary",onClick:ue,disabled:!b.trim(),className:"px-8 font-bold",children:[l.jsx(rt,{name:"zap",className:"w-5 h-5 mr-2"})," Start Synthesis"]})]})]}):l.jsx(WS,{onBack:()=>p("main")})})}):null},t1=({isOpen:n,onClose:a,onCancel:s})=>{const{currentTask:i,queue:c,streamingDrafts:u,chapterPhases:f}=kt(S=>S.aiGenerationStatus),p=kt(S=>S.decks),b=$.useRef(null);kr(b,n);const m=()=>{s()},_=S=>{s(S)},E=$.useMemo(()=>{if((i==null?void 0:i.type)!=="generateDeepCourse"||!i.deckId)return null;const S=p[i.deckId];return!S||!S.curriculum?null:S.curriculum.chapters.map(A=>({...A,phase:f[A.id]||"queued"}))},[i,p,f]);if(!n)return null;const N=S=>{switch(S){case"complete":return"bg-green-500 shadow-[0_0_8px_rgba(34,197,94,0.4)]";case"drafting":return"bg-blue-400 animate-pulse";case"auditing":return"bg-amber-400 animate-pulse";case"illustrating":return"bg-purple-400 animate-pulse";case"finalizing":return"bg-primary animate-pulse";case"failed":return"bg-red-500";default:return"bg-border"}};return l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-[60] p-4",children:l.jsxs("div",{ref:b,className:"bg-surface rounded-lg shadow-xl w-full max-w-xl transform transition-all relative max-h-[85vh] flex flex-col",role:"dialog","aria-modal":"true","aria-labelledby":"ai-status-title",children:[l.jsxs("div",{className:"flex-shrink-0 flex justify-between items-center p-4 border-b border-border",children:[l.jsxs("h2",{id:"ai-status-title",className:"text-xl font-bold text-text flex items-center gap-2",children:[l.jsx(rt,{name:"bot",className:"text-primary w-6 h-6"}),"AI Pipeline"]}),l.jsx(pt,{type:"button",variant:"ghost",onClick:a,className:"p-1 h-auto","aria-label":"Close",children:l.jsx(rt,{name:"x"})})]}),l.jsxs("div",{className:"p-6 overflow-y-auto space-y-8 no-scrollbar",children:[l.jsxs("section",{children:[l.jsxs("div",{className:"flex items-center justify-between mb-4",children:[l.jsx("h3",{className:"text-xs font-bold uppercase tracking-widest text-text-muted",children:"Active Process"}),i&&l.jsx("span",{className:"text-[10px] bg-primary/10 text-primary px-2 py-0.5 rounded-full font-bold animate-pulse",children:"AGENT RUNNING"})]}),l.jsx("div",{className:"bg-background/50 border border-border rounded-xl p-5 shadow-inner",children:i?l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{className:"flex items-start gap-4",children:[l.jsx("div",{className:"p-3 bg-primary/10 rounded-full",children:l.jsx(Rs,{size:"sm"})}),l.jsxs("div",{className:"flex-grow min-w-0",children:[l.jsx("p",{className:"text-sm font-bold text-text truncate mb-1",children:i.type==="generateDeepCourse"?"Synthesizing Hyper-Course":"Standard Generation"}),l.jsx("p",{className:"text-xs text-text-muted leading-relaxed",children:i.statusText||"Executing instructional logic..."})]}),l.jsx(pt,{variant:"danger",size:"sm",onClick:m,className:"flex-shrink-0",children:"Abort"})]}),E&&l.jsxs("div",{className:"pt-4 border-t border-border/50",children:[l.jsx("p",{className:"text-[10px] font-bold text-text-muted uppercase mb-3",children:"Project Blueprint"}),l.jsx("div",{className:"grid grid-cols-5 gap-2",children:E.map((S,I)=>l.jsx("div",{title:`${I+1}. ${S.title} (${S.phase})`,className:`h-2.5 rounded-full transition-all duration-500 ${N(S.phase)}`},S.id))}),l.jsxs("div",{className:"flex justify-between mt-3 text-[9px] text-text-muted font-mono uppercase",children:[l.jsxs("div",{className:"flex items-center gap-1",children:[l.jsx("span",{className:"w-2 h-2 rounded-full bg-blue-400"})," Draft"]}),l.jsxs("div",{className:"flex items-center gap-1",children:[l.jsx("span",{className:"w-2 h-2 rounded-full bg-amber-400"})," Audit"]}),l.jsxs("div",{className:"flex items-center gap-1",children:[l.jsx("span",{className:"w-2 h-2 rounded-full bg-purple-400"})," Visual"]}),l.jsxs("div",{className:"flex items-center gap-1",children:[l.jsx("span",{className:"w-2 h-2 rounded-full bg-green-500"})," Done"]})]})]})]}):l.jsxs("div",{className:"text-center py-6",children:[l.jsx(rt,{name:"check-circle",className:"w-10 h-10 text-text-muted/30 mx-auto mb-2"}),l.jsx("p",{className:"text-sm text-text-muted",children:"No active background processes."})]})})]}),c&&c.length>0&&l.jsxs("section",{children:[l.jsxs("h3",{className:"text-xs font-bold uppercase tracking-widest text-text-muted mb-3",children:["Waitlist (",c.length,")"]}),l.jsx("ul",{className:"space-y-2",children:c.map(S=>l.jsxs("li",{className:"bg-background border border-border p-3 rounded-lg flex items-center justify-between gap-4 group transition-colors hover:border-primary/30",children:[l.jsxs("div",{className:"flex items-center gap-3 min-w-0",children:[l.jsx(rt,{name:"layers",className:"w-4 h-4 text-text-muted/50"}),l.jsx("p",{className:"text-text text-xs font-medium truncate",children:S.statusText})]}),l.jsx("button",{onClick:()=>_(S.id),className:"text-text-muted hover:text-red-500 opacity-0 group-hover:opacity-100 transition-all p-1","aria-label":"Remove from queue",children:l.jsx(rt,{name:"x-circle",className:"w-4 h-4"})})]},S.id))})]}),l.jsx("div",{className:"bg-primary/5 rounded-lg p-4 border border-primary/10",children:l.jsxs("div",{className:"flex gap-3",children:[l.jsx(rt,{name:"info",className:"w-5 h-5 text-primary flex-shrink-0"}),l.jsxs("p",{className:"text-xs text-text-muted leading-relaxed",children:["The ",l.jsx("b",{children:"Hyper-Course Engine"})," uses multiple agent passes. First, it architects a curriculum, then parallel agents draft chapters, followed by search-grounded audits and visual enrichment. Closing this modal will not stop the process."]})]})})]}),l.jsx("div",{className:"flex-shrink-0 flex justify-end p-4 bg-background/50 border-t border-border",children:l.jsx(pt,{type:"button",variant:"primary",onClick:a,className:"px-8",children:"Done"})})]})})};var nd={exports:{}},n1=nd.exports,Fy;function r1(){return Fy||(Fy=1,(function(n,a){(function(s,i){n.exports=i()})(n1,function(){var s=function(d,g){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(w,D){w.__proto__=D}||function(w,D){for(var B in D)Object.prototype.hasOwnProperty.call(D,B)&&(w[B]=D[B])})(d,g)},i=function(){return(i=Object.assign||function(d){for(var g,w=1,D=arguments.length;w<D;w++)for(var B in g=arguments[w])Object.prototype.hasOwnProperty.call(g,B)&&(d[B]=g[B]);return d}).apply(this,arguments)};function c(d,g,w){for(var D,B=0,K=g.length;B<K;B++)!D&&B in g||((D=D||Array.prototype.slice.call(g,0,B))[B]=g[B]);return d.concat(D||Array.prototype.slice.call(g))}var u=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:mc,f=Object.keys,p=Array.isArray;function b(d,g){return typeof g!="object"||f(g).forEach(function(w){d[w]=g[w]}),d}typeof Promise>"u"||u.Promise||(u.Promise=Promise);var m=Object.getPrototypeOf,_={}.hasOwnProperty;function E(d,g){return _.call(d,g)}function N(d,g){typeof g=="function"&&(g=g(m(d))),(typeof Reflect>"u"?f:Reflect.ownKeys)(g).forEach(function(w){I(d,w,g[w])})}var S=Object.defineProperty;function I(d,g,w,D){S(d,g,b(w&&E(w,"get")&&typeof w.get=="function"?{get:w.get,set:w.set,configurable:!0}:{value:w,configurable:!0,writable:!0},D))}function A(d){return{from:function(g){return d.prototype=Object.create(g.prototype),I(d.prototype,"constructor",d),{extend:N.bind(null,d.prototype)}}}}var k=Object.getOwnPropertyDescriptor,R=[].slice;function P(d,g,w){return R.call(d,g,w)}function q(d,g){return g(d)}function G(d){if(!d)throw new Error("Assertion Failed")}function Y(d){u.setImmediate?setImmediate(d):setTimeout(d,0)}function W(d,g){if(typeof g=="string"&&E(d,g))return d[g];if(!g)return d;if(typeof g!="string"){for(var w=[],D=0,B=g.length;D<B;++D){var K=W(d,g[D]);w.push(K)}return w}var ae=g.indexOf(".");if(ae!==-1){var fe=d[g.substr(0,ae)];return fe==null?void 0:W(fe,g.substr(ae+1))}}function H(d,g,w){if(d&&g!==void 0&&!("isFrozen"in Object&&Object.isFrozen(d)))if(typeof g!="string"&&"length"in g){G(typeof w!="string"&&"length"in w);for(var D=0,B=g.length;D<B;++D)H(d,g[D],w[D])}else{var K,ae,fe=g.indexOf(".");fe!==-1?(K=g.substr(0,fe),(ae=g.substr(fe+1))===""?w===void 0?p(d)&&!isNaN(parseInt(K))?d.splice(K,1):delete d[K]:d[K]=w:H(fe=!(fe=d[K])||!E(d,K)?d[K]={}:fe,ae,w)):w===void 0?p(d)&&!isNaN(parseInt(g))?d.splice(g,1):delete d[g]:d[g]=w}}function L(d){var g,w={};for(g in d)E(d,g)&&(w[g]=d[g]);return w}var U=[].concat;function Q(d){return U.apply([],d)}var sa="BigUint64Array,BigInt64Array,Array,Boolean,String,Date,RegExp,Blob,File,FileList,FileSystemFileHandle,FileSystemDirectoryHandle,ArrayBuffer,DataView,Uint8ClampedArray,ImageBitmap,ImageData,Map,Set,CryptoKey".split(",").concat(Q([8,16,32,64].map(function(d){return["Int","Uint","Float"].map(function(g){return g+d+"Array"})}))).filter(function(d){return u[d]}),le=new Set(sa.map(function(d){return u[d]})),F=null;function te(d){return F=new WeakMap,d=(function g(w){if(!w||typeof w!="object")return w;var D=F.get(w);if(D)return D;if(p(w)){D=[],F.set(w,D);for(var B=0,K=w.length;B<K;++B)D.push(g(w[B]))}else if(le.has(w.constructor))D=w;else{var ae,fe=m(w);for(ae in D=fe===Object.prototype?{}:Object.create(fe),F.set(w,D),w)E(w,ae)&&(D[ae]=g(w[ae]))}return D})(d),F=null,d}var j={}.toString;function he(d){return j.call(d).slice(8,-1)}var J=typeof Symbol<"u"?Symbol.iterator:"@@iterator",Z=typeof J=="symbol"?function(d){var g;return d!=null&&(g=d[J])&&g.apply(d)}:function(){return null};function De(d,g){return g=d.indexOf(g),0<=g&&d.splice(g,1),0<=g}var ve={};function Be(d){var g,w,D,B;if(arguments.length===1){if(p(d))return d.slice();if(this===ve&&typeof d=="string")return[d];if(B=Z(d)){for(w=[];!(D=B.next()).done;)w.push(D.value);return w}if(d==null)return[d];if(typeof(g=d.length)!="number")return[d];for(w=new Array(g);g--;)w[g]=d[g];return w}for(g=arguments.length,w=new Array(g);g--;)w[g]=arguments[g];return w}var T=typeof Symbol<"u"?function(d){return d[Symbol.toStringTag]==="AsyncFunction"}:function(){return!1},Ue=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],ea=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"].concat(Ue),z={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed",MissingAPI:"IndexedDB API missing. Please visit https://tinyurl.com/y2uuvskb"};function ne(d,g){this.name=d,this.message=g}function se(d,g){return d+". Errors: "+Object.keys(g).map(function(w){return g[w].toString()}).filter(function(w,D,B){return B.indexOf(w)===D}).join(`
`)}function ue(d,g,w,D){this.failures=g,this.failedKeys=D,this.successCount=w,this.message=se(d,g)}function de(d,g){this.name="BulkError",this.failures=Object.keys(g).map(function(w){return g[w]}),this.failuresByPos=g,this.message=se(d,this.failures)}A(ne).from(Error).extend({toString:function(){return this.name+": "+this.message}}),A(ue).from(ne),A(de).from(ne);var oe=ea.reduce(function(d,g){return d[g]=g+"Error",d},{}),ye=ne,ie=ea.reduce(function(d,g){var w=g+"Error";function D(B,K){this.name=w,B?typeof B=="string"?(this.message="".concat(B).concat(K?`
 `+K:""),this.inner=K||null):typeof B=="object"&&(this.message="".concat(B.name," ").concat(B.message),this.inner=B):(this.message=z[g]||w,this.inner=null)}return A(D).from(ye),d[g]=D,d},{});ie.Syntax=SyntaxError,ie.Type=TypeError,ie.Range=RangeError;var We=Ue.reduce(function(d,g){return d[g+"Error"]=ie[g],d},{}),ot=ea.reduce(function(d,g){return["Syntax","Type","Range"].indexOf(g)===-1&&(d[g+"Error"]=ie[g]),d},{});function ft(){}function $e(d){return d}function C(d,g){return d==null||d===$e?g:function(w){return g(d(w))}}function Ne(d,g){return function(){d.apply(this,arguments),g.apply(this,arguments)}}function Ce(d,g){return d===ft?g:function(){var w=d.apply(this,arguments);w!==void 0&&(arguments[0]=w);var D=this.onsuccess,B=this.onerror;this.onsuccess=null,this.onerror=null;var K=g.apply(this,arguments);return D&&(this.onsuccess=this.onsuccess?Ne(D,this.onsuccess):D),B&&(this.onerror=this.onerror?Ne(B,this.onerror):B),K!==void 0?K:w}}function re(d,g){return d===ft?g:function(){d.apply(this,arguments);var w=this.onsuccess,D=this.onerror;this.onsuccess=this.onerror=null,g.apply(this,arguments),w&&(this.onsuccess=this.onsuccess?Ne(w,this.onsuccess):w),D&&(this.onerror=this.onerror?Ne(D,this.onerror):D)}}function ee(d,g){return d===ft?g:function(w){var D=d.apply(this,arguments);b(w,D);var B=this.onsuccess,K=this.onerror;return this.onsuccess=null,this.onerror=null,w=g.apply(this,arguments),B&&(this.onsuccess=this.onsuccess?Ne(B,this.onsuccess):B),K&&(this.onerror=this.onerror?Ne(K,this.onerror):K),D===void 0?w===void 0?void 0:w:b(D,w)}}function me(d,g){return d===ft?g:function(){return g.apply(this,arguments)!==!1&&d.apply(this,arguments)}}function Ve(d,g){return d===ft?g:function(){var w=d.apply(this,arguments);if(w&&typeof w.then=="function"){for(var D=this,B=arguments.length,K=new Array(B);B--;)K[B]=arguments[B];return w.then(function(){return g.apply(D,K)})}return g.apply(this,arguments)}}ot.ModifyError=ue,ot.DexieError=ne,ot.BulkError=de;var Ye=typeof location<"u"&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function be(d){Ye=d}var Ze={},at=100,sa=typeof Promise>"u"?[]:(function(){var d=Promise.resolve();if(typeof crypto>"u"||!crypto.subtle)return[d,m(d),d];var g=crypto.subtle.digest("SHA-512",new Uint8Array([0]));return[g,m(g),d]})(),Ue=sa[0],ea=sa[1],sa=sa[2],ea=ea&&ea.then,_t=Ue&&Ue.constructor,It=!!sa,Nt=function(d,g){tn.push([d,g]),Zt&&(queueMicrotask(mt),Zt=!1)},on=!0,Zt=!0,cn=[],bn=[],zt=$e,Ht={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:ft,pgp:!1,env:{},finalize:ft},yt=Ht,tn=[],or=0,At=[];function gt(d){if(typeof this!="object")throw new TypeError("Promises must be constructed via new");this._listeners=[],this._lib=!1;var g=this._PSD=yt;if(typeof d!="function"){if(d!==Ze)throw new TypeError("Not a function");return this._state=arguments[1],this._value=arguments[2],void(this._state===!1&&qn(this,this._value))}this._state=null,this._value=null,++g.ref,(function w(D,B){try{B(function(K){if(D._state===null){if(K===D)throw new TypeError("A promise cannot be resolved with itself.");var ae=D._lib&&Vr();K&&typeof K.then=="function"?w(D,function(fe,ke){K instanceof gt?K._then(fe,ke):K.then(fe,ke)}):(D._state=!0,D._value=K,vr(D)),ae&&zn()}},qn.bind(null,D))}catch(K){qn(D,K)}})(this,d)}var jr={get:function(){var d=yt,g=zr;function w(D,B){var K=this,ae=!d.global&&(d!==yt||g!==zr),fe=ae&&!nn(),ke=new gt(function(xe,je){Tr(K,new An(_e(D,d,ae,fe),_e(B,d,ae,fe),xe,je,d))});return this._consoleTask&&(ke._consoleTask=this._consoleTask),ke}return w.prototype=Ze,w},set:function(d){I(this,"then",d&&d.prototype===Ze?jr:{get:function(){return d},set:jr.set})}};function An(d,g,w,D,B){this.onFulfilled=typeof d=="function"?d:null,this.onRejected=typeof g=="function"?g:null,this.resolve=w,this.reject=D,this.psd=B}function qn(d,g){var w,D;bn.push(g),d._state===null&&(w=d._lib&&Vr(),g=zt(g),d._state=!1,d._value=g,D=d,cn.some(function(B){return B._value===D._value})||cn.push(D),vr(d),w&&zn())}function vr(d){var g=d._listeners;d._listeners=[];for(var w=0,D=g.length;w<D;++w)Tr(d,g[w]);var B=d._PSD;--B.ref||B.finalize(),or===0&&(++or,Nt(function(){--or==0&&Lr()},[]))}function Tr(d,g){if(d._state!==null){var w=d._state?g.onFulfilled:g.onRejected;if(w===null)return(d._state?g.resolve:g.reject)(d._value);++g.psd.ref,++or,Nt(ka,[w,d,g])}else d._listeners.push(g)}function ka(d,g,w){try{var D,B=g._value;!g._state&&bn.length&&(bn=[]),D=Ye&&g._consoleTask?g._consoleTask.run(function(){return d(B)}):d(B),g._state||bn.indexOf(B)!==-1||(function(K){for(var ae=cn.length;ae;)if(cn[--ae]._value===K._value)return cn.splice(ae,1)})(g),w.resolve(D)}catch(K){w.reject(K)}finally{--or==0&&Lr(),--w.psd.ref||w.psd.finalize()}}function mt(){St(Ht,function(){Vr()&&zn()})}function Vr(){var d=on;return Zt=on=!1,d}function zn(){var d,g,w;do for(;0<tn.length;)for(d=tn,tn=[],w=d.length,g=0;g<w;++g){var D=d[g];D[0].apply(null,D[1])}while(0<tn.length);Zt=on=!0}function Lr(){var d=cn;cn=[],d.forEach(function(D){D._PSD.onunhandled.call(null,D._value,D)});for(var g=At.slice(0),w=g.length;w;)g[--w]()}function Aa(d){return new gt(Ze,!1,d)}function En(d,g){var w=yt;return function(){var D=Vr(),B=yt;try{return Fr(w,!0),d.apply(this,arguments)}catch(K){g&&g(K)}finally{Fr(B,!1),D&&zn()}}}N(gt.prototype,{then:jr,_then:function(d,g){Tr(this,new An(null,null,d,g,yt))},catch:function(d){if(arguments.length===1)return this.then(null,d);var g=d,w=arguments[1];return typeof g=="function"?this.then(null,function(D){return(D instanceof g?w:Aa)(D)}):this.then(null,function(D){return(D&&D.name===g?w:Aa)(D)})},finally:function(d){return this.then(function(g){return gt.resolve(d()).then(function(){return g})},function(g){return gt.resolve(d()).then(function(){return Aa(g)})})},timeout:function(d,g){var w=this;return d<1/0?new gt(function(D,B){var K=setTimeout(function(){return B(new ie.Timeout(g))},d);w.then(D,B).finally(clearTimeout.bind(null,K))}):this}}),typeof Symbol<"u"&&Symbol.toStringTag&&I(gt.prototype,Symbol.toStringTag,"Dexie.Promise"),Ht.env=Us(),N(gt,{all:function(){var d=Be.apply(null,arguments).map(Br);return new gt(function(g,w){d.length===0&&g([]);var D=d.length;d.forEach(function(B,K){return gt.resolve(B).then(function(ae){d[K]=ae,--D||g(d)},w)})})},resolve:function(d){return d instanceof gt?d:d&&typeof d.then=="function"?new gt(function(g,w){d.then(g,w)}):new gt(Ze,!0,d)},reject:Aa,race:function(){var d=Be.apply(null,arguments).map(Br);return new gt(function(g,w){d.map(function(D){return gt.resolve(D).then(g,w)})})},PSD:{get:function(){return yt},set:function(d){return yt=d}},totalEchoes:{get:function(){return zr}},newPSD:nr,usePSD:St,scheduler:{get:function(){return Nt},set:function(d){Nt=d}},rejectionMapper:{get:function(){return zt},set:function(d){zt=d}},follow:function(d,g){return new gt(function(w,D){return nr(function(B,K){var ae=yt;ae.unhandleds=[],ae.onunhandled=K,ae.finalize=Ne(function(){var fe,ke=this;fe=function(){ke.unhandleds.length===0?B():K(ke.unhandleds[0])},At.push(function xe(){fe(),At.splice(At.indexOf(xe),1)}),++or,Nt(function(){--or==0&&Lr()},[])},ae.finalize),d()},g,w,D)})}}),_t&&(_t.allSettled&&I(gt,"allSettled",function(){var d=Be.apply(null,arguments).map(Br);return new gt(function(g){d.length===0&&g([]);var w=d.length,D=new Array(w);d.forEach(function(B,K){return gt.resolve(B).then(function(ae){return D[K]={status:"fulfilled",value:ae}},function(ae){return D[K]={status:"rejected",reason:ae}}).then(function(){return--w||g(D)})})})}),_t.any&&typeof AggregateError<"u"&&I(gt,"any",function(){var d=Be.apply(null,arguments).map(Br);return new gt(function(g,w){d.length===0&&w(new AggregateError([]));var D=d.length,B=new Array(D);d.forEach(function(K,ae){return gt.resolve(K).then(function(fe){return g(fe)},function(fe){B[ae]=fe,--D||w(new AggregateError(B))})})})}));var Dn={awaits:0,echoes:0,id:0},Cr=0,Vn=[],da=0,zr=0,Ms=0;function nr(d,g,w,D){var B=yt,K=Object.create(B);return K.parent=B,K.ref=0,K.global=!1,K.id=++Ms,Ht.env,K.env=It?{Promise:gt,PromiseProp:{value:gt,configurable:!0,writable:!0},all:gt.all,race:gt.race,allSettled:gt.allSettled,any:gt.any,resolve:gt.resolve,reject:gt.reject}:{},g&&b(K,g),++B.ref,K.finalize=function(){--this.parent.ref||this.parent.finalize()},D=St(K,d,w,D),K.ref===0&&K.finalize(),D}function gn(){return Dn.id||(Dn.id=++Cr),++Dn.awaits,Dn.echoes+=at,Dn.id}function nn(){return!!Dn.awaits&&(--Dn.awaits==0&&(Dn.id=0),Dn.echoes=Dn.awaits*at,!0)}function Br(d){return Dn.echoes&&d&&d.constructor===_t?(gn(),d.then(function(g){return nn(),g},function(g){return nn(),ut(g)})):d}function ms(){var d=Vn[Vn.length-1];Vn.pop(),Fr(d,!1)}function Fr(d,g){var w,D=yt;(g?!Dn.echoes||da++&&d===yt:!da||--da&&d===yt)||queueMicrotask(g?(function(B){++zr,Dn.echoes&&--Dn.echoes!=0||(Dn.echoes=Dn.awaits=Dn.id=0),Vn.push(yt),Fr(B,!0)}).bind(null,d):ms),d!==yt&&(yt=d,D===Ht&&(Ht.env=Us()),It&&(w=Ht.env.Promise,g=d.env,(D.global||d.global)&&(Object.defineProperty(u,"Promise",g.PromiseProp),w.all=g.all,w.race=g.race,w.resolve=g.resolve,w.reject=g.reject,g.allSettled&&(w.allSettled=g.allSettled),g.any&&(w.any=g.any))))}function Us(){var d=u.Promise;return It?{Promise:d,PromiseProp:Object.getOwnPropertyDescriptor(u,"Promise"),all:d.all,race:d.race,allSettled:d.allSettled,any:d.any,resolve:d.resolve,reject:d.reject}:{}}function St(d,g,w,D,B){var K=yt;try{return Fr(d,!0),g(w,D,B)}finally{Fr(K,!1)}}function _e(d,g,w,D){return typeof d!="function"?d:function(){var B=yt;w&&gn(),Fr(g,!0);try{return d.apply(this,arguments)}finally{Fr(B,!1),D&&queueMicrotask(nn)}}}function st(d){Promise===_t&&Dn.echoes===0?da===0?d():enqueueNativeMicroTask(d):setTimeout(d,0)}(""+ea).indexOf("[native code]")===-1&&(gn=nn=ft);var ut=gt.reject,Rt="",xn="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",Rn="String expected.",$t=[],Zn="__dbnames",Hr="readonly",Mn="readwrite";function Xn(d,g){return d?g?function(){return d.apply(this,arguments)&&g.apply(this,arguments)}:d:g}var es={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1};function gs(d){return typeof d!="string"||/\./.test(d)?function(g){return g}:function(g){return g[d]===void 0&&d in g&&delete(g=te(g))[d],g}}function ii(){throw ie.Type()}function dn(d,g){try{var w=Ls(d),D=Ls(g);if(w!==D)return w==="Array"?1:D==="Array"?-1:w==="binary"?1:D==="binary"?-1:w==="string"?1:D==="string"?-1:w==="Date"?1:D!=="Date"?NaN:-1;switch(w){case"number":case"Date":case"string":return g<d?1:d<g?-1:0;case"binary":return(function(B,K){for(var ae=B.length,fe=K.length,ke=ae<fe?ae:fe,xe=0;xe<ke;++xe)if(B[xe]!==K[xe])return B[xe]<K[xe]?-1:1;return ae===fe?0:ae<fe?-1:1})(ys(d),ys(g));case"Array":return(function(B,K){for(var ae=B.length,fe=K.length,ke=ae<fe?ae:fe,xe=0;xe<ke;++xe){var je=dn(B[xe],K[xe]);if(je!==0)return je}return ae===fe?0:ae<fe?-1:1})(d,g)}}catch{}return NaN}function Ls(d){var g=typeof d;return g!="object"?g:ArrayBuffer.isView(d)?"binary":(d=he(d),d==="ArrayBuffer"?"binary":d)}function ys(d){return d instanceof Uint8Array?d:ArrayBuffer.isView(d)?new Uint8Array(d.buffer,d.byteOffset,d.byteLength):new Uint8Array(d)}var aa=(Qt.prototype._trans=function(d,g,w){var D=this._tx||yt.trans,B=this.name,K=Ye&&typeof console<"u"&&console.createTask&&console.createTask("Dexie: ".concat(d==="readonly"?"read":"write"," ").concat(this.name));function ae(xe,je,ge){if(!ge.schema[B])throw new ie.NotFound("Table "+B+" not part of transaction");return g(ge.idbtrans,ge)}var fe=Vr();try{var ke=D&&D.db._novip===this.db._novip?D===yt.trans?D._promise(d,ae,w):nr(function(){return D._promise(d,ae,w)},{trans:D,transless:yt.transless||yt}):(function xe(je,ge,Re,Ee){if(je.idbdb&&(je._state.openComplete||yt.letThrough||je._vip)){var Ae=je._createTransaction(ge,Re,je._dbSchema);try{Ae.create(),je._state.PR1398_maxLoop=3}catch(Oe){return Oe.name===oe.InvalidState&&je.isOpen()&&0<--je._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),je.close({disableAutoOpen:!1}),je.open().then(function(){return xe(je,ge,Re,Ee)})):ut(Oe)}return Ae._promise(ge,function(Oe,Te){return nr(function(){return yt.trans=Ae,Ee(Oe,Te,Ae)})}).then(function(Oe){if(ge==="readwrite")try{Ae.idbtrans.commit()}catch{}return ge==="readonly"?Oe:Ae._completion.then(function(){return Oe})})}if(je._state.openComplete)return ut(new ie.DatabaseClosed(je._state.dbOpenError));if(!je._state.isBeingOpened){if(!je._state.autoOpen)return ut(new ie.DatabaseClosed);je.open().catch(ft)}return je._state.dbReadyPromise.then(function(){return xe(je,ge,Re,Ee)})})(this.db,d,[this.name],ae);return K&&(ke._consoleTask=K,ke=ke.catch(function(xe){return console.trace(xe),ut(xe)})),ke}finally{fe&&zn()}},Qt.prototype.get=function(d,g){var w=this;return d&&d.constructor===Object?this.where(d).first(g):d==null?ut(new ie.Type("Invalid argument to Table.get()")):this._trans("readonly",function(D){return w.core.get({trans:D,key:d}).then(function(B){return w.hook.reading.fire(B)})}).then(g)},Qt.prototype.where=function(d){if(typeof d=="string")return new this.db.WhereClause(this,d);if(p(d))return new this.db.WhereClause(this,"[".concat(d.join("+"),"]"));var g=f(d);if(g.length===1)return this.where(g[0]).equals(d[g[0]]);var w=this.schema.indexes.concat(this.schema.primKey).filter(function(ke){if(ke.compound&&g.every(function(je){return 0<=ke.keyPath.indexOf(je)})){for(var xe=0;xe<g.length;++xe)if(g.indexOf(ke.keyPath[xe])===-1)return!1;return!0}return!1}).sort(function(ke,xe){return ke.keyPath.length-xe.keyPath.length})[0];if(w&&this.db._maxKey!==Rt){var ae=w.keyPath.slice(0,g.length);return this.where(ae).equals(ae.map(function(xe){return d[xe]}))}!w&&Ye&&console.warn("The query ".concat(JSON.stringify(d)," on ").concat(this.name," would benefit from a ")+"compound index [".concat(g.join("+"),"]"));var D=this.schema.idxByName,B=this.db._deps.indexedDB;function K(ke,xe){return B.cmp(ke,xe)===0}var fe=g.reduce(function(Re,xe){var je=Re[0],ge=Re[1],Re=D[xe],Ee=d[xe];return[je||Re,je||!Re?Xn(ge,Re&&Re.multi?function(Ae){return Ae=W(Ae,xe),p(Ae)&&Ae.some(function(Oe){return K(Ee,Oe)})}:function(Ae){return K(Ee,W(Ae,xe))}):ge]},[null,null]),ae=fe[0],fe=fe[1];return ae?this.where(ae.name).equals(d[ae.keyPath]).filter(fe):w?this.filter(fe):this.where(g).equals("")},Qt.prototype.filter=function(d){return this.toCollection().and(d)},Qt.prototype.count=function(d){return this.toCollection().count(d)},Qt.prototype.offset=function(d){return this.toCollection().offset(d)},Qt.prototype.limit=function(d){return this.toCollection().limit(d)},Qt.prototype.each=function(d){return this.toCollection().each(d)},Qt.prototype.toArray=function(d){return this.toCollection().toArray(d)},Qt.prototype.toCollection=function(){return new this.db.Collection(new this.db.WhereClause(this))},Qt.prototype.orderBy=function(d){return new this.db.Collection(new this.db.WhereClause(this,p(d)?"[".concat(d.join("+"),"]"):d))},Qt.prototype.reverse=function(){return this.toCollection().reverse()},Qt.prototype.mapToClass=function(d){var g,w=this.db,D=this.name;function B(){return g!==null&&g.apply(this,arguments)||this}(this.schema.mappedClass=d).prototype instanceof ii&&((function(ke,xe){if(typeof xe!="function"&&xe!==null)throw new TypeError("Class extends value "+String(xe)+" is not a constructor or null");function je(){this.constructor=ke}s(ke,xe),ke.prototype=xe===null?Object.create(xe):(je.prototype=xe.prototype,new je)})(B,g=d),Object.defineProperty(B.prototype,"db",{get:function(){return w},enumerable:!1,configurable:!0}),B.prototype.table=function(){return D},d=B);for(var K=new Set,ae=d.prototype;ae;ae=m(ae))Object.getOwnPropertyNames(ae).forEach(function(ke){return K.add(ke)});function fe(ke){if(!ke)return ke;var xe,je=Object.create(d.prototype);for(xe in ke)if(!K.has(xe))try{je[xe]=ke[xe]}catch{}return je}return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=fe,this.hook("reading",fe),d},Qt.prototype.defineClass=function(){return this.mapToClass(function(d){b(this,d)})},Qt.prototype.add=function(d,g){var w=this,D=this.schema.primKey,B=D.auto,K=D.keyPath,ae=d;return K&&B&&(ae=gs(K)(d)),this._trans("readwrite",function(fe){return w.core.mutate({trans:fe,type:"add",keys:g!=null?[g]:null,values:[ae]})}).then(function(fe){return fe.numFailures?gt.reject(fe.failures[0]):fe.lastResult}).then(function(fe){if(K)try{H(d,K,fe)}catch{}return fe})},Qt.prototype.update=function(d,g){return typeof d!="object"||p(d)?this.where(":id").equals(d).modify(g):(d=W(d,this.schema.primKey.keyPath),d===void 0?ut(new ie.InvalidArgument("Given object does not contain its primary key")):this.where(":id").equals(d).modify(g))},Qt.prototype.put=function(d,g){var w=this,D=this.schema.primKey,B=D.auto,K=D.keyPath,ae=d;return K&&B&&(ae=gs(K)(d)),this._trans("readwrite",function(fe){return w.core.mutate({trans:fe,type:"put",values:[ae],keys:g!=null?[g]:null})}).then(function(fe){return fe.numFailures?gt.reject(fe.failures[0]):fe.lastResult}).then(function(fe){if(K)try{H(d,K,fe)}catch{}return fe})},Qt.prototype.delete=function(d){var g=this;return this._trans("readwrite",function(w){return g.core.mutate({trans:w,type:"delete",keys:[d]})}).then(function(w){return w.numFailures?gt.reject(w.failures[0]):void 0})},Qt.prototype.clear=function(){var d=this;return this._trans("readwrite",function(g){return d.core.mutate({trans:g,type:"deleteRange",range:es})}).then(function(g){return g.numFailures?gt.reject(g.failures[0]):void 0})},Qt.prototype.bulkGet=function(d){var g=this;return this._trans("readonly",function(w){return g.core.getMany({keys:d,trans:w}).then(function(D){return D.map(function(B){return g.hook.reading.fire(B)})})})},Qt.prototype.bulkAdd=function(d,g,w){var D=this,B=Array.isArray(g)?g:void 0,K=(w=w||(B?void 0:g))?w.allKeys:void 0;return this._trans("readwrite",function(ae){var xe=D.schema.primKey,fe=xe.auto,xe=xe.keyPath;if(xe&&B)throw new ie.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(B&&B.length!==d.length)throw new ie.InvalidArgument("Arguments objects and keys must have the same length");var ke=d.length,xe=xe&&fe?d.map(gs(xe)):d;return D.core.mutate({trans:ae,type:"add",keys:B,values:xe,wantResults:K}).then(function(Ae){var ge=Ae.numFailures,Re=Ae.results,Ee=Ae.lastResult,Ae=Ae.failures;if(ge===0)return K?Re:Ee;throw new de("".concat(D.name,".bulkAdd(): ").concat(ge," of ").concat(ke," operations failed"),Ae)})})},Qt.prototype.bulkPut=function(d,g,w){var D=this,B=Array.isArray(g)?g:void 0,K=(w=w||(B?void 0:g))?w.allKeys:void 0;return this._trans("readwrite",function(ae){var xe=D.schema.primKey,fe=xe.auto,xe=xe.keyPath;if(xe&&B)throw new ie.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(B&&B.length!==d.length)throw new ie.InvalidArgument("Arguments objects and keys must have the same length");var ke=d.length,xe=xe&&fe?d.map(gs(xe)):d;return D.core.mutate({trans:ae,type:"put",keys:B,values:xe,wantResults:K}).then(function(Ae){var ge=Ae.numFailures,Re=Ae.results,Ee=Ae.lastResult,Ae=Ae.failures;if(ge===0)return K?Re:Ee;throw new de("".concat(D.name,".bulkPut(): ").concat(ge," of ").concat(ke," operations failed"),Ae)})})},Qt.prototype.bulkUpdate=function(d){var g=this,w=this.core,D=d.map(function(ae){return ae.key}),B=d.map(function(ae){return ae.changes}),K=[];return this._trans("readwrite",function(ae){return w.getMany({trans:ae,keys:D,cache:"clone"}).then(function(fe){var ke=[],xe=[];d.forEach(function(ge,Re){var Ee=ge.key,Ae=ge.changes,Oe=fe[Re];if(Oe){for(var Te=0,Fe=Object.keys(Ae);Te<Fe.length;Te++){var qe=Fe[Te],Ge=Ae[qe];if(qe===g.schema.primKey.keyPath){if(dn(Ge,Ee)!==0)throw new ie.Constraint("Cannot update primary key in bulkUpdate()")}else H(Oe,qe,Ge)}K.push(Re),ke.push(Ee),xe.push(Oe)}});var je=ke.length;return w.mutate({trans:ae,type:"put",keys:ke,values:xe,updates:{keys:D,changeSpecs:B}}).then(function(ge){var Re=ge.numFailures,Ee=ge.failures;if(Re===0)return je;for(var Ae=0,Oe=Object.keys(Ee);Ae<Oe.length;Ae++){var Te,Fe=Oe[Ae],qe=K[Number(Fe)];qe!=null&&(Te=Ee[Fe],delete Ee[Fe],Ee[qe]=Te)}throw new de("".concat(g.name,".bulkUpdate(): ").concat(Re," of ").concat(je," operations failed"),Ee)})})})},Qt.prototype.bulkDelete=function(d){var g=this,w=d.length;return this._trans("readwrite",function(D){return g.core.mutate({trans:D,type:"delete",keys:d})}).then(function(ae){var B=ae.numFailures,K=ae.lastResult,ae=ae.failures;if(B===0)return K;throw new de("".concat(g.name,".bulkDelete(): ").concat(B," of ").concat(w," operations failed"),ae)})},Qt);function Qt(){}function ts(d){function g(ae,fe){if(fe){for(var ke=arguments.length,xe=new Array(ke-1);--ke;)xe[ke-1]=arguments[ke];return w[ae].subscribe.apply(null,xe),d}if(typeof ae=="string")return w[ae]}var w={};g.addEventType=K;for(var D=1,B=arguments.length;D<B;++D)K(arguments[D]);return g;function K(ae,fe,ke){if(typeof ae!="object"){var xe;fe=fe||me;var je={subscribers:[],fire:ke=ke||ft,subscribe:function(ge){je.subscribers.indexOf(ge)===-1&&(je.subscribers.push(ge),je.fire=fe(je.fire,ge))},unsubscribe:function(ge){je.subscribers=je.subscribers.filter(function(Re){return Re!==ge}),je.fire=je.subscribers.reduce(fe,ke)}};return w[ae]=g[ae]=je}f(xe=ae).forEach(function(ge){var Re=xe[ge];if(p(Re))K(ge,xe[ge][0],xe[ge][1]);else{if(Re!=="asap")throw new ie.InvalidArgument("Invalid event config");var Ee=K(ge,$e,function(){for(var Ae=arguments.length,Oe=new Array(Ae);Ae--;)Oe[Ae]=arguments[Ae];Ee.subscribers.forEach(function(Te){Y(function(){Te.apply(null,Oe)})})})}})}}function kn(d,g){return A(g).from({prototype:d}),g}function Zr(d,g){return!(d.filter||d.algorithm||d.or)&&(g?d.justLimit:!d.replayFilter)}function vs(d,g){d.filter=Xn(d.filter,g)}function Qr(d,g,w){var D=d.replayFilter;d.replayFilter=D?function(){return Xn(D(),g())}:g,d.justLimit=w&&!D}function ns(d,g){if(d.isPrimKey)return g.primaryKey;var w=g.getIndexByKeyPath(d.index);if(!w)throw new ie.Schema("KeyPath "+d.index+" on object store "+g.name+" is not indexed");return w}function br(d,g,w){var D=ns(d,g.schema);return g.openCursor({trans:w,values:!d.keysOnly,reverse:d.dir==="prev",unique:!!d.unique,query:{index:D,range:d.range}})}function Ta(d,g,w,D){var B=d.replayFilter?Xn(d.filter,d.replayFilter()):d.filter;if(d.or){var K={},ae=function(fe,ke,xe){var je,ge;B&&!B(ke,xe,function(Re){return ke.stop(Re)},function(Re){return ke.fail(Re)})||((ge=""+(je=ke.primaryKey))=="[object ArrayBuffer]"&&(ge=""+new Uint8Array(je)),E(K,ge)||(K[ge]=!0,g(fe,ke,xe)))};return Promise.all([d.or._iterate(ae,w),rs(br(d,D,w),d.algorithm,ae,!d.keysOnly&&d.valueMapper)])}return rs(br(d,D,w),Xn(d.algorithm,B),g,!d.keysOnly&&d.valueMapper)}function rs(d,g,w,D){var B=En(D?function(K,ae,fe){return w(D(K),ae,fe)}:w);return d.then(function(K){if(K)return K.start(function(){var ae=function(){return K.continue()};g&&!g(K,function(fe){return ae=fe},function(fe){K.stop(fe),ae=ft},function(fe){K.fail(fe),ae=ft})||B(K.value,K,function(fe){return ae=fe}),ae()})})}var sa=Symbol(),fa=(oi.prototype.execute=function(d){if(this.add!==void 0){var g=this.add;if(p(g))return c(c([],p(d)?d:[],!0),g).sort();if(typeof g=="number")return(Number(d)||0)+g;if(typeof g=="bigint")try{return BigInt(d)+g}catch{return BigInt(0)+g}throw new TypeError("Invalid term ".concat(g))}if(this.remove!==void 0){var w=this.remove;if(p(w))return p(d)?d.filter(function(D){return!w.includes(D)}).sort():[];if(typeof w=="number")return Number(d)-w;if(typeof w=="bigint")try{return BigInt(d)-w}catch{return BigInt(0)-w}throw new TypeError("Invalid subtrahend ".concat(w))}return g=(g=this.replacePrefix)===null||g===void 0?void 0:g[0],g&&typeof d=="string"&&d.startsWith(g)?this.replacePrefix[1]+d.substring(g.length):d},oi);function oi(d){Object.assign(this,d)}var li=(rn.prototype._read=function(d,g){var w=this._ctx;return w.error?w.table._trans(null,ut.bind(null,w.error)):w.table._trans("readonly",d).then(g)},rn.prototype._write=function(d){var g=this._ctx;return g.error?g.table._trans(null,ut.bind(null,g.error)):g.table._trans("readwrite",d,"locked")},rn.prototype._addAlgorithm=function(d){var g=this._ctx;g.algorithm=Xn(g.algorithm,d)},rn.prototype._iterate=function(d,g){return Ta(this._ctx,d,g,this._ctx.table.core)},rn.prototype.clone=function(d){var g=Object.create(this.constructor.prototype),w=Object.create(this._ctx);return d&&b(w,d),g._ctx=w,g},rn.prototype.raw=function(){return this._ctx.valueMapper=null,this},rn.prototype.each=function(d){var g=this._ctx;return this._read(function(w){return Ta(g,d,w,g.table.core)})},rn.prototype.count=function(d){var g=this;return this._read(function(w){var D=g._ctx,B=D.table.core;if(Zr(D,!0))return B.count({trans:w,query:{index:ns(D,B.schema),range:D.range}}).then(function(ae){return Math.min(ae,D.limit)});var K=0;return Ta(D,function(){return++K,!1},w,B).then(function(){return K})}).then(d)},rn.prototype.sortBy=function(d,g){var w=d.split(".").reverse(),D=w[0],B=w.length-1;function K(ke,xe){return xe?K(ke[w[xe]],xe-1):ke[D]}var ae=this._ctx.dir==="next"?1:-1;function fe(ke,xe){return ke=K(ke,B),xe=K(xe,B),ke<xe?-ae:xe<ke?ae:0}return this.toArray(function(ke){return ke.sort(fe)}).then(g)},rn.prototype.toArray=function(d){var g=this;return this._read(function(w){var D=g._ctx;if(D.dir==="next"&&Zr(D,!0)&&0<D.limit){var B=D.valueMapper,K=ns(D,D.table.core.schema);return D.table.core.query({trans:w,limit:D.limit,values:!0,query:{index:K,range:D.range}}).then(function(fe){return fe=fe.result,B?fe.map(B):fe})}var ae=[];return Ta(D,function(fe){return ae.push(fe)},w,D.table.core).then(function(){return ae})},d)},rn.prototype.offset=function(d){var g=this._ctx;return d<=0||(g.offset+=d,Zr(g)?Qr(g,function(){var w=d;return function(D,B){return w===0||(w===1?--w:B(function(){D.advance(w),w=0}),!1)}}):Qr(g,function(){var w=d;return function(){return--w<0}})),this},rn.prototype.limit=function(d){return this._ctx.limit=Math.min(this._ctx.limit,d),Qr(this._ctx,function(){var g=d;return function(w,D,B){return--g<=0&&D(B),0<=g}},!0),this},rn.prototype.until=function(d,g){return vs(this._ctx,function(w,D,B){return!d(w.value)||(D(B),g)}),this},rn.prototype.first=function(d){return this.limit(1).toArray(function(g){return g[0]}).then(d)},rn.prototype.last=function(d){return this.reverse().first(d)},rn.prototype.filter=function(d){var g;return vs(this._ctx,function(w){return d(w.value)}),(g=this._ctx).isMatch=Xn(g.isMatch,d),this},rn.prototype.and=function(d){return this.filter(d)},rn.prototype.or=function(d){return new this.db.WhereClause(this._ctx.table,d,this)},rn.prototype.reverse=function(){return this._ctx.dir=this._ctx.dir==="prev"?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this},rn.prototype.desc=function(){return this.reverse()},rn.prototype.eachKey=function(d){var g=this._ctx;return g.keysOnly=!g.isMatch,this.each(function(w,D){d(D.key,D)})},rn.prototype.eachUniqueKey=function(d){return this._ctx.unique="unique",this.eachKey(d)},rn.prototype.eachPrimaryKey=function(d){var g=this._ctx;return g.keysOnly=!g.isMatch,this.each(function(w,D){d(D.primaryKey,D)})},rn.prototype.keys=function(d){var g=this._ctx;g.keysOnly=!g.isMatch;var w=[];return this.each(function(D,B){w.push(B.key)}).then(function(){return w}).then(d)},rn.prototype.primaryKeys=function(d){var g=this._ctx;if(g.dir==="next"&&Zr(g,!0)&&0<g.limit)return this._read(function(D){var B=ns(g,g.table.core.schema);return g.table.core.query({trans:D,values:!1,limit:g.limit,query:{index:B,range:g.range}})}).then(function(D){return D.result}).then(d);g.keysOnly=!g.isMatch;var w=[];return this.each(function(D,B){w.push(B.primaryKey)}).then(function(){return w}).then(d)},rn.prototype.uniqueKeys=function(d){return this._ctx.unique="unique",this.keys(d)},rn.prototype.firstKey=function(d){return this.limit(1).keys(function(g){return g[0]}).then(d)},rn.prototype.lastKey=function(d){return this.reverse().firstKey(d)},rn.prototype.distinct=function(){var d=this._ctx,d=d.index&&d.table.schema.idxByName[d.index];if(!d||!d.multi)return this;var g={};return vs(this._ctx,function(B){var D=B.primaryKey.toString(),B=E(g,D);return g[D]=!0,!B}),this},rn.prototype.modify=function(d){var g=this,w=this._ctx;return this._write(function(D){var B,K,ae;ae=typeof d=="function"?d:(B=f(d),K=B.length,function(Te){for(var Fe=!1,qe=0;qe<K;++qe){var Ge=B[qe],Xe=d[Ge],ct=W(Te,Ge);Xe instanceof fa?(H(Te,Ge,Xe.execute(ct)),Fe=!0):ct!==Xe&&(H(Te,Ge,Xe),Fe=!0)}return Fe});function fe(Te,Ge){var qe=Ge.failures,Ge=Ge.numFailures;Ae+=Te-Ge;for(var Xe=0,ct=f(qe);Xe<ct.length;Xe++){var bt=ct[Xe];Ee.push(qe[bt])}}var ke=w.table.core,xe=ke.schema.primaryKey,je=xe.outbound,ge=xe.extractKey,Re=g.db._options.modifyChunkSize||200,Ee=[],Ae=0,Oe=[];return g.clone().primaryKeys().then(function(Te){function Fe(Ge){var Xe=Math.min(Re,Te.length-Ge);return ke.getMany({trans:D,keys:Te.slice(Ge,Ge+Xe),cache:"immutable"}).then(function(ct){for(var bt=[],dt=[],vt=je?[]:null,xt=[],lt=0;lt<Xe;++lt){var Yt=ct[lt],Ft={value:te(Yt),primKey:Te[Ge+lt]};ae.call(Ft,Ft.value,Ft)!==!1&&(Ft.value==null?xt.push(Te[Ge+lt]):je||dn(ge(Yt),ge(Ft.value))===0?(dt.push(Ft.value),je&&vt.push(Te[Ge+lt])):(xt.push(Te[Ge+lt]),bt.push(Ft.value)))}return Promise.resolve(0<bt.length&&ke.mutate({trans:D,type:"add",values:bt}).then(function(Wt){for(var Pt in Wt.failures)xt.splice(parseInt(Pt),1);fe(bt.length,Wt)})).then(function(){return(0<dt.length||qe&&typeof d=="object")&&ke.mutate({trans:D,type:"put",keys:vt,values:dt,criteria:qe,changeSpec:typeof d!="function"&&d,isAdditionalChunk:0<Ge}).then(function(Wt){return fe(dt.length,Wt)})}).then(function(){return(0<xt.length||qe&&d===zs)&&ke.mutate({trans:D,type:"delete",keys:xt,criteria:qe,isAdditionalChunk:0<Ge}).then(function(Wt){return fe(xt.length,Wt)})}).then(function(){return Te.length>Ge+Xe&&Fe(Ge+Re)})})}var qe=Zr(w)&&w.limit===1/0&&(typeof d!="function"||d===zs)&&{index:w.index,range:w.range};return Fe(0).then(function(){if(0<Ee.length)throw new ue("Error modifying one or more objects",Ee,Ae,Oe);return Te.length})})})},rn.prototype.delete=function(){var d=this._ctx,g=d.range;return Zr(d)&&(d.isPrimKey||g.type===3)?this._write(function(w){var D=d.table.core.schema.primaryKey,B=g;return d.table.core.count({trans:w,query:{index:D,range:B}}).then(function(K){return d.table.core.mutate({trans:w,type:"deleteRange",range:B}).then(function(ae){var fe=ae.failures;if(ae.lastResult,ae.results,ae=ae.numFailures,ae)throw new ue("Could not delete some values",Object.keys(fe).map(function(ke){return fe[ke]}),K-ae);return K-ae})})}):this.modify(zs)},rn);function rn(){}var zs=function(d,g){return g.value=null};function ci(d,g){return d<g?-1:d===g?0:1}function Oo(d,g){return g<d?-1:d===g?0:1}function lr(d,g,w){return d=d instanceof Na?new d.Collection(d):d,d._ctx.error=new(w||TypeError)(g),d}function Ca(d){return new d.Collection(d,function(){return cr("")}).limit(0)}function ha(d,g,w,D){var B,K,ae,fe,ke,xe,je,ge=w.length;if(!w.every(function(Ae){return typeof Ae=="string"}))return lr(d,Rn);function Re(Ae){B=Ae==="next"?function(Te){return Te.toUpperCase()}:function(Te){return Te.toLowerCase()},K=Ae==="next"?function(Te){return Te.toLowerCase()}:function(Te){return Te.toUpperCase()},ae=Ae==="next"?ci:Oo;var Oe=w.map(function(Te){return{lower:K(Te),upper:B(Te)}}).sort(function(Te,Fe){return ae(Te.lower,Fe.lower)});fe=Oe.map(function(Te){return Te.upper}),ke=Oe.map(function(Te){return Te.lower}),je=(xe=Ae)==="next"?"":D}Re("next"),d=new d.Collection(d,function(){return Pr(fe[0],ke[ge-1]+D)}),d._ondirectionchange=function(Ae){Re(Ae)};var Ee=0;return d._addAlgorithm(function(Ae,Oe,Te){var Fe=Ae.key;if(typeof Fe!="string")return!1;var qe=K(Fe);if(g(qe,ke,Ee))return!0;for(var Ge=null,Xe=Ee;Xe<ge;++Xe){var ct=(function(bt,dt,vt,xt,lt,Yt){for(var Ft=Math.min(bt.length,xt.length),Wt=-1,Pt=0;Pt<Ft;++Pt){var Mr=dt[Pt];if(Mr!==xt[Pt])return lt(bt[Pt],vt[Pt])<0?bt.substr(0,Pt)+vt[Pt]+vt.substr(Pt+1):lt(bt[Pt],xt[Pt])<0?bt.substr(0,Pt)+xt[Pt]+vt.substr(Pt+1):0<=Wt?bt.substr(0,Wt)+dt[Wt]+vt.substr(Wt+1):null;lt(bt[Pt],Mr)<0&&(Wt=Pt)}return Ft<xt.length&&Yt==="next"?bt+vt.substr(bt.length):Ft<bt.length&&Yt==="prev"?bt.substr(0,vt.length):Wt<0?null:bt.substr(0,Wt)+xt[Wt]+vt.substr(Wt+1)})(Fe,qe,fe[Xe],ke[Xe],ae,xe);ct===null&&Ge===null?Ee=Xe+1:(Ge===null||0<ae(Ge,ct))&&(Ge=ct)}return Oe(Ge!==null?function(){Ae.continue(Ge+je)}:Te),!1}),d}function Pr(d,g,w,D){return{type:2,lower:d,upper:g,lowerOpen:w,upperOpen:D}}function cr(d){return{type:1,lower:d,upper:d}}var Na=(Object.defineProperty(Gn.prototype,"Collection",{get:function(){return this._ctx.table.db.Collection},enumerable:!1,configurable:!0}),Gn.prototype.between=function(d,g,w,D){w=w!==!1,D=D===!0;try{return 0<this._cmp(d,g)||this._cmp(d,g)===0&&(w||D)&&(!w||!D)?Ca(this):new this.Collection(this,function(){return Pr(d,g,!w,!D)})}catch{return lr(this,xn)}},Gn.prototype.equals=function(d){return d==null?lr(this,xn):new this.Collection(this,function(){return cr(d)})},Gn.prototype.above=function(d){return d==null?lr(this,xn):new this.Collection(this,function(){return Pr(d,void 0,!0)})},Gn.prototype.aboveOrEqual=function(d){return d==null?lr(this,xn):new this.Collection(this,function(){return Pr(d,void 0,!1)})},Gn.prototype.below=function(d){return d==null?lr(this,xn):new this.Collection(this,function(){return Pr(void 0,d,!1,!0)})},Gn.prototype.belowOrEqual=function(d){return d==null?lr(this,xn):new this.Collection(this,function(){return Pr(void 0,d)})},Gn.prototype.startsWith=function(d){return typeof d!="string"?lr(this,Rn):this.between(d,d+Rt,!0,!0)},Gn.prototype.startsWithIgnoreCase=function(d){return d===""?this.startsWith(d):ha(this,function(g,w){return g.indexOf(w[0])===0},[d],Rt)},Gn.prototype.equalsIgnoreCase=function(d){return ha(this,function(g,w){return g===w[0]},[d],"")},Gn.prototype.anyOfIgnoreCase=function(){var d=Be.apply(ve,arguments);return d.length===0?Ca(this):ha(this,function(g,w){return w.indexOf(g)!==-1},d,"")},Gn.prototype.startsWithAnyOfIgnoreCase=function(){var d=Be.apply(ve,arguments);return d.length===0?Ca(this):ha(this,function(g,w){return w.some(function(D){return g.indexOf(D)===0})},d,Rt)},Gn.prototype.anyOf=function(){var d=this,g=Be.apply(ve,arguments),w=this._cmp;try{g.sort(w)}catch{return lr(this,xn)}if(g.length===0)return Ca(this);var D=new this.Collection(this,function(){return Pr(g[0],g[g.length-1])});D._ondirectionchange=function(K){w=K==="next"?d._ascending:d._descending,g.sort(w)};var B=0;return D._addAlgorithm(function(K,ae,fe){for(var ke=K.key;0<w(ke,g[B]);)if(++B===g.length)return ae(fe),!1;return w(ke,g[B])===0||(ae(function(){K.continue(g[B])}),!1)}),D},Gn.prototype.notEqual=function(d){return this.inAnyRange([[-1/0,d],[d,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})},Gn.prototype.noneOf=function(){var d=Be.apply(ve,arguments);if(d.length===0)return new this.Collection(this);try{d.sort(this._ascending)}catch{return lr(this,xn)}var g=d.reduce(function(w,D){return w?w.concat([[w[w.length-1][1],D]]):[[-1/0,D]]},null);return g.push([d[d.length-1],this.db._maxKey]),this.inAnyRange(g,{includeLowers:!1,includeUppers:!1})},Gn.prototype.inAnyRange=function(Fe,g){var w=this,D=this._cmp,B=this._ascending,K=this._descending,ae=this._min,fe=this._max;if(Fe.length===0)return Ca(this);if(!Fe.every(function(qe){return qe[0]!==void 0&&qe[1]!==void 0&&B(qe[0],qe[1])<=0}))return lr(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",ie.InvalidArgument);var ke=!g||g.includeLowers!==!1,xe=g&&g.includeUppers===!0,je,ge=B;function Re(qe,Ge){return ge(qe[0],Ge[0])}try{(je=Fe.reduce(function(qe,Ge){for(var Xe=0,ct=qe.length;Xe<ct;++Xe){var bt=qe[Xe];if(D(Ge[0],bt[1])<0&&0<D(Ge[1],bt[0])){bt[0]=ae(bt[0],Ge[0]),bt[1]=fe(bt[1],Ge[1]);break}}return Xe===ct&&qe.push(Ge),qe},[])).sort(Re)}catch{return lr(this,xn)}var Ee=0,Ae=xe?function(qe){return 0<B(qe,je[Ee][1])}:function(qe){return 0<=B(qe,je[Ee][1])},Oe=ke?function(qe){return 0<K(qe,je[Ee][0])}:function(qe){return 0<=K(qe,je[Ee][0])},Te=Ae,Fe=new this.Collection(this,function(){return Pr(je[0][0],je[je.length-1][1],!ke,!xe)});return Fe._ondirectionchange=function(qe){ge=qe==="next"?(Te=Ae,B):(Te=Oe,K),je.sort(Re)},Fe._addAlgorithm(function(qe,Ge,Xe){for(var ct,bt=qe.key;Te(bt);)if(++Ee===je.length)return Ge(Xe),!1;return!Ae(ct=bt)&&!Oe(ct)||(w._cmp(bt,je[Ee][1])===0||w._cmp(bt,je[Ee][0])===0||Ge(function(){ge===B?qe.continue(je[Ee][0]):qe.continue(je[Ee][1])}),!1)}),Fe},Gn.prototype.startsWithAnyOf=function(){var d=Be.apply(ve,arguments);return d.every(function(g){return typeof g=="string"})?d.length===0?Ca(this):this.inAnyRange(d.map(function(g){return[g,g+Rt]})):lr(this,"startsWithAnyOf() only works with strings")},Gn);function Gn(){}function xr(d){return En(function(g){return pa(g),d(g.target.error),!1})}function pa(d){d.stopPropagation&&d.stopPropagation(),d.preventDefault&&d.preventDefault()}var Ot="storagemutated",bs="x-storagemutated-1",Jr=ts(null,Ot),Pa=(rr.prototype._lock=function(){return G(!yt.global),++this._reculock,this._reculock!==1||yt.global||(yt.lockOwnerFor=this),this},rr.prototype._unlock=function(){if(G(!yt.global),--this._reculock==0)for(yt.global||(yt.lockOwnerFor=null);0<this._blockedFuncs.length&&!this._locked();){var d=this._blockedFuncs.shift();try{St(d[1],d[0])}catch{}}return this},rr.prototype._locked=function(){return this._reculock&&yt.lockOwnerFor!==this},rr.prototype.create=function(d){var g=this;if(!this.mode)return this;var w=this.db.idbdb,D=this.db._state.dbOpenError;if(G(!this.idbtrans),!d&&!w)switch(D&&D.name){case"DatabaseClosedError":throw new ie.DatabaseClosed(D);case"MissingAPIError":throw new ie.MissingAPI(D.message,D);default:throw new ie.OpenFailed(D)}if(!this.active)throw new ie.TransactionInactive;return G(this._completion._state===null),(d=this.idbtrans=d||(this.db.core||w).transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability})).onerror=En(function(B){pa(B),g._reject(d.error)}),d.onabort=En(function(B){pa(B),g.active&&g._reject(new ie.Abort(d.error)),g.active=!1,g.on("abort").fire(B)}),d.oncomplete=En(function(){g.active=!1,g._resolve(),"mutatedParts"in d&&Jr.storagemutated.fire(d.mutatedParts)}),this},rr.prototype._promise=function(d,g,w){var D=this;if(d==="readwrite"&&this.mode!=="readwrite")return ut(new ie.ReadOnly("Transaction is readonly"));if(!this.active)return ut(new ie.TransactionInactive);if(this._locked())return new gt(function(K,ae){D._blockedFuncs.push([function(){D._promise(d,g,w).then(K,ae)},yt])});if(w)return nr(function(){var K=new gt(function(ae,fe){D._lock();var ke=g(ae,fe,D);ke&&ke.then&&ke.then(ae,fe)});return K.finally(function(){return D._unlock()}),K._lib=!0,K});var B=new gt(function(K,ae){var fe=g(K,ae,D);fe&&fe.then&&fe.then(K,ae)});return B._lib=!0,B},rr.prototype._root=function(){return this.parent?this.parent._root():this},rr.prototype.waitFor=function(d){var g,w=this._root(),D=gt.resolve(d);w._waitingFor?w._waitingFor=w._waitingFor.then(function(){return D}):(w._waitingFor=D,w._waitingQueue=[],g=w.idbtrans.objectStore(w.storeNames[0]),(function K(){for(++w._spinCount;w._waitingQueue.length;)w._waitingQueue.shift()();w._waitingFor&&(g.get(-1/0).onsuccess=K)})());var B=w._waitingFor;return new gt(function(K,ae){D.then(function(fe){return w._waitingQueue.push(En(K.bind(null,fe)))},function(fe){return w._waitingQueue.push(En(ae.bind(null,fe)))}).finally(function(){w._waitingFor===B&&(w._waitingFor=null)})})},rr.prototype.abort=function(){this.active&&(this.active=!1,this.idbtrans&&this.idbtrans.abort(),this._reject(new ie.Abort))},rr.prototype.table=function(d){var g=this._memoizedTables||(this._memoizedTables={});if(E(g,d))return g[d];var w=this.schema[d];if(!w)throw new ie.NotFound("Table "+d+" not part of transaction");return w=new this.db.Table(d,w,this),w.core=this.db.core.table(d),g[d]=w},rr);function rr(){}function Da(d,g,w,D,B,K,ae){return{name:d,keyPath:g,unique:w,multi:D,auto:B,compound:K,src:(w&&!ae?"&":"")+(D?"*":"")+(B?"++":"")+ma(g)}}function ma(d){return typeof d=="string"?d:d?"["+[].join.call(d,"+")+"]":""}function hr(d,g,w){return{name:d,primKey:g,indexes:w,mappedClass:null,idxByName:(D=function(B){return[B.name,B]},w.reduce(function(B,K,ae){return ae=D(K,ae),ae&&(B[ae[0]]=ae[1]),B},{}))};var D}var ga=function(d){try{return d.only([[]]),ga=function(){return[[]]},[[]]}catch{return ga=function(){return Rt},Rt}};function as(d){return d==null?function(){}:typeof d=="string"?(g=d).split(".").length===1?function(w){return w[g]}:function(w){return W(w,g)}:function(w){return W(w,d)};var g}function v(d){return[].slice.call(d)}var x=0;function M(d){return d==null?":id":typeof d=="string"?d:"[".concat(d.join("+"),"]")}function X(d,g,ke){function D(Te){if(Te.type===3)return null;if(Te.type===4)throw new Error("Cannot convert never type to IDBKeyRange");var Ee=Te.lower,Ae=Te.upper,Oe=Te.lowerOpen,Te=Te.upperOpen;return Ee===void 0?Ae===void 0?null:g.upperBound(Ae,!!Te):Ae===void 0?g.lowerBound(Ee,!!Oe):g.bound(Ee,Ae,!!Oe,!!Te)}function B(Re){var Ee,Ae=Re.name;return{name:Ae,schema:Re,mutate:function(Oe){var Te=Oe.trans,Fe=Oe.type,qe=Oe.keys,Ge=Oe.values,Xe=Oe.range;return new Promise(function(ct,bt){ct=En(ct);var dt=Te.objectStore(Ae),vt=dt.keyPath==null,xt=Fe==="put"||Fe==="add";if(!xt&&Fe!=="delete"&&Fe!=="deleteRange")throw new Error("Invalid operation type: "+Fe);var lt,Yt=(qe||Ge||{length:1}).length;if(qe&&Ge&&qe.length!==Ge.length)throw new Error("Given keys array must have same length as given values array.");if(Yt===0)return ct({numFailures:0,failures:{},results:[],lastResult:void 0});function Ft(ar){++Mr,pa(ar)}var Wt=[],Pt=[],Mr=0;if(Fe==="deleteRange"){if(Xe.type===4)return ct({numFailures:Mr,failures:Pt,results:[],lastResult:void 0});Xe.type===3?Wt.push(lt=dt.clear()):Wt.push(lt=dt.delete(D(Xe)))}else{var vt=xt?vt?[Ge,qe]:[Ge,null]:[qe,null],en=vt[0],pr=vt[1];if(xt)for(var mr=0;mr<Yt;++mr)Wt.push(lt=pr&&pr[mr]!==void 0?dt[Fe](en[mr],pr[mr]):dt[Fe](en[mr])),lt.onerror=Ft;else for(mr=0;mr<Yt;++mr)Wt.push(lt=dt[Fe](en[mr])),lt.onerror=Ft}function _i(ar){ar=ar.target.result,Wt.forEach(function(ks,wi){return ks.error!=null&&(Pt[wi]=ks.error)}),ct({numFailures:Mr,failures:Pt,results:Fe==="delete"?qe:Wt.map(function(ks){return ks.result}),lastResult:ar})}lt.onerror=function(ar){Ft(ar),_i(ar)},lt.onsuccess=_i})},getMany:function(Oe){var Te=Oe.trans,Fe=Oe.keys;return new Promise(function(qe,Ge){qe=En(qe);for(var Xe,ct=Te.objectStore(Ae),bt=Fe.length,dt=new Array(bt),vt=0,xt=0,lt=function(Wt){Wt=Wt.target,dt[Wt._pos]=Wt.result,++xt===vt&&qe(dt)},Yt=xr(Ge),Ft=0;Ft<bt;++Ft)Fe[Ft]!=null&&((Xe=ct.get(Fe[Ft]))._pos=Ft,Xe.onsuccess=lt,Xe.onerror=Yt,++vt);vt===0&&qe(dt)})},get:function(Oe){var Te=Oe.trans,Fe=Oe.key;return new Promise(function(qe,Ge){qe=En(qe);var Xe=Te.objectStore(Ae).get(Fe);Xe.onsuccess=function(ct){return qe(ct.target.result)},Xe.onerror=xr(Ge)})},query:(Ee=xe,function(Oe){return new Promise(function(Te,Fe){Te=En(Te);var qe,Ge,Xe,vt=Oe.trans,ct=Oe.values,bt=Oe.limit,lt=Oe.query,dt=bt===1/0?void 0:bt,xt=lt.index,lt=lt.range,vt=vt.objectStore(Ae),xt=xt.isPrimaryKey?vt:vt.index(xt.name),lt=D(lt);if(bt===0)return Te({result:[]});Ee?((dt=ct?xt.getAll(lt,dt):xt.getAllKeys(lt,dt)).onsuccess=function(Yt){return Te({result:Yt.target.result})},dt.onerror=xr(Fe)):(qe=0,Ge=!ct&&"openKeyCursor"in xt?xt.openKeyCursor(lt):xt.openCursor(lt),Xe=[],Ge.onsuccess=function(Yt){var Ft=Ge.result;return Ft?(Xe.push(ct?Ft.value:Ft.primaryKey),++qe===bt?Te({result:Xe}):void Ft.continue()):Te({result:Xe})},Ge.onerror=xr(Fe))})}),openCursor:function(Oe){var Te=Oe.trans,Fe=Oe.values,qe=Oe.query,Ge=Oe.reverse,Xe=Oe.unique;return new Promise(function(ct,bt){ct=En(ct);var xt=qe.index,dt=qe.range,vt=Te.objectStore(Ae),vt=xt.isPrimaryKey?vt:vt.index(xt.name),xt=Ge?Xe?"prevunique":"prev":Xe?"nextunique":"next",lt=!Fe&&"openKeyCursor"in vt?vt.openKeyCursor(D(dt),xt):vt.openCursor(D(dt),xt);lt.onerror=xr(bt),lt.onsuccess=En(function(Yt){var Ft,Wt,Pt,Mr,en=lt.result;en?(en.___id=++x,en.done=!1,Ft=en.continue.bind(en),Wt=(Wt=en.continuePrimaryKey)&&Wt.bind(en),Pt=en.advance.bind(en),Mr=function(){throw new Error("Cursor not stopped")},en.trans=Te,en.stop=en.continue=en.continuePrimaryKey=en.advance=function(){throw new Error("Cursor not started")},en.fail=En(bt),en.next=function(){var pr=this,mr=1;return this.start(function(){return mr--?pr.continue():pr.stop()}).then(function(){return pr})},en.start=function(pr){function mr(){if(lt.result)try{pr()}catch(ar){en.fail(ar)}else en.done=!0,en.start=function(){throw new Error("Cursor behind last entry")},en.stop()}var _i=new Promise(function(ar,ks){ar=En(ar),lt.onerror=xr(ks),en.fail=ks,en.stop=function(wi){en.stop=en.continue=en.continuePrimaryKey=en.advance=Mr,ar(wi)}});return lt.onsuccess=En(function(ar){lt.onsuccess=mr,mr()}),en.continue=Ft,en.continuePrimaryKey=Wt,en.advance=Pt,mr(),_i},ct(en)):ct(null)},bt)})},count:function(Oe){var Te=Oe.query,Fe=Oe.trans,qe=Te.index,Ge=Te.range;return new Promise(function(Xe,ct){var bt=Fe.objectStore(Ae),dt=qe.isPrimaryKey?bt:bt.index(qe.name),bt=D(Ge),dt=bt?dt.count(bt):dt.count();dt.onsuccess=En(function(vt){return Xe(vt.target.result)}),dt.onerror=xr(ct)})}}}var K,ae,fe,je=(ae=ke,fe=v((K=d).objectStoreNames),{schema:{name:K.name,tables:fe.map(function(Re){return ae.objectStore(Re)}).map(function(Re){var Ee=Re.keyPath,Te=Re.autoIncrement,Ae=p(Ee),Oe={},Te={name:Re.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:Ee==null,compound:Ae,keyPath:Ee,autoIncrement:Te,unique:!0,extractKey:as(Ee)},indexes:v(Re.indexNames).map(function(Fe){return Re.index(Fe)}).map(function(Xe){var qe=Xe.name,Ge=Xe.unique,ct=Xe.multiEntry,Xe=Xe.keyPath,ct={name:qe,compound:p(Xe),keyPath:Xe,unique:Ge,multiEntry:ct,extractKey:as(Xe)};return Oe[M(Xe)]=ct}),getIndexByKeyPath:function(Fe){return Oe[M(Fe)]}};return Oe[":id"]=Te.primaryKey,Ee!=null&&(Oe[M(Ee)]=Te.primaryKey),Te})},hasGetAll:0<fe.length&&"getAll"in ae.objectStore(fe[0])&&!(typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)}),ke=je.schema,xe=je.hasGetAll,je=ke.tables.map(B),ge={};return je.forEach(function(Re){return ge[Re.name]=Re}),{stack:"dbcore",transaction:d.transaction.bind(d),table:function(Re){if(!ge[Re])throw new Error("Table '".concat(Re,"' not found"));return ge[Re]},MIN_KEY:-1/0,MAX_KEY:ga(g),schema:ke}}function ce(d,g,w,D){var B=w.IDBKeyRange;return w.indexedDB,{dbcore:(D=X(g,B,D),d.dbcore.reduce(function(K,ae){return ae=ae.create,i(i({},K),ae(K))},D))}}function He(d,D){var w=D.db,D=ce(d._middlewares,w,d._deps,D);d.core=D.dbcore,d.tables.forEach(function(B){var K=B.name;d.core.schema.tables.some(function(ae){return ae.name===K})&&(B.core=d.core.table(K),d[K]instanceof d.Table&&(d[K].core=B.core))})}function Je(d,g,w,D){w.forEach(function(B){var K=D[B];g.forEach(function(ae){var fe=(function ke(xe,je){return k(xe,je)||(xe=m(xe))&&ke(xe,je)})(ae,B);(!fe||"value"in fe&&fe.value===void 0)&&(ae===d.Transaction.prototype||ae instanceof d.Transaction?I(ae,B,{get:function(){return this.table(B)},set:function(ke){S(this,B,{value:ke,writable:!0,configurable:!0,enumerable:!0})}}):ae[B]=new d.Table(B,K))})})}function Mt(d,g){g.forEach(function(w){for(var D in w)w[D]instanceof d.Table&&delete w[D]})}function fn(d,g){return d._cfg.version-g._cfg.version}function Vt(d,g,w,D){var B=d._dbSchema;w.objectStoreNames.contains("$meta")&&!B.$meta&&(B.$meta=hr("$meta",di("")[0],[]),d._storeNames.push("$meta"));var K=d._createTransaction("readwrite",d._storeNames,B);K.create(w),K._completion.catch(D);var ae=K._reject.bind(K),fe=yt.transless||yt;nr(function(){return yt.trans=K,yt.transless=fe,g!==0?(He(d,w),xe=g,((ke=K).storeNames.includes("$meta")?ke.table("$meta").get("version").then(function(je){return je??xe}):gt.resolve(xe)).then(function(je){return Re=je,Ee=K,Ae=w,Oe=[],je=(ge=d)._versions,Te=ge._dbSchema=ui(0,ge.idbdb,Ae),(je=je.filter(function(Fe){return Fe._cfg.version>=Re})).length!==0?(je.forEach(function(Fe){Oe.push(function(){var qe=Te,Ge=Fe._cfg.dbschema;Fs(ge,qe,Ae),Fs(ge,Ge,Ae),Te=ge._dbSchema=Ge;var Xe=Bn(qe,Ge);Xe.add.forEach(function(xt){ss(Ae,xt[0],xt[1].primKey,xt[1].indexes)}),Xe.change.forEach(function(xt){if(xt.recreate)throw new ie.Upgrade("Not yet support for changing primary key");var lt=Ae.objectStore(xt.name);xt.add.forEach(function(Yt){return Bs(lt,Yt)}),xt.change.forEach(function(Yt){lt.deleteIndex(Yt.name),Bs(lt,Yt)}),xt.del.forEach(function(Yt){return lt.deleteIndex(Yt)})});var ct=Fe._cfg.contentUpgrade;if(ct&&Fe._cfg.version>Re){He(ge,Ae),Ee._memoizedTables={};var bt=L(Ge);Xe.del.forEach(function(xt){bt[xt]=qe[xt]}),Mt(ge,[ge.Transaction.prototype]),Je(ge,[ge.Transaction.prototype],f(bt),bt),Ee.schema=bt;var dt,vt=T(ct);return vt&&gn(),Xe=gt.follow(function(){var xt;(dt=ct(Ee))&&vt&&(xt=nn.bind(null,null),dt.then(xt,xt))}),dt&&typeof dt.then=="function"?gt.resolve(dt):Xe.then(function(){return dt})}}),Oe.push(function(qe){var Ge,Xe,ct=Fe._cfg.dbschema;Ge=ct,Xe=qe,[].slice.call(Xe.db.objectStoreNames).forEach(function(bt){return Ge[bt]==null&&Xe.db.deleteObjectStore(bt)}),Mt(ge,[ge.Transaction.prototype]),Je(ge,[ge.Transaction.prototype],ge._storeNames,ge._dbSchema),Ee.schema=ge._dbSchema}),Oe.push(function(qe){ge.idbdb.objectStoreNames.contains("$meta")&&(Math.ceil(ge.idbdb.version/10)===Fe._cfg.version?(ge.idbdb.deleteObjectStore("$meta"),delete ge._dbSchema.$meta,ge._storeNames=ge._storeNames.filter(function(Ge){return Ge!=="$meta"})):qe.objectStore("$meta").put(Fe._cfg.version,"version"))})}),(function Fe(){return Oe.length?gt.resolve(Oe.shift()(Ee.idbtrans)).then(Fe):gt.resolve()})().then(function(){Wi(Te,Ae)})):gt.resolve();var ge,Re,Ee,Ae,Oe,Te}).catch(ae)):(f(B).forEach(function(je){ss(w,je,B[je].primKey,B[je].indexes)}),He(d,w),void gt.follow(function(){return d.on.populate.fire(K)}).catch(ae));var ke,xe})}function Yn(d,g){Wi(d._dbSchema,g),g.db.version%10!=0||g.objectStoreNames.contains("$meta")||g.db.createObjectStore("$meta").add(Math.ceil(g.db.version/10-1),"version");var w=ui(0,d.idbdb,g);Fs(d,d._dbSchema,g);for(var D=0,B=Bn(w,d._dbSchema).change;D<B.length;D++){var K=(function(ae){if(ae.change.length||ae.recreate)return console.warn("Unable to patch indexes of table ".concat(ae.name," because it has changes on the type of index or primary key.")),{value:void 0};var fe=g.objectStore(ae.name);ae.add.forEach(function(ke){Ye&&console.debug("Dexie upgrade patch: Creating missing index ".concat(ae.name,".").concat(ke.src)),Bs(fe,ke)})})(B[D]);if(typeof K=="object")return K.value}}function Bn(d,g){var w,D={del:[],add:[],change:[]};for(w in d)g[w]||D.del.push(w);for(w in g){var B=d[w],K=g[w];if(B){var ae={name:w,def:K,recreate:!1,del:[],add:[],change:[]};if(""+(B.primKey.keyPath||"")!=""+(K.primKey.keyPath||"")||B.primKey.auto!==K.primKey.auto)ae.recreate=!0,D.change.push(ae);else{var fe=B.idxByName,ke=K.idxByName,xe=void 0;for(xe in fe)ke[xe]||ae.del.push(xe);for(xe in ke){var je=fe[xe],ge=ke[xe];je?je.src!==ge.src&&ae.change.push(ge):ae.add.push(ge)}(0<ae.del.length||0<ae.add.length||0<ae.change.length)&&D.change.push(ae)}}else D.add.push([w,K])}return D}function ss(d,g,w,D){var B=d.db.createObjectStore(g,w.keyPath?{keyPath:w.keyPath,autoIncrement:w.auto}:{autoIncrement:w.auto});return D.forEach(function(K){return Bs(B,K)}),B}function Wi(d,g){f(d).forEach(function(w){g.db.objectStoreNames.contains(w)||(Ye&&console.debug("Dexie: Creating missing table",w),ss(g,w,d[w].primKey,d[w].indexes))})}function Bs(d,g){d.createIndex(g.name,g.keyPath,{unique:g.unique,multiEntry:g.multi})}function ui(d,g,w){var D={};return P(g.objectStoreNames,0).forEach(function(B){for(var K=w.objectStore(B),ae=Da(ma(xe=K.keyPath),xe||"",!0,!1,!!K.autoIncrement,xe&&typeof xe!="string",!0),fe=[],ke=0;ke<K.indexNames.length;++ke){var je=K.index(K.indexNames[ke]),xe=je.keyPath,je=Da(je.name,xe,!!je.unique,!!je.multiEntry,!1,xe&&typeof xe!="string",!1);fe.push(je)}D[B]=hr(B,ae,fe)}),D}function Fs(d,g,w){for(var D=w.db.objectStoreNames,B=0;B<D.length;++B){var K=D[B],ae=w.objectStore(K);d._hasGetAll="getAll"in ae;for(var fe=0;fe<ae.indexNames.length;++fe){var ke=ae.indexNames[fe],xe=ae.index(ke).keyPath,je=typeof xe=="string"?xe:"["+P(xe).join("+")+"]";!g[K]||(xe=g[K].idxByName[je])&&(xe.name=ke,delete g[K].idxByName[je],g[K].idxByName[ke]=xe)}}typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&u.WorkerGlobalScope&&u instanceof u.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(d._hasGetAll=!1)}function di(d){return d.split(",").map(function(g,w){var D=(g=g.trim()).replace(/([&*]|\+\+)/g,""),B=/^\[/.test(D)?D.match(/^\[(.*)\]$/)[1].split("+"):D;return Da(D,B||null,/\&/.test(g),/\*/.test(g),/\+\+/.test(g),p(B),w===0)})}var Sl=(fi.prototype._parseStoresSpec=function(d,g){f(d).forEach(function(w){if(d[w]!==null){var D=di(d[w]),B=D.shift();if(B.unique=!0,B.multi)throw new ie.Schema("Primary key cannot be multi-valued");D.forEach(function(K){if(K.auto)throw new ie.Schema("Only primary key can be marked as autoIncrement (++)");if(!K.keyPath)throw new ie.Schema("Index must have a name and cannot be an empty string")}),g[w]=hr(w,B,D)}})},fi.prototype.stores=function(w){var g=this.db;this._cfg.storesSource=this._cfg.storesSource?b(this._cfg.storesSource,w):w;var w=g._versions,D={},B={};return w.forEach(function(K){b(D,K._cfg.storesSource),B=K._cfg.dbschema={},K._parseStoresSpec(D,B)}),g._dbSchema=B,Mt(g,[g._allTables,g,g.Transaction.prototype]),Je(g,[g._allTables,g,g.Transaction.prototype,this._cfg.tables],f(B),B),g._storeNames=f(B),this},fi.prototype.upgrade=function(d){return this._cfg.contentUpgrade=Ve(this._cfg.contentUpgrade||ft,d),this},fi);function fi(){}function eo(d,g){var w=d._dbNamesDB;return w||(w=d._dbNamesDB=new Wr(Zn,{addons:[],indexedDB:d,IDBKeyRange:g})).version(1).stores({dbnames:"name"}),w.table("dbnames")}function to(d){return d&&typeof d.databases=="function"}function no(d){return nr(function(){return yt.letThrough=!0,d()})}function hi(d){return!("from"in d)}var Nr=function(d,g){if(!this){var w=new Nr;return d&&"d"in d&&b(w,d),w}b(this,arguments.length?{d:1,from:d,to:1<arguments.length?g:d}:{d:0})};function xs(d,g,w){var D=dn(g,w);if(!isNaN(D)){if(0<D)throw RangeError();if(hi(d))return b(d,{from:g,to:w,d:1});var B=d.l,D=d.r;if(dn(w,d.from)<0)return B?xs(B,g,w):d.l={from:g,to:w,d:1,l:null,r:null},Io(d);if(0<dn(g,d.to))return D?xs(D,g,w):d.r={from:g,to:w,d:1,l:null,r:null},Io(d);dn(g,d.from)<0&&(d.from=g,d.l=null,d.d=D?D.d+1:1),0<dn(w,d.to)&&(d.to=w,d.r=null,d.d=d.l?d.l.d+1:1),w=!d.r,B&&!d.l&&Hs(d,B),D&&w&&Hs(d,D)}}function Hs(d,g){hi(g)||(function w(D,ke){var K=ke.from,ae=ke.to,fe=ke.l,ke=ke.r;xs(D,K,ae),fe&&w(D,fe),ke&&w(D,ke)})(d,g)}function jo(d,g){var w=_s(g),D=w.next();if(D.done)return!1;for(var B=D.value,K=_s(d),ae=K.next(B.from),fe=ae.value;!D.done&&!ae.done;){if(dn(fe.from,B.to)<=0&&0<=dn(fe.to,B.from))return!0;dn(B.from,fe.from)<0?B=(D=w.next(fe.from)).value:fe=(ae=K.next(B.from)).value}return!1}function _s(d){var g=hi(d)?null:{s:0,n:d};return{next:function(w){for(var D=0<arguments.length;g;)switch(g.s){case 0:if(g.s=1,D)for(;g.n.l&&dn(w,g.n.from)<0;)g={up:g,n:g.n.l,s:1};else for(;g.n.l;)g={up:g,n:g.n.l,s:1};case 1:if(g.s=2,!D||dn(w,g.n.to)<=0)return{value:g.n,done:!1};case 2:if(g.n.r){g.s=3,g={up:g,n:g.n.r,s:0};continue}case 3:g=g.up}return{done:!0}}}}function Io(d){var g,w,D=(((g=d.r)===null||g===void 0?void 0:g.d)||0)-(((w=d.l)===null||w===void 0?void 0:w.d)||0),B=1<D?"r":D<-1?"l":"";B&&(g=B=="r"?"l":"r",w=i({},d),D=d[B],d.from=D.from,d.to=D.to,d[B]=D[B],w[B]=D[g],(d[g]=w).d=Ro(w)),d.d=Ro(d)}function Ro(w){var g=w.r,w=w.l;return(g?w?Math.max(g.d,w.d):g.d:w?w.d:0)+1}function pi(d,g){return f(g).forEach(function(w){d[w]?Hs(d[w],g[w]):d[w]=(function D(B){var K,ae,fe={};for(K in B)E(B,K)&&(ae=B[K],fe[K]=!ae||typeof ae!="object"||le.has(ae.constructor)?ae:D(ae));return fe})(g[w])}),d}function mi(d,g){return d.all||g.all||Object.keys(d).some(function(w){return g[w]&&jo(g[w],d[w])})}N(Nr.prototype,((ea={add:function(d){return Hs(this,d),this},addKey:function(d){return xs(this,d,d),this},addKeys:function(d){var g=this;return d.forEach(function(w){return xs(g,w,w)}),this},hasKey:function(d){var g=_s(this).next(d).value;return g&&dn(g.from,d)<=0&&0<=dn(g.to,d)}})[J]=function(){return _s(this)},ea));var qa={},ro={},ao=!1;function gi(d){pi(ro,d),ao||(ao=!0,setTimeout(function(){ao=!1,so(ro,!(ro={}))},0))}function so(d,g){g===void 0&&(g=!1);var w=new Set;if(d.all)for(var D=0,B=Object.values(qa);D<B.length;D++)Mo(ae=B[D],d,w,g);else for(var K in d){var ae,fe=/^idb\:\/\/(.*)\/(.*)\//.exec(K);fe&&(K=fe[1],fe=fe[2],(ae=qa["idb://".concat(K,"/").concat(fe)])&&Mo(ae,d,w,g))}w.forEach(function(ke){return ke()})}function Mo(d,g,w,D){for(var B=[],K=0,ae=Object.entries(d.queries.query);K<ae.length;K++){for(var fe=ae[K],ke=fe[0],xe=[],je=0,ge=fe[1];je<ge.length;je++){var Re=ge[je];mi(g,Re.obsSet)?Re.subscribers.forEach(function(Te){return w.add(Te)}):D&&xe.push(Re)}D&&B.push([ke,xe])}if(D)for(var Ee=0,Ae=B;Ee<Ae.length;Ee++){var Oe=Ae[Ee],ke=Oe[0],xe=Oe[1];d.queries.query[ke]=xe}}function El(d){var g=d._state,w=d._deps.indexedDB;if(g.isBeingOpened||d.idbdb)return g.dbReadyPromise.then(function(){return g.dbOpenError?ut(g.dbOpenError):d});g.isBeingOpened=!0,g.dbOpenError=null,g.openComplete=!1;var D=g.openCanceller,B=Math.round(10*d.verno),K=!1;function ae(){if(g.openCanceller!==D)throw new ie.DatabaseClosed("db.open() was cancelled")}function fe(){return new gt(function(Re,Ee){if(ae(),!w)throw new ie.MissingAPI;var Ae=d.name,Oe=g.autoSchema||!B?w.open(Ae):w.open(Ae,B);if(!Oe)throw new ie.MissingAPI;Oe.onerror=xr(Ee),Oe.onblocked=En(d._fireOnBlocked),Oe.onupgradeneeded=En(function(Te){var Fe;je=Oe.transaction,g.autoSchema&&!d._options.allowEmptyDB?(Oe.onerror=pa,je.abort(),Oe.result.close(),(Fe=w.deleteDatabase(Ae)).onsuccess=Fe.onerror=En(function(){Ee(new ie.NoSuchDatabase("Database ".concat(Ae," doesnt exist")))})):(je.onerror=xr(Ee),Te=Te.oldVersion>Math.pow(2,62)?0:Te.oldVersion,ge=Te<1,d.idbdb=Oe.result,K&&Yn(d,je),Vt(d,Te/10,je,Ee))},Ee),Oe.onsuccess=En(function(){je=null;var Te,Fe,qe,Ge,Xe,ct=d.idbdb=Oe.result,bt=P(ct.objectStoreNames);if(0<bt.length)try{var dt=ct.transaction((Ge=bt).length===1?Ge[0]:Ge,"readonly");if(g.autoSchema)Fe=ct,qe=dt,(Te=d).verno=Fe.version/10,qe=Te._dbSchema=ui(0,Fe,qe),Te._storeNames=P(Fe.objectStoreNames,0),Je(Te,[Te._allTables],f(qe),qe);else if(Fs(d,d._dbSchema,dt),((Xe=Bn(ui(0,(Xe=d).idbdb,dt),Xe._dbSchema)).add.length||Xe.change.some(function(vt){return vt.add.length||vt.change.length}))&&!K)return console.warn("Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Dexie will add missing parts and increment native version number to workaround this."),ct.close(),B=ct.version+1,K=!0,Re(fe());He(d,dt)}catch{}$t.push(d),ct.onversionchange=En(function(vt){g.vcFired=!0,d.on("versionchange").fire(vt)}),ct.onclose=En(function(vt){d.on("close").fire(vt)}),ge&&(Xe=d._deps,dt=Ae,ct=Xe.indexedDB,Xe=Xe.IDBKeyRange,to(ct)||dt===Zn||eo(ct,Xe).put({name:dt}).catch(ft)),Re()},Ee)}).catch(function(Re){switch(Re==null?void 0:Re.name){case"UnknownError":if(0<g.PR1398_maxLoop)return g.PR1398_maxLoop--,console.warn("Dexie: Workaround for Chrome UnknownError on open()"),fe();break;case"VersionError":if(0<B)return B=0,fe()}return gt.reject(Re)})}var ke,xe=g.dbReadyResolve,je=null,ge=!1;return gt.race([D,(typeof navigator>"u"?gt.resolve():!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent)&&indexedDB.databases?new Promise(function(Re){function Ee(){return indexedDB.databases().finally(Re)}ke=setInterval(Ee,100),Ee()}).finally(function(){return clearInterval(ke)}):Promise.resolve()).then(fe)]).then(function(){return ae(),g.onReadyBeingFired=[],gt.resolve(no(function(){return d.on.ready.fire(d.vip)})).then(function Re(){if(0<g.onReadyBeingFired.length){var Ee=g.onReadyBeingFired.reduce(Ve,ft);return g.onReadyBeingFired=[],gt.resolve(no(function(){return Ee(d.vip)})).then(Re)}})}).finally(function(){g.openCanceller===D&&(g.onReadyBeingFired=null,g.isBeingOpened=!1)}).catch(function(Re){g.dbOpenError=Re;try{je&&je.abort()}catch{}return D===g.openCanceller&&d._close(),ut(Re)}).finally(function(){g.openComplete=!0,xe()}).then(function(){var Re;return ge&&(Re={},d.tables.forEach(function(Ee){Ee.schema.indexes.forEach(function(Ae){Ae.name&&(Re["idb://".concat(d.name,"/").concat(Ee.name,"/").concat(Ae.name)]=new Nr(-1/0,[[[]]]))}),Re["idb://".concat(d.name,"/").concat(Ee.name,"/")]=Re["idb://".concat(d.name,"/").concat(Ee.name,"/:dels")]=new Nr(-1/0,[[[]]])}),Jr(Ot).fire(Re),so(Re,!0)),d})}function yi(d){function g(K){return d.next(K)}var w=B(g),D=B(function(K){return d.throw(K)});function B(K){return function(ke){var fe=K(ke),ke=fe.value;return fe.done?ke:ke&&typeof ke.then=="function"?ke.then(w,D):p(ke)?Promise.all(ke).then(w,D):w(ke)}}return B(g)()}function vi(d,g,w){for(var D=p(d)?d.slice():[d],B=0;B<w;++B)D.push(g);return D}var io={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:function(d){return i(i({},d),{table:function(g){var w=d.table(g),D=w.schema,B={},K=[];function ae(ge,Re,Ee){var Ae=M(ge),Oe=B[Ae]=B[Ae]||[],Te=ge==null?0:typeof ge=="string"?1:ge.length,Fe=0<Re,Fe=i(i({},Ee),{name:Fe?"".concat(Ae,"(virtual-from:").concat(Ee.name,")"):Ee.name,lowLevelIndex:Ee,isVirtual:Fe,keyTail:Re,keyLength:Te,extractKey:as(ge),unique:!Fe&&Ee.unique});return Oe.push(Fe),Fe.isPrimaryKey||K.push(Fe),1<Te&&ae(Te===2?ge[0]:ge.slice(0,Te-1),Re+1,Ee),Oe.sort(function(qe,Ge){return qe.keyTail-Ge.keyTail}),Fe}g=ae(D.primaryKey.keyPath,0,D.primaryKey),B[":id"]=[g];for(var fe=0,ke=D.indexes;fe<ke.length;fe++){var xe=ke[fe];ae(xe.keyPath,0,xe)}function je(ge){var Re,Ee=ge.query.index;return Ee.isVirtual?i(i({},ge),{query:{index:Ee.lowLevelIndex,range:(Re=ge.query.range,Ee=Ee.keyTail,{type:Re.type===1?2:Re.type,lower:vi(Re.lower,Re.lowerOpen?d.MAX_KEY:d.MIN_KEY,Ee),lowerOpen:!0,upper:vi(Re.upper,Re.upperOpen?d.MIN_KEY:d.MAX_KEY,Ee),upperOpen:!0})}}):ge}return i(i({},w),{schema:i(i({},D),{primaryKey:g,indexes:K,getIndexByKeyPath:function(ge){return(ge=B[M(ge)])&&ge[0]}}),count:function(ge){return w.count(je(ge))},query:function(ge){return w.query(je(ge))},openCursor:function(ge){var Re=ge.query.index,Ee=Re.keyTail,Ae=Re.isVirtual,Oe=Re.keyLength;return Ae?w.openCursor(je(ge)).then(function(Fe){return Fe&&Te(Fe)}):w.openCursor(ge);function Te(Fe){return Object.create(Fe,{continue:{value:function(qe){qe!=null?Fe.continue(vi(qe,ge.reverse?d.MAX_KEY:d.MIN_KEY,Ee)):ge.unique?Fe.continue(Fe.key.slice(0,Oe).concat(ge.reverse?d.MIN_KEY:d.MAX_KEY,Ee)):Fe.continue()}},continuePrimaryKey:{value:function(qe,Ge){Fe.continuePrimaryKey(vi(qe,d.MAX_KEY,Ee),Ge)}},primaryKey:{get:function(){return Fe.primaryKey}},key:{get:function(){var qe=Fe.key;return Oe===1?qe[0]:qe.slice(0,Oe)}},value:{get:function(){return Fe.value}}})}}})}})}};function is(d,g,w,D){return w=w||{},D=D||"",f(d).forEach(function(B){var K,ae,fe;E(g,B)?(K=d[B],ae=g[B],typeof K=="object"&&typeof ae=="object"&&K&&ae?(fe=he(K))!==he(ae)?w[D+B]=g[B]:fe==="Object"?is(K,ae,w,D+B+"."):K!==ae&&(w[D+B]=g[B]):K!==ae&&(w[D+B]=g[B])):w[D+B]=void 0}),f(g).forEach(function(B){E(d,B)||(w[D+B]=g[B])}),w}function ws(d,g){return g.type==="delete"?g.keys:g.keys||g.values.map(d.extractKey)}var oo={stack:"dbcore",name:"HooksMiddleware",level:2,create:function(d){return i(i({},d),{table:function(g){var w=d.table(g),D=w.schema.primaryKey;return i(i({},w),{mutate:function(B){var K=yt.trans,ae=K.table(g).hook,fe=ae.deleting,ke=ae.creating,xe=ae.updating;switch(B.type){case"add":if(ke.fire===ft)break;return K._promise("readwrite",function(){return je(B)},!0);case"put":if(ke.fire===ft&&xe.fire===ft)break;return K._promise("readwrite",function(){return je(B)},!0);case"delete":if(fe.fire===ft)break;return K._promise("readwrite",function(){return je(B)},!0);case"deleteRange":if(fe.fire===ft)break;return K._promise("readwrite",function(){return(function ge(Re,Ee,Ae){return w.query({trans:Re,values:!1,query:{index:D,range:Ee},limit:Ae}).then(function(Oe){var Te=Oe.result;return je({type:"delete",keys:Te,trans:Re}).then(function(Fe){return 0<Fe.numFailures?Promise.reject(Fe.failures[0]):Te.length<Ae?{failures:[],numFailures:0,lastResult:void 0}:ge(Re,i(i({},Ee),{lower:Te[Te.length-1],lowerOpen:!0}),Ae)})})})(B.trans,B.range,1e4)},!0)}return w.mutate(B);function je(ge){var Re,Ee,Ae,Oe=yt.trans,Te=ge.keys||ws(D,ge);if(!Te)throw new Error("Keys missing");return(ge=ge.type==="add"||ge.type==="put"?i(i({},ge),{keys:Te}):i({},ge)).type!=="delete"&&(ge.values=c([],ge.values)),ge.keys&&(ge.keys=c([],ge.keys)),Re=w,Ae=Te,((Ee=ge).type==="add"?Promise.resolve([]):Re.getMany({trans:Ee.trans,keys:Ae,cache:"immutable"})).then(function(Fe){var qe=Te.map(function(Ge,Xe){var ct,bt,dt,vt=Fe[Xe],xt={onerror:null,onsuccess:null};return ge.type==="delete"?fe.fire.call(xt,Ge,vt,Oe):ge.type==="add"||vt===void 0?(ct=ke.fire.call(xt,Ge,ge.values[Xe],Oe),Ge==null&&ct!=null&&(ge.keys[Xe]=Ge=ct,D.outbound||H(ge.values[Xe],D.keyPath,Ge))):(ct=is(vt,ge.values[Xe]),(bt=xe.fire.call(xt,ct,Ge,vt,Oe))&&(dt=ge.values[Xe],Object.keys(bt).forEach(function(lt){E(dt,lt)?dt[lt]=bt[lt]:H(dt,lt,bt[lt])}))),xt});return w.mutate(ge).then(function(Ge){for(var Xe=Ge.failures,ct=Ge.results,bt=Ge.numFailures,Ge=Ge.lastResult,dt=0;dt<Te.length;++dt){var vt=(ct||Te)[dt],xt=qe[dt];vt==null?xt.onerror&&xt.onerror(Xe[dt]):xt.onsuccess&&xt.onsuccess(ge.type==="put"&&Fe[dt]?ge.values[dt]:vt)}return{failures:Xe,results:ct,numFailures:bt,lastResult:Ge}}).catch(function(Ge){return qe.forEach(function(Xe){return Xe.onerror&&Xe.onerror(Ge)}),Promise.reject(Ge)})})}}})}})}};function bi(d,g,w){try{if(!g||g.keys.length<d.length)return null;for(var D=[],B=0,K=0;B<g.keys.length&&K<d.length;++B)dn(g.keys[B],d[K])===0&&(D.push(w?te(g.values[B]):g.values[B]),++K);return D.length===d.length?D:null}catch{return null}}var Me={stack:"dbcore",level:-1,create:function(d){return{table:function(g){var w=d.table(g);return i(i({},w),{getMany:function(D){if(!D.cache)return w.getMany(D);var B=bi(D.keys,D.trans._cache,D.cache==="clone");return B?gt.resolve(B):w.getMany(D).then(function(K){return D.trans._cache={keys:D.keys,values:D.cache==="clone"?te(K):K},K})},mutate:function(D){return D.type!=="add"&&(D.trans._cache=null),w.mutate(D)}})}}}};function it(d,g){return d.trans.mode==="readonly"&&!!d.subscr&&!d.trans.explicit&&d.trans.db._options.cache!=="disabled"&&!g.schema.primaryKey.outbound}function Dt(d,g){switch(d){case"query":return g.values&&!g.unique;case"get":case"getMany":case"count":case"openCursor":return!1}}var Bt={stack:"dbcore",level:0,name:"Observability",create:function(d){var g=d.schema.name,w=new Nr(d.MIN_KEY,d.MAX_KEY);return i(i({},d),{transaction:function(D,B,K){if(yt.subscr&&B!=="readonly")throw new ie.ReadOnly("Readwrite transaction in liveQuery context. Querier source: ".concat(yt.querier));return d.transaction(D,B,K)},table:function(D){var B=d.table(D),K=B.schema,ae=K.primaryKey,ge=K.indexes,fe=ae.extractKey,ke=ae.outbound,xe=ae.autoIncrement&&ge.filter(function(Ee){return Ee.compound&&Ee.keyPath.includes(ae.keyPath)}),je=i(i({},B),{mutate:function(Ee){function Ae(lt){return lt="idb://".concat(g,"/").concat(D,"/").concat(lt),Ge[lt]||(Ge[lt]=new Nr)}var Oe,Te,Fe,qe=Ee.trans,Ge=Ee.mutatedParts||(Ee.mutatedParts={}),Xe=Ae(""),ct=Ae(":dels"),bt=Ee.type,xt=Ee.type==="deleteRange"?[Ee.range]:Ee.type==="delete"?[Ee.keys]:Ee.values.length<50?[ws(ae,Ee).filter(function(lt){return lt}),Ee.values]:[],dt=xt[0],vt=xt[1],xt=Ee.trans._cache;return p(dt)?(Xe.addKeys(dt),(xt=bt==="delete"||dt.length===vt.length?bi(dt,xt):null)||ct.addKeys(dt),(xt||vt)&&(Oe=Ae,Te=xt,Fe=vt,K.indexes.forEach(function(lt){var Yt=Oe(lt.name||"");function Ft(Pt){return Pt!=null?lt.extractKey(Pt):null}function Wt(Pt){return lt.multiEntry&&p(Pt)?Pt.forEach(function(Mr){return Yt.addKey(Mr)}):Yt.addKey(Pt)}(Te||Fe).forEach(function(Pt,pr){var en=Te&&Ft(Te[pr]),pr=Fe&&Ft(Fe[pr]);dn(en,pr)!==0&&(en!=null&&Wt(en),pr!=null&&Wt(pr))})}))):dt?(vt={from:dt.lower,to:dt.upper},ct.add(vt),Xe.add(vt)):(Xe.add(w),ct.add(w),K.indexes.forEach(function(lt){return Ae(lt.name).add(w)})),B.mutate(Ee).then(function(lt){return!dt||Ee.type!=="add"&&Ee.type!=="put"||(Xe.addKeys(lt.results),xe&&xe.forEach(function(Yt){var Ft=Ee.values.map(function(Pt){return Yt.extractKey(Pt)}),Wt=Yt.keyPath.findIndex(function(Pt){return Pt===ae.keyPath});lt.results.forEach(function(Pt){return Ft[Wt]=Pt}),Ae(Yt.name).addKeys(Ft)})),qe.mutatedParts=pi(qe.mutatedParts||{},Ge),lt})}}),ge=function(Ae){var Oe=Ae.query,Ae=Oe.index,Oe=Oe.range;return[Ae,new Nr((Ae=Oe.lower)!==null&&Ae!==void 0?Ae:d.MIN_KEY,(Oe=Oe.upper)!==null&&Oe!==void 0?Oe:d.MAX_KEY)]},Re={get:function(Ee){return[ae,new Nr(Ee.key)]},getMany:function(Ee){return[ae,new Nr().addKeys(Ee.keys)]},count:ge,query:ge,openCursor:ge};return f(Re).forEach(function(Ee){je[Ee]=function(Ae){var Oe=yt.subscr,Te=!!Oe,Fe=it(yt,B)&&Dt(Ee,Ae)?Ae.obsSet={}:Oe;if(Te){var qe=function(vt){return vt="idb://".concat(g,"/").concat(D,"/").concat(vt),Fe[vt]||(Fe[vt]=new Nr)},Ge=qe(""),Xe=qe(":dels"),Oe=Re[Ee](Ae),Te=Oe[0],Oe=Oe[1];if((Ee==="query"&&Te.isPrimaryKey&&!Ae.values?Xe:qe(Te.name||"")).add(Oe),!Te.isPrimaryKey){if(Ee!=="count"){var ct=Ee==="query"&&ke&&Ae.values&&B.query(i(i({},Ae),{values:!1}));return B[Ee].apply(this,arguments).then(function(vt){if(Ee==="query"){if(ke&&Ae.values)return ct.then(function(Ft){return Ft=Ft.result,Ge.addKeys(Ft),vt});var xt=Ae.values?vt.result.map(fe):vt.result;(Ae.values?Ge:Xe).addKeys(xt)}else if(Ee==="openCursor"){var lt=vt,Yt=Ae.values;return lt&&Object.create(lt,{key:{get:function(){return Xe.addKey(lt.primaryKey),lt.key}},primaryKey:{get:function(){var Ft=lt.primaryKey;return Xe.addKey(Ft),Ft}},value:{get:function(){return Yt&&Ge.addKey(lt.primaryKey),lt.value}}})}return vt})}Xe.add(w)}}return B[Ee].apply(this,arguments)}}),je}})}};function Xt(d,g,w){if(w.numFailures===0)return g;if(g.type==="deleteRange")return null;var D=g.keys?g.keys.length:"values"in g&&g.values?g.values.length:1;return w.numFailures===D?null:(g=i({},g),p(g.keys)&&(g.keys=g.keys.filter(function(B,K){return!(K in w.failures)})),"values"in g&&p(g.values)&&(g.values=g.values.filter(function(B,K){return!(K in w.failures)})),g)}function Tn(d,g){return w=d,((D=g).lower===void 0||(D.lowerOpen?0<dn(w,D.lower):0<=dn(w,D.lower)))&&(d=d,(g=g).upper===void 0||(g.upperOpen?dn(d,g.upper)<0:dn(d,g.upper)<=0));var w,D}function Xr(d,g,Re,D,B,K){if(!Re||Re.length===0)return d;var ae=g.query.index,fe=ae.multiEntry,ke=g.query.range,xe=D.schema.primaryKey.extractKey,je=ae.extractKey,ge=(ae.lowLevelIndex||ae).extractKey,Re=Re.reduce(function(Ee,Ae){var Oe=Ee,Te=[];if(Ae.type==="add"||Ae.type==="put")for(var Fe=new Nr,qe=Ae.values.length-1;0<=qe;--qe){var Ge,Xe=Ae.values[qe],ct=xe(Xe);Fe.hasKey(ct)||(Ge=je(Xe),(fe&&p(Ge)?Ge.some(function(xt){return Tn(xt,ke)}):Tn(Ge,ke))&&(Fe.addKey(ct),Te.push(Xe)))}switch(Ae.type){case"add":Oe=Ee.concat(g.values?Te:Te.map(function(lt){return xe(lt)}));break;case"put":var bt=new Nr().addKeys(Ae.values.map(function(lt){return xe(lt)})),Oe=Ee.filter(function(lt){return!bt.hasKey(g.values?xe(lt):lt)}).concat(g.values?Te:Te.map(function(lt){return xe(lt)}));break;case"delete":var dt=new Nr().addKeys(Ae.keys);Oe=Ee.filter(function(lt){return!dt.hasKey(g.values?xe(lt):lt)});break;case"deleteRange":var vt=Ae.range;Oe=Ee.filter(function(lt){return!Tn(xe(lt),vt)})}return Oe},d);return Re===d?d:(Re.sort(function(Ee,Ae){return dn(ge(Ee),ge(Ae))||dn(xe(Ee),xe(Ae))}),g.limit&&g.limit<1/0&&(Re.length>g.limit?Re.length=g.limit:d.length===g.limit&&Re.length<g.limit&&(B.dirty=!0)),K?Object.freeze(Re):Re)}function Ir(d,g){return dn(d.lower,g.lower)===0&&dn(d.upper,g.upper)===0&&!!d.lowerOpen==!!g.lowerOpen&&!!d.upperOpen==!!g.upperOpen}function Rr(d,g){return(function(w,D,B,K){if(w===void 0)return D!==void 0?-1:0;if(D===void 0)return 1;if((D=dn(w,D))===0){if(B&&K)return 0;if(B)return 1;if(K)return-1}return D})(d.lower,g.lower,d.lowerOpen,g.lowerOpen)<=0&&0<=(function(w,D,B,K){if(w===void 0)return D!==void 0?1:0;if(D===void 0)return-1;if((D=dn(w,D))===0){if(B&&K)return 0;if(B)return-1;if(K)return 1}return D})(d.upper,g.upper,d.upperOpen,g.upperOpen)}function Dr(d,g,w,D){d.subscribers.add(w),D.addEventListener("abort",function(){var B,K;d.subscribers.delete(w),d.subscribers.size===0&&(B=d,K=g,setTimeout(function(){B.subscribers.size===0&&De(K,B)},3e3))})}var os={stack:"dbcore",level:0,name:"Cache",create:function(d){var g=d.schema.name;return i(i({},d),{transaction:function(w,D,B){var K,ae,fe=d.transaction(w,D,B);return D==="readwrite"&&(ae=(K=new AbortController).signal,B=function(ke){return function(){if(K.abort(),D==="readwrite"){for(var xe=new Set,je=0,ge=w;je<ge.length;je++){var Re=ge[je],Ee=qa["idb://".concat(g,"/").concat(Re)];if(Ee){var Ae=d.table(Re),Oe=Ee.optimisticOps.filter(function(Yt){return Yt.trans===fe});if(fe._explicit&&ke&&fe.mutatedParts)for(var Te=0,Fe=Object.values(Ee.queries.query);Te<Fe.length;Te++)for(var qe=0,Ge=(bt=Fe[Te]).slice();qe<Ge.length;qe++)mi((dt=Ge[qe]).obsSet,fe.mutatedParts)&&(De(bt,dt),dt.subscribers.forEach(function(Yt){return xe.add(Yt)}));else if(0<Oe.length){Ee.optimisticOps=Ee.optimisticOps.filter(function(Yt){return Yt.trans!==fe});for(var Xe=0,ct=Object.values(Ee.queries.query);Xe<ct.length;Xe++)for(var bt,dt,vt,xt=0,lt=(bt=ct[Xe]).slice();xt<lt.length;xt++)(dt=lt[xt]).res!=null&&fe.mutatedParts&&(ke&&!dt.dirty?(vt=Object.isFrozen(dt.res),vt=Xr(dt.res,dt.req,Oe,Ae,dt,vt),dt.dirty?(De(bt,dt),dt.subscribers.forEach(function(Yt){return xe.add(Yt)})):vt!==dt.res&&(dt.res=vt,dt.promise=gt.resolve({result:vt}))):(dt.dirty&&De(bt,dt),dt.subscribers.forEach(function(Yt){return xe.add(Yt)})))}}}xe.forEach(function(Yt){return Yt()})}}},fe.addEventListener("abort",B(!1),{signal:ae}),fe.addEventListener("error",B(!1),{signal:ae}),fe.addEventListener("complete",B(!0),{signal:ae})),fe},table:function(w){var D=d.table(w),B=D.schema.primaryKey;return i(i({},D),{mutate:function(K){var ae=yt.trans;if(B.outbound||ae.db._options.cache==="disabled"||ae.explicit)return D.mutate(K);var fe=qa["idb://".concat(g,"/").concat(w)];return fe?(ae=D.mutate(K),K.type!=="add"&&K.type!=="put"||!(50<=K.values.length||ws(B,K).some(function(ke){return ke==null}))?(fe.optimisticOps.push(K),K.mutatedParts&&gi(K.mutatedParts),ae.then(function(ke){0<ke.numFailures&&(De(fe.optimisticOps,K),(ke=Xt(0,K,ke))&&fe.optimisticOps.push(ke),K.mutatedParts&&gi(K.mutatedParts))}),ae.catch(function(){De(fe.optimisticOps,K),K.mutatedParts&&gi(K.mutatedParts)})):ae.then(function(ke){var xe=Xt(0,i(i({},K),{values:K.values.map(function(Ee,ge){var Re,Ee=(Re=B.keyPath)!==null&&Re!==void 0&&Re.includes(".")?te(Ee):i({},Ee);return H(Ee,B.keyPath,ke.results[ge]),Ee})}),ke);fe.optimisticOps.push(xe),queueMicrotask(function(){return K.mutatedParts&&gi(K.mutatedParts)})}),ae):D.mutate(K)},query:function(K){if(!it(yt,D)||!Dt("query",K))return D.query(K);var ae=((xe=yt.trans)===null||xe===void 0?void 0:xe.db._options.cache)==="immutable",ge=yt,fe=ge.requery,ke=ge.signal,xe=(function(Ae,Oe,Te,Fe){var qe=qa["idb://".concat(Ae,"/").concat(Oe)];if(!qe)return[];if(!(Oe=qe.queries[Te]))return[null,!1,qe,null];var Ge=Oe[(Fe.query?Fe.query.index.name:null)||""];if(!Ge)return[null,!1,qe,null];switch(Te){case"query":var Xe=Ge.find(function(ct){return ct.req.limit===Fe.limit&&ct.req.values===Fe.values&&Ir(ct.req.query.range,Fe.query.range)});return Xe?[Xe,!0,qe,Ge]:[Ge.find(function(ct){return("limit"in ct.req?ct.req.limit:1/0)>=Fe.limit&&(!Fe.values||ct.req.values)&&Rr(ct.req.query.range,Fe.query.range)}),!1,qe,Ge];case"count":return Xe=Ge.find(function(ct){return Ir(ct.req.query.range,Fe.query.range)}),[Xe,!!Xe,qe,Ge]}})(g,w,"query",K),je=xe[0],ge=xe[1],Re=xe[2],Ee=xe[3];return je&&ge?je.obsSet=K.obsSet:(ge=D.query(K).then(function(Ae){var Oe=Ae.result;if(je&&(je.res=Oe),ae){for(var Te=0,Fe=Oe.length;Te<Fe;++Te)Object.freeze(Oe[Te]);Object.freeze(Oe)}else Ae.result=te(Oe);return Ae}).catch(function(Ae){return Ee&&je&&De(Ee,je),Promise.reject(Ae)}),je={obsSet:K.obsSet,promise:ge,subscribers:new Set,type:"query",req:K,dirty:!1},Ee?Ee.push(je):(Ee=[je],(Re=Re||(qa["idb://".concat(g,"/").concat(w)]={queries:{query:{},count:{}},objs:new Map,optimisticOps:[],unsignaledParts:{}})).queries.query[K.query.index.name||""]=Ee)),Dr(je,Ee,fe,ke),je.promise.then(function(Ae){return{result:Xr(Ae.result,K,Re==null?void 0:Re.optimisticOps,D,je,ae)}})}})}})}};function ya(d,g){return new Proxy(d,{get:function(w,D,B){return D==="db"?g:Reflect.get(w,D,B)}})}var Wr=(Wn.prototype.version=function(d){if(isNaN(d)||d<.1)throw new ie.Type("Given version is not a positive number");if(d=Math.round(10*d)/10,this.idbdb||this._state.isBeingOpened)throw new ie.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,d);var g=this._versions,w=g.filter(function(D){return D._cfg.version===d})[0];return w||(w=new this.Version(d),g.push(w),g.sort(fn),w.stores({}),this._state.autoSchema=!1,w)},Wn.prototype._whenReady=function(d){var g=this;return this.idbdb&&(this._state.openComplete||yt.letThrough||this._vip)?d():new gt(function(w,D){if(g._state.openComplete)return D(new ie.DatabaseClosed(g._state.dbOpenError));if(!g._state.isBeingOpened){if(!g._state.autoOpen)return void D(new ie.DatabaseClosed);g.open().catch(ft)}g._state.dbReadyPromise.then(w,D)}).then(d)},Wn.prototype.use=function(d){var g=d.stack,w=d.create,D=d.level,B=d.name;return B&&this.unuse({stack:g,name:B}),d=this._middlewares[g]||(this._middlewares[g]=[]),d.push({stack:g,create:w,level:D??10,name:B}),d.sort(function(K,ae){return K.level-ae.level}),this},Wn.prototype.unuse=function(d){var g=d.stack,w=d.name,D=d.create;return g&&this._middlewares[g]&&(this._middlewares[g]=this._middlewares[g].filter(function(B){return D?B.create!==D:!!w&&B.name!==w})),this},Wn.prototype.open=function(){var d=this;return St(Ht,function(){return El(d)})},Wn.prototype._close=function(){var d=this._state,g=$t.indexOf(this);if(0<=g&&$t.splice(g,1),this.idbdb){try{this.idbdb.close()}catch{}this.idbdb=null}d.isBeingOpened||(d.dbReadyPromise=new gt(function(w){d.dbReadyResolve=w}),d.openCanceller=new gt(function(w,D){d.cancelOpen=D}))},Wn.prototype.close=function(w){var g=(w===void 0?{disableAutoOpen:!0}:w).disableAutoOpen,w=this._state;g?(w.isBeingOpened&&w.cancelOpen(new ie.DatabaseClosed),this._close(),w.autoOpen=!1,w.dbOpenError=new ie.DatabaseClosed):(this._close(),w.autoOpen=this._options.autoOpen||w.isBeingOpened,w.openComplete=!1,w.dbOpenError=null)},Wn.prototype.delete=function(d){var g=this;d===void 0&&(d={disableAutoOpen:!0});var w=0<arguments.length&&typeof arguments[0]!="object",D=this._state;return new gt(function(B,K){function ae(){g.close(d);var fe=g._deps.indexedDB.deleteDatabase(g.name);fe.onsuccess=En(function(){var ke,xe,je;ke=g._deps,xe=g.name,je=ke.indexedDB,ke=ke.IDBKeyRange,to(je)||xe===Zn||eo(je,ke).delete(xe).catch(ft),B()}),fe.onerror=xr(K),fe.onblocked=g._fireOnBlocked}if(w)throw new ie.InvalidArgument("Invalid closeOptions argument to db.delete()");D.isBeingOpened?D.dbReadyPromise.then(ae):ae()})},Wn.prototype.backendDB=function(){return this.idbdb},Wn.prototype.isOpen=function(){return this.idbdb!==null},Wn.prototype.hasBeenClosed=function(){var d=this._state.dbOpenError;return d&&d.name==="DatabaseClosed"},Wn.prototype.hasFailed=function(){return this._state.dbOpenError!==null},Wn.prototype.dynamicallyOpened=function(){return this._state.autoSchema},Object.defineProperty(Wn.prototype,"tables",{get:function(){var d=this;return f(this._allTables).map(function(g){return d._allTables[g]})},enumerable:!1,configurable:!0}),Wn.prototype.transaction=function(){var d=(function(g,w,D){var B=arguments.length;if(B<2)throw new ie.InvalidArgument("Too few arguments");for(var K=new Array(B-1);--B;)K[B-1]=arguments[B];return D=K.pop(),[g,Q(K),D]}).apply(this,arguments);return this._transaction.apply(this,d)},Wn.prototype._transaction=function(d,g,w){var D=this,B=yt.trans;B&&B.db===this&&d.indexOf("!")===-1||(B=null);var K,ae,fe=d.indexOf("?")!==-1;d=d.replace("!","").replace("?","");try{if(ae=g.map(function(xe){if(xe=xe instanceof D.Table?xe.name:xe,typeof xe!="string")throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return xe}),d=="r"||d===Hr)K=Hr;else{if(d!="rw"&&d!=Mn)throw new ie.InvalidArgument("Invalid transaction mode: "+d);K=Mn}if(B){if(B.mode===Hr&&K===Mn){if(!fe)throw new ie.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");B=null}B&&ae.forEach(function(xe){if(B&&B.storeNames.indexOf(xe)===-1){if(!fe)throw new ie.SubTransaction("Table "+xe+" not included in parent transaction.");B=null}}),fe&&B&&!B.active&&(B=null)}}catch(xe){return B?B._promise(null,function(je,ge){ge(xe)}):ut(xe)}var ke=(function xe(je,ge,Re,Ee,Ae){return gt.resolve().then(function(){var Oe=yt.transless||yt,Te=je._createTransaction(ge,Re,je._dbSchema,Ee);if(Te.explicit=!0,Oe={trans:Te,transless:Oe},Ee)Te.idbtrans=Ee.idbtrans;else try{Te.create(),Te.idbtrans._explicit=!0,je._state.PR1398_maxLoop=3}catch(Ge){return Ge.name===oe.InvalidState&&je.isOpen()&&0<--je._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),je.close({disableAutoOpen:!1}),je.open().then(function(){return xe(je,ge,Re,null,Ae)})):ut(Ge)}var Fe,qe=T(Ae);return qe&&gn(),Oe=gt.follow(function(){var Ge;(Fe=Ae.call(Te,Te))&&(qe?(Ge=nn.bind(null,null),Fe.then(Ge,Ge)):typeof Fe.next=="function"&&typeof Fe.throw=="function"&&(Fe=yi(Fe)))},Oe),(Fe&&typeof Fe.then=="function"?gt.resolve(Fe).then(function(Ge){return Te.active?Ge:ut(new ie.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))}):Oe.then(function(){return Fe})).then(function(Ge){return Ee&&Te._resolve(),Te._completion.then(function(){return Ge})}).catch(function(Ge){return Te._reject(Ge),ut(Ge)})})}).bind(null,this,K,ae,B,w);return B?B._promise(K,ke,"lock"):yt.trans?St(yt.transless,function(){return D._whenReady(ke)}):this._whenReady(ke)},Wn.prototype.table=function(d){if(!E(this._allTables,d))throw new ie.InvalidTable("Table ".concat(d," does not exist"));return this._allTables[d]},Wn);function Wn(d,g){var w=this;this._middlewares={},this.verno=0;var D=Wn.dependencies;this._options=g=i({addons:Wn.addons,autoOpen:!0,indexedDB:D.indexedDB,IDBKeyRange:D.IDBKeyRange,cache:"cloned"},g),this._deps={indexedDB:g.indexedDB,IDBKeyRange:g.IDBKeyRange},D=g.addons,this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={},this.idbdb=null,this._novip=this;var B,K,ae,fe,ke,xe={dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:ft,dbReadyPromise:null,cancelOpen:ft,openCanceller:null,autoSchema:!0,PR1398_maxLoop:3,autoOpen:g.autoOpen};xe.dbReadyPromise=new gt(function(ge){xe.dbReadyResolve=ge}),xe.openCanceller=new gt(function(ge,Re){xe.cancelOpen=Re}),this._state=xe,this.name=d,this.on=ts(this,"populate","blocked","versionchange","close",{ready:[Ve,ft]}),this.on.ready.subscribe=q(this.on.ready.subscribe,function(ge){return function(Re,Ee){Wn.vip(function(){var Ae,Oe=w._state;Oe.openComplete?(Oe.dbOpenError||gt.resolve().then(Re),Ee&&ge(Re)):Oe.onReadyBeingFired?(Oe.onReadyBeingFired.push(Re),Ee&&ge(Re)):(ge(Re),Ae=w,Ee||ge(function Te(){Ae.on.ready.unsubscribe(Re),Ae.on.ready.unsubscribe(Te)}))})}}),this.Collection=(B=this,kn(li.prototype,function(Fe,Te){this.db=B;var Ee=es,Ae=null;if(Te)try{Ee=Te()}catch(qe){Ae=qe}var Oe=Fe._ctx,Te=Oe.table,Fe=Te.hook.reading.fire;this._ctx={table:Te,index:Oe.index,isPrimKey:!Oe.index||Te.schema.primKey.keyPath&&Oe.index===Te.schema.primKey.name,range:Ee,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:Ae,or:Oe.or,valueMapper:Fe!==$e?Fe:null}})),this.Table=(K=this,kn(aa.prototype,function(ge,Re,Ee){this.db=K,this._tx=Ee,this.name=ge,this.schema=Re,this.hook=K._allTables[ge]?K._allTables[ge].hook:ts(null,{creating:[Ce,ft],reading:[C,$e],updating:[ee,ft],deleting:[re,ft]})})),this.Transaction=(ae=this,kn(Pa.prototype,function(ge,Re,Ee,Ae,Oe){var Te=this;this.db=ae,this.mode=ge,this.storeNames=Re,this.schema=Ee,this.chromeTransactionDurability=Ae,this.idbtrans=null,this.on=ts(this,"complete","error","abort"),this.parent=Oe||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new gt(function(Fe,qe){Te._resolve=Fe,Te._reject=qe}),this._completion.then(function(){Te.active=!1,Te.on.complete.fire()},function(Fe){var qe=Te.active;return Te.active=!1,Te.on.error.fire(Fe),Te.parent?Te.parent._reject(Fe):qe&&Te.idbtrans&&Te.idbtrans.abort(),ut(Fe)})})),this.Version=(fe=this,kn(Sl.prototype,function(ge){this.db=fe,this._cfg={version:ge,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}})),this.WhereClause=(ke=this,kn(Na.prototype,function(ge,Re,Ee){if(this.db=ke,this._ctx={table:ge,index:Re===":id"?null:Re,or:Ee},this._cmp=this._ascending=dn,this._descending=function(Ae,Oe){return dn(Oe,Ae)},this._max=function(Ae,Oe){return 0<dn(Ae,Oe)?Ae:Oe},this._min=function(Ae,Oe){return dn(Ae,Oe)<0?Ae:Oe},this._IDBKeyRange=ke._deps.IDBKeyRange,!this._IDBKeyRange)throw new ie.MissingAPI})),this.on("versionchange",function(ge){0<ge.newVersion?console.warn("Another connection wants to upgrade database '".concat(w.name,"'. Closing db now to resume the upgrade.")):console.warn("Another connection wants to delete database '".concat(w.name,"'. Closing db now to resume the delete request.")),w.close({disableAutoOpen:!1})}),this.on("blocked",function(ge){!ge.newVersion||ge.newVersion<ge.oldVersion?console.warn("Dexie.delete('".concat(w.name,"') was blocked")):console.warn("Upgrade '".concat(w.name,"' blocked by other connection holding version ").concat(ge.oldVersion/10))}),this._maxKey=ga(g.IDBKeyRange),this._createTransaction=function(ge,Re,Ee,Ae){return new w.Transaction(ge,Re,Ee,w._options.chromeTransactionDurability,Ae)},this._fireOnBlocked=function(ge){w.on("blocked").fire(ge),$t.filter(function(Re){return Re.name===w.name&&Re!==w&&!Re._state.vcFired}).map(function(Re){return Re.on("versionchange").fire(ge)})},this.use(Me),this.use(os),this.use(Bt),this.use(io),this.use(oo);var je=new Proxy(this,{get:function(ge,Re,Ee){if(Re==="_vip")return!0;if(Re==="table")return function(Oe){return ya(w.table(Oe),je)};var Ae=Reflect.get(ge,Re,Ee);return Ae instanceof aa?ya(Ae,je):Re==="tables"?Ae.map(function(Oe){return ya(Oe,je)}):Re==="_createTransaction"?function(){return ya(Ae.apply(this,arguments),je)}:Ae}});this.vip=je,D.forEach(function(ge){return ge(w)})}var lo,ea=typeof Symbol<"u"&&"observable"in Symbol?Symbol.observable:"@@observable",kl=(Uo.prototype.subscribe=function(d,g,w){return this._subscribe(d&&typeof d!="function"?d:{next:d,error:g,complete:w})},Uo.prototype[ea]=function(){return this},Uo);function Uo(d){this._subscribe=d}try{lo={indexedDB:u.indexedDB||u.mozIndexedDB||u.webkitIndexedDB||u.msIndexedDB,IDBKeyRange:u.IDBKeyRange||u.webkitIDBKeyRange}}catch{lo={indexedDB:null,IDBKeyRange:null}}function Al(d){var g,w=!1,D=new kl(function(B){var K=T(d),ae,fe=!1,ke={},xe={},je={get closed(){return fe},unsubscribe:function(){fe||(fe=!0,ae&&ae.abort(),ge&&Jr.storagemutated.unsubscribe(Ee))}};B.start&&B.start(je);var ge=!1,Re=function(){return st(Ae)},Ee=function(Oe){pi(ke,Oe),mi(xe,ke)&&Re()},Ae=function(){var Oe,Te,Fe;!fe&&lo.indexedDB&&(ke={},Oe={},ae&&ae.abort(),ae=new AbortController,Fe=(function(qe){var Ge=Vr();try{K&&gn();var Xe=nr(d,qe);return Xe=K?Xe.finally(nn):Xe}finally{Ge&&zn()}})(Te={subscr:Oe,signal:ae.signal,requery:Re,querier:d,trans:null}),Promise.resolve(Fe).then(function(qe){w=!0,g=qe,fe||Te.signal.aborted||(ke={},(function(Ge){for(var Xe in Ge)if(E(Ge,Xe))return;return 1})(xe=Oe)||ge||(Jr(Ot,Ee),ge=!0),st(function(){return!fe&&B.next&&B.next(qe)}))},function(qe){w=!1,["DatabaseClosedError","AbortError"].includes(qe==null?void 0:qe.name)||fe||st(function(){fe||B.error&&B.error(qe)})}))};return setTimeout(Re,0),je});return D.hasValue=function(){return w},D.getValue=function(){return g},D}var Ss=Wr;function Tl(d){var g=Es;try{Es=!0,Jr.storagemutated.fire(d),so(d,!0)}finally{Es=g}}N(Ss,i(i({},ot),{delete:function(d){return new Ss(d,{addons:[]}).delete()},exists:function(d){return new Ss(d,{addons:[]}).open().then(function(g){return g.close(),!0}).catch("NoSuchDatabaseError",function(){return!1})},getDatabaseNames:function(d){try{return g=Ss.dependencies,w=g.indexedDB,g=g.IDBKeyRange,(to(w)?Promise.resolve(w.databases()).then(function(D){return D.map(function(B){return B.name}).filter(function(B){return B!==Zn})}):eo(w,g).toCollection().primaryKeys()).then(d)}catch{return ut(new ie.MissingAPI)}var g,w},defineClass:function(){return function(d){b(this,d)}},ignoreTransaction:function(d){return yt.trans?St(yt.transless,d):d()},vip:no,async:function(d){return function(){try{var g=yi(d.apply(this,arguments));return g&&typeof g.then=="function"?g:gt.resolve(g)}catch(w){return ut(w)}}},spawn:function(d,g,w){try{var D=yi(d.apply(w,g||[]));return D&&typeof D.then=="function"?D:gt.resolve(D)}catch(B){return ut(B)}},currentTransaction:{get:function(){return yt.trans||null}},waitFor:function(d,g){return g=gt.resolve(typeof d=="function"?Ss.ignoreTransaction(d):d).timeout(g||6e4),yt.trans?yt.trans.waitFor(g):g},Promise:gt,debug:{get:function(){return Ye},set:function(d){be(d)}},derive:A,extend:b,props:N,override:q,Events:ts,on:Jr,liveQuery:Al,extendObservabilitySet:pi,getByKeyPath:W,setByKeyPath:H,delByKeyPath:function(d,g){typeof g=="string"?H(d,g,void 0):"length"in g&&[].map.call(g,function(w){H(d,w,void 0)})},shallowClone:L,deepClone:te,getObjectDiff:is,cmp:dn,asap:Y,minKey:-1/0,addons:[],connections:$t,errnames:oe,dependencies:lo,cache:qa,semVer:"4.0.8",version:"4.0.8".split(".").map(function(d){return parseInt(d)}).reduce(function(d,g,w){return d+g/Math.pow(10,2*w)})})),Ss.maxKey=ga(Ss.dependencies.IDBKeyRange),typeof dispatchEvent<"u"&&typeof addEventListener<"u"&&(Jr(Ot,function(d){Es||(d=new CustomEvent(bs,{detail:d}),Es=!0,dispatchEvent(d),Es=!1)}),addEventListener(bs,function(d){d=d.detail,Es||Tl(d)}));var xi,Es=!1,Hc=function(){};return typeof BroadcastChannel<"u"&&((Hc=function(){(xi=new BroadcastChannel(bs)).onmessage=function(d){return d.data&&Tl(d.data)}})(),typeof xi.unref=="function"&&xi.unref(),Jr(Ot,function(d){Es||xi.postMessage(d)})),typeof addEventListener<"u"&&(addEventListener("pagehide",function(d){if(!Wr.disableBfCache&&d.persisted){Ye&&console.debug("Dexie: handling persisted pagehide"),xi!=null&&xi.close();for(var g=0,w=$t;g<w.length;g++)w[g].close({disableAutoOpen:!1})}}),addEventListener("pageshow",function(d){!Wr.disableBfCache&&d.persisted&&(Ye&&console.debug("Dexie: handling persisted pageshow"),Hc(),Tl({all:new Nr(-1/0,[[]])}))})),gt.rejectionMapper=function(d,g){return!d||d instanceof ne||d instanceof TypeError||d instanceof SyntaxError||!d.name||!We[d.name]?d:(g=new We[d.name](g||d.message,d),"stack"in d&&I(g,"stack",{get:function(){return this.inner.stack}}),g)},be(Ye),i(Wr,Object.freeze({__proto__:null,Dexie:Wr,liveQuery:Al,Entity:ii,cmp:dn,PropModSymbol:sa,PropModification:fa,replacePrefix:function(d,g){return new fa({replacePrefix:[d,g]})},add:function(d){return new fa({add:d})},remove:function(d){return new fa({remove:d})},default:Wr,RangeSet:Nr,mergeRanges:Hs,rangesOverlap:jo}),{default:Wr}),Wr})})(nd)),nd.exports}var a1=r1();const $h=Co(a1),Hy=Symbol.for("Dexie"),pd=globalThis[Hy]||(globalThis[Hy]=$h);if($h.semVer!==pd.semVer)throw new Error(`Two different versions of Dexie loaded in the same app: ${$h.semVer} and ${pd.semVer}`);const{liveQuery:G2,mergeRanges:K2,rangesOverlap:Y2,RangeSet:$2,cmp:V2,Entity:Z2,PropModSymbol:Q2,PropModification:J2,replacePrefix:X2,add:W2,remove:eA}=pd,s1="cogniflow-sync";let wh=null;const $b=()=>(wh||(wh=new BroadcastChannel(s1)),wh),wl=()=>{$b().postMessage({type:"data-changed"})},i1=n=>{const a=$b(),s=()=>{n()};return a.addEventListener("message",s),()=>{a.removeEventListener("message",s)}},o1="CogniFlowDB",l1=9;class Vb extends pd{constructor(){super(o1),this.version(l1).stores({decks:"id",folders:"id",deckSeries:"id",sessions:"id",reviews:"++id, timestamp, deckId",ai_chat:"id",seriesProgress:"id",learningProgress:"deckId"})}}const wt=new Vb;async function Zb(){return await wt.decks.toArray()}async function Qb(n){n.length!==0&&(await wt.decks.bulkPut(n),wl())}async function c1(n){await Qb(n)}async function u1(n){await wt.transaction("rw",wt.decks,wt.deckSeries,async()=>{await wt.decks.delete(n),await wt.deckSeries.toCollection().modify(a=>{a.levels&&(a.levels=a.levels.map(s=>({...s,deckIds:(s.deckIds||[]).filter(i=>i!==n)})))})}),wl()}async function d1(n){await wt.decks.put(n),wl()}async function f1(){return await wt.folders.toArray()}async function h1(n){await wt.folders.add(n)}async function p1(n){n.length!==0&&await wt.folders.bulkPut(n)}async function m1(n){await wt.folders.put(n)}async function g1(n){await wt.transaction("rw",wt.folders,wt.decks,async()=>{await wt.folders.delete(n),await wt.decks.where("folderId").equals(n).modify({folderId:null})})}async function y1(){return await wt.deckSeries.toArray()}async function v1(n){n.length!==0&&(await wt.deckSeries.bulkPut(n),wl())}async function b1(n){await wt.deckSeries.put(n)}async function x1(n){await wt.deckSeries.delete(n),wl()}async function _1(n,a){await wt.sessions.put({...a,id:n})}async function w1(n){return await wt.sessions.get(n)||null}async function S1(){return await wt.sessions.toArray()}async function E1(){await wt.sessions.clear()}async function k1(n){n.length!==0&&await wt.sessions.bulkPut(n)}async function A1(n){await wt.sessions.delete(n)}async function T1(){return await wt.sessions.toCollection().primaryKeys()}async function C1(){await wt.decks.clear()}async function N1(){await wt.folders.clear()}async function D1(){await wt.deckSeries.clear()}async function O1(n){await wt.learningProgress.put(n)}async function j1(){const n=await wt.learningProgress.toArray(),a={};return n.forEach(s=>a[s.deckId]=s),a}async function I1(n){const a=Object.values(n);a.length!==0&&await wt.learningProgress.bulkPut(a)}async function $i(){const[n,a,s,i,c,u,f]=await Promise.all([wt.decks.toArray(),wt.folders.toArray(),wt.deckSeries.toArray(),wt.reviews.toArray(),wt.sessions.toArray(),wt.seriesProgress.toArray(),wt.learningProgress.toArray()]),p={};u.forEach(m=>p[m.id]=m.completedDeckIds);const b={};return f.forEach(m=>b[m.deckId]=m),{decks:n,folders:a,deckSeries:s,reviews:i,sessions:c,seriesProgress:p,learningProgress:b}}async function R1(n){const{id:a,...s}=n;await wt.reviews.add(s)}async function M1(n){return await wt.reviews.where("timestamp").aboveOrEqual(n.toISOString()).toArray()}async function U1(){return await wt.reviews.toArray()}async function L1(){await wt.reviews.clear()}async function z1(n){n.length!==0&&await wt.reviews.where("deckId").anyOf(n).delete()}async function B1(n){if(n.length===0)return;const a=n.map(({id:s,...i})=>i);await wt.reviews.bulkAdd(a)}async function F1(n){return await wt.reviews.where("deckId").equals(n).toArray()}async function Jb(n){await wt.ai_chat.put({id:"global_history",history:n})}async function xd(){const n=await wt.ai_chat.get("global_history");return(n==null?void 0:n.history)||[]}async function H1(){await wt.ai_chat.clear()}async function P1(n,a){await wt.seriesProgress.put({id:n,completedDeckIds:Array.from(a)})}async function q1(){const n=await wt.seriesProgress.toArray(),a={};return n.forEach(s=>a[s.id]=s.completedDeckIds),a}async function G1(){await wt.seriesProgress.clear()}async function K1(n){const a=Object.entries(n).map(([s,i])=>({id:s,completedDeckIds:i}));a.length!==0&&await wt.seriesProgress.bulkPut(a)}async function Xb(){if(typeof window>"u")return null;const n=await $i();if(n.decks.length===0&&n.folders.length===0&&n.deckSeries.length===0)throw new Error("No data to export.");const a=await xd(),s={};Object.entries({themeId:"cogniflow-themeId",disableAnimations:"cogniflow-disableAnimations",hapticsEnabled:"cogniflow-hapticsEnabled",aiFeaturesEnabled:"cogniflow-aiFeaturesEnabled",veoEnabled:"cogniflow-veoEnabled",groundedImagesEnabled:"cogniflow-groundedImagesEnabled",searchAuditsEnabled:"cogniflow-searchAuditsEnabled",backupEnabled:"cogniflow-backupEnabled",backupApiKey:"cogniflow-backupApiKey",syncOnCellular:"cogniflow-syncOnCellular",notificationsEnabled:"cogniflow-notificationsEnabled",leechThreshold:"cogniflow-leechThreshold",leechAction:"cogniflow-leechAction",fontFamily:"cogniflow-fontFamily",encryptionPassword:"cogniflow-encryptionPassword"}).forEach(([b,m])=>{const _=localStorage.getItem(m);if(_!==null)try{s[b]=JSON.parse(_)}catch{s[b]=_}});const c={version:9,...n,aiChatHistory:a,settings:s},u=new Blob([JSON.stringify(c,null,2)],{type:"application/json"}),f=URL.createObjectURL(u),p=document.createElement("a");return p.href=f,p.download=`cogniflow-backup-${cp()}.json`,document.body.appendChild(p),p.click(),document.body.removeChild(p),URL.revokeObjectURL(f),p.download}async function vc(n){await wt.transaction("rw",[wt.decks,wt.folders,wt.deckSeries,wt.reviews,wt.sessions,wt.ai_chat,wt.seriesProgress,wt.learningProgress],async()=>{await Promise.all([wt.decks.clear(),wt.folders.clear(),wt.deckSeries.clear(),wt.reviews.clear(),wt.sessions.clear(),wt.ai_chat.clear(),wt.seriesProgress.clear(),wt.learningProgress.clear()]);const a=wt,s=n;if(s.decks&&await a.decks.bulkPut(s.decks),s.folders&&await a.folders.bulkPut(s.folders),s.deckSeries&&await a.deckSeries.bulkPut(s.deckSeries),s.reviews&&s.reviews.length>0){const i=s.reviews.map(c=>{const{id:u,...f}=c;return f});await a.table("reviews").bulkAdd(i)}if(s.sessions&&await a.sessions.bulkPut(s.sessions),s.aiChatHistory&&await a.ai_chat.put({id:"global_history",history:s.aiChatHistory}),s.seriesProgress){const i=Object.entries(s.seriesProgress).map(([c,u])=>({id:c,completedDeckIds:u}));await a.seriesProgress.bulkPut(i)}s.learningProgress&&await a.learningProgress.bulkPut(Object.values(s.learningProgress))}),wl()}async function Y1(){await wt.delete(),localStorage.clear(),window.location.reload()}const $1=Object.freeze(Object.defineProperty({__proto__:null,CogniFlowDatabase:Vb,addDeckSeries:v1,addDecks:Qb,addFolder:h1,addFolders:p1,addReviewLog:R1,bulkAddLearningProgress:I1,bulkAddReviews:B1,bulkAddSeriesProgress:K1,bulkAddSessions:k1,bulkUpdateDecks:c1,clearAIChatHistory:H1,clearDecks:C1,clearFolders:N1,clearReviews:L1,clearSeries:D1,clearSeriesProgress:G1,clearSessions:E1,db:wt,deleteDeck:u1,deleteDeckSeries:x1,deleteFolder:g1,deleteReviewsForDecks:z1,deleteSessionState:A1,exportAllData:Xb,factoryReset:Y1,getAIChatHistory:xd,getAllDataForBackup:$i,getAllDeckSeries:y1,getAllDecks:Zb,getAllFolders:f1,getAllLearningProgress:j1,getAllReviews:U1,getAllSeriesProgress:q1,getAllSessionKeys:T1,getAllSessions:S1,getReviewsForDeck:F1,getReviewsSince:M1,getSessionState:w1,performAtomicRestore:vc,saveAIChatHistory:Jb,saveLearningProgress:O1,saveSeriesProgress:P1,saveSessionState:_1,updateDeck:d1,updateDeckSeries:b1,updateFolder:m1},Symbol.toStringTag,{value:"Module"})),up="AES-GCM",ul=16,rd=12;async function Wb(n,a,s){const i=new TextEncoder,c=await window.crypto.subtle.importKey("raw",i.encode(n),{name:"PBKDF2"},!1,["deriveKey"]);return window.crypto.subtle.deriveKey({name:"PBKDF2",salt:a,iterations:1e5,hash:"SHA-256"},c,{name:up,length:256},!1,s)}async function e0(n,a){const s=window.crypto.getRandomValues(new Uint8Array(ul)),i=window.crypto.getRandomValues(new Uint8Array(rd)),c=await Wb(a,s,["encrypt"]),u=new TextEncoder,f=await window.crypto.subtle.encrypt({name:up,iv:i},c,u.encode(n)),p=new Uint8Array(s.byteLength+i.byteLength+f.byteLength);p.set(s,0),p.set(i,s.byteLength),p.set(new Uint8Array(f),s.byteLength+i.byteLength);let b="";for(let m=0;m<p.byteLength;m++)b+=String.fromCharCode(p[m]);return btoa(b)}async function V1(n,a){const s=atob(n),i=new Uint8Array(s.length);for(let b=0;b<s.length;b++)i[b]=s.charCodeAt(b);if(i.byteLength<ul+rd)throw new Error("Invalid encrypted data.");const c=i.slice(0,ul),u=i.slice(ul,ul+rd),f=i.slice(ul+rd),p=await Wb(a,c,["decrypt"]);try{const b=await window.crypto.subtle.decrypt({name:up,iv:u},p,f);return new TextDecoder().decode(b)}catch{throw new Error("Decryption failed. Wrong password or corrupted data.")}}const Z1="https://www.greenyogafestival.org/backup-api/api/v1",No="cogniflow-data",md="cogniflow-data.json",Q1=()=>localStorage.getItem("cogniflow-backupApiKey")||"qRt+gU/57GHKhxTZeRnRi+dfT274iSkKKq2UnTr9Bxs=",t0=n=>localStorage.setItem("cogniflow-lastSyncEtag",n),n0=()=>localStorage.getItem("cogniflow-lastSyncEtag");async function Do(n,a={}){const s=`${Z1}/${n}`,i=Q1(),c=new Headers(a.headers||{});c.set("X-API-Key",i),a.body instanceof FormData&&c.delete("Content-Type");const u={...a,headers:c};console.log(`[BackupService] Requesting: ${a.method||"GET"} ${s}`,{headers:Object.fromEntries(c.entries())});const f=3,p=1e3;for(let b=1;b<=f;b++)try{const m=await window.fetch(s,u);if(console.log(`[BackupService] Response from ${a.method||"GET"} ${s}: ${m.status}`),!m.ok&&![304,404].includes(m.status)){let _;try{_=await m.json()}catch{_={error:`HTTP error! status: ${m.status}`}}console.error("[BackupService] API request failed:",_);const E=(_==null?void 0:_.error)||(_==null?void 0:_.message)||`Request failed with status ${m.status}`,N=new Error(E);throw N.status=m.status,N}return m}catch(m){if(m instanceof TypeError&&m.message.toLowerCase().includes("failed to fetch"))if(b<f){const _=p*Math.pow(2,b-1);console.warn(`[BackupService] Attempt ${b} failed. Retrying in ${_}ms...`,m),await new Promise(E=>setTimeout(E,_));continue}else{console.error("[BackupService] All network attempts failed. This may be a network or CORS issue.",m);const _=new Error("Network error: Could not connect to the backup server. Please check your internet connection and any browser extensions (like ad-blockers) that may be interfering.");throw _.isNetworkError=!0,_}throw m}throw new Error("An unexpected error occurred in the request function.")}async function r0(n){const a=new lp;return a.file("backup.json",JSON.stringify(n)),{dataType:"cogniflow-compressed-backup-v1",content:await a.generateAsync({type:"base64",compression:"DEFLATE",compressionOptions:{level:6}})}}async function Sh(n,a=!1){console.log("[BackupService] Starting syncDataToServer...");let s;if(n)s=n;else{const{decks:E,folders:N,deckSeries:S,reviews:I,sessions:A,seriesProgress:k,learningProgress:R}=await $i(),P=await xd(),q=localStorage.getItem("cogniflow-ai-options"),G=q?JSON.parse(q):void 0,Y=kt.getState().aiGenerationStatus.queue||[];s={version:9,decks:E,folders:N,deckSeries:S,reviews:I,sessions:A,seriesProgress:k,learningProgress:R,aiOptions:G,aiChatHistory:P,aiTasks:Y}}const i=await r0(s);let c=JSON.stringify(i);const u=localStorage.getItem("cogniflow-encryptionPassword");if(u){const E=await e0(c,u);c=JSON.stringify({dataType:"cogniflow-encrypted-v1",content:E}),console.log("[BackupService] Payload encrypted.")}const f={"Content-Type":"application/json"},p=n0();p&&!a&&(f["If-Match"]=p),console.log(`[BackupService] PUT ${md}`,{headers:f,bodySize:c.length});const b=await Do(`apps/${No}/backups/${md}`,{method:"PUT",headers:f,body:c});if(!b.ok){let E;try{E=await b.json()}catch{E={error:`HTTP error! status: ${b.status}`}}const N=(E==null?void 0:E.error)||(E==null?void 0:E.message)||`Request failed with status ${b.status}`,S=new Error(N);throw S.status=b.status,S}const m=b.headers.get("ETag");m&&t0(m);const _=await b.json();return console.log("[BackupService] syncDataToServer successful:",_),{timestamp:_.modified,etag:m||""}}async function Eh(){console.log("[BackupService] Starting syncDataFromServer...");const n=await Do(`apps/${No}/backups/${md}`);if(n.status===404)throw new Error("No sync file found on the server.");const a=n.headers.get("ETag");a&&t0(a);let s=await n.text();try{const c=JSON.parse(s);if(c&&c.dataType==="cogniflow-encrypted-v1"){const u=localStorage.getItem("cogniflow-encryptionPassword");if(!u)throw new Error("Sync data is encrypted but no password is set on this device. Please set it in Settings.");s=await V1(c.content,u),console.log("[BackupService] Payload decrypted.")}}catch(c){if(c instanceof Error&&(c.message.includes("Decryption failed")||c.message.includes("password is set")))throw c}const i=await bd(s);return console.log("[BackupService] syncDataFromServer successful."),i}async function J1(){console.log("[BackupService] Starting getSyncDataMetadata...");const n={},a=n0();a&&(n["If-None-Match"]=a);const s=await Do(`apps/${No}/backups/${md}/meta`,{headers:n});if(s.status===304||s.status===404)return console.log(`[BackupService] getSyncDataMetadata finished with status: ${s.status}`),{metadata:null,isNotModified:s.status===304};const i=await s.json();return console.log("[BackupService] getSyncDataMetadata successful:",i),{metadata:i,isNotModified:!1}}async function X1(){var s;console.log("[BackupService] Starting listServerBackups...");const a=await(await Do(`apps/${No}/backups/list`)).json();return console.log(`[BackupService] Found ${((s=a.backups)==null?void 0:s.length)||0} backups.`),a.backups||[]}async function W1(){console.log("[BackupService] Starting createServerBackup...");const{decks:n,folders:a,deckSeries:s,reviews:i,sessions:c,seriesProgress:u,learningProgress:f}=await $i(),p=localStorage.getItem("cogniflow-ai-options"),b=p?JSON.parse(p):void 0,m=await xd(),_=kt.getState().aiGenerationStatus.queue||[],N=await r0({version:9,decks:n,folders:a,deckSeries:s,reviews:i,sessions:c,seriesProgress:u,learningProgress:f,aiOptions:b,aiChatHistory:m,aiTasks:_});let S=JSON.stringify(N);const I=localStorage.getItem("cogniflow-encryptionPassword");if(I){const G=await e0(S,I);S=JSON.stringify({dataType:"cogniflow-encrypted-v1",content:G}),console.log("[BackupService] Backup payload encrypted.")}const A=new Blob([S],{type:"application/json"}),k=`backup-${cp()}.json`,R=new FormData;R.append("file",A,k);const q=await(await Do(`apps/${No}/backups`,{method:"POST",body:R})).json();return console.log("[BackupService] createServerBackup successful:",q),q}async function eE(n){console.log(`[BackupService] Restoring live sync from manual backup: ${n}...`);const s=await(await Do(`apps/${No}/backups/${n}/restore`,{method:"POST"})).json();return console.log(`[BackupService] Restore from ${n} successful:`,s),s}async function tE(n){console.log(`[BackupService] Deleting manual backup: ${n}...`),await Do(`apps/${No}/backups/${n}`,{method:"DELETE"}),console.log(`[BackupService] Deleted ${n} successfully.`)}const nE=({isOpen:n,onClose:a,onRestore:s,onDelete:i})=>{const[c,u]=$.useState([]),[f,p]=$.useState(!1),[b,m]=$.useState(null),[_,E]=$.useState(null),{addToast:N}=Ar(),S=$.useRef(null);kr(S,n),$.useEffect(()=>{n&&(async()=>{p(!0),m(null),E("Loading sync file info...");try{const[R,{metadata:P}]=await Promise.all([X1(),J1()]),q=R.sort((G,Y)=>new Date(Y.modified).getTime()-new Date(G.modified).getTime());if(u(q),P){const G=new Date(P.modified),Y=(P.size/1024).toFixed(1);E(`Live sync file: ${G.toLocaleString()} (${Y} KB)`)}else E("No live sync file found on server.")}catch(R){const P=R instanceof Error?R.message:"Failed to load backups.";m(P),E("Could not retrieve live sync file info.")}finally{p(!1)}})()},[n]);const I=k=>{s(k),a()},A=async k=>{try{await i(k),u(R=>R.filter(P=>P.filename!==k)),N(`Deleted backup: ${k}`,"success")}catch{}};return l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-[60] p-4",children:l.jsxs("div",{ref:S,className:"bg-surface rounded-lg shadow-xl w-full max-w-2xl transform transition-all relative max-h-[90vh] flex flex-col",children:[l.jsxs("div",{className:"flex-shrink-0 flex justify-between items-center p-4 border-b border-border",children:[l.jsx("h2",{className:"text-xl font-bold",children:"Manage Server Backups"}),l.jsx(pt,{type:"button",variant:"ghost",onClick:a,className:"p-1 h-auto",children:l.jsx(rt,{name:"x"})})]}),l.jsxs("div",{className:"p-6 overflow-y-auto",children:[l.jsx("p",{className:"text-text-muted mb-2",children:"Select a backup to restore your live sync data from, or delete old backups. Restoring will overwrite the current sync file on the server."}),_&&l.jsx("p",{className:"text-sm text-text-muted mb-4 p-2 bg-background rounded-md",children:_}),f?l.jsx("div",{className:"text-center py-8",children:l.jsx(Rs,{})}):b?l.jsx("div",{className:"text-center py-8 text-red-500",children:b}):c.length>0?l.jsx("div",{className:"space-y-2 border border-border rounded-md",children:c.map(k=>l.jsxs("div",{className:"flex items-center justify-between p-3 hover:bg-background border-b border-border last:border-b-0",children:[l.jsxs("div",{className:"text-sm min-w-0",children:[l.jsx("p",{className:"font-medium text-text truncate",children:k.filename}),l.jsxs("p",{className:"text-text-muted",children:[new Date(k.modified).toLocaleString()," - ",(k.size/1024).toFixed(2)," KB"]})]}),l.jsxs("div",{className:"flex-shrink-0 flex items-center gap-1",children:[l.jsx(pt,{variant:"secondary",size:"sm",onClick:()=>I(k.filename),children:"Restore"}),l.jsx(pt,{variant:"danger",size:"sm",onClick:()=>A(k.filename),children:"Delete"})]})]},k.filename))}):l.jsx("div",{className:"text-center py-8 text-text-muted",children:l.jsx("p",{children:"No server backups found."})})]}),l.jsx("div",{className:"flex-shrink-0 flex justify-end p-4 bg-background/50 border-t border-border",children:l.jsx(pt,{type:"button",variant:"primary",onClick:a,children:"Close"})})]})})},rE=({isOpen:n,onClose:a,onConfirm:s,analysis:i})=>{const[c,u]=$.useState(""),[f,p]=$.useState(""),[b,m]=$.useState(null),_=$.useRef(null);kr(_,n),$.useEffect(()=>{if((i.type==="quiz"||i.type==="learning")&&i.data.name?u(i.data.name):u(""),i.type==="image"&&i.file){const k=new FileReader;k.readAsDataURL(i.file),k.onload=R=>{var P;m((P=R.target)==null?void 0:P.result)}}else m(null);p("")},[i]);const{title:E,message:N,confirmText:S}=$.useMemo(()=>{switch(i.type){case"backup":return{title:"Restore from Backup",message:`You dropped the backup file "${i.fileName}". Restoring will merge its content with your current data. Do you want to continue?`,confirmText:"Restore"};case"series":return{title:"Import Series",message:`You dropped a file containing the series "${i.data.seriesName}". Would you like to import it?`,confirmText:"Import Series"};case"quiz":return{title:"Import Quiz Deck",message:`You dropped a file for the quiz deck "${i.data.name}". Would you like to import it?`,confirmText:"Import Deck"};case"learning":return{title:"Import Learning Deck",message:`You dropped a file for the course "${i.data.name}". It includes instructional cards and associated questions.`,confirmText:"Import Course"};case"flashcard":return{title:"Import Flashcard Deck",message:`You dropped a file with ${i.data.length} flashcard(s). Please provide a name for the new deck.`,confirmText:"Import Deck"};case"anki":return{title:"Import Anki Package",message:`You dropped the Anki package "${i.fileName}". This may contain multiple decks and media.`,confirmText:"Import Anki Package"};case"image":return{title:"Generate Deck from Image",message:"Analyze this image with AI to create a flashcard deck.",confirmText:"Generate Deck"};default:return{title:"Confirm Import",message:"Unknown file type.",confirmText:"Confirm"}}},[i]),I=i.type==="flashcard"&&!c.trim(),A=()=>{s(i,{deckName:c.trim(),imageHint:f.trim()})};return n?l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-[60] p-4",children:l.jsxs("div",{ref:_,className:"bg-surface rounded-lg shadow-xl w-full max-w-lg transform transition-all relative flex flex-col max-h-[90vh]",children:[l.jsxs("div",{className:"flex-shrink-0 flex justify-between items-center p-4 border-b border-border",children:[l.jsx("h2",{className:"text-xl font-bold text-text",children:E}),l.jsx(pt,{type:"button",variant:"ghost",onClick:a,className:"p-1 h-auto","aria-label":"Close",children:l.jsx(rt,{name:"x"})})]}),l.jsxs("div",{className:"p-6 space-y-4 overflow-y-auto",children:[l.jsx("p",{className:"text-text-muted",children:N}),(i.type==="flashcard"||i.type==="quiz"||i.type==="learning")&&l.jsxs("div",{children:[l.jsx("label",{htmlFor:"deck-name-input",className:"block text-sm font-medium text-text-muted mb-1",children:"Deck Name"}),l.jsx("input",{id:"deck-name-input",type:"text",value:c,onChange:k=>u(k.target.value),className:"w-full p-2 bg-background border border-border rounded-md focus:ring-2 focus:ring-primary focus:outline-none",placeholder:"Enter a name for the new deck",autoFocus:!0})]}),i.type==="image"&&l.jsxs("div",{className:"space-y-4",children:[b&&l.jsx("div",{className:"rounded-lg overflow-hidden border border-border max-h-48 flex justify-center bg-black/5",children:l.jsx("img",{src:b,alt:"Preview",className:"h-full object-contain"})}),l.jsxs("div",{children:[l.jsx("label",{htmlFor:"image-hint",className:"block text-sm font-medium text-text-muted mb-1",children:"Topic / Hint (Optional)"}),l.jsx("input",{type:"text",id:"image-hint",value:f,onChange:k=>p(k.target.value),className:"w-full p-2 bg-background border border-border rounded-md focus:ring-2 focus:ring-primary focus:outline-none",placeholder:"e.g., Focus on dates or biological terms"}),l.jsx("p",{className:"text-xs text-text-muted mt-1",children:"Guide the AI to extract specific information."})]})]})]}),l.jsxs("div",{className:"flex-shrink-0 flex justify-end p-4 bg-background/50 border-t border-border",children:[l.jsx(pt,{type:"button",variant:"secondary",onClick:a,className:"mr-2",children:"Cancel"}),l.jsx(pt,{type:"button",variant:"primary",onClick:A,disabled:I,children:S})]})]})}):null};/*! @license DOMPurify 3.1.2 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/3.1.2/LICENSE */const{entries:a0,setPrototypeOf:Py,isFrozen:aE,getPrototypeOf:sE,getOwnPropertyDescriptor:iE}=Object;let{freeze:ca,seal:Xa,create:s0}=Object,{apply:Vh,construct:Zh}=typeof Reflect<"u"&&Reflect;ca||(ca=function(a){return a});Xa||(Xa=function(a){return a});Vh||(Vh=function(a,s,i){return a.apply(s,i)});Zh||(Zh=function(a,s){return new a(...s)});const Yu=Fa(Array.prototype.forEach),qy=Fa(Array.prototype.pop),uc=Fa(Array.prototype.push),ad=Fa(String.prototype.toLowerCase),kh=Fa(String.prototype.toString),Gy=Fa(String.prototype.match),dc=Fa(String.prototype.replace),oE=Fa(String.prototype.indexOf),lE=Fa(String.prototype.trim),us=Fa(Object.prototype.hasOwnProperty),Sa=Fa(RegExp.prototype.test),fc=cE(TypeError);function Fa(n){return function(a){for(var s=arguments.length,i=new Array(s>1?s-1:0),c=1;c<s;c++)i[c-1]=arguments[c];return Vh(n,a,i)}}function cE(n){return function(){for(var a=arguments.length,s=new Array(a),i=0;i<a;i++)s[i]=arguments[i];return Zh(n,s)}}function mn(n,a){let s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:ad;Py&&Py(n,null);let i=a.length;for(;i--;){let c=a[i];if(typeof c=="string"){const u=s(c);u!==c&&(aE(a)||(a[i]=u),c=u)}n[c]=!0}return n}function uE(n){for(let a=0;a<n.length;a++)us(n,a)||(n[a]=null);return n}function wo(n){const a=s0(null);for(const[s,i]of a0(n))us(n,s)&&(Array.isArray(i)?a[s]=uE(i):i&&typeof i=="object"&&i.constructor===Object?a[s]=wo(i):a[s]=i);return a}function $u(n,a){for(;n!==null;){const i=iE(n,a);if(i){if(i.get)return Fa(i.get);if(typeof i.value=="function")return Fa(i.value)}n=sE(n)}function s(){return null}return s}const Ky=ca(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),Ah=ca(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),Th=ca(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),dE=ca(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),Ch=ca(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),fE=ca(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),Yy=ca(["#text"]),$y=ca(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),Nh=ca(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),Vy=ca(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),Vu=ca(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),hE=Xa(/\{\{[\w\W]*|[\w\W]*\}\}/gm),pE=Xa(/<%[\w\W]*|[\w\W]*%>/gm),mE=Xa(/\${[\w\W]*}/gm),gE=Xa(/^data-[\-\w.\u00B7-\uFFFF]/),yE=Xa(/^aria-[\-\w]+$/),i0=Xa(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),vE=Xa(/^(?:\w+script|data):/i),bE=Xa(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),o0=Xa(/^html$/i),xE=Xa(/^[a-z][.\w]*(-[.\w]+)+$/i);var Zy=Object.freeze({__proto__:null,MUSTACHE_EXPR:hE,ERB_EXPR:pE,TMPLIT_EXPR:mE,DATA_ATTR:gE,ARIA_ATTR:yE,IS_ALLOWED_URI:i0,IS_SCRIPT_OR_DATA:vE,ATTR_WHITESPACE:bE,DOCTYPE_NAME:o0,CUSTOM_ELEMENT:xE});const _E=function(){return typeof window>"u"?null:window},wE=function(a,s){if(typeof a!="object"||typeof a.createPolicy!="function")return null;let i=null;const c="data-tt-policy-suffix";s&&s.hasAttribute(c)&&(i=s.getAttribute(c));const u="dompurify"+(i?"#"+i:"");try{return a.createPolicy(u,{createHTML(f){return f},createScriptURL(f){return f}})}catch{return console.warn("TrustedTypes policy "+u+" could not be created."),null}};function l0(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:_E();const a=St=>l0(St);if(a.version="3.1.2",a.removed=[],!n||!n.document||n.document.nodeType!==9)return a.isSupported=!1,a;let{document:s}=n;const i=s,c=i.currentScript,{DocumentFragment:u,HTMLTemplateElement:f,Node:p,Element:b,NodeFilter:m,NamedNodeMap:_=n.NamedNodeMap||n.MozNamedAttrMap,HTMLFormElement:E,DOMParser:N,trustedTypes:S}=n,I=b.prototype,A=$u(I,"cloneNode"),k=$u(I,"nextSibling"),R=$u(I,"childNodes"),P=$u(I,"parentNode");if(typeof f=="function"){const St=s.createElement("template");St.content&&St.content.ownerDocument&&(s=St.content.ownerDocument)}let q,G="";const{implementation:Y,createNodeIterator:W,createDocumentFragment:H,getElementsByTagName:L}=s,{importNode:U}=i;let Q={};a.isSupported=typeof a0=="function"&&typeof P=="function"&&Y&&Y.createHTMLDocument!==void 0;const{MUSTACHE_EXPR:le,ERB_EXPR:F,TMPLIT_EXPR:te,DATA_ATTR:j,ARIA_ATTR:he,IS_SCRIPT_OR_DATA:J,ATTR_WHITESPACE:Z,CUSTOM_ELEMENT:De}=Zy;let{IS_ALLOWED_URI:ve}=Zy,Be=null;const T=mn({},[...Ky,...Ah,...Th,...Ch,...Yy]);let z=null;const ne=mn({},[...$y,...Nh,...Vy,...Vu]);let se=Object.seal(s0(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),ue=null,de=null,oe=!0,ye=!0,ie=!1,We=!0,ot=!1,ft=!0,$e=!1,C=!1,Ne=!1,Ce=!1,re=!1,ee=!1,me=!0,Ve=!1;const Ye="user-content-";let be=!0,Ze=!1,at={},Ue=null;const _t=mn({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let It=null;const Nt=mn({},["audio","video","img","source","image","track"]);let on=null;const Zt=mn({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),cn="http://www.w3.org/1998/Math/MathML",bn="http://www.w3.org/2000/svg",zt="http://www.w3.org/1999/xhtml";let Ht=zt,yt=!1,tn=null;const or=mn({},[cn,bn,zt],kh);let At=null;const gt=["application/xhtml+xml","text/html"],jr="text/html";let An=null,qn=null;const vr=255,Tr=s.createElement("form"),ka=function(_e){return _e instanceof RegExp||_e instanceof Function},mt=function(){let _e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!(qn&&qn===_e)){if((!_e||typeof _e!="object")&&(_e={}),_e=wo(_e),At=gt.indexOf(_e.PARSER_MEDIA_TYPE)===-1?jr:_e.PARSER_MEDIA_TYPE,An=At==="application/xhtml+xml"?kh:ad,Be=us(_e,"ALLOWED_TAGS")?mn({},_e.ALLOWED_TAGS,An):T,z=us(_e,"ALLOWED_ATTR")?mn({},_e.ALLOWED_ATTR,An):ne,tn=us(_e,"ALLOWED_NAMESPACES")?mn({},_e.ALLOWED_NAMESPACES,kh):or,on=us(_e,"ADD_URI_SAFE_ATTR")?mn(wo(Zt),_e.ADD_URI_SAFE_ATTR,An):Zt,It=us(_e,"ADD_DATA_URI_TAGS")?mn(wo(Nt),_e.ADD_DATA_URI_TAGS,An):Nt,Ue=us(_e,"FORBID_CONTENTS")?mn({},_e.FORBID_CONTENTS,An):_t,ue=us(_e,"FORBID_TAGS")?mn({},_e.FORBID_TAGS,An):{},de=us(_e,"FORBID_ATTR")?mn({},_e.FORBID_ATTR,An):{},at=us(_e,"USE_PROFILES")?_e.USE_PROFILES:!1,oe=_e.ALLOW_ARIA_ATTR!==!1,ye=_e.ALLOW_DATA_ATTR!==!1,ie=_e.ALLOW_UNKNOWN_PROTOCOLS||!1,We=_e.ALLOW_SELF_CLOSE_IN_ATTR!==!1,ot=_e.SAFE_FOR_TEMPLATES||!1,ft=_e.SAFE_FOR_XML!==!1,$e=_e.WHOLE_DOCUMENT||!1,Ce=_e.RETURN_DOM||!1,re=_e.RETURN_DOM_FRAGMENT||!1,ee=_e.RETURN_TRUSTED_TYPE||!1,Ne=_e.FORCE_BODY||!1,me=_e.SANITIZE_DOM!==!1,Ve=_e.SANITIZE_NAMED_PROPS||!1,be=_e.KEEP_CONTENT!==!1,Ze=_e.IN_PLACE||!1,ve=_e.ALLOWED_URI_REGEXP||i0,Ht=_e.NAMESPACE||zt,se=_e.CUSTOM_ELEMENT_HANDLING||{},_e.CUSTOM_ELEMENT_HANDLING&&ka(_e.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(se.tagNameCheck=_e.CUSTOM_ELEMENT_HANDLING.tagNameCheck),_e.CUSTOM_ELEMENT_HANDLING&&ka(_e.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(se.attributeNameCheck=_e.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),_e.CUSTOM_ELEMENT_HANDLING&&typeof _e.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(se.allowCustomizedBuiltInElements=_e.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),ot&&(ye=!1),re&&(Ce=!0),at&&(Be=mn({},Yy),z=[],at.html===!0&&(mn(Be,Ky),mn(z,$y)),at.svg===!0&&(mn(Be,Ah),mn(z,Nh),mn(z,Vu)),at.svgFilters===!0&&(mn(Be,Th),mn(z,Nh),mn(z,Vu)),at.mathMl===!0&&(mn(Be,Ch),mn(z,Vy),mn(z,Vu))),_e.ADD_TAGS&&(Be===T&&(Be=wo(Be)),mn(Be,_e.ADD_TAGS,An)),_e.ADD_ATTR&&(z===ne&&(z=wo(z)),mn(z,_e.ADD_ATTR,An)),_e.ADD_URI_SAFE_ATTR&&mn(on,_e.ADD_URI_SAFE_ATTR,An),_e.FORBID_CONTENTS&&(Ue===_t&&(Ue=wo(Ue)),mn(Ue,_e.FORBID_CONTENTS,An)),be&&(Be["#text"]=!0),$e&&mn(Be,["html","head","body"]),Be.table&&(mn(Be,["tbody"]),delete ue.tbody),_e.TRUSTED_TYPES_POLICY){if(typeof _e.TRUSTED_TYPES_POLICY.createHTML!="function")throw fc('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if(typeof _e.TRUSTED_TYPES_POLICY.createScriptURL!="function")throw fc('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');q=_e.TRUSTED_TYPES_POLICY,G=q.createHTML("")}else q===void 0&&(q=wE(S,c)),q!==null&&typeof G=="string"&&(G=q.createHTML(""));ca&&ca(_e),qn=_e}},Vr=mn({},["mi","mo","mn","ms","mtext"]),zn=mn({},["foreignobject","annotation-xml"]),Lr=mn({},["title","style","font","a","script"]),Aa=mn({},[...Ah,...Th,...dE]),En=mn({},[...Ch,...fE]),Dn=function(_e){let st=P(_e);(!st||!st.tagName)&&(st={namespaceURI:Ht,tagName:"template"});const ut=ad(_e.tagName),Rt=ad(st.tagName);return tn[_e.namespaceURI]?_e.namespaceURI===bn?st.namespaceURI===zt?ut==="svg":st.namespaceURI===cn?ut==="svg"&&(Rt==="annotation-xml"||Vr[Rt]):!!Aa[ut]:_e.namespaceURI===cn?st.namespaceURI===zt?ut==="math":st.namespaceURI===bn?ut==="math"&&zn[Rt]:!!En[ut]:_e.namespaceURI===zt?st.namespaceURI===bn&&!zn[Rt]||st.namespaceURI===cn&&!Vr[Rt]?!1:!En[ut]&&(Lr[ut]||!Aa[ut]):!!(At==="application/xhtml+xml"&&tn[_e.namespaceURI]):!1},Cr=function(_e){uc(a.removed,{element:_e});try{_e.parentNode.removeChild(_e)}catch{_e.remove()}},Vn=function(_e,st){try{uc(a.removed,{attribute:st.getAttributeNode(_e),from:st})}catch{uc(a.removed,{attribute:null,from:st})}if(st.removeAttribute(_e),_e==="is"&&!z[_e])if(Ce||re)try{Cr(st)}catch{}else try{st.setAttribute(_e,"")}catch{}},da=function(_e){let st=null,ut=null;if(Ne)_e="<remove></remove>"+_e;else{const Rn=Gy(_e,/^[\r\n\t ]+/);ut=Rn&&Rn[0]}At==="application/xhtml+xml"&&Ht===zt&&(_e='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+_e+"</body></html>");const Rt=q?q.createHTML(_e):_e;if(Ht===zt)try{st=new N().parseFromString(Rt,At)}catch{}if(!st||!st.documentElement){st=Y.createDocument(Ht,"template",null);try{st.documentElement.innerHTML=yt?G:Rt}catch{}}const xn=st.body||st.documentElement;return _e&&ut&&xn.insertBefore(s.createTextNode(ut),xn.childNodes[0]||null),Ht===zt?L.call(st,$e?"html":"body")[0]:$e?st.documentElement:xn},zr=function(_e){return W.call(_e.ownerDocument||_e,_e,m.SHOW_ELEMENT|m.SHOW_COMMENT|m.SHOW_TEXT|m.SHOW_PROCESSING_INSTRUCTION|m.SHOW_CDATA_SECTION,null)},Ms=function(_e){return _e instanceof E&&(typeof _e.__depth<"u"&&typeof _e.__depth!="number"||typeof _e.__removalCount<"u"&&typeof _e.__removalCount!="number"||typeof _e.nodeName!="string"||typeof _e.textContent!="string"||typeof _e.removeChild!="function"||!(_e.attributes instanceof _)||typeof _e.removeAttribute!="function"||typeof _e.setAttribute!="function"||typeof _e.namespaceURI!="string"||typeof _e.insertBefore!="function"||typeof _e.hasChildNodes!="function")},nr=function(_e){return typeof p=="function"&&_e instanceof p},gn=function(_e,st,ut){Q[_e]&&Yu(Q[_e],Rt=>{Rt.call(a,st,ut,qn)})},nn=function(_e){let st=null;if(gn("beforeSanitizeElements",_e,null),Ms(_e))return Cr(_e),!0;const ut=An(_e.nodeName);if(gn("uponSanitizeElement",_e,{tagName:ut,allowedTags:Be}),_e.hasChildNodes()&&!nr(_e.firstElementChild)&&Sa(/<[/\w]/g,_e.innerHTML)&&Sa(/<[/\w]/g,_e.textContent)||_e.nodeType===7||ft&&_e.nodeType===8&&Sa(/<[/\w]/g,_e.data))return Cr(_e),!0;if(!Be[ut]||ue[ut]){if(!ue[ut]&&ms(ut)&&(se.tagNameCheck instanceof RegExp&&Sa(se.tagNameCheck,ut)||se.tagNameCheck instanceof Function&&se.tagNameCheck(ut)))return!1;if(be&&!Ue[ut]){const Rt=P(_e)||_e.parentNode,xn=R(_e)||_e.childNodes;if(xn&&Rt){const Rn=xn.length;for(let $t=Rn-1;$t>=0;--$t){const Zn=A(xn[$t],!0);Zn.__removalCount=(_e.__removalCount||0)+1,Rt.insertBefore(Zn,k(_e))}}}return Cr(_e),!0}return _e instanceof b&&!Dn(_e)||(ut==="noscript"||ut==="noembed"||ut==="noframes")&&Sa(/<\/no(script|embed|frames)/i,_e.innerHTML)?(Cr(_e),!0):(ot&&_e.nodeType===3&&(st=_e.textContent,Yu([le,F,te],Rt=>{st=dc(st,Rt," ")}),_e.textContent!==st&&(uc(a.removed,{element:_e.cloneNode()}),_e.textContent=st)),gn("afterSanitizeElements",_e,null),!1)},Br=function(_e,st,ut){if(me&&(st==="id"||st==="name")&&(ut in s||ut in Tr))return!1;if(!(ye&&!de[st]&&Sa(j,st))){if(!(oe&&Sa(he,st))){if(!z[st]||de[st]){if(!(ms(_e)&&(se.tagNameCheck instanceof RegExp&&Sa(se.tagNameCheck,_e)||se.tagNameCheck instanceof Function&&se.tagNameCheck(_e))&&(se.attributeNameCheck instanceof RegExp&&Sa(se.attributeNameCheck,st)||se.attributeNameCheck instanceof Function&&se.attributeNameCheck(st))||st==="is"&&se.allowCustomizedBuiltInElements&&(se.tagNameCheck instanceof RegExp&&Sa(se.tagNameCheck,ut)||se.tagNameCheck instanceof Function&&se.tagNameCheck(ut))))return!1}else if(!on[st]){if(!Sa(ve,dc(ut,Z,""))){if(!((st==="src"||st==="xlink:href"||st==="href")&&_e!=="script"&&oE(ut,"data:")===0&&It[_e])){if(!(ie&&!Sa(J,dc(ut,Z,"")))){if(ut)return!1}}}}}}return!0},ms=function(_e){return _e!=="annotation-xml"&&Gy(_e,De)},Fr=function(_e){gn("beforeSanitizeAttributes",_e,null);const{attributes:st}=_e;if(!st)return;const ut={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:z};let Rt=st.length;for(;Rt--;){const xn=st[Rt],{name:Rn,namespaceURI:$t,value:Zn}=xn,Hr=An(Rn);let Mn=Rn==="value"?Zn:lE(Zn);if(ut.attrName=Hr,ut.attrValue=Mn,ut.keepAttr=!0,ut.forceKeepAttr=void 0,gn("uponSanitizeAttribute",_e,ut),Mn=ut.attrValue,ut.forceKeepAttr||(Vn(Rn,_e),!ut.keepAttr))continue;if(!We&&Sa(/\/>/i,Mn)){Vn(Rn,_e);continue}ot&&Yu([le,F,te],es=>{Mn=dc(Mn,es," ")});const Xn=An(_e.nodeName);if(Br(Xn,Hr,Mn)){if(Ve&&(Hr==="id"||Hr==="name")&&(Vn(Rn,_e),Mn=Ye+Mn),q&&typeof S=="object"&&typeof S.getAttributeType=="function"&&!$t)switch(S.getAttributeType(Xn,Hr)){case"TrustedHTML":{Mn=q.createHTML(Mn);break}case"TrustedScriptURL":{Mn=q.createScriptURL(Mn);break}}try{$t?_e.setAttributeNS($t,Rn,Mn):_e.setAttribute(Rn,Mn),qy(a.removed)}catch{}}}gn("afterSanitizeAttributes",_e,null)},Us=function St(_e){let st=null;const ut=zr(_e);for(gn("beforeSanitizeShadowDOM",_e,null);st=ut.nextNode();){if(gn("uponSanitizeShadowNode",st,null),nn(st))continue;const Rt=P(st);st.nodeType===1&&(Rt&&Rt.__depth?st.__depth=(st.__removalCount||0)+Rt.__depth+1:st.__depth=1),st.__depth>=vr&&Cr(st),st.content instanceof u&&(st.content.__depth=st.__depth,St(st.content)),Fr(st)}gn("afterSanitizeShadowDOM",_e,null)};return a.sanitize=function(St){let _e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},st=null,ut=null,Rt=null,xn=null;if(yt=!St,yt&&(St="<!-->"),typeof St!="string"&&!nr(St))if(typeof St.toString=="function"){if(St=St.toString(),typeof St!="string")throw fc("dirty is not a string, aborting")}else throw fc("toString is not a function");if(!a.isSupported)return St;if(C||mt(_e),a.removed=[],typeof St=="string"&&(Ze=!1),Ze){if(St.nodeName){const Zn=An(St.nodeName);if(!Be[Zn]||ue[Zn])throw fc("root node is forbidden and cannot be sanitized in-place")}}else if(St instanceof p)st=da("<!---->"),ut=st.ownerDocument.importNode(St,!0),ut.nodeType===1&&ut.nodeName==="BODY"||ut.nodeName==="HTML"?st=ut:st.appendChild(ut);else{if(!Ce&&!ot&&!$e&&St.indexOf("<")===-1)return q&&ee?q.createHTML(St):St;if(st=da(St),!st)return Ce?null:ee?G:""}st&&Ne&&Cr(st.firstChild);const Rn=zr(Ze?St:st);for(;Rt=Rn.nextNode();){if(nn(Rt))continue;const Zn=P(Rt);Rt.nodeType===1&&(Zn&&Zn.__depth?Rt.__depth=(Rt.__removalCount||0)+Zn.__depth+1:Rt.__depth=1),Rt.__depth>=vr&&Cr(Rt),Rt.content instanceof u&&(Rt.content.__depth=Rt.__depth,Us(Rt.content)),Fr(Rt)}if(Ze)return St;if(Ce){if(re)for(xn=H.call(st.ownerDocument);st.firstChild;)xn.appendChild(st.firstChild);else xn=st;return(z.shadowroot||z.shadowrootmode)&&(xn=U.call(i,xn,!0)),xn}let $t=$e?st.outerHTML:st.innerHTML;return $e&&Be["!doctype"]&&st.ownerDocument&&st.ownerDocument.doctype&&st.ownerDocument.doctype.name&&Sa(o0,st.ownerDocument.doctype.name)&&($t="<!DOCTYPE "+st.ownerDocument.doctype.name+`>
`+$t),ot&&Yu([le,F,te],Zn=>{$t=dc($t,Zn," ")}),q&&ee?q.createHTML($t):$t},a.setConfig=function(){let St=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};mt(St),C=!0},a.clearConfig=function(){qn=null,C=!1},a.isValidAttribute=function(St,_e,st){qn||mt({});const ut=An(St),Rt=An(_e);return Br(ut,Rt,st)},a.addHook=function(St,_e){typeof _e=="function"&&(Q[St]=Q[St]||[],uc(Q[St],_e))},a.removeHook=function(St){if(Q[St])return qy(Q[St])},a.removeHooks=function(St){Q[St]&&(Q[St]=[])},a.removeAllHooks=function(){Q={}},a}var SE=l0();const c0=({html:n,className:a,as:s="div"})=>{const i=`html-container-${Yi.useId()}`,c=Yi.useMemo(()=>SE.sanitize(n,{ADD_TAGS:["script","style","iframe","video","audio","source","track","img"],ADD_ATTR:["allow","allowfullscreen","frameborder","scrolling","target","src","data-src","type","controls","autoplay","loop","muted","poster","preload","class","id","style"],FORCE_BODY:!0}),[n]);return Yi.useEffect(()=>{const u=document.getElementById(i);if(!u)return;Array.from(u.getElementsByTagName("img")).forEach(m=>{m.hasAttribute("loading")||m.setAttribute("loading","lazy"),m.hasAttribute("decoding")||m.setAttribute("decoding","async")});const p=Array.from(u.getElementsByTagName("script")),b=[];return p.forEach(m=>{const _=document.createElement("script");Array.from(m.attributes).forEach(E=>{_.setAttribute(E.name,E.value)}),m.text&&!m.src?_.text=`try { ${m.text} } catch (e) { console.error('Error in custom card script:', e); }`:_.text=m.text,document.body.appendChild(_),b.push(_)}),()=>{b.forEach(m=>{document.body.contains(m)&&document.body.removeChild(m)})}},[c,i]),l.jsx(s,{id:i,className:a,dangerouslySetInnerHTML:{__html:c}})};var EE={};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var Qy;(function(n){n.OUTCOME_UNSPECIFIED="OUTCOME_UNSPECIFIED",n.OUTCOME_OK="OUTCOME_OK",n.OUTCOME_FAILED="OUTCOME_FAILED",n.OUTCOME_DEADLINE_EXCEEDED="OUTCOME_DEADLINE_EXCEEDED"})(Qy||(Qy={}));var Jy;(function(n){n.LANGUAGE_UNSPECIFIED="LANGUAGE_UNSPECIFIED",n.PYTHON="PYTHON"})(Jy||(Jy={}));var Xy;(function(n){n.SCHEDULING_UNSPECIFIED="SCHEDULING_UNSPECIFIED",n.SILENT="SILENT",n.WHEN_IDLE="WHEN_IDLE",n.INTERRUPT="INTERRUPT"})(Xy||(Xy={}));var na;(function(n){n.TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",n.STRING="STRING",n.NUMBER="NUMBER",n.INTEGER="INTEGER",n.BOOLEAN="BOOLEAN",n.ARRAY="ARRAY",n.OBJECT="OBJECT",n.NULL="NULL"})(na||(na={}));var Wy;(function(n){n.MODE_UNSPECIFIED="MODE_UNSPECIFIED",n.MODE_DYNAMIC="MODE_DYNAMIC"})(Wy||(Wy={}));var ev;(function(n){n.API_SPEC_UNSPECIFIED="API_SPEC_UNSPECIFIED",n.SIMPLE_SEARCH="SIMPLE_SEARCH",n.ELASTIC_SEARCH="ELASTIC_SEARCH"})(ev||(ev={}));var tv;(function(n){n.AUTH_TYPE_UNSPECIFIED="AUTH_TYPE_UNSPECIFIED",n.NO_AUTH="NO_AUTH",n.API_KEY_AUTH="API_KEY_AUTH",n.HTTP_BASIC_AUTH="HTTP_BASIC_AUTH",n.GOOGLE_SERVICE_ACCOUNT_AUTH="GOOGLE_SERVICE_ACCOUNT_AUTH",n.OAUTH="OAUTH",n.OIDC_AUTH="OIDC_AUTH"})(tv||(tv={}));var nv;(function(n){n.HTTP_IN_UNSPECIFIED="HTTP_IN_UNSPECIFIED",n.HTTP_IN_QUERY="HTTP_IN_QUERY",n.HTTP_IN_HEADER="HTTP_IN_HEADER",n.HTTP_IN_PATH="HTTP_IN_PATH",n.HTTP_IN_BODY="HTTP_IN_BODY",n.HTTP_IN_COOKIE="HTTP_IN_COOKIE"})(nv||(nv={}));var rv;(function(n){n.PHISH_BLOCK_THRESHOLD_UNSPECIFIED="PHISH_BLOCK_THRESHOLD_UNSPECIFIED",n.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",n.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",n.BLOCK_HIGH_AND_ABOVE="BLOCK_HIGH_AND_ABOVE",n.BLOCK_HIGHER_AND_ABOVE="BLOCK_HIGHER_AND_ABOVE",n.BLOCK_VERY_HIGH_AND_ABOVE="BLOCK_VERY_HIGH_AND_ABOVE",n.BLOCK_ONLY_EXTREMELY_HIGH="BLOCK_ONLY_EXTREMELY_HIGH"})(rv||(rv={}));var av;(function(n){n.THINKING_LEVEL_UNSPECIFIED="THINKING_LEVEL_UNSPECIFIED",n.LOW="LOW",n.MEDIUM="MEDIUM",n.HIGH="HIGH",n.MINIMAL="MINIMAL"})(av||(av={}));var sv;(function(n){n.HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",n.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",n.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",n.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",n.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",n.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY",n.HARM_CATEGORY_IMAGE_HATE="HARM_CATEGORY_IMAGE_HATE",n.HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT="HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT",n.HARM_CATEGORY_IMAGE_HARASSMENT="HARM_CATEGORY_IMAGE_HARASSMENT",n.HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT="HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT",n.HARM_CATEGORY_JAILBREAK="HARM_CATEGORY_JAILBREAK"})(sv||(sv={}));var iv;(function(n){n.HARM_BLOCK_METHOD_UNSPECIFIED="HARM_BLOCK_METHOD_UNSPECIFIED",n.SEVERITY="SEVERITY",n.PROBABILITY="PROBABILITY"})(iv||(iv={}));var ov;(function(n){n.HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",n.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",n.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",n.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",n.BLOCK_NONE="BLOCK_NONE",n.OFF="OFF"})(ov||(ov={}));var lv;(function(n){n.FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",n.STOP="STOP",n.MAX_TOKENS="MAX_TOKENS",n.SAFETY="SAFETY",n.RECITATION="RECITATION",n.LANGUAGE="LANGUAGE",n.OTHER="OTHER",n.BLOCKLIST="BLOCKLIST",n.PROHIBITED_CONTENT="PROHIBITED_CONTENT",n.SPII="SPII",n.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",n.IMAGE_SAFETY="IMAGE_SAFETY",n.UNEXPECTED_TOOL_CALL="UNEXPECTED_TOOL_CALL",n.IMAGE_PROHIBITED_CONTENT="IMAGE_PROHIBITED_CONTENT",n.NO_IMAGE="NO_IMAGE",n.IMAGE_RECITATION="IMAGE_RECITATION",n.IMAGE_OTHER="IMAGE_OTHER"})(lv||(lv={}));var cv;(function(n){n.HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",n.NEGLIGIBLE="NEGLIGIBLE",n.LOW="LOW",n.MEDIUM="MEDIUM",n.HIGH="HIGH"})(cv||(cv={}));var uv;(function(n){n.HARM_SEVERITY_UNSPECIFIED="HARM_SEVERITY_UNSPECIFIED",n.HARM_SEVERITY_NEGLIGIBLE="HARM_SEVERITY_NEGLIGIBLE",n.HARM_SEVERITY_LOW="HARM_SEVERITY_LOW",n.HARM_SEVERITY_MEDIUM="HARM_SEVERITY_MEDIUM",n.HARM_SEVERITY_HIGH="HARM_SEVERITY_HIGH"})(uv||(uv={}));var dv;(function(n){n.URL_RETRIEVAL_STATUS_UNSPECIFIED="URL_RETRIEVAL_STATUS_UNSPECIFIED",n.URL_RETRIEVAL_STATUS_SUCCESS="URL_RETRIEVAL_STATUS_SUCCESS",n.URL_RETRIEVAL_STATUS_ERROR="URL_RETRIEVAL_STATUS_ERROR",n.URL_RETRIEVAL_STATUS_PAYWALL="URL_RETRIEVAL_STATUS_PAYWALL",n.URL_RETRIEVAL_STATUS_UNSAFE="URL_RETRIEVAL_STATUS_UNSAFE"})(dv||(dv={}));var fv;(function(n){n.BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",n.SAFETY="SAFETY",n.OTHER="OTHER",n.BLOCKLIST="BLOCKLIST",n.PROHIBITED_CONTENT="PROHIBITED_CONTENT",n.IMAGE_SAFETY="IMAGE_SAFETY",n.MODEL_ARMOR="MODEL_ARMOR",n.JAILBREAK="JAILBREAK"})(fv||(fv={}));var hv;(function(n){n.TRAFFIC_TYPE_UNSPECIFIED="TRAFFIC_TYPE_UNSPECIFIED",n.ON_DEMAND="ON_DEMAND",n.PROVISIONED_THROUGHPUT="PROVISIONED_THROUGHPUT"})(hv||(hv={}));var Qh;(function(n){n.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",n.TEXT="TEXT",n.IMAGE="IMAGE",n.AUDIO="AUDIO"})(Qh||(Qh={}));var pv;(function(n){n.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",n.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",n.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",n.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH"})(pv||(pv={}));var mv;(function(n){n.TUNING_MODE_UNSPECIFIED="TUNING_MODE_UNSPECIFIED",n.TUNING_MODE_FULL="TUNING_MODE_FULL",n.TUNING_MODE_PEFT_ADAPTER="TUNING_MODE_PEFT_ADAPTER"})(mv||(mv={}));var gv;(function(n){n.ADAPTER_SIZE_UNSPECIFIED="ADAPTER_SIZE_UNSPECIFIED",n.ADAPTER_SIZE_ONE="ADAPTER_SIZE_ONE",n.ADAPTER_SIZE_TWO="ADAPTER_SIZE_TWO",n.ADAPTER_SIZE_FOUR="ADAPTER_SIZE_FOUR",n.ADAPTER_SIZE_EIGHT="ADAPTER_SIZE_EIGHT",n.ADAPTER_SIZE_SIXTEEN="ADAPTER_SIZE_SIXTEEN",n.ADAPTER_SIZE_THIRTY_TWO="ADAPTER_SIZE_THIRTY_TWO"})(gv||(gv={}));var yv;(function(n){n.JOB_STATE_UNSPECIFIED="JOB_STATE_UNSPECIFIED",n.JOB_STATE_QUEUED="JOB_STATE_QUEUED",n.JOB_STATE_PENDING="JOB_STATE_PENDING",n.JOB_STATE_RUNNING="JOB_STATE_RUNNING",n.JOB_STATE_SUCCEEDED="JOB_STATE_SUCCEEDED",n.JOB_STATE_FAILED="JOB_STATE_FAILED",n.JOB_STATE_CANCELLING="JOB_STATE_CANCELLING",n.JOB_STATE_CANCELLED="JOB_STATE_CANCELLED",n.JOB_STATE_PAUSED="JOB_STATE_PAUSED",n.JOB_STATE_EXPIRED="JOB_STATE_EXPIRED",n.JOB_STATE_UPDATING="JOB_STATE_UPDATING",n.JOB_STATE_PARTIALLY_SUCCEEDED="JOB_STATE_PARTIALLY_SUCCEEDED"})(yv||(yv={}));var vv;(function(n){n.TUNING_TASK_UNSPECIFIED="TUNING_TASK_UNSPECIFIED",n.TUNING_TASK_I2V="TUNING_TASK_I2V",n.TUNING_TASK_T2V="TUNING_TASK_T2V",n.TUNING_TASK_R2V="TUNING_TASK_R2V"})(vv||(vv={}));var bv;(function(n){n.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",n.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",n.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",n.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH",n.MEDIA_RESOLUTION_ULTRA_HIGH="MEDIA_RESOLUTION_ULTRA_HIGH"})(bv||(bv={}));var xv;(function(n){n.FEATURE_SELECTION_PREFERENCE_UNSPECIFIED="FEATURE_SELECTION_PREFERENCE_UNSPECIFIED",n.PRIORITIZE_QUALITY="PRIORITIZE_QUALITY",n.BALANCED="BALANCED",n.PRIORITIZE_COST="PRIORITIZE_COST"})(xv||(xv={}));var _v;(function(n){n.UNSPECIFIED="UNSPECIFIED",n.BLOCKING="BLOCKING",n.NON_BLOCKING="NON_BLOCKING"})(_v||(_v={}));var wv;(function(n){n.MODE_UNSPECIFIED="MODE_UNSPECIFIED",n.MODE_DYNAMIC="MODE_DYNAMIC"})(wv||(wv={}));var Sv;(function(n){n.ENVIRONMENT_UNSPECIFIED="ENVIRONMENT_UNSPECIFIED",n.ENVIRONMENT_BROWSER="ENVIRONMENT_BROWSER"})(Sv||(Sv={}));var Ev;(function(n){n.MODE_UNSPECIFIED="MODE_UNSPECIFIED",n.AUTO="AUTO",n.ANY="ANY",n.NONE="NONE",n.VALIDATED="VALIDATED"})(Ev||(Ev={}));var kv;(function(n){n.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",n.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",n.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",n.BLOCK_NONE="BLOCK_NONE"})(kv||(kv={}));var Av;(function(n){n.DONT_ALLOW="DONT_ALLOW",n.ALLOW_ADULT="ALLOW_ADULT",n.ALLOW_ALL="ALLOW_ALL"})(Av||(Av={}));var Tv;(function(n){n.auto="auto",n.en="en",n.ja="ja",n.ko="ko",n.hi="hi",n.zh="zh",n.pt="pt",n.es="es"})(Tv||(Tv={}));var Cv;(function(n){n.MASK_MODE_DEFAULT="MASK_MODE_DEFAULT",n.MASK_MODE_USER_PROVIDED="MASK_MODE_USER_PROVIDED",n.MASK_MODE_BACKGROUND="MASK_MODE_BACKGROUND",n.MASK_MODE_FOREGROUND="MASK_MODE_FOREGROUND",n.MASK_MODE_SEMANTIC="MASK_MODE_SEMANTIC"})(Cv||(Cv={}));var Nv;(function(n){n.CONTROL_TYPE_DEFAULT="CONTROL_TYPE_DEFAULT",n.CONTROL_TYPE_CANNY="CONTROL_TYPE_CANNY",n.CONTROL_TYPE_SCRIBBLE="CONTROL_TYPE_SCRIBBLE",n.CONTROL_TYPE_FACE_MESH="CONTROL_TYPE_FACE_MESH"})(Nv||(Nv={}));var Dv;(function(n){n.SUBJECT_TYPE_DEFAULT="SUBJECT_TYPE_DEFAULT",n.SUBJECT_TYPE_PERSON="SUBJECT_TYPE_PERSON",n.SUBJECT_TYPE_ANIMAL="SUBJECT_TYPE_ANIMAL",n.SUBJECT_TYPE_PRODUCT="SUBJECT_TYPE_PRODUCT"})(Dv||(Dv={}));var Ov;(function(n){n.EDIT_MODE_DEFAULT="EDIT_MODE_DEFAULT",n.EDIT_MODE_INPAINT_REMOVAL="EDIT_MODE_INPAINT_REMOVAL",n.EDIT_MODE_INPAINT_INSERTION="EDIT_MODE_INPAINT_INSERTION",n.EDIT_MODE_OUTPAINT="EDIT_MODE_OUTPAINT",n.EDIT_MODE_CONTROLLED_EDITING="EDIT_MODE_CONTROLLED_EDITING",n.EDIT_MODE_STYLE="EDIT_MODE_STYLE",n.EDIT_MODE_BGSWAP="EDIT_MODE_BGSWAP",n.EDIT_MODE_PRODUCT_IMAGE="EDIT_MODE_PRODUCT_IMAGE"})(Ov||(Ov={}));var jv;(function(n){n.FOREGROUND="FOREGROUND",n.BACKGROUND="BACKGROUND",n.PROMPT="PROMPT",n.SEMANTIC="SEMANTIC",n.INTERACTIVE="INTERACTIVE"})(jv||(jv={}));var Iv;(function(n){n.ASSET="ASSET",n.STYLE="STYLE"})(Iv||(Iv={}));var Rv;(function(n){n.INSERT="INSERT",n.REMOVE="REMOVE",n.REMOVE_STATIC="REMOVE_STATIC",n.OUTPAINT="OUTPAINT"})(Rv||(Rv={}));var Mv;(function(n){n.OPTIMIZED="OPTIMIZED",n.LOSSLESS="LOSSLESS"})(Mv||(Mv={}));var Uv;(function(n){n.SUPERVISED_FINE_TUNING="SUPERVISED_FINE_TUNING",n.PREFERENCE_TUNING="PREFERENCE_TUNING"})(Uv||(Uv={}));var Lv;(function(n){n.STATE_UNSPECIFIED="STATE_UNSPECIFIED",n.STATE_PENDING="STATE_PENDING",n.STATE_ACTIVE="STATE_ACTIVE",n.STATE_FAILED="STATE_FAILED"})(Lv||(Lv={}));var zv;(function(n){n.STATE_UNSPECIFIED="STATE_UNSPECIFIED",n.PROCESSING="PROCESSING",n.ACTIVE="ACTIVE",n.FAILED="FAILED"})(zv||(zv={}));var Bv;(function(n){n.SOURCE_UNSPECIFIED="SOURCE_UNSPECIFIED",n.UPLOADED="UPLOADED",n.GENERATED="GENERATED"})(Bv||(Bv={}));var Fv;(function(n){n.TURN_COMPLETE_REASON_UNSPECIFIED="TURN_COMPLETE_REASON_UNSPECIFIED",n.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",n.RESPONSE_REJECTED="RESPONSE_REJECTED",n.NEED_MORE_INPUT="NEED_MORE_INPUT"})(Fv||(Fv={}));var Hv;(function(n){n.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",n.TEXT="TEXT",n.IMAGE="IMAGE",n.VIDEO="VIDEO",n.AUDIO="AUDIO",n.DOCUMENT="DOCUMENT"})(Hv||(Hv={}));var Pv;(function(n){n.VAD_SIGNAL_TYPE_UNSPECIFIED="VAD_SIGNAL_TYPE_UNSPECIFIED",n.VAD_SIGNAL_TYPE_SOS="VAD_SIGNAL_TYPE_SOS",n.VAD_SIGNAL_TYPE_EOS="VAD_SIGNAL_TYPE_EOS"})(Pv||(Pv={}));var qv;(function(n){n.START_SENSITIVITY_UNSPECIFIED="START_SENSITIVITY_UNSPECIFIED",n.START_SENSITIVITY_HIGH="START_SENSITIVITY_HIGH",n.START_SENSITIVITY_LOW="START_SENSITIVITY_LOW"})(qv||(qv={}));var Gv;(function(n){n.END_SENSITIVITY_UNSPECIFIED="END_SENSITIVITY_UNSPECIFIED",n.END_SENSITIVITY_HIGH="END_SENSITIVITY_HIGH",n.END_SENSITIVITY_LOW="END_SENSITIVITY_LOW"})(Gv||(Gv={}));var Kv;(function(n){n.ACTIVITY_HANDLING_UNSPECIFIED="ACTIVITY_HANDLING_UNSPECIFIED",n.START_OF_ACTIVITY_INTERRUPTS="START_OF_ACTIVITY_INTERRUPTS",n.NO_INTERRUPTION="NO_INTERRUPTION"})(Kv||(Kv={}));var Yv;(function(n){n.TURN_COVERAGE_UNSPECIFIED="TURN_COVERAGE_UNSPECIFIED",n.TURN_INCLUDES_ONLY_ACTIVITY="TURN_INCLUDES_ONLY_ACTIVITY",n.TURN_INCLUDES_ALL_INPUT="TURN_INCLUDES_ALL_INPUT"})(Yv||(Yv={}));var $v;(function(n){n.SCALE_UNSPECIFIED="SCALE_UNSPECIFIED",n.C_MAJOR_A_MINOR="C_MAJOR_A_MINOR",n.D_FLAT_MAJOR_B_FLAT_MINOR="D_FLAT_MAJOR_B_FLAT_MINOR",n.D_MAJOR_B_MINOR="D_MAJOR_B_MINOR",n.E_FLAT_MAJOR_C_MINOR="E_FLAT_MAJOR_C_MINOR",n.E_MAJOR_D_FLAT_MINOR="E_MAJOR_D_FLAT_MINOR",n.F_MAJOR_D_MINOR="F_MAJOR_D_MINOR",n.G_FLAT_MAJOR_E_FLAT_MINOR="G_FLAT_MAJOR_E_FLAT_MINOR",n.G_MAJOR_E_MINOR="G_MAJOR_E_MINOR",n.A_FLAT_MAJOR_F_MINOR="A_FLAT_MAJOR_F_MINOR",n.A_MAJOR_G_FLAT_MINOR="A_MAJOR_G_FLAT_MINOR",n.B_FLAT_MAJOR_G_MINOR="B_FLAT_MAJOR_G_MINOR",n.B_MAJOR_A_FLAT_MINOR="B_MAJOR_A_FLAT_MINOR"})($v||($v={}));var Vv;(function(n){n.MUSIC_GENERATION_MODE_UNSPECIFIED="MUSIC_GENERATION_MODE_UNSPECIFIED",n.QUALITY="QUALITY",n.DIVERSITY="DIVERSITY",n.VOCALIZATION="VOCALIZATION"})(Vv||(Vv={}));var Zv;(function(n){n.PLAYBACK_CONTROL_UNSPECIFIED="PLAYBACK_CONTROL_UNSPECIFIED",n.PLAY="PLAY",n.PAUSE="PAUSE",n.STOP="STOP",n.RESET_CONTEXT="RESET_CONTEXT"})(Zv||(Zv={}));/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var Qv;(function(n){n.PAGED_ITEM_BATCH_JOBS="batchJobs",n.PAGED_ITEM_MODELS="models",n.PAGED_ITEM_TUNING_JOBS="tuningJobs",n.PAGED_ITEM_FILES="files",n.PAGED_ITEM_CACHED_CONTENTS="cachedContents",n.PAGED_ITEM_FILE_SEARCH_STORES="fileSearchStores",n.PAGED_ITEM_DOCUMENTS="documents"})(Qv||(Qv={}));function gd(n,a){var s={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&a.indexOf(i)<0&&(s[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var c=0,i=Object.getOwnPropertySymbols(n);c<i.length;c++)a.indexOf(i[c])<0&&Object.prototype.propertyIsEnumerable.call(n,i[c])&&(s[i[c]]=n[i[c]]);return s}function Jv(n){var a=typeof Symbol=="function"&&Symbol.iterator,s=a&&n[a],i=0;if(s)return s.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&i>=n.length&&(n=void 0),{value:n&&n[i++],done:!n}}};throw new TypeError(a?"Object is not iterable.":"Symbol.iterator is not defined.")}function sr(n){return this instanceof sr?(this.v=n,this):new sr(n)}function _c(n,a,s){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i=s.apply(n,a||[]),c,u=[];return c=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),p("next"),p("throw"),p("return",f),c[Symbol.asyncIterator]=function(){return this},c;function f(S){return function(I){return Promise.resolve(I).then(S,E)}}function p(S,I){i[S]&&(c[S]=function(A){return new Promise(function(k,R){u.push([S,A,k,R])>1||b(S,A)})},I&&(c[S]=I(c[S])))}function b(S,I){try{m(i[S](I))}catch(A){N(u[0][3],A)}}function m(S){S.value instanceof sr?Promise.resolve(S.value.v).then(_,E):N(u[0][2],S)}function _(S){b("next",S)}function E(S){b("throw",S)}function N(S,I){S(I),u.shift(),u.length&&b(u[0][0],u[0][1])}}function gl(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var a=n[Symbol.asyncIterator],s;return a?a.call(n):(n=typeof Jv=="function"?Jv(n):n[Symbol.iterator](),s={},i("next"),i("throw"),i("return"),s[Symbol.asyncIterator]=function(){return this},s);function i(u){s[u]=n[u]&&function(f){return new Promise(function(p,b){f=n[u](f),c(p,b,f.done,f.value)})}}function c(u,f,p,b){Promise.resolve(b).then(function(m){u({value:m,done:p})},f)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */let u0=function(){const{crypto:n}=globalThis;if(n!=null&&n.randomUUID)return u0=n.randomUUID.bind(n),n.randomUUID();const a=new Uint8Array(1),s=n?()=>n.getRandomValues(a)[0]:()=>Math.random()*255&255;return"10000000-1000-4000-8000-100000000000".replace(/[018]/g,i=>(+i^s()&15>>+i/4).toString(16))};const kE=()=>u0();/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Jh(n){return typeof n=="object"&&n!==null&&("name"in n&&n.name==="AbortError"||"message"in n&&String(n.message).includes("FetchRequestCanceledException"))}const Xh=n=>{if(n instanceof Error)return n;if(typeof n=="object"&&n!==null){try{if(Object.prototype.toString.call(n)==="[object Error]"){const a=new Error(n.message,n.cause?{cause:n.cause}:{});return n.stack&&(a.stack=n.stack),n.cause&&!a.cause&&(a.cause=n.cause),n.name&&(a.name=n.name),a}}catch{}try{return new Error(JSON.stringify(n))}catch{}}return new Error(n)};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Wa extends Error{}class ua extends Wa{constructor(a,s,i,c){super(`${ua.makeMessage(a,s,i)}`),this.status=a,this.headers=c,this.error=s}static makeMessage(a,s,i){const c=s!=null&&s.message?typeof s.message=="string"?s.message:JSON.stringify(s.message):s?JSON.stringify(s):i;return a&&c?`${a} ${c}`:a?`${a} status code (no body)`:c||"(no status code or body)"}static generate(a,s,i,c){if(!a||!c)return new _d({message:i,cause:Xh(s)});const u=s;return a===400?new f0(a,u,i,c):a===401?new h0(a,u,i,c):a===403?new p0(a,u,i,c):a===404?new m0(a,u,i,c):a===409?new g0(a,u,i,c):a===422?new y0(a,u,i,c):a===429?new v0(a,u,i,c):a>=500?new b0(a,u,i,c):new ua(a,u,i,c)}}class Wh extends ua{constructor({message:a}={}){super(void 0,void 0,a||"Request was aborted.",void 0)}}class _d extends ua{constructor({message:a,cause:s}){super(void 0,void 0,a||"Connection error.",void 0),s&&(this.cause=s)}}class d0 extends _d{constructor({message:a}={}){super({message:a??"Request timed out."})}}class f0 extends ua{}class h0 extends ua{}class p0 extends ua{}class m0 extends ua{}class g0 extends ua{}class y0 extends ua{}class v0 extends ua{}class b0 extends ua{}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const AE=/^[a-z][a-z0-9+.-]*:/i,TE=n=>AE.test(n);let ep=n=>(ep=Array.isArray,ep(n));const CE=ep;let NE=CE;const Xv=NE;function DE(n){if(!n)return!0;for(const a in n)return!1;return!0}function OE(n,a){return Object.prototype.hasOwnProperty.call(n,a)}const jE=(n,a)=>{if(typeof a!="number"||!Number.isInteger(a))throw new Wa(`${n} must be an integer`);if(a<0)throw new Wa(`${n} must be a positive integer`);return a},IE=n=>{try{return JSON.parse(n)}catch{return}};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const RE=n=>new Promise(a=>setTimeout(a,n));/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const dl="0.0.1";/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function ME(){return typeof Deno<"u"&&Deno.build!=null?"deno":typeof EdgeRuntime<"u"?"edge":Object.prototype.toString.call(typeof globalThis.process<"u"?globalThis.process:0)==="[object process]"?"node":"unknown"}const UE=()=>{var n,a,s,i,c;const u=ME();if(u==="deno")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":dl,"X-Stainless-OS":eb(Deno.build.os),"X-Stainless-Arch":Wv(Deno.build.arch),"X-Stainless-Runtime":"deno","X-Stainless-Runtime-Version":typeof Deno.version=="string"?Deno.version:(a=(n=Deno.version)===null||n===void 0?void 0:n.deno)!==null&&a!==void 0?a:"unknown"};if(typeof EdgeRuntime<"u")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":dl,"X-Stainless-OS":"Unknown","X-Stainless-Arch":`other:${EdgeRuntime}`,"X-Stainless-Runtime":"edge","X-Stainless-Runtime-Version":globalThis.process.version};if(u==="node")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":dl,"X-Stainless-OS":eb((s=globalThis.process.platform)!==null&&s!==void 0?s:"unknown"),"X-Stainless-Arch":Wv((i=globalThis.process.arch)!==null&&i!==void 0?i:"unknown"),"X-Stainless-Runtime":"node","X-Stainless-Runtime-Version":(c=globalThis.process.version)!==null&&c!==void 0?c:"unknown"};const f=LE();return f?{"X-Stainless-Lang":"js","X-Stainless-Package-Version":dl,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":`browser:${f.browser}`,"X-Stainless-Runtime-Version":f.version}:{"X-Stainless-Lang":"js","X-Stainless-Package-Version":dl,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":"unknown","X-Stainless-Runtime-Version":"unknown"}};function LE(){if(typeof navigator>"u"||!navigator)return null;const n=[{key:"edge",pattern:/Edge(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/MSIE(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/Trident(?:.*rv\:(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"chrome",pattern:/Chrome(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"firefox",pattern:/Firefox(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"safari",pattern:/(?:Version\W+(\d+)\.(\d+)(?:\.(\d+))?)?(?:\W+Mobile\S*)?\W+Safari/}];for(const{key:a,pattern:s}of n){const i=s.exec(navigator.userAgent);if(i){const c=i[1]||0,u=i[2]||0,f=i[3]||0;return{browser:a,version:`${c}.${u}.${f}`}}}return null}const Wv=n=>n==="x32"?"x32":n==="x86_64"||n==="x64"?"x64":n==="arm"?"arm":n==="aarch64"||n==="arm64"?"arm64":n?`other:${n}`:"unknown",eb=n=>(n=n.toLowerCase(),n.includes("ios")?"iOS":n==="android"?"Android":n==="darwin"?"MacOS":n==="win32"?"Windows":n==="freebsd"?"FreeBSD":n==="openbsd"?"OpenBSD":n==="linux"?"Linux":n?`Other:${n}`:"Unknown");let Zu;const zE=()=>Zu??(Zu=UE());/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function BE(){if(typeof fetch<"u")return fetch;throw new Error("`fetch` is not defined as a global; Either pass `fetch` to the client, `new GeminiNextGenAPIClient({ fetch })` or polyfill the global, `globalThis.fetch = fetch`")}function x0(...n){const a=globalThis.ReadableStream;if(typeof a>"u")throw new Error("`ReadableStream` is not defined as a global; You will need to polyfill it, `globalThis.ReadableStream = ReadableStream`");return new a(...n)}function FE(n){let a=Symbol.asyncIterator in n?n[Symbol.asyncIterator]():n[Symbol.iterator]();return x0({start(){},async pull(s){const{done:i,value:c}=await a.next();i?s.close():s.enqueue(c)},async cancel(){var s;await((s=a.return)===null||s===void 0?void 0:s.call(a))}})}function _0(n){if(n[Symbol.asyncIterator])return n;const a=n.getReader();return{async next(){try{const s=await a.read();return s!=null&&s.done&&a.releaseLock(),s}catch(s){throw a.releaseLock(),s}},async return(){const s=a.cancel();return a.releaseLock(),await s,{done:!0,value:void 0}},[Symbol.asyncIterator](){return this}}}async function HE(n){var a,s;if(n===null||typeof n!="object")return;if(n[Symbol.asyncIterator]){await((s=(a=n[Symbol.asyncIterator]()).return)===null||s===void 0?void 0:s.call(a));return}const i=n.getReader(),c=i.cancel();i.releaseLock(),await c}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const PE=({headers:n,body:a})=>({bodyHeaders:{"content-type":"application/json"},body:JSON.stringify(a)});/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const w0=()=>{var n;if(typeof File>"u"){const{process:a}=globalThis,s=typeof((n=a==null?void 0:a.versions)===null||n===void 0?void 0:n.node)=="string"&&parseInt(a.versions.node.split("."))<20;throw new Error("`File` is not defined as a global, which is required for file uploads."+(s?" Update to Node 20 LTS or newer, or set `globalThis.File` to `import('node:buffer').File`.":""))}};function Dh(n,a,s){return w0(),new File(n,a??"unknown_file",s)}function qE(n){return(typeof n=="object"&&n!==null&&("name"in n&&n.name&&String(n.name)||"url"in n&&n.url&&String(n.url)||"filename"in n&&n.filename&&String(n.filename)||"path"in n&&n.path&&String(n.path))||"").split(/[\\/]/).pop()||void 0}const GE=n=>n!=null&&typeof n=="object"&&typeof n[Symbol.asyncIterator]=="function";/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const S0=n=>n!=null&&typeof n=="object"&&typeof n.size=="number"&&typeof n.type=="string"&&typeof n.text=="function"&&typeof n.slice=="function"&&typeof n.arrayBuffer=="function",KE=n=>n!=null&&typeof n=="object"&&typeof n.name=="string"&&typeof n.lastModified=="number"&&S0(n),YE=n=>n!=null&&typeof n=="object"&&typeof n.url=="string"&&typeof n.blob=="function";async function $E(n,a,s){if(w0(),n=await n,KE(n))return n instanceof File?n:Dh([await n.arrayBuffer()],n.name);if(YE(n)){const c=await n.blob();return a||(a=new URL(n.url).pathname.split(/[\\/]/).pop()),Dh(await tp(c),a,s)}const i=await tp(n);if(a||(a=qE(n)),!(s!=null&&s.type)){const c=i.find(u=>typeof u=="object"&&"type"in u&&u.type);typeof c=="string"&&(s=Object.assign(Object.assign({},s),{type:c}))}return Dh(i,a,s)}async function tp(n){var a,s,i,c,u;let f=[];if(typeof n=="string"||ArrayBuffer.isView(n)||n instanceof ArrayBuffer)f.push(n);else if(S0(n))f.push(n instanceof Blob?n:await n.arrayBuffer());else if(GE(n))try{for(var p=!0,b=gl(n),m;m=await b.next(),a=m.done,!a;p=!0){c=m.value,p=!1;const _=c;f.push(...await tp(_))}}catch(_){s={error:_}}finally{try{!p&&!a&&(i=b.return)&&await i.call(b)}finally{if(s)throw s.error}}else{const _=(u=n==null?void 0:n.constructor)===null||u===void 0?void 0:u.name;throw new Error(`Unexpected data type: ${typeof n}${_?`; constructor: ${_}`:""}${VE(n)}`)}return f}function VE(n){return typeof n!="object"||n===null?"":`; props: [${Object.getOwnPropertyNames(n).map(s=>`"${s}"`).join(", ")}]`}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class E0{constructor(a){this._client=a}}E0._key=[];/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function k0(n){return n.replace(/[^A-Za-z0-9\-._~!$&'()*+,;=:@]+/g,encodeURIComponent)}const tb=Object.freeze(Object.create(null)),ZE=(n=k0)=>(function(s,...i){if(s.length===1)return s[0];let c=!1;const u=[],f=s.reduce((_,E,N)=>{var S,I,A;/[?#]/.test(E)&&(c=!0);const k=i[N];let R=(c?encodeURIComponent:n)(""+k);return N!==i.length&&(k==null||typeof k=="object"&&k.toString===((A=Object.getPrototypeOf((I=Object.getPrototypeOf((S=k.hasOwnProperty)!==null&&S!==void 0?S:tb))!==null&&I!==void 0?I:tb))===null||A===void 0?void 0:A.toString))&&(R=k+"",u.push({start:_.length+E.length,length:R.length,error:`Value of type ${Object.prototype.toString.call(k).slice(8,-1)} is not a valid path parameter`})),_+E+(N===i.length?"":R)},""),p=f.split(/[?#]/,1)[0],b=new RegExp("(?<=^|\\/)(?:\\.|%2e){1,2}(?=\\/|$)","gi");let m;for(;(m=b.exec(p))!==null;)u.push({start:m.index,length:m[0].length,error:`Value "${m[0]}" can't be safely passed as a path parameter`});if(u.sort((_,E)=>_.start-E.start),u.length>0){let _=0;const E=u.reduce((N,S)=>{const I=" ".repeat(S.start-_),A="^".repeat(S.length);return _=S.start+S.length,N+I+A},"");throw new Wa(`Path parameters result in path with invalid segments:
${u.map(N=>N.error).join(`
`)}
${f}
${E}`)}return f}),Qu=ZE(k0);/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class A0 extends E0{create(a,s){var i;const{api_version:c=this._client.apiVersion}=a,u=gd(a,["api_version"]);if("model"in u&&"agent_config"in u)throw new Wa("Invalid request: specified `model` and `agent_config`. If specifying `model`, use `generation_config`.");if("agent"in u&&"generation_config"in u)throw new Wa("Invalid request: specified `agent` and `generation_config`. If specifying `agent`, use `agent_config`.");return this._client.post(Qu`/${c}/interactions`,Object.assign(Object.assign({body:u},s),{stream:(i=a.stream)!==null&&i!==void 0?i:!1}))}delete(a,s={},i){const{api_version:c=this._client.apiVersion}=s??{};return this._client.delete(Qu`/${c}/interactions/${a}`,i)}cancel(a,s={},i){const{api_version:c=this._client.apiVersion}=s??{};return this._client.post(Qu`/${c}/interactions/${a}/cancel`,i)}get(a,s={},i){var c;const u=s??{},{api_version:f=this._client.apiVersion}=u,p=gd(u,["api_version"]);return this._client.get(Qu`/${f}/interactions/${a}`,Object.assign(Object.assign({query:p},i),{stream:(c=s==null?void 0:s.stream)!==null&&c!==void 0?c:!1}))}}A0._key=Object.freeze(["interactions"]);class T0 extends A0{}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function QE(n){let a=0;for(const c of n)a+=c.length;const s=new Uint8Array(a);let i=0;for(const c of n)s.set(c,i),i+=c.length;return s}let Ju;function dp(n){let a;return(Ju??(a=new globalThis.TextEncoder,Ju=a.encode.bind(a)))(n)}let Xu;function nb(n){let a;return(Xu??(a=new globalThis.TextDecoder,Xu=a.decode.bind(a)))(n)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class wd{constructor(){this.buffer=new Uint8Array,this.carriageReturnIndex=null}decode(a){if(a==null)return[];const s=a instanceof ArrayBuffer?new Uint8Array(a):typeof a=="string"?dp(a):a;this.buffer=QE([this.buffer,s]);const i=[];let c;for(;(c=JE(this.buffer,this.carriageReturnIndex))!=null;){if(c.carriage&&this.carriageReturnIndex==null){this.carriageReturnIndex=c.index;continue}if(this.carriageReturnIndex!=null&&(c.index!==this.carriageReturnIndex+1||c.carriage)){i.push(nb(this.buffer.subarray(0,this.carriageReturnIndex-1))),this.buffer=this.buffer.subarray(this.carriageReturnIndex),this.carriageReturnIndex=null;continue}const u=this.carriageReturnIndex!==null?c.preceding-1:c.preceding,f=nb(this.buffer.subarray(0,u));i.push(f),this.buffer=this.buffer.subarray(c.index),this.carriageReturnIndex=null}return i}flush(){return this.buffer.length?this.decode(`
`):[]}}wd.NEWLINE_CHARS=new Set([`
`,"\r"]);wd.NEWLINE_REGEXP=/\r\n|[\n\r]/g;function JE(n,a){for(let c=a??0;c<n.length;c++){if(n[c]===10)return{preceding:c,index:c+1,carriage:!1};if(n[c]===13)return{preceding:c,index:c+1,carriage:!0}}return null}function XE(n){for(let i=0;i<n.length-1;i++){if(n[i]===10&&n[i+1]===10||n[i]===13&&n[i+1]===13)return i+2;if(n[i]===13&&n[i+1]===10&&i+3<n.length&&n[i+2]===13&&n[i+3]===10)return i+4}return-1}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const yd={off:0,error:200,warn:300,info:400,debug:500},rb=(n,a,s)=>{if(n){if(OE(yd,n))return n;oa(s).warn(`${a} was set to ${JSON.stringify(n)}, expected one of ${JSON.stringify(Object.keys(yd))}`)}};function bc(){}function Wu(n,a,s){return!a||yd[n]>yd[s]?bc:a[n].bind(a)}const WE={error:bc,warn:bc,info:bc,debug:bc};let ab=new WeakMap;function oa(n){var a;const s=n.logger,i=(a=n.logLevel)!==null&&a!==void 0?a:"off";if(!s)return WE;const c=ab.get(s);if(c&&c[0]===i)return c[1];const u={error:Wu("error",s,i),warn:Wu("warn",s,i),info:Wu("info",s,i),debug:Wu("debug",s,i)};return ab.set(s,[i,u]),u}const So=n=>(n.options&&(n.options=Object.assign({},n.options),delete n.options.headers),n.headers&&(n.headers=Object.fromEntries((n.headers instanceof Headers?[...n.headers]:Object.entries(n.headers)).map(([a,s])=>[a,a.toLowerCase()==="x-goog-api-key"||a.toLowerCase()==="authorization"||a.toLowerCase()==="cookie"||a.toLowerCase()==="set-cookie"?"***":s]))),"retryOfRequestLogID"in n&&(n.retryOfRequestLogID&&(n.retryOf=n.retryOfRequestLogID),delete n.retryOfRequestLogID),n);/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class pl{constructor(a,s,i){this.iterator=a,this.controller=s,this.client=i}static fromSSEResponse(a,s,i){let c=!1;const u=i?oa(i):console;function f(){return _c(this,arguments,function*(){var b,m,_,E;if(c)throw new Wa("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");c=!0;let N=!1;try{try{for(var S=!0,I=gl(ek(a,s)),A;A=yield sr(I.next()),b=A.done,!b;S=!0){E=A.value,S=!1;const k=E;if(!N)if(k.data.startsWith("[DONE]")){N=!0;continue}else try{yield yield sr(JSON.parse(k.data))}catch(R){throw u.error("Could not parse message into JSON:",k.data),u.error("From chunk:",k.raw),R}}}catch(k){m={error:k}}finally{try{!S&&!b&&(_=I.return)&&(yield sr(_.call(I)))}finally{if(m)throw m.error}}N=!0}catch(k){if(Jh(k))return yield sr(void 0);throw k}finally{N||s.abort()}})}return new pl(f,s,i)}static fromReadableStream(a,s,i){let c=!1;function u(){return _c(this,arguments,function*(){var b,m,_,E;const N=new wd,S=_0(a);try{for(var I=!0,A=gl(S),k;k=yield sr(A.next()),b=k.done,!b;I=!0){E=k.value,I=!1;const R=E;for(const P of N.decode(R))yield yield sr(P)}}catch(R){m={error:R}}finally{try{!I&&!b&&(_=A.return)&&(yield sr(_.call(A)))}finally{if(m)throw m.error}}for(const R of N.flush())yield yield sr(R)})}function f(){return _c(this,arguments,function*(){var b,m,_,E;if(c)throw new Wa("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");c=!0;let N=!1;try{try{for(var S=!0,I=gl(u()),A;A=yield sr(I.next()),b=A.done,!b;S=!0){E=A.value,S=!1;const k=E;N||k&&(yield yield sr(JSON.parse(k)))}}catch(k){m={error:k}}finally{try{!S&&!b&&(_=I.return)&&(yield sr(_.call(I)))}finally{if(m)throw m.error}}N=!0}catch(k){if(Jh(k))return yield sr(void 0);throw k}finally{N||s.abort()}})}return new pl(f,s,i)}[Symbol.asyncIterator](){return this.iterator()}tee(){const a=[],s=[],i=this.iterator(),c=u=>({next:()=>{if(u.length===0){const f=i.next();a.push(f),s.push(f)}return u.shift()}});return[new pl(()=>c(a),this.controller,this.client),new pl(()=>c(s),this.controller,this.client)]}toReadableStream(){const a=this;let s;return x0({async start(){s=a[Symbol.asyncIterator]()},async pull(i){try{const{value:c,done:u}=await s.next();if(u)return i.close();const f=dp(JSON.stringify(c)+`
`);i.enqueue(f)}catch(c){i.error(c)}},async cancel(){var i;await((i=s.return)===null||i===void 0?void 0:i.call(s))}})}}function ek(n,a){return _c(this,arguments,function*(){var i,c,u,f;if(!n.body)throw a.abort(),typeof globalThis.navigator<"u"&&globalThis.navigator.product==="ReactNative"?new Wa("The default react-native fetch implementation does not support streaming. Please use expo/fetch: https://docs.expo.dev/versions/latest/sdk/expo/#expofetch-api"):new Wa("Attempted to iterate over a response with no body");const p=new nk,b=new wd,m=_0(n.body);try{for(var _=!0,E=gl(tk(m)),N;N=yield sr(E.next()),i=N.done,!i;_=!0){f=N.value,_=!1;const S=f;for(const I of b.decode(S)){const A=p.decode(I);A&&(yield yield sr(A))}}}catch(S){c={error:S}}finally{try{!_&&!i&&(u=E.return)&&(yield sr(u.call(E)))}finally{if(c)throw c.error}}for(const S of b.flush()){const I=p.decode(S);I&&(yield yield sr(I))}})}function tk(n){return _c(this,arguments,function*(){var s,i,c,u;let f=new Uint8Array;try{for(var p=!0,b=gl(n),m;m=yield sr(b.next()),s=m.done,!s;p=!0){u=m.value,p=!1;const _=u;if(_==null)continue;const E=_ instanceof ArrayBuffer?new Uint8Array(_):typeof _=="string"?dp(_):_;let N=new Uint8Array(f.length+E.length);N.set(f),N.set(E,f.length),f=N;let S;for(;(S=XE(f))!==-1;)yield yield sr(f.slice(0,S)),f=f.slice(S)}}catch(_){i={error:_}}finally{try{!p&&!s&&(c=b.return)&&(yield sr(c.call(b)))}finally{if(i)throw i.error}}f.length>0&&(yield yield sr(f))})}class nk{constructor(){this.event=null,this.data=[],this.chunks=[]}decode(a){if(a.endsWith("\r")&&(a=a.substring(0,a.length-1)),!a){if(!this.event&&!this.data.length)return null;const u={event:this.event,data:this.data.join(`
`),raw:this.chunks};return this.event=null,this.data=[],this.chunks=[],u}if(this.chunks.push(a),a.startsWith(":"))return null;let[s,i,c]=rk(a,":");return c.startsWith(" ")&&(c=c.substring(1)),s==="event"?this.event=c:s==="data"&&this.data.push(c),null}}function rk(n,a){const s=n.indexOf(a);return s!==-1?[n.substring(0,s),a,n.substring(s+a.length)]:[n,"",""]}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */async function ak(n,a){const{response:s,requestLogID:i,retryOfRequestLogID:c,startTime:u}=a,f=await(async()=>{var p;if(a.options.stream)return oa(n).debug("response",s.status,s.url,s.headers,s.body),a.options.__streamClass?a.options.__streamClass.fromSSEResponse(s,a.controller,n):pl.fromSSEResponse(s,a.controller,n);if(s.status===204)return null;if(a.options.__binaryResponse)return s;const b=s.headers.get("content-type"),m=(p=b==null?void 0:b.split(";")[0])===null||p===void 0?void 0:p.trim();return(m==null?void 0:m.includes("application/json"))||(m==null?void 0:m.endsWith("+json"))?await s.json():await s.text()})();return oa(n).debug(`[${i}] response parsed`,So({retryOfRequestLogID:c,url:s.url,status:s.status,body:f,durationMs:Date.now()-u})),f}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class fp extends Promise{constructor(a,s,i=ak){super(c=>{c(null)}),this.responsePromise=s,this.parseResponse=i,this.client=a}_thenUnwrap(a){return new fp(this.client,this.responsePromise,async(s,i)=>a(await this.parseResponse(s,i),i))}asResponse(){return this.responsePromise.then(a=>a.response)}async withResponse(){const[a,s]=await Promise.all([this.parse(),this.asResponse()]);return{data:a,response:s}}parse(){return this.parsedPromise||(this.parsedPromise=this.responsePromise.then(a=>this.parseResponse(this.client,a))),this.parsedPromise}then(a,s){return this.parse().then(a,s)}catch(a){return this.parse().catch(a)}finally(a){return this.parse().finally(a)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const C0=Symbol("brand.privateNullableHeaders");function*sk(n){if(!n)return;if(C0 in n){const{values:i,nulls:c}=n;yield*i.entries();for(const u of c)yield[u,null];return}let a=!1,s;n instanceof Headers?s=n.entries():Xv(n)?s=n:(a=!0,s=Object.entries(n??{}));for(let i of s){const c=i[0];if(typeof c!="string")throw new TypeError("expected header name to be a string");const u=Xv(i[1])?i[1]:[i[1]];let f=!1;for(const p of u)p!==void 0&&(a&&!f&&(f=!0,yield[c,null]),yield[c,p])}}const hc=n=>{const a=new Headers,s=new Set;for(const i of n){const c=new Set;for(const[u,f]of sk(i)){const p=u.toLowerCase();c.has(p)||(a.delete(u),c.add(p)),f===null?(a.delete(u),s.add(p)):(a.append(u,f),s.delete(p))}}return{[C0]:!0,values:a,nulls:s}};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Oh=n=>{var a,s,i,c,u,f;if(typeof globalThis.process<"u")return(i=(s=(a=EE)===null||a===void 0?void 0:a[n])===null||s===void 0?void 0:s.trim())!==null&&i!==void 0?i:void 0;if(typeof globalThis.Deno<"u")return(f=(u=(c=globalThis.Deno.env)===null||c===void 0?void 0:c.get)===null||u===void 0?void 0:u.call(c,n))===null||f===void 0?void 0:f.trim()};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var N0;class Sd{constructor(a){var s,i,c,u,f,p,b,{baseURL:m=Oh("GEMINI_NEXT_GEN_API_BASE_URL"),apiKey:_=(s=Oh("GEMINI_API_KEY"))!==null&&s!==void 0?s:null,apiVersion:E="v1beta"}=a,N=gd(a,["baseURL","apiKey","apiVersion"]);const S=Object.assign(Object.assign({apiKey:_,apiVersion:E},N),{baseURL:m||"https://generativelanguage.googleapis.com"});this.baseURL=S.baseURL,this.timeout=(i=S.timeout)!==null&&i!==void 0?i:Sd.DEFAULT_TIMEOUT,this.logger=(c=S.logger)!==null&&c!==void 0?c:console;const I="warn";this.logLevel=I,this.logLevel=(f=(u=rb(S.logLevel,"ClientOptions.logLevel",this))!==null&&u!==void 0?u:rb(Oh("GEMINI_NEXT_GEN_API_LOG"),"process.env['GEMINI_NEXT_GEN_API_LOG']",this))!==null&&f!==void 0?f:I,this.fetchOptions=S.fetchOptions,this.maxRetries=(p=S.maxRetries)!==null&&p!==void 0?p:2,this.fetch=(b=S.fetch)!==null&&b!==void 0?b:BE(),this.encoder=PE,this._options=S,this.apiKey=_,this.apiVersion=E,this.clientAdapter=S.clientAdapter}withOptions(a){return new this.constructor(Object.assign(Object.assign(Object.assign({},this._options),{baseURL:this.baseURL,maxRetries:this.maxRetries,timeout:this.timeout,logger:this.logger,logLevel:this.logLevel,fetch:this.fetch,fetchOptions:this.fetchOptions,apiKey:this.apiKey,apiVersion:this.apiVersion}),a))}baseURLOverridden(){return this.baseURL!=="https://generativelanguage.googleapis.com"}defaultQuery(){return this._options.defaultQuery}validateHeaders({values:a,nulls:s}){if(!(a.has("authorization")||a.has("x-goog-api-key"))&&!(this.apiKey&&a.get("x-goog-api-key"))&&!s.has("x-goog-api-key"))throw new Error('Could not resolve authentication method. Expected the apiKey to be set. Or for the "x-goog-api-key" headers to be explicitly omitted')}async authHeaders(a){const s=hc([a.headers]);if(!(s.values.has("authorization")||s.values.has("x-goog-api-key"))){if(this.apiKey)return hc([{"x-goog-api-key":this.apiKey}]);if(this.clientAdapter.isVertexAI())return hc([await this.clientAdapter.getAuthHeaders()])}}stringifyQuery(a){return Object.entries(a).filter(([s,i])=>typeof i<"u").map(([s,i])=>{if(typeof i=="string"||typeof i=="number"||typeof i=="boolean")return`${encodeURIComponent(s)}=${encodeURIComponent(i)}`;if(i===null)return`${encodeURIComponent(s)}=`;throw new Wa(`Cannot stringify type ${typeof i}; Expected string, number, boolean, or null. If you need to pass nested query parameters, you can manually encode them, e.g. { query: { 'foo[key1]': value1, 'foo[key2]': value2 } }, and please open a GitHub issue requesting better support for your use case.`)}).join("&")}getUserAgent(){return`${this.constructor.name}/JS ${dl}`}defaultIdempotencyKey(){return`stainless-node-retry-${kE()}`}makeStatusError(a,s,i,c){return ua.generate(a,s,i,c)}buildURL(a,s,i){const c=!this.baseURLOverridden()&&i||this.baseURL,u=TE(a)?new URL(a):new URL(c+(c.endsWith("/")&&a.startsWith("/")?a.slice(1):a)),f=this.defaultQuery();return DE(f)||(s=Object.assign(Object.assign({},f),s)),typeof s=="object"&&s&&!Array.isArray(s)&&(u.search=this.stringifyQuery(s)),u.toString()}async prepareOptions(a){if(this.clientAdapter&&this.clientAdapter.isVertexAI()&&!a.path.startsWith(`/${this.apiVersion}/projects/`)){const s=a.path.slice(this.apiVersion.length+1);a.path=`/${this.apiVersion}/projects/${this.clientAdapter.getProject()}/locations/${this.clientAdapter.getLocation()}${s}`}}async prepareRequest(a,{url:s,options:i}){}get(a,s){return this.methodRequest("get",a,s)}post(a,s){return this.methodRequest("post",a,s)}patch(a,s){return this.methodRequest("patch",a,s)}put(a,s){return this.methodRequest("put",a,s)}delete(a,s){return this.methodRequest("delete",a,s)}methodRequest(a,s,i){return this.request(Promise.resolve(i).then(c=>Object.assign({method:a,path:s},c)))}request(a,s=null){return new fp(this,this.makeRequest(a,s,void 0))}async makeRequest(a,s,i){var c,u,f;const p=await a,b=(c=p.maxRetries)!==null&&c!==void 0?c:this.maxRetries;s==null&&(s=b),await this.prepareOptions(p);const{req:m,url:_,timeout:E}=await this.buildRequest(p,{retryCount:b-s});await this.prepareRequest(m,{url:_,options:p});const N="log_"+(Math.random()*(1<<24)|0).toString(16).padStart(6,"0"),S=i===void 0?"":`, retryOf: ${i}`,I=Date.now();if(oa(this).debug(`[${N}] sending request`,So({retryOfRequestLogID:i,method:p.method,url:_,options:p,headers:m.headers})),!((u=p.signal)===null||u===void 0)&&u.aborted)throw new Wh;const A=new AbortController,k=await this.fetchWithTimeout(_,m,E,A).catch(Xh),R=Date.now();if(k instanceof globalThis.Error){const q=`retrying, ${s} attempts remaining`;if(!((f=p.signal)===null||f===void 0)&&f.aborted)throw new Wh;const G=Jh(k)||/timed? ?out/i.test(String(k)+("cause"in k?String(k.cause):""));if(s)return oa(this).info(`[${N}] connection ${G?"timed out":"failed"} - ${q}`),oa(this).debug(`[${N}] connection ${G?"timed out":"failed"} (${q})`,So({retryOfRequestLogID:i,url:_,durationMs:R-I,message:k.message})),this.retryRequest(p,s,i??N);throw oa(this).info(`[${N}] connection ${G?"timed out":"failed"} - error; no more retries left`),oa(this).debug(`[${N}] connection ${G?"timed out":"failed"} (error; no more retries left)`,So({retryOfRequestLogID:i,url:_,durationMs:R-I,message:k.message})),G?new d0:new _d({cause:k})}const P=`[${N}${S}] ${m.method} ${_} ${k.ok?"succeeded":"failed"} with status ${k.status} in ${R-I}ms`;if(!k.ok){const q=await this.shouldRetry(k);if(s&&q){const U=`retrying, ${s} attempts remaining`;return await HE(k.body),oa(this).info(`${P} - ${U}`),oa(this).debug(`[${N}] response error (${U})`,So({retryOfRequestLogID:i,url:k.url,status:k.status,headers:k.headers,durationMs:R-I})),this.retryRequest(p,s,i??N,k.headers)}const G=q?"error; no more retries left":"error; not retryable";oa(this).info(`${P} - ${G}`);const Y=await k.text().catch(U=>Xh(U).message),W=IE(Y),H=W?void 0:Y;throw oa(this).debug(`[${N}] response error (${G})`,So({retryOfRequestLogID:i,url:k.url,status:k.status,headers:k.headers,message:H,durationMs:Date.now()-I})),this.makeStatusError(k.status,W,H,k.headers)}return oa(this).info(P),oa(this).debug(`[${N}] response start`,So({retryOfRequestLogID:i,url:k.url,status:k.status,headers:k.headers,durationMs:R-I})),{response:k,options:p,controller:A,requestLogID:N,retryOfRequestLogID:i,startTime:I}}async fetchWithTimeout(a,s,i,c){const u=s||{},{signal:f,method:p}=u,b=gd(u,["signal","method"]);f&&f.addEventListener("abort",()=>c.abort());const m=setTimeout(()=>c.abort(),i),_=globalThis.ReadableStream&&b.body instanceof globalThis.ReadableStream||typeof b.body=="object"&&b.body!==null&&Symbol.asyncIterator in b.body,E=Object.assign(Object.assign(Object.assign({signal:c.signal},_?{duplex:"half"}:{}),{method:"GET"}),b);p&&(E.method=p.toUpperCase());try{return await this.fetch.call(void 0,a,E)}finally{clearTimeout(m)}}async shouldRetry(a){const s=a.headers.get("x-should-retry");return s==="true"?!0:s==="false"?!1:a.status===408||a.status===409||a.status===429||a.status>=500}async retryRequest(a,s,i,c){var u;let f;const p=c==null?void 0:c.get("retry-after-ms");if(p){const m=parseFloat(p);Number.isNaN(m)||(f=m)}const b=c==null?void 0:c.get("retry-after");if(b&&!f){const m=parseFloat(b);Number.isNaN(m)?f=Date.parse(b)-Date.now():f=m*1e3}if(!(f&&0<=f&&f<60*1e3)){const m=(u=a.maxRetries)!==null&&u!==void 0?u:this.maxRetries;f=this.calculateDefaultRetryTimeoutMillis(s,m)}return await RE(f),this.makeRequest(a,s-1,i)}calculateDefaultRetryTimeoutMillis(a,s){const u=s-a,f=Math.min(.5*Math.pow(2,u),8),p=1-Math.random()*.25;return f*p*1e3}async buildRequest(a,{retryCount:s=0}={}){var i,c,u;const f=Object.assign({},a),{method:p,path:b,query:m,defaultBaseURL:_}=f,E=this.buildURL(b,m,_);"timeout"in f&&jE("timeout",f.timeout),f.timeout=(i=f.timeout)!==null&&i!==void 0?i:this.timeout;const{bodyHeaders:N,body:S}=this.buildBody({options:f}),I=await this.buildHeaders({options:a,method:p,bodyHeaders:N,retryCount:s});return{req:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({method:p,headers:I},f.signal&&{signal:f.signal}),globalThis.ReadableStream&&S instanceof globalThis.ReadableStream&&{duplex:"half"}),S&&{body:S}),(c=this.fetchOptions)!==null&&c!==void 0?c:{}),(u=f.fetchOptions)!==null&&u!==void 0?u:{}),url:E,timeout:f.timeout}}async buildHeaders({options:a,method:s,bodyHeaders:i,retryCount:c}){let u={};this.idempotencyHeader&&s!=="get"&&(a.idempotencyKey||(a.idempotencyKey=this.defaultIdempotencyKey()),u[this.idempotencyHeader]=a.idempotencyKey);const f=await this.authHeaders(a);let p=hc([u,Object.assign(Object.assign({Accept:"application/json","User-Agent":this.getUserAgent(),"X-Stainless-Retry-Count":String(c)},a.timeout?{"X-Stainless-Timeout":String(Math.trunc(a.timeout/1e3))}:{}),zE()),this._options.defaultHeaders,i,a.headers,f]);return this.validateHeaders(p),p.values}buildBody({options:{body:a,headers:s}}){if(!a)return{bodyHeaders:void 0,body:void 0};const i=hc([s]);return ArrayBuffer.isView(a)||a instanceof ArrayBuffer||a instanceof DataView||typeof a=="string"&&i.values.has("content-type")||globalThis.Blob&&a instanceof globalThis.Blob||a instanceof FormData||a instanceof URLSearchParams||globalThis.ReadableStream&&a instanceof globalThis.ReadableStream?{bodyHeaders:void 0,body:a}:typeof a=="object"&&(Symbol.asyncIterator in a||Symbol.iterator in a&&"next"in a&&typeof a.next=="function")?{bodyHeaders:void 0,body:FE(a)}:this.encoder({body:a,headers:i})}}Sd.DEFAULT_TIMEOUT=6e4;class $r extends Sd{constructor(){super(...arguments),this.interactions=new T0(this)}}N0=$r;$r.GeminiNextGenAPIClient=N0;$r.GeminiNextGenAPIClientError=Wa;$r.APIError=ua;$r.APIConnectionError=_d;$r.APIConnectionTimeoutError=d0;$r.APIUserAbortError=Wh;$r.NotFoundError=m0;$r.ConflictError=g0;$r.RateLimitError=v0;$r.BadRequestError=f0;$r.AuthenticationError=h0;$r.InternalServerError=b0;$r.PermissionDeniedError=p0;$r.UnprocessableEntityError=y0;$r.toFile=$E;$r.Interactions=T0;const ik=()=>{throw new Error("AI features are disabled. A Google Gemini API key is required.")},ok={type:na.ARRAY,description:"An array of one or more actions the user wants to perform. If the user is just chatting, return an array with a single NO_ACTION.",items:{type:na.OBJECT,properties:{action:{type:na.STRING,enum:Object.values(xc),description:"The specific action the user wants to perform. Use NO_ACTION for conversational replies."},payload:{type:na.OBJECT,description:"The data needed to perform the action. Include only necessary fields.",properties:{deckId:{type:na.STRING,description:"The ID of the target deck."},folderId:{type:na.STRING,description:"The ID of the target folder. Use null to move a deck out of a folder."},name:{type:na.STRING,description:"The name for a new deck or folder."},newName:{type:na.STRING,description:"The new name for a deck or folder being renamed."},seriesId:{type:na.STRING,description:"The ID of the target series for expansion."},levelIndex:{type:na.NUMBER,description:"The 0-based index of the level within the series to add decks to."},count:{type:na.NUMBER,description:"The number of questions to generate for a deck."},reworkInstructions:{type:na.STRING,description:"Detailed instructions for reworking the deck content (e.g. 'Expand info cards')."},persona:{type:na.STRING,description:"The ID of the persona to use for rework (e.g. 'the_master', 'feynman'). Default to 'default' if not specified."}}},confirmationMessage:{type:na.STRING,description:"A friendly message to the user asking them to confirm the action. For a NO_ACTION, this should be the AI's conversational reply."}},required:["action","payload","confirmationMessage"]}},lk=async(n,a)=>{var p,b;const s=ik();a.decks.map(m=>`- Deck: "${m.name}" (id: ${m.id}, folderId: ${m.folderId||"none"})`).join(`
`);const i=a.folders.map(m=>`- Folder: "${m.name}" (id: ${m.id})`).join(`
`);let c="",u="";if((p=a.activeContext)!=null&&p.deck){const m=a.activeContext.deck;if(c=`
--- START ACTIVE DECK CONTENT ---
CURRENT OPEN DECK: "${m.name}" (ID: ${m.id})
TYPE: ${m.type}
`,m.type===et.Flashcard){const _=m;c+=`CARDS (${_.cards.length}):
`+_.cards.map(E=>`- Front: ${E.front}
  Back: ${E.back}`).join(`
`)}else{const _=m;if(m.type===et.Learning){const E=m;c+=`INFO CARDS (${E.infoCards.length}):
`+E.infoCards.map(N=>`- Content: ${N.content}`).join(`
`)}c+=`QUESTIONS (${_.questions.length}):
`+_.questions.map(E=>{var N;return`- Question: ${E.questionText}
  Correct Answer: ${(N=E.options.find(S=>S.id===E.correctAnswerId))==null?void 0:N.text}`}).join(`
`)}c+=`
--- END ACTIVE DECK CONTENT ---
`}if((b=a.activeContext)!=null&&b.series){const m=a.activeContext.series;u=`
--- START ACTIVE SERIES CONTEXT ---
CURRENT OPEN SERIES: "${m.name}" (ID: ${m.id})
`,u+=`Levels:
`+m.levels.map((_,E)=>{const N=_.deckIds.map(S=>a.decks.find(I=>I.id===S)).filter(Boolean);return`Level ${E}: ${_.title}
`+N.map(S=>`  - Deck: "${S==null?void 0:S.name}" (${S==null?void 0:S.description})`).join(`
`)}).join(`
`),u+=`
--- END ACTIVE SERIES CONTEXT ---
`}const f=`
        You are an AI assistant for 'CogniFlow', a spaced repetition app. Your goal is to help users manage their decks and folders.

        **PERSONAS**
        Users can request content generation using specific personas. Available personas:
        - 'default': Helpful and neutral assistant.
        - 'tutor': Friendly, uses analogies, simple language.
        - 'professor': Formal, academic, in-depth, precise.
        - 'author': Concise, fact-focused, no fluff.
        - 'lindstrom': Linguistic, cultural, witty, slightly dry.
        - 'bryson': Sense of wonder, conversational, avoids jargon, dry humor.
        - 'feynman': Simplicity, physical analogies, "why" and "how" focused.
        - 'roach': Intense curiosity, human side of science, funny,Relatable.
        - 'great_teacher': Storytelling, modeling radical curiosity.
        - 'the_master': Ultimate mentor. 5 pillars: Stylist (rhythm), Storyteller (human struggle), Analogy Architect, Provocateur (challenge assumptions), Formatter (aggressive HTML use).

        **CRITICAL: REFERENCING CONTEXT (@)**
        Users may use "@" or "this" to refer to the current deck or series they are viewing.
        ${c}
        ${u}

        You MUST respond with a JSON array of actions.

        **Capabilities:**
        - Create/rename/move/delete decks & folders.
        - Expand learning series.
        - Generate unique questions for decks using HTML formatting.
        - REWORK content: If a user asks to "improve", "expand", or "rewrite" an existing deck (using a persona or not), use REWORK_DECK.
        - Answer general questions about study materials if context is provided.

        **Instructions:**
        1. Analyze user request. Use active context (marked above) if the user says "@" or "this".
        2. For content rework (e.g. "Expand info cards using the Master persona"), identify the target deck ID, extract any requested persona ID (if requested), and provide the specific instructions.
        3. For conversational replies, use 'NO_ACTION'.
        4. For data modifications, use a clear 'confirmationMessage'.

        **State Summary:**
        Folders: ${i||"None"}
        Series: ${a.series.map(m=>m.name).join(", ")||"None"}
    `;try{const _=(await s.models.generateContent({model:"gemini-2.5-pro",contents:n,config:{systemInstruction:f,responseMimeType:"application/json",responseSchema:ok,thinkingConfig:{thinkingBudget:32768}}})).text.trim(),E=JSON.parse(_);if(!Array.isArray(E))throw new Error("AI response was not a valid array of actions.");return E}catch(m){throw console.error("Error getting AI response:",m),m instanceof Error&&m.message.includes("SAFETY")?new Error("Blocked by safety settings."):new Error("Sorry, I had trouble with that. Try rephrasing?")}},ck=({isOpen:n,onClose:a,onExecuteAction:s,history:i})=>{const{dispatch:c}=kt(),u=_l(),f=np(),p=T_(),b=rp(),[m,_]=$.useState(""),[E,N]=$.useState(!1),[S,I]=$.useState(""),A=$.useRef(null),k=$.useRef(null),R=u==null?void 0:u.activeDeck,P=u==null?void 0:u.activeSeries;$.useEffect(()=>{var U;(U=A.current)==null||U.scrollIntoView({behavior:"smooth"})},[i]),$.useEffect(()=>{n&&Jb(i)},[i,n]);const q=$.useMemo(()=>{const U=[];return R&&U.push({id:R.id,name:`this deck (${R.name})`,type:"deck"}),P&&U.push({id:P.id,name:`this series (${P.name})`,type:"series"}),p.forEach(Q=>U.push({id:Q.id,name:Q.name,type:"folder"})),f.filter(Q=>!Q.deletedAt&&!Q.archived).forEach(Q=>U.push({id:Q.id,name:Q.name,type:"deck"})),U.filter(Q=>Q.name.toLowerCase().includes(S.toLowerCase()))},[f,p,R,P,S]),G=U=>{const Q=U.target.value;_(Q);const le=Q.lastIndexOf("@");le!==-1&&le>=Q.length-15?(N(!0),I(Q.substring(le+1))):N(!1)},Y=U=>{var F;const Q=m.lastIndexOf("@"),le=m.substring(0,Q)+`@${U.name} `;_(le),N(!1),(F=k.current)==null||F.focus()},W=async U=>{var j;U.preventDefault();const Q=m.trim();if(!Q)return;_(""),N(!1);const le={id:crypto.randomUUID(),role:"user",text:Q},F={id:crypto.randomUUID(),role:"model",text:"",isLoading:!0},te=[...i,le,F];c({type:"SET_AI_CHAT_HISTORY",payload:te});try{const he=await lk(Q,{decks:f,folders:p,series:b,activeContext:{deck:R||void 0,series:P||void 0}}),J={id:crypto.randomUUID(),role:"model",text:((j=he.find(Z=>Z.confirmationMessage))==null?void 0:j.confirmationMessage)||"I've processed your request.",actions:he};c({type:"SET_AI_CHAT_HISTORY",payload:[...i,le,J]})}catch(he){const J={id:crypto.randomUUID(),role:"model",text:he instanceof Error?he.message:"An unknown error occurred."};c({type:"SET_AI_CHAT_HISTORY",payload:[...i,le,J]})}},H=U=>{s(U),a()},L=U=>U.replace(/\*\*(.*?)\*\*/g,"<b>$1</b>").replace(/\*(.*?)\*/g,"<i>$1</i>").replace(/```([\s\S]*?)```/g,'<pre class="bg-gray-800 text-white p-2 rounded my-2 overflow-x-auto text-xs"><code>$1</code></pre>').replace(/`([^`]+)`/g,'<code class="bg-gray-200 dark:bg-gray-700 px-1 rounded text-sm font-mono">$1</code>').replace(/\n/g,"<br />");return n?l.jsxs("div",{className:"fixed inset-0 bg-black/50 z-[60] flex flex-col items-center justify-end",onClick:a,children:[l.jsxs("div",{className:"bg-surface w-full max-w-2xl h-[70vh] max-h-[600px] rounded-t-2xl shadow-2xl flex flex-col transform transition-transform duration-300 animate-fade-in relative",style:{animationName:"slideUp",animationDuration:"0.3s"},onClick:U=>U.stopPropagation(),children:[l.jsxs("header",{className:"flex-shrink-0 flex items-center justify-between p-4 border-b border-border",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(rt,{name:"bot",className:"w-6 h-6 text-primary"}),l.jsx("h2",{className:"text-xl font-bold text-text",children:"AI Assistant"})]}),l.jsx(pt,{variant:"ghost",onClick:a,className:"p-1 h-auto",children:l.jsx(rt,{name:"x"})})]}),l.jsx("main",{className:"flex-grow p-4 overflow-y-auto",children:l.jsxs("div",{className:"space-y-4",children:[i.map(U=>l.jsxs("div",{className:`flex gap-3 ${U.role==="user"?"justify-end":"justify-start"}`,children:[U.role==="model"&&l.jsx(rt,{name:"bot",className:"w-6 h-6 text-primary flex-shrink-0 mt-1"}),l.jsxs("div",{className:`max-w-md p-3 rounded-2xl ${U.role==="user"?"bg-primary text-on-primary rounded-br-lg":"bg-background rounded-bl-lg"}`,children:[U.isLoading?l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(Rs,{size:"sm"}),l.jsx("span",{className:"text-text-muted",children:"Thinking..."})]}):l.jsx(c0,{html:L(U.text),className:"prose dark:prose-invert max-w-none text-sm"}),U.actions&&U.actions.length>0&&l.jsx("div",{className:"mt-3 pt-3 border-t border-border/50 flex flex-wrap gap-2",children:U.actions.map((Q,le)=>Q.action!=="NO_ACTION"&&l.jsx(pt,{size:"sm",variant:"secondary",onClick:()=>H(Q),children:Q.confirmationMessage},le))})]})]},U.id)),l.jsx("div",{ref:A})]})}),l.jsxs("footer",{className:"flex-shrink-0 p-4 border-t border-border relative",children:[E&&q.length>0&&l.jsxs("div",{className:"absolute bottom-full left-4 right-4 mb-2 bg-surface border border-border rounded-lg shadow-2xl max-h-48 overflow-y-auto z-10 animate-fade-in",children:[l.jsx("div",{className:"p-2 text-xs font-bold text-text-muted uppercase border-b border-border",children:"Reference Content"}),q.map(U=>l.jsxs("button",{className:"w-full text-left px-4 py-2 hover:bg-primary/10 flex items-center gap-2 text-sm transition-colors",onClick:()=>Y(U),children:[l.jsx(rt,{name:U.type==="deck"?"laptop":U.type==="series"?"layers":"folder",className:"w-4 h-4 text-text-muted"}),l.jsx("span",{className:"truncate",children:U.name})]},`${U.type}-${U.id}`))]}),l.jsxs("form",{onSubmit:W,className:"flex items-center gap-2",children:[l.jsx("input",{ref:k,type:"text",value:m,onChange:G,placeholder:"Ask a question or type @ to reference...",className:"flex-grow p-2 bg-background border border-border rounded-full focus:ring-2 focus:ring-primary focus:outline-none px-4",autoFocus:!0}),l.jsx(pt,{type:"submit",variant:"primary",className:"rounded-full w-10 h-10 p-0","aria-label":"Send message",children:l.jsx(rt,{name:"arrow-down",className:"w-5 h-5 -rotate-90"})})]})]})]}),l.jsx("style",{children:`
              @keyframes slideUp {
                from { transform: translateY(100%); }
                to { transform: translateY(0); }
              }
            `})]}):null},uk=({isOpen:n,onClose:a,onRestore:s,files:i})=>{const[c,u]=$.useState(""),f=$.useRef(null);kr(f,n);const p=()=>{c&&s(c)};return n?l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-[60] p-4",children:l.jsxs("div",{ref:f,className:"bg-white dark:bg-gray-800 rounded-lg shadow-xl w-full max-w-lg transform transition-all relative max-h-[90vh] flex flex-col",children:[l.jsxs("div",{className:"flex-shrink-0 flex justify-between items-center p-4 border-b border-gray-200 dark:border-gray-700",children:[l.jsx("h2",{className:"text-xl font-bold",children:"Restore from Google Drive"}),l.jsx(pt,{type:"button",variant:"ghost",onClick:a,className:"p-1 h-auto",children:l.jsx(rt,{name:"x"})})]}),l.jsxs("div",{className:"p-6 overflow-y-auto",children:[l.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-4",children:"Select a backup file to restore. Restoring will overwrite decks with the same ID."}),i.length>0?l.jsx("div",{className:"space-y-2 border border-gray-200 dark:border-gray-700 rounded-md",children:i.map(b=>l.jsxs("label",{className:"flex items-center p-3 hover:bg-gray-100 dark:hover:bg-gray-700/50 cursor-pointer border-b border-gray-200 dark:border-gray-700 last:border-b-0",children:[l.jsx("input",{type:"radio",name:"backup-file",value:b.id,checked:c===b.id,onChange:()=>u(b.id),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 dark:border-gray-600 dark:bg-gray-900"}),l.jsxs("div",{className:"ml-3 text-sm",children:[l.jsx("p",{className:"font-medium text-gray-900 dark:text-gray-100",children:b.name}),l.jsxs("p",{className:"text-gray-500 dark:text-gray-400",children:["Last modified: ",new Date(b.modifiedTime).toLocaleString()]})]})]},b.id))}):l.jsx("div",{className:"text-center py-8 text-gray-500 dark:text-gray-400",children:l.jsx("p",{children:"No backup files found in your Google Drive application folder."})})]}),l.jsxs("div",{className:"flex-shrink-0 flex justify-end p-4 bg-gray-100/50 dark:bg-gray-900/50 border-t border-gray-200 dark:border-gray-700",children:[l.jsx(pt,{type:"button",variant:"secondary",onClick:a,className:"mr-2",children:"Cancel"}),l.jsx(pt,{type:"button",variant:"danger",onClick:p,disabled:!c,children:"Restore Selected"})]})]})}):null},sb=n=>{var a,s;return n.type===et.Flashcard?((a=n.cards)==null?void 0:a.length)||0:((s=n.questions)==null?void 0:s.length)||0},jh=({label:n,localValue:a,remoteValue:s})=>l.jsxs("div",{className:"text-sm",children:[l.jsxs("span",{className:"font-semibold",children:[n,": "]}),l.jsx("span",{className:"text-text-muted",children:a}),l.jsx(rt,{name:"arrow-down",className:"inline w-3 h-3 mx-1 rotate-[-90deg]"}),l.jsx("span",{className:"text-primary font-semibold",children:s})]}),dk=({isOpen:n,onClose:a,onResolve:s,comparison:i,remoteData:c})=>{const u=$.useRef(null);kr(u,n);const{seriesProgress:f}=kt(),[p,b]=$.useState({decks:{},series:{}}),[m,_]=$.useState(null);$.useMemo(()=>{const I={decks:{},series:{}};i.changedDecks.forEach(A=>I.decks[A.local.id]="remote"),i.changedSeries.forEach(A=>I.series[A.local.id]="remote"),b(I)},[i]);const E=(I,A)=>{b(k=>({...k,[I]:{...k[I],[A]:k[I][A]==="local"?"remote":"local"}})),_("mixed")},N=I=>{const A={decks:{},series:{}};i.changedDecks.forEach(k=>A.decks[k.local.id]=I),i.changedSeries.forEach(k=>A.series[k.local.id]=I),b(A),_(I)},S=()=>{s(p,c)};return n?l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-[60] p-4",children:l.jsxs("div",{ref:u,className:"bg-surface rounded-lg shadow-xl w-full max-w-2xl transform transition-all relative max-h-[90vh] flex flex-col",role:"alertdialog","aria-modal":"true","aria-labelledby":"conflict-title",children:[l.jsx("div",{className:"flex-shrink-0 flex justify-between items-center p-4 border-b border-border",children:l.jsx("h2",{id:"conflict-title",className:"text-xl font-bold text-yellow-600 dark:text-yellow-400",children:"Sync Conflict"})}),l.jsxs("div",{className:"p-6 overflow-y-auto space-y-4",children:[l.jsx("p",{className:"text-text-muted",children:"Both your local data and the server data have changed since the last sync. Please choose which version to keep for each item."}),l.jsxs("div",{className:"flex gap-2 mb-4",children:[l.jsx(pt,{variant:m==="local"?"primary":"secondary",size:"sm",onClick:()=>N("local"),children:"Keep All Local"}),l.jsx(pt,{variant:m==="remote"?"primary":"secondary",size:"sm",onClick:()=>N("remote"),children:"Take All Remote"})]}),l.jsxs("div",{className:"space-y-6",children:[(i.newSeries.length>0||i.newDecks.length>0)&&l.jsxs("div",{children:[l.jsxs("h3",{className:"font-semibold text-text mb-2 flex items-center gap-2",children:[l.jsx(rt,{name:"plus",className:"w-4 h-4 text-green-500"}),"New Items on Server (Will be added)"]}),l.jsxs("ul",{className:"text-sm list-disc list-inside text-text-muted bg-background p-3 rounded-md border border-border",children:[i.newSeries.map(I=>l.jsxs("li",{children:['Series: "',I.name,'"']},I.id)),i.newDecks.map(I=>l.jsxs("li",{children:['Deck: "',I.name,'"']},I.id))]})]}),i.changedSeries.length>0&&l.jsxs("div",{children:[l.jsx("h3",{className:"font-semibold text-text mb-2",children:"Changed Series"}),l.jsx("div",{className:"space-y-3",children:i.changedSeries.map(({local:I,backup:A})=>{var Y,W;const k=(I.levels||[]).reduce((H,L)=>{var U;return H+(((U=L.deckIds)==null?void 0:U.length)||0)},0),R=(A.levels||[]).reduce((H,L)=>{var U;return H+(((U=L.deckIds)==null?void 0:U.length)||0)},0),P=((Y=f.get(I.id))==null?void 0:Y.size)||0,q=(((W=c.seriesProgress)==null?void 0:W[A.id])||[]).length,G=p.series[I.id]==="local";return l.jsxs("div",{className:`p-3 rounded-md border transition-colors cursor-pointer ${G?"bg-blue-50 dark:bg-blue-900/20 border-blue-200 dark:border-blue-800":"bg-green-50 dark:bg-green-900/20 border-green-200 dark:border-green-800"}`,onClick:()=>E("series",I.id),children:[l.jsxs("div",{className:"flex justify-between items-center mb-2",children:[l.jsx("p",{className:"font-bold",children:I.name}),l.jsx("span",{className:`text-xs font-semibold px-2 py-1 rounded ${G?"bg-blue-100 text-blue-700":"bg-green-100 text-green-700"}`,children:G?"Keeping Local":"Taking Server"})]}),l.jsx(jh,{label:"Progress",localValue:`${P}/${k}`,remoteValue:`${q}/${R}`}),l.jsx("p",{className:"text-xs text-text-muted mt-2 text-right",children:"Tap to toggle"})]},I.id)})})]}),i.changedDecks.length>0&&l.jsxs("div",{children:[l.jsx("h3",{className:"font-semibold text-text mb-2",children:"Changed Decks"}),l.jsx("div",{className:"space-y-3",children:i.changedDecks.map(({local:I,backup:A})=>{const k=i.dueCounts.get(`local-${I.id}`)||0,R=i.dueCounts.get(A.id)||0,P=p.decks[I.id]==="local";return l.jsxs("div",{className:`p-3 rounded-md border transition-colors cursor-pointer ${P?"bg-blue-50 dark:bg-blue-900/20 border-blue-200 dark:border-blue-800":"bg-green-50 dark:bg-green-900/20 border-green-200 dark:border-green-800"}`,onClick:()=>E("decks",I.id),children:[l.jsxs("div",{className:"flex justify-between items-center mb-2",children:[l.jsx("p",{className:"font-bold",children:I.name}),l.jsx("span",{className:`text-xs font-semibold px-2 py-1 rounded ${P?"bg-blue-100 text-blue-700":"bg-green-100 text-green-700"}`,children:P?"Keeping Local":"Taking Server"})]}),l.jsx(jh,{label:"Items",localValue:sb(I),remoteValue:sb(A)}),l.jsx(jh,{label:"Due",localValue:k,remoteValue:R}),l.jsx("p",{className:"text-xs text-text-muted mt-2 text-right",children:"Tap to toggle"})]},I.id)})})]})]})]}),l.jsxs("div",{className:"flex-shrink-0 flex justify-between items-center p-4 bg-background/50 border-t border-border",children:[l.jsx(pt,{type:"button",variant:"danger",onClick:a,children:"Cancel Sync"}),l.jsxs(pt,{variant:"primary",onClick:S,children:[l.jsx(rt,{name:"check-circle",className:"mr-2"}),"Resolve & Merge"]})]})]})}):null},wc=n=>{if(!n)return"";try{return new DOMParser().parseFromString(n,"text/html").body.textContent||""}catch{return String(n).replace(/<[^>]+>/g,"")}},tA=async(n,a=24e3)=>{const s=atob(n),i=s.length,c=new Uint8Array(i);for(let N=0;N<i;N++)c[N]=s.charCodeAt(N);const u=window.AudioContext||window.webkitAudioContext,f=new u({sampleRate:a}),p=new Int16Array(c.buffer),b=1,m=p.length/b,_=f.createBuffer(b,m,a);for(let N=0;N<b;N++){const S=_.getChannelData(N);for(let I=0;I<m;I++)S[I]=p[I*b+N]/32768}const E=f.createBufferSource();return E.buffer=_,E.connect(f.destination),E.start(),new Promise(N=>{E.onended=()=>{f.close(),N()}})},fk=({isOpen:n,onClose:a,actions:s})=>{const[i,c]=$.useState(""),[u,f]=$.useState(0),p=$.useRef(null),b=$.useRef(null),{navigate:m}=si(),_=np(),E=rp();kr(p,n);const N=$.useMemo(()=>{const G=[];return s.forEach(Y=>G.push({type:"action",id:Y.id,label:Y.label,icon:Y.icon,run:Y.action,keywords:Y.keywords,searchableOnly:Y.searchableOnly})),_.filter(Y=>!Y.archived&&!Y.deletedAt).forEach(Y=>G.push({type:"deck",id:Y.id,name:Y.name,itemType:Y.type})),E.filter(Y=>!Y.archived&&!Y.deletedAt).forEach(Y=>G.push({type:"series",id:Y.id,name:Y.name})),_.filter(Y=>!Y.archived&&!Y.deletedAt).forEach(Y=>{Y.type==="flashcard"?(Y.cards||[]).forEach(W=>G.push({type:"card",id:W.id,deckId:Y.id,deckName:Y.name,front:W.front})):(Y.questions||[]).forEach(W=>G.push({type:"question",id:W.id,deckId:Y.id,deckName:Y.name,text:W.questionText}))}),G},[s,_,E]),S=$.useMemo(()=>{if(!i.trim())return N.filter(W=>W.type==="action"&&!W.searchableOnly);const G=i.toLowerCase();return N.filter(W=>{switch(W.type){case"action":{const H=W,L=H.label.toLowerCase().includes(G),U=(H.keywords||[]).some(Q=>Q.toLowerCase().includes(G));return L||U}case"deck":return W.name.toLowerCase().includes(G);case"series":return W.name.toLowerCase().includes(G);case"card":return wc(W.front).toLowerCase().includes(G);case"question":return W.text.toLowerCase().includes(G);default:return!1}}).slice(0,50)},[i,N]),I=$.useMemo(()=>{const G={Actions:[],Series:[],Decks:[],Cards:[]};return S.forEach(Y=>{Y.type==="action"?G.Actions.push(Y):Y.type==="series"?G.Series.push(Y):Y.type==="deck"?G.Decks.push(Y):(Y.type==="card"||Y.type==="question")&&G.Cards.push(Y)}),Object.entries(G).filter(([,Y])=>Y.length>0)},[S]),A=$.useMemo(()=>I.flatMap(([,G])=>G),[I]),k=$.useCallback(G=>{switch(G.type){case"action":G.run();break;case"deck":m(`/decks/${G.id}`);break;case"series":m(`/series/${G.id}`);break;case"card":case"question":m(`/decks/${G.deckId}`);break}a()},[m,a]);$.useEffect(()=>{const G=Y=>{if(n)if(Y.key==="ArrowDown")Y.preventDefault(),f(W=>(W+1)%(A.length||1));else if(Y.key==="ArrowUp")Y.preventDefault(),f(W=>(W-1+(A.length||1))%(A.length||1));else if(Y.key==="Enter"){Y.preventDefault();const W=A[u];W&&k(W)}else Y.key==="Escape"&&a()};return window.addEventListener("keydown",G),()=>window.removeEventListener("keydown",G)},[n,u,A,k,a]),$.useEffect(()=>{n&&(c(""),f(0))},[n]),$.useEffect(()=>{f(0)},[i]),$.useEffect(()=>{var G;(G=document.getElementById(`cmdk-item-${u}`))==null||G.scrollIntoView({block:"nearest"})},[u]);const R=G=>{G.target===G.currentTarget&&a()};if(!n)return null;const P=(G,Y)=>{let W,H="",L;switch(G.type){case"action":W=G.icon,H=G.label;break;case"deck":W="help-circle",G.itemType===et.Flashcard?W="laptop":G.itemType===et.Learning&&(W="layers"),H=G.name;break;case"series":W="layers",H=G.name;break;case"card":W="laptop",H=wc(G.front),L=`In: ${G.deckName}`;break;case"question":W="help-circle",H=G.text,L=`In: ${G.deckName}`;break}return l.jsxs("li",{id:`cmdk-item-${Y}`,role:"option","aria-selected":u===Y,onClick:()=>k(G),className:`flex items-center gap-4 px-4 py-3 cursor-pointer rounded-md ${u===Y?"bg-primary/10":"hover:bg-border/30"}`,children:[l.jsx(rt,{name:W,className:"w-5 h-5 text-text-muted flex-shrink-0"}),l.jsxs("div",{className:"flex-grow min-w-0",children:[l.jsx("p",{className:`font-medium truncate ${u===Y?"text-primary":"text-text"}`,children:H}),L&&l.jsx("p",{className:`text-sm truncate ${u===Y?"text-primary/80":"text-text-muted"}`,children:L})]})]},G.id)};let q=0;return l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-70 flex justify-center items-start pt-4 sm:pt-[15vh] z-[60] p-4",onClick:R,children:l.jsxs("div",{ref:p,role:"dialog","aria-modal":"true",className:"bg-surface rounded-lg shadow-xl w-full max-w-2xl transform transition-all relative max-h-[70vh] flex flex-col",children:[l.jsxs("div",{className:"flex items-center gap-2 p-4 border-b border-border",children:[l.jsx(rt,{name:"search",className:"w-5 h-5 text-text-muted"}),l.jsx("input",{type:"text",value:i,onChange:G=>c(G.target.value),placeholder:"Search for anything or type a command...",className:"w-full bg-transparent focus:outline-none text-lg placeholder:text-text-muted",autoFocus:!0}),l.jsx("div",{className:"hidden sm:block text-xs text-text-muted border border-border rounded px-1.5 py-0.5",children:"ESC"})]}),l.jsx("div",{className:"flex-grow overflow-y-auto p-2",children:A.length>0?l.jsx("ul",{ref:b,role:"listbox",children:I.map(([G,Y])=>l.jsxs("li",{children:[l.jsx("p",{className:"px-4 py-2 text-xs font-semibold text-text-muted uppercase tracking-wider",children:G}),l.jsx("ul",{className:"space-y-1",children:Y.map(W=>P(W,q++))})]},G))}):l.jsx("div",{className:"text-center py-10 px-4",children:l.jsxs("p",{className:"text-text-muted",children:['No results found for "',i,'".']})})}),l.jsx("div",{className:"hidden sm:flex flex-shrink-0 justify-end items-center p-2 border-t border-border",children:l.jsxs("span",{className:"text-sm text-text-muted",children:[l.jsx(rt,{name:"terminal",className:"inline-block w-4 h-4 mr-2"}),l.jsx("kbd",{className:"font-sans",children:"Cmd+K"})," to toggle"]})})]})})},hk=({isOpen:n,onClose:a,onAddDeck:s})=>{const[i,c]=$.useState(""),{addToast:u}=Ar(),f=$.useRef(null);kr(f,n);const p=`{
  "name": "New Quiz Deck Name",
  "description": "A description for the new deck.",
  "questions": [
    {
      "questionText": "What is 2+2?",
      "options": [{"id":"1","text":"4"}, {"id":"2","text":"3"}],
      "correctAnswerId": "1",
      "detailedExplanation": "It's basic math.",
      "tags": []
    }
  ]
}`,b=_=>{if(_.preventDefault(),!i.trim()){u("JSON content cannot be empty.","error");return}try{const E=hd(i);if(E.type!==et.Quiz){u("The provided JSON is not a valid Quiz Deck format.","error");return}const N={id:crypto.randomUUID(),name:E.data.name,description:E.data.description,type:et.Quiz,questions:E.data.questions.map(S=>({...S,id:crypto.randomUUID(),questionType:"multipleChoice",dueDate:new Date().toISOString(),interval:0,easeFactor:2.5,suspended:!1,lapses:0,masteryLevel:0,detailedExplanation:S.detailedExplanation||"",options:S.options.map(I=>({id:I.id||crypto.randomUUID(),text:I.text,explanation:I.explanation}))}))};s(N),u(`Successfully created and added deck: "${N.name}"`,"success"),a()}catch(E){u(E instanceof Error?E.message:"Invalid JSON format.","error")}},m=_=>{if(_.key==="Tab"){_.preventDefault();const E=_.target,N=E.selectionStart,S=E.selectionEnd;E.value=E.value.substring(0,N)+"  "+E.value.substring(S),E.selectionStart=E.selectionEnd=N+2}};return n?l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-[60] p-4",children:l.jsx("div",{ref:f,className:"bg-surface rounded-lg shadow-xl w-full max-w-2xl transform transition-all relative",children:l.jsxs("form",{onSubmit:b,children:[l.jsxs("div",{className:"flex justify-between items-center p-4 border-b border-border",children:[l.jsx("h2",{className:"text-xl font-bold",children:"Add New Deck to Series"}),l.jsx(pt,{type:"button",variant:"ghost",onClick:a,className:"p-1 h-auto",children:l.jsx(rt,{name:"x"})})]}),l.jsxs("div",{className:"p-6",children:[l.jsx("label",{htmlFor:"json-content",className:"block text-sm font-medium text-text-muted mb-1",children:"Paste a complete quiz deck object in JSON format."}),l.jsx("textarea",{id:"json-content",value:i,onChange:_=>c(_.target.value),onKeyDown:m,rows:15,className:"w-full p-2 bg-background border border-border rounded-md focus:ring-2 focus:ring-primary focus:outline-none font-mono text-sm",placeholder:p})]}),l.jsxs("div",{className:"flex justify-end p-4 bg-background/50 border-t border-border",children:[l.jsx(pt,{type:"button",variant:"secondary",onClick:a,className:"mr-2",children:"Cancel"}),l.jsx(pt,{type:"submit",variant:"primary",children:"Create & Add Deck"})]})]})})}):null},pk=({isOpen:n,onClose:a,badJson:s,onRetry:i,onCancel:c})=>{const[u,f]=$.useState(s),{addToast:p}=Ar(),b=$.useRef(null);kr(b,n);const m=()=>{try{const N=JSON.parse(u);i(N),a()}catch(N){p(`Still not valid JSON. ${N.message}`,"error")}},_=()=>{c(),a()},E=N=>{if(N.key==="Tab"){N.preventDefault();const S=N.target,I=S.selectionStart,A=S.selectionEnd;S.value=S.value.substring(0,I)+"  "+S.value.substring(A),S.selectionStart=S.selectionEnd=I+2}};return n?l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-[70] p-4",children:l.jsxs("div",{ref:b,className:"bg-surface rounded-lg shadow-xl w-full max-w-3xl transform transition-all relative max-h-[90vh] flex flex-col",children:[l.jsxs("div",{className:"flex-shrink-0 flex justify-between items-center p-4 border-b border-border",children:[l.jsx("h2",{className:"text-xl font-bold",children:"Fix AI Response"}),l.jsx(pt,{type:"button",variant:"ghost",onClick:_,className:"p-1 h-auto",children:l.jsx(rt,{name:"x"})})]}),l.jsxs("div",{className:"flex-grow p-6 space-y-4 overflow-y-auto",children:[l.jsxs("div",{className:"bg-yellow-900/10 border border-yellow-500/30 rounded-lg p-4 text-sm text-yellow-800 dark:text-yellow-200",children:[l.jsxs("p",{children:[l.jsx("strong",{className:"font-bold",children:"Error:"})," The AI returned malformed JSON. This can happen if the response is too long and gets cut off. You can try to fix it manually below."]}),l.jsx("p",{className:"mt-2",children:'Common fixes include adding a missing closing quote (`"`) or bracket/brace (`]` or `}`).'})]}),l.jsxs("div",{children:[l.jsx("label",{htmlFor:"json-fix-content",className:"block text-sm font-medium text-text-muted mb-1",children:"Edit JSON response:"}),l.jsx("textarea",{id:"json-fix-content",value:u,onChange:N=>f(N.target.value),onKeyDown:E,rows:20,className:"w-full p-2 bg-background border border-border rounded-md focus:ring-2 focus:ring-primary focus:outline-none font-mono text-sm"})]})]}),l.jsxs("div",{className:"flex-shrink-0 flex justify-end p-4 bg-background/50 border-t border-border",children:[l.jsx(pt,{type:"button",variant:"secondary",onClick:_,className:"mr-2",children:"Cancel"}),l.jsxs(pt,{type:"button",variant:"primary",onClick:m,children:[l.jsx(rt,{name:"refresh-ccw",className:"w-4 h-4 mr-2"}),"Retry with Fix"]})]})]})}):null},In=()=>{throw new Error("API Key missing from environment (process.env.API_KEY)")},fr=n=>{if(!n)return null;const a=n.replace(/```json/g,"").replace(/```/g,"").trim();try{return JSON.parse(a)}catch{const i=n.indexOf("{"),c=n.indexOf("[");let u=-1,f="";if(i!==-1&&(c===-1||i<c)?(u=i,f="}"):c!==-1&&(u=c,f="]"),u!==-1){const b=n.lastIndexOf(f);if(b>u){const m=n.substring(u,b+1);try{return JSON.parse(m)}catch(_){console.error("JSON repair extraction failed:",_);const E=new Error("Malformed JSON response from AI.");throw E.jsonString=n,E}}}const p=new Error("No JSON structure found in AI response.");throw p.jsonString=n,p}},ib=async(n,a,s,i={})=>{const c=In(),u=i.analogyIntensity==="none"?"Do not use analogies.":i.analogyIntensity==="aggressive"?"Use multiple, layered physical analogies to explain abstract parts of the concept. Make them vivid and relatable.":"Add a concrete physical analogy for the core concept.",f=`
        Act as the following expert persona: ${s.name}.
        Persona Instructions: ${s.instruction}
        
        TOPIC: "${n}"
        CURRENT CONTENT: 
        ${a}
        
        TASK:
        Expand this content into a world-class holistic instructional block. 
        
        REQUIREMENTS:
        1. Target length: Approximately ${i.targetWordCount||500} words.
        2. Keep all original facts and data.
        3. ${u}
        4. Connect the topic to broader interdisciplinary context (historical, social, or scientific).
        5. Use aggressive HTML formatting (h2, h3, bold, blockquotes) to guide the reader.
        6. The prose should be rhythmic, engaging, and embody the selected persona perfectly.
        
        OUTPUT: Return only the improved HTML.
    `;return(await c.models.generateContent({model:"gemini-3-pro-preview",contents:f,config:{thinkingConfig:{thinkingBudget:i.thinkingBudget!==void 0?i.thinkingBudget:32768}}})).text||a},mk=async(n,a,s,i="Analysis, Synthesis, and Evaluation")=>{const c=In(),u=`
        You are an expert psychometrician. Analyze this instructional material about "${n}":
        ${a}
        
        TASK:
        Generate ${s} high-quality multiple-choice questions.
        
        REQUIREMENTS:
        1. Aim for Bloom's Taxonomy: ${i}.
        2. Each option must have a brief pedagogical explanation.
        3. Factual accuracy is paramount.
        
        JSON SCHEMA:
        {
            "questions": [
                {
                    "questionText": "...",
                    "bloomsLevel": "Analysis",
                    "options": [
                        { "id": "1", "text": "...", "explanation": "..." }
                    ],
                    "correctAnswerId": "1",
                    "detailedExplanation": "..."
                }
            ]
        }
    `,f=await c.models.generateContent({model:"gemini-3-flash-preview",contents:u,config:{responseMimeType:"application/json"}});return fr(f.text||"{}").questions||[]},gk=async(n,a)=>{const s=In(),i=n.sourceMaterial?`
CRITICAL SOURCE MATERIAL (PRIORITIZE THIS):
${n.sourceMaterial}
`:"",c=`
        You are a world-class instructional designer. Create a detailed curriculum for a deep-dive Hyper-Course on: "${n.topic}".
        Target Level: ${n.understanding}
        Persona: ${a.instruction}
        Target length: Approximately ${n.chapterCount||12} chapters.
        ${i}

        TASK:
        1. Generate a professional name and a 3-5 sentence HTML summary.
        2. Design a sequence of chapters (InfoCards) based on the topic ${n.sourceMaterial?"and strictly grounded in the provided source material":""}.
        3. For each chapter, provide a unique 'id', a title, and a detailed bulleted list of sub-topics.
        4. Define prerequisites using 'prerequisiteChapterIds'.
        5. Generate a "sharedDictionary" of 10-20 core technical terms and their canonical definitions for this course.
        
        JSON SCHEMA:
        {
            "name": "Course Title",
            "description": "Full course summary (HTML)",
            "sharedDictionary": { "TermA": "Definition A", "TermB": "Definition B" },
            "chapters": [
                {
                    "id": "chap-1",
                    "title": "Chapter Title",
                    "learningObjectives": ["Obj 1", "Obj 2"],
                    "topics": ["Topic A", "Topic B"],
                    "prerequisiteChapterIds": []
                }
            ]
        }
    `,u=await s.models.generateContent({model:"gemini-3-flash-preview",contents:c,config:{responseMimeType:"application/json"}});return fr(u.text||"{}")};async function*yk(n,a,s,i,c,u,f,p,b){const m=In(),_=b?`
CRITICAL SOURCE MATERIAL (STAY FAITHFUL TO THIS):
${b}
`:"",E=`
        Act as an expert subject matter expert and the following persona: ${c.name}.
        Persona Instructions: ${c.instruction}
        
        COURSE TOPIC: "${n}"
        CHAPTER ${i+1}/${s}: "${a.title}"
        LEARNING OBJECTIVES: ${a.learningObjectives.join(", ")}
        TOPICS TO COVER: ${a.topics.join(", ")}
        ${_}

        TERMINOLOGY LOCK: ${JSON.stringify(f)}
        COURSE PROGRESS STATE: ${p}
        
        TASK:
        Generate the full, detailed text for this chapter. 
        Target word count: ${u} words.
        
        REQUIREMENTS:
        1. Use aggressive HTML formatting (h2, h3, bold, blockquotes).
        2. If source material was provided, ensure every fact mentioned is grounded in that material. 
        3. Do not re-introduce concepts summarized in the COURSE PROGRESS STATE.
        
        OUTPUT FORMAT: Return raw HTML content.
    `,N=await m.models.generateContentStream({model:"gemini-3-pro-preview",contents:E,config:{thinkingConfig:{thinkingBudget:32768}}});for await(const S of N)S.text&&(yield S.text)}const vk=async(n,a,s,i,c,u,f,p,b)=>{const m=In(),_=b?`
CRITICAL SOURCE MATERIAL (STAY FAITHFUL TO THIS):
${b}
`:"",E=`
        Act as an expert subject matter expert and the following persona: ${c.name}.
        Persona Instructions: ${c.instruction}
        
        COURSE TOPIC: "${n}"
        CHAPTER ${i+1}/${s}: "${a.title}"
        ${_}

        TERMINOLOGY LOCK: ${JSON.stringify(f)}
        COURSE PROGRESS STATE: ${p}
        
        TASK:
        Generate the full, detailed text for this chapter inside a JSON object.
        Target word count: ${u} words.
        
        JSON SCHEMA:
        {
            "content": "Full HTML Content...",
            "summaryForArchivist": "A 1-paragraph summary of what was covered."
        }
    `,N=await m.models.generateContent({model:"gemini-3-pro-preview",contents:E,config:{responseMimeType:"application/json",thinkingConfig:{thinkingBudget:32768}}});return fr(N.text||"{}")},ob=async(n,a="Standard",s,i)=>{const c=In(),u=i?`
USER PROVIDED SOURCE MATERIAL (BASE EVERYTHING ON THIS):
${i}
`:"",f=`
        Act as a world-class SME. Create a ${s?"deep-dive course":"learning guide"} for the topic: "${n}".
        Desired Depth: ${a}
        ${u}
        
        REQUIREMENTS:
        1. Generate detailed instructional InfoCards (chapters) using rich HTML.
        2. If source material is provided, ONLY use the concepts found in that material.
        3. For EACH InfoCard, generate 1-4 multiple-choice questions with pedagogical explanations.
        4. Generate a professional name and description.
        
        JSON SCHEMA:
        {
            "name": "The Title",
            "description": "HTML summary",
            "infoCards": [ { "id": "chap-1", "content": "HTML...", "unlocksQuestionIds": ["q-1"] } ],
            "questions": [ { "id": "q-1", "questionText": "...", "options": [...], "correctAnswerId": "...", "detailedExplanation": "..." } ]
        }
    `,p=await c.models.generateContent({model:"gemini-3-pro-preview",contents:f,config:{thinkingConfig:{thinkingBudget:32768}}});return fr(p.text||"{}")},bk=async(n,a,s)=>{const i=In(),c=n.sourceMaterial?`
BASED ON THIS SOURCE MATERIAL:
${n.sourceMaterial}
`:"",u=`Generate a learning outline for ${n.topic} at ${n.understanding} level. ${c}`;return{outline:(await i.models.generateContent({model:"gemini-3-flash-preview",contents:u})).text||"",metadata:{name:n.topic}}},xk=async(n,a)=>{const s=In(),i=n.sourceMaterial?`
STAY FAITHFUL TO THIS SOURCE MATERIAL:
${n.sourceMaterial}
`:"",c=`
        Create a high-quality flashcard deck for: "${n.topic}".
        ${i}
        JSON SCHEMA: { "name": "...", "description": "...", "cards": [...] }
    `,u=await s.models.generateContent({model:"gemini-3-pro-preview",contents:c,config:{responseMimeType:"application/json"}});return fr(u.text||"{}")},nA=async()=>{try{return(await In().models.generateContent({model:"gemini-3-flash-preview",contents:"ping",config:{maxOutputTokens:5,thinkingConfig:{thinkingBudget:0}}})).text?{status:"ok",message:"Connection established successfully."}:{status:"error",message:"Received empty response from AI."}}catch(n){return console.error("AI Connectivity Test Failed:",n),{status:"error",message:n.message||"Unknown error occurred."}}},rA=async(n,a)=>{const s=In(),i=`
        Analyze the following educational content and suggest a high-quality name and a detailed, engaging HTML description.
        
        CONTENT:
        ${n}
        
        TASK:
        1. Suggest a concise, descriptive name (e.g., "Level 1.1: Introduction to X").
        2. Suggest a 2-4 sentence description using HTML tags like <b> and <i> for emphasis.
        
        JSON SCHEMA: { "name": "string", "description": "string (HTML)" }
        ONLY return raw JSON.
    `,c=await s.models.generateContent({model:"gemini-3-flash-preview",contents:i,config:{responseMimeType:"application/json"}});return fr(c.text||"{}")},_k=async(n,a,s)=>{const i=In(),c=`
        You are an Educational Archivist. Review the following summaries of chapters already completed in a course on "${n}".
        
        SHARED TERMINOLOGY LOCK:
        ${JSON.stringify(s)}
        
        CHAPTER SUMMARIES:
        ${a.join(`

`)}
        
        TASK:
        Generate a concise "Logical State Vector" summary.
        
        OUTPUT: Return only the plain text summary.
    `;return(await i.models.generateContent({model:"gemini-3-flash-preview",contents:c})).text||""},wk=async(n,a,s)=>{const i=In(),c=`
        Analyze this chapter about "${a}" in a course on "${n}".
        CONTENT: ${s}
        TASK: Use Google Search to verify every technical, historical, and scientific claim.
        JSON SCHEMA: { "isAccurate": boolean, "corrections": [ { "originalClaim": "...", "correction": "...", "source": "..." } ] }
    `,u=await i.models.generateContent({model:"gemini-3-pro-preview",contents:c,config:{tools:[{googleSearch:{}}],responseMimeType:"application/json"}});return fr(u.text||"{}")},Sk=async(n,a,s)=>{const i=In(),c=`
        Refine this content about "${n}" using verified corrections:
        ${JSON.stringify(s)}
        ORIGINAL: ${a}
        JSON SCHEMA: { "refinedContent": "..." }
    `,u=await i.models.generateContent({model:"gemini-3-pro-preview",contents:c,config:{responseMimeType:"application/json"}});return fr(u.text||"{}")},Ek=async(n,a)=>{const s=In(),i=`
        Generate an animated SVG diagram for this topic: ${n}.
        CONTENT: ${a}
        JSON SCHEMA: { "hasDiagram": boolean, "svgCode": "...", "caption": "..." }
    `,c=await s.models.generateContent({model:"gemini-3-pro-preview",contents:i,config:{responseMimeType:"application/json"}});return fr(c.text||"{}")},kk=async(n,a,s)=>{const i=In(),c=`
        Analyze this chapter: "${a}" on "${n}".
        CONTENT: ${s}
        TASK: Generate 3-5 challenging questions and refine HTML.
        JSON SCHEMA: { "refinedContent": "...", "questions": [...] }
    `,u=await i.models.generateContent({model:"gemini-3-pro-preview",contents:c,config:{responseMimeType:"application/json"}});return fr(u.text||"{}")},Ak=async(n,a,s)=>(await In().models.generateContent({model:"gemini-3-flash-preview",contents:"Refine this outline based on feedback."})).text||"",Tk=async(n,a)=>{const i=await In().models.generateContent({model:"gemini-3-pro-preview",contents:`Generate questions based on this outline: ${n}`,config:{responseMimeType:"application/json"}});return fr(i.text||"{}")},Ck=async(n,a)=>{const i=await In().models.generateContent({model:"gemini-3-flash-preview",contents:`Generate a series scaffold from this outline: ${n}`,config:{responseMimeType:"application/json"}});return fr(i.text||"{}")},Nk=async(n,a,s,i)=>{const c=In(),u=`
        Rework deck "${n.name}". Instructions: "${a.reworkInstructions}".
        CURRENT CONTENT: ${JSON.stringify(n)}
        JSON SCHEMA (MATCH ORIGINAL TYPE ${n.type}): { "name": "...", "description": "...", ... }
    `,f=await c.models.generateContent({model:"gemini-3-pro-preview",contents:u,config:{responseMimeType:"application/json",thinkingConfig:{thinkingBudget:32768}}});return fr(f.text||"{}")},Dk=async(n,a,s)=>{const c=await In().models.generateContent({model:"gemini-3-pro-preview",contents:`Generate ${a} questions for ${n.name}`,config:{responseMimeType:"application/json"}});return fr(c.text||"[]")},Ok=async n=>{const a=In(),s=`
        Upgrade deck "${n.name}" into a Learning Deck.
        EXISTING ITEMS: ${JSON.stringify(n)}
        JSON SCHEMA: { "infoCards": [ { "id": "...", "content": "...", "unlocksQuestionIds": [...] } ] }
    `,i=await a.models.generateContent({model:"gemini-3-pro-preview",contents:s,config:{responseMimeType:"application/json"}});return fr(i.text||"{}")},aA=async(n,a)=>(await In().models.generateContent({model:"gemini-3-flash-preview",contents:`Create a mnemonic for: ${n} means ${a}`})).text||"",sA=async(n,a)=>(await In().models.generateContent({model:"gemini-3-flash-preview",contents:`Explain like I'm 5: ${n}. Context: ${a}`})).text||"",lb=async n=>{var i,c,u,f,p,b;return((b=(p=(f=(u=(c=(i=(await In().models.generateContent({model:"gemini-2.5-flash-preview-tts",contents:[{parts:[{text:n}]}],config:{responseModalities:[Qh.AUDIO],speechConfig:{voiceConfig:{prebuiltVoiceConfig:{voiceName:"Kore"}}}}})).candidates)==null?void 0:i[0])==null?void 0:c.content)==null?void 0:u.parts)==null?void 0:f[0])==null?void 0:p.inlineData)==null?void 0:b.data)||""},jk=async(n,a,s,i)=>{const u=await In().models.generateContent({model:"gemini-3-pro-preview",contents:`Harden distractors for: ${n}.`,config:{responseMimeType:"application/json"}});return fr(u.text||"[]")},Ik=async(n,a,s)=>{const c=await In().models.generateContent({model:"gemini-3-flash-preview",contents:`Generate structure for ${n}.`,config:{responseMimeType:"application/json"}});return fr(c.text||"{}")},Rk=async(n,a,s,i)=>{const u=await In().models.generateContent({model:"gemini-3-flash-preview",contents:`Suggest decks for ${s} in ${n}.`,config:{responseMimeType:"application/json"}});return fr(u.text||"[]")},Mk=async(n,a)=>{const i=await In().models.generateContent({model:"gemini-3-pro-preview",contents:`Regenerate question for ${a}: ${JSON.stringify(n)}`,config:{responseMimeType:"application/json"}});return fr(i.text||"{}")},Uk=async n=>{const s=await In().models.generateContent({model:"gemini-3-pro-preview",contents:`Analyze deck quality: ${n.name}`,config:{responseMimeType:"application/json"}});return fr(s.text||"[]")},Lk=async(n,a)=>{const i=await In().models.generateContent({model:"gemini-3-pro-preview",contents:`Improve deck based on suggestions: ${JSON.stringify(a)}`,config:{responseMimeType:"application/json"}});return fr(i.text||"{}")},zk=async(n,a,s)=>{const c=await In().models.generateContent({model:"gemini-2.5-flash-image",contents:{parts:[{inlineData:{data:n,mimeType:a}},{text:`Create deck from image. Hint: ${s}`}]}});return fr(c.text||"{}")},Bk=({isOpen:n,onClose:a,params:s})=>{const[i,c]=$.useState([]),[u,f]=$.useState(!0),[p,b]=$.useState(""),[m,_]=$.useState({}),[E,N]=$.useState(""),{options:S}=Fc();_l();const{addToast:I}=Ar(),{dispatch:A,deckSeries:k}=kt(),R=$.useRef(null),P=$.useRef(!1);$.useEffect(()=>{var W;(W=R.current)==null||W.scrollIntoView({behavior:"smooth"})},[i]),$.useEffect(()=>{if(!n){P.current=!1;return}if(P.current)return;P.current=!0,(async()=>{f(!0),c([]);const H=S.personas.find(Q=>Q.id===s.persona)||S.personas[0],L=s.seriesId?k[s.seriesId]:null,U=L?{name:L.name,description:L.description}:void 0;try{const{outline:Q,metadata:le}=await bk(s,H,U);b(Q),_(le),c([{id:crypto.randomUUID(),role:"model",text:`Here is a draft outline for your ${s.generationType.startsWith("series-")?"series":"deck"} on "${s.topic}":

${Q}`}])}catch(Q){const le=Q instanceof Error?Q.message:"Failed to generate initial outline.";I(le,"error"),c([{id:crypto.randomUUID(),role:"model",text:`Sorry, I couldn't generate an outline. Error: ${le}`}])}finally{f(!1)}})()},[n,s,S.personas,I,k]);const q=async W=>{W.preventDefault();const H=E.trim();if(!H||u)return;N("");const L={id:crypto.randomUUID(),role:"user",text:H},U=[...i,L];c(U),f(!0);const Q=S.personas.find(le=>le.id===s.persona)||S.personas[0];try{const le=await Ak(U,s,Q);b(le),c(F=>[...F,{id:crypto.randomUUID(),role:"model",text:`Here is the refined outline:

${le}`}])}catch(le){const F=le instanceof Error?le.message:"Failed to refine outline.";I(F,"error"),c(te=>[...te,{id:crypto.randomUUID(),role:"model",text:`Sorry, I had trouble with that request. Error: ${F}`}])}finally{f(!1)}},G=async()=>{const W=crypto.randomUUID(),{generationType:H}=s;if(H.startsWith("series-")){const L={id:W,type:"generateFullSeriesFromScaffold",payload:{outline:p,generationType:s.generationType},statusText:`Generating series structure for "${s.topic}"`};A({type:"ADD_AI_TASK_TO_QUEUE",payload:L}),I("Series generation started. Check the status indicator below.","info")}else if(["deck-flashcard","deck-vocab","deck-atomic"].includes(H)){const L={id:W,type:"generateFlashcardDeckWithAI",payload:s,statusText:`Generating flashcards for "${s.topic}"`};A({type:"ADD_AI_TASK_TO_QUEUE",payload:L}),I("Flashcard generation started. Check the status indicator below.","info")}else if(["single-deck-learning","deck-course"].includes(H)){const L={id:W,type:"generateLearningDeckWithAI",payload:s,statusText:`Generating learning content for "${s.topic}"`};A({type:"ADD_AI_TASK_TO_QUEUE",payload:L}),I("Learning content generation started. Check the status indicator below.","info")}else if(["single-deck-quiz","quiz-blooms"].includes(H)){const L={id:W,type:"generateDeckFromOutline",payload:{outline:p,metadata:m,seriesId:s.seriesId,levelIndex:s.levelIndex},statusText:`Generating deck content for "${s.topic}"`};A({type:"ADD_AI_TASK_TO_QUEUE",payload:L}),I("Deck generation started. Check the status indicator below.","info")}a()},Y=W=>W.replace(/^### (.*$)/gim,'<h3 class="text-lg font-bold mt-2">$1</h3>').replace(/^## (.*$)/gim,'<h2 class="text-xl font-bold mt-3 border-b border-border pb-1">$1</h2>').replace(/^# (.*$)/gim,'<h1 class="text-2xl font-bold mt-4 mb-2">$1</h1>').replace(/\*\*(.*?)\*\*/g,"<b>$1</b>").replace(/\*(.*?)\*/g,"<i>$1</i>").replace(/^- (.*$)/gim,'<li class="ml-4">$1</li>').replace(/```([\s\S]*?)```/g,'<pre class="bg-gray-800 text-white p-2 rounded my-2 overflow-x-auto text-xs"><code>$1</code></pre>').replace(/`([^`]+)`/g,'<code class="bg-gray-200 dark:bg-gray-700 px-1 rounded text-sm font-mono">$1</code>').replace(/\n/g,"<br />");return n?l.jsxs("div",{className:"fixed inset-0 bg-black/50 z-[70] flex flex-col items-center justify-end",onClick:a,children:[l.jsxs("div",{className:"bg-surface w-full max-w-3xl h-[85vh] max-h-[800px] rounded-t-2xl shadow-2xl flex flex-col transform transition-transform duration-300 animate-fade-in",style:{animationName:"slideUp",animationDuration:"0.3s"},onClick:W=>W.stopPropagation(),children:[l.jsxs("header",{className:"flex-shrink-0 flex items-center justify-between p-4 border-b border-border",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(rt,{name:"bot",className:"w-6 h-6 text-primary"}),l.jsx("h2",{className:"text-xl font-bold text-text",children:"AI Content Generation"})]}),l.jsx(pt,{variant:"ghost",onClick:a,className:"p-1 h-auto",children:l.jsx(rt,{name:"x"})})]}),l.jsx("main",{className:"flex-grow p-4 overflow-y-auto",children:l.jsxs("div",{className:"space-y-4",children:[i.map(W=>l.jsxs("div",{className:`flex gap-3 ${W.role==="user"?"justify-end":"justify-start"}`,children:[W.role==="model"&&l.jsx(rt,{name:"bot",className:"w-6 h-6 text-primary flex-shrink-0 mt-1"}),l.jsx("div",{className:`max-w-xl p-3 rounded-2xl ${W.role==="user"?"bg-primary text-on-primary rounded-br-lg":"bg-background rounded-bl-lg"}`,children:l.jsx(c0,{html:Y(W.text),className:"prose dark:prose-invert max-w-none text-sm"})})]},W.id)),u&&l.jsxs("div",{className:"flex justify-start gap-3",children:[l.jsx(rt,{name:"bot",className:"w-6 h-6 text-primary flex-shrink-0 mt-1"}),l.jsx("div",{className:"max-w-xl p-3 rounded-2xl bg-background rounded-bl-lg",children:l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(Rs,{size:"sm"}),l.jsx("span",{className:"text-text-muted",children:"Thinking..."})]})})]}),l.jsx("div",{ref:R})]})}),l.jsxs("footer",{className:"flex-shrink-0 p-4 border-t border-border space-y-3",children:[l.jsxs("form",{onSubmit:q,className:"flex items-center gap-2",children:[l.jsx("input",{type:"text",value:E,onChange:W=>N(W.target.value),placeholder:"Refine the outline...",className:"flex-grow p-2 bg-background border border-border rounded-full focus:ring-2 focus:ring-primary focus:outline-none px-4",disabled:u}),l.jsx(pt,{type:"submit",variant:"secondary",className:"rounded-full w-10 h-10 p-0","aria-label":"Send message",disabled:u,children:l.jsx(rt,{name:"arrow-down",className:"w-5 h-5 -rotate-90"})})]}),l.jsxs("div",{className:"flex justify-end gap-2",children:[l.jsx(pt,{variant:"secondary",onClick:a,disabled:u,children:"Cancel"}),l.jsxs(pt,{variant:"primary",onClick:G,disabled:u||i.length===0,children:[l.jsx(rt,{name:"zap",className:"w-5 h-5 mr-2"}),`Generate ${s.generationType.startsWith("series-")?"Series":"Deck"}`]})]})]})]}),l.jsx("style",{children:`
              @keyframes slideUp {
                from { transform: translateY(100%); }
                to { transform: translateY(0); }
              }
            `})]}):null},Fk=({isOpen:n,onClose:a,deck:s,onUpdateDeck:i})=>{const[c,u]=$.useState("analyzing"),[f,p]=$.useState([]),[b,m]=$.useState(new Set),{addToast:_}=Ar(),E=$.useRef(null);kr(E,n),$.useEffect(()=>{n&&c==="analyzing"&&(async()=>{try{const R=await Uk(s);p(R),m(new Set(R.map(P=>P.id))),u("review")}catch{_("Analysis failed. Please try again.","error"),a()}})()},[n,s,_,a,c]);const N=k=>{const R=new Set(b);R.has(k)?R.delete(k):R.add(k),m(R)},S=async()=>{u("applying");try{const k=f.filter(P=>b.has(P.id)),R=await Lk(s,k);i(R,{toastMessage:"Deck improvements applied successfully!"}),a()}catch{_("Failed to apply improvements.","error"),u("review")}},I=$.useMemo(()=>{const k={general:{label:"General Improvements",icon:"zap",items:[]},chapters:{label:"Chapters (InfoCards)",icon:"book-open",items:[]},questions:{label:"Questions & Quizzes",icon:"help-circle",items:[]}};return f.forEach(R=>{if(!R.targetId){k.general.items.push(R);return}if(s.type===et.Learning&&s.infoCards.some(q=>q.id===R.targetId)){k.chapters.items.push(R);return}k.questions.items.push(R)}),Object.entries(k).filter(([R,P])=>P.items.length>0)},[f,s]),A=k=>{var q,G;if(!k)return null;if(s.type===et.Learning){const Y=s.infoCards.find(W=>W.id===k);if(Y)return`Chapter: ${wc(Y.content).substring(0,40)}...`}const R=(q=s.questions)==null?void 0:q.find(Y=>Y.id===k);if(R)return`Question: ${wc(R.questionText).substring(0,40)}...`;const P=(G=s.cards)==null?void 0:G.find(Y=>Y.id===k);return P?`Card: ${wc(P.front).substring(0,40)}...`:null};return n?l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-[70] p-4",children:l.jsxs("div",{ref:E,className:"bg-surface rounded-lg shadow-xl w-full max-w-2xl transform transition-all relative flex flex-col max-h-[90vh]",children:[l.jsxs("header",{className:"flex-shrink-0 flex justify-between items-center p-4 border-b border-border",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(rt,{name:"zap",className:"w-6 h-6 text-primary"}),l.jsx("h2",{className:"text-xl font-bold text-text",children:"AI Deck Analyzer"})]}),l.jsx(pt,{type:"button",variant:"ghost",onClick:a,className:"p-1 h-auto","aria-label":"Close",children:l.jsx(rt,{name:"x"})})]}),l.jsxs("main",{className:"flex-grow p-6 overflow-y-auto no-scrollbar",children:[c==="analyzing"&&l.jsxs("div",{className:"flex flex-col items-center justify-center h-64 text-center",children:[l.jsx(Rs,{size:"lg"}),l.jsx("p",{className:"mt-4 text-lg font-medium text-text",children:"Analyzing deck content..."}),l.jsx("p",{className:"text-sm text-text-muted",children:"Checking for pedagogical alignment, accuracy, and clarity."})]}),c==="applying"&&l.jsxs("div",{className:"flex flex-col items-center justify-center h-64 text-center",children:[l.jsx(Rs,{size:"lg"}),l.jsx("p",{className:"mt-4 text-lg font-medium text-text",children:"Applying improvements..."}),l.jsx("p",{className:"text-sm text-text-muted",children:"Rewriting content and refining instructional flow."})]}),c==="review"&&l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{className:"flex justify-between items-center bg-background p-3 rounded-lg border border-border",children:[l.jsxs("p",{className:"text-sm text-text-muted",children:["Pedagogical Review for ",l.jsx("b",{children:s.name})]}),l.jsxs("div",{className:"text-xs space-x-3",children:[l.jsx("button",{onClick:()=>m(new Set(f.map(k=>k.id))),className:"text-primary font-semibold hover:underline",children:"Select All"}),l.jsx("button",{onClick:()=>m(new Set),className:"text-text-muted font-semibold hover:underline",children:"Clear"})]})]}),f.length===0?l.jsxs("div",{className:"text-center py-10 border-2 border-dashed border-border rounded-lg",children:[l.jsx(rt,{name:"check-circle",className:"w-12 h-12 text-green-500 mx-auto mb-2"}),l.jsx("p",{className:"text-text font-medium",children:"No pedagogical issues found!"}),l.jsx("p",{className:"text-text-muted text-sm",children:"Your learning deck is structured perfectly."})]}):l.jsx("div",{className:"space-y-8",children:I.map(([k,R])=>l.jsxs("section",{className:"animate-fade-in",children:[l.jsxs("h3",{className:"text-xs font-bold text-text-muted uppercase tracking-widest mb-3 flex items-center gap-2",children:[l.jsx(rt,{name:R.icon,className:"w-4 h-4"}),R.label]}),l.jsx("ul",{className:"space-y-3",children:R.items.map(P=>{const q=A(P.targetId);return l.jsxs("li",{className:"p-4 bg-background rounded-lg border border-border flex gap-4 transition-all hover:border-primary/50 group",children:[l.jsx("div",{className:"pt-1",children:l.jsx("input",{type:"checkbox",checked:b.has(P.id),onChange:()=>N(P.id),className:"w-5 h-5 text-primary rounded border-gray-300 focus:ring-primary cursor-pointer"})}),l.jsxs("div",{className:"flex-grow min-w-0",children:[l.jsxs("div",{className:"flex justify-between items-start mb-1",children:[l.jsx("h4",{className:"font-bold text-text leading-tight",children:P.title}),l.jsx("span",{className:"text-[10px] px-2 py-0.5 rounded-full bg-surface border border-border font-bold uppercase tracking-tighter text-text-muted whitespace-nowrap ml-2",children:P.category})]}),q&&l.jsx("p",{className:"text-[10px] font-semibold text-primary/80 mb-2 truncate italic",children:q}),l.jsx("p",{className:"text-sm text-text leading-relaxed",children:P.description}),l.jsxs("div",{className:"mt-2 flex items-start gap-1 text-xs text-text-muted bg-primary/5 p-2 rounded italic",children:[l.jsx(rt,{name:"info",className:"w-3.5 h-3.5 flex-shrink-0 mt-0.5 text-primary"}),l.jsx("span",{children:P.rationale})]})]})]},P.id)})})]},k))})]})]}),l.jsx("footer",{className:"flex-shrink-0 p-4 border-t border-border flex justify-end gap-2 bg-background/50",children:c==="review"&&l.jsxs(l.Fragment,{children:[l.jsx(pt,{variant:"secondary",onClick:a,children:"Cancel"}),l.jsxs(pt,{variant:"primary",onClick:S,disabled:b.size===0,children:["Apply ",b.size," Improvement",b.size!==1?"s":""]})]})})]})}):null},Hk=(n,a,s,i)=>{const c=[],u=[];n.forEach(b=>{if(b.suspended)return;const m={id:b.id,dueDate:b.dueDate,interval:b.interval,easeFactor:b.easeFactor,lapses:b.lapses,masteryLevel:b.masteryLevel||0,isNew:b.interval===0};m.isNew?u.push(m):c.push(m)});const f=[],p=new Date;p.setHours(0,0,0,0);for(let b=0;b<a;b++){const m=new Date(p);m.setDate(p.getDate()+b);const _=new Date(m).setHours(23,59,59,999),E=[],N=[];c.forEach(A=>{new Date(A.dueDate).getTime()<=_?E.push(A):N.push(A)});const S=[];E.forEach(A=>{const R=Math.random()<i?La.Good:La.Again;let P=0,q=A.easeFactor;R===La.Again?(P=1,q=Math.max(1.3,A.easeFactor-.2)):(q=A.easeFactor,A.interval===0?P=1:P=Math.ceil(A.interval*A.easeFactor));const G=new Date(m);G.setDate(m.getDate()+P);const Y={...A,interval:P,easeFactor:q,dueDate:G.toISOString(),isNew:!1};S.push(Y)}),S.forEach(A=>N.push(A)),c.length=0,N.forEach(A=>c.push(A));const I=Math.min(s,u.length);for(let A=0;A<I;A++){const k=u.shift();if(k){const R=new Date(m);R.setDate(m.getDate()+1);const P={...k,interval:1,dueDate:R.toISOString(),isNew:!1};c.push(P)}}f.push({day:b,date:m.toLocaleDateString(void 0,{month:"short",day:"numeric"}),reviewCount:E.length,newCount:I,totalLoad:E.length+I})}return f},Pk=({data:n})=>{if(n.length===0)return null;const a=Math.max(...n.map(_=>_.totalLoad),10),s=500,i=250,c={top:20,right:10,bottom:30,left:40},u=s-c.left-c.right,f=i-c.top-c.bottom,p=n,b=Math.max(2,u/p.length-1),m=_=>f-_/a*f;return l.jsxs("svg",{viewBox:`0 0 ${s} ${i}`,className:"w-full h-full overflow-visible",children:[[0,.25,.5,.75,1].map(_=>{const E=Math.round(a*_),N=m(E)+c.top;return l.jsxs("g",{children:[l.jsx("line",{x1:c.left,y1:N,x2:s-c.right,y2:N,className:"stroke-border/50",strokeDasharray:"3,3"}),l.jsx("text",{x:c.left-5,y:N+4,className:"text-[10px] fill-text-muted",textAnchor:"end",children:E})]},_)}),p.map((_,E)=>{const N=c.left+E*(u/p.length),S=m(_.totalLoad)+c.top,I=f-m(_.totalLoad),A=_.newCount/_.totalLoad*I||0,k=I-A,R=S,P=S+A;return l.jsxs("g",{className:"group",children:[l.jsx("title",{children:`${_.date}: ${_.reviewCount} reviews + ${_.newCount} new = ${_.totalLoad} total`}),_.newCount>0&&l.jsx("rect",{x:N,y:R,width:b,height:A,className:"fill-blue-400 dark:fill-blue-500 hover:fill-blue-300 transition-colors"}),_.reviewCount>0&&l.jsx("rect",{x:N,y:P,width:b,height:k,className:"fill-green-500 dark:fill-green-600 hover:fill-green-400 transition-colors"})]},E)}),p.map((_,E)=>E%Math.ceil(p.length/5)===0?l.jsx("text",{x:c.left+E*(u/p.length)+b/2,y:i-10,className:"text-[10px] fill-text-muted",textAnchor:"middle",children:_.date},E):null)]})},qk=({isOpen:n,onClose:a,items:s})=>{const[i,c]=$.useState(30),[u,f]=$.useState(0),[p,b]=$.useState(90),[m,_]=$.useState(!1),[E,N]=$.useState([]),S=$.useRef(null);kr(S,n),$.useEffect(()=>{if(!n)return;_(!0);const A=setTimeout(()=>{const k=Hk(s,i,u,p/100);N(k),_(!1)},100);return()=>clearTimeout(A)},[i,u,p,s,n]);const I=$.useMemo(()=>{if(E.length===0)return null;const A=Math.max(...E.map(P=>P.totalLoad)),k=Math.round(E.reduce((P,q)=>P+q.totalLoad,0)/E.length),R=E.reduce((P,q)=>P+q.newCount,0);return{maxLoad:A,avgLoad:k,totalNew:R}},[E]);return n?l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-[60] p-4",children:l.jsxs("div",{ref:S,className:"bg-surface rounded-lg shadow-xl w-full max-w-3xl transform transition-all relative max-h-[90vh] flex flex-col",children:[l.jsxs("div",{className:"flex justify-between items-center p-4 border-b border-border",children:[l.jsxs("h2",{className:"text-xl font-bold text-text flex items-center gap-2",children:[l.jsx(rt,{name:"trending-up",className:"text-primary"})," Workload Simulator"]}),l.jsx(pt,{type:"button",variant:"ghost",onClick:a,className:"p-1 h-auto",children:l.jsx(rt,{name:"x"})})]}),l.jsx("div",{className:"p-6 overflow-y-auto flex-grow space-y-6",children:l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[l.jsxs("div",{className:"space-y-4 md:col-span-1 border-b md:border-b-0 md:border-r border-border pb-4 md:pb-0 md:pr-4",children:[l.jsxs("div",{children:[l.jsxs("label",{className:"block text-sm font-medium text-text-muted mb-1",children:["Duration: ",i," days"]}),l.jsx("input",{type:"range",min:"7",max:"180",step:"7",value:i,onChange:A=>c(Number(A.target.value)),className:"w-full accent-primary"})]}),l.jsxs("div",{children:[l.jsxs("label",{className:"block text-sm font-medium text-text-muted mb-1",children:["New Cards / Day: ",u]}),l.jsx("input",{type:"range",min:"0",max:"50",step:"5",value:u,onChange:A=>f(Number(A.target.value)),className:"w-full accent-primary"})]}),l.jsxs("div",{children:[l.jsxs("label",{className:"block text-sm font-medium text-text-muted mb-1",children:["Est. Retention: ",p,"%"]}),l.jsx("input",{type:"range",min:"70",max:"99",step:"1",value:p,onChange:A=>b(Number(A.target.value)),className:"w-full accent-primary"})]}),I&&l.jsxs("div",{className:"bg-background rounded-lg p-3 space-y-2 text-sm border border-border",children:[l.jsxs("div",{className:"flex justify-between",children:[l.jsx("span",{className:"text-text-muted",children:"Peak Load:"}),l.jsx("span",{className:"font-bold text-text",children:I.maxLoad})]}),l.jsxs("div",{className:"flex justify-between",children:[l.jsx("span",{className:"text-text-muted",children:"Average Load:"}),l.jsx("span",{className:"font-bold text-text",children:I.avgLoad})]}),l.jsxs("div",{className:"flex justify-between",children:[l.jsx("span",{className:"text-text-muted",children:"Total New:"}),l.jsx("span",{className:"font-bold text-blue-500",children:I.totalNew})]})]})]}),l.jsxs("div",{className:"md:col-span-2 h-64 md:h-auto flex flex-col",children:[l.jsxs("div",{className:"flex items-center gap-4 text-xs text-text-muted mb-2 justify-end",children:[l.jsxs("div",{className:"flex items-center gap-1",children:[l.jsx("span",{className:"w-3 h-3 bg-blue-400 rounded-sm"})," New Cards"]}),l.jsxs("div",{className:"flex items-center gap-1",children:[l.jsx("span",{className:"w-3 h-3 bg-green-500 rounded-sm"})," Reviews"]})]}),l.jsx("div",{className:"flex-grow relative bg-background/50 rounded-lg border border-border p-2",children:m?l.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-surface/50 backdrop-blur-sm",children:l.jsx(Rs,{size:"lg"})}):l.jsx(Pk,{data:E})}),l.jsx("p",{className:"text-xs text-text-muted mt-2 text-center",children:"This is a projection based on the SM-2 algorithm. Actual workload may vary."})]})]})}),l.jsx("div",{className:"flex justify-end p-4 bg-background/50 border-t border-border",children:l.jsx(pt,{type:"button",variant:"primary",onClick:a,children:"Done"})})]})}):null},Gk=({isOpen:n,onClose:a,data:s,title:i,filename:c="data.json"})=>{const u=$.useRef(null),{addToast:f}=Ar();kr(u,n);const p=Yi.useMemo(()=>JSON.stringify(s,null,2),[s]),b=()=>{navigator.clipboard.writeText(p).then(()=>{f("JSON copied to clipboard!","success")}).catch(_=>{f("Failed to copy JSON.","error")})},m=()=>{const _=new Blob([p],{type:"application/json"}),E=URL.createObjectURL(_),N=document.createElement("a");N.href=E,N.download=c,document.body.appendChild(N),N.click(),document.body.removeChild(N),URL.revokeObjectURL(E),f("Download started.","success")};return n?l.jsx("div",{className:"fixed inset-0 bg-black/75 flex items-center justify-center z-[70] p-4",children:l.jsxs("div",{ref:u,className:"bg-surface rounded-lg shadow-xl w-full max-w-2xl transform transition-all relative max-h-[90vh] flex flex-col",children:[l.jsxs("header",{className:"flex-shrink-0 flex justify-between items-center p-4 border-b border-border",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(rt,{name:"code",className:"w-6 h-6 text-primary"}),l.jsx("h2",{className:"text-xl font-bold text-text",children:i})]}),l.jsx(pt,{type:"button",variant:"ghost",onClick:a,className:"p-1 h-auto",children:l.jsx(rt,{name:"x"})})]}),l.jsx("main",{className:"flex-grow p-4 overflow-hidden flex flex-col",children:l.jsx("div",{className:"flex-grow bg-background rounded-lg border border-border overflow-auto p-4 font-mono text-xs text-text-muted",children:l.jsx("pre",{children:p})})}),l.jsxs("footer",{className:"flex-shrink-0 p-4 border-t border-border flex justify-end gap-2 bg-background/50",children:[l.jsxs(pt,{variant:"secondary",onClick:b,children:[l.jsx(rt,{name:"save",className:"w-4 h-4 mr-2"})," Copy to Clipboard"]}),l.jsxs(pt,{variant:"primary",onClick:m,children:[l.jsx(rt,{name:"download",className:"w-4 h-4 mr-2"})," Download .json"]})]})]})}):null},Kk=({label:n,checked:a,onChange:s,description:i,disabled:c=!1})=>{const u=Yi.useId();return l.jsxs("div",{className:`flex items-center justify-between ${c?"opacity-50":""}`,children:[l.jsxs("span",{className:"flex flex-col",children:[l.jsx("label",{htmlFor:u,className:`font-medium text-text ${c?"cursor-not-allowed":"cursor-pointer"}`,children:n}),i&&l.jsx("span",{id:`${u}-description`,className:"text-sm text-text-muted",children:i})]}),l.jsx("button",{id:u,type:"button",role:"switch","aria-checked":a,"aria-describedby":i?`${u}-description`:void 0,onClick:()=>s(!a),disabled:c,className:`${a?"bg-primary":"bg-border"} relative inline-flex h-6 w-11 flex-shrink-0 cursor-pointer rounded-full border-2 border-transparent transition-colors duration-200 ease-in-out focus:outline-none focus:ring-2 focus:ring-primary focus:ring-offset-2 dark:focus:ring-offset-surface`,children:l.jsx("span",{"aria-hidden":"true",className:`${a?"translate-x-5":"translate-x-0"} pointer-events-none inline-block h-5 w-5 transform rounded-full bg-white shadow ring-0 transition duration-200 ease-in-out`})})]})},Yk=({isOpen:n,onClose:a,onConfirm:s,title:i,type:c})=>{const{options:u}=Fc(),[f,p]=$.useState(c==="text"?"the_master":"default"),[b,m]=$.useState(500),[_,E]=$.useState("standard"),[N,S]=$.useState(!0),I=$.useRef(null);kr(I,n);const A=()=>{const k={persona:f,targetWordCount:c==="text"?b:void 0,count:c==="questions"?Math.floor(b/100):void 0,analogyIntensity:c==="text"?_:void 0,thinkingBudget:N?32768:0};s(k),a()};return n?l.jsx("div",{className:"fixed inset-0 bg-black/75 flex items-center justify-center z-[70] p-4",children:l.jsxs("div",{ref:I,className:"bg-surface rounded-xl shadow-2xl w-full max-w-md transform transition-all relative overflow-hidden flex flex-col",children:[l.jsxs("header",{className:"p-4 border-b border-border bg-background/50 flex justify-between items-center",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(rt,{name:"bot",className:"w-5 h-5 text-primary"}),l.jsx("h2",{className:"font-bold text-lg",children:"Synthesis Studio"})]}),l.jsx(pt,{variant:"ghost",onClick:a,className:"p-1 h-auto",children:l.jsx(rt,{name:"x"})})]}),l.jsxs("div",{className:"p-6 space-y-6",children:[l.jsxs("div",{className:"text-center mb-2",children:[l.jsx("h3",{className:"font-bold text-text",children:i}),l.jsx("p",{className:"text-xs text-text-muted mt-1",children:"Configure your conceptual transformer settings."})]}),l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-xs font-black text-text-muted uppercase tracking-tighter mb-2",children:"Instructional Persona"}),l.jsx("div",{className:"grid grid-cols-2 gap-2",children:u.personas.slice(0,6).map(k=>l.jsx("button",{onClick:()=>p(k.id),className:`text-left p-2 rounded-lg border text-xs transition-all ${f===k.id?"border-primary bg-primary/10 ring-1 ring-primary":"border-border bg-background hover:border-primary/50"}`,children:l.jsx("p",{className:"font-bold",children:k.name})},k.id))})]}),l.jsxs("div",{children:[l.jsxs("div",{className:"flex justify-between items-center mb-2",children:[l.jsx("label",{className:"text-xs font-black text-text-muted uppercase tracking-tighter",children:c==="text"?"Expansion Density":"Question Volume"}),l.jsx("span",{className:"text-[10px] font-bold bg-primary/10 text-primary px-2 py-0.5 rounded",children:c==="text"?`${b} words`:`${Math.floor(b/100)} items`})]}),l.jsx("input",{type:"range",min:100,max:c==="text"?2e3:1e3,step:100,value:b,onChange:k=>m(Number(k.target.value)),className:"w-full accent-primary"})]}),c==="text"&&l.jsxs("div",{children:[l.jsx("label",{className:"block text-xs font-black text-text-muted uppercase tracking-tighter mb-2",children:"Analogy Architecture"}),l.jsx("div",{className:"flex bg-background rounded-lg p-1 border border-border",children:["none","standard","aggressive"].map(k=>l.jsx("button",{onClick:()=>E(k),className:`flex-1 py-1 rounded-md text-[10px] font-bold uppercase transition-all ${_===k?"bg-primary text-on-primary shadow-sm":"text-text-muted hover:text-text"}`,children:k},k))})]}),l.jsx("div",{className:"pt-2 border-t border-border",children:l.jsx(Kk,{label:"Hyper-Reasoning Mode",checked:N,onChange:S,description:"Uses higher token budget for synthesis."})})]})]}),l.jsxs("footer",{className:"p-4 bg-background/50 border-t border-border flex justify-end gap-2",children:[l.jsx(pt,{variant:"secondary",onClick:a,children:"Cancel"}),l.jsx(pt,{variant:"primary",onClick:A,className:"px-6 font-bold",children:"Start Upgrade"})]})]})}):null},$k=({driveFiles:n})=>{const{modalType:a,modalPayload:s,closeModal:i,openModal:c}=zc(),u=_l(),{aiChatHistory:f}=kt(),p=np(),{navigate:b}=si();if(!a)return null;const m=s||{},_=()=>p.reduce((E,N)=>N.type===et.Flashcard?E.concat(N.cards||[]):E.concat(N.questions||[]),[]);return l.jsxs(l.Fragment,{children:[a==="import"&&l.jsx(GS,{isOpen:!0,onClose:i,onAddDecks:u.handleAddDecks,onAddSeriesWithDecks:u.handleAddSeriesWithDecks}),a==="restore"&&l.jsx(YS,{isOpen:!0,onClose:i,onCompare:u.handleCompareBackup,onRestoreSelected:u.handleRestoreSelectedItems,file:m.file,onFullRestore:u.onRestoreData,openConfirmModal:E=>c("confirm",E)}),a==="resetProgress"&&l.jsx($S,{isOpen:!0,onClose:i,onReset:u.handleResetDeckProgress,decks:p}),a==="confirm"&&l.jsx(VS,{isOpen:!0,onClose:i,...m}),a==="folder"&&l.jsx(ZS,{isOpen:!0,onClose:i,onSave:u.handleSaveFolder,folder:m.folder==="new"?null:m.folder}),a==="series"&&l.jsx(QS,{isOpen:!0,onClose:i,onSave:u.handleSaveSeries,series:m.series==="new"?null:m.series}),a==="aiGeneration"&&l.jsx(e1,{isOpen:!0,onClose:i,onStartAIGeneration:u.handleStartAIGeneration,initialTopic:m.initialTopic,context:m.context}),a==="aiGenerationChat"&&l.jsx(Bk,{isOpen:!0,onClose:i,params:m.params}),a==="aiStatus"&&l.jsx(t1,{isOpen:!0,onClose:i,onCancel:u.handleCancelAIGeneration}),a==="serverBackup"&&l.jsx(nE,{isOpen:!0,onClose:i,onRestore:u.handleRestoreFromServerBackup,onDelete:u.handleDeleteServerBackup}),a==="droppedFile"&&l.jsx(rE,{isOpen:!0,onClose:i,onConfirm:u.handleDroppedFileConfirm,analysis:m.analysis}),a==="aiChat"&&l.jsx(ck,{isOpen:!0,onClose:i,onExecuteAction:u.handleExecuteAIAction,history:f}),a==="restoreFromDrive"&&l.jsx(uk,{isOpen:!0,onClose:i,onRestore:u.handleRestoreFromDrive,files:n}),a==="addDeckToSeries"&&l.jsx(hk,{isOpen:!0,onClose:i,onAddDeck:E=>u.handleAddDeckToSeries(m.seriesId,E)}),a==="mergeConflict"&&l.jsx(dk,{isOpen:!0,onClose:i,onResolve:u.handleMergeResolution,comparison:m.comparison,remoteData:m.remoteData}),a==="commandPalette"&&l.jsx(fk,{isOpen:!0,onClose:i,actions:[{id:"import",label:"Create / Import Deck",icon:"plus",action:()=>c("import"),keywords:["new","add"]},{id:"settings",label:"Settings",icon:"settings",action:()=>b("/settings")},{id:"trash",label:"View Trash",icon:"trash-2",action:()=>b("/trash")},{id:"archive",label:"View Archive",icon:"archive",action:()=>b("/archive")},{id:"progress",label:"View Progress",icon:"trending-up",action:()=>b("/progress")},{id:"simulate",label:"Simulate Workload",icon:"trending-up",action:()=>c("workloadSimulator")}]}),a==="aiResponseFix"&&l.jsx(pk,{isOpen:!0,onClose:i,...m}),a==="deckAnalysis"&&l.jsx(Fk,{isOpen:!0,onClose:i,deck:m.deck,onUpdateDeck:u.handleUpdateDeck}),a==="workloadSimulator"&&l.jsx(qk,{isOpen:!0,onClose:i,items:_()}),a==="viewJson"&&l.jsx(Gk,{isOpen:!0,onClose:i,...m}),a==="synthesisConfig"&&l.jsx(Yk,{isOpen:!0,onClose:i,...m})]})},Vk=({onOpen:n,onCancel:a})=>{const{currentTask:s,queue:i,streamingDrafts:c}=kt(S=>S.aiGenerationStatus),{aiFeaturesEnabled:u}=Xi(),f=s!==null,p=(i==null?void 0:i.length)||0,b=(f?1:0)+p;if(!u||b===0)return null;const m=(s==null?void 0:s.type)==="generateDeepCourse",_=Object.keys(c).pop(),E=_?c[_].slice(-60):null,N=E?`...${E}`:(s==null?void 0:s.statusText)||`${p} task(s) queued...`;return l.jsxs("div",{className:"fixed bottom-6 left-6 z-40",children:[l.jsxs("button",{onClick:n,className:`bg-surface rounded-lg shadow-lg flex items-center p-2 gap-3 transition-all hover:shadow-xl animate-fade-in border-l-4 ${f?"border-primary":"border-text-muted"} min-w-[240px]`,"aria-label":"View AI generation status",children:[l.jsxs("div",{className:"relative w-10 h-10 flex items-center justify-center flex-shrink-0",children:[l.jsx("svg",{className:"absolute w-full h-full",style:{animation:f?"spin 1.5s linear infinite":"none"},viewBox:"0 0 24 24",children:l.jsx("circle",{cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"2",fill:"none",className:f?"text-primary/50":"text-text-muted/50",strokeDasharray:f?"40 100":"5 15"})}),l.jsx(rt,{name:m?"layers":"bot",className:`w-6 h-6 ${f?"text-primary":"text-text-muted"}`})]}),l.jsxs("div",{className:"flex flex-col text-left pr-2 flex-grow min-w-0",children:[l.jsx("span",{className:"font-semibold text-sm text-text truncate",children:f?m?"Synthesizing Course...":"AI is working...":"AI Queue"}),l.jsx("span",{className:"text-[10px] text-text-muted truncate font-mono italic",title:N,children:N})]}),b>0&&l.jsx("div",{className:"bg-primary text-on-primary text-[10px] font-bold rounded-full h-5 w-5 flex items-center justify-center self-center flex-shrink-0",children:b})]}),l.jsx("style",{children:`
                @keyframes spin {
                    from { transform: rotate(0deg); }
                    to { transform: rotate(360deg); }
                }
            `})]})},Zk=()=>{const{openModal:n}=zc(),{aiFeaturesEnabled:a}=Xi(),s=()=>{n("aiChat")};return a?l.jsx("div",{className:"fixed bottom-6 right-6 z-40 animate-fade-in",children:l.jsx(pt,{variant:"primary",onClick:s,className:"rounded-full w-16 h-16 shadow-lg flex items-center justify-center","aria-label":"Open AI Assistant",children:l.jsx(rt,{name:"bot",className:"w-8 h-8"})})}):null},Qk=()=>{const n=()=>{const i=navigator,c=i.connection;return{isOnline:i.onLine,isMetered:c?c.type==="cellular"||c.saveData===!0:!1}},[a,s]=$.useState(n);return $.useEffect(()=>{const i=()=>s(n()),u=navigator.connection;return window.addEventListener("online",i),window.addEventListener("offline",i),u==null||u.addEventListener("change",i),()=>{window.removeEventListener("online",i),window.removeEventListener("offline",i),u==null||u.removeEventListener("change",i)}},[]),a},Jk=()=>{const{isOnline:n}=Qk();return n?null:l.jsx("div",{role:"status","aria-live":"assertive",title:"You are currently offline",className:"fixed bottom-6 right-6 z-50 bg-surface rounded-full w-12 h-12 shadow-lg flex items-center justify-center border-2 border-border animate-fade-in",children:l.jsx(rt,{name:"wifi-off",className:"w-6 h-6 text-text-muted"})})},Xk=({pullDistance:n,isRefreshing:a,threshold:s})=>{if(a)return l.jsx("div",{className:"fixed top-0 left-0 right-0 h-20 flex items-center justify-center z-50 transition-all duration-300",children:l.jsx(Rs,{size:"md"})});if(n<=0)return null;const i=Math.min(n/s,1),c=i>=1,u=Math.min(.5+i*.5,1),f=20,p=2*Math.PI*f,b=p-i*p;return l.jsx("div",{className:"fixed top-0 left-0 right-0 h-20 flex items-center justify-center z-10 pointer-events-none",style:{transform:`translateY(${Math.min(n,s*1.5)-80}px) scale(${u})`,opacity:Math.min(n/(s/2),1)},children:l.jsxs("div",{className:"relative w-12 h-12 flex items-center justify-center bg-white dark:bg-gray-800 rounded-full shadow-lg transition-transform duration-200",style:{transform:c?"scale(1.1)":"scale(1)"},children:[l.jsxs("svg",{className:"absolute w-full h-full transform -rotate-90",viewBox:"0 0 44 44",children:[l.jsx("circle",{className:"text-gray-300/50 dark:text-gray-600/50",stroke:"currentColor",strokeWidth:"4",fill:"transparent",r:f,cx:"22",cy:"22"}),l.jsx("circle",{className:"text-blue-500",stroke:"currentColor",strokeWidth:"4",strokeLinecap:"round",fill:"transparent",r:f,cx:"22",cy:"22",style:{strokeDasharray:p,strokeDashoffset:b,transition:c?"stroke-dashoffset 0.1s linear":"none"}})]}),l.jsx(rt,{name:c?"refresh-ccw":"arrow-down",className:`w-6 h-6 transition-colors duration-200 ${c?"text-blue-500":"text-gray-500 dark:text-gray-400"}`})]})})},Wk=10,e2=()=>{const[n,a]=$.useState(!0),s=$.useRef(0),i=$.useRef(!1),c=$.useCallback(()=>{const u=window.scrollY;u<=0||u<s.current?a(!0):u>s.current&&u>Wk&&a(!1),s.current=u},[]);return $.useEffect(()=>{const u=()=>{i.current||(window.requestAnimationFrame(()=>{c(),i.current=!1}),i.current=!0)};return window.addEventListener("scroll",u,{passive:!0}),()=>window.removeEventListener("scroll",u)},[c]),n},ed=120,t2=()=>{const[n,a]=$.useState({startY:0,pullDistance:0,isRefreshing:!1,thresholdMet:!1}),{hapticsEnabled:s}=Xi(),i=$.useCallback(f=>{if(f.touches.length===0)return;const p=f.target;window.scrollY===0&&!p.closest('input, textarea, button, a[href], select, [role="button"], [role="switch"]')?a(b=>({...b,startY:f.touches[0].clientY,pullDistance:0,isRefreshing:!1,thresholdMet:!1})):a(b=>({...b,startY:0}))},[]),c=$.useCallback(f=>{if(n.startY===0||f.touches.length===0)return;const p=f.touches[0].clientY-n.startY;p>5&&(f.preventDefault(),p>ed&&!n.thresholdMet&&s&&"vibrate"in navigator&&navigator.vibrate(50),a(m=>({...m,pullDistance:p,thresholdMet:p>ed})))},[n.startY,n.thresholdMet,s]),u=$.useCallback(()=>{n.startY!==0&&(n.pullDistance>ed?(a(f=>({...f,isRefreshing:!0})),setTimeout(()=>{window.location.reload()},500)):a({startY:0,pullDistance:0,isRefreshing:!1,thresholdMet:!1}))},[n.startY,n.pullDistance]);return{pullToRefreshState:n,handleTouchStart:i,handleTouchMove:c,handleTouchEnd:u,REFRESH_THRESHOLD:ed}},n2=()=>{const{dispatch:n,aiGenerationStatus:a,isLoading:s}=kt(),i=_l(),c=e2(),{pullToRefreshState:u,handleTouchStart:f,handleTouchMove:p,handleTouchEnd:b,REFRESH_THRESHOLD:m}=t2(),[_,E]=$.useState(!1),[N,S]=$.useState([]),[I,A]=$.useState(!1);$.useEffect(()=>{(async()=>{const{currentTask:G,queue:Y}=a;if(!G&&Y&&Y.length>0){const W=Y[0],H=new AbortController;n({type:"START_NEXT_AI_TASK",payload:{task:W,abortController:H}});try{switch(W.type){case"generateDeepCourse":await i.onGenerateDeepCourse(W.payload,H.signal);break;case"holistic-expand-item":await i.onHolisticExpandItem(W.payload,H.signal);break;case"deep-expand-questions":await i.onDeepExpandQuestions(W.payload,H.signal);break;case"generateDeckFromOutline":await i.onGenerateDeckFromOutline(W.payload.outline,W.payload.metadata,W.payload.seriesId,W.payload.levelIndex,H.signal,W.deckId);break;case"generateFullSeriesFromScaffold":await i.onGenerateFullSeriesFromScaffold(W.payload,H.signal);break;case"generateFlashcardDeckWithAI":await i.onGenerateFlashcardDeck(W.payload,H.signal);break;case"generateLearningDeckWithAI":await i.onGenerateLearningDeckWithAI(W.payload,H.signal);break;case"autoPopulateSeries":await i.onAutoPopulateSeries(W.payload,H.signal);break;case"autoPopulateLevel":await i.onAutoPopulateLevel(W.payload,H.signal);break;case"generateQuestionsForDeck":await i.onGenerateQuestionsForDeck(W.payload.deck,W.payload.count,void 0,H.signal);break;case"generateSeriesLearningContentInBatches":await i.onGenerateLearningContentForDeck(W.payload,H.signal);break;case"generateSeriesQuestionsInBatches":await i.onGenerateSeriesQuestionsInBatches(W.payload,H.signal);break;case"regenerateQuestion":await i.onRegenerateQuestion(W.payload,H.signal);break;case"upgradeDeckToLearning":await i.onUpgradeDeckToLearning(W.payload,H.signal);break;case"hardenAllDistractors":await i.onHardenAllDistractors(W.payload,H.signal);break;case"generateAudioForAllCards":await i.onGenerateAudioForAllCards(W.payload,H.signal);break;case"rework-deck":await i.onReworkDeckContent(W.payload,H.signal);break}}catch(L){L instanceof Error&&L.message!=="Cancelled by user"&&(console.error("AI Task Failed:",L),i.addToast(`Generation failed: ${L.message}`,"error"))}finally{n({type:"FINISH_CURRENT_AI_TASK"})}}})()},[a,n,i]);const k=$.useCallback(q=>{q.preventDefault(),q.stopPropagation(),q.dataTransfer.types.includes("Files")&&A(!0)},[]),R=$.useCallback(q=>{q.preventDefault(),q.stopPropagation(),(q.currentTarget===q.target||!q.currentTarget.contains(q.relatedTarget))&&A(!1)},[]),P=$.useCallback(async q=>{var W;q.preventDefault(),q.stopPropagation(),A(!1);const G=(W=q.dataTransfer.files)==null?void 0:W[0];if(!G)return;const Y=await Bb(G);Y?i.openModal("droppedFile",{analysis:Y}):i.addToast("Unrecognized file format. Please drop a JSON, Anki, or Image file.","error")},[i]);return s?null:l.jsxs("div",{className:"min-h-screen bg-background text-text selection:bg-primary selection:text-on-primary transition-colors duration-300 relative",onTouchStart:f,onTouchMove:p,onTouchEnd:b,onDragOver:k,onDragLeave:R,onDrop:P,children:[I&&l.jsxs("div",{className:"fixed inset-0 z-[100] bg-primary/20 backdrop-blur-sm border-4 border-dashed border-primary m-4 rounded-2xl flex flex-col items-center justify-center animate-fade-in pointer-events-none",children:[l.jsx("div",{className:"bg-surface p-8 rounded-full shadow-2xl scale-110 mb-6",children:l.jsx(rt,{name:"upload-cloud",className:"w-16 h-16 text-primary"})}),l.jsx("h2",{className:"text-3xl font-bold text-primary bg-surface/80 px-6 py-2 rounded-lg backdrop-blur-md",children:"Drop to Import"}),l.jsx("p",{className:"text-primary font-medium mt-2",children:"JSON, Anki, CSV, or Image"})]}),l.jsx(Xk,{pullDistance:u.pullDistance,isRefreshing:u.isRefreshing,threshold:m}),l.jsx(X_,{onOpenMenu:()=>E(!0),onOpenCommandPalette:()=>i.openModal("commandPalette"),activeDeck:i.activeDeck,isVisible:c}),l.jsx(ew,{isOpen:_,onClose:()=>E(!1),onImport:()=>i.openModal("import"),onCreateSeries:()=>i.openModal("series",{series:"new"}),onGenerateAI:()=>i.openModal("aiGeneration"),onInstall:null}),l.jsx("main",{className:"container mx-auto px-4 pt-24 pb-20 sm:px-6 lg:px-8 max-w-7xl min-h-[calc(100vh-4rem)]",children:l.jsx(J_,{})}),l.jsx($k,{driveFiles:N}),l.jsx(Vk,{onOpen:()=>i.openModal("aiStatus"),onCancel:i.handleCancelAIGeneration}),l.jsx(Zk,{}),l.jsx(Jk,{})]})};class r2 extends Yi.Component{constructor(a){super(a),this.handleReload=()=>{window.location.reload()},this.handleCopyReport=()=>{const s=this.state,{error:i,errorInfo:c}=s,u=`
Error Report
Date: ${new Date().toISOString()}
URL: ${window.location.href}
User Agent: ${navigator.userAgent}

Error: ${i==null?void 0:i.toString()}

Stack Trace:
${i==null?void 0:i.stack}

Component Stack:
${c==null?void 0:c.componentStack}
    `.trim();navigator.clipboard.writeText(u).then(()=>{alert("Error report copied to clipboard.")}).catch(f=>{console.error("Failed to copy report:",f),alert("Failed to copy report to clipboard.")})},this.state={hasError:!1,error:null,errorInfo:null}}static getDerivedStateFromError(a){return{hasError:!0,error:a,errorInfo:null}}componentDidCatch(a,s){console.error("Uncaught error:",a,s),this.setState({errorInfo:s})}render(){const a=this.state,s=this.props,{hasError:i,error:c}=a,{children:u}=s;return i?l.jsx("div",{className:"min-h-screen flex items-center justify-center p-4 bg-background",children:l.jsxs("div",{className:"text-center bg-surface p-8 rounded-lg shadow-xl max-w-lg w-full border border-border",children:[l.jsx(rt,{name:"x-circle",className:"w-16 h-16 text-red-500 mx-auto mb-4"}),l.jsx("h1",{className:"text-3xl font-bold text-red-500 mb-4",children:"Something went wrong"}),l.jsx("p",{className:"text-text-muted mb-6",children:"An unexpected error occurred. Please try reloading the page."}),c&&l.jsxs("details",{className:"text-left bg-background p-4 rounded-md mb-6 overflow-auto max-h-64",children:[l.jsx("summary",{className:"cursor-pointer text-sm text-text-muted font-bold",children:"Error Details"}),l.jsx("pre",{className:"mt-2 text-xs text-red-400 whitespace-pre-wrap break-all",children:l.jsx("code",{children:c.toString()})})]}),l.jsxs("div",{className:"flex flex-wrap gap-4 justify-center",children:[l.jsxs(pt,{variant:"secondary",onClick:this.handleCopyReport,children:[l.jsx(rt,{name:"file-text",className:"w-4 h-4 mr-2"}),"Copy Report"]}),l.jsxs(pt,{variant:"danger",onClick:this.handleReload,children:[l.jsx(rt,{name:"refresh-ccw",className:"w-4 h-4 mr-2"}),"Reload Page"]})]})]})}):u}}const Ih="cogniflow-themeId",cb="cogniflow-custom-themes",yl=[{id:"system",name:"System",isDark:!1,metaColor:"#f9fafb",metaColorDark:"#111827",palette:{background:"249 250 251",surface:"255 255 255",primary:"37 99 235",text:"17 24 39"},paletteDark:{background:"17 24 39",surface:"31 41 55",primary:"37 99 235",text:"243 244 246"}},{id:"light",name:"Light",isDark:!1,metaColor:"#f9fafb",palette:{background:"249 250 251",surface:"255 255 255",primary:"37 99 235",text:"17 24 39"}},{id:"rose",name:"Rose",isDark:!1,metaColor:"#fff1f2",palette:{background:"255 241 242",surface:"254 226 226",primary:"225 29 72",text:"136 25 55"}},{id:"matcha",name:"Matcha",isDark:!1,metaColor:"#f0fdf4",palette:{background:"240 253 244",surface:"220 252 231",primary:"22 163 74",text:"21 94 53"}},{id:"latte",name:"Latte",isDark:!1,metaColor:"#fffbeb",palette:{background:"255 251 235",surface:"254 243 199",primary:"217 119 6",text:"113 63 18"}},{id:"sky",name:"Sky",isDark:!1,metaColor:"#f0f9ff",palette:{background:"240 249 255",surface:"224 242 254",primary:"14 165 233",text:"7 89 133"}},{id:"sunrise",name:"Sunrise",isDark:!1,metaColor:"#fffbeb",palette:{background:"255 251 235",surface:"254 243 199",primary:"249 115 22",text:"124 45 18"}},{id:"lavender",name:"Lavender",isDark:!1,metaColor:"#f5f3ff",palette:{background:"245 243 255",surface:"237 233 254",primary:"124 58 237",text:"76 29 149"}},{id:"terracotta",name:"Terracotta",isDark:!1,metaColor:"#faf3e8",palette:{background:"250 243 232",surface:"245 233 218",primary:"226 114 91",text:"93 64 55"}},{id:"alabaster",name:"Alabaster",isDark:!1,metaColor:"#fcfcfc",palette:{background:"252 252 252",surface:"255 255 255",primary:"96 165 250",text:"50 50 50"}},{id:"dark",name:"Dark",isDark:!0,metaColor:"#111827",palette:{background:"17 24 39",surface:"31 41 55",primary:"37 99 235",text:"243 244 246"}},{id:"espresso",name:"Espresso",isDark:!0,metaColor:"#211713",palette:{background:"33 23 19",surface:"58 45 39",primary:"196 154 108",text:"224 213 208"}},{id:"midnight",name:"Midnight",isDark:!0,metaColor:"#0c0d11",palette:{background:"12 13 17",surface:"26 27 38",primary:"133 137 230",text:"200 201 215"}}],D0=$.createContext(void 0),ub=(n,a=[])=>{let s=yl.find(p=>p.id===n);s||(s=a.find(p=>p.id===n)),s||(s=yl[0]);const i=window.document.documentElement,c=document.querySelector('meta[name="theme-color"]');let u,f;if(s.id==="system"?(u=window.matchMedia("(prefers-color-scheme: dark)").matches,f=u?s.metaColorDark:s.metaColor):(u=s.isDark,f=s.metaColor),yl.forEach(p=>{p.id!=="system"&&i.classList.remove(`theme-${p.id}`)}),a.forEach(p=>i.classList.remove(`theme-${p.id}`)),i.classList.remove("theme-dark","theme-light"),i.classList.toggle("dark",u),c&&f&&c.setAttribute("content",f),s.isCustom){i.classList.add(`theme-${s.id}`);const p=s.palette;i.style.setProperty("--color-background",p.background),i.style.setProperty("--color-surface",p.surface),i.style.setProperty("--color-primary",p.primary),i.style.setProperty("--color-text",p.text),i.style.setProperty("--color-primary-hover",p.primary),i.style.setProperty("--color-text-muted",p.text),i.style.setProperty("--color-border",p.surface),p.onPrimary?i.style.setProperty("--color-on-primary",p.onPrimary):i.style.setProperty("--color-on-primary","255 255 255")}else i.style.removeProperty("--color-background"),i.style.removeProperty("--color-surface"),i.style.removeProperty("--color-primary"),i.style.removeProperty("--color-text"),i.style.removeProperty("--color-primary-hover"),i.style.removeProperty("--color-text-muted"),i.style.removeProperty("--color-border"),i.style.removeProperty("--color-on-primary"),s.id!=="system"&&i.classList.add(`theme-${s.id}`)},a2=({children:n})=>{const[a,s]=$.useState(()=>{try{const m=localStorage.getItem(cb);return m?JSON.parse(m):[]}catch{return[]}}),[i,c]=$.useState(()=>{try{const m=localStorage.getItem(Ih);return yl.some(_=>_.id===m)||a.some(_=>_.id===m)?m:"system"}catch(m){return console.error("Could not access localStorage. Defaulting to 'system'.",m),"system"}});$.useEffect(()=>{localStorage.setItem(cb,JSON.stringify(a))},[a]),$.useEffect(()=>{try{localStorage.setItem(Ih,i)}catch(m){console.error("Could not set theme in localStorage.",m)}ub(i,a)},[i,a]),$.useEffect(()=>{const m=window.matchMedia("(prefers-color-scheme: dark)"),_=()=>{let E="system";try{E=localStorage.getItem(Ih)||"system"}catch{}E==="system"&&ub("system",a)};return m.addEventListener("change",_),()=>m.removeEventListener("change",_)},[a]);const u=$.useCallback(m=>{c(m)},[]),f=$.useCallback(m=>{s(_=>[..._,m]),c(m.id)},[]),p=$.useCallback(m=>{s(_=>_.filter(E=>E.id!==m)),i===m&&c("system")},[i]),b=yl.find(m=>m.id===i)||a.find(m=>m.id===i)||yl[0];return l.jsx(D0.Provider,{value:{themeId:i,setThemeById:u,currentTheme:b,customThemes:a,addCustomTheme:f,deleteCustomTheme:p},children:n})},iA=()=>{const n=$.useContext(D0);if(n===void 0)throw new Error("useTheme must be used within a ThemeProvider");return n},hp="cogniflow_v1_",wn=n=>{const a=localStorage.getItem(hp+n);return a?JSON.parse(a):null},jn=(n,a)=>{localStorage.setItem(hp+n,JSON.stringify(a))},fl={getAllDecks:async()=>wn("decks")||[],addDecks:async n=>{const a=wn("decks")||[],s=new Map(a.map(i=>[i.id,i]));n.forEach(i=>s.set(i.id,i)),jn("decks",Array.from(s.values()))},updateDeck:async n=>{await fl.addDecks([n])},bulkUpdateDecks:async n=>{await fl.addDecks(n)},deleteDeck:async n=>{const a=wn("decks")||[];jn("decks",a.filter(s=>s.id!==n))},getAllFolders:async()=>wn("folders")||[],addFolder:async n=>{const a=wn("folders")||[];jn("folders",[...a,n])},addFolders:async n=>{const a=wn("folders")||[];jn("folders",[...a,...n])},updateFolder:async n=>{const a=wn("folders")||[],s=a.findIndex(i=>i.id===n.id);s!==-1?(a[s]=n,jn("folders",a)):await fl.addFolder(n)},deleteFolder:async n=>{const a=wn("folders")||[];jn("folders",a.filter(s=>s.id!==n))},getAllDeckSeries:async()=>wn("deckSeries")||[],addDeckSeries:async n=>{const a=wn("deckSeries")||[],s=new Map(a.map(i=>[i.id,i]));n.forEach(i=>s.set(i.id,i)),jn("deckSeries",Array.from(s.values()))},updateDeckSeries:async n=>{await fl.addDeckSeries([n])},deleteDeckSeries:async n=>{const a=wn("deckSeries")||[];jn("deckSeries",a.filter(s=>s.id!==n))},saveSessionState:async(n,a)=>{const s=wn("sessions")||{};s[n]=a,jn("sessions",s)},getSessionState:async n=>(wn("sessions")||{})[n]||null,getAllSessions:async()=>Object.values(wn("sessions")||{}),clearSessions:async()=>jn("sessions",{}),bulkAddSessions:async n=>{const a=wn("sessions")||{};n.forEach(s=>a[s.id]=s),jn("sessions",a)},deleteSessionState:async n=>{const a=wn("sessions")||{};delete a[n],jn("sessions",a)},getAllSessionKeys:async()=>Object.keys(wn("sessions")||{}),addReviewLog:async n=>{const a=wn("reviews")||[];jn("reviews",[...a,n])},getReviewsSince:async n=>(wn("reviews")||[]).filter(s=>new Date(s.timestamp)>=n),getAllReviews:async()=>wn("reviews")||[],clearReviews:async()=>jn("reviews",[]),deleteReviewsForDecks:async n=>{const a=wn("reviews")||[],s=new Set(n);jn("reviews",a.filter(i=>!s.has(i.deckId)))},bulkAddReviews:async n=>{const a=wn("reviews")||[];jn("reviews",[...a,...n])},getReviewsForDeck:async n=>(wn("reviews")||[]).filter(s=>s.deckId===n),saveAIChatHistory:async n=>jn("ai_chat",n),getAIChatHistory:async()=>wn("ai_chat")||[],clearAIChatHistory:async()=>jn("ai_chat",[]),saveSeriesProgress:async(n,a)=>{const s=wn("seriesProgress")||{};s[n]=Array.from(a),jn("seriesProgress",s)},getAllSeriesProgress:async()=>wn("seriesProgress")||{},clearSeriesProgress:async()=>jn("seriesProgress",{}),bulkAddSeriesProgress:async n=>jn("seriesProgress",n),saveLearningProgress:async n=>{const a=wn("learningProgress")||{};a[n.deckId]=n,jn("learningProgress",a)},getAllLearningProgress:async()=>wn("learningProgress")||{},bulkAddLearningProgress:async n=>jn("learningProgress",n),getAllDataForBackup:async()=>{const n=wn("sessions")||{};return{decks:wn("decks")||[],folders:wn("folders")||[],deckSeries:wn("deckSeries")||[],reviews:wn("reviews")||[],sessions:Object.values(n),seriesProgress:wn("seriesProgress")||{},learningProgress:wn("learningProgress")||{}}},exportAllData:async()=>{const n=await fl.getAllDataForBackup();return JSON.stringify(n)},performAtomicRestore:async n=>{jn("decks",n.decks),jn("folders",n.folders),jn("deckSeries",n.deckSeries),jn("reviews",n.reviews);const a=(n.sessions||[]).reduce((s,i)=>(s[i.id]=i,s),{});jn("sessions",a),jn("seriesProgress",n.seriesProgress),jn("learningProgress",n.learningProgress),n.aiChatHistory&&jn("ai_chat",n.aiChatHistory)},factoryReset:async()=>{Object.keys(localStorage).filter(a=>a.startsWith(hp)).forEach(a=>localStorage.removeItem(a))}},s2=()=>{let n=null,a=null;const s=async()=>n||a||(a=(async()=>{try{if(!(typeof indexedDB<"u"?indexedDB:typeof window<"u"?window.indexedDB:void 0))throw new Error("No IndexedDB support");await Zb(),n=$1,console.log("Using IndexedDB for primary storage.")}catch(c){console.warn("IndexedDB initialization failed. Falling back to localStorage.",c),n=fl}return n})(),a),i=c=>async(...u)=>(await s())[c](...u);return{getAllDecks:i("getAllDecks"),addDecks:i("addDecks"),updateDeck:i("updateDeck"),bulkUpdateDecks:i("bulkUpdateDecks"),deleteDeck:i("deleteDeck"),getAllFolders:i("getAllFolders"),addFolder:i("addFolder"),addFolders:i("addFolders"),updateFolder:i("updateFolder"),deleteFolder:i("deleteFolder"),getAllDeckSeries:i("getAllDeckSeries"),addDeckSeries:i("addDeckSeries"),updateDeckSeries:i("updateDeckSeries"),deleteDeckSeries:i("deleteDeckSeries"),saveSessionState:i("saveSessionState"),getSessionState:i("getSessionState"),getAllSessions:i("getAllSessions"),clearSessions:i("clearSessions"),bulkAddSessions:i("bulkAddSessions"),deleteSessionState:i("deleteSessionState"),getAllSessionKeys:i("getAllSessionKeys"),addReviewLog:i("addReviewLog"),getReviewsSince:i("getReviewsSince"),getAllReviews:i("getAllReviews"),clearReviews:i("clearReviews"),deleteReviewsForDecks:i("deleteReviewsForDecks"),bulkAddReviews:i("bulkAddReviews"),getReviewsForDeck:i("getReviewsForDeck"),saveAIChatHistory:i("saveAIChatHistory"),getAIChatHistory:i("getAIChatHistory"),clearAIChatHistory:i("clearAIChatHistory"),saveSeriesProgress:i("saveSeriesProgress"),getAllSeriesProgress:i("getAllSeriesProgress"),clearSeriesProgress:i("clearSeriesProgress"),bulkAddSeriesProgress:i("bulkAddSeriesProgress"),saveLearningProgress:i("saveLearningProgress"),getAllLearningProgress:i("getAllLearningProgress"),bulkAddLearningProgress:i("bulkAddLearningProgress"),getAllDataForBackup:i("getAllDataForBackup"),exportAllData:i("exportAllData"),performAtomicRestore:i("performAtomicRestore"),factoryReset:i("factoryReset")}},$n=s2(),Ja=(n,a,s)=>{const i=new Date;i.setHours(0,0,0,0);const c=a.map(f=>({id:crypto.randomUUID(),text:f.text,explanation:f.explanation})),u=c[a.findIndex(f=>f.correct)];if(!u)throw new Error(`No correct option specified for question: "${n}"`);return{id:crypto.randomUUID(),questionType:"multipleChoice",questionText:n,tags:["nature","sample"],detailedExplanation:s,options:c,correctAnswerId:u.id,dueDate:i.toISOString(),interval:0,easeFactor:za,suspended:!1,masteryLevel:0,lastReviewed:void 0,lapses:0}},i2=()=>{const n={id:crypto.randomUUID(),name:"Level 1.1: Simple Addition",description:"Practice basic addition problems.",type:et.Quiz,questions:[Ja("What is 1 + 1?",[{text:"2",correct:!0},{text:"1"},{text:"3"}],"1 plus 1 equals 2."),Ja("What is 2 + 3?",[{text:"5",correct:!0},{text:"4"},{text:"6"}],"2 plus 3 equals 5."),Ja("What is 5 + 4?",[{text:"9",correct:!0},{text:"8"},{text:"10"}],"5 plus 4 equals 9.")]},a={id:crypto.randomUUID(),name:"Level 1.2: Simple Subtraction",description:"Practice basic subtraction problems.",type:et.Quiz,questions:[Ja("What is 5 - 2?",[{text:"3",correct:!0},{text:"2"},{text:"4"}],"5 minus 2 equals 3."),Ja("What is 10 - 4?",[{text:"6",correct:!0},{text:"5"},{text:"7"}],"10 minus 4 equals 6.")]},s={id:crypto.randomUUID(),name:"Level 2.1: Simple Multiplication",description:"Practice basic multiplication problems.",type:et.Quiz,questions:[Ja("What is 2 * 3?",[{text:"6",correct:!0},{text:"5"},{text:"8"}],"2 times 3 is 6."),Ja("What is 4 * 5?",[{text:"20",correct:!0},{text:"15"},{text:"25"}],"4 times 5 is 20.")]},i=[n,a,s];return{series:{id:crypto.randomUUID(),type:"series",name:"Sample: Basic Math Series",description:"A sample series to demonstrate the progressive learning path feature. Complete each deck to unlock the next!",levels:[{title:"Level 1: Fundamentals",deckIds:[n.id,a.id]},{title:"Level 2: Next Steps",deckIds:[s.id]}],createdAt:new Date().toISOString()},decks:i}},db=()=>{const n=[Ja("Which process allows plants to convert light energy into chemical energy?",[{text:"Respiration"},{text:"Photosynthesis",correct:!0},{text:"Transpiration"},{text:"Germination"}],"Photosynthesis is the vital process used by plants, algae, and certain bacteria to harness energy from sunlight and turn it into chemical energy in the form of glucose."),Ja("What is the largest rainforest in the world?",[{text:"The Congo Rainforest"},{text:"The Valdivian Temperate Rainforest"},{text:"The Daintree Rainforest"},{text:"The Amazon Rainforest",correct:!0}],"The Amazon Rainforest is the world's largest tropical rainforest, famed for its biodiversity. It spans across nine countries in South America."),Ja("What type of rock is formed from the cooling and solidification of magma or lava?",[{text:"Igneous Rock",correct:!0},{text:"Sedimentary Rock"},{text:"Metamorphic Rock"},{text:"Sandstone"}],"Igneous rock is formed through the cooling and solidification of magma (molten rock below the surface) or lava (molten rock on the surface). Examples include granite and basalt."),Ja("Which layer of the Earth's atmosphere is closest to the surface?",[{text:"Stratosphere"},{text:"Mesosphere"},{text:"Troposphere",correct:!0},{text:"Thermosphere"}],"The Troposphere is the lowest layer of Earth's atmosphere, and is also where nearly all weather conditions take place. It contains about 75% of the atmosphere's mass."),Ja("What is the name for the process of water movement through a plant and its evaporation from aerial parts, such as leaves, stems and flowers?",[{text:"Condensation"},{text:"Precipitation"},{text:"Transpiration",correct:!0},{text:"Photosynthesis"}],"Transpiration is essentially evaporation of water from plant leaves. It is a key part of the water cycle, and an important process in plant life.")];return{id:crypto.randomUUID(),name:"Sample: Wonders of Nature",description:"A sample quiz deck to introduce you to CogniFlow. Test your knowledge about the natural world!",type:et.Quiz,questions:n,lastOpened:new Date().toISOString()}},o2=()=>({id:crypto.randomUUID(),name:"Sample: Spanish Basics",description:"Common Spanish words and phrases.",type:et.Flashcard,cards:[{id:crypto.randomUUID(),front:"Hola",back:"Hello",dueDate:new Date().toISOString(),interval:0,easeFactor:za,masteryLevel:0,lapses:0},{id:crypto.randomUUID(),front:"Gracias",back:"Thank you",dueDate:new Date().toISOString(),interval:0,easeFactor:za,masteryLevel:0,lapses:0},{id:crypto.randomUUID(),front:"Por favor",back:"Please",dueDate:new Date().toISOString(),interval:0,easeFactor:za,masteryLevel:0,lapses:0},{id:crypto.randomUUID(),front:"Buenos das",back:"Good morning",dueDate:new Date().toISOString(),interval:0,easeFactor:za,masteryLevel:0,lapses:0},{id:crypto.randomUUID(),front:"Amigo",back:"Friend",dueDate:new Date().toISOString(),interval:0,easeFactor:za,masteryLevel:0,lapses:0}],lastOpened:new Date().toISOString()}),l2=()=>{const n=crypto.randomUUID(),a=crypto.randomUUID(),s=crypto.randomUUID(),i=crypto.randomUUID(),c=[{id:n,content:`<h3>Digital Photography: The Exposure Triangle</h3><p>Exposure is determined by three key elements, often called the "Exposure Triangle":</p><ul><li><b>Aperture:</b> The size of the lens opening (f-stop). Controls depth of field.</li><li><b>Shutter Speed:</b> How long the sensor is exposed to light. Controls motion blur.</li><li><b>ISO:</b> The sensor's sensitivity to light. Controls digital noise.</li></ul><p>Balancing these three is the key to a properly exposed image.</p>`,unlocksQuestionIds:[s]},{id:a,content:"<h3>Digital Photography: Composition</h3><p>Good composition guides the viewer's eye. One of the most fundamental rules is the <b>Rule of Thirds</b>.</p><p>Imagine breaking an image down into thirds (both horizontally and vertically) so that you have 9 parts. The rule suggests that you should place key elements of your scene along these lines or at their intersections.</p>",unlocksQuestionIds:[i]}],u=[{id:s,questionType:"multipleChoice",questionText:"Which element of the exposure triangle primarily controls depth of field (how much of the scene is in focus)?",options:[{id:crypto.randomUUID(),text:"ISO",explanation:"ISO controls sensitivity and noise."},{id:crypto.randomUUID(),text:"Shutter Speed",explanation:"Shutter speed controls motion blur."},{id:crypto.randomUUID(),text:"Aperture",explanation:"Correct! A wide aperture (low f-number) creates a shallow depth of field."}],correctAnswerId:"",detailedExplanation:"Aperture refers to the opening of the lens's diaphragm through which light travels. Large openings (small f-numbers) create a shallow depth of field (blurry background), while small openings (large f-numbers) keep more in focus.",dueDate:new Date().toISOString(),interval:0,easeFactor:za,suspended:!1,masteryLevel:0,lapses:0,infoCardIds:[n]},{id:i,questionType:"multipleChoice",questionText:"According to the Rule of Thirds, where is the best place to put your main subject?",options:[{id:crypto.randomUUID(),text:"Dead center",explanation:"Centering is valid but can be static. The Rule of Thirds suggests off-center placement."},{id:crypto.randomUUID(),text:"At the intersections of the grid lines",explanation:'Correct! These "power points" create a more balanced and interesting image.'},{id:crypto.randomUUID(),text:"In the extreme corner",explanation:"This can make the subject feel like it is falling out of the frame."}],correctAnswerId:"",detailedExplanation:"The Rule of Thirds grid creates four intersection points. Placing your subject on one of these points generally creates a more energetic and interesting composition than simply centering the subject.",dueDate:new Date().toISOString(),interval:0,easeFactor:za,suspended:!1,masteryLevel:0,lapses:0,infoCardIds:[a]}];return u[0].correctAnswerId=u[0].options[2].id,u[1].correctAnswerId=u[1].options[1].id,{id:crypto.randomUUID(),name:"Sample: Photography Basics",description:"A mini-course covering exposure and composition fundamentals.",type:et.Learning,infoCards:c,questions:u,learningMode:"separate",lastOpened:new Date().toISOString()}};function pp(n,a,s){const i=new Blob([n],{type:s}),c=URL.createObjectURL(i),u=document.createElement("a");u.style.display="none",u.href=c,u.download=a,document.body.appendChild(u),u.click(),window.URL.revokeObjectURL(c),document.body.removeChild(u)}function mp(n){return n.replace(/[^a-z0-9 -]/gi,"_").replace(/\s+/g,"-").toLowerCase().substring(0,30)}const c2=n=>{let a;const s=`cogniflow-deck-${mp(n.name)}.json`;if(n.type===et.Flashcard){const c=n;c.generationStatus||c.icon||c.description?a={name:c.name,description:c.description,type:c.type,icon:c.icon,generationStatus:c.generationStatus,cards:(c.cards||[]).map(u=>({front:u.front,back:u.back}))}:a=(c.cards||[]).map(f=>({front:f.front,back:f.back}))}else if(n.type===et.Quiz||n.type===et.Learning){const c=n,u={name:c.name,description:c.description,type:c.type,generationStatus:c.generationStatus,icon:c.icon,questions:(c.questions||[]).map(f=>({questionType:f.questionType,questionText:f.questionText,options:(f.options||[]).map(p=>({id:p.id,text:p.text,explanation:p.explanation})),correctAnswerId:f.correctAnswerId,detailedExplanation:f.detailedExplanation,tags:f.tags,infoCardIds:f.infoCardIds,bloomsLevel:f.bloomsLevel}))};if(n.type===et.Learning){const f=n;u.infoCards=f.infoCards,u.learningMode=f.learningMode,u.curriculum=f.curriculum}a=u}else throw new Error(`Unsupported deck type for export: ${n.type}`);const i=JSON.stringify(a,null,2);pp(i,s,"application/json")},u2=n=>{if(n.type!==et.Flashcard)throw new Error("CSV export is currently only supported for Flashcard decks.");const s=(n.cards||[]).map(u=>({Front:u.front,Back:u.back})),i=zb.unparse(s),c=`cogniflow-deck-${mp(n.name)}.csv`;pp(i,c,"text/csv")},d2=(n,a)=>{const s=new Map,i=new Set((n.levels||[]).flatMap(b=>(b==null?void 0:b.deckIds)||[]));a.forEach(b=>{i.has(b.id)&&s.set(b.id,b)});const c=(n.levels||[]).map(b=>{const m=(b.deckIds||[]).map(_=>s.get(_)).filter(_=>!!_).map(_=>{const E={type:_.type,name:_.name,description:_.description,icon:_.icon,generationStatus:_.generationStatus};if(_.type===et.Flashcard)return{...E,cards:(_.cards||[]).map(S=>({front:S.front,back:S.back}))};if(_.type===et.Quiz||_.type===et.Learning){const S={...E,questions:(_.questions||[]).map(I=>({questionType:I.questionType,questionText:I.questionText,options:(I.options||[]).map(A=>({id:A.id,text:A.text,explanation:A.explanation})),correctAnswerId:I.correctAnswerId,detailedExplanation:I.detailedExplanation,tags:I.tags,infoCardIds:I.infoCardIds,bloomsLevel:I.bloomsLevel}))};if(_.type===et.Learning){const I=_;S.infoCards=I.infoCards,S.learningMode=I.learningMode,S.curriculum=I.curriculum}return S}return null}).filter(Boolean);return{title:b.title,decks:m}}),u={seriesName:n.name,seriesDescription:n.description,levels:c},f=`cogniflow-series-${mp(n.name)}.json`,p=JSON.stringify(u,null,2);pp(p,f,"application/json")},f2=({triggerSync:n,openConfirmModal:a})=>{const{dispatch:s}=kt(),{addToast:i}=Ar(),c=$.useCallback(async H=>{const L=Object.values(kt.getState().decks),U=new Set(L.map(le=>le.name)),Q=H.map(le=>{let F=le.name,te=1;for(;U.has(F);)F=`${le.name} (Copy ${te})`,te++;return U.add(F),{...le,name:F}});s({type:"ADD_DECKS",payload:Q});try{await $n.addDecks(Q),n({isManual:!1})}catch(le){i("Error saving new deck(s).","error"),console.error(le)}},[s,i,n]),u=$.useCallback(async(H,L)=>{const U={...H,lastModified:Date.now()};s({type:"UPDATE_DECK",payload:U});try{await $n.updateDeck(U),L!=null&&L.silent||(L!=null&&L.toastMessage&&i(L.toastMessage,"success"),n({isManual:!1}))}catch(Q){i(`Error updating deck "${H.name}".`,"error"),console.error(Q)}},[s,i,n]),f=$.useCallback(async(H,L)=>{const U=H.map(Q=>({...Q,lastModified:Date.now()}));s({type:"BULK_UPDATE_DECKS",payload:U});try{await $n.bulkUpdateDecks(U),L!=null&&L.silent||n({isManual:!1})}catch{i("Error updating decks.","error")}},[s,n,i]),p=$.useCallback(async(H,L)=>{const U=kt.getState().decks[H];U&&(await u({...U,folderId:L}),i("Deck moved.","success"))},[u,i]),b=$.useCallback(async H=>{const L=kt.getState().decks[H];if(L){const U={...L,deletedAt:new Date().toISOString(),archived:!1};await u(U,{toastMessage:`Deck "${L.name}" moved to trash.`})}},[u]),m=$.useCallback(async H=>{const L=kt.getState().decks[H];L&&await u({...L,deletedAt:null},{toastMessage:`Deck "${L.name}" restored.`})},[u]),_=$.useCallback(async H=>{s({type:"DELETE_DECK",payload:H});try{await $n.deleteDeck(H),i("Deck permanently deleted.","success"),n({isManual:!1})}catch{i("Error deleting deck permanently.","error")}},[s,i,n]),E=$.useCallback(async H=>{if(H.id){const L={id:H.id,name:H.name};s({type:"UPDATE_FOLDER",payload:L});try{await $n.updateFolder(L),i(`Folder renamed to "${L.name}".`,"success"),n({isManual:!1})}catch{i("Error renaming folder.","error")}}else{const L={id:crypto.randomUUID(),name:H.name};s({type:"ADD_FOLDER",payload:L});try{await $n.addFolder(L),i(`Folder "${L.name}" created.`,"success"),n({isManual:!1})}catch{i("Error creating folder.","error")}}},[s,i,n]),N=$.useCallback(async H=>{const L=kt.getState().folders[H];L&&a({title:"Delete Folder",message:`Are you sure you want to delete the folder "${L.name}"? Decks inside will be moved to the main list.`,onConfirm:async()=>{s({type:"DELETE_FOLDER",payload:H});try{await $n.deleteFolder(H);const U=Object.values(kt.getState().decks).filter(Q=>Q.folderId===H);U.length>0&&await $n.bulkUpdateDecks(U.map(Q=>({...Q,folderId:null}))),i(`Folder "${L.name}" deleted.`,"success"),n({isManual:!1})}catch{i("Error deleting folder.","error")}}})},[s,i,n,a]),S=$.useCallback(H=>{const L=kt.getState().decks[H];if(L&&L.id!=="general-study-deck"){const U=new Date,Q=L.lastOpened?new Date(L.lastOpened):new Date(0);U.getTime()-Q.getTime()>5e3&&u({...L,lastOpened:U.toISOString()},{silent:!0})}},[u]),I=$.useCallback(()=>{const H=db();c([H]),i(`Sample quiz "${H.name}" created.`,"success")},[c,i]),A=$.useCallback(()=>{const H=db();c([H]),i(`Sample quiz "${H.name}" created.`,"success")},[c,i]),k=$.useCallback(()=>{const H=o2();c([H]),i(`Sample flashcard deck "${H.name}" created.`,"success")},[c,i]),R=$.useCallback(()=>{const H=l2();c([H]),i(`Sample learning deck "${H.name}" created.`,"success")},[c,i]),P=$.useCallback(async(H,L)=>{const U=kt.getState().decks[H];if(!U)return;const Q=U.infoCards||[],F=Q.some(J=>J.id===L.infoCard.id)?Q.map(J=>J.id===L.infoCard.id?L.infoCard:J):[...Q,L.infoCard],te=U.questions||[],j=new Map(te.map(J=>[J.id,J]));L.questions.forEach(J=>j.set(J.id,J));const he={...U,infoCards:F,questions:Array.from(j.values())};await u(he,{toastMessage:"Learning block saved."})},[u]),q=$.useCallback(async(H,L)=>{var he;const U=kt.getState().decks[H];if(!U)return;const Q=U.infoCards||[],le=Q.filter(J=>J.id!==L),F=new Set(((he=Q.find(J=>J.id===L))==null?void 0:he.unlocksQuestionIds)||[]),te=(U.questions||[]).filter(J=>!F.has(J.id)),j={...U,infoCards:le,questions:te};await u(j,{toastMessage:"Learning block deleted."})},[u]),G=$.useCallback(H=>{try{c2(H),i(`Deck "${H.name}" exported as JSON.`,"success")}catch(L){i(`Failed to export deck: ${L.message}`,"error")}},[i]),Y=$.useCallback(H=>{try{u2(H),i(`Deck "${H.name}" exported as CSV.`,"success")}catch(L){i(`Failed to export deck: ${L.message}`,"error")}},[i]),W=$.useCallback(async H=>{a({title:"Shift Schedule",message:`Are you sure you want to shift all due dates forward by ${H} day(s)? This affects all active cards in all decks.`,confirmText:"Shift Schedule",onConfirm:async()=>{const L=Object.values(kt.getState().decks),U=[];let Q=0;L.forEach(le=>{let F=!1,te={...le};if(le.type===et.Flashcard){const j=le,he=j.cards.map(J=>{if(!J.suspended&&J.dueDate){const Z=new Date(J.dueDate);return Z.setDate(Z.getDate()+H),Q++,F=!0,{...J,dueDate:Z.toISOString()}}return J});F&&(te={...j,cards:he})}else{const j=le,he=j.questions.map(J=>{if(!J.suspended&&J.dueDate){const Z=new Date(J.dueDate);return Z.setDate(Z.getDate()+H),Q++,F=!0,{...J,dueDate:Z.toISOString()}}return J});F&&(te={...j,questions:he})}F&&U.push(te)}),U.length>0?(await f(U),i(`Schedule shifted! ${Q} items moved forward by ${H} days.`,"success")):i("No active items found to shift.","info")}})},[a,f,i]);return $.useMemo(()=>({handleAddDecks:c,handleUpdateDeck:u,handleBulkUpdateDecks:f,handleMoveDeck:p,handleDeleteDeck:b,handleRestoreDeck:m,handleDeleteDeckPermanently:_,handleSaveFolder:E,handleDeleteFolder:N,updateLastOpened:S,handleCreateSampleDeck:I,handleCreateSampleQuizDeck:A,handleCreateSampleFlashcardDeck:k,handleCreateSampleLearningDeck:R,handleSaveLearningBlock:P,handleDeleteLearningBlock:q,handleExportDeck:G,handleExportDeckCSV:Y,handleShiftSchedule:W}),[c,u,f,p,b,m,_,E,N,S,I,A,k,R,P,q,G,Y,W])},h2=({triggerSync:n,handleAddDecks:a,handleUpdateDeck:s})=>{const{dispatch:i}=kt(),{addToast:c}=Ar(),{navigate:u}=si(),f=$.useCallback(async(k,R)=>{i({type:"ADD_SERIES_WITH_DECKS",payload:{series:k,decks:R}});try{await $n.addDeckSeries([k]),await $n.addDecks(R),c(`Series "${k.name}" created with ${R.length} deck(s).`,"success"),u(`/series/${k.id}`),n({isManual:!1})}catch{c("Error creating new series.","error")}},[i,c,u,n]),p=$.useCallback(async(k,R)=>{const P={...k,lastModified:Date.now()};i({type:"UPDATE_SERIES",payload:P});try{await $n.updateDeckSeries(P),R!=null&&R.silent||(R!=null&&R.toastMessage&&c(R.toastMessage,"success"),n({isManual:!1}))}catch{c(`Error updating series "${k.name}".`,"error")}},[i,c,n]),b=$.useCallback(async k=>{const R=kt.getState().deckSeries[k];if(R){const P={...R,deletedAt:new Date().toISOString(),archived:!1};p(P,{toastMessage:`Series "${R.name}" moved to trash.`});const q=new Set((R.levels||[]).flatMap(Y=>(Y==null?void 0:Y.deckIds)||[])),G=Object.values(kt.getState().decks).filter(Y=>q.has(Y.id));for(const Y of G)s({...Y,deletedAt:new Date().toISOString(),archived:!1},{silent:!0})}},[p,s]),m=$.useCallback(async k=>{const R=kt.getState().deckSeries[k];if(R){p({...R,deletedAt:null},{toastMessage:`Series "${R.name}" restored.`});const P=new Set((R.levels||[]).flatMap(G=>(G==null?void 0:G.deckIds)||[])),q=Object.values(kt.getState().decks).filter(G=>P.has(G.id));for(const G of q)G.deletedAt&&s({...G,deletedAt:null},{silent:!0})}},[p,s]),_=$.useCallback(async k=>{const R=kt.getState().deckSeries[k];if(!R)return;const P=new Set((R.levels||[]).flatMap(G=>(G==null?void 0:G.deckIds)||[])),q=Object.values(kt.getState().decks).filter(G=>P.has(G.id));i({type:"DELETE_SERIES",payload:k});for(const G of q)i({type:"DELETE_DECK",payload:G.id});try{await $n.deleteDeckSeries(k);for(const G of q)await $n.deleteDeck(G.id);c("Series and its decks permanently deleted.","success"),n({isManual:!1})}catch{c("Error deleting series permanently.","error")}},[i,c,n]),E=$.useCallback(async k=>{if(k.id){const R=kt.getState().deckSeries[k.id];R&&p({...R,name:k.name,description:k.description})}else if(k.scaffold){const{seriesName:R,seriesDescription:P,levels:q}=k.scaffold,G=[],Y=(q||[]).map(H=>{const L=(H.decks||[]).map(U=>{const Q={id:crypto.randomUUID(),name:U.name,description:U.description};return U.type===et.Quiz?{...Q,type:et.Quiz,questions:U.questions||[]}:U.type===et.Learning?{...Q,type:et.Learning,questions:U.questions||[],infoCards:U.infoCards||[],learningMode:U.learningMode||"separate"}:U.type===et.Flashcard?{...Q,type:et.Flashcard,cards:U.cards||[]}:null}).filter(U=>U!==null);return G.push(...L),{title:H.title,deckIds:L.map(U=>U.id)}}),W={id:crypto.randomUUID(),type:"series",name:R,description:P,levels:Y,archived:!1,createdAt:new Date().toISOString()};await f(W,G)}else{const R={id:crypto.randomUUID(),type:"series",name:k.name,description:k.description,levels:[],createdAt:new Date().toISOString(),archived:!1};i({type:"ADD_SERIES",payload:R});try{await $n.addDeckSeries([R]),c(`Series "${R.name}" created.`,"success"),u(`/series/${R.id}`)}catch{c("Error saving new series.","error")}}},[i,c,u,p,f]),N=$.useCallback(()=>{const{series:k,decks:R}=i2();f(k,R)},[f]),S=$.useCallback(k=>{const R=kt.getState().deckSeries[k];if(R){const P=new Date,q=new Date(R.lastOpened||0);P.getTime()-q.getTime()>5e3&&p({...R,lastOpened:P.toISOString()},{silent:!0})}},[p]),I=$.useCallback(async(k,R)=>{const P=kt.getState().deckSeries[k];if(!P){c("Could not find the series to add the deck to.","error");return}await a([R]);const q=P.levels[P.levels.length-1];if(q){const G={...P,levels:[...P.levels.slice(0,-1),{...q,deckIds:[...q.deckIds,R.id]}]};p(G)}},[a,p,c]),A=$.useCallback(k=>{try{const R=Object.values(kt.getState().decks);d2(k,R),c(`Series "${k.name}" exported.`,"success")}catch(R){c(`Failed to export series: ${R.message}`,"error")}},[c]);return $.useMemo(()=>({handleAddSeriesWithDecks:f,handleUpdateSeries:p,handleDeleteSeries:b,handleRestoreSeries:m,handleDeleteSeriesPermanently:_,handleSaveSeries:E,handleCreateSampleSeries:N,updateLastOpenedSeries:S,handleAddDeckToSeries:I,handleExportSeries:A}),[f,p,b,m,_,E,N,S,I,A])};function p2(n,a){const s=new Date(n);return s.setDate(s.getDate()+a),s}const oA=(n,a)=>{const s=new Date;s.setHours(0,0,0,0);let i=n.lapses||0;a===La.Again?i++:i>0&&(i=0);let c=sw[a];a===La.Again&&i>2&&(c-=(i-2)*.05);let u=n.easeFactor+c;u<Bh&&(u=Bh);let f;if(a===La.Again)f=nw;else if(n.interval===0)switch(a){case La.Hard:f=1;break;case La.Good:f=3;break;case La.Easy:f=5;break;default:f=1}else{let m=1;a===La.Hard&&(m=rw),a===La.Easy&&(m=aw),f=Math.ceil(n.interval*u*m)}const p=p2(s,f),b=Math.min(1,Math.log1p(f)/Math.log1p(90));return{...n,interval:f,easeFactor:u,dueDate:p.toISOString(),lastReviewed:s.toISOString(),masteryLevel:b,lapses:i}},fb=n=>{const a=new Date;return a.setHours(0,0,0,0),{...n,dueDate:a.toISOString(),interval:0,easeFactor:za,suspended:!1,masteryLevel:0,lastReviewed:void 0,lapses:0}},m2=n=>{const a=n.masteryLevel||0;if(a===0||!n.lastReviewed||n.suspended)return 0;const s=(n.interval||1)*2,i=new Date(n.lastReviewed),u=Math.max(0,(new Date().getTime()-i.getTime())/(1e3*60*60*24));if(u<=0)return a;const f=Math.pow(.5,u/s);return a*f},pc=n=>{const a=new Date;a.setHours(23,59,59,999);const s=(n.type===et.Quiz||n.type===et.Learning?n.questions:n.cards)||[];return Array.isArray(s)?s.filter(i=>!i.suspended&&new Date(i.dueDate)<=a).length:0},g2=({sessionsToResume:n,setSessionsToResume:a,setGeneralStudyDeck:s,handleUpdateDeck:i})=>{const{navigate:c,path:u}=si(),{dispatch:f}=kt(),{addToast:p}=Ar(),b=$.useCallback(async(A,k)=>{const R=`session_deck_${A}`;if(n.has(A)){const P=new Set(n);P.delete(A),a(P)}try{await $n.deleteSessionState(R)}catch(P){console.error(`Failed to clean up session state for ${R} from DB`,P)}A==="general-study-deck"&&s(null),c(k?`/series/${k}`:"/")},[c,n,a,s]),m=$.useCallback(async(A,k,R)=>{const P=`session_deck_${A}`;if(n.has(A)){const q=new Set(n);q.delete(A),a(q)}try{await $n.deleteSessionState(P)}catch(q){console.error(`Failed to clean up session state for ${P} from DB`,q)}A==="general-study-deck"&&s(null),c(`/decks/${R}/study?seriesId=${k}`)},[c,n,a,s]),_=$.useCallback(async(A,k,R,P)=>{const{decks:q,deckSeries:G,seriesProgress:Y}=kt.getState(),W=q[A];if(!W)return;let H;const{id:L,dueDate:U,interval:Q,easeFactor:le,suspended:F,masteryLevel:te,lastReviewed:j,lapses:he}=k,J={dueDate:U,interval:Q,easeFactor:le,suspended:F,masteryLevel:te,lastReviewed:j,lapses:he};W.type===et.Flashcard?H={...W,cards:(W.cards||[]).map(Z=>Z.id===L?{...Z,...J}:Z)}:W.type===et.Learning?H={...W,questions:(W.questions||[]).map(Z=>Z.id===L?{...Z,...J}:Z)}:H={...W,questions:(W.questions||[]).map(Z=>Z.id===L?{...Z,...J}:Z)},await i(H,{silent:!0});try{const Z={itemId:k.id,deckId:A,seriesId:P,timestamp:new Date().toISOString(),rating:R,newInterval:k.interval,easeFactor:k.easeFactor,masteryLevel:k.masteryLevel||0};await $n.addReviewLog(Z)}catch(Z){console.error("Failed to log review:",Z)}if(P){const Z=H,De="cards"in Z?Z.cards:Z.questions,ve=Array.isArray(De)&&De.some(T=>!T.suspended&&T.interval===0),Be=(Y.get(P)||new Set).has(A);if(!ve&&!Be&&(De==null?void 0:De.length)>0){const T=new Map(Y),z=T.get(P),ne=new Set(z instanceof Set?z:[]);ne.add(A),T.set(P,ne);try{await $n.saveSeriesProgress(P,ne);const se=G[P],ue=((se==null?void 0:se.levels)||[]).flatMap(oe=>(oe==null?void 0:oe.deckIds)||[]);ue.indexOf(A)===ue.length-1&&ue.length>0?p(`Congratulations! You've completed the series: "${se==null?void 0:se.name}"!`,"success"):p(`Deck "${Z.name}" completed! Next chapter unlocked.`,"success"),f({type:"SET_SERIES_PROGRESS",payload:T})}catch(se){console.error("Could not save series progress",se)}}}},[i,p,f]),E=$.useCallback(async A=>{const k=kt.getState().decks[A];if(!k)return;let R;k.type===et.Flashcard?R={...k,cards:(k.cards||[]).map(P=>fb(P))}:R={...k,questions:(k.questions||[]).map(P=>fb(P))},await i(R,{toastMessage:`Progress for deck "${R.name}" has been reset.`})},[i]),N=$.useCallback(()=>{const{decks:A,deckSeries:k,seriesProgress:R}=kt.getState(),P=new Set;Object.values(k).forEach(H=>(H.levels||[]).filter(Boolean).forEach(L=>(L.deckIds||[]).forEach(U=>P.add(U))));const q=new Set;Object.values(k).forEach(H=>{var L;if(!H.archived&&!H.deletedAt){const U=((L=R.get(H.id))==null?void 0:L.size)||0;let Q=0;(H.levels||[]).filter(Boolean).forEach(le=>{(le.deckIds||[]).forEach(F=>{Q<=U&&q.add(F),Q++})})}});const G=new Date;G.setHours(23,59,59,999);const Y=Object.values(A).filter(H=>!(H.type!==et.Quiz||H.archived||H.deletedAt||P.has(H.id)&&!q.has(H.id))).flatMap(H=>{const L=Object.values(k).find(U=>(U.levels||[]).some(Q=>(Q.deckIds||[]).includes(H.id)));return(H.questions||[]).filter(U=>!U.suspended&&new Date(U.dueDate)<=G).map(U=>({...U,originalDeckId:H.id,originalDeckName:H.name,originalSeriesName:L==null?void 0:L.name,originalSeriesId:L==null?void 0:L.id}))}).sort(()=>Math.random()-.5),W={id:"general-study-deck",name:"General Study Session",description:"A mix of all due questions.",type:et.Quiz,questions:Y};s(W),c(`/study/general?from=${encodeURIComponent(u)}`)},[c,s,u]),S=$.useCallback(async A=>{var le;const{decks:k,deckSeries:R,seriesProgress:P}=kt.getState(),q=R[A];if(!q)return;const G=new Set,Y=((le=P.get(q.id))==null?void 0:le.size)||0;let W=0;(q.levels||[]).filter(Boolean).forEach(F=>{(F.deckIds||[]).forEach(te=>{W<=Y&&G.add(te),W++})});const H=new Date;H.setHours(23,59,59,999);const U=(q.levels||[]).filter(Boolean).flatMap(F=>F.deckIds||[]).map(F=>k[F]).filter(F=>!!(F&&(F.type===et.Quiz||F.type===et.Learning))).filter(F=>G.has(F.id)).flatMap(F=>(F.questions||[]).filter(te=>!te.suspended&&new Date(te.dueDate)<=H).map(te=>({...te,originalDeckId:F.id,originalDeckName:F.name}))).sort(()=>Math.random()-.5),Q={id:"general-study-deck",name:`${q.name} - Study Session`,description:`A study session for due items in the series: ${q.name}`,type:et.Quiz,questions:U};s(Q),c(`/study/general?seriesId=${A}&from=${encodeURIComponent(u)}`)},[c,s,u]),I=$.useCallback(async A=>{f({type:"UPDATE_LEARNING_PROGRESS",payload:A});try{await $n.saveLearningProgress(A)}catch(k){console.error("Failed to save learning progress",k)}},[f]);return $.useMemo(()=>({handleSessionEnd:b,handleStudyNextDeckInSeries:m,handleItemReviewed:_,handleResetDeckProgress:E,handleStartGeneralStudy:N,handleStartSeriesStudy:S,handleUpdateLearningProgress:I}),[b,m,_,E,N,S,I])},hb=(n,a,s)=>{var N;const i={...a,decks:[...a.decks],deckSeries:[...a.deckSeries],seriesProgress:{...a.seriesProgress}},c=new Map(a.decks.map(S=>[S.id,S])),u=new Map(n.decks.map(S=>[S.id,S])),f=[];a.decks.forEach(S=>{s.decks[S.id]==="local"&&u.has(S.id)?f.push(u.get(S.id)):f.push(S)}),n.decks.forEach(S=>{c.has(S.id)||f.push(S)}),i.decks=f;const p=new Map(a.deckSeries.map(S=>[S.id,S])),b=new Map(n.deckSeries.map(S=>[S.id,S])),m=[];a.deckSeries.forEach(S=>{s.series[S.id]==="local"&&b.has(S.id)?(m.push(b.get(S.id)),n.seriesProgress&&n.seriesProgress[S.id]&&(i.seriesProgress[S.id]=n.seriesProgress[S.id])):m.push(S)}),n.deckSeries.forEach(S=>{p.has(S.id)||(m.push(S),n.seriesProgress&&n.seriesProgress[S.id]&&(i.seriesProgress[S.id]=n.seriesProgress[S.id]))}),i.deckSeries=m;const _=new Set((N=a.reviews)==null?void 0:N.map(S=>S.timestamp+S.itemId)),E=(n.reviews||[]).filter(S=>!_.has(S.timestamp+S.itemId));return i.reviews=[...i.reviews||[],...E],i.sessions=n.sessions,i},y2=({addToast:n,openModal:a,closeModal:s,dispatch:i,setLastSyncStatus:c,setIsSyncing:u,backupEnabled:f})=>{const p=H=>!H||H.length===0?0:H.reduce((L,U)=>L+m2(U),0)/H.length,b=$.useCallback(H=>{const L=kt.getState().decks,U=kt.getState().deckSeries,Q=[],le=[],F=[],te=[],j=new Map,he=new Map;return H.decks.forEach(J=>{const Z=L[J.id];if(!Z)Q.push(J),j.set(J.id,pc(J));else if(Z.lastModified!==J.lastModified){const De=(Z.type===et.Flashcard?Z.cards:(Z.type===et.Learning,Z.questions))||[],ve=(J.type===et.Flashcard?J.cards:J.type===et.Learning||J.type===et.Quiz?J.questions:[])||[],Be={content:De.length!==ve.length,dueCount:pc(Z)!==pc(J),mastery:!1};F.push({local:Z,backup:J,diff:Be}),j.set(`local-${Z.id}`,pc(Z)),j.set(J.id,pc(J));const T=De,z=ve,ne=p(T),se=p(z);he.set(`local-${Z.id}`,ne),he.set(J.id,se),Be.mastery=Math.abs(ne-se)>.01}}),H.deckSeries.forEach(J=>{const Z=U[J.id];if(!Z)le.push(J);else if(Z.lastModified!==J.lastModified){const De={structure:JSON.stringify(Z.levels)!==JSON.stringify(J.levels),completion:!1,mastery:!1};te.push({local:Z,backup:J,diff:De})}}),{newDecks:Q,newSeries:le,changedDecks:F,changedSeries:te,dueCounts:j,masteryLevels:he}},[]),m=$.useCallback(async(H={})=>{if(!f){H.isManual&&n("Backup is disabled in settings.","info");return}u(!0),c("Syncing...");try{const{timestamp:L}=await Sh(void 0,H.force),U=new Date(L);c(`Synced: ${U.toLocaleTimeString()}`),H.isManual&&n("Sync successful.","success")}catch(L){if(console.error("Sync failed",L),L.status===412||L.status===409){c("Sync Conflict");try{const U=await Eh(),Q=b(U);a("mergeConflict",{comparison:Q,remoteData:U})}catch{n("Sync failed and could not read server data for resolution.","error")}}else c("Sync Failed"),H.isManual&&n(`Sync failed: ${L.message}`,"error")}finally{u(!1)}},[f,n,u,c,b,a]),_=$.useCallback(async H=>{try{await vc(H),i({type:"RESTORE_DATA",payload:H}),H.aiChatHistory&&i({type:"SET_AI_CHAT_HISTORY",payload:H.aiChatHistory}),n("Data restored successfully.","success"),f&&m({isManual:!1,force:!0})}catch(L){console.error(L),n("Failed to restore data.","error")}},[i,n,m,f]),E=$.useCallback(()=>{m({isManual:!0})},[m]),N=$.useCallback(async()=>{u(!0);try{const H=await $i();localStorage.setItem("cogniflow-pre-fetch-backup",JSON.stringify(H));const L=await Eh();await vc(L),i({type:"RESTORE_DATA",payload:L}),L.aiChatHistory&&i({type:"SET_AI_CHAT_HISTORY",payload:L.aiChatHistory}),n("Force fetch successful.","success"),c(`Fetched: ${new Date().toLocaleTimeString()}`)}catch(H){n(`Force fetch failed: ${H.message}`,"error")}finally{u(!1)}},[i,u,n,c]),S=$.useCallback(async()=>{const H=localStorage.getItem("cogniflow-pre-fetch-backup");if(!H){n("No backup found to revert to.","error");return}try{const L=JSON.parse(H);await _(L),n("Reverted to state before last fetch.","success")}catch{n("Failed to revert.","error")}},[_,n]),I=$.useCallback(async()=>{u(!0);try{await Sh(void 0,!0),n("Force upload successful.","success"),c(`Synced: ${new Date().toLocaleTimeString()}`)}catch(H){n(`Force upload failed: ${H.message}`,"error")}finally{u(!1)}},[u,n,c]),A=$.useCallback(async()=>{u(!0);try{const H=await W1();n(`Backup created: ${H.filename}`,"success")}catch(H){n(`Backup failed: ${H.message}`,"error")}finally{u(!1)}},[u,n]),k=$.useCallback(async H=>{u(!0);try{await eE(H);const L=await Eh();await vc(L),i({type:"RESTORE_DATA",payload:L}),L.aiChatHistory&&i({type:"SET_AI_CHAT_HISTORY",payload:L.aiChatHistory}),n("Restored from server backup.","success"),c(`Restored: ${new Date().toLocaleTimeString()}`)}catch(L){n(`Restore failed: ${L.message}`,"error")}finally{u(!1)}},[u,n,i,c]),R=$.useCallback(async H=>{try{await tE(H)}catch(L){throw n(`Delete failed: ${L.message}`,"error"),L}},[n]),P=$.useCallback(async({selectedIds:H,backupData:L})=>{const U=await $i(),Q={decks:{},series:{}};L.decks.forEach(F=>{H.has(F.id)?Q.decks[F.id]="remote":Q.decks[F.id]="local"}),L.deckSeries.forEach(F=>{H.has(F.id)?Q.series[F.id]="remote":Q.series[F.id]="local"});const le=hb({...U},L,Q);await _(le)},[_]),q=$.useCallback(async(H,L)=>{s();const U=await $i(),Q=hb({...U},L,H);await vc(Q),i({type:"RESTORE_DATA",payload:Q}),Q.aiChatHistory&&i({type:"SET_AI_CHAT_HISTORY",payload:Q.aiChatHistory}),u(!0);try{await Sh(Q,!0),n("Sync conflict resolved.","success"),c(`Synced: ${new Date().toLocaleTimeString()}`)}catch{n("Failed to push resolved data to server.","error")}finally{u(!1)}},[s,i,n,u,c]),G=$.useCallback(async()=>{try{await Xb(),n("Export started.","info")}catch(H){n(`Export failed: ${H.message}`,"error")}},[n]),Y=$.useCallback(()=>{"serviceWorker"in navigator&&navigator.serviceWorker.controller?(navigator.serviceWorker.controller.postMessage({type:"CLEAR_APP_CACHE"}),n("App cache cleared. Reloading...","success"),setTimeout(()=>window.location.reload(),1e3)):n("Service worker not active.","error")},[n]),W=$.useCallback(()=>{"serviceWorker"in navigator&&navigator.serviceWorker.controller?(navigator.serviceWorker.controller.postMessage({type:"CLEAR_CDN_CACHE"}),n("CDN cache cleared.","success")):n("Service worker not active.","error")},[n]);return{triggerSync:m,handleManualSync:E,onRestoreData:_,handleCompareBackup:b,handleRestoreSelectedItems:P,handleForceFetchFromServer:N,handleForceUploadToServer:I,handleCreateServerBackup:A,handleRestoreFromServerBackup:k,handleDeleteServerBackup:R,handleMergeResolution:q,handleExportData:G,handleClearAppCache:Y,handleClearCdnCache:W,handleRevertLastFetch:S}};var v2={};const O0=n=>{try{return typeof process<"u"?v2[n]:void 0}catch{return}};O0("GDRIVE_API_KEY");O0("GDRIVE_CLIENT_ID");let b2=!1,sd=[],Rh=[];const x2=(n,a)=>{sd.forEach(s=>s(n,a))},_2=n=>(Rh.push(n),n(b2),()=>{Rh=Rh.filter(a=>a!==n)}),w2=n=>(sd.push(n),()=>{sd=sd.filter(a=>a!==n)}),S2=()=>{{console.error("Google services not ready for sign-in.");return}},E2=()=>{const n=gapi.client.getToken();gapi.client.setToken(null),localStorage.removeItem("gdrive-previously-signed-in"),x2(!1),n!==null&&google.accounts.oauth2.revoke(n.access_token,()=>{console.log("Google token revoked.")})},k2=async()=>{const n=await $i();if(n.decks.length===0&&n.folders.length===0&&n.deckSeries.length===0)throw new Error("There is no data to back up.");const a={version:7,...n},s=JSON.stringify(a),u={name:`cogniflow-backup-${cp()}.json`,parents:["appDataFolder"]},f="-------314159265358979323846",p=`\r
--${f}\r
`,b=`\r
--${f}--`,m=p+`Content-Type: application/json; charset=UTF-8\r
\r
`+JSON.stringify(u)+p+`Content-Type: application/json; charset=UTF-8\r
\r
`+s+b,_=await gapi.client.request({path:"https://www.googleapis.com/upload/drive/v3/files",method:"POST",params:{uploadType:"multipart",fields:"id, name, modifiedTime"},headers:{"Content-Type":`multipart/related; boundary=${f}`},body:m});if(_.status!==200)throw new Error("Failed to upload backup file.");return _.result},A2=async()=>(await gapi.client.drive.files.list({spaces:"appDataFolder",fields:"files(id, name, modifiedTime)",orderBy:"modifiedTime desc"})).result.files,T2=async n=>{const a=await gapi.client.drive.files.get({fileId:n,alt:"media"});if(a.status!==200)throw new Error("Failed to download backup file.");const s=typeof a.body=="string"?a.body:JSON.stringify(a.result);return await bd(s)},C2=({openConfirmModal:n,openRestoreFromDriveModal:a,setDriveFiles:s,onRestoreData:i})=>{const{addToast:c}=Ar(),u=$.useCallback(()=>{S2()},[]),f=$.useCallback(()=>{E2(),c("Signed out of Google Drive.","info")},[c]),p=$.useCallback(()=>{n({title:"Backup to Google Drive",message:"This will create a new backup file in a private application folder in your Google Drive. Are you sure?",onConfirm:async()=>{try{const _=await k2();c(`Successfully created backup: ${_.name}`,"success")}catch(_){const E=_ instanceof Error?_.message:"Failed to create backup.";c(E,"error")}}})},[c,n]),b=$.useCallback(async()=>{try{const _=await A2();s(_),a()}catch(_){const E=_ instanceof Error?_.message:"Failed to list files from Google Drive.";c(E,"error")}},[c,s,a]),m=$.useCallback(async _=>{n({title:"Restore from Google Drive",message:"Restoring will merge and overwrite data. Are you sure?",onConfirm:async()=>{try{const E=await T2(_);await i(E)}catch(E){const N=E instanceof Error?E.message:"Failed to restore from backup.";c(N,"error")}}})},[c,n,i]);return $.useMemo(()=>({handleGoogleSignIn:u,handleGoogleSignOut:f,handleBackupToDrive:p,handleListDriveFiles:b,handleRestoreFromDrive:m,openRestoreFromDriveModal:b}),[u,f,p,b,m])},N2=3,pb=3;async function j0(n,a=3,s=2e3){try{return await n()}catch(i){if(a<=0)throw i;const c=s*Math.pow(2,3-a);return await new Promise(u=>setTimeout(u,c)),j0(n,a-1,s)}}const D2=({handleUpdateDeck:n,handleAddDecks:a,handleAddSeriesWithDecks:s,handleUpdateSeries:i,openConfirmModal:c,openModal:u,closeModal:f})=>{const{dispatch:p}=kt(),{addToast:b}=Ar(),{veoEnabled:m,groundedImagesEnabled:_,searchAuditsEnabled:E}=Xi(),N=$.useCallback(async(T,z)=>{var ee,me,Ve,Ye;const{currentTask:ne}=kt.getState().aiGenerationStatus;if(!ne)return;const se=T.persona||"default",ue=localStorage.getItem("cogniflow-ai-options");let de=[];ue&&(de=JSON.parse(ue).personas||[]);const oe=de.find(be=>be.id===se)||{name:"Assistant",instruction:"You are a helpful assistant."};let ye=(ee=T.partialProgress)==null?void 0:ee.curriculum,ie=(me=T.partialProgress)==null?void 0:me.deckId,We=new Set(((Ve=T.partialProgress)==null?void 0:Ve.completedChapterIds)||[]),ot=((Ye=T.partialProgress)==null?void 0:Ye.previousSummariesMap)||{},ft=new Map;if(ye){const be=kt.getState().decks[ie];be&&be.generationStatus!=="generating"&&await n({...be,generationStatus:"generating"},{silent:!0})}else{p({type:"UPDATE_CURRENT_AI_TASK_STATUS",payload:{statusText:"Ingesting material & architecting..."}});try{ye=await gk(T,oe),ie=crypto.randomUUID();const Ze=(ye.chapters||[]).map(Ue=>({id:Ue.id,content:"",unlocksQuestionIds:[],prerequisiteIds:Ue.prerequisiteChapterIds||[]})),at={id:ie,name:ye.name||T.topic,description:ye.description||`Generating: ${T.topic}...`,type:et.Learning,infoCards:Ze,questions:[],learningMode:"separate",curriculum:ye,generationStatus:"generating"};await a([at]),p({type:"UPDATE_CURRENT_AI_TASK_STATUS",payload:{payload:{...T,partialProgress:{...T.partialProgress,curriculum:ye,deckId:ie,completedChapterIds:[],previousSummariesMap:{}}}}})}catch(be){if(be.jsonString){u("aiResponseFix",{badJson:be.jsonString,onRetry:Ze=>{const at={...ne,payload:{...T,partialProgress:{curriculum:Ze}}};p({type:"CANCEL_AI_TASK"}),p({type:"ADD_AI_TASK_TO_QUEUE",payload:at})},onCancel:()=>p({type:"CANCEL_AI_TASK"})});return}throw be}}if(z.aborted)return;const $e=ye.chapters,C=$e.length,Ne=Math.floor((T.targetWordCount||1e4)/C),Ce=ye.sharedDictionary||{},re=new Set;for(;We.size<C&&!z.aborted;){const be=$e.filter(Ue=>We.has(Ue.id)||re.has(Ue.id)||(ft.get(Ue.id)||0)>=pb?!1:(Ue.prerequisiteChapterIds||[]).every(Nt=>We.has(Nt)));if(be.length===0&&re.size===0)break;const Ze=N2-re.size;be.slice(0,Ze).forEach(Ue=>{re.add(Ue.id),(async()=>{var _t;try{const It=$e.indexOf(Ue),Nt=(Ue.prerequisiteChapterIds||[]).map(At=>ot[At]).filter(Boolean),on=await _k(T.topic,Nt,Ce);p({type:"UPDATE_CHAPTER_PHASE",payload:{chapterId:Ue.id,phase:"drafting"}});let Zt="";if(await j0(async()=>{const At=yk(T.topic,Ue,C,It,oe,Ne,Ce,on,T.sourceMaterial);for await(const gt of At){if(z.aborted)return;Zt+=gt,p({type:"UPDATE_STREAMING_DRAFT",payload:{chapterId:Ue.id,text:Zt}})}},pb),z.aborted)return;p({type:"UPDATE_CHAPTER_PHASE",payload:{chapterId:Ue.id,phase:"finalizing"}});const cn=await vk(T.topic,Ue,C,It,oe,Ne,Ce,on,T.sourceMaterial);Zt=cn.content;const bn=cn.summaryForArchivist;if(E){p({type:"UPDATE_CHAPTER_PHASE",payload:{chapterId:Ue.id,phase:"auditing"}});let At=await wk(T.topic,Ue.title,Zt);((_t=At.corrections)==null?void 0:_t.length)>0&&(Zt=(await Sk(T.topic,Zt,At.corrections)).refinedContent)}p({type:"UPDATE_CHAPTER_PHASE",payload:{chapterId:Ue.id,phase:"illustrating"}});let zt=await Ek(T.topic,Zt);if(zt.hasDiagram&&zt.svgCode){const At=`<div class="factual-diagram my-8 flex flex-col items-center bg-surface-dark p-4 rounded-xl border border-border shadow-inner"><div class="max-w-full overflow-x-auto">${zt.svgCode}</div><p class="text-xs text-text-muted mt-3 italic text-center max-w-sm">${zt.caption}</p></div>`;Zt=Zt.replace(/(<\/h[23]>)/,`$1
${At}
`)}p({type:"UPDATE_CHAPTER_PHASE",payload:{chapterId:Ue.id,phase:"finalizing"}});let Ht=await kk(T.topic,Ue.title,Zt);if(z.aborted)return;const yt=Ue.id,tn=Ht.questions.map(At=>({...At,id:At.id||crypto.randomUUID(),questionType:"multipleChoice",dueDate:new Date().toISOString(),interval:0,easeFactor:2.5,lapses:0,masteryLevel:0,suspended:!1,infoCardIds:[yt],options:(At.options||[]).map(gt=>({...gt,id:crypto.randomUUID()})),bloomsLevel:At.bloomsLevel})),or=kt.getState().decks[ie];if(or){const At=or.infoCards.map(gt=>gt.id===yt?{...gt,content:Ht.refinedContent||Zt,unlocksQuestionIds:tn.map(jr=>jr.id)}:gt);await n({...or,infoCards:At,questions:[...or.questions,...tn],lastModified:Date.now()},{silent:!0})}We.add(Ue.id),ot[yt]=bn,p({type:"UPDATE_CHAPTER_PHASE",payload:{chapterId:Ue.id,phase:"complete"}})}catch(It){console.error(It),ft.set(Ue.id,(ft.get(Ue.id)||0)+1),p({type:"UPDATE_CHAPTER_PHASE",payload:{chapterId:Ue.id,phase:"failed"}})}finally{re.delete(Ue.id)}})()}),await new Promise(Ue=>setTimeout(Ue,3e3))}if(!z.aborted){let be=kt.getState().decks[ie];be&&await n({...be,generationStatus:"complete"},{toastMessage:"Document synthesis complete!"}),p({type:"CLEAR_STREAMING_DRAFTS"})}},[p,a,n,u,b,E]),S=$.useCallback(async(T,z)=>{if(!T.deckId||!T.itemId)return;const ne=kt.getState().decks[T.deckId];if(!ne)return;const se=T.persona||"default",ue=localStorage.getItem("cogniflow-ai-options"),oe=(ue?JSON.parse(ue).personas||[]:[]).find(ye=>ye.id===se)||{name:"Assistant",instruction:"You are helpful."};p({type:"UPDATE_CURRENT_AI_TASK_STATUS",payload:{statusText:"Synthesizing conceptual expansion..."}});try{const ye={targetWordCount:T.targetWordCount,analogyIntensity:T.analogyIntensity,thinkingBudget:T.thinkingBudget};if(ne.type===et.Learning){const ie=ne,We=ie.infoCards.find($e=>$e.id===T.itemId);if(!We)return;const ot=await ib(ne.name,We.content,oe,ye);if(z.aborted)return;const ft={...ie,infoCards:ie.infoCards.map($e=>$e.id===T.itemId?{...$e,content:ot}:$e)};await n(ft,{silent:!0}),b("Item expanded with custom synthesis!","success")}else if(ne.type===et.Flashcard){const ie=ne,We=ie.cards.find($e=>$e.id===T.itemId);if(!We)return;const ot=await ib(ne.name,We.back,oe,ye);if(z.aborted)return;const ft={...ie,cards:ie.cards.map($e=>$e.id===T.itemId?{...$e,back:ot}:$e)};await n(ft,{silent:!0}),b("Card expanded!","success")}}catch(ye){b(`Expansion failed: ${ye.message}`,"error")}},[p,n,b]),I=$.useCallback(async(T,z)=>{if(!T.deckId||!T.itemId)return;const ne=kt.getState().decks[T.deckId];if(!ne)return;const se=ne.infoCards.find(ue=>ue.id===T.itemId);if(se){p({type:"UPDATE_CURRENT_AI_TASK_STATUS",payload:{statusText:"Synthesizing higher-order assessments..."}});try{const ue=await mk(ne.name,se.content,T.count||3);if(z.aborted)return;const de=ue.map(ye=>({...ye,id:crypto.randomUUID(),questionType:"multipleChoice",dueDate:new Date().toISOString(),interval:0,easeFactor:2.5,lapses:0,masteryLevel:0,suspended:!1,infoCardIds:[se.id],options:(ye.options||[]).map(ie=>({...ie,id:crypto.randomUUID()}))})),oe={...ne,questions:[...ne.questions,...de],infoCards:ne.infoCards.map(ye=>ye.id===se.id?{...ye,unlocksQuestionIds:[...ye.unlocksQuestionIds||[],...de.map(ie=>ie.id)]}:ye)};await n(oe,{silent:!0}),b(`Synthesized ${de.length} deep assessment items!`,"success")}catch(ue){b(`Deepening failed: ${ue.message}`,"error")}}},[p,n,b]),A=$.useCallback(async(T,z,ne={})=>{if(z==="text"){const se=T.type===et.Learning?T.infoCards:T.type===et.Flashcard?T.cards:[];se.forEach(ue=>{const de={id:crypto.randomUUID(),type:"holistic-expand-item",payload:{generationType:"holistic-expand-item",topic:T.name,persona:ne.persona||"the_master",understanding:ne.understanding||"Advanced",comprehensiveness:ne.comprehensiveness||"Standard",targetWordCount:ne.targetWordCount||500,thinkingBudget:ne.thinkingBudget,analogyIntensity:ne.analogyIntensity||"standard",deckId:T.id,itemId:ue.id},statusText:"Enhancing conceptual depth..."};p({type:"ADD_AI_TASK_TO_QUEUE",payload:de})}),b(`Queued ${se.length} conceptual enhancements.`,"info")}else{const se=T;se.infoCards.forEach(ue=>{const de={id:crypto.randomUUID(),type:"deep-expand-questions",payload:{generationType:"deep-expand-questions",topic:T.name,persona:ne.persona||"default",understanding:ne.understanding||"Advanced",comprehensiveness:ne.comprehensiveness||"Standard",count:ne.count||2,deckId:T.id,itemId:ue.id},statusText:"Drafting analysis questions..."};p({type:"ADD_AI_TASK_TO_QUEUE",payload:de})}),b(`Queued assessment depth for ${se.infoCards.length} chapters.`,"info")}},[p,b]),k=$.useCallback(async(T,z)=>{p({type:"UPDATE_CURRENT_AI_TASK_STATUS",payload:{statusText:"Inhaling source material..."}});const ne=T.generationType==="deck-course"||T.generationType==="single-deck-learning",se=await ob(T.topic,T.comprehensiveness,ne,T.sourceMaterial),{infoCards:ue,questions:de,name:oe,description:ye}=se;if(z.aborted)throw new Error("Cancelled by user");const ie=(ue||[]).map(ft=>({...ft,id:ft.id||crypto.randomUUID(),unlocksQuestionIds:ft.unlocksQuestionIds||[]})),We=Ea(de||[]),ot={id:crypto.randomUUID(),name:oe||T.topic,description:ye||`Course from document: ${T.topic}`,type:et.Learning,infoCards:ie,questions:We,learningMode:"separate"};await a([ot]),b("Learning Deck synthesized!","success")},[p,a,b]),R=$.useCallback(async(T,z)=>{var oe;const ne=kt.getState().decks[T.deckId];if(!ne||ne.type!==et.Quiz&&ne.type!==et.Learning)return;const se=ne,ue=se.questions.length,de=[...se.questions];for(let ye=0;ye<ue;ye++){if(z.aborted)throw new Error("Cancelled by user");const ie=de[ye];p({type:"UPDATE_CURRENT_AI_TASK_STATUS",payload:{statusText:`Hardening question ${ye+1}/${ue}...`}});try{const We=ie.options.filter(C=>C.id!==ie.correctAnswerId).map(C=>C.text),ot=((oe=ie.options.find(C=>C.id===ie.correctAnswerId))==null?void 0:oe.text)||"",ft=await jk(ie.questionText,ot,We,ne.name),$e=ie.options.find(C=>C.id===ie.correctAnswerId);de[ye]={...ie,options:[$e,...ft.map(C=>({id:crypto.randomUUID(),text:C.text,explanation:C.explanation}))].sort(()=>Math.random()-.5)}}catch{}}await n({...ne,questions:de}),b(`Hardened distractors for all ${ue} questions!`,"success")},[p,n,b]),P=$.useCallback(async(T,z)=>{const ne=kt.getState().decks[T.deckId];if(!ne||ne.type!==et.Flashcard)return;const se=ne,ue=se.cards.length,de=[...se.cards];let oe=0;for(let ye=0;ye<ue;ye++){if(z.aborted)throw new Error("Cancelled by user");const ie=de[ye];if(!ie.frontAudio||!ie.backAudio){p({type:"UPDATE_CURRENT_AI_TASK_STATUS",payload:{statusText:`Generating audio for card ${ye+1}/${ue}...`}});try{const[We,ot]=await Promise.all([ie.frontAudio?Promise.resolve(ie.frontAudio):lb(ie.front.replace(/<[^>]+>/g,"")),ie.backAudio?Promise.resolve(ie.backAudio):lb(ie.back.replace(/<[^>]+>/g,""))]);de[ye]={...ie,frontAudio:We,backAudio:ot},oe++}catch{}}}await n({...ne,cards:de}),b(`Audio generated for ${oe} card sides!`,"success")},[p,n,b]),q=$.useCallback(async(T,z)=>{const ne=kt.getState().decks[T.deckId];if(!ne)return;p({type:"UPDATE_CURRENT_AI_TASK_STATUS",payload:{statusText:"Analyzing concepts..."}});const se=await Ok(ne);if(z.aborted)throw new Error("Cancelled by user");p({type:"UPDATE_CURRENT_AI_TASK_STATUS",payload:{statusText:"Structuring course..."}});let ue=[];ne.type===et.Flashcard?(ue=ne.cards.map(oe=>({id:oe.id,questionType:"multipleChoice",questionText:oe.front,options:[{id:crypto.randomUUID(),text:oe.back},{id:crypto.randomUUID(),text:"Incorrect Option A"},{id:crypto.randomUUID(),text:"Incorrect Option B"}].sort(()=>Math.random()-.5),correctAnswerId:"",detailedExplanation:`Concept: ${oe.front} is ${oe.back}`,dueDate:oe.dueDate,interval:0,easeFactor:oe.easeFactor,lapses:oe.lapses,masteryLevel:oe.masteryLevel,suspended:!1,lastReviewed:oe.lastReviewed})),ue.forEach(oe=>{const ye=oe.options.find(ie=>{var We;return ie.text===((We=ne.cards.find(ot=>ot.id===oe.id))==null?void 0:We.back)});oe.correctAnswerId=(ye==null?void 0:ye.id)||oe.options[0].id})):ue=ne.questions;const de={...ne,type:et.Learning,infoCards:se.infoCards.map(oe=>({...oe,id:oe.id||crypto.randomUUID(),unlocksQuestionIds:oe.unlocksQuestionIds||[]})),questions:ue,learningMode:"separate"};await n(de,{toastMessage:`"${ne.name}" is now a Learning Deck!`})},[p,n]),G=$.useCallback(T=>{u("aiGenerationChat",{params:T})},[u]),Y=$.useCallback(async T=>{const z=crypto.randomUUID(),{generationType:ne}=T;let se;ne==="deep-course"?se={id:z,type:"generateDeepCourse",payload:T,statusText:"Synthesizing course from document...",deckId:T.deckId}:ne==="single-deck-learning"||ne==="deck-course"?se={id:z,type:"generateLearningDeckWithAI",payload:T,statusText:"Generating learning guide..."}:["deck-flashcard","deck-vocab","deck-atomic"].includes(ne)?se={id:z,type:"generateFlashcardDeckWithAI",payload:T,statusText:"Generating flashcards..."}:ne==="rework-deck"?se={id:z,type:"rework-deck",payload:T,statusText:`Reworking "${T.topic}"`}:ne==="holistic-expand-item"?se={id:z,type:"holistic-expand-item",payload:T,statusText:"Enhancing concept..."}:ne==="deep-expand-questions"?se={id:z,type:"deep-expand-questions",payload:T,statusText:"Expanding assessments..."}:se={id:z,type:"generateDeckFromOutline",payload:{immediate:!0,topic:T.topic,understanding:T.understanding,count:T.count},statusText:"Generating quiz..."},p({type:"ADD_AI_TASK_TO_QUEUE",payload:se}),b("Task added to queue.","info")},[p,b]),W=$.useCallback(async T=>{try{switch(T.action){case xc.CREATE_DECK:await a([{id:crypto.randomUUID(),name:T.payload.name,type:et.Flashcard,cards:[],folderId:T.payload.folderId||null,description:"Created by AI"}]),b(`Deck "${T.payload.name}" created.`,"success");break;case xc.UPGRADE_TO_LEARNING:const z=kt.getState().decks[T.payload.deckId];z&&q({deckId:z.id},new AbortController().signal);break;case xc.REWORK_DECK:const ne=kt.getState().decks[T.payload.deckId];ne&&Y({generationType:"rework-deck",topic:ne.name,deckId:ne.id,reworkInstructions:T.payload.reworkInstructions||"Improve content.",persona:T.payload.persona||"default",understanding:"Intermediate",comprehensiveness:"Standard"});break;default:b("Action not implemented yet.","info")}}catch(z){b(`Failed: ${z.message}`,"error")}},[a,b,q,Y]),H=$.useCallback(T=>{p({type:"CANCEL_AI_TASK",payload:{taskId:T}}),b("Generation cancelled.","info")},[p,b]),L=$.useCallback(T=>{u("aiGeneration",{context:{deckId:T.id,deckName:T.name,deckType:T.type,mode:"expand"}})},[u]),U=$.useCallback(T=>{u("aiGeneration",{context:{deckId:T.id,deckName:T.name,deckType:T.type,mode:"rework"}})},[u]),Q=$.useCallback((T,z)=>{const ne=kt.getState().deckSeries[T];u("aiGeneration",{initialGenerationType:"single-deck-quiz",context:{seriesId:T,seriesName:ne==null?void 0:ne.name,levelIndex:z}})},[u]),le=$.useCallback(T=>{const z=kt.getState().deckSeries[T];u("aiGeneration",{initialGenerationType:"series-auto-fill",context:{seriesId:T,seriesName:z==null?void 0:z.name}})},[u]),F=$.useCallback(async(T,z)=>{if(!T.deckId)return;const se=kt.getState().decks[T.deckId];if(!se)return;const ue=T.persona||"default",de=localStorage.getItem("cogniflow-ai-options"),ye=(de?JSON.parse(de).personas||[]:[]).find(ie=>ie.id===ue)||{name:"Assistant",instruction:"You are helpful."};p({type:"UPDATE_CURRENT_AI_TASK_STATUS",payload:{statusText:`Reworking "${se.name}"...`}});try{const ie=await Nk(se,T,ye);if(z.aborted)throw new Error("Cancelled by user");let We;se.type===et.Flashcard?We={...se,name:ie.name||se.name,description:ie.description||se.description,cards:ko(ie.cards||[])}:se.type===et.Quiz?We={...se,name:ie.name||se.name,description:ie.description||se.description,questions:Ea(ie.questions||[])}:We={...se,name:ie.name||se.name,description:ie.description||se.description,infoCards:(ie.infoCards||[]).map(ot=>({...ot,id:ot.id||crypto.randomUUID()})),questions:Ea(ie.questions||[])},await n(We,{toastMessage:`"${se.name}" reworked successfully!`})}catch(ie){b(`Failed: ${ie.message}`,"error")}},[p,n,b]),te=$.useCallback(async(T,z)=>{const{seriesId:ne,topic:se,comprehensiveness:ue}=T,de=kt.getState();let oe=ne&&de.deckSeries[ne]||null;if(!oe&&se){p({type:"UPDATE_CURRENT_AI_TASK_STATUS",payload:{statusText:"Designing curriculum..."}});const ye=await Ik(se);if(z.aborted)return;const ie=[],We=(ye.levels||[]).map(ot=>{const ft=(ot.decks||[]).map($e=>({id:crypto.randomUUID(),name:$e.name,description:$e.description,type:et.Quiz,questions:[]}));return ie.push(...ft),{title:ot.title,deckIds:ft.map($e=>$e.id)}});oe={id:crypto.randomUUID(),type:"series",name:ye.name||se,description:ye.description||"",levels:We,createdAt:new Date().toISOString(),archived:!1},await s(oe,ie)}},[p,s,a,i,b]),j=$.useCallback(async(T,z)=>{const{seriesId:ne,levelIndex:se}=T,ue=kt.getState().deckSeries[ne];if(!ue||!ue.levels[se])return;const de=ue.levels[se];de.deckIds.map(We=>{var ot;return(ot=kt.getState().decks[We])==null?void 0:ot.name}).filter(Boolean);const oe=await Rk(ue.name,ue.description,de.title);if(z.aborted)return;const ye=oe.map(We=>({id:crypto.randomUUID(),name:We.name,description:We.description,type:et.Quiz,questions:[]}));await a(ye);const ie={...ue,levels:ue.levels.map((We,ot)=>ot===se?{...We,deckIds:[...We.deckIds,...ye.map(ft=>ft.id)]}:We)};await i(ie,{silent:!0})},[a,i]),he=$.useCallback(async(T,z,ne,se)=>{const ue=await Dk(T,z||5);if(se.aborted)return;const de=Ea(ue);await n({...T,questions:[...T.questions||[],...de]},{silent:!0})},[n]),J=$.useCallback(async(T,z)=>{const ne=kt.getState().deckSeries[T.seriesId];if(!ne)return;const se=(ne.levels||[]).flatMap(de=>de.deckIds),ue=kt.getState().decks;for(const de of se){if(z.aborted)return;const oe=ue[de];(oe==null?void 0:oe.type)===et.Quiz&&oe.questions.length===0&&(p({type:"UPDATE_CURRENT_AI_TASK_STATUS",payload:{statusText:`Generating for "${oe.name}"...`}}),await he(oe,5,{name:ne.name},z))}},[he,p]),Z=$.useCallback(async(T,z)=>{const ne=kt.getState().decks[T.deckId];if(!ne)return;const se=ne.questions,ue=se.find(oe=>oe.id===T.questionId);if(!ue)return;const de=await Mk(ue,ne.name);z.aborted||await n({...ne,questions:se.map(oe=>oe.id===T.questionId?{...ue,...de}:oe)},{silent:!0})},[n]),De=$.useCallback(async(T,z)=>{p({type:"UPDATE_CURRENT_AI_TASK_STATUS",payload:{statusText:"Generating..."}});let ne=T.immediate?await ob(T.topic,"Standard",!1):await Tk(T.outline,T.metadata);if(z.aborted)throw new Error("Cancelled");const se=T.deckId?kt.getState().decks[T.deckId]:null;if(se){const de=Ea(ne.questions||[]);await n({...se,questions:[...se.questions||[],...de]},{silent:!0}),b(`Added content to "${se.name}"!`,"success");return}const ue={id:crypto.randomUUID(),name:ne.name||T.topic||"New Quiz",description:ne.description||"",type:et.Quiz,questions:Ea(ne.questions||[])};await a([ue]),b(`Deck "${ue.name}" generated!`,"success")},[p,a,i,b,n]),ve=$.useCallback(async(T,z)=>{p({type:"UPDATE_CURRENT_AI_TASK_STATUS",payload:{statusText:"Generating cards..."}}),(localStorage.getItem("cogniflow-ai-options")?JSON.parse(localStorage.getItem("cogniflow-ai-options")).personas:[]).find(ue=>ue.id===T.persona);const ne=await xk(T);if(z.aborted)throw new Error("Cancelled");const se={id:crypto.randomUUID(),name:ne.name||T.topic,description:ne.description||"",type:et.Flashcard,cards:ko(ne.cards||[])};await a([se]),b(`Deck "${se.name}" generated!`,"success")},[p,a,b]),Be=$.useCallback(async(T,z)=>{p({type:"UPDATE_CURRENT_AI_TASK_STATUS",payload:{statusText:"Creating series..."}});const ne=T.generationType.includes("flashcard")?et.Flashcard:et.Quiz,se=await Ck(T.outline);if(z.aborted)throw new Error("Cancelled");const ue=[],de=(se.levels||[]).map(oe=>{const ye=(oe.decks||[]).map(ie=>{const We={id:crypto.randomUUID(),name:ie.name,description:ie.description};return ne===et.Flashcard?{...We,type:et.Flashcard,cards:[]}:{...We,type:et.Quiz,questions:[]}});return ue.push(...ye),{title:oe.title,deckIds:ye.map(ie=>ie.id)}});await s({id:crypto.randomUUID(),type:"series",name:se.name||"New Series",description:se.description||"",levels:de,createdAt:new Date().toISOString(),archived:!1},ue)},[p,s]);return{onGenerateDeepCourse:N,onHardenAllDistractors:R,onGenerateAudioForAllCards:P,onUpgradeDeckToLearning:q,handleStartAIGeneration:G,handleImmediateAIGeneration:Y,handleExecuteAIAction:W,handleCancelAIGeneration:H,handleOpenAIGenerationForDeck:L,handleOpenAIReworkForDeck:U,handleOpenAIGenerationForSeriesLevel:Q,handleOpenAIAutoExpandSeries:le,onReworkDeckContent:F,onAutoPopulateSeries:te,onAutoPopulateLevel:j,onGenerateQuestionsForDeck:he,onGenerateLearningContentForDeck:k,onGenerateSeriesQuestionsInBatches:J,onRegenerateQuestion:Z,onGenerateDeckFromOutline:De,onGenerateFlashcardDeck:ve,onGenerateLearningDeckWithAI:k,onGenerateFullSeriesFromScaffold:Be,onHolisticExpandItem:S,onDeepExpandQuestions:I,handleHolisticUpgrade:A,handleAutoTagQuestions:T=>{},handleSuggestDeckIcon:T=>{},handleExpandText:(T,z,ne)=>{},handleGenerateCardExamples:(T,z,ne)=>{},handleHardenDistractors:(T,z)=>{}}};var Mh={exports:{}};const O2={},j2=Object.freeze(Object.defineProperty({__proto__:null,default:O2},Symbol.toStringTag,{value:"Module"})),Uh=Xx(j2);var mb;function I2(){return mb||(mb=1,(function(n,a){var s=void 0,i=function(c){return s||(s=new Promise(function(u,f){var p=typeof c<"u"?c:{},b=p.onAbort;p.onAbort=function(v){f(new Error(v)),b&&b(v)},p.postRun=p.postRun||[],p.postRun.push(function(){u(p)}),n=void 0;var m;m||(m=typeof p<"u"?p:{}),m.onRuntimeInitialized=function(){function v(Me,it){switch(typeof it){case"boolean":is(Me,it?1:0);break;case"number":El(Me,it);break;case"string":vi(Me,it,-1,-1);break;case"object":if(it===null)yi(Me);else if(it.length!=null){var Dt=Ca(it,lr);io(Me,Dt,it.length,-1),Pa(Dt)}else ws(Me,"Wrong API use : tried to return a value of an unknown type ("+it+").",-1);break;default:yi(Me)}}function x(Me,it){for(var Dt=[],Bt=0;Bt<Me;Bt+=1){var Xt=Ce(it+4*Bt,"i32"),Tn=ro(Xt);if(Tn===1||Tn===2)Xt=Mo(Xt);else if(Tn===3)Xt=gi(Xt);else if(Tn===4){Tn=Xt,Xt=ao(Tn),Tn=so(Tn);for(var Xr=new Uint8Array(Xt),Ir=0;Ir<Xt;Ir+=1)Xr[Ir]=Q[Tn+Ir];Xt=Xr}else Xt=null;Dt.push(Xt)}return Dt}function M(Me,it){this.La=Me,this.db=it,this.Ja=1,this.fb=[]}function X(Me,it){if(this.db=it,it=on(Me)+1,this.Ya=Jr(it),this.Ya===null)throw Error("Unable to allocate memory for the SQL string");Zt(Me,le,this.Ya,it),this.eb=this.Ya,this.Ua=this.ib=null}function ce(Me){if(this.filename="dbfile_"+(4294967295*Math.random()>>>0),Me!=null){var it=this.filename,Dt="/",Bt=it;if(Dt&&(Dt=typeof Dt=="string"?Dt:Lr(Dt),Bt=it?be(Dt+"/"+it):Dt),it=gt(!0,!0),Bt=St(Bt,(it!==void 0?it:438)&4095|32768,0),Me){if(typeof Me=="string"){Dt=Array(Me.length);for(var Xt=0,Tn=Me.length;Xt<Tn;++Xt)Dt[Xt]=Me.charCodeAt(Xt);Me=Dt}Hr(Bt,it|146),Dt=Xn(Bt,577),dn(Dt,Me,0,Me.length,0),es(Dt),Hr(Bt,it)}}this.handleError(Mt(this.filename,He)),this.db=Ce(He,"i32"),bi(this.db),this.Za={},this.Na={}}var He=hr(4),Je=m.cwrap,Mt=Je("sqlite3_open","number",["string","number"]),fn=Je("sqlite3_close_v2","number",["number"]),Vt=Je("sqlite3_exec","number",["number","string","number","number","number"]),Yn=Je("sqlite3_changes","number",["number"]),Bn=Je("sqlite3_prepare_v2","number",["number","string","number","number","number"]),ss=Je("sqlite3_sql","string",["number"]),Wi=Je("sqlite3_normalized_sql","string",["number"]),Bs=Je("sqlite3_prepare_v2","number",["number","number","number","number","number"]),ui=Je("sqlite3_bind_text","number",["number","number","number","number","number"]),Fs=Je("sqlite3_bind_blob","number",["number","number","number","number","number"]),di=Je("sqlite3_bind_double","number",["number","number","number"]),Sl=Je("sqlite3_bind_int","number",["number","number","number"]),fi=Je("sqlite3_bind_parameter_index","number",["number","string"]),eo=Je("sqlite3_step","number",["number"]),to=Je("sqlite3_errmsg","string",["number"]),no=Je("sqlite3_column_count","number",["number"]),hi=Je("sqlite3_data_count","number",["number"]),Nr=Je("sqlite3_column_double","number",["number","number"]),xs=Je("sqlite3_column_text","string",["number","number"]),Hs=Je("sqlite3_column_blob","number",["number","number"]),jo=Je("sqlite3_column_bytes","number",["number","number"]),_s=Je("sqlite3_column_type","number",["number","number"]),Io=Je("sqlite3_column_name","string",["number","number"]),Ro=Je("sqlite3_reset","number",["number"]),pi=Je("sqlite3_clear_bindings","number",["number"]),mi=Je("sqlite3_finalize","number",["number"]),qa=Je("sqlite3_create_function_v2","number","number string number number number number number number number".split(" ")),ro=Je("sqlite3_value_type","number",["number"]),ao=Je("sqlite3_value_bytes","number",["number"]),gi=Je("sqlite3_value_text","string",["number"]),so=Je("sqlite3_value_blob","number",["number"]),Mo=Je("sqlite3_value_double","number",["number"]),El=Je("sqlite3_result_double","",["number","number"]),yi=Je("sqlite3_result_null","",["number"]),vi=Je("sqlite3_result_text","",["number","string","number","number"]),io=Je("sqlite3_result_blob","",["number","number","number","number"]),is=Je("sqlite3_result_int","",["number","number"]),ws=Je("sqlite3_result_error","",["number","string","number"]),oo=Je("sqlite3_aggregate_context","number",["number","number"]),bi=Je("RegisterExtensionFunctions","number",["number"]);M.prototype.bind=function(Me){if(!this.La)throw"Statement closed";return this.reset(),Array.isArray(Me)?this.wb(Me):Me!=null&&typeof Me=="object"?this.xb(Me):!0},M.prototype.step=function(){if(!this.La)throw"Statement closed";this.Ja=1;var Me=eo(this.La);switch(Me){case 100:return!0;case 101:return!1;default:throw this.db.handleError(Me)}},M.prototype.rb=function(Me){return Me==null&&(Me=this.Ja,this.Ja+=1),Nr(this.La,Me)},M.prototype.Ab=function(Me){if(Me==null&&(Me=this.Ja,this.Ja+=1),Me=xs(this.La,Me),typeof BigInt!="function")throw Error("BigInt is not supported");return BigInt(Me)},M.prototype.Bb=function(Me){return Me==null&&(Me=this.Ja,this.Ja+=1),xs(this.La,Me)},M.prototype.getBlob=function(Me){Me==null&&(Me=this.Ja,this.Ja+=1);var it=jo(this.La,Me);Me=Hs(this.La,Me);for(var Dt=new Uint8Array(it),Bt=0;Bt<it;Bt+=1)Dt[Bt]=Q[Me+Bt];return Dt},M.prototype.get=function(Me,it){it=it||{},Me!=null&&this.bind(Me)&&this.step(),Me=[];for(var Dt=hi(this.La),Bt=0;Bt<Dt;Bt+=1)switch(_s(this.La,Bt)){case 1:var Xt=it.useBigInt?this.Ab(Bt):this.rb(Bt);Me.push(Xt);break;case 2:Me.push(this.rb(Bt));break;case 3:Me.push(this.Bb(Bt));break;case 4:Me.push(this.getBlob(Bt));break;default:Me.push(null)}return Me},M.prototype.getColumnNames=function(){for(var Me=[],it=no(this.La),Dt=0;Dt<it;Dt+=1)Me.push(Io(this.La,Dt));return Me},M.prototype.getAsObject=function(Me,it){Me=this.get(Me,it),it=this.getColumnNames();for(var Dt={},Bt=0;Bt<it.length;Bt+=1)Dt[it[Bt]]=Me[Bt];return Dt},M.prototype.getSQL=function(){return ss(this.La)},M.prototype.getNormalizedSQL=function(){return Wi(this.La)},M.prototype.run=function(Me){return Me!=null&&this.bind(Me),this.step(),this.reset()},M.prototype.nb=function(Me,it){it==null&&(it=this.Ja,this.Ja+=1),Me=cn(Me);var Dt=Ca(Me,lr);this.fb.push(Dt),this.db.handleError(ui(this.La,it,Dt,Me.length-1,0))},M.prototype.vb=function(Me,it){it==null&&(it=this.Ja,this.Ja+=1);var Dt=Ca(Me,lr);this.fb.push(Dt),this.db.handleError(Fs(this.La,it,Dt,Me.length,0))},M.prototype.mb=function(Me,it){it==null&&(it=this.Ja,this.Ja+=1),this.db.handleError((Me===(Me|0)?Sl:di)(this.La,it,Me))},M.prototype.yb=function(Me){Me==null&&(Me=this.Ja,this.Ja+=1),Fs(this.La,Me,0,0,0)},M.prototype.ob=function(Me,it){switch(it==null&&(it=this.Ja,this.Ja+=1),typeof Me){case"string":this.nb(Me,it);return;case"number":this.mb(Me,it);return;case"bigint":this.nb(Me.toString(),it);return;case"boolean":this.mb(Me+0,it);return;case"object":if(Me===null){this.yb(it);return}if(Me.length!=null){this.vb(Me,it);return}}throw"Wrong API use : tried to bind a value of an unknown type ("+Me+")."},M.prototype.xb=function(Me){var it=this;return Object.keys(Me).forEach(function(Dt){var Bt=fi(it.La,Dt);Bt!==0&&it.ob(Me[Dt],Bt)}),!0},M.prototype.wb=function(Me){for(var it=0;it<Me.length;it+=1)this.ob(Me[it],it+1);return!0},M.prototype.reset=function(){return this.freemem(),pi(this.La)===0&&Ro(this.La)===0},M.prototype.freemem=function(){for(var Me;(Me=this.fb.pop())!==void 0;)Pa(Me)},M.prototype.free=function(){this.freemem();var Me=mi(this.La)===0;return delete this.db.Za[this.La],this.La=0,Me},X.prototype.next=function(){if(this.Ya===null)return{done:!0};if(this.Ua!==null&&(this.Ua.free(),this.Ua=null),!this.db.db)throw this.gb(),Error("Database closed");var Me=Da(),it=hr(4);re(He),re(it);try{this.db.handleError(Bs(this.db.db,this.eb,-1,He,it)),this.eb=Ce(it,"i32");var Dt=Ce(He,"i32");return Dt===0?(this.gb(),{done:!0}):(this.Ua=new M(Dt,this.db),this.db.Za[Dt]=this.Ua,{value:this.Ua,done:!1})}catch(Bt){throw this.ib=Ve(this.eb),this.gb(),Bt}finally{ma(Me)}},X.prototype.gb=function(){Pa(this.Ya),this.Ya=null},X.prototype.getRemainingSQL=function(){return this.ib!==null?this.ib:Ve(this.eb)},typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"&&(X.prototype[Symbol.iterator]=function(){return this}),ce.prototype.run=function(Me,it){if(!this.db)throw"Database closed";if(it){Me=this.prepare(Me,it);try{Me.step()}finally{Me.free()}}else this.handleError(Vt(this.db,Me,0,0,He));return this},ce.prototype.exec=function(Me,it,Dt){if(!this.db)throw"Database closed";var Bt=Da(),Xt=null;try{var Tn=ci(Me),Xr=hr(4);for(Me=[];Ce(Tn,"i8")!==0;){re(He),re(Xr),this.handleError(Bs(this.db,Tn,-1,He,Xr));var Ir=Ce(He,"i32");if(Tn=Ce(Xr,"i32"),Ir!==0){var Rr=null;for(Xt=new M(Ir,this),it!=null&&Xt.bind(it);Xt.step();)Rr===null&&(Rr={columns:Xt.getColumnNames(),values:[]},Me.push(Rr)),Rr.values.push(Xt.get(null,Dt));Xt.free()}}return Me}catch(Dr){throw Xt&&Xt.free(),Dr}finally{ma(Bt)}},ce.prototype.each=function(Me,it,Dt,Bt,Xt){typeof it=="function"&&(Bt=Dt,Dt=it,it=void 0),Me=this.prepare(Me,it);try{for(;Me.step();)Dt(Me.getAsObject(null,Xt))}finally{Me.free()}if(typeof Bt=="function")return Bt()},ce.prototype.prepare=function(Me,it){if(re(He),this.handleError(Bn(this.db,Me,-1,He,0)),Me=Ce(He,"i32"),Me===0)throw"Nothing to prepare";var Dt=new M(Me,this);return it!=null&&Dt.bind(it),this.Za[Me]=Dt},ce.prototype.iterateStatements=function(Me){return new X(Me,this)},ce.prototype.export=function(){Object.values(this.Za).forEach(function(it){it.free()}),Object.values(this.Na).forEach(Na),this.Na={},this.handleError(fn(this.db));var Me=Ls(this.filename);return this.handleError(Mt(this.filename,He)),this.db=Ce(He,"i32"),bi(this.db),Me},ce.prototype.close=function(){this.db!==null&&(Object.values(this.Za).forEach(function(Me){Me.free()}),Object.values(this.Na).forEach(Na),this.Na={},this.handleError(fn(this.db)),xn("/"+this.filename),this.db=null)},ce.prototype.handleError=function(Me){if(Me===0)return null;throw Me=to(this.db),Error(Me)},ce.prototype.getRowsModified=function(){return Yn(this.db)},ce.prototype.create_function=function(Me,it){Object.prototype.hasOwnProperty.call(this.Na,Me)&&(Na(this.Na[Me]),delete this.Na[Me]);var Dt=Gn(function(Bt,Xt,Tn){Xt=x(Xt,Tn);try{var Xr=it.apply(null,Xt)}catch(Ir){ws(Bt,Ir,-1);return}v(Bt,Xr)},"viii");return this.Na[Me]=Dt,this.handleError(qa(this.db,Me,it.length,1,0,Dt,0,0,0)),this},ce.prototype.create_aggregate=function(Me,it){var Dt=it.init||function(){return null},Bt=it.finalize||function(Rr){return Rr},Xt=it.step;if(!Xt)throw"An aggregate function must have a step function in "+Me;var Tn={};Object.hasOwnProperty.call(this.Na,Me)&&(Na(this.Na[Me]),delete this.Na[Me]),it=Me+"__finalize",Object.hasOwnProperty.call(this.Na,it)&&(Na(this.Na[it]),delete this.Na[it]);var Xr=Gn(function(Rr,Dr,os){var ya=oo(Rr,1);Object.hasOwnProperty.call(Tn,ya)||(Tn[ya]=Dt()),Dr=x(Dr,os),Dr=[Tn[ya]].concat(Dr);try{Tn[ya]=Xt.apply(null,Dr)}catch(Wr){delete Tn[ya],ws(Rr,Wr,-1)}},"viii"),Ir=Gn(function(Rr){var Dr=oo(Rr,1);try{var os=Bt(Tn[Dr])}catch(ya){delete Tn[Dr],ws(Rr,ya,-1);return}v(Rr,os),delete Tn[Dr]},"vi");return this.Na[Me]=Xr,this.Na[it]=Ir,this.handleError(qa(this.db,Me,Xt.length-1,1,0,0,Xr,Ir,0)),this},m.Database=ce};var _=Object.assign({},m),E="./this.program",N=typeof window=="object",S=typeof importScripts=="function",I=typeof process=="object"&&typeof process.versions=="object"&&typeof process.versions.node=="string",A="",k,R,P;if(I){var q=Uh,G=Uh;A=S?G.dirname(A)+"/":__dirname+"/",k=(v,x)=>(v=de(v)?new URL(v):G.normalize(v),q.readFileSync(v,x?void 0:"utf8")),P=v=>(v=k(v,!0),v.buffer||(v=new Uint8Array(v)),v),R=(v,x,M,X=!0)=>{v=de(v)?new URL(v):G.normalize(v),q.readFile(v,X?void 0:"utf8",(ce,He)=>{ce?M(ce):x(X?He.buffer:He)})},!m.thisProgram&&1<process.argv.length&&(E=process.argv[1].replace(/\\/g,"/")),process.argv.slice(2),n.exports=m,m.inspect=()=>"[Emscripten Module object]"}else(N||S)&&(S?A=self.location.href:typeof document<"u"&&document.currentScript&&(A=document.currentScript.src),A=A.indexOf("blob:")!==0?A.substr(0,A.replace(/[?#].*/,"").lastIndexOf("/")+1):"",k=v=>{var x=new XMLHttpRequest;return x.open("GET",v,!1),x.send(null),x.responseText},S&&(P=v=>{var x=new XMLHttpRequest;return x.open("GET",v,!1),x.responseType="arraybuffer",x.send(null),new Uint8Array(x.response)}),R=(v,x,M)=>{var X=new XMLHttpRequest;X.open("GET",v,!0),X.responseType="arraybuffer",X.onload=()=>{X.status==200||X.status==0&&X.response?x(X.response):M()},X.onerror=M,X.send(null)});var Y=m.print||console.log.bind(console),W=m.printErr||console.error.bind(console);Object.assign(m,_),_=null,m.thisProgram&&(E=m.thisProgram);var H;m.wasmBinary&&(H=m.wasmBinary),typeof WebAssembly!="object"&&se("no native wasm support detected");var L,U=!1,Q,le,F,te,j,he,J;function Z(){var v=L.buffer;m.HEAP8=Q=new Int8Array(v),m.HEAP16=F=new Int16Array(v),m.HEAPU8=le=new Uint8Array(v),m.HEAPU16=new Uint16Array(v),m.HEAP32=te=new Int32Array(v),m.HEAPU32=j=new Uint32Array(v),m.HEAPF32=he=new Float32Array(v),m.HEAPF64=J=new Float64Array(v)}var De=[],ve=[],Be=[];function T(){var v=m.preRun.shift();De.unshift(v)}var z=0,ne=null;function se(v){var x;throw(x=m.onAbort)==null||x.call(m,v),v="Aborted("+v+")",W(v),U=!0,new WebAssembly.RuntimeError(v+". Build with -sASSERTIONS for more info.")}var ue=v=>v.startsWith("data:application/octet-stream;base64,"),de=v=>v.startsWith("file://"),oe;if(oe="sql-wasm.wasm",!ue(oe)){var ye=oe;oe=m.locateFile?m.locateFile(ye,A):A+ye}function ie(v){if(v==oe&&H)return new Uint8Array(H);if(P)return P(v);throw"both async and sync fetching of the wasm failed"}function We(v){if(!H&&(N||S)){if(typeof fetch=="function"&&!de(v))return fetch(v,{credentials:"same-origin"}).then(x=>{if(!x.ok)throw"failed to load wasm binary file at '"+v+"'";return x.arrayBuffer()}).catch(()=>ie(v));if(R)return new Promise((x,M)=>{R(v,X=>x(new Uint8Array(X)),M)})}return Promise.resolve().then(()=>ie(v))}function ot(v,x,M){return We(v).then(X=>WebAssembly.instantiate(X,x)).then(X=>X).then(M,X=>{W(`failed to asynchronously prepare wasm: ${X}`),se(X)})}function ft(v,x){var M=oe;H||typeof WebAssembly.instantiateStreaming!="function"||ue(M)||de(M)||I||typeof fetch!="function"?ot(M,v,x):fetch(M,{credentials:"same-origin"}).then(X=>WebAssembly.instantiateStreaming(X,v).then(x,function(ce){return W(`wasm streaming compile failed: ${ce}`),W("falling back to ArrayBuffer instantiation"),ot(M,v,x)}))}var $e,C,Ne=v=>{for(;0<v.length;)v.shift()(m)};function Ce(v,x="i8"){switch(x.endsWith("*")&&(x="*"),x){case"i1":return Q[v>>0];case"i8":return Q[v>>0];case"i16":return F[v>>1];case"i32":return te[v>>2];case"i64":se("to do getValue(i64) use WASM_BIGINT");case"float":return he[v>>2];case"double":return J[v>>3];case"*":return j[v>>2];default:se(`invalid type for getValue: ${x}`)}}function re(v){var x="i32";switch(x.endsWith("*")&&(x="*"),x){case"i1":Q[v>>0]=0;break;case"i8":Q[v>>0]=0;break;case"i16":F[v>>1]=0;break;case"i32":te[v>>2]=0;break;case"i64":se("to do setValue(i64) use WASM_BIGINT");case"float":he[v>>2]=0;break;case"double":J[v>>3]=0;break;case"*":j[v>>2]=0;break;default:se(`invalid type for setValue: ${x}`)}}var ee=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0,me=(v,x,M)=>{var X=x+M;for(M=x;v[M]&&!(M>=X);)++M;if(16<M-x&&v.buffer&&ee)return ee.decode(v.subarray(x,M));for(X="";x<M;){var ce=v[x++];if(ce&128){var He=v[x++]&63;if((ce&224)==192)X+=String.fromCharCode((ce&31)<<6|He);else{var Je=v[x++]&63;ce=(ce&240)==224?(ce&15)<<12|He<<6|Je:(ce&7)<<18|He<<12|Je<<6|v[x++]&63,65536>ce?X+=String.fromCharCode(ce):(ce-=65536,X+=String.fromCharCode(55296|ce>>10,56320|ce&1023))}}else X+=String.fromCharCode(ce)}return X},Ve=(v,x)=>v?me(le,v,x):"",Ye=(v,x)=>{for(var M=0,X=v.length-1;0<=X;X--){var ce=v[X];ce==="."?v.splice(X,1):ce===".."?(v.splice(X,1),M++):M&&(v.splice(X,1),M--)}if(x)for(;M;M--)v.unshift("..");return v},be=v=>{var x=v.charAt(0)==="/",M=v.substr(-1)==="/";return(v=Ye(v.split("/").filter(X=>!!X),!x).join("/"))||x||(v="."),v&&M&&(v+="/"),(x?"/":"")+v},Ze=v=>{var x=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/.exec(v).slice(1);return v=x[0],x=x[1],!v&&!x?".":(x&&(x=x.substr(0,x.length-1)),v+x)},at=v=>{if(v==="/")return"/";v=be(v),v=v.replace(/\/$/,"");var x=v.lastIndexOf("/");return x===-1?v:v.substr(x+1)},Ue=()=>{if(typeof crypto=="object"&&typeof crypto.getRandomValues=="function")return M=>crypto.getRandomValues(M);if(I)try{var v=Uh;if(v.randomFillSync)return M=>v.randomFillSync(M);var x=v.randomBytes;return M=>(M.set(x(M.byteLength)),M)}catch{}se("initRandomDevice")},_t=v=>(_t=Ue())(v);function It(){for(var v="",x=!1,M=arguments.length-1;-1<=M&&!x;M--){if(x=0<=M?arguments[M]:"/",typeof x!="string")throw new TypeError("Arguments to path.resolve must be strings");if(!x)return"";v=x+"/"+v,x=x.charAt(0)==="/"}return v=Ye(v.split("/").filter(X=>!!X),!x).join("/"),(x?"/":"")+v||"."}var Nt=[],on=v=>{for(var x=0,M=0;M<v.length;++M){var X=v.charCodeAt(M);127>=X?x++:2047>=X?x+=2:55296<=X&&57343>=X?(x+=4,++M):x+=3}return x},Zt=(v,x,M,X)=>{if(!(0<X))return 0;var ce=M;X=M+X-1;for(var He=0;He<v.length;++He){var Je=v.charCodeAt(He);if(55296<=Je&&57343>=Je){var Mt=v.charCodeAt(++He);Je=65536+((Je&1023)<<10)|Mt&1023}if(127>=Je){if(M>=X)break;x[M++]=Je}else{if(2047>=Je){if(M+1>=X)break;x[M++]=192|Je>>6}else{if(65535>=Je){if(M+2>=X)break;x[M++]=224|Je>>12}else{if(M+3>=X)break;x[M++]=240|Je>>18,x[M++]=128|Je>>12&63}x[M++]=128|Je>>6&63}x[M++]=128|Je&63}}return x[M]=0,M-ce};function cn(v,x){var M=Array(on(v)+1);return v=Zt(v,M,0,M.length),x&&(M.length=v),M}var bn=[];function zt(v,x){bn[v]={input:[],output:[],Xa:x},Fr(v,Ht)}var Ht={open(v){var x=bn[v.node.rdev];if(!x)throw new mt(43);v.tty=x,v.seekable=!1},close(v){v.tty.Xa.fsync(v.tty)},fsync(v){v.tty.Xa.fsync(v.tty)},read(v,x,M,X){if(!v.tty||!v.tty.Xa.sb)throw new mt(60);for(var ce=0,He=0;He<X;He++){try{var Je=v.tty.Xa.sb(v.tty)}catch{throw new mt(29)}if(Je===void 0&&ce===0)throw new mt(6);if(Je==null)break;ce++,x[M+He]=Je}return ce&&(v.node.timestamp=Date.now()),ce},write(v,x,M,X){if(!v.tty||!v.tty.Xa.jb)throw new mt(60);try{for(var ce=0;ce<X;ce++)v.tty.Xa.jb(v.tty,x[M+ce])}catch{throw new mt(29)}return X&&(v.node.timestamp=Date.now()),ce}},yt={sb(){e:{if(!Nt.length){var v=null;if(I){var x=Buffer.alloc(256),M=0,X=process.stdin.fd;try{M=q.readSync(X,x)}catch(ce){if(ce.toString().includes("EOF"))M=0;else throw ce}0<M?v=x.slice(0,M).toString("utf-8"):v=null}else typeof window<"u"&&typeof window.prompt=="function"?(v=window.prompt("Input: "),v!==null&&(v+=`
`)):typeof readline=="function"&&(v=readline(),v!==null&&(v+=`
`));if(!v){v=null;break e}Nt=cn(v,!0)}v=Nt.shift()}return v},jb(v,x){x===null||x===10?(Y(me(v.output,0)),v.output=[]):x!=0&&v.output.push(x)},fsync(v){v.output&&0<v.output.length&&(Y(me(v.output,0)),v.output=[])},Mb(){return{Ib:25856,Kb:5,Hb:191,Jb:35387,Gb:[3,28,127,21,4,0,1,0,17,19,26,0,18,15,23,22,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]}},Nb(){return 0},Ob(){return[24,80]}},tn={jb(v,x){x===null||x===10?(W(me(v.output,0)),v.output=[]):x!=0&&v.output.push(x)},fsync(v){v.output&&0<v.output.length&&(W(me(v.output,0)),v.output=[])}};function or(v,x){var M=v.Ia?v.Ia.length:0;M>=x||(x=Math.max(x,M*(1048576>M?2:1.125)>>>0),M!=0&&(x=Math.max(x,256)),M=v.Ia,v.Ia=new Uint8Array(x),0<v.Ma&&v.Ia.set(M.subarray(0,v.Ma),0))}var At={Qa:null,Ra(){return At.createNode(null,"/",16895,0)},createNode(v,x,M,X){if((M&61440)===24576||(M&61440)===4096)throw new mt(63);return At.Qa||(At.Qa={dir:{node:{Pa:At.Ga.Pa,Oa:At.Ga.Oa,lookup:At.Ga.lookup,ab:At.Ga.ab,rename:At.Ga.rename,unlink:At.Ga.unlink,rmdir:At.Ga.rmdir,readdir:At.Ga.readdir,symlink:At.Ga.symlink},stream:{Ta:At.Ha.Ta}},file:{node:{Pa:At.Ga.Pa,Oa:At.Ga.Oa},stream:{Ta:At.Ha.Ta,read:At.Ha.read,write:At.Ha.write,lb:At.Ha.lb,bb:At.Ha.bb,cb:At.Ha.cb}},link:{node:{Pa:At.Ga.Pa,Oa:At.Ga.Oa,readlink:At.Ga.readlink},stream:{}},pb:{node:{Pa:At.Ga.Pa,Oa:At.Ga.Oa},stream:ms}}),M=Cr(v,x,M,X),Vn(M.mode)?(M.Ga=At.Qa.dir.node,M.Ha=At.Qa.dir.stream,M.Ia={}):(M.mode&61440)===32768?(M.Ga=At.Qa.file.node,M.Ha=At.Qa.file.stream,M.Ma=0,M.Ia=null):(M.mode&61440)===40960?(M.Ga=At.Qa.link.node,M.Ha=At.Qa.link.stream):(M.mode&61440)===8192&&(M.Ga=At.Qa.pb.node,M.Ha=At.Qa.pb.stream),M.timestamp=Date.now(),v&&(v.Ia[x]=M,v.timestamp=M.timestamp),M},Lb(v){return v.Ia?v.Ia.subarray?v.Ia.subarray(0,v.Ma):new Uint8Array(v.Ia):new Uint8Array(0)},Ga:{Pa(v){var x={};return x.dev=(v.mode&61440)===8192?v.id:1,x.ino=v.id,x.mode=v.mode,x.nlink=1,x.uid=0,x.gid=0,x.rdev=v.rdev,Vn(v.mode)?x.size=4096:(v.mode&61440)===32768?x.size=v.Ma:(v.mode&61440)===40960?x.size=v.link.length:x.size=0,x.atime=new Date(v.timestamp),x.mtime=new Date(v.timestamp),x.ctime=new Date(v.timestamp),x.zb=4096,x.blocks=Math.ceil(x.size/x.zb),x},Oa(v,x){if(x.mode!==void 0&&(v.mode=x.mode),x.timestamp!==void 0&&(v.timestamp=x.timestamp),x.size!==void 0&&(x=x.size,v.Ma!=x))if(x==0)v.Ia=null,v.Ma=0;else{var M=v.Ia;v.Ia=new Uint8Array(x),M&&v.Ia.set(M.subarray(0,Math.min(x,v.Ma))),v.Ma=x}},lookup(){throw Vr[44]},ab(v,x,M,X){return At.createNode(v,x,M,X)},rename(v,x,M){if(Vn(v.mode)){try{var X=Dn(x,M)}catch{}if(X)for(var ce in X.Ia)throw new mt(55)}delete v.parent.Ia[v.name],v.parent.timestamp=Date.now(),v.name=M,x.Ia[M]=v,x.timestamp=v.parent.timestamp,v.parent=x},unlink(v,x){delete v.Ia[x],v.timestamp=Date.now()},rmdir(v,x){var M=Dn(v,x),X;for(X in M.Ia)throw new mt(55);delete v.Ia[x],v.timestamp=Date.now()},readdir(v){var x=[".",".."],M;for(M of Object.keys(v.Ia))x.push(M);return x},symlink(v,x,M){return v=At.createNode(v,x,41471,0),v.link=M,v},readlink(v){if((v.mode&61440)!==40960)throw new mt(28);return v.link}},Ha:{read(v,x,M,X,ce){var He=v.node.Ia;if(ce>=v.node.Ma)return 0;if(v=Math.min(v.node.Ma-ce,X),8<v&&He.subarray)x.set(He.subarray(ce,ce+v),M);else for(X=0;X<v;X++)x[M+X]=He[ce+X];return v},write(v,x,M,X,ce,He){if(x.buffer===Q.buffer&&(He=!1),!X)return 0;if(v=v.node,v.timestamp=Date.now(),x.subarray&&(!v.Ia||v.Ia.subarray)){if(He)return v.Ia=x.subarray(M,M+X),v.Ma=X;if(v.Ma===0&&ce===0)return v.Ia=x.slice(M,M+X),v.Ma=X;if(ce+X<=v.Ma)return v.Ia.set(x.subarray(M,M+X),ce),X}if(or(v,ce+X),v.Ia.subarray&&x.subarray)v.Ia.set(x.subarray(M,M+X),ce);else for(He=0;He<X;He++)v.Ia[ce+He]=x[M+He];return v.Ma=Math.max(v.Ma,ce+X),X},Ta(v,x,M){if(M===1?x+=v.position:M===2&&(v.node.mode&61440)===32768&&(x+=v.node.Ma),0>x)throw new mt(28);return x},lb(v,x,M){or(v.node,x+M),v.node.Ma=Math.max(v.node.Ma,x+M)},bb(v,x,M,X,ce){if((v.node.mode&61440)!==32768)throw new mt(43);if(v=v.node.Ia,ce&2||v.buffer!==Q.buffer){if((0<M||M+x<v.length)&&(v.subarray?v=v.subarray(M,M+x):v=Array.prototype.slice.call(v,M,M+x)),M=!0,x=65536*Math.ceil(x/65536),(ce=rr(65536,x))?(le.fill(0,ce,ce+x),x=ce):x=0,!x)throw new mt(48);Q.set(v,x)}else M=!1,x=v.byteOffset;return{Db:x,ub:M}},cb(v,x,M,X){return At.Ha.write(v,x,0,X,M,!1),0}}},gt=(v,x)=>{var M=0;return v&&(M|=365),x&&(M|=146),M},jr=null,An={},qn=[],vr=1,Tr=null,ka=!0,mt=null,Vr={};function zn(v,x={}){if(v=It(v),!v)return{path:"",node:null};if(x=Object.assign({qb:!0,kb:0},x),8<x.kb)throw new mt(32);v=v.split("/").filter(Je=>!!Je);for(var M=jr,X="/",ce=0;ce<v.length;ce++){var He=ce===v.length-1;if(He&&x.parent)break;if(M=Dn(M,v[ce]),X=be(X+"/"+v[ce]),M.Va&&(!He||He&&x.qb)&&(M=M.Va.root),!He||x.Sa){for(He=0;(M.mode&61440)===40960;)if(M=Rn(X),X=It(Ze(X),M),M=zn(X,{kb:x.kb+1}).node,40<He++)throw new mt(32)}}return{path:X,node:M}}function Lr(v){for(var x;;){if(v===v.parent)return v=v.Ra.tb,x?v[v.length-1]!=="/"?`${v}/${x}`:v+x:v;x=x?`${v.name}/${x}`:v.name,v=v.parent}}function Aa(v,x){for(var M=0,X=0;X<x.length;X++)M=(M<<5)-M+x.charCodeAt(X)|0;return(v+M>>>0)%Tr.length}function En(v){var x=Aa(v.parent.id,v.name);if(Tr[x]===v)Tr[x]=v.Wa;else for(x=Tr[x];x;){if(x.Wa===v){x.Wa=v.Wa;break}x=x.Wa}}function Dn(v,x){var M;if(M=(M=zr(v,"x"))?M:v.Ga.lookup?0:2)throw new mt(M,v);for(M=Tr[Aa(v.id,x)];M;M=M.Wa){var X=M.name;if(M.parent.id===v.id&&X===x)return M}return v.Ga.lookup(v,x)}function Cr(v,x,M,X){return v=new xr(v,x,M,X),x=Aa(v.parent.id,v.name),v.Wa=Tr[x],Tr[x]=v}function Vn(v){return(v&61440)===16384}function da(v){var x=["r","w","rw"][v&3];return v&512&&(x+="w"),x}function zr(v,x){if(ka)return 0;if(!x.includes("r")||v.mode&292){if(x.includes("w")&&!(v.mode&146)||x.includes("x")&&!(v.mode&73))return 2}else return 2;return 0}function Ms(v,x){try{return Dn(v,x),20}catch{}return zr(v,"wx")}function nr(v,x,M){try{var X=Dn(v,x)}catch(ce){return ce.Ka}if(v=zr(v,"wx"))return v;if(M){if(!Vn(X.mode))return 54;if(X===X.parent||Lr(X)==="/")return 10}else if(Vn(X.mode))return 31;return 0}function gn(){for(var v=0;4096>=v;v++)if(!qn[v])return v;throw new mt(33)}function nn(v){if(v=qn[v],!v)throw new mt(8);return v}function Br(v,x=-1){return Zr||(Zr=function(){this.$a={}},Zr.prototype={},Object.defineProperties(Zr.prototype,{object:{get(){return this.node},set(M){this.node=M}},flags:{get(){return this.$a.flags},set(M){this.$a.flags=M}},position:{get(){return this.$a.position},set(M){this.$a.position=M}}})),v=Object.assign(new Zr,v),x==-1&&(x=gn()),v.fd=x,qn[x]=v}var ms={open(v){var x,M;v.Ha=An[v.node.rdev].Ha,(M=(x=v.Ha).open)==null||M.call(x,v)},Ta(){throw new mt(70)}};function Fr(v,x){An[v]={Ha:x}}function Us(v,x){var M=x==="/",X=!x;if(M&&jr)throw new mt(10);if(!M&&!X){var ce=zn(x,{qb:!1});if(x=ce.path,ce=ce.node,ce.Va)throw new mt(10);if(!Vn(ce.mode))throw new mt(54)}x={type:v,Pb:{},tb:x,Cb:[]},v=v.Ra(x),v.Ra=x,x.root=v,M?jr=v:ce&&(ce.Va=x,ce.Ra&&ce.Ra.Cb.push(x))}function St(v,x,M){var X=zn(v,{parent:!0}).node;if(v=at(v),!v||v==="."||v==="..")throw new mt(28);var ce=Ms(X,v);if(ce)throw new mt(ce);if(!X.Ga.ab)throw new mt(63);return X.Ga.ab(X,v,x,M)}function _e(v,x){return St(v,(x!==void 0?x:511)&1023|16384,0)}function st(v,x,M){typeof M>"u"&&(M=x,x=438),St(v,x|8192,M)}function ut(v,x){if(!It(v))throw new mt(44);var M=zn(x,{parent:!0}).node;if(!M)throw new mt(44);x=at(x);var X=Ms(M,x);if(X)throw new mt(X);if(!M.Ga.symlink)throw new mt(63);M.Ga.symlink(M,x,v)}function Rt(v){var x=zn(v,{parent:!0}).node;v=at(v);var M=Dn(x,v),X=nr(x,v,!0);if(X)throw new mt(X);if(!x.Ga.rmdir)throw new mt(63);if(M.Va)throw new mt(10);x.Ga.rmdir(x,v),En(M)}function xn(v){var x=zn(v,{parent:!0}).node;if(!x)throw new mt(44);v=at(v);var M=Dn(x,v),X=nr(x,v,!1);if(X)throw new mt(X);if(!x.Ga.unlink)throw new mt(63);if(M.Va)throw new mt(10);x.Ga.unlink(x,v),En(M)}function Rn(v){if(v=zn(v).node,!v)throw new mt(44);if(!v.Ga.readlink)throw new mt(28);return It(Lr(v.parent),v.Ga.readlink(v))}function $t(v,x){if(v=zn(v,{Sa:!x}).node,!v)throw new mt(44);if(!v.Ga.Pa)throw new mt(63);return v.Ga.Pa(v)}function Zn(v){return $t(v,!0)}function Hr(v,x){if(v=typeof v=="string"?zn(v,{Sa:!0}).node:v,!v.Ga.Oa)throw new mt(63);v.Ga.Oa(v,{mode:x&4095|v.mode&-4096,timestamp:Date.now()})}function Mn(v,x){if(0>x)throw new mt(28);if(v=typeof v=="string"?zn(v,{Sa:!0}).node:v,!v.Ga.Oa)throw new mt(63);if(Vn(v.mode))throw new mt(31);if((v.mode&61440)!==32768)throw new mt(28);var M=zr(v,"w");if(M)throw new mt(M);v.Ga.Oa(v,{size:x,timestamp:Date.now()})}function Xn(v,x,M){if(v==="")throw new mt(44);if(typeof x=="string"){var X={r:0,"r+":2,w:577,"w+":578,a:1089,"a+":1090}[x];if(typeof X>"u")throw Error(`Unknown file open mode: ${x}`);x=X}if(M=x&64?(typeof M>"u"?438:M)&4095|32768:0,typeof v=="object")var ce=v;else{v=be(v);try{ce=zn(v,{Sa:!(x&131072)}).node}catch{}}if(X=!1,x&64)if(ce){if(x&128)throw new mt(20)}else ce=St(v,M,0),X=!0;if(!ce)throw new mt(44);if((ce.mode&61440)===8192&&(x&=-513),x&65536&&!Vn(ce.mode))throw new mt(54);if(!X&&(M=ce?(ce.mode&61440)===40960?32:Vn(ce.mode)&&(da(x)!=="r"||x&512)?31:zr(ce,da(x)):44))throw new mt(M);return x&512&&!X&&Mn(ce,0),x&=-131713,ce=Br({node:ce,path:Lr(ce),flags:x,seekable:!0,position:0,Ha:ce.Ha,Fb:[],error:!1}),ce.Ha.open&&ce.Ha.open(ce),!m.logReadFiles||x&1||(vs||(vs={}),v in vs||(vs[v]=1)),ce}function es(v){if(v.fd===null)throw new mt(8);v.hb&&(v.hb=null);try{v.Ha.close&&v.Ha.close(v)}catch(x){throw x}finally{qn[v.fd]=null}v.fd=null}function gs(v,x,M){if(v.fd===null)throw new mt(8);if(!v.seekable||!v.Ha.Ta)throw new mt(70);if(M!=0&&M!=1&&M!=2)throw new mt(28);v.position=v.Ha.Ta(v,x,M),v.Fb=[]}function ii(v,x,M,X,ce){if(0>X||0>ce)throw new mt(28);if(v.fd===null)throw new mt(8);if((v.flags&2097155)===1)throw new mt(8);if(Vn(v.node.mode))throw new mt(31);if(!v.Ha.read)throw new mt(28);var He=typeof ce<"u";if(!He)ce=v.position;else if(!v.seekable)throw new mt(70);return x=v.Ha.read(v,x,M,X,ce),He||(v.position+=x),x}function dn(v,x,M,X,ce){if(0>X||0>ce)throw new mt(28);if(v.fd===null)throw new mt(8);if((v.flags&2097155)===0)throw new mt(8);if(Vn(v.node.mode))throw new mt(31);if(!v.Ha.write)throw new mt(28);v.seekable&&v.flags&1024&&gs(v,0,2);var He=typeof ce<"u";if(!He)ce=v.position;else if(!v.seekable)throw new mt(70);return x=v.Ha.write(v,x,M,X,ce,void 0),He||(v.position+=x),x}function Ls(v){var x,M=Xn(v,M||0);v=$t(v).size;var X=new Uint8Array(v);return ii(M,X,0,v,0),x=X,es(M),x}function ys(){mt||(mt=function(v,x){this.name="ErrnoError",this.node=x,this.Eb=function(M){this.Ka=M},this.Eb(v),this.message="FS error"},mt.prototype=Error(),mt.prototype.constructor=mt,[44].forEach(v=>{Vr[v]=new mt(v),Vr[v].stack="<generic error, no stack>"}))}var aa;function Qt(v,x,M){v=be("/dev/"+v);var X=gt(!!x,!!M);ts||(ts=64);var ce=ts++<<8|0;Fr(ce,{open(He){He.seekable=!1},close(){var He;(He=M==null?void 0:M.buffer)!=null&&He.length&&M(10)},read(He,Je,Mt,fn){for(var Vt=0,Yn=0;Yn<fn;Yn++){try{var Bn=x()}catch{throw new mt(29)}if(Bn===void 0&&Vt===0)throw new mt(6);if(Bn==null)break;Vt++,Je[Mt+Yn]=Bn}return Vt&&(He.node.timestamp=Date.now()),Vt},write(He,Je,Mt,fn){for(var Vt=0;Vt<fn;Vt++)try{M(Je[Mt+Vt])}catch{throw new mt(29)}return fn&&(He.node.timestamp=Date.now()),Vt}}),st(v,X,ce)}var ts,kn={},Zr,vs;function Qr(v,x,M){if(x.charAt(0)==="/")return x;if(v=v===-100?"/":nn(v).path,x.length==0){if(!M)throw new mt(44);return v}return be(v+"/"+x)}function ns(v,x,M){try{var X=v(x)}catch(He){if(He&&He.node&&be(x)!==be(Lr(He.node)))return-54;throw He}te[M>>2]=X.dev,te[M+4>>2]=X.mode,j[M+8>>2]=X.nlink,te[M+12>>2]=X.uid,te[M+16>>2]=X.gid,te[M+20>>2]=X.rdev,C=[X.size>>>0,($e=X.size,1<=+Math.abs($e)?0<$e?+Math.floor($e/4294967296)>>>0:~~+Math.ceil(($e-+(~~$e>>>0))/4294967296)>>>0:0)],te[M+24>>2]=C[0],te[M+28>>2]=C[1],te[M+32>>2]=4096,te[M+36>>2]=X.blocks,v=X.atime.getTime(),x=X.mtime.getTime();var ce=X.ctime.getTime();return C=[Math.floor(v/1e3)>>>0,($e=Math.floor(v/1e3),1<=+Math.abs($e)?0<$e?+Math.floor($e/4294967296)>>>0:~~+Math.ceil(($e-+(~~$e>>>0))/4294967296)>>>0:0)],te[M+40>>2]=C[0],te[M+44>>2]=C[1],j[M+48>>2]=v%1e3*1e3,C=[Math.floor(x/1e3)>>>0,($e=Math.floor(x/1e3),1<=+Math.abs($e)?0<$e?+Math.floor($e/4294967296)>>>0:~~+Math.ceil(($e-+(~~$e>>>0))/4294967296)>>>0:0)],te[M+56>>2]=C[0],te[M+60>>2]=C[1],j[M+64>>2]=x%1e3*1e3,C=[Math.floor(ce/1e3)>>>0,($e=Math.floor(ce/1e3),1<=+Math.abs($e)?0<$e?+Math.floor($e/4294967296)>>>0:~~+Math.ceil(($e-+(~~$e>>>0))/4294967296)>>>0:0)],te[M+72>>2]=C[0],te[M+76>>2]=C[1],j[M+80>>2]=ce%1e3*1e3,C=[X.ino>>>0,($e=X.ino,1<=+Math.abs($e)?0<$e?+Math.floor($e/4294967296)>>>0:~~+Math.ceil(($e-+(~~$e>>>0))/4294967296)>>>0:0)],te[M+88>>2]=C[0],te[M+92>>2]=C[1],0}var br=void 0;function Ta(){var v=te[+br>>2];return br+=4,v}var rs=(v,x)=>x+2097152>>>0<4194305-!!v?(v>>>0)+4294967296*x:NaN,sa=[0,31,60,91,121,152,182,213,244,274,305,335],fa=[0,31,59,90,120,151,181,212,243,273,304,334],oi=v=>{var x=on(v)+1,M=Jr(x);return M&&Zt(v,le,M,x),M},li={},rn=()=>{if(!zs){var v={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:(typeof navigator=="object"&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8",_:E||"./this.program"},x;for(x in li)li[x]===void 0?delete v[x]:v[x]=li[x];var M=[];for(x in v)M.push(`${x}=${v[x]}`);zs=M}return zs},zs,ci=v=>{var x=on(v)+1,M=hr(x);return Zt(v,le,M,x),M},Oo=(v,x,M,X)=>{var ce={string:Vt=>{var Yn=0;return Vt!=null&&Vt!==0&&(Yn=ci(Vt)),Yn},array:Vt=>{var Yn=hr(Vt.length);return Q.set(Vt,Yn),Yn}};v=m["_"+v];var He=[],Je=0;if(X)for(var Mt=0;Mt<X.length;Mt++){var fn=ce[M[Mt]];fn?(Je===0&&(Je=Da()),He[Mt]=fn(X[Mt])):He[Mt]=X[Mt]}return M=v.apply(null,He),M=(function(Vt){return Je!==0&&ma(Je),x==="string"?Vt?me(le,Vt):"":x==="boolean"?!!Vt:Vt})(M)},lr=0,Ca=(v,x)=>(x=x==1?hr(v.length):Jr(v.length),v.subarray||v.slice||(v=new Uint8Array(v)),le.set(v,x),x),ha,Pr=[],cr,Na=v=>{ha.delete(cr.get(v)),cr.set(v,null),Pr.push(v)},Gn=(v,x)=>{if(!ha){ha=new WeakMap;var M=cr.length;if(ha)for(var X=0;X<0+M;X++){var ce=cr.get(X);ce&&ha.set(ce,X)}}if(M=ha.get(v)||0)return M;if(Pr.length)M=Pr.pop();else{try{cr.grow(1)}catch(Mt){throw Mt instanceof RangeError?"Unable to grow wasm table. Set ALLOW_TABLE_GROWTH.":Mt}M=cr.length-1}try{cr.set(M,v)}catch(Mt){if(!(Mt instanceof TypeError))throw Mt;if(typeof WebAssembly.Function=="function"){X=WebAssembly.Function,ce={i:"i32",j:"i64",f:"f32",d:"f64",e:"externref",p:"i32"};for(var He={parameters:[],results:x[0]=="v"?[]:[ce[x[0]]]},Je=1;Je<x.length;++Je)He.parameters.push(ce[x[Je]]);x=new X(He,v)}else{for(X=[1],ce=x.slice(0,1),x=x.slice(1),He={i:127,p:127,j:126,f:125,d:124,e:111},X.push(96),Je=x.length,128>Je?X.push(Je):X.push(Je%128|128,Je>>7),Je=0;Je<x.length;++Je)X.push(He[x[Je]]);ce=="v"?X.push(0):X.push(1,He[ce]),x=[0,97,115,109,1,0,0,0,1],ce=X.length,128>ce?x.push(ce):x.push(ce%128|128,ce>>7),x.push.apply(x,X),x.push(2,7,1,1,101,1,102,0,0,7,5,1,1,102,0,0),x=new WebAssembly.Module(new Uint8Array(x)),x=new WebAssembly.Instance(x,{e:{f:v}}).exports.f}cr.set(M,x)}return ha.set(v,M),M};function xr(v,x,M,X){v||(v=this),this.parent=v,this.Ra=v.Ra,this.Va=null,this.id=vr++,this.name=x,this.mode=M,this.Ga={},this.Ha={},this.rdev=X}Object.defineProperties(xr.prototype,{read:{get:function(){return(this.mode&365)===365},set:function(v){v?this.mode|=365:this.mode&=-366}},write:{get:function(){return(this.mode&146)===146},set:function(v){v?this.mode|=146:this.mode&=-147}}}),ys(),Tr=Array(4096),Us(At,"/"),_e("/tmp"),_e("/home"),_e("/home/web_user"),(function(){_e("/dev"),Fr(259,{read:()=>0,write:(X,ce,He,Je)=>Je}),st("/dev/null",259),zt(1280,yt),zt(1536,tn),st("/dev/tty",1280),st("/dev/tty1",1536);var v=new Uint8Array(1024),x=0,M=()=>(x===0&&(x=_t(v).byteLength),v[--x]);Qt("random",M),Qt("urandom",M),_e("/dev/shm"),_e("/dev/shm/tmp")})(),(function(){_e("/proc");var v=_e("/proc/self");_e("/proc/self/fd"),Us({Ra(){var x=Cr(v,"fd",16895,73);return x.Ga={lookup(M,X){var ce=nn(+X);return M={parent:null,Ra:{tb:"fake"},Ga:{readlink:()=>ce.path}},M.parent=M}},x}},"/proc/self/fd")})();var pa={a:(v,x,M,X)=>{se(`Assertion failed: ${v?me(le,v):""}, at: `+[x?x?me(le,x):"":"unknown filename",M,X?X?me(le,X):"":"unknown function"])},h:function(v,x){try{return v=v?me(le,v):"",Hr(v,x),0}catch(M){if(typeof kn>"u"||M.name!=="ErrnoError")throw M;return-M.Ka}},H:function(v,x,M){try{if(x=x?me(le,x):"",x=Qr(v,x),M&-8)return-28;var X=zn(x,{Sa:!0}).node;return X?(v="",M&4&&(v+="r"),M&2&&(v+="w"),M&1&&(v+="x"),v&&zr(X,v)?-2:0):-44}catch(ce){if(typeof kn>"u"||ce.name!=="ErrnoError")throw ce;return-ce.Ka}},i:function(v,x){try{var M=nn(v);return Hr(M.node,x),0}catch(X){if(typeof kn>"u"||X.name!=="ErrnoError")throw X;return-X.Ka}},g:function(v){try{var x=nn(v).node,M=typeof x=="string"?zn(x,{Sa:!0}).node:x;if(!M.Ga.Oa)throw new mt(63);return M.Ga.Oa(M,{timestamp:Date.now()}),0}catch(X){if(typeof kn>"u"||X.name!=="ErrnoError")throw X;return-X.Ka}},b:function(v,x,M){br=M;try{var X=nn(v);switch(x){case 0:var ce=Ta();if(0>ce)return-28;for(;qn[ce];)ce++;return Br(X,ce).fd;case 1:case 2:return 0;case 3:return X.flags;case 4:return ce=Ta(),X.flags|=ce,0;case 5:return ce=Ta(),F[ce+0>>1]=2,0;case 6:case 7:return 0;case 16:case 8:return-28;case 9:return te[bs()>>2]=28,-1;default:return-28}}catch(He){if(typeof kn>"u"||He.name!=="ErrnoError")throw He;return-He.Ka}},f:function(v,x){try{var M=nn(v);return ns($t,M.path,x)}catch(X){if(typeof kn>"u"||X.name!=="ErrnoError")throw X;return-X.Ka}},n:function(v,x,M){x=rs(x,M);try{if(isNaN(x))return 61;var X=nn(v);if((X.flags&2097155)===0)throw new mt(28);return Mn(X.node,x),0}catch(ce){if(typeof kn>"u"||ce.name!=="ErrnoError")throw ce;return-ce.Ka}},C:function(v,x){try{if(x===0)return-28;var M=on("/")+1;return x<M?-68:(Zt("/",le,v,x),M)}catch(X){if(typeof kn>"u"||X.name!=="ErrnoError")throw X;return-X.Ka}},F:function(v,x){try{return v=v?me(le,v):"",ns(Zn,v,x)}catch(M){if(typeof kn>"u"||M.name!=="ErrnoError")throw M;return-M.Ka}},z:function(v,x,M){try{return x=x?me(le,x):"",x=Qr(v,x),x=be(x),x[x.length-1]==="/"&&(x=x.substr(0,x.length-1)),_e(x,M),0}catch(X){if(typeof kn>"u"||X.name!=="ErrnoError")throw X;return-X.Ka}},E:function(v,x,M,X){try{x=x?me(le,x):"";var ce=X&256;return x=Qr(v,x,X&4096),ns(ce?Zn:$t,x,M)}catch(He){if(typeof kn>"u"||He.name!=="ErrnoError")throw He;return-He.Ka}},y:function(v,x,M,X){br=X;try{x=x?me(le,x):"",x=Qr(v,x);var ce=X?Ta():0;return Xn(x,M,ce).fd}catch(He){if(typeof kn>"u"||He.name!=="ErrnoError")throw He;return-He.Ka}},w:function(v,x,M,X){try{if(x=x?me(le,x):"",x=Qr(v,x),0>=X)return-28;var ce=Rn(x),He=Math.min(X,on(ce)),Je=Q[M+He];return Zt(ce,le,M,X+1),Q[M+He]=Je,He}catch(Mt){if(typeof kn>"u"||Mt.name!=="ErrnoError")throw Mt;return-Mt.Ka}},v:function(v){try{return v=v?me(le,v):"",Rt(v),0}catch(x){if(typeof kn>"u"||x.name!=="ErrnoError")throw x;return-x.Ka}},G:function(v,x){try{return v=v?me(le,v):"",ns($t,v,x)}catch(M){if(typeof kn>"u"||M.name!=="ErrnoError")throw M;return-M.Ka}},r:function(v,x,M){try{return x=x?me(le,x):"",x=Qr(v,x),M===0?xn(x):M===512?Rt(x):se("Invalid flags passed to unlinkat"),0}catch(X){if(typeof kn>"u"||X.name!=="ErrnoError")throw X;return-X.Ka}},q:function(v,x,M){try{if(x=x?me(le,x):"",x=Qr(v,x,!0),M){var X=j[M>>2]+4294967296*te[M+4>>2],ce=te[M+8>>2];He=1e3*X+ce/1e6,M+=16,X=j[M>>2]+4294967296*te[M+4>>2],ce=te[M+8>>2],Je=1e3*X+ce/1e6}else var He=Date.now(),Je=He;v=He;var Mt=zn(x,{Sa:!0}).node;return Mt.Ga.Oa(Mt,{timestamp:Math.max(v,Je)}),0}catch(fn){if(typeof kn>"u"||fn.name!=="ErrnoError")throw fn;return-fn.Ka}},l:function(v,x,M){v=new Date(1e3*rs(v,x)),te[M>>2]=v.getSeconds(),te[M+4>>2]=v.getMinutes(),te[M+8>>2]=v.getHours(),te[M+12>>2]=v.getDate(),te[M+16>>2]=v.getMonth(),te[M+20>>2]=v.getFullYear()-1900,te[M+24>>2]=v.getDay(),x=v.getFullYear(),te[M+28>>2]=(x%4!==0||x%100===0&&x%400!==0?fa:sa)[v.getMonth()]+v.getDate()-1|0,te[M+36>>2]=-(60*v.getTimezoneOffset()),x=new Date(v.getFullYear(),6,1).getTimezoneOffset();var X=new Date(v.getFullYear(),0,1).getTimezoneOffset();te[M+32>>2]=(x!=X&&v.getTimezoneOffset()==Math.min(X,x))|0},j:function(v,x,M,X,ce,He,Je,Mt){ce=rs(ce,He);try{if(isNaN(ce))return 61;var fn=nn(X);if((x&2)!==0&&(M&2)===0&&(fn.flags&2097155)!==2)throw new mt(2);if((fn.flags&2097155)===1)throw new mt(2);if(!fn.Ha.bb)throw new mt(43);var Vt=fn.Ha.bb(fn,v,ce,x,M),Yn=Vt.Db;return te[Je>>2]=Vt.ub,j[Mt>>2]=Yn,0}catch(Bn){if(typeof kn>"u"||Bn.name!=="ErrnoError")throw Bn;return-Bn.Ka}},k:function(v,x,M,X,ce,He,Je){He=rs(He,Je);try{if(isNaN(He))return 61;var Mt=nn(ce);if(M&2){if((Mt.node.mode&61440)!==32768)throw new mt(43);if(!(X&2)){var fn=le.slice(v,v+x);Mt.Ha.cb&&Mt.Ha.cb(Mt,fn,He,x,X)}}}catch(Vt){if(typeof kn>"u"||Vt.name!=="ErrnoError")throw Vt;return-Vt.Ka}},s:(v,x,M)=>{function X(fn){return(fn=fn.toTimeString().match(/\(([A-Za-z ]+)\)$/))?fn[1]:"GMT"}var ce=new Date().getFullYear(),He=new Date(ce,0,1),Je=new Date(ce,6,1);ce=He.getTimezoneOffset();var Mt=Je.getTimezoneOffset();j[v>>2]=60*Math.max(ce,Mt),te[x>>2]=+(ce!=Mt),v=X(He),x=X(Je),v=oi(v),x=oi(x),Mt<ce?(j[M>>2]=v,j[M+4>>2]=x):(j[M>>2]=x,j[M+4>>2]=v)},d:()=>Date.now(),t:()=>2147483648,c:()=>performance.now(),o:v=>{var x=le.length;if(v>>>=0,2147483648<v)return!1;for(var M=1;4>=M;M*=2){var X=x*(1+.2/M);X=Math.min(X,v+100663296);var ce=Math;X=Math.max(v,X);e:{ce=(ce.min.call(ce,2147483648,X+(65536-X%65536)%65536)-L.buffer.byteLength+65535)/65536;try{L.grow(ce),Z();var He=1;break e}catch{}He=void 0}if(He)return!0}return!1},A:(v,x)=>{var M=0;return rn().forEach((X,ce)=>{var He=x+M;for(ce=j[v+4*ce>>2]=He,He=0;He<X.length;++He)Q[ce++>>0]=X.charCodeAt(He);Q[ce>>0]=0,M+=X.length+1}),0},B:(v,x)=>{var M=rn();j[v>>2]=M.length;var X=0;return M.forEach(ce=>X+=ce.length+1),j[x>>2]=X,0},e:function(v){try{var x=nn(v);return es(x),0}catch(M){if(typeof kn>"u"||M.name!=="ErrnoError")throw M;return M.Ka}},p:function(v,x){try{var M=nn(v);return Q[x>>0]=M.tty?2:Vn(M.mode)?3:(M.mode&61440)===40960?7:4,F[x+2>>1]=0,C=[0,($e=0,1<=+Math.abs($e)?0<$e?+Math.floor($e/4294967296)>>>0:~~+Math.ceil(($e-+(~~$e>>>0))/4294967296)>>>0:0)],te[x+8>>2]=C[0],te[x+12>>2]=C[1],C=[0,($e=0,1<=+Math.abs($e)?0<$e?+Math.floor($e/4294967296)>>>0:~~+Math.ceil(($e-+(~~$e>>>0))/4294967296)>>>0:0)],te[x+16>>2]=C[0],te[x+20>>2]=C[1],0}catch(X){if(typeof kn>"u"||X.name!=="ErrnoError")throw X;return X.Ka}},x:function(v,x,M,X){try{e:{var ce=nn(v);v=x;for(var He,Je=x=0;Je<M;Je++){var Mt=j[v>>2],fn=j[v+4>>2];v+=8;var Vt=ii(ce,Q,Mt,fn,He);if(0>Vt){var Yn=-1;break e}if(x+=Vt,Vt<fn)break;typeof He<"u"&&(He+=Vt)}Yn=x}return j[X>>2]=Yn,0}catch(Bn){if(typeof kn>"u"||Bn.name!=="ErrnoError")throw Bn;return Bn.Ka}},m:function(v,x,M,X,ce){x=rs(x,M);try{if(isNaN(x))return 61;var He=nn(v);return gs(He,x,X),C=[He.position>>>0,($e=He.position,1<=+Math.abs($e)?0<$e?+Math.floor($e/4294967296)>>>0:~~+Math.ceil(($e-+(~~$e>>>0))/4294967296)>>>0:0)],te[ce>>2]=C[0],te[ce+4>>2]=C[1],He.hb&&x===0&&X===0&&(He.hb=null),0}catch(Je){if(typeof kn>"u"||Je.name!=="ErrnoError")throw Je;return Je.Ka}},D:function(v){var M;try{var x=nn(v);return(M=x.Ha)!=null&&M.fsync?x.Ha.fsync(x):0}catch(X){if(typeof kn>"u"||X.name!=="ErrnoError")throw X;return X.Ka}},u:function(v,x,M,X){try{e:{var ce=nn(v);v=x;for(var He,Je=x=0;Je<M;Je++){var Mt=j[v>>2],fn=j[v+4>>2];v+=8;var Vt=dn(ce,Q,Mt,fn,He);if(0>Vt){var Yn=-1;break e}x+=Vt,typeof He<"u"&&(He+=Vt)}Yn=x}return j[X>>2]=Yn,0}catch(Bn){if(typeof kn>"u"||Bn.name!=="ErrnoError")throw Bn;return Bn.Ka}}},Ot=(function(){var M;function v(X){var ce;return Ot=X.exports,L=Ot.I,Z(),cr=Ot.Aa,ve.unshift(Ot.J),z--,(ce=m.monitorRunDependencies)==null||ce.call(m,z),z==0&&ne&&(X=ne,ne=null,X()),Ot}var x={a:pa};if(z++,(M=m.monitorRunDependencies)==null||M.call(m,z),m.instantiateWasm)try{return m.instantiateWasm(x,v)}catch(X){return W(`Module.instantiateWasm callback failed with error: ${X}`),!1}return ft(x,function(X){v(X.instance)}),{}})();m._sqlite3_free=v=>(m._sqlite3_free=Ot.K)(v),m._sqlite3_value_text=v=>(m._sqlite3_value_text=Ot.L)(v);var bs=()=>(bs=Ot.M)();m._sqlite3_prepare_v2=(v,x,M,X,ce)=>(m._sqlite3_prepare_v2=Ot.N)(v,x,M,X,ce),m._sqlite3_step=v=>(m._sqlite3_step=Ot.O)(v),m._sqlite3_reset=v=>(m._sqlite3_reset=Ot.P)(v),m._sqlite3_exec=(v,x,M,X,ce)=>(m._sqlite3_exec=Ot.Q)(v,x,M,X,ce),m._sqlite3_finalize=v=>(m._sqlite3_finalize=Ot.R)(v),m._sqlite3_column_name=(v,x)=>(m._sqlite3_column_name=Ot.S)(v,x),m._sqlite3_column_text=(v,x)=>(m._sqlite3_column_text=Ot.T)(v,x),m._sqlite3_column_type=(v,x)=>(m._sqlite3_column_type=Ot.U)(v,x),m._sqlite3_errmsg=v=>(m._sqlite3_errmsg=Ot.V)(v),m._sqlite3_clear_bindings=v=>(m._sqlite3_clear_bindings=Ot.W)(v),m._sqlite3_value_blob=v=>(m._sqlite3_value_blob=Ot.X)(v),m._sqlite3_value_bytes=v=>(m._sqlite3_value_bytes=Ot.Y)(v),m._sqlite3_value_double=v=>(m._sqlite3_value_double=Ot.Z)(v),m._sqlite3_value_int=v=>(m._sqlite3_value_int=Ot._)(v),m._sqlite3_value_type=v=>(m._sqlite3_value_type=Ot.$)(v),m._sqlite3_result_blob=(v,x,M,X)=>(m._sqlite3_result_blob=Ot.aa)(v,x,M,X),m._sqlite3_result_double=(v,x)=>(m._sqlite3_result_double=Ot.ba)(v,x),m._sqlite3_result_error=(v,x,M)=>(m._sqlite3_result_error=Ot.ca)(v,x,M),m._sqlite3_result_int=(v,x)=>(m._sqlite3_result_int=Ot.da)(v,x),m._sqlite3_result_int64=(v,x,M)=>(m._sqlite3_result_int64=Ot.ea)(v,x,M),m._sqlite3_result_null=v=>(m._sqlite3_result_null=Ot.fa)(v),m._sqlite3_result_text=(v,x,M,X)=>(m._sqlite3_result_text=Ot.ga)(v,x,M,X),m._sqlite3_aggregate_context=(v,x)=>(m._sqlite3_aggregate_context=Ot.ha)(v,x),m._sqlite3_column_count=v=>(m._sqlite3_column_count=Ot.ia)(v),m._sqlite3_data_count=v=>(m._sqlite3_data_count=Ot.ja)(v),m._sqlite3_column_blob=(v,x)=>(m._sqlite3_column_blob=Ot.ka)(v,x),m._sqlite3_column_bytes=(v,x)=>(m._sqlite3_column_bytes=Ot.la)(v,x),m._sqlite3_column_double=(v,x)=>(m._sqlite3_column_double=Ot.ma)(v,x),m._sqlite3_bind_blob=(v,x,M,X,ce)=>(m._sqlite3_bind_blob=Ot.na)(v,x,M,X,ce),m._sqlite3_bind_double=(v,x,M)=>(m._sqlite3_bind_double=Ot.oa)(v,x,M),m._sqlite3_bind_int=(v,x,M)=>(m._sqlite3_bind_int=Ot.pa)(v,x,M),m._sqlite3_bind_text=(v,x,M,X,ce)=>(m._sqlite3_bind_text=Ot.qa)(v,x,M,X,ce),m._sqlite3_bind_parameter_index=(v,x)=>(m._sqlite3_bind_parameter_index=Ot.ra)(v,x),m._sqlite3_sql=v=>(m._sqlite3_sql=Ot.sa)(v),m._sqlite3_normalized_sql=v=>(m._sqlite3_normalized_sql=Ot.ta)(v),m._sqlite3_changes=v=>(m._sqlite3_changes=Ot.ua)(v),m._sqlite3_close_v2=v=>(m._sqlite3_close_v2=Ot.va)(v),m._sqlite3_create_function_v2=(v,x,M,X,ce,He,Je,Mt,fn)=>(m._sqlite3_create_function_v2=Ot.wa)(v,x,M,X,ce,He,Je,Mt,fn),m._sqlite3_open=(v,x)=>(m._sqlite3_open=Ot.xa)(v,x);var Jr=m._malloc=v=>(Jr=m._malloc=Ot.ya)(v),Pa=m._free=v=>(Pa=m._free=Ot.za)(v);m._RegisterExtensionFunctions=v=>(m._RegisterExtensionFunctions=Ot.Ba)(v);var rr=(v,x)=>(rr=Ot.Ca)(v,x),Da=()=>(Da=Ot.Da)(),ma=v=>(ma=Ot.Ea)(v),hr=v=>(hr=Ot.Fa)(v);m.stackAlloc=hr,m.stackSave=Da,m.stackRestore=ma,m.cwrap=(v,x,M,X)=>{var ce=!M||M.every(He=>He==="number"||He==="boolean");return x!=="string"&&ce&&!X?m["_"+v]:function(){return Oo(v,x,M,arguments)}},m.addFunction=Gn,m.removeFunction=Na,m.UTF8ToString=Ve,m.ALLOC_NORMAL=lr,m.allocate=Ca,m.allocateUTF8OnStack=ci;var ga;ne=function v(){ga||as(),ga||(ne=v)};function as(){function v(){if(!ga&&(ga=!0,m.calledRun=!0,!U)){if(m.noFSInit||aa||(aa=!0,ys(),m.stdin=m.stdin,m.stdout=m.stdout,m.stderr=m.stderr,m.stdin?Qt("stdin",m.stdin):ut("/dev/tty","/dev/stdin"),m.stdout?Qt("stdout",null,m.stdout):ut("/dev/tty","/dev/stdout"),m.stderr?Qt("stderr",null,m.stderr):ut("/dev/tty1","/dev/stderr"),Xn("/dev/stdin",0),Xn("/dev/stdout",1),Xn("/dev/stderr",1)),ka=!1,Ne(ve),m.onRuntimeInitialized&&m.onRuntimeInitialized(),m.postRun)for(typeof m.postRun=="function"&&(m.postRun=[m.postRun]);m.postRun.length;){var x=m.postRun.shift();Be.unshift(x)}Ne(Be)}}if(!(0<z)){if(m.preRun)for(typeof m.preRun=="function"&&(m.preRun=[m.preRun]);m.preRun.length;)T();Ne(De),0<z||(m.setStatus?(m.setStatus("Running..."),setTimeout(function(){setTimeout(function(){m.setStatus("")},1),v()},1)):v())}}if(m.preInit)for(typeof m.preInit=="function"&&(m.preInit=[m.preInit]);0<m.preInit.length;)m.preInit.pop()();return as(),p}),s)};n.exports=i,n.exports.default=i})(Mh)),Mh.exports}var R2=I2();const M2=Co(R2);function U2(n){return new Promise((a,s)=>{const i=new Worker(new URL("/CogniFlow/assets/ankiImport.worker-DXXYc2v4.js",import.meta.url),{type:"module"});i.onmessage=c=>{const{status:u,decks:f,error:p}=c.data;u==="success"?a(f):s(new Error(p)),i.terminate()},i.onerror=c=>{console.error("Worker error:",c);const u=c.message||"The worker script could not be loaded or an unexpected error occurred.";s(new Error(`Anki import worker failed: ${u}`)),i.terminate()},i.postMessage(n,[n])})}let Lh=null;async function L2(){return Lh||(Lh=await M2({locateFile:n=>`https://esm.sh/sql.js@1.10.3/dist/${n}`})),Lh}function gb(n,a){let s=n;return s=s.replace(/<img\s[^>]*?src=(["'])(.*?)\1[^>]*?>/gi,(i,c,u)=>{const f=decodeURIComponent(u),p=a.get(f);if(p){const b=btoa(new Uint8Array(p.data).reduce((_,E)=>_+String.fromCharCode(E),"")),m=`src="data:${p.type};base64,${b}"`;return i.replace(/src=(["']).*?\1/i,m)}return i}),s=s.replace(/\[sound:(.*?)\]/g,(i,c)=>{const u=decodeURIComponent(c.trim()),f=a.get(u);if(f){const p=btoa(new Uint8Array(f.data).reduce((b,m)=>b+String.fromCharCode(m),""));return f.type.startsWith("video/")?`<video controls playsinline src="data:${f.type};base64,${p}"></video>`:`<audio controls src="data:${f.type};base64,${p}"></audio>`}return""}),s}function yb(n,a,s,i,c){let u=n;const f=/{{c(\d+)::(.*?)(?:::(.*?))?}}/gs;u=u.replace(f,(_,E,N,S)=>{const I=parseInt(E,10);return i?I===s+1?`<span class="cloze">[${S||"..."}]</span>`:`<span class="cloze-inactive">${N}</span>`:I===s+1?`<span class="cloze"><b>${N}</b></span>`:`<span class="cloze-inactive">${N}</span>`}),c&&(u=u.replace(/<hr id=answer>/g,"").replace(/{{FrontSide}}/g,c));const p=/{{#([^}]+?)}}(.*?){{\/\1}}/gs;let b;do b=u,u=u.replace(p,(_,E,N)=>{const S=a.get(E.trim());return S&&S.trim()!==""?N:""});while(u!==b);const m=/{{\^([^}]+?)}}(.*?){{\/\1}}/gs;do b=u,u=u.replace(m,(_,E,N)=>{const S=a.get(E.trim());return!S||S.trim()===""?N:""});while(u!==b);return a.forEach((_,E)=>{const N=new RegExp(`{{${E}}}`,"g");u=u.replace(N,_)}),u=u.replace(/{{(.*?)}}/g,""),u}async function z2(n){var G;const a=await L2(),s=await lp.loadAsync(n),i=s.file(/collection.anki2[1]?/);if(!i||i.length===0)throw new Error("collection.anki2 or .anki21 file not found.");const c=await i[0].async("uint8array"),u=new a.Database(c),f=s.file("media");let p={};if(f)try{p=JSON.parse(await f.async("string"))}catch(Y){console.warn("Could not parse media file.",Y)}const b=new Map;for(const Y in p){const W=p[Y],H=s.file(Y);if(H){const L=await H.async("uint8array"),U=((G=W.split(".").pop())==null?void 0:G.toLowerCase())||"";let Q="application/octet-stream";["jpg","jpeg"].includes(U)?Q="image/jpeg":U==="png"?Q="image/png":U==="gif"?Q="image/gif":U==="svg"?Q="image/svg+xml":U==="mp3"?Q="audio/mpeg":U==="ogg"?Q="audio/ogg":U==="wav"?Q="audio/wav":U==="m4a"?Q="audio/mp4":U==="opus"?Q="audio/opus":U==="mp4"?Q="video/mp4":U==="webm"?Q="video/webm":U==="ogv"&&(Q="video/ogg"),b.set(W,{data:L,type:Q})}}const m=u.exec("SELECT models, decks, crt FROM col");if(!m[0])throw new Error("Could not read collection data.");const[_,E,N]=m[0].values[0],S=JSON.parse(_),I=JSON.parse(E),A=u.exec("SELECT id, mid, flds FROM notes"),k=new Map(A[0].values.map(Y=>[Y[0],{mid:Y[1],flds:Y[2].split("")}])),P=u.exec("SELECT id, nid, did, ord, due, ivl, factor, type, lapses FROM cards")[0].values,q=new Map;for(const Y in I){const W=I[Y];q.set(Y,{id:crypto.randomUUID(),name:W.name,description:W.desc||"Imported Anki deck.",type:et.Flashcard,cards:[]})}for(const Y of P){const[W,H,L,U,Q,le,F,te,j]=Y,he=k.get(H);if(!he)continue;const J=S[he.mid];if(!(J!=null&&J.tmpls))continue;const Z=q.get(L.toString());if(!Z)continue;const De=J.tmpls[U];if(!De)continue;const ve=new Map((J.flds||[]).map((ue,de)=>[ue.name,he.flds[de]||""]));let Be=yb(De.qfmt,ve,U,!0),T=yb(De.afmt,ve,U,!1,Be);Be=gb(Be,b),T=gb(T,b);let z,ne;te===2&&le>0?(z=new Date(N*1e3),z.setDate(z.getDate()+Q),ne=new Date(z.getTime()),ne.setDate(ne.getDate()-le)):(z=new Date,z.setHours(0,0,0,0));const se=Math.min(1,Math.log1p(le)/Math.log1p(90));Z.cards.push({id:W.toString(),front:Be,back:T,css:J.css?`<style>${J.css}</style>`:"",dueDate:z.toISOString(),interval:le,easeFactor:F?Math.max(F/1e3,Bh):za,masteryLevel:se,lastReviewed:ne==null?void 0:ne.toISOString(),lapses:j||0})}return u.close(),Array.from(q.values()).filter(Y=>Y.cards.length>0)}const B2=n=>{const{dispatch:a}=kt(),{openModal:s,closeModal:i}=zc(),{addToast:c}=Ar(),{navigate:u}=si(),f=y2({...n,addToast:c,openModal:s,closeModal:i,dispatch:a}),{triggerSync:p}=f,b=f2({triggerSync:p,openConfirmModal:k=>s("confirm",k)}),m=h2({triggerSync:p,handleAddDecks:b.handleAddDecks,handleUpdateDeck:b.handleUpdateDeck}),_=g2({...n,handleUpdateDeck:b.handleUpdateDeck}),E=C2({...n,openConfirmModal:k=>s("confirm",k),openRestoreFromDriveModal:()=>s("restoreFromDrive"),onRestoreData:async k=>{await f.onRestoreData(k),n.onDataRestoreComplete&&n.onDataRestoreComplete(k)}}),N=D2({handleUpdateDeck:b.handleUpdateDeck,handleAddDecks:b.handleAddDecks,handleAddSeriesWithDecks:m.handleAddSeriesWithDecks,handleUpdateSeries:m.handleUpdateSeries,openConfirmModal:k=>s("confirm",k),openModal:s,closeModal:i}),S=$.useCallback(async(k,R={})=>{if(i(),!k)return;const{deckName:P,imageHint:q}=R;try{if(k.type==="series"){const{seriesName:G,seriesDescription:Y,levels:W}=k.data,H=[],L=(W||[]).map(Q=>{const le=(Q.decks||[]).map(F=>F.type==="quiz"?{id:crypto.randomUUID(),name:F.name,description:F.description,type:et.Quiz,questions:Ea(F.questions||[]),generationStatus:F.generationStatus}:F.type==="learning"?{id:crypto.randomUUID(),name:F.name,description:F.description,type:et.Learning,infoCards:F.infoCards||[],questions:Ea(F.questions||[]),learningMode:F.learningMode||"separate",curriculum:F.curriculum,generationStatus:F.generationStatus}:F.type==="flashcard"?{id:crypto.randomUUID(),name:F.name,description:F.description,type:et.Flashcard,cards:ko(F.cards||[]),generationStatus:F.generationStatus}:null).filter(F=>F!==null);return H.push(...le),{title:Q.title,deckIds:le.map(F=>F.id)}}),U={id:crypto.randomUUID(),type:"series",name:G,description:Y,levels:L,archived:!1,createdAt:new Date().toISOString()};await m.handleAddSeriesWithDecks(U,H)}else if(k.type==="quiz"){const G={id:crypto.randomUUID(),name:P||k.data.name,description:k.data.description,type:et.Quiz,questions:Ea(k.data.questions),generationStatus:k.data.generationStatus};await b.handleAddDecks([G]),c(`Deck "${G.name}" imported successfully.`,"success")}else if(k.type==="learning"){const G={id:crypto.randomUUID(),name:P||k.data.name,description:k.data.description||"",type:et.Learning,infoCards:k.data.infoCards||[],questions:Ea(k.data.questions||[]),learningMode:k.data.learningMode||"separate",curriculum:k.data.curriculum,generationStatus:k.data.generationStatus};await b.handleAddDecks([G]),c(`Learning Deck "${G.name}" imported successfully.`,"success")}else if(k.type==="flashcard"){if(!P){c("Deck name is required for flashcard import.","error");return}const G=ko(k.data),Y={id:crypto.randomUUID(),name:P,type:et.Flashcard,cards:G,description:`${G.length} imported flashcard${G.length===1?"":"s"}.`};await b.handleAddDecks([Y]),c(`Deck "${Y.name}" imported successfully.`,"success")}else if(k.type==="anki"&&k.file){c("Processing Anki package...","info");const G=await k.file.arrayBuffer();let Y=[];try{Y=await U2(G)}catch(W){console.warn("Anki worker failed, trying fallback:",W);const H=await k.file.arrayBuffer();Y=await z2(H)}Y.length>0?(await b.handleAddDecks(Y),c(`Successfully imported ${Y.length} deck(s) from Anki package.`,"success")):c("No valid decks found in the Anki package.","error")}else if(k.type==="image"&&k.file){c("Analyzing image with AI...","info");const G=new FileReader;G.readAsDataURL(k.file),G.onload=async()=>{try{const Y=G.result.split(",")[1],{name:W,description:H,cards:L}=await zk(Y,k.file.type,q),U={id:crypto.randomUUID(),name:W||`Image Deck - ${k.file.name}`,description:H||`Generated from ${k.file.name}`,type:et.Flashcard,cards:ko(L)};await b.handleAddDecks([U]),c(`Deck "${U.name}" generated successfully.`,"success")}catch(Y){console.error(Y),c(`Image generation failed: ${Y.message}`,"error")}},G.onerror=()=>c("Failed to read image file.","error")}else k.type==="backup"&&k.data&&(await f.onRestoreData(k.data),n.onDataRestoreComplete&&n.onDataRestoreComplete(k.data))}catch(G){c(G.message,"error")}},[m,b,f,c,i,n]),I=$.useCallback(k=>{s("viewJson",{title:`View Deck JSON: ${k.name}`,data:k,filename:`deck-${k.id}.json`})},[s]),A=$.useCallback(k=>{const R=Object.values(kt.getState().decks).filter(P=>k.levels.some(q=>q.deckIds.includes(P.id)));s("viewJson",{title:`View Series JSON: ${k.name}`,data:{series:k,decks:R},filename:`series-${k.id}.json`})},[s]);return $.useCallback(async()=>{await f.handleExportData()},[f]),$.useMemo(()=>({...n,...b,...m,..._,...f,...E,...N,handleViewDeckJson:I,handleViewSeriesJson:A,openModal:s,closeModal:i,handleDroppedFileConfirm:S,openConfirmModal:k=>s("confirm",k),addToast:c}),[n,b,m,_,f,E,N,I,A,s,i,S,c])},F2=({children:n})=>{const{path:a}=si(),{dispatch:s,decks:i,deckSeries:c}=kt(),{addToast:u}=Ar(),{openModal:f}=zc(),{backupEnabled:p}=Xi(),[b,m]=$.useState(!1),[_,E]=$.useState("Not synced"),[N,S]=$.useState(new Set),[I,A]=$.useState(null),[k,R]=$.useState("recent"),[P,q]=$.useState(null),[G,Y]=$.useState(new Set),W=Z=>{Y(De=>{const ve=new Set(De);return ve.has(Z)?ve.delete(Z):ve.add(Z),ve})},[H,L]=$.useState(!1),[U,Q]=$.useState(!1),[le,F]=$.useState(null),te=$.useCallback(async Z=>{try{const[De,ve,Be,T,z,ne,se]=await Promise.all([$n.getAllDecks(),$n.getAllFolders(),$n.getAllDeckSeries(),$n.getAllSeriesProgress(),$n.getAllLearningProgress(),$n.getAIChatHistory(),$n.getAllSessionKeys()]),ue=new Map;Object.entries(T).forEach(([oe,ye])=>{ue.set(oe,new Set(ye))}),s({type:"LOAD_DATA",payload:{decks:De,folders:ve,deckSeries:Be}}),s({type:"SET_SERIES_PROGRESS",payload:ue}),s({type:"SET_LEARNING_PROGRESS",payload:z}),s({type:"SET_AI_CHAT_HISTORY",payload:ne}),Z!=null&&Z.aiTasks&&Z.aiTasks.length>0&&(Z.aiTasks.forEach(oe=>{s({type:"ADD_AI_TASK_TO_QUEUE",payload:oe})}),u(`Resumed ${Z.aiTasks.length} background AI tasks.`,"info"));const de=new Set;se.forEach(oe=>{oe.startsWith("session_deck_")&&de.add(oe.replace("session_deck_",""))}),S(de)}catch(De){console.error("Critical error during data initialization:",De),u("Failed to load your data. Please check browser permissions and reload.","error")}},[s,u]);$.useEffect(()=>{te();const Z=i1(()=>{console.log("Data changed in another tab, reloading..."),te()});return()=>{Z()}},[te]),$.useEffect(()=>{const Z=_2(L),De=w2((ve,Be)=>{Q(ve),F(Be||null)});return()=>{Z(),De()}},[]);const j=$.useMemo(()=>{const Z=a.match(/^\/decks\/([^/?]+)/);return Z?i[Z[1]]:null},[a,i]),he=$.useMemo(()=>{const Z=a.match(/^\/series\/([^/?]+)/);return Z?c[Z[1]]:null},[a,c]),J=B2({activeDeck:j,activeSeries:he,generalStudyDeck:I,setGeneralStudyDeck:A,sessionsToResume:N,setSessionsToResume:S,isSyncing:b,setIsSyncing:m,lastSyncStatus:_,setLastSyncStatus:E,backupEnabled:p,isGapiReady:H,isGapiSignedIn:U,gapiUser:le,sortPreference:k,setSortPreference:R,draggedDeckId:P,setDraggedDeckId:q,openFolderIds:G,onToggleFolder:W,onDataRestoreComplete:Z=>te(Z)});return l.jsx(O_,{value:J,children:n})};function I0(n,a,s={}){const i=a instanceof Error;console.groupCollapsed(`%c[${n}] ${i?a.message:"An error occurred"}`,"color: red; font-weight: bold;"),console.error(a),Object.keys(s).length>0&&console.log("Additional Info:",s),i&&a.stack&&console.log("Stack Trace:",a.stack),console.groupEnd()}window.addEventListener("error",n=>{I0("Unhandled Global Error",n.error||n.message,{message:n.message,filename:n.filename,lineno:n.lineno,colno:n.colno})});window.addEventListener("unhandledrejection",n=>{I0("Unhandled Promise Rejection",n.reason)});const R0=document.getElementById("root");if(!R0)throw new Error("Could not find root element to mount to");const H2=c_.createRoot(R0);H2.render(l.jsx(Yi.StrictMode,{children:l.jsx(a2,{children:l.jsx(PS,{children:l.jsx(U_,{children:l.jsx(R_,{children:l.jsx(tw,{children:l.jsx(F2,{children:l.jsx(r2,{children:l.jsx(n2,{})})})})})})})})}));export{KS as A,pt as B,VS as C,c0 as D,tr as E,si as F,rp as G,pc as H,rt as I,P2 as J,rA as K,ds as L,ko as M,Ea as N,F1 as O,np as P,Yi as Q,La as R,Rs as S,Kk as T,T_ as U,N_ as V,M1 as W,Ar as a,aA as b,kr as c,kt as d,et as e,w1 as f,m2 as g,A1 as h,_l as i,l as j,_1 as k,oA as l,sA as m,iA as n,Pu as o,tA as p,qu as q,$ as r,wc as s,yl as t,Xi as u,Gu as v,nA as w,zc as x,q2 as y,za as z};
