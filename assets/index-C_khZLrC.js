var Ag=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports);var JE=Ag((QE,wi)=>{(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))o(i);new MutationObserver(i=>{for(const c of i)if(c.type==="childList")for(const f of c.addedNodes)f.tagName==="LINK"&&f.rel==="modulepreload"&&o(f)}).observe(document,{childList:!0,subtree:!0});function n(i){const c={};return i.integrity&&(c.integrity=i.integrity),i.referrerPolicy&&(c.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?c.credentials="include":i.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function o(i){if(i.ep)return;i.ep=!0;const c=n(i);fetch(i.href,c)}})();var Aa=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function yi(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function Dg(t){if(Object.prototype.hasOwnProperty.call(t,"__esModule"))return t;var e=t.default;if(typeof e=="function"){var n=function o(){return this instanceof o?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};n.prototype=e.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(t).forEach(function(o){var i=Object.getOwnPropertyDescriptor(t,o);Object.defineProperty(n,o,i.get?i:{enumerable:!0,get:function(){return t[o]}})}),n}var Uu={exports:{}},ui={},ju={exports:{}},mt={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var jf;function Mg(){if(jf)return mt;jf=1;var t=Symbol.for("react.element"),e=Symbol.for("react.portal"),n=Symbol.for("react.fragment"),o=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),c=Symbol.for("react.provider"),f=Symbol.for("react.context"),m=Symbol.for("react.forward_ref"),h=Symbol.for("react.suspense"),p=Symbol.for("react.memo"),v=Symbol.for("react.lazy"),x=Symbol.iterator;function C(N){return N===null||typeof N!="object"?null:(N=x&&N[x]||N["@@iterator"],typeof N=="function"?N:null)}var S={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},b=Object.assign,T={};function A(N,j,O){this.props=N,this.context=j,this.refs=T,this.updater=O||S}A.prototype.isReactComponent={},A.prototype.setState=function(N,j){if(typeof N!="object"&&typeof N!="function"&&N!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,N,j,"setState")},A.prototype.forceUpdate=function(N){this.updater.enqueueForceUpdate(this,N,"forceUpdate")};function D(){}D.prototype=A.prototype;function F(N,j,O){this.props=N,this.context=j,this.refs=T,this.updater=O||S}var L=F.prototype=new D;L.constructor=F,b(L,A.prototype),L.isPureReactComponent=!0;var R=Array.isArray,P=Object.prototype.hasOwnProperty,G={current:null},$={key:!0,ref:!0,__self:!0,__source:!0};function oe(N,j,O){var V,K={},X=null,se=null;if(j!=null)for(V in j.ref!==void 0&&(se=j.ref),j.key!==void 0&&(X=""+j.key),j)P.call(j,V)&&!$.hasOwnProperty(V)&&(K[V]=j[V]);var ae=arguments.length-2;if(ae===1)K.children=O;else if(1<ae){for(var ke=Array(ae),Ae=0;Ae<ae;Ae++)ke[Ae]=arguments[Ae+2];K.children=ke}if(N&&N.defaultProps)for(V in ae=N.defaultProps,ae)K[V]===void 0&&(K[V]=ae[V]);return{$$typeof:t,type:N,key:X,ref:se,props:K,_owner:G.current}}function J(N,j){return{$$typeof:t,type:N.type,key:j,ref:N.ref,props:N.props,_owner:N._owner}}function Z(N){return typeof N=="object"&&N!==null&&N.$$typeof===t}function le(N){var j={"=":"=0",":":"=2"};return"$"+N.replace(/[=:]/g,function(O){return j[O]})}var Q=/\/+/g;function Y(N,j){return typeof N=="object"&&N!==null&&N.key!=null?le(""+N.key):j.toString(36)}function M(N,j,O,V,K){var X=typeof N;(X==="undefined"||X==="boolean")&&(N=null);var se=!1;if(N===null)se=!0;else switch(X){case"string":case"number":se=!0;break;case"object":switch(N.$$typeof){case t:case e:se=!0}}if(se)return se=N,K=K(se),N=V===""?"."+Y(se,0):V,R(K)?(O="",N!=null&&(O=N.replace(Q,"$&/")+"/"),M(K,j,O,"",function(Ae){return Ae})):K!=null&&(Z(K)&&(K=J(K,O+(!K.key||se&&se.key===K.key?"":(""+K.key).replace(Q,"$&/")+"/")+N)),j.push(K)),1;if(se=0,V=V===""?".":V+":",R(N))for(var ae=0;ae<N.length;ae++){X=N[ae];var ke=V+Y(X,ae);se+=M(X,j,O,ke,K)}else if(ke=C(N),typeof ke=="function")for(N=ke.call(N),ae=0;!(X=N.next()).done;)X=X.value,ke=V+Y(X,ae++),se+=M(X,j,O,ke,K);else if(X==="object")throw j=String(N),Error("Objects are not valid as a React child (found: "+(j==="[object Object]"?"object with keys {"+Object.keys(N).join(", ")+"}":j)+"). If you meant to render a collection of children, use an array instead.");return se}function pe(N,j,O){if(N==null)return N;var V=[],K=0;return M(N,V,"","",function(X){return j.call(O,X,K++)}),V}function be(N){if(N._status===-1){var j=N._result;j=j(),j.then(function(O){(N._status===0||N._status===-1)&&(N._status=1,N._result=O)},function(O){(N._status===0||N._status===-1)&&(N._status=2,N._result=O)}),N._status===-1&&(N._status=0,N._result=j)}if(N._status===1)return N._result.default;throw N._result}var ve={current:null},xe={transition:null},te={ReactCurrentDispatcher:ve,ReactCurrentBatchConfig:xe,ReactCurrentOwner:G};function q(){throw Error("act(...) is not supported in production builds of React.")}return mt.Children={map:pe,forEach:function(N,j,O){pe(N,function(){j.apply(this,arguments)},O)},count:function(N){var j=0;return pe(N,function(){j++}),j},toArray:function(N){return pe(N,function(j){return j})||[]},only:function(N){if(!Z(N))throw Error("React.Children.only expected to receive a single React element child.");return N}},mt.Component=A,mt.Fragment=n,mt.Profiler=i,mt.PureComponent=F,mt.StrictMode=o,mt.Suspense=h,mt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=te,mt.act=q,mt.cloneElement=function(N,j,O){if(N==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+N+".");var V=b({},N.props),K=N.key,X=N.ref,se=N._owner;if(j!=null){if(j.ref!==void 0&&(X=j.ref,se=G.current),j.key!==void 0&&(K=""+j.key),N.type&&N.type.defaultProps)var ae=N.type.defaultProps;for(ke in j)P.call(j,ke)&&!$.hasOwnProperty(ke)&&(V[ke]=j[ke]===void 0&&ae!==void 0?ae[ke]:j[ke])}var ke=arguments.length-2;if(ke===1)V.children=O;else if(1<ke){ae=Array(ke);for(var Ae=0;Ae<ke;Ae++)ae[Ae]=arguments[Ae+2];V.children=ae}return{$$typeof:t,type:N.type,key:K,ref:X,props:V,_owner:se}},mt.createContext=function(N){return N={$$typeof:f,_currentValue:N,_currentValue2:N,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},N.Provider={$$typeof:c,_context:N},N.Consumer=N},mt.createElement=oe,mt.createFactory=function(N){var j=oe.bind(null,N);return j.type=N,j},mt.createRef=function(){return{current:null}},mt.forwardRef=function(N){return{$$typeof:m,render:N}},mt.isValidElement=Z,mt.lazy=function(N){return{$$typeof:v,_payload:{_status:-1,_result:N},_init:be}},mt.memo=function(N,j){return{$$typeof:p,type:N,compare:j===void 0?null:j}},mt.startTransition=function(N){var j=xe.transition;xe.transition={};try{N()}finally{xe.transition=j}},mt.unstable_act=q,mt.useCallback=function(N,j){return ve.current.useCallback(N,j)},mt.useContext=function(N){return ve.current.useContext(N)},mt.useDebugValue=function(){},mt.useDeferredValue=function(N){return ve.current.useDeferredValue(N)},mt.useEffect=function(N,j){return ve.current.useEffect(N,j)},mt.useId=function(){return ve.current.useId()},mt.useImperativeHandle=function(N,j,O){return ve.current.useImperativeHandle(N,j,O)},mt.useInsertionEffect=function(N,j){return ve.current.useInsertionEffect(N,j)},mt.useLayoutEffect=function(N,j){return ve.current.useLayoutEffect(N,j)},mt.useMemo=function(N,j){return ve.current.useMemo(N,j)},mt.useReducer=function(N,j,O){return ve.current.useReducer(N,j,O)},mt.useRef=function(N){return ve.current.useRef(N)},mt.useState=function(N){return ve.current.useState(N)},mt.useSyncExternalStore=function(N,j,O){return ve.current.useSyncExternalStore(N,j,O)},mt.useTransition=function(){return ve.current.useTransition()},mt.version="18.3.1",mt}var qf;function vi(){return qf||(qf=1,ju.exports=Mg()),ju.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var zf;function Rg(){if(zf)return ui;zf=1;var t=vi(),e=Symbol.for("react.element"),n=Symbol.for("react.fragment"),o=Object.prototype.hasOwnProperty,i=t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,c={key:!0,ref:!0,__self:!0,__source:!0};function f(m,h,p){var v,x={},C=null,S=null;p!==void 0&&(C=""+p),h.key!==void 0&&(C=""+h.key),h.ref!==void 0&&(S=h.ref);for(v in h)o.call(h,v)&&!c.hasOwnProperty(v)&&(x[v]=h[v]);if(m&&m.defaultProps)for(v in h=m.defaultProps,h)x[v]===void 0&&(x[v]=h[v]);return{$$typeof:e,type:m,key:C,ref:S,props:x,_owner:i.current}}return ui.Fragment=n,ui.jsx=f,ui.jsxs=f,ui}var Of;function Pg(){return Of||(Of=1,Uu.exports=Rg()),Uu.exports}var u=Pg(),B=vi();const hi=yi(B);var Da={},qu={exports:{}},Nn={},zu={exports:{}},Ou={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Bf;function Fg(){return Bf||(Bf=1,function(t){function e(xe,te){var q=xe.length;xe.push(te);e:for(;0<q;){var N=q-1>>>1,j=xe[N];if(0<i(j,te))xe[N]=te,xe[q]=j,q=N;else break e}}function n(xe){return xe.length===0?null:xe[0]}function o(xe){if(xe.length===0)return null;var te=xe[0],q=xe.pop();if(q!==te){xe[0]=q;e:for(var N=0,j=xe.length,O=j>>>1;N<O;){var V=2*(N+1)-1,K=xe[V],X=V+1,se=xe[X];if(0>i(K,q))X<j&&0>i(se,K)?(xe[N]=se,xe[X]=q,N=X):(xe[N]=K,xe[V]=q,N=V);else if(X<j&&0>i(se,q))xe[N]=se,xe[X]=q,N=X;else break e}}return te}function i(xe,te){var q=xe.sortIndex-te.sortIndex;return q!==0?q:xe.id-te.id}if(typeof performance=="object"&&typeof performance.now=="function"){var c=performance;t.unstable_now=function(){return c.now()}}else{var f=Date,m=f.now();t.unstable_now=function(){return f.now()-m}}var h=[],p=[],v=1,x=null,C=3,S=!1,b=!1,T=!1,A=typeof setTimeout=="function"?setTimeout:null,D=typeof clearTimeout=="function"?clearTimeout:null,F=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function L(xe){for(var te=n(p);te!==null;){if(te.callback===null)o(p);else if(te.startTime<=xe)o(p),te.sortIndex=te.expirationTime,e(h,te);else break;te=n(p)}}function R(xe){if(T=!1,L(xe),!b)if(n(h)!==null)b=!0,be(P);else{var te=n(p);te!==null&&ve(R,te.startTime-xe)}}function P(xe,te){b=!1,T&&(T=!1,D(oe),oe=-1),S=!0;var q=C;try{for(L(te),x=n(h);x!==null&&(!(x.expirationTime>te)||xe&&!le());){var N=x.callback;if(typeof N=="function"){x.callback=null,C=x.priorityLevel;var j=N(x.expirationTime<=te);te=t.unstable_now(),typeof j=="function"?x.callback=j:x===n(h)&&o(h),L(te)}else o(h);x=n(h)}if(x!==null)var O=!0;else{var V=n(p);V!==null&&ve(R,V.startTime-te),O=!1}return O}finally{x=null,C=q,S=!1}}var G=!1,$=null,oe=-1,J=5,Z=-1;function le(){return!(t.unstable_now()-Z<J)}function Q(){if($!==null){var xe=t.unstable_now();Z=xe;var te=!0;try{te=$(!0,xe)}finally{te?Y():(G=!1,$=null)}}else G=!1}var Y;if(typeof F=="function")Y=function(){F(Q)};else if(typeof MessageChannel<"u"){var M=new MessageChannel,pe=M.port2;M.port1.onmessage=Q,Y=function(){pe.postMessage(null)}}else Y=function(){A(Q,0)};function be(xe){$=xe,G||(G=!0,Y())}function ve(xe,te){oe=A(function(){xe(t.unstable_now())},te)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(xe){xe.callback=null},t.unstable_continueExecution=function(){b||S||(b=!0,be(P))},t.unstable_forceFrameRate=function(xe){0>xe||125<xe?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):J=0<xe?Math.floor(1e3/xe):5},t.unstable_getCurrentPriorityLevel=function(){return C},t.unstable_getFirstCallbackNode=function(){return n(h)},t.unstable_next=function(xe){switch(C){case 1:case 2:case 3:var te=3;break;default:te=C}var q=C;C=te;try{return xe()}finally{C=q}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(xe,te){switch(xe){case 1:case 2:case 3:case 4:case 5:break;default:xe=3}var q=C;C=xe;try{return te()}finally{C=q}},t.unstable_scheduleCallback=function(xe,te,q){var N=t.unstable_now();switch(typeof q=="object"&&q!==null?(q=q.delay,q=typeof q=="number"&&0<q?N+q:N):q=N,xe){case 1:var j=-1;break;case 2:j=250;break;case 5:j=1073741823;break;case 4:j=1e4;break;default:j=5e3}return j=q+j,xe={id:v++,callback:te,priorityLevel:xe,startTime:q,expirationTime:j,sortIndex:-1},q>N?(xe.sortIndex=q,e(p,xe),n(h)===null&&xe===n(p)&&(T?(D(oe),oe=-1):T=!0,ve(R,q-N))):(xe.sortIndex=j,e(h,xe),b||S||(b=!0,be(P))),xe},t.unstable_shouldYield=le,t.unstable_wrapCallback=function(xe){var te=C;return function(){var q=C;C=te;try{return xe.apply(this,arguments)}finally{C=q}}}}(Ou)),Ou}var Vf;function Lg(){return Vf||(Vf=1,zu.exports=Fg()),zu.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Gf;function Ug(){if(Gf)return Nn;Gf=1;var t=vi(),e=Lg();function n(r){for(var s="https://reactjs.org/docs/error-decoder.html?invariant="+r,d=1;d<arguments.length;d++)s+="&args[]="+encodeURIComponent(arguments[d]);return"Minified React error #"+r+"; visit "+s+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var o=new Set,i={};function c(r,s){f(r,s),f(r+"Capture",s)}function f(r,s){for(i[r]=s,r=0;r<s.length;r++)o.add(s[r])}var m=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),h=Object.prototype.hasOwnProperty,p=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,v={},x={};function C(r){return h.call(x,r)?!0:h.call(v,r)?!1:p.test(r)?x[r]=!0:(v[r]=!0,!1)}function S(r,s,d,g){if(d!==null&&d.type===0)return!1;switch(typeof s){case"function":case"symbol":return!0;case"boolean":return g?!1:d!==null?!d.acceptsBooleans:(r=r.toLowerCase().slice(0,5),r!=="data-"&&r!=="aria-");default:return!1}}function b(r,s,d,g){if(s===null||typeof s>"u"||S(r,s,d,g))return!0;if(g)return!1;if(d!==null)switch(d.type){case 3:return!s;case 4:return s===!1;case 5:return isNaN(s);case 6:return isNaN(s)||1>s}return!1}function T(r,s,d,g,w,_,U){this.acceptsBooleans=s===2||s===3||s===4,this.attributeName=g,this.attributeNamespace=w,this.mustUseProperty=d,this.propertyName=r,this.type=s,this.sanitizeURL=_,this.removeEmptyString=U}var A={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(r){A[r]=new T(r,0,!1,r,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(r){var s=r[0];A[s]=new T(s,1,!1,r[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(r){A[r]=new T(r,2,!1,r.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(r){A[r]=new T(r,2,!1,r,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(r){A[r]=new T(r,3,!1,r.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(r){A[r]=new T(r,3,!0,r,null,!1,!1)}),["capture","download"].forEach(function(r){A[r]=new T(r,4,!1,r,null,!1,!1)}),["cols","rows","size","span"].forEach(function(r){A[r]=new T(r,6,!1,r,null,!1,!1)}),["rowSpan","start"].forEach(function(r){A[r]=new T(r,5,!1,r.toLowerCase(),null,!1,!1)});var D=/[\-:]([a-z])/g;function F(r){return r[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(r){var s=r.replace(D,F);A[s]=new T(s,1,!1,r,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(r){var s=r.replace(D,F);A[s]=new T(s,1,!1,r,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(r){var s=r.replace(D,F);A[s]=new T(s,1,!1,r,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(r){A[r]=new T(r,1,!1,r.toLowerCase(),null,!1,!1)}),A.xlinkHref=new T("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(r){A[r]=new T(r,1,!1,r.toLowerCase(),null,!0,!0)});function L(r,s,d,g){var w=A.hasOwnProperty(s)?A[s]:null;(w!==null?w.type!==0:g||!(2<s.length)||s[0]!=="o"&&s[0]!=="O"||s[1]!=="n"&&s[1]!=="N")&&(b(s,d,w,g)&&(d=null),g||w===null?C(s)&&(d===null?r.removeAttribute(s):r.setAttribute(s,""+d)):w.mustUseProperty?r[w.propertyName]=d===null?w.type===3?!1:"":d:(s=w.attributeName,g=w.attributeNamespace,d===null?r.removeAttribute(s):(w=w.type,d=w===3||w===4&&d===!0?"":""+d,g?r.setAttributeNS(g,s,d):r.setAttribute(s,d))))}var R=t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,P=Symbol.for("react.element"),G=Symbol.for("react.portal"),$=Symbol.for("react.fragment"),oe=Symbol.for("react.strict_mode"),J=Symbol.for("react.profiler"),Z=Symbol.for("react.provider"),le=Symbol.for("react.context"),Q=Symbol.for("react.forward_ref"),Y=Symbol.for("react.suspense"),M=Symbol.for("react.suspense_list"),pe=Symbol.for("react.memo"),be=Symbol.for("react.lazy"),ve=Symbol.for("react.offscreen"),xe=Symbol.iterator;function te(r){return r===null||typeof r!="object"?null:(r=xe&&r[xe]||r["@@iterator"],typeof r=="function"?r:null)}var q=Object.assign,N;function j(r){if(N===void 0)try{throw Error()}catch(d){var s=d.stack.trim().match(/\n( *(at )?)/);N=s&&s[1]||""}return`
`+N+r}var O=!1;function V(r,s){if(!r||O)return"";O=!0;var d=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(s)if(s=function(){throw Error()},Object.defineProperty(s.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(s,[])}catch(we){var g=we}Reflect.construct(r,[],s)}else{try{s.call()}catch(we){g=we}r.call(s.prototype)}else{try{throw Error()}catch(we){g=we}r()}}catch(we){if(we&&g&&typeof we.stack=="string"){for(var w=we.stack.split(`
`),_=g.stack.split(`
`),U=w.length-1,ee=_.length-1;1<=U&&0<=ee&&w[U]!==_[ee];)ee--;for(;1<=U&&0<=ee;U--,ee--)if(w[U]!==_[ee]){if(U!==1||ee!==1)do if(U--,ee--,0>ee||w[U]!==_[ee]){var ie=`
`+w[U].replace(" at new "," at ");return r.displayName&&ie.includes("<anonymous>")&&(ie=ie.replace("<anonymous>",r.displayName)),ie}while(1<=U&&0<=ee);break}}}finally{O=!1,Error.prepareStackTrace=d}return(r=r?r.displayName||r.name:"")?j(r):""}function K(r){switch(r.tag){case 5:return j(r.type);case 16:return j("Lazy");case 13:return j("Suspense");case 19:return j("SuspenseList");case 0:case 2:case 15:return r=V(r.type,!1),r;case 11:return r=V(r.type.render,!1),r;case 1:return r=V(r.type,!0),r;default:return""}}function X(r){if(r==null)return null;if(typeof r=="function")return r.displayName||r.name||null;if(typeof r=="string")return r;switch(r){case $:return"Fragment";case G:return"Portal";case J:return"Profiler";case oe:return"StrictMode";case Y:return"Suspense";case M:return"SuspenseList"}if(typeof r=="object")switch(r.$$typeof){case le:return(r.displayName||"Context")+".Consumer";case Z:return(r._context.displayName||"Context")+".Provider";case Q:var s=r.render;return r=r.displayName,r||(r=s.displayName||s.name||"",r=r!==""?"ForwardRef("+r+")":"ForwardRef"),r;case pe:return s=r.displayName||null,s!==null?s:X(r.type)||"Memo";case be:s=r._payload,r=r._init;try{return X(r(s))}catch{}}return null}function se(r){var s=r.type;switch(r.tag){case 24:return"Cache";case 9:return(s.displayName||"Context")+".Consumer";case 10:return(s._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return r=s.render,r=r.displayName||r.name||"",s.displayName||(r!==""?"ForwardRef("+r+")":"ForwardRef");case 7:return"Fragment";case 5:return s;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return X(s);case 8:return s===oe?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof s=="function")return s.displayName||s.name||null;if(typeof s=="string")return s}return null}function ae(r){switch(typeof r){case"boolean":case"number":case"string":case"undefined":return r;case"object":return r;default:return""}}function ke(r){var s=r.type;return(r=r.nodeName)&&r.toLowerCase()==="input"&&(s==="checkbox"||s==="radio")}function Ae(r){var s=ke(r)?"checked":"value",d=Object.getOwnPropertyDescriptor(r.constructor.prototype,s),g=""+r[s];if(!r.hasOwnProperty(s)&&typeof d<"u"&&typeof d.get=="function"&&typeof d.set=="function"){var w=d.get,_=d.set;return Object.defineProperty(r,s,{configurable:!0,get:function(){return w.call(this)},set:function(U){g=""+U,_.call(this,U)}}),Object.defineProperty(r,s,{enumerable:d.enumerable}),{getValue:function(){return g},setValue:function(U){g=""+U},stopTracking:function(){r._valueTracker=null,delete r[s]}}}}function Ne(r){r._valueTracker||(r._valueTracker=Ae(r))}function je(r){if(!r)return!1;var s=r._valueTracker;if(!s)return!0;var d=s.getValue(),g="";return r&&(g=ke(r)?r.checked?"true":"false":r.value),r=g,r!==d?(s.setValue(r),!0):!1}function De(r){if(r=r||(typeof document<"u"?document:void 0),typeof r>"u")return null;try{return r.activeElement||r.body}catch{return r.body}}function E(r,s){var d=s.checked;return q({},s,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:d??r._wrapperState.initialChecked})}function fe(r,s){var d=s.defaultValue==null?"":s.defaultValue,g=s.checked!=null?s.checked:s.defaultChecked;d=ae(s.value!=null?s.value:d),r._wrapperState={initialChecked:g,initialValue:d,controlled:s.type==="checkbox"||s.type==="radio"?s.checked!=null:s.value!=null}}function ce(r,s){s=s.checked,s!=null&&L(r,"checked",s,!1)}function W(r,s){ce(r,s);var d=ae(s.value),g=s.type;if(d!=null)g==="number"?(d===0&&r.value===""||r.value!=d)&&(r.value=""+d):r.value!==""+d&&(r.value=""+d);else if(g==="submit"||g==="reset"){r.removeAttribute("value");return}s.hasOwnProperty("value")?re(r,s.type,d):s.hasOwnProperty("defaultValue")&&re(r,s.type,ae(s.defaultValue)),s.checked==null&&s.defaultChecked!=null&&(r.defaultChecked=!!s.defaultChecked)}function H(r,s,d){if(s.hasOwnProperty("value")||s.hasOwnProperty("defaultValue")){var g=s.type;if(!(g!=="submit"&&g!=="reset"||s.value!==void 0&&s.value!==null))return;s=""+r._wrapperState.initialValue,d||s===r.value||(r.value=s),r.defaultValue=s}d=r.name,d!==""&&(r.name=""),r.defaultChecked=!!r._wrapperState.initialChecked,d!==""&&(r.name=d)}function re(r,s,d){(s!=="number"||De(r.ownerDocument)!==r)&&(d==null?r.defaultValue=""+r._wrapperState.initialValue:r.defaultValue!==""+d&&(r.defaultValue=""+d))}var Te=Array.isArray;function _e(r,s,d,g){if(r=r.options,s){s={};for(var w=0;w<d.length;w++)s["$"+d[w]]=!0;for(d=0;d<r.length;d++)w=s.hasOwnProperty("$"+r[d].value),r[d].selected!==w&&(r[d].selected=w),w&&g&&(r[d].defaultSelected=!0)}else{for(d=""+ae(d),s=null,w=0;w<r.length;w++){if(r[w].value===d){r[w].selected=!0,g&&(r[w].defaultSelected=!0);return}s!==null||r[w].disabled||(s=r[w])}s!==null&&(s.selected=!0)}}function me(r,s){if(s.dangerouslySetInnerHTML!=null)throw Error(n(91));return q({},s,{value:void 0,defaultValue:void 0,children:""+r._wrapperState.initialValue})}function Le(r,s){var d=s.value;if(d==null){if(d=s.children,s=s.defaultValue,d!=null){if(s!=null)throw Error(n(92));if(Te(d)){if(1<d.length)throw Error(n(93));d=d[0]}s=d}s==null&&(s=""),d=s}r._wrapperState={initialValue:ae(d)}}function Oe(r,s){var d=ae(s.value),g=ae(s.defaultValue);d!=null&&(d=""+d,d!==r.value&&(r.value=d),s.defaultValue==null&&r.defaultValue!==d&&(r.defaultValue=d)),g!=null&&(r.defaultValue=""+g)}function Fe(r){var s=r.textContent;s===r._wrapperState.initialValue&&s!==""&&s!==null&&(r.value=s)}function Ve(r){switch(r){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function at(r,s){return r==null||r==="http://www.w3.org/1999/xhtml"?Ve(s):r==="http://www.w3.org/2000/svg"&&s==="foreignObject"?"http://www.w3.org/1999/xhtml":r}var et,Nt=function(r){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(s,d,g,w){MSApp.execUnsafeLocalFunction(function(){return r(s,d,g,w)})}:r}(function(r,s){if(r.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in r)r.innerHTML=s;else{for(et=et||document.createElement("div"),et.innerHTML="<svg>"+s.valueOf().toString()+"</svg>",s=et.firstChild;r.firstChild;)r.removeChild(r.firstChild);for(;s.firstChild;)r.appendChild(s.firstChild)}});function kt(r,s){if(s){var d=r.firstChild;if(d&&d===r.lastChild&&d.nodeType===3){d.nodeValue=s;return}}r.textContent=s}var pt={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Qt=["Webkit","ms","Moz","O"];Object.keys(pt).forEach(function(r){Qt.forEach(function(s){s=s+r.charAt(0).toUpperCase()+r.substring(1),pt[s]=pt[r]})});function Ct(r,s,d){return s==null||typeof s=="boolean"||s===""?"":d||typeof s!="number"||s===0||pt.hasOwnProperty(r)&&pt[r]?(""+s).trim():s+"px"}function jn(r,s){r=r.style;for(var d in s)if(s.hasOwnProperty(d)){var g=d.indexOf("--")===0,w=Ct(d,s[d],g);d==="float"&&(d="cssFloat"),g?r.setProperty(d,w):r[d]=w}}var wr=q({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Gt(r,s){if(s){if(wr[r]&&(s.children!=null||s.dangerouslySetInnerHTML!=null))throw Error(n(137,r));if(s.dangerouslySetInnerHTML!=null){if(s.children!=null)throw Error(n(60));if(typeof s.dangerouslySetInnerHTML!="object"||!("__html"in s.dangerouslySetInnerHTML))throw Error(n(61))}if(s.style!=null&&typeof s.style!="object")throw Error(n(62))}}function qn(r,s){if(r.indexOf("-")===-1)return typeof s.is=="string";switch(r){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var ot=null;function ir(r){return r=r.target||r.srcElement||window,r.correspondingUseElement&&(r=r.correspondingUseElement),r.nodeType===3?r.parentNode:r}var yn=null,Kt=null,$t=null;function Yn(r){if(r=Js(r)){if(typeof yn!="function")throw Error(n(280));var s=r.stateNode;s&&(s=$i(s),yn(r.stateNode,r.type,s))}}function ze(r){Kt?$t?$t.push(r):$t=[r]:Kt=r}function Je(){if(Kt){var r=Kt,s=$t;if($t=Kt=null,Yn(r),s)for(r=0;r<s.length;r++)Yn(s[r])}}function Ee(r,s){return r(s)}function st(){}var Xe=!1;function dt(r,s,d){if(Xe)return r(s,d);Xe=!0;try{return Ee(r,s,d)}finally{Xe=!1,(Kt!==null||$t!==null)&&(st(),Je())}}function It(r,s){var d=r.stateNode;if(d===null)return null;var g=$i(d);if(g===null)return null;d=g[s];e:switch(s){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(g=!g.disabled)||(r=r.type,g=!(r==="button"||r==="input"||r==="select"||r==="textarea")),r=!g;break e;default:r=!1}if(r)return null;if(d&&typeof d!="function")throw Error(n(231,s,typeof d));return d}var Zt=!1;if(m)try{var Tt={};Object.defineProperty(Tt,"passive",{get:function(){Zt=!0}}),window.addEventListener("test",Tt,Tt),window.removeEventListener("test",Tt,Tt)}catch{Zt=!1}function Bt(r,s,d,g,w,_,U,ee,ie){var we=Array.prototype.slice.call(arguments,3);try{s.apply(d,we)}catch(Pe){this.onError(Pe)}}var ht=!1,ar=null,rn=!1,Ho=null,Ci={onError:function(r){ht=!0,ar=r}};function tl(r,s,d,g,w,_,U,ee,ie){ht=!1,ar=null,Bt.apply(Ci,arguments)}function on(r,s,d,g,w,_,U,ee,ie){if(tl.apply(this,arguments),ht){if(ht){var we=ar;ht=!1,ar=null}else throw Error(n(198));rn||(rn=!0,Ho=we)}}function lr(r){var s=r,d=r;if(r.alternate)for(;s.return;)s=s.return;else{r=s;do s=r,(s.flags&4098)!==0&&(d=s.return),r=s.return;while(r)}return s.tag===3?d:null}function Si(r){if(r.tag===13){var s=r.memoizedState;if(s===null&&(r=r.alternate,r!==null&&(s=r.memoizedState)),s!==null)return s.dehydrated}return null}function Wo(r){if(lr(r)!==r)throw Error(n(188))}function ki(r){var s=r.alternate;if(!s){if(s=lr(r),s===null)throw Error(n(188));return s!==r?null:r}for(var d=r,g=s;;){var w=d.return;if(w===null)break;var _=w.alternate;if(_===null){if(g=w.return,g!==null){d=g;continue}break}if(w.child===_.child){for(_=w.child;_;){if(_===d)return Wo(w),r;if(_===g)return Wo(w),s;_=_.sibling}throw Error(n(188))}if(d.return!==g.return)d=w,g=_;else{for(var U=!1,ee=w.child;ee;){if(ee===d){U=!0,d=w,g=_;break}if(ee===g){U=!0,g=w,d=_;break}ee=ee.sibling}if(!U){for(ee=_.child;ee;){if(ee===d){U=!0,d=_,g=w;break}if(ee===g){U=!0,g=_,d=w;break}ee=ee.sibling}if(!U)throw Error(n(189))}}if(d.alternate!==g)throw Error(n(190))}if(d.tag!==3)throw Error(n(188));return d.stateNode.current===d?r:s}function lo(r){return r=ki(r),r!==null?In(r):null}function In(r){if(r.tag===5||r.tag===6)return r;for(r=r.child;r!==null;){var s=In(r);if(s!==null)return s;r=r.sibling}return null}var uo=e.unstable_scheduleCallback,Jo=e.unstable_cancelCallback,Ti=e.unstable_shouldYield,_i=e.unstable_requestPaint,Pt=e.unstable_now,co=e.unstable_getCurrentPriorityLevel,Yo=e.unstable_ImmediatePriority,fo=e.unstable_UserBlockingPriority,mo=e.unstable_NormalPriority,Lr=e.unstable_LowPriority,Qo=e.unstable_IdlePriority,po=null,An=null;function Ei(r){if(An&&typeof An.onCommitFiberRoot=="function")try{An.onCommitFiberRoot(po,r,void 0,(r.current.flags&128)===128)}catch{}}var Dn=Math.clz32?Math.clz32:ho,bi=Math.log,Ni=Math.LN2;function ho(r){return r>>>=0,r===0?32:31-(bi(r)/Ni|0)|0}var go=64,Et=4194304;function Qn(r){switch(r&-r){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return r&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return r&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return r}}function Ur(r,s){var d=r.pendingLanes;if(d===0)return 0;var g=0,w=r.suspendedLanes,_=r.pingedLanes,U=d&268435455;if(U!==0){var ee=U&~w;ee!==0?g=Qn(ee):(_&=U,_!==0&&(g=Qn(_)))}else U=d&~w,U!==0?g=Qn(U):_!==0&&(g=Qn(_));if(g===0)return 0;if(s!==0&&s!==g&&(s&w)===0&&(w=g&-g,_=s&-s,w>=_||w===16&&(_&4194240)!==0))return s;if((g&4)!==0&&(g|=d&16),s=r.entangledLanes,s!==0)for(r=r.entanglements,s&=g;0<s;)d=31-Dn(s),w=1<<d,g|=r[d],s&=~w;return g}function Cr(r,s){switch(r){case 1:case 2:case 4:return s+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return s+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Ko(r,s){for(var d=r.suspendedLanes,g=r.pingedLanes,w=r.expirationTimes,_=r.pendingLanes;0<_;){var U=31-Dn(_),ee=1<<U,ie=w[U];ie===-1?((ee&d)===0||(ee&g)!==0)&&(w[U]=Cr(ee,s)):ie<=s&&(r.expiredLanes|=ee),_&=~ee}}function jr(r){return r=r.pendingLanes&-1073741825,r!==0?r:r&1073741824?1073741824:0}function yo(){var r=go;return go<<=1,(go&4194240)===0&&(go=64),r}function Sr(r){for(var s=[],d=0;31>d;d++)s.push(r);return s}function vo(r,s,d){r.pendingLanes|=s,s!==536870912&&(r.suspendedLanes=0,r.pingedLanes=0),r=r.eventTimes,s=31-Dn(s),r[s]=d}function nl(r,s){var d=r.pendingLanes&~s;r.pendingLanes=s,r.suspendedLanes=0,r.pingedLanes=0,r.expiredLanes&=s,r.mutableReadLanes&=s,r.entangledLanes&=s,s=r.entanglements;var g=r.eventTimes;for(r=r.expirationTimes;0<d;){var w=31-Dn(d),_=1<<w;s[w]=0,g[w]=-1,r[w]=-1,d&=~_}}function Zo(r,s){var d=r.entangledLanes|=s;for(r=r.entanglements;d;){var g=31-Dn(d),w=1<<g;w&s|r[g]&s&&(r[g]|=s),d&=~w}}var xt=0;function Rs(r){return r&=-r,1<r?4<r?(r&268435455)!==0?16:536870912:4:1}var Xo,xo,Ii,wo,Co,Kn=!1,qr=[],Xt=null,vn=null,Mn=null,zr=new Map,So=new Map,He=[],Ai="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function ko(r,s){switch(r){case"focusin":case"focusout":Xt=null;break;case"dragenter":case"dragleave":vn=null;break;case"mouseover":case"mouseout":Mn=null;break;case"pointerover":case"pointerout":zr.delete(s.pointerId);break;case"gotpointercapture":case"lostpointercapture":So.delete(s.pointerId)}}function ur(r,s,d,g,w,_){return r===null||r.nativeEvent!==_?(r={blockedOn:s,domEventName:d,eventSystemFlags:g,nativeEvent:_,targetContainers:[w]},s!==null&&(s=Js(s),s!==null&&xo(s)),r):(r.eventSystemFlags|=g,s=r.targetContainers,w!==null&&s.indexOf(w)===-1&&s.push(w),r)}function Di(r,s,d,g,w){switch(s){case"focusin":return Xt=ur(Xt,r,s,d,g,w),!0;case"dragenter":return vn=ur(vn,r,s,d,g,w),!0;case"mouseover":return Mn=ur(Mn,r,s,d,g,w),!0;case"pointerover":var _=w.pointerId;return zr.set(_,ur(zr.get(_)||null,r,s,d,g,w)),!0;case"gotpointercapture":return _=w.pointerId,So.set(_,ur(So.get(_)||null,r,s,d,g,w)),!0}return!1}function Or(r){var s=No(r.target);if(s!==null){var d=lr(s);if(d!==null){if(s=d.tag,s===13){if(s=Si(d),s!==null){r.blockedOn=s,Co(r.priority,function(){Ii(d)});return}}else if(s===3&&d.stateNode.current.memoizedState.isDehydrated){r.blockedOn=d.tag===3?d.stateNode.containerInfo:null;return}}}r.blockedOn=null}function cr(r){if(r.blockedOn!==null)return!1;for(var s=r.targetContainers;0<s.length;){var d=rt(r.domEventName,r.eventSystemFlags,s[0],r.nativeEvent);if(d===null){d=r.nativeEvent;var g=new d.constructor(d.type,d);ot=g,d.target.dispatchEvent(g),ot=null}else return s=Js(d),s!==null&&xo(s),r.blockedOn=d,!1;s.shift()}return!0}function Zn(r,s,d){cr(r)&&d.delete(s)}function es(){Kn=!1,Xt!==null&&cr(Xt)&&(Xt=null),vn!==null&&cr(vn)&&(vn=null),Mn!==null&&cr(Mn)&&(Mn=null),zr.forEach(Zn),So.forEach(Zn)}function Br(r,s){r.blockedOn===s&&(r.blockedOn=null,Kn||(Kn=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,es)))}function y(r){function s(w){return Br(w,r)}if(0<qr.length){Br(qr[0],r);for(var d=1;d<qr.length;d++){var g=qr[d];g.blockedOn===r&&(g.blockedOn=null)}}for(Xt!==null&&Br(Xt,r),vn!==null&&Br(vn,r),Mn!==null&&Br(Mn,r),zr.forEach(s),So.forEach(s),d=0;d<He.length;d++)g=He[d],g.blockedOn===r&&(g.blockedOn=null);for(;0<He.length&&(d=He[0],d.blockedOn===null);)Or(d),d.blockedOn===null&&He.shift()}var k=R.ReactCurrentBatchConfig,I=!0;function z(r,s,d,g){var w=xt,_=k.transition;k.transition=null;try{xt=1,Ce(r,s,d,g)}finally{xt=w,k.transition=_}}function ne(r,s,d,g){var w=xt,_=k.transition;k.transition=null;try{xt=4,Ce(r,s,d,g)}finally{xt=w,k.transition=_}}function Ce(r,s,d,g){if(I){var w=rt(r,s,d,g);if(w===null)bl(r,s,g,Ie,d),ko(r,g);else if(Di(w,r,s,d,g))g.stopPropagation();else if(ko(r,g),s&4&&-1<Ai.indexOf(r)){for(;w!==null;){var _=Js(w);if(_!==null&&Xo(_),_=rt(r,s,d,g),_===null&&bl(r,s,g,Ie,d),_===w)break;w=_}w!==null&&g.stopPropagation()}else bl(r,s,g,null,d)}}var Ie=null;function rt(r,s,d,g){if(Ie=null,r=ir(g),r=No(r),r!==null)if(s=lr(r),s===null)r=null;else if(d=s.tag,d===13){if(r=Si(s),r!==null)return r;r=null}else if(d===3){if(s.stateNode.current.memoizedState.isDehydrated)return s.tag===3?s.stateNode.containerInfo:null;r=null}else s!==r&&(r=null);return Ie=r,null}function gt(r){switch(r){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(co()){case Yo:return 1;case fo:return 4;case mo:case Lr:return 16;case Qo:return 536870912;default:return 16}default:return 16}}var it=null,Ft=null,Ut=null;function Ps(){if(Ut)return Ut;var r,s=Ft,d=s.length,g,w="value"in it?it.value:it.textContent,_=w.length;for(r=0;r<d&&s[r]===w[r];r++);var U=d-r;for(g=1;g<=U&&s[d-g]===w[_-g];g++);return Ut=w.slice(r,1<g?1-g:void 0)}function ts(r){var s=r.keyCode;return"charCode"in r?(r=r.charCode,r===0&&s===13&&(r=13)):r=s,r===10&&(r=13),32<=r||r===13?r:0}function To(){return!0}function Mi(){return!1}function un(r){function s(d,g,w,_,U){this._reactName=d,this._targetInst=w,this.type=g,this.nativeEvent=_,this.target=U,this.currentTarget=null;for(var ee in r)r.hasOwnProperty(ee)&&(d=r[ee],this[ee]=d?d(_):_[ee]);return this.isDefaultPrevented=(_.defaultPrevented!=null?_.defaultPrevented:_.returnValue===!1)?To:Mi,this.isPropagationStopped=Mi,this}return q(s.prototype,{preventDefault:function(){this.defaultPrevented=!0;var d=this.nativeEvent;d&&(d.preventDefault?d.preventDefault():typeof d.returnValue!="unknown"&&(d.returnValue=!1),this.isDefaultPrevented=To)},stopPropagation:function(){var d=this.nativeEvent;d&&(d.stopPropagation?d.stopPropagation():typeof d.cancelBubble!="unknown"&&(d.cancelBubble=!0),this.isPropagationStopped=To)},persist:function(){},isPersistent:To}),s}var Vr={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(r){return r.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Fs=un(Vr),_o=q({},Vr,{view:0,detail:0}),rl=un(_o),Ls,Us,Eo,ns=q({},_o,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:rs,button:0,buttons:0,relatedTarget:function(r){return r.relatedTarget===void 0?r.fromElement===r.srcElement?r.toElement:r.fromElement:r.relatedTarget},movementX:function(r){return"movementX"in r?r.movementX:(r!==Eo&&(Eo&&r.type==="mousemove"?(Ls=r.screenX-Eo.screenX,Us=r.screenY-Eo.screenY):Us=Ls=0,Eo=r),Ls)},movementY:function(r){return"movementY"in r?r.movementY:Us}}),js=un(ns),ol=q({},ns,{dataTransfer:0}),sl=un(ol),il=q({},_o,{relatedTarget:0}),qs=un(il),al=q({},Vr,{animationName:0,elapsedTime:0,pseudoElement:0}),ll=un(al),ul=q({},Vr,{clipboardData:function(r){return"clipboardData"in r?r.clipboardData:window.clipboardData}}),Ri=un(ul),cl=q({},Vr,{data:0}),Pi=un(cl),dl={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},fl={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},ml={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function pl(r){var s=this.nativeEvent;return s.getModifierState?s.getModifierState(r):(r=ml[r])?!!s[r]:!1}function rs(){return pl}var hl=q({},_o,{key:function(r){if(r.key){var s=dl[r.key]||r.key;if(s!=="Unidentified")return s}return r.type==="keypress"?(r=ts(r),r===13?"Enter":String.fromCharCode(r)):r.type==="keydown"||r.type==="keyup"?fl[r.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:rs,charCode:function(r){return r.type==="keypress"?ts(r):0},keyCode:function(r){return r.type==="keydown"||r.type==="keyup"?r.keyCode:0},which:function(r){return r.type==="keypress"?ts(r):r.type==="keydown"||r.type==="keyup"?r.keyCode:0}}),gl=un(hl),yl=q({},ns,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),bo=un(yl),Fi=q({},_o,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:rs}),Li=un(Fi),ge=q({},Vr,{propertyName:0,elapsedTime:0,pseudoElement:0}),Me=un(ge),Ke=q({},ns,{deltaX:function(r){return"deltaX"in r?r.deltaX:"wheelDeltaX"in r?-r.wheelDeltaX:0},deltaY:function(r){return"deltaY"in r?r.deltaY:"wheelDeltaY"in r?-r.wheelDeltaY:"wheelDelta"in r?-r.wheelDelta:0},deltaZ:0,deltaMode:0}),lt=un(Ke),ct=[9,13,27,32],bt=m&&"CompositionEvent"in window,sn=null;m&&"documentMode"in document&&(sn=document.documentMode);var Cn=m&&"TextEvent"in window&&!sn,cn=m&&(!bt||sn&&8<sn&&11>=sn),Sn=" ",os=!1;function dr(r,s){switch(r){case"keyup":return ct.indexOf(s.keyCode)!==-1;case"keydown":return s.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Ui(r){return r=r.detail,typeof r=="object"&&"data"in r?r.data:null}var ss=!1;function bh(r,s){switch(r){case"compositionend":return Ui(s);case"keypress":return s.which!==32?null:(os=!0,Sn);case"textInput":return r=s.data,r===Sn&&os?null:r;default:return null}}function Nh(r,s){if(ss)return r==="compositionend"||!bt&&dr(r,s)?(r=Ps(),Ut=Ft=it=null,ss=!1,r):null;switch(r){case"paste":return null;case"keypress":if(!(s.ctrlKey||s.altKey||s.metaKey)||s.ctrlKey&&s.altKey){if(s.char&&1<s.char.length)return s.char;if(s.which)return String.fromCharCode(s.which)}return null;case"compositionend":return cn&&s.locale!=="ko"?null:s.data;default:return null}}var Ih={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Pc(r){var s=r&&r.nodeName&&r.nodeName.toLowerCase();return s==="input"?!!Ih[r.type]:s==="textarea"}function Fc(r,s,d,g){ze(g),s=Bi(s,"onChange"),0<s.length&&(d=new Fs("onChange","change",null,d,g),r.push({event:d,listeners:s}))}var zs=null,Os=null;function Ah(r){Xc(r,0)}function ji(r){var s=cs(r);if(je(s))return r}function Dh(r,s){if(r==="change")return s}var Lc=!1;if(m){var vl;if(m){var xl="oninput"in document;if(!xl){var Uc=document.createElement("div");Uc.setAttribute("oninput","return;"),xl=typeof Uc.oninput=="function"}vl=xl}else vl=!1;Lc=vl&&(!document.documentMode||9<document.documentMode)}function jc(){zs&&(zs.detachEvent("onpropertychange",qc),Os=zs=null)}function qc(r){if(r.propertyName==="value"&&ji(Os)){var s=[];Fc(s,Os,r,ir(r)),dt(Ah,s)}}function Mh(r,s,d){r==="focusin"?(jc(),zs=s,Os=d,zs.attachEvent("onpropertychange",qc)):r==="focusout"&&jc()}function Rh(r){if(r==="selectionchange"||r==="keyup"||r==="keydown")return ji(Os)}function Ph(r,s){if(r==="click")return ji(s)}function Fh(r,s){if(r==="input"||r==="change")return ji(s)}function Lh(r,s){return r===s&&(r!==0||1/r===1/s)||r!==r&&s!==s}var Xn=typeof Object.is=="function"?Object.is:Lh;function Bs(r,s){if(Xn(r,s))return!0;if(typeof r!="object"||r===null||typeof s!="object"||s===null)return!1;var d=Object.keys(r),g=Object.keys(s);if(d.length!==g.length)return!1;for(g=0;g<d.length;g++){var w=d[g];if(!h.call(s,w)||!Xn(r[w],s[w]))return!1}return!0}function zc(r){for(;r&&r.firstChild;)r=r.firstChild;return r}function Oc(r,s){var d=zc(r);r=0;for(var g;d;){if(d.nodeType===3){if(g=r+d.textContent.length,r<=s&&g>=s)return{node:d,offset:s-r};r=g}e:{for(;d;){if(d.nextSibling){d=d.nextSibling;break e}d=d.parentNode}d=void 0}d=zc(d)}}function Bc(r,s){return r&&s?r===s?!0:r&&r.nodeType===3?!1:s&&s.nodeType===3?Bc(r,s.parentNode):"contains"in r?r.contains(s):r.compareDocumentPosition?!!(r.compareDocumentPosition(s)&16):!1:!1}function Vc(){for(var r=window,s=De();s instanceof r.HTMLIFrameElement;){try{var d=typeof s.contentWindow.location.href=="string"}catch{d=!1}if(d)r=s.contentWindow;else break;s=De(r.document)}return s}function wl(r){var s=r&&r.nodeName&&r.nodeName.toLowerCase();return s&&(s==="input"&&(r.type==="text"||r.type==="search"||r.type==="tel"||r.type==="url"||r.type==="password")||s==="textarea"||r.contentEditable==="true")}function Uh(r){var s=Vc(),d=r.focusedElem,g=r.selectionRange;if(s!==d&&d&&d.ownerDocument&&Bc(d.ownerDocument.documentElement,d)){if(g!==null&&wl(d)){if(s=g.start,r=g.end,r===void 0&&(r=s),"selectionStart"in d)d.selectionStart=s,d.selectionEnd=Math.min(r,d.value.length);else if(r=(s=d.ownerDocument||document)&&s.defaultView||window,r.getSelection){r=r.getSelection();var w=d.textContent.length,_=Math.min(g.start,w);g=g.end===void 0?_:Math.min(g.end,w),!r.extend&&_>g&&(w=g,g=_,_=w),w=Oc(d,_);var U=Oc(d,g);w&&U&&(r.rangeCount!==1||r.anchorNode!==w.node||r.anchorOffset!==w.offset||r.focusNode!==U.node||r.focusOffset!==U.offset)&&(s=s.createRange(),s.setStart(w.node,w.offset),r.removeAllRanges(),_>g?(r.addRange(s),r.extend(U.node,U.offset)):(s.setEnd(U.node,U.offset),r.addRange(s)))}}for(s=[],r=d;r=r.parentNode;)r.nodeType===1&&s.push({element:r,left:r.scrollLeft,top:r.scrollTop});for(typeof d.focus=="function"&&d.focus(),d=0;d<s.length;d++)r=s[d],r.element.scrollLeft=r.left,r.element.scrollTop=r.top}}var jh=m&&"documentMode"in document&&11>=document.documentMode,is=null,Cl=null,Vs=null,Sl=!1;function Gc(r,s,d){var g=d.window===d?d.document:d.nodeType===9?d:d.ownerDocument;Sl||is==null||is!==De(g)||(g=is,"selectionStart"in g&&wl(g)?g={start:g.selectionStart,end:g.selectionEnd}:(g=(g.ownerDocument&&g.ownerDocument.defaultView||window).getSelection(),g={anchorNode:g.anchorNode,anchorOffset:g.anchorOffset,focusNode:g.focusNode,focusOffset:g.focusOffset}),Vs&&Bs(Vs,g)||(Vs=g,g=Bi(Cl,"onSelect"),0<g.length&&(s=new Fs("onSelect","select",null,s,d),r.push({event:s,listeners:g}),s.target=is)))}function qi(r,s){var d={};return d[r.toLowerCase()]=s.toLowerCase(),d["Webkit"+r]="webkit"+s,d["Moz"+r]="moz"+s,d}var as={animationend:qi("Animation","AnimationEnd"),animationiteration:qi("Animation","AnimationIteration"),animationstart:qi("Animation","AnimationStart"),transitionend:qi("Transition","TransitionEnd")},kl={},$c={};m&&($c=document.createElement("div").style,"AnimationEvent"in window||(delete as.animationend.animation,delete as.animationiteration.animation,delete as.animationstart.animation),"TransitionEvent"in window||delete as.transitionend.transition);function zi(r){if(kl[r])return kl[r];if(!as[r])return r;var s=as[r],d;for(d in s)if(s.hasOwnProperty(d)&&d in $c)return kl[r]=s[d];return r}var Hc=zi("animationend"),Wc=zi("animationiteration"),Jc=zi("animationstart"),Yc=zi("transitionend"),Qc=new Map,Kc="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Gr(r,s){Qc.set(r,s),c(s,[r])}for(var Tl=0;Tl<Kc.length;Tl++){var _l=Kc[Tl],qh=_l.toLowerCase(),zh=_l[0].toUpperCase()+_l.slice(1);Gr(qh,"on"+zh)}Gr(Hc,"onAnimationEnd"),Gr(Wc,"onAnimationIteration"),Gr(Jc,"onAnimationStart"),Gr("dblclick","onDoubleClick"),Gr("focusin","onFocus"),Gr("focusout","onBlur"),Gr(Yc,"onTransitionEnd"),f("onMouseEnter",["mouseout","mouseover"]),f("onMouseLeave",["mouseout","mouseover"]),f("onPointerEnter",["pointerout","pointerover"]),f("onPointerLeave",["pointerout","pointerover"]),c("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),c("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),c("onBeforeInput",["compositionend","keypress","textInput","paste"]),c("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),c("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),c("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Gs="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Oh=new Set("cancel close invalid load scroll toggle".split(" ").concat(Gs));function Zc(r,s,d){var g=r.type||"unknown-event";r.currentTarget=d,on(g,s,void 0,r),r.currentTarget=null}function Xc(r,s){s=(s&4)!==0;for(var d=0;d<r.length;d++){var g=r[d],w=g.event;g=g.listeners;e:{var _=void 0;if(s)for(var U=g.length-1;0<=U;U--){var ee=g[U],ie=ee.instance,we=ee.currentTarget;if(ee=ee.listener,ie!==_&&w.isPropagationStopped())break e;Zc(w,ee,we),_=ie}else for(U=0;U<g.length;U++){if(ee=g[U],ie=ee.instance,we=ee.currentTarget,ee=ee.listener,ie!==_&&w.isPropagationStopped())break e;Zc(w,ee,we),_=ie}}}if(rn)throw r=Ho,rn=!1,Ho=null,r}function Dt(r,s){var d=s[Rl];d===void 0&&(d=s[Rl]=new Set);var g=r+"__bubble";d.has(g)||(ed(s,r,2,!1),d.add(g))}function El(r,s,d){var g=0;s&&(g|=4),ed(d,r,g,s)}var Oi="_reactListening"+Math.random().toString(36).slice(2);function $s(r){if(!r[Oi]){r[Oi]=!0,o.forEach(function(d){d!=="selectionchange"&&(Oh.has(d)||El(d,!1,r),El(d,!0,r))});var s=r.nodeType===9?r:r.ownerDocument;s===null||s[Oi]||(s[Oi]=!0,El("selectionchange",!1,s))}}function ed(r,s,d,g){switch(gt(s)){case 1:var w=z;break;case 4:w=ne;break;default:w=Ce}d=w.bind(null,s,d,r),w=void 0,!Zt||s!=="touchstart"&&s!=="touchmove"&&s!=="wheel"||(w=!0),g?w!==void 0?r.addEventListener(s,d,{capture:!0,passive:w}):r.addEventListener(s,d,!0):w!==void 0?r.addEventListener(s,d,{passive:w}):r.addEventListener(s,d,!1)}function bl(r,s,d,g,w){var _=g;if((s&1)===0&&(s&2)===0&&g!==null)e:for(;;){if(g===null)return;var U=g.tag;if(U===3||U===4){var ee=g.stateNode.containerInfo;if(ee===w||ee.nodeType===8&&ee.parentNode===w)break;if(U===4)for(U=g.return;U!==null;){var ie=U.tag;if((ie===3||ie===4)&&(ie=U.stateNode.containerInfo,ie===w||ie.nodeType===8&&ie.parentNode===w))return;U=U.return}for(;ee!==null;){if(U=No(ee),U===null)return;if(ie=U.tag,ie===5||ie===6){g=_=U;continue e}ee=ee.parentNode}}g=g.return}dt(function(){var we=_,Pe=ir(d),Ue=[];e:{var Re=Qc.get(r);if(Re!==void 0){var Be=Fs,$e=r;switch(r){case"keypress":if(ts(d)===0)break e;case"keydown":case"keyup":Be=gl;break;case"focusin":$e="focus",Be=qs;break;case"focusout":$e="blur",Be=qs;break;case"beforeblur":case"afterblur":Be=qs;break;case"click":if(d.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Be=js;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Be=sl;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Be=Li;break;case Hc:case Wc:case Jc:Be=ll;break;case Yc:Be=Me;break;case"scroll":Be=rl;break;case"wheel":Be=lt;break;case"copy":case"cut":case"paste":Be=Ri;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Be=bo}var Ye=(s&4)!==0,Vt=!Ye&&r==="scroll",he=Ye?Re!==null?Re+"Capture":null:Re;Ye=[];for(var ue=we,ye;ue!==null;){ye=ue;var qe=ye.stateNode;if(ye.tag===5&&qe!==null&&(ye=qe,he!==null&&(qe=It(ue,he),qe!=null&&Ye.push(Hs(ue,qe,ye)))),Vt)break;ue=ue.return}0<Ye.length&&(Re=new Be(Re,$e,null,d,Pe),Ue.push({event:Re,listeners:Ye}))}}if((s&7)===0){e:{if(Re=r==="mouseover"||r==="pointerover",Be=r==="mouseout"||r==="pointerout",Re&&d!==ot&&($e=d.relatedTarget||d.fromElement)&&(No($e)||$e[kr]))break e;if((Be||Re)&&(Re=Pe.window===Pe?Pe:(Re=Pe.ownerDocument)?Re.defaultView||Re.parentWindow:window,Be?($e=d.relatedTarget||d.toElement,Be=we,$e=$e?No($e):null,$e!==null&&(Vt=lr($e),$e!==Vt||$e.tag!==5&&$e.tag!==6)&&($e=null)):(Be=null,$e=we),Be!==$e)){if(Ye=js,qe="onMouseLeave",he="onMouseEnter",ue="mouse",(r==="pointerout"||r==="pointerover")&&(Ye=bo,qe="onPointerLeave",he="onPointerEnter",ue="pointer"),Vt=Be==null?Re:cs(Be),ye=$e==null?Re:cs($e),Re=new Ye(qe,ue+"leave",Be,d,Pe),Re.target=Vt,Re.relatedTarget=ye,qe=null,No(Pe)===we&&(Ye=new Ye(he,ue+"enter",$e,d,Pe),Ye.target=ye,Ye.relatedTarget=Vt,qe=Ye),Vt=qe,Be&&$e)t:{for(Ye=Be,he=$e,ue=0,ye=Ye;ye;ye=ls(ye))ue++;for(ye=0,qe=he;qe;qe=ls(qe))ye++;for(;0<ue-ye;)Ye=ls(Ye),ue--;for(;0<ye-ue;)he=ls(he),ye--;for(;ue--;){if(Ye===he||he!==null&&Ye===he.alternate)break t;Ye=ls(Ye),he=ls(he)}Ye=null}else Ye=null;Be!==null&&td(Ue,Re,Be,Ye,!1),$e!==null&&Vt!==null&&td(Ue,Vt,$e,Ye,!0)}}e:{if(Re=we?cs(we):window,Be=Re.nodeName&&Re.nodeName.toLowerCase(),Be==="select"||Be==="input"&&Re.type==="file")var Ze=Dh;else if(Pc(Re))if(Lc)Ze=Fh;else{Ze=Rh;var tt=Mh}else(Be=Re.nodeName)&&Be.toLowerCase()==="input"&&(Re.type==="checkbox"||Re.type==="radio")&&(Ze=Ph);if(Ze&&(Ze=Ze(r,we))){Fc(Ue,Ze,d,Pe);break e}tt&&tt(r,Re,we),r==="focusout"&&(tt=Re._wrapperState)&&tt.controlled&&Re.type==="number"&&re(Re,"number",Re.value)}switch(tt=we?cs(we):window,r){case"focusin":(Pc(tt)||tt.contentEditable==="true")&&(is=tt,Cl=we,Vs=null);break;case"focusout":Vs=Cl=is=null;break;case"mousedown":Sl=!0;break;case"contextmenu":case"mouseup":case"dragend":Sl=!1,Gc(Ue,d,Pe);break;case"selectionchange":if(jh)break;case"keydown":case"keyup":Gc(Ue,d,Pe)}var nt;if(bt)e:{switch(r){case"compositionstart":var ut="onCompositionStart";break e;case"compositionend":ut="onCompositionEnd";break e;case"compositionupdate":ut="onCompositionUpdate";break e}ut=void 0}else ss?dr(r,d)&&(ut="onCompositionEnd"):r==="keydown"&&d.keyCode===229&&(ut="onCompositionStart");ut&&(cn&&d.locale!=="ko"&&(ss||ut!=="onCompositionStart"?ut==="onCompositionEnd"&&ss&&(nt=Ps()):(it=Pe,Ft="value"in it?it.value:it.textContent,ss=!0)),tt=Bi(we,ut),0<tt.length&&(ut=new Pi(ut,r,null,d,Pe),Ue.push({event:ut,listeners:tt}),nt?ut.data=nt:(nt=Ui(d),nt!==null&&(ut.data=nt)))),(nt=Cn?bh(r,d):Nh(r,d))&&(we=Bi(we,"onBeforeInput"),0<we.length&&(Pe=new Pi("onBeforeInput","beforeinput",null,d,Pe),Ue.push({event:Pe,listeners:we}),Pe.data=nt))}Xc(Ue,s)})}function Hs(r,s,d){return{instance:r,listener:s,currentTarget:d}}function Bi(r,s){for(var d=s+"Capture",g=[];r!==null;){var w=r,_=w.stateNode;w.tag===5&&_!==null&&(w=_,_=It(r,d),_!=null&&g.unshift(Hs(r,_,w)),_=It(r,s),_!=null&&g.push(Hs(r,_,w))),r=r.return}return g}function ls(r){if(r===null)return null;do r=r.return;while(r&&r.tag!==5);return r||null}function td(r,s,d,g,w){for(var _=s._reactName,U=[];d!==null&&d!==g;){var ee=d,ie=ee.alternate,we=ee.stateNode;if(ie!==null&&ie===g)break;ee.tag===5&&we!==null&&(ee=we,w?(ie=It(d,_),ie!=null&&U.unshift(Hs(d,ie,ee))):w||(ie=It(d,_),ie!=null&&U.push(Hs(d,ie,ee)))),d=d.return}U.length!==0&&r.push({event:s,listeners:U})}var Bh=/\r\n?/g,Vh=/\u0000|\uFFFD/g;function nd(r){return(typeof r=="string"?r:""+r).replace(Bh,`
`).replace(Vh,"")}function Vi(r,s,d){if(s=nd(s),nd(r)!==s&&d)throw Error(n(425))}function Gi(){}var Nl=null,Il=null;function Al(r,s){return r==="textarea"||r==="noscript"||typeof s.children=="string"||typeof s.children=="number"||typeof s.dangerouslySetInnerHTML=="object"&&s.dangerouslySetInnerHTML!==null&&s.dangerouslySetInnerHTML.__html!=null}var Dl=typeof setTimeout=="function"?setTimeout:void 0,Gh=typeof clearTimeout=="function"?clearTimeout:void 0,rd=typeof Promise=="function"?Promise:void 0,$h=typeof queueMicrotask=="function"?queueMicrotask:typeof rd<"u"?function(r){return rd.resolve(null).then(r).catch(Hh)}:Dl;function Hh(r){setTimeout(function(){throw r})}function Ml(r,s){var d=s,g=0;do{var w=d.nextSibling;if(r.removeChild(d),w&&w.nodeType===8)if(d=w.data,d==="/$"){if(g===0){r.removeChild(w),y(s);return}g--}else d!=="$"&&d!=="$?"&&d!=="$!"||g++;d=w}while(d);y(s)}function $r(r){for(;r!=null;r=r.nextSibling){var s=r.nodeType;if(s===1||s===3)break;if(s===8){if(s=r.data,s==="$"||s==="$!"||s==="$?")break;if(s==="/$")return null}}return r}function od(r){r=r.previousSibling;for(var s=0;r;){if(r.nodeType===8){var d=r.data;if(d==="$"||d==="$!"||d==="$?"){if(s===0)return r;s--}else d==="/$"&&s++}r=r.previousSibling}return null}var us=Math.random().toString(36).slice(2),fr="__reactFiber$"+us,Ws="__reactProps$"+us,kr="__reactContainer$"+us,Rl="__reactEvents$"+us,Wh="__reactListeners$"+us,Jh="__reactHandles$"+us;function No(r){var s=r[fr];if(s)return s;for(var d=r.parentNode;d;){if(s=d[kr]||d[fr]){if(d=s.alternate,s.child!==null||d!==null&&d.child!==null)for(r=od(r);r!==null;){if(d=r[fr])return d;r=od(r)}return s}r=d,d=r.parentNode}return null}function Js(r){return r=r[fr]||r[kr],!r||r.tag!==5&&r.tag!==6&&r.tag!==13&&r.tag!==3?null:r}function cs(r){if(r.tag===5||r.tag===6)return r.stateNode;throw Error(n(33))}function $i(r){return r[Ws]||null}var Pl=[],ds=-1;function Hr(r){return{current:r}}function Mt(r){0>ds||(r.current=Pl[ds],Pl[ds]=null,ds--)}function At(r,s){ds++,Pl[ds]=r.current,r.current=s}var Wr={},dn=Hr(Wr),kn=Hr(!1),Io=Wr;function fs(r,s){var d=r.type.contextTypes;if(!d)return Wr;var g=r.stateNode;if(g&&g.__reactInternalMemoizedUnmaskedChildContext===s)return g.__reactInternalMemoizedMaskedChildContext;var w={},_;for(_ in d)w[_]=s[_];return g&&(r=r.stateNode,r.__reactInternalMemoizedUnmaskedChildContext=s,r.__reactInternalMemoizedMaskedChildContext=w),w}function Tn(r){return r=r.childContextTypes,r!=null}function Hi(){Mt(kn),Mt(dn)}function sd(r,s,d){if(dn.current!==Wr)throw Error(n(168));At(dn,s),At(kn,d)}function id(r,s,d){var g=r.stateNode;if(s=s.childContextTypes,typeof g.getChildContext!="function")return d;g=g.getChildContext();for(var w in g)if(!(w in s))throw Error(n(108,se(r)||"Unknown",w));return q({},d,g)}function Wi(r){return r=(r=r.stateNode)&&r.__reactInternalMemoizedMergedChildContext||Wr,Io=dn.current,At(dn,r),At(kn,kn.current),!0}function ad(r,s,d){var g=r.stateNode;if(!g)throw Error(n(169));d?(r=id(r,s,Io),g.__reactInternalMemoizedMergedChildContext=r,Mt(kn),Mt(dn),At(dn,r)):Mt(kn),At(kn,d)}var Tr=null,Ji=!1,Fl=!1;function ld(r){Tr===null?Tr=[r]:Tr.push(r)}function Yh(r){Ji=!0,ld(r)}function Jr(){if(!Fl&&Tr!==null){Fl=!0;var r=0,s=xt;try{var d=Tr;for(xt=1;r<d.length;r++){var g=d[r];do g=g(!0);while(g!==null)}Tr=null,Ji=!1}catch(w){throw Tr!==null&&(Tr=Tr.slice(r+1)),uo(Yo,Jr),w}finally{xt=s,Fl=!1}}return null}var ms=[],ps=0,Yi=null,Qi=0,zn=[],On=0,Ao=null,_r=1,Er="";function Do(r,s){ms[ps++]=Qi,ms[ps++]=Yi,Yi=r,Qi=s}function ud(r,s,d){zn[On++]=_r,zn[On++]=Er,zn[On++]=Ao,Ao=r;var g=_r;r=Er;var w=32-Dn(g)-1;g&=~(1<<w),d+=1;var _=32-Dn(s)+w;if(30<_){var U=w-w%5;_=(g&(1<<U)-1).toString(32),g>>=U,w-=U,_r=1<<32-Dn(s)+w|d<<w|g,Er=_+r}else _r=1<<_|d<<w|g,Er=r}function Ll(r){r.return!==null&&(Do(r,1),ud(r,1,0))}function Ul(r){for(;r===Yi;)Yi=ms[--ps],ms[ps]=null,Qi=ms[--ps],ms[ps]=null;for(;r===Ao;)Ao=zn[--On],zn[On]=null,Er=zn[--On],zn[On]=null,_r=zn[--On],zn[On]=null}var Rn=null,Pn=null,Lt=!1,er=null;function cd(r,s){var d=$n(5,null,null,0);d.elementType="DELETED",d.stateNode=s,d.return=r,s=r.deletions,s===null?(r.deletions=[d],r.flags|=16):s.push(d)}function dd(r,s){switch(r.tag){case 5:var d=r.type;return s=s.nodeType!==1||d.toLowerCase()!==s.nodeName.toLowerCase()?null:s,s!==null?(r.stateNode=s,Rn=r,Pn=$r(s.firstChild),!0):!1;case 6:return s=r.pendingProps===""||s.nodeType!==3?null:s,s!==null?(r.stateNode=s,Rn=r,Pn=null,!0):!1;case 13:return s=s.nodeType!==8?null:s,s!==null?(d=Ao!==null?{id:_r,overflow:Er}:null,r.memoizedState={dehydrated:s,treeContext:d,retryLane:1073741824},d=$n(18,null,null,0),d.stateNode=s,d.return=r,r.child=d,Rn=r,Pn=null,!0):!1;default:return!1}}function jl(r){return(r.mode&1)!==0&&(r.flags&128)===0}function ql(r){if(Lt){var s=Pn;if(s){var d=s;if(!dd(r,s)){if(jl(r))throw Error(n(418));s=$r(d.nextSibling);var g=Rn;s&&dd(r,s)?cd(g,d):(r.flags=r.flags&-4097|2,Lt=!1,Rn=r)}}else{if(jl(r))throw Error(n(418));r.flags=r.flags&-4097|2,Lt=!1,Rn=r}}}function fd(r){for(r=r.return;r!==null&&r.tag!==5&&r.tag!==3&&r.tag!==13;)r=r.return;Rn=r}function Ki(r){if(r!==Rn)return!1;if(!Lt)return fd(r),Lt=!0,!1;var s;if((s=r.tag!==3)&&!(s=r.tag!==5)&&(s=r.type,s=s!=="head"&&s!=="body"&&!Al(r.type,r.memoizedProps)),s&&(s=Pn)){if(jl(r))throw md(),Error(n(418));for(;s;)cd(r,s),s=$r(s.nextSibling)}if(fd(r),r.tag===13){if(r=r.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(n(317));e:{for(r=r.nextSibling,s=0;r;){if(r.nodeType===8){var d=r.data;if(d==="/$"){if(s===0){Pn=$r(r.nextSibling);break e}s--}else d!=="$"&&d!=="$!"&&d!=="$?"||s++}r=r.nextSibling}Pn=null}}else Pn=Rn?$r(r.stateNode.nextSibling):null;return!0}function md(){for(var r=Pn;r;)r=$r(r.nextSibling)}function hs(){Pn=Rn=null,Lt=!1}function zl(r){er===null?er=[r]:er.push(r)}var Qh=R.ReactCurrentBatchConfig;function Ys(r,s,d){if(r=d.ref,r!==null&&typeof r!="function"&&typeof r!="object"){if(d._owner){if(d=d._owner,d){if(d.tag!==1)throw Error(n(309));var g=d.stateNode}if(!g)throw Error(n(147,r));var w=g,_=""+r;return s!==null&&s.ref!==null&&typeof s.ref=="function"&&s.ref._stringRef===_?s.ref:(s=function(U){var ee=w.refs;U===null?delete ee[_]:ee[_]=U},s._stringRef=_,s)}if(typeof r!="string")throw Error(n(284));if(!d._owner)throw Error(n(290,r))}return r}function Zi(r,s){throw r=Object.prototype.toString.call(s),Error(n(31,r==="[object Object]"?"object with keys {"+Object.keys(s).join(", ")+"}":r))}function pd(r){var s=r._init;return s(r._payload)}function hd(r){function s(he,ue){if(r){var ye=he.deletions;ye===null?(he.deletions=[ue],he.flags|=16):ye.push(ue)}}function d(he,ue){if(!r)return null;for(;ue!==null;)s(he,ue),ue=ue.sibling;return null}function g(he,ue){for(he=new Map;ue!==null;)ue.key!==null?he.set(ue.key,ue):he.set(ue.index,ue),ue=ue.sibling;return he}function w(he,ue){return he=no(he,ue),he.index=0,he.sibling=null,he}function _(he,ue,ye){return he.index=ye,r?(ye=he.alternate,ye!==null?(ye=ye.index,ye<ue?(he.flags|=2,ue):ye):(he.flags|=2,ue)):(he.flags|=1048576,ue)}function U(he){return r&&he.alternate===null&&(he.flags|=2),he}function ee(he,ue,ye,qe){return ue===null||ue.tag!==6?(ue=Du(ye,he.mode,qe),ue.return=he,ue):(ue=w(ue,ye),ue.return=he,ue)}function ie(he,ue,ye,qe){var Ze=ye.type;return Ze===$?Pe(he,ue,ye.props.children,qe,ye.key):ue!==null&&(ue.elementType===Ze||typeof Ze=="object"&&Ze!==null&&Ze.$$typeof===be&&pd(Ze)===ue.type)?(qe=w(ue,ye.props),qe.ref=Ys(he,ue,ye),qe.return=he,qe):(qe=Sa(ye.type,ye.key,ye.props,null,he.mode,qe),qe.ref=Ys(he,ue,ye),qe.return=he,qe)}function we(he,ue,ye,qe){return ue===null||ue.tag!==4||ue.stateNode.containerInfo!==ye.containerInfo||ue.stateNode.implementation!==ye.implementation?(ue=Mu(ye,he.mode,qe),ue.return=he,ue):(ue=w(ue,ye.children||[]),ue.return=he,ue)}function Pe(he,ue,ye,qe,Ze){return ue===null||ue.tag!==7?(ue=qo(ye,he.mode,qe,Ze),ue.return=he,ue):(ue=w(ue,ye),ue.return=he,ue)}function Ue(he,ue,ye){if(typeof ue=="string"&&ue!==""||typeof ue=="number")return ue=Du(""+ue,he.mode,ye),ue.return=he,ue;if(typeof ue=="object"&&ue!==null){switch(ue.$$typeof){case P:return ye=Sa(ue.type,ue.key,ue.props,null,he.mode,ye),ye.ref=Ys(he,null,ue),ye.return=he,ye;case G:return ue=Mu(ue,he.mode,ye),ue.return=he,ue;case be:var qe=ue._init;return Ue(he,qe(ue._payload),ye)}if(Te(ue)||te(ue))return ue=qo(ue,he.mode,ye,null),ue.return=he,ue;Zi(he,ue)}return null}function Re(he,ue,ye,qe){var Ze=ue!==null?ue.key:null;if(typeof ye=="string"&&ye!==""||typeof ye=="number")return Ze!==null?null:ee(he,ue,""+ye,qe);if(typeof ye=="object"&&ye!==null){switch(ye.$$typeof){case P:return ye.key===Ze?ie(he,ue,ye,qe):null;case G:return ye.key===Ze?we(he,ue,ye,qe):null;case be:return Ze=ye._init,Re(he,ue,Ze(ye._payload),qe)}if(Te(ye)||te(ye))return Ze!==null?null:Pe(he,ue,ye,qe,null);Zi(he,ye)}return null}function Be(he,ue,ye,qe,Ze){if(typeof qe=="string"&&qe!==""||typeof qe=="number")return he=he.get(ye)||null,ee(ue,he,""+qe,Ze);if(typeof qe=="object"&&qe!==null){switch(qe.$$typeof){case P:return he=he.get(qe.key===null?ye:qe.key)||null,ie(ue,he,qe,Ze);case G:return he=he.get(qe.key===null?ye:qe.key)||null,we(ue,he,qe,Ze);case be:var tt=qe._init;return Be(he,ue,ye,tt(qe._payload),Ze)}if(Te(qe)||te(qe))return he=he.get(ye)||null,Pe(ue,he,qe,Ze,null);Zi(ue,qe)}return null}function $e(he,ue,ye,qe){for(var Ze=null,tt=null,nt=ue,ut=ue=0,nn=null;nt!==null&&ut<ye.length;ut++){nt.index>ut?(nn=nt,nt=null):nn=nt.sibling;var St=Re(he,nt,ye[ut],qe);if(St===null){nt===null&&(nt=nn);break}r&&nt&&St.alternate===null&&s(he,nt),ue=_(St,ue,ut),tt===null?Ze=St:tt.sibling=St,tt=St,nt=nn}if(ut===ye.length)return d(he,nt),Lt&&Do(he,ut),Ze;if(nt===null){for(;ut<ye.length;ut++)nt=Ue(he,ye[ut],qe),nt!==null&&(ue=_(nt,ue,ut),tt===null?Ze=nt:tt.sibling=nt,tt=nt);return Lt&&Do(he,ut),Ze}for(nt=g(he,nt);ut<ye.length;ut++)nn=Be(nt,he,ut,ye[ut],qe),nn!==null&&(r&&nn.alternate!==null&&nt.delete(nn.key===null?ut:nn.key),ue=_(nn,ue,ut),tt===null?Ze=nn:tt.sibling=nn,tt=nn);return r&&nt.forEach(function(ro){return s(he,ro)}),Lt&&Do(he,ut),Ze}function Ye(he,ue,ye,qe){var Ze=te(ye);if(typeof Ze!="function")throw Error(n(150));if(ye=Ze.call(ye),ye==null)throw Error(n(151));for(var tt=Ze=null,nt=ue,ut=ue=0,nn=null,St=ye.next();nt!==null&&!St.done;ut++,St=ye.next()){nt.index>ut?(nn=nt,nt=null):nn=nt.sibling;var ro=Re(he,nt,St.value,qe);if(ro===null){nt===null&&(nt=nn);break}r&&nt&&ro.alternate===null&&s(he,nt),ue=_(ro,ue,ut),tt===null?Ze=ro:tt.sibling=ro,tt=ro,nt=nn}if(St.done)return d(he,nt),Lt&&Do(he,ut),Ze;if(nt===null){for(;!St.done;ut++,St=ye.next())St=Ue(he,St.value,qe),St!==null&&(ue=_(St,ue,ut),tt===null?Ze=St:tt.sibling=St,tt=St);return Lt&&Do(he,ut),Ze}for(nt=g(he,nt);!St.done;ut++,St=ye.next())St=Be(nt,he,ut,St.value,qe),St!==null&&(r&&St.alternate!==null&&nt.delete(St.key===null?ut:St.key),ue=_(St,ue,ut),tt===null?Ze=St:tt.sibling=St,tt=St);return r&&nt.forEach(function(Ig){return s(he,Ig)}),Lt&&Do(he,ut),Ze}function Vt(he,ue,ye,qe){if(typeof ye=="object"&&ye!==null&&ye.type===$&&ye.key===null&&(ye=ye.props.children),typeof ye=="object"&&ye!==null){switch(ye.$$typeof){case P:e:{for(var Ze=ye.key,tt=ue;tt!==null;){if(tt.key===Ze){if(Ze=ye.type,Ze===$){if(tt.tag===7){d(he,tt.sibling),ue=w(tt,ye.props.children),ue.return=he,he=ue;break e}}else if(tt.elementType===Ze||typeof Ze=="object"&&Ze!==null&&Ze.$$typeof===be&&pd(Ze)===tt.type){d(he,tt.sibling),ue=w(tt,ye.props),ue.ref=Ys(he,tt,ye),ue.return=he,he=ue;break e}d(he,tt);break}else s(he,tt);tt=tt.sibling}ye.type===$?(ue=qo(ye.props.children,he.mode,qe,ye.key),ue.return=he,he=ue):(qe=Sa(ye.type,ye.key,ye.props,null,he.mode,qe),qe.ref=Ys(he,ue,ye),qe.return=he,he=qe)}return U(he);case G:e:{for(tt=ye.key;ue!==null;){if(ue.key===tt)if(ue.tag===4&&ue.stateNode.containerInfo===ye.containerInfo&&ue.stateNode.implementation===ye.implementation){d(he,ue.sibling),ue=w(ue,ye.children||[]),ue.return=he,he=ue;break e}else{d(he,ue);break}else s(he,ue);ue=ue.sibling}ue=Mu(ye,he.mode,qe),ue.return=he,he=ue}return U(he);case be:return tt=ye._init,Vt(he,ue,tt(ye._payload),qe)}if(Te(ye))return $e(he,ue,ye,qe);if(te(ye))return Ye(he,ue,ye,qe);Zi(he,ye)}return typeof ye=="string"&&ye!==""||typeof ye=="number"?(ye=""+ye,ue!==null&&ue.tag===6?(d(he,ue.sibling),ue=w(ue,ye),ue.return=he,he=ue):(d(he,ue),ue=Du(ye,he.mode,qe),ue.return=he,he=ue),U(he)):d(he,ue)}return Vt}var gs=hd(!0),gd=hd(!1),Xi=Hr(null),ea=null,ys=null,Ol=null;function Bl(){Ol=ys=ea=null}function Vl(r){var s=Xi.current;Mt(Xi),r._currentValue=s}function Gl(r,s,d){for(;r!==null;){var g=r.alternate;if((r.childLanes&s)!==s?(r.childLanes|=s,g!==null&&(g.childLanes|=s)):g!==null&&(g.childLanes&s)!==s&&(g.childLanes|=s),r===d)break;r=r.return}}function vs(r,s){ea=r,Ol=ys=null,r=r.dependencies,r!==null&&r.firstContext!==null&&((r.lanes&s)!==0&&(_n=!0),r.firstContext=null)}function Bn(r){var s=r._currentValue;if(Ol!==r)if(r={context:r,memoizedValue:s,next:null},ys===null){if(ea===null)throw Error(n(308));ys=r,ea.dependencies={lanes:0,firstContext:r}}else ys=ys.next=r;return s}var Mo=null;function $l(r){Mo===null?Mo=[r]:Mo.push(r)}function yd(r,s,d,g){var w=s.interleaved;return w===null?(d.next=d,$l(s)):(d.next=w.next,w.next=d),s.interleaved=d,br(r,g)}function br(r,s){r.lanes|=s;var d=r.alternate;for(d!==null&&(d.lanes|=s),d=r,r=r.return;r!==null;)r.childLanes|=s,d=r.alternate,d!==null&&(d.childLanes|=s),d=r,r=r.return;return d.tag===3?d.stateNode:null}var Yr=!1;function Hl(r){r.updateQueue={baseState:r.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function vd(r,s){r=r.updateQueue,s.updateQueue===r&&(s.updateQueue={baseState:r.baseState,firstBaseUpdate:r.firstBaseUpdate,lastBaseUpdate:r.lastBaseUpdate,shared:r.shared,effects:r.effects})}function Nr(r,s){return{eventTime:r,lane:s,tag:0,payload:null,callback:null,next:null}}function Qr(r,s,d){var g=r.updateQueue;if(g===null)return null;if(g=g.shared,(wt&2)!==0){var w=g.pending;return w===null?s.next=s:(s.next=w.next,w.next=s),g.pending=s,br(r,d)}return w=g.interleaved,w===null?(s.next=s,$l(g)):(s.next=w.next,w.next=s),g.interleaved=s,br(r,d)}function ta(r,s,d){if(s=s.updateQueue,s!==null&&(s=s.shared,(d&4194240)!==0)){var g=s.lanes;g&=r.pendingLanes,d|=g,s.lanes=d,Zo(r,d)}}function xd(r,s){var d=r.updateQueue,g=r.alternate;if(g!==null&&(g=g.updateQueue,d===g)){var w=null,_=null;if(d=d.firstBaseUpdate,d!==null){do{var U={eventTime:d.eventTime,lane:d.lane,tag:d.tag,payload:d.payload,callback:d.callback,next:null};_===null?w=_=U:_=_.next=U,d=d.next}while(d!==null);_===null?w=_=s:_=_.next=s}else w=_=s;d={baseState:g.baseState,firstBaseUpdate:w,lastBaseUpdate:_,shared:g.shared,effects:g.effects},r.updateQueue=d;return}r=d.lastBaseUpdate,r===null?d.firstBaseUpdate=s:r.next=s,d.lastBaseUpdate=s}function na(r,s,d,g){var w=r.updateQueue;Yr=!1;var _=w.firstBaseUpdate,U=w.lastBaseUpdate,ee=w.shared.pending;if(ee!==null){w.shared.pending=null;var ie=ee,we=ie.next;ie.next=null,U===null?_=we:U.next=we,U=ie;var Pe=r.alternate;Pe!==null&&(Pe=Pe.updateQueue,ee=Pe.lastBaseUpdate,ee!==U&&(ee===null?Pe.firstBaseUpdate=we:ee.next=we,Pe.lastBaseUpdate=ie))}if(_!==null){var Ue=w.baseState;U=0,Pe=we=ie=null,ee=_;do{var Re=ee.lane,Be=ee.eventTime;if((g&Re)===Re){Pe!==null&&(Pe=Pe.next={eventTime:Be,lane:0,tag:ee.tag,payload:ee.payload,callback:ee.callback,next:null});e:{var $e=r,Ye=ee;switch(Re=s,Be=d,Ye.tag){case 1:if($e=Ye.payload,typeof $e=="function"){Ue=$e.call(Be,Ue,Re);break e}Ue=$e;break e;case 3:$e.flags=$e.flags&-65537|128;case 0:if($e=Ye.payload,Re=typeof $e=="function"?$e.call(Be,Ue,Re):$e,Re==null)break e;Ue=q({},Ue,Re);break e;case 2:Yr=!0}}ee.callback!==null&&ee.lane!==0&&(r.flags|=64,Re=w.effects,Re===null?w.effects=[ee]:Re.push(ee))}else Be={eventTime:Be,lane:Re,tag:ee.tag,payload:ee.payload,callback:ee.callback,next:null},Pe===null?(we=Pe=Be,ie=Ue):Pe=Pe.next=Be,U|=Re;if(ee=ee.next,ee===null){if(ee=w.shared.pending,ee===null)break;Re=ee,ee=Re.next,Re.next=null,w.lastBaseUpdate=Re,w.shared.pending=null}}while(!0);if(Pe===null&&(ie=Ue),w.baseState=ie,w.firstBaseUpdate=we,w.lastBaseUpdate=Pe,s=w.shared.interleaved,s!==null){w=s;do U|=w.lane,w=w.next;while(w!==s)}else _===null&&(w.shared.lanes=0);Fo|=U,r.lanes=U,r.memoizedState=Ue}}function wd(r,s,d){if(r=s.effects,s.effects=null,r!==null)for(s=0;s<r.length;s++){var g=r[s],w=g.callback;if(w!==null){if(g.callback=null,g=d,typeof w!="function")throw Error(n(191,w));w.call(g)}}}var Qs={},mr=Hr(Qs),Ks=Hr(Qs),Zs=Hr(Qs);function Ro(r){if(r===Qs)throw Error(n(174));return r}function Wl(r,s){switch(At(Zs,s),At(Ks,r),At(mr,Qs),r=s.nodeType,r){case 9:case 11:s=(s=s.documentElement)?s.namespaceURI:at(null,"");break;default:r=r===8?s.parentNode:s,s=r.namespaceURI||null,r=r.tagName,s=at(s,r)}Mt(mr),At(mr,s)}function xs(){Mt(mr),Mt(Ks),Mt(Zs)}function Cd(r){Ro(Zs.current);var s=Ro(mr.current),d=at(s,r.type);s!==d&&(At(Ks,r),At(mr,d))}function Jl(r){Ks.current===r&&(Mt(mr),Mt(Ks))}var jt=Hr(0);function ra(r){for(var s=r;s!==null;){if(s.tag===13){var d=s.memoizedState;if(d!==null&&(d=d.dehydrated,d===null||d.data==="$?"||d.data==="$!"))return s}else if(s.tag===19&&s.memoizedProps.revealOrder!==void 0){if((s.flags&128)!==0)return s}else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===r)break;for(;s.sibling===null;){if(s.return===null||s.return===r)return null;s=s.return}s.sibling.return=s.return,s=s.sibling}return null}var Yl=[];function Ql(){for(var r=0;r<Yl.length;r++)Yl[r]._workInProgressVersionPrimary=null;Yl.length=0}var oa=R.ReactCurrentDispatcher,Kl=R.ReactCurrentBatchConfig,Po=0,qt=null,Jt=null,en=null,sa=!1,Xs=!1,ei=0,Kh=0;function fn(){throw Error(n(321))}function Zl(r,s){if(s===null)return!1;for(var d=0;d<s.length&&d<r.length;d++)if(!Xn(r[d],s[d]))return!1;return!0}function Xl(r,s,d,g,w,_){if(Po=_,qt=s,s.memoizedState=null,s.updateQueue=null,s.lanes=0,oa.current=r===null||r.memoizedState===null?tg:ng,r=d(g,w),Xs){_=0;do{if(Xs=!1,ei=0,25<=_)throw Error(n(301));_+=1,en=Jt=null,s.updateQueue=null,oa.current=rg,r=d(g,w)}while(Xs)}if(oa.current=la,s=Jt!==null&&Jt.next!==null,Po=0,en=Jt=qt=null,sa=!1,s)throw Error(n(300));return r}function eu(){var r=ei!==0;return ei=0,r}function pr(){var r={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return en===null?qt.memoizedState=en=r:en=en.next=r,en}function Vn(){if(Jt===null){var r=qt.alternate;r=r!==null?r.memoizedState:null}else r=Jt.next;var s=en===null?qt.memoizedState:en.next;if(s!==null)en=s,Jt=r;else{if(r===null)throw Error(n(310));Jt=r,r={memoizedState:Jt.memoizedState,baseState:Jt.baseState,baseQueue:Jt.baseQueue,queue:Jt.queue,next:null},en===null?qt.memoizedState=en=r:en=en.next=r}return en}function ti(r,s){return typeof s=="function"?s(r):s}function tu(r){var s=Vn(),d=s.queue;if(d===null)throw Error(n(311));d.lastRenderedReducer=r;var g=Jt,w=g.baseQueue,_=d.pending;if(_!==null){if(w!==null){var U=w.next;w.next=_.next,_.next=U}g.baseQueue=w=_,d.pending=null}if(w!==null){_=w.next,g=g.baseState;var ee=U=null,ie=null,we=_;do{var Pe=we.lane;if((Po&Pe)===Pe)ie!==null&&(ie=ie.next={lane:0,action:we.action,hasEagerState:we.hasEagerState,eagerState:we.eagerState,next:null}),g=we.hasEagerState?we.eagerState:r(g,we.action);else{var Ue={lane:Pe,action:we.action,hasEagerState:we.hasEagerState,eagerState:we.eagerState,next:null};ie===null?(ee=ie=Ue,U=g):ie=ie.next=Ue,qt.lanes|=Pe,Fo|=Pe}we=we.next}while(we!==null&&we!==_);ie===null?U=g:ie.next=ee,Xn(g,s.memoizedState)||(_n=!0),s.memoizedState=g,s.baseState=U,s.baseQueue=ie,d.lastRenderedState=g}if(r=d.interleaved,r!==null){w=r;do _=w.lane,qt.lanes|=_,Fo|=_,w=w.next;while(w!==r)}else w===null&&(d.lanes=0);return[s.memoizedState,d.dispatch]}function nu(r){var s=Vn(),d=s.queue;if(d===null)throw Error(n(311));d.lastRenderedReducer=r;var g=d.dispatch,w=d.pending,_=s.memoizedState;if(w!==null){d.pending=null;var U=w=w.next;do _=r(_,U.action),U=U.next;while(U!==w);Xn(_,s.memoizedState)||(_n=!0),s.memoizedState=_,s.baseQueue===null&&(s.baseState=_),d.lastRenderedState=_}return[_,g]}function Sd(){}function kd(r,s){var d=qt,g=Vn(),w=s(),_=!Xn(g.memoizedState,w);if(_&&(g.memoizedState=w,_n=!0),g=g.queue,ru(Ed.bind(null,d,g,r),[r]),g.getSnapshot!==s||_||en!==null&&en.memoizedState.tag&1){if(d.flags|=2048,ni(9,_d.bind(null,d,g,w,s),void 0,null),tn===null)throw Error(n(349));(Po&30)!==0||Td(d,s,w)}return w}function Td(r,s,d){r.flags|=16384,r={getSnapshot:s,value:d},s=qt.updateQueue,s===null?(s={lastEffect:null,stores:null},qt.updateQueue=s,s.stores=[r]):(d=s.stores,d===null?s.stores=[r]:d.push(r))}function _d(r,s,d,g){s.value=d,s.getSnapshot=g,bd(s)&&Nd(r)}function Ed(r,s,d){return d(function(){bd(s)&&Nd(r)})}function bd(r){var s=r.getSnapshot;r=r.value;try{var d=s();return!Xn(r,d)}catch{return!0}}function Nd(r){var s=br(r,1);s!==null&&or(s,r,1,-1)}function Id(r){var s=pr();return typeof r=="function"&&(r=r()),s.memoizedState=s.baseState=r,r={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:ti,lastRenderedState:r},s.queue=r,r=r.dispatch=eg.bind(null,qt,r),[s.memoizedState,r]}function ni(r,s,d,g){return r={tag:r,create:s,destroy:d,deps:g,next:null},s=qt.updateQueue,s===null?(s={lastEffect:null,stores:null},qt.updateQueue=s,s.lastEffect=r.next=r):(d=s.lastEffect,d===null?s.lastEffect=r.next=r:(g=d.next,d.next=r,r.next=g,s.lastEffect=r)),r}function Ad(){return Vn().memoizedState}function ia(r,s,d,g){var w=pr();qt.flags|=r,w.memoizedState=ni(1|s,d,void 0,g===void 0?null:g)}function aa(r,s,d,g){var w=Vn();g=g===void 0?null:g;var _=void 0;if(Jt!==null){var U=Jt.memoizedState;if(_=U.destroy,g!==null&&Zl(g,U.deps)){w.memoizedState=ni(s,d,_,g);return}}qt.flags|=r,w.memoizedState=ni(1|s,d,_,g)}function Dd(r,s){return ia(8390656,8,r,s)}function ru(r,s){return aa(2048,8,r,s)}function Md(r,s){return aa(4,2,r,s)}function Rd(r,s){return aa(4,4,r,s)}function Pd(r,s){if(typeof s=="function")return r=r(),s(r),function(){s(null)};if(s!=null)return r=r(),s.current=r,function(){s.current=null}}function Fd(r,s,d){return d=d!=null?d.concat([r]):null,aa(4,4,Pd.bind(null,s,r),d)}function ou(){}function Ld(r,s){var d=Vn();s=s===void 0?null:s;var g=d.memoizedState;return g!==null&&s!==null&&Zl(s,g[1])?g[0]:(d.memoizedState=[r,s],r)}function Ud(r,s){var d=Vn();s=s===void 0?null:s;var g=d.memoizedState;return g!==null&&s!==null&&Zl(s,g[1])?g[0]:(r=r(),d.memoizedState=[r,s],r)}function jd(r,s,d){return(Po&21)===0?(r.baseState&&(r.baseState=!1,_n=!0),r.memoizedState=d):(Xn(d,s)||(d=yo(),qt.lanes|=d,Fo|=d,r.baseState=!0),s)}function Zh(r,s){var d=xt;xt=d!==0&&4>d?d:4,r(!0);var g=Kl.transition;Kl.transition={};try{r(!1),s()}finally{xt=d,Kl.transition=g}}function qd(){return Vn().memoizedState}function Xh(r,s,d){var g=eo(r);if(d={lane:g,action:d,hasEagerState:!1,eagerState:null,next:null},zd(r))Od(s,d);else if(d=yd(r,s,d,g),d!==null){var w=wn();or(d,r,g,w),Bd(d,s,g)}}function eg(r,s,d){var g=eo(r),w={lane:g,action:d,hasEagerState:!1,eagerState:null,next:null};if(zd(r))Od(s,w);else{var _=r.alternate;if(r.lanes===0&&(_===null||_.lanes===0)&&(_=s.lastRenderedReducer,_!==null))try{var U=s.lastRenderedState,ee=_(U,d);if(w.hasEagerState=!0,w.eagerState=ee,Xn(ee,U)){var ie=s.interleaved;ie===null?(w.next=w,$l(s)):(w.next=ie.next,ie.next=w),s.interleaved=w;return}}catch{}finally{}d=yd(r,s,w,g),d!==null&&(w=wn(),or(d,r,g,w),Bd(d,s,g))}}function zd(r){var s=r.alternate;return r===qt||s!==null&&s===qt}function Od(r,s){Xs=sa=!0;var d=r.pending;d===null?s.next=s:(s.next=d.next,d.next=s),r.pending=s}function Bd(r,s,d){if((d&4194240)!==0){var g=s.lanes;g&=r.pendingLanes,d|=g,s.lanes=d,Zo(r,d)}}var la={readContext:Bn,useCallback:fn,useContext:fn,useEffect:fn,useImperativeHandle:fn,useInsertionEffect:fn,useLayoutEffect:fn,useMemo:fn,useReducer:fn,useRef:fn,useState:fn,useDebugValue:fn,useDeferredValue:fn,useTransition:fn,useMutableSource:fn,useSyncExternalStore:fn,useId:fn,unstable_isNewReconciler:!1},tg={readContext:Bn,useCallback:function(r,s){return pr().memoizedState=[r,s===void 0?null:s],r},useContext:Bn,useEffect:Dd,useImperativeHandle:function(r,s,d){return d=d!=null?d.concat([r]):null,ia(4194308,4,Pd.bind(null,s,r),d)},useLayoutEffect:function(r,s){return ia(4194308,4,r,s)},useInsertionEffect:function(r,s){return ia(4,2,r,s)},useMemo:function(r,s){var d=pr();return s=s===void 0?null:s,r=r(),d.memoizedState=[r,s],r},useReducer:function(r,s,d){var g=pr();return s=d!==void 0?d(s):s,g.memoizedState=g.baseState=s,r={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:r,lastRenderedState:s},g.queue=r,r=r.dispatch=Xh.bind(null,qt,r),[g.memoizedState,r]},useRef:function(r){var s=pr();return r={current:r},s.memoizedState=r},useState:Id,useDebugValue:ou,useDeferredValue:function(r){return pr().memoizedState=r},useTransition:function(){var r=Id(!1),s=r[0];return r=Zh.bind(null,r[1]),pr().memoizedState=r,[s,r]},useMutableSource:function(){},useSyncExternalStore:function(r,s,d){var g=qt,w=pr();if(Lt){if(d===void 0)throw Error(n(407));d=d()}else{if(d=s(),tn===null)throw Error(n(349));(Po&30)!==0||Td(g,s,d)}w.memoizedState=d;var _={value:d,getSnapshot:s};return w.queue=_,Dd(Ed.bind(null,g,_,r),[r]),g.flags|=2048,ni(9,_d.bind(null,g,_,d,s),void 0,null),d},useId:function(){var r=pr(),s=tn.identifierPrefix;if(Lt){var d=Er,g=_r;d=(g&~(1<<32-Dn(g)-1)).toString(32)+d,s=":"+s+"R"+d,d=ei++,0<d&&(s+="H"+d.toString(32)),s+=":"}else d=Kh++,s=":"+s+"r"+d.toString(32)+":";return r.memoizedState=s},unstable_isNewReconciler:!1},ng={readContext:Bn,useCallback:Ld,useContext:Bn,useEffect:ru,useImperativeHandle:Fd,useInsertionEffect:Md,useLayoutEffect:Rd,useMemo:Ud,useReducer:tu,useRef:Ad,useState:function(){return tu(ti)},useDebugValue:ou,useDeferredValue:function(r){var s=Vn();return jd(s,Jt.memoizedState,r)},useTransition:function(){var r=tu(ti)[0],s=Vn().memoizedState;return[r,s]},useMutableSource:Sd,useSyncExternalStore:kd,useId:qd,unstable_isNewReconciler:!1},rg={readContext:Bn,useCallback:Ld,useContext:Bn,useEffect:ru,useImperativeHandle:Fd,useInsertionEffect:Md,useLayoutEffect:Rd,useMemo:Ud,useReducer:nu,useRef:Ad,useState:function(){return nu(ti)},useDebugValue:ou,useDeferredValue:function(r){var s=Vn();return Jt===null?s.memoizedState=r:jd(s,Jt.memoizedState,r)},useTransition:function(){var r=nu(ti)[0],s=Vn().memoizedState;return[r,s]},useMutableSource:Sd,useSyncExternalStore:kd,useId:qd,unstable_isNewReconciler:!1};function tr(r,s){if(r&&r.defaultProps){s=q({},s),r=r.defaultProps;for(var d in r)s[d]===void 0&&(s[d]=r[d]);return s}return s}function su(r,s,d,g){s=r.memoizedState,d=d(g,s),d=d==null?s:q({},s,d),r.memoizedState=d,r.lanes===0&&(r.updateQueue.baseState=d)}var ua={isMounted:function(r){return(r=r._reactInternals)?lr(r)===r:!1},enqueueSetState:function(r,s,d){r=r._reactInternals;var g=wn(),w=eo(r),_=Nr(g,w);_.payload=s,d!=null&&(_.callback=d),s=Qr(r,_,w),s!==null&&(or(s,r,w,g),ta(s,r,w))},enqueueReplaceState:function(r,s,d){r=r._reactInternals;var g=wn(),w=eo(r),_=Nr(g,w);_.tag=1,_.payload=s,d!=null&&(_.callback=d),s=Qr(r,_,w),s!==null&&(or(s,r,w,g),ta(s,r,w))},enqueueForceUpdate:function(r,s){r=r._reactInternals;var d=wn(),g=eo(r),w=Nr(d,g);w.tag=2,s!=null&&(w.callback=s),s=Qr(r,w,g),s!==null&&(or(s,r,g,d),ta(s,r,g))}};function Vd(r,s,d,g,w,_,U){return r=r.stateNode,typeof r.shouldComponentUpdate=="function"?r.shouldComponentUpdate(g,_,U):s.prototype&&s.prototype.isPureReactComponent?!Bs(d,g)||!Bs(w,_):!0}function Gd(r,s,d){var g=!1,w=Wr,_=s.contextType;return typeof _=="object"&&_!==null?_=Bn(_):(w=Tn(s)?Io:dn.current,g=s.contextTypes,_=(g=g!=null)?fs(r,w):Wr),s=new s(d,_),r.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,s.updater=ua,r.stateNode=s,s._reactInternals=r,g&&(r=r.stateNode,r.__reactInternalMemoizedUnmaskedChildContext=w,r.__reactInternalMemoizedMaskedChildContext=_),s}function $d(r,s,d,g){r=s.state,typeof s.componentWillReceiveProps=="function"&&s.componentWillReceiveProps(d,g),typeof s.UNSAFE_componentWillReceiveProps=="function"&&s.UNSAFE_componentWillReceiveProps(d,g),s.state!==r&&ua.enqueueReplaceState(s,s.state,null)}function iu(r,s,d,g){var w=r.stateNode;w.props=d,w.state=r.memoizedState,w.refs={},Hl(r);var _=s.contextType;typeof _=="object"&&_!==null?w.context=Bn(_):(_=Tn(s)?Io:dn.current,w.context=fs(r,_)),w.state=r.memoizedState,_=s.getDerivedStateFromProps,typeof _=="function"&&(su(r,s,_,d),w.state=r.memoizedState),typeof s.getDerivedStateFromProps=="function"||typeof w.getSnapshotBeforeUpdate=="function"||typeof w.UNSAFE_componentWillMount!="function"&&typeof w.componentWillMount!="function"||(s=w.state,typeof w.componentWillMount=="function"&&w.componentWillMount(),typeof w.UNSAFE_componentWillMount=="function"&&w.UNSAFE_componentWillMount(),s!==w.state&&ua.enqueueReplaceState(w,w.state,null),na(r,d,w,g),w.state=r.memoizedState),typeof w.componentDidMount=="function"&&(r.flags|=4194308)}function ws(r,s){try{var d="",g=s;do d+=K(g),g=g.return;while(g);var w=d}catch(_){w=`
Error generating stack: `+_.message+`
`+_.stack}return{value:r,source:s,stack:w,digest:null}}function au(r,s,d){return{value:r,source:null,stack:d??null,digest:s??null}}function lu(r,s){try{console.error(s.value)}catch(d){setTimeout(function(){throw d})}}var og=typeof WeakMap=="function"?WeakMap:Map;function Hd(r,s,d){d=Nr(-1,d),d.tag=3,d.payload={element:null};var g=s.value;return d.callback=function(){ga||(ga=!0,ku=g),lu(r,s)},d}function Wd(r,s,d){d=Nr(-1,d),d.tag=3;var g=r.type.getDerivedStateFromError;if(typeof g=="function"){var w=s.value;d.payload=function(){return g(w)},d.callback=function(){lu(r,s)}}var _=r.stateNode;return _!==null&&typeof _.componentDidCatch=="function"&&(d.callback=function(){lu(r,s),typeof g!="function"&&(Zr===null?Zr=new Set([this]):Zr.add(this));var U=s.stack;this.componentDidCatch(s.value,{componentStack:U!==null?U:""})}),d}function Jd(r,s,d){var g=r.pingCache;if(g===null){g=r.pingCache=new og;var w=new Set;g.set(s,w)}else w=g.get(s),w===void 0&&(w=new Set,g.set(s,w));w.has(d)||(w.add(d),r=vg.bind(null,r,s,d),s.then(r,r))}function Yd(r){do{var s;if((s=r.tag===13)&&(s=r.memoizedState,s=s!==null?s.dehydrated!==null:!0),s)return r;r=r.return}while(r!==null);return null}function Qd(r,s,d,g,w){return(r.mode&1)===0?(r===s?r.flags|=65536:(r.flags|=128,d.flags|=131072,d.flags&=-52805,d.tag===1&&(d.alternate===null?d.tag=17:(s=Nr(-1,1),s.tag=2,Qr(d,s,1))),d.lanes|=1),r):(r.flags|=65536,r.lanes=w,r)}var sg=R.ReactCurrentOwner,_n=!1;function xn(r,s,d,g){s.child=r===null?gd(s,null,d,g):gs(s,r.child,d,g)}function Kd(r,s,d,g,w){d=d.render;var _=s.ref;return vs(s,w),g=Xl(r,s,d,g,_,w),d=eu(),r!==null&&!_n?(s.updateQueue=r.updateQueue,s.flags&=-2053,r.lanes&=~w,Ir(r,s,w)):(Lt&&d&&Ll(s),s.flags|=1,xn(r,s,g,w),s.child)}function Zd(r,s,d,g,w){if(r===null){var _=d.type;return typeof _=="function"&&!Au(_)&&_.defaultProps===void 0&&d.compare===null&&d.defaultProps===void 0?(s.tag=15,s.type=_,Xd(r,s,_,g,w)):(r=Sa(d.type,null,g,s,s.mode,w),r.ref=s.ref,r.return=s,s.child=r)}if(_=r.child,(r.lanes&w)===0){var U=_.memoizedProps;if(d=d.compare,d=d!==null?d:Bs,d(U,g)&&r.ref===s.ref)return Ir(r,s,w)}return s.flags|=1,r=no(_,g),r.ref=s.ref,r.return=s,s.child=r}function Xd(r,s,d,g,w){if(r!==null){var _=r.memoizedProps;if(Bs(_,g)&&r.ref===s.ref)if(_n=!1,s.pendingProps=g=_,(r.lanes&w)!==0)(r.flags&131072)!==0&&(_n=!0);else return s.lanes=r.lanes,Ir(r,s,w)}return uu(r,s,d,g,w)}function ef(r,s,d){var g=s.pendingProps,w=g.children,_=r!==null?r.memoizedState:null;if(g.mode==="hidden")if((s.mode&1)===0)s.memoizedState={baseLanes:0,cachePool:null,transitions:null},At(Ss,Fn),Fn|=d;else{if((d&1073741824)===0)return r=_!==null?_.baseLanes|d:d,s.lanes=s.childLanes=1073741824,s.memoizedState={baseLanes:r,cachePool:null,transitions:null},s.updateQueue=null,At(Ss,Fn),Fn|=r,null;s.memoizedState={baseLanes:0,cachePool:null,transitions:null},g=_!==null?_.baseLanes:d,At(Ss,Fn),Fn|=g}else _!==null?(g=_.baseLanes|d,s.memoizedState=null):g=d,At(Ss,Fn),Fn|=g;return xn(r,s,w,d),s.child}function tf(r,s){var d=s.ref;(r===null&&d!==null||r!==null&&r.ref!==d)&&(s.flags|=512,s.flags|=2097152)}function uu(r,s,d,g,w){var _=Tn(d)?Io:dn.current;return _=fs(s,_),vs(s,w),d=Xl(r,s,d,g,_,w),g=eu(),r!==null&&!_n?(s.updateQueue=r.updateQueue,s.flags&=-2053,r.lanes&=~w,Ir(r,s,w)):(Lt&&g&&Ll(s),s.flags|=1,xn(r,s,d,w),s.child)}function nf(r,s,d,g,w){if(Tn(d)){var _=!0;Wi(s)}else _=!1;if(vs(s,w),s.stateNode===null)da(r,s),Gd(s,d,g),iu(s,d,g,w),g=!0;else if(r===null){var U=s.stateNode,ee=s.memoizedProps;U.props=ee;var ie=U.context,we=d.contextType;typeof we=="object"&&we!==null?we=Bn(we):(we=Tn(d)?Io:dn.current,we=fs(s,we));var Pe=d.getDerivedStateFromProps,Ue=typeof Pe=="function"||typeof U.getSnapshotBeforeUpdate=="function";Ue||typeof U.UNSAFE_componentWillReceiveProps!="function"&&typeof U.componentWillReceiveProps!="function"||(ee!==g||ie!==we)&&$d(s,U,g,we),Yr=!1;var Re=s.memoizedState;U.state=Re,na(s,g,U,w),ie=s.memoizedState,ee!==g||Re!==ie||kn.current||Yr?(typeof Pe=="function"&&(su(s,d,Pe,g),ie=s.memoizedState),(ee=Yr||Vd(s,d,ee,g,Re,ie,we))?(Ue||typeof U.UNSAFE_componentWillMount!="function"&&typeof U.componentWillMount!="function"||(typeof U.componentWillMount=="function"&&U.componentWillMount(),typeof U.UNSAFE_componentWillMount=="function"&&U.UNSAFE_componentWillMount()),typeof U.componentDidMount=="function"&&(s.flags|=4194308)):(typeof U.componentDidMount=="function"&&(s.flags|=4194308),s.memoizedProps=g,s.memoizedState=ie),U.props=g,U.state=ie,U.context=we,g=ee):(typeof U.componentDidMount=="function"&&(s.flags|=4194308),g=!1)}else{U=s.stateNode,vd(r,s),ee=s.memoizedProps,we=s.type===s.elementType?ee:tr(s.type,ee),U.props=we,Ue=s.pendingProps,Re=U.context,ie=d.contextType,typeof ie=="object"&&ie!==null?ie=Bn(ie):(ie=Tn(d)?Io:dn.current,ie=fs(s,ie));var Be=d.getDerivedStateFromProps;(Pe=typeof Be=="function"||typeof U.getSnapshotBeforeUpdate=="function")||typeof U.UNSAFE_componentWillReceiveProps!="function"&&typeof U.componentWillReceiveProps!="function"||(ee!==Ue||Re!==ie)&&$d(s,U,g,ie),Yr=!1,Re=s.memoizedState,U.state=Re,na(s,g,U,w);var $e=s.memoizedState;ee!==Ue||Re!==$e||kn.current||Yr?(typeof Be=="function"&&(su(s,d,Be,g),$e=s.memoizedState),(we=Yr||Vd(s,d,we,g,Re,$e,ie)||!1)?(Pe||typeof U.UNSAFE_componentWillUpdate!="function"&&typeof U.componentWillUpdate!="function"||(typeof U.componentWillUpdate=="function"&&U.componentWillUpdate(g,$e,ie),typeof U.UNSAFE_componentWillUpdate=="function"&&U.UNSAFE_componentWillUpdate(g,$e,ie)),typeof U.componentDidUpdate=="function"&&(s.flags|=4),typeof U.getSnapshotBeforeUpdate=="function"&&(s.flags|=1024)):(typeof U.componentDidUpdate!="function"||ee===r.memoizedProps&&Re===r.memoizedState||(s.flags|=4),typeof U.getSnapshotBeforeUpdate!="function"||ee===r.memoizedProps&&Re===r.memoizedState||(s.flags|=1024),s.memoizedProps=g,s.memoizedState=$e),U.props=g,U.state=$e,U.context=ie,g=we):(typeof U.componentDidUpdate!="function"||ee===r.memoizedProps&&Re===r.memoizedState||(s.flags|=4),typeof U.getSnapshotBeforeUpdate!="function"||ee===r.memoizedProps&&Re===r.memoizedState||(s.flags|=1024),g=!1)}return cu(r,s,d,g,_,w)}function cu(r,s,d,g,w,_){tf(r,s);var U=(s.flags&128)!==0;if(!g&&!U)return w&&ad(s,d,!1),Ir(r,s,_);g=s.stateNode,sg.current=s;var ee=U&&typeof d.getDerivedStateFromError!="function"?null:g.render();return s.flags|=1,r!==null&&U?(s.child=gs(s,r.child,null,_),s.child=gs(s,null,ee,_)):xn(r,s,ee,_),s.memoizedState=g.state,w&&ad(s,d,!0),s.child}function rf(r){var s=r.stateNode;s.pendingContext?sd(r,s.pendingContext,s.pendingContext!==s.context):s.context&&sd(r,s.context,!1),Wl(r,s.containerInfo)}function of(r,s,d,g,w){return hs(),zl(w),s.flags|=256,xn(r,s,d,g),s.child}var du={dehydrated:null,treeContext:null,retryLane:0};function fu(r){return{baseLanes:r,cachePool:null,transitions:null}}function sf(r,s,d){var g=s.pendingProps,w=jt.current,_=!1,U=(s.flags&128)!==0,ee;if((ee=U)||(ee=r!==null&&r.memoizedState===null?!1:(w&2)!==0),ee?(_=!0,s.flags&=-129):(r===null||r.memoizedState!==null)&&(w|=1),At(jt,w&1),r===null)return ql(s),r=s.memoizedState,r!==null&&(r=r.dehydrated,r!==null)?((s.mode&1)===0?s.lanes=1:r.data==="$!"?s.lanes=8:s.lanes=1073741824,null):(U=g.children,r=g.fallback,_?(g=s.mode,_=s.child,U={mode:"hidden",children:U},(g&1)===0&&_!==null?(_.childLanes=0,_.pendingProps=U):_=ka(U,g,0,null),r=qo(r,g,d,null),_.return=s,r.return=s,_.sibling=r,s.child=_,s.child.memoizedState=fu(d),s.memoizedState=du,r):mu(s,U));if(w=r.memoizedState,w!==null&&(ee=w.dehydrated,ee!==null))return ig(r,s,U,g,ee,w,d);if(_){_=g.fallback,U=s.mode,w=r.child,ee=w.sibling;var ie={mode:"hidden",children:g.children};return(U&1)===0&&s.child!==w?(g=s.child,g.childLanes=0,g.pendingProps=ie,s.deletions=null):(g=no(w,ie),g.subtreeFlags=w.subtreeFlags&14680064),ee!==null?_=no(ee,_):(_=qo(_,U,d,null),_.flags|=2),_.return=s,g.return=s,g.sibling=_,s.child=g,g=_,_=s.child,U=r.child.memoizedState,U=U===null?fu(d):{baseLanes:U.baseLanes|d,cachePool:null,transitions:U.transitions},_.memoizedState=U,_.childLanes=r.childLanes&~d,s.memoizedState=du,g}return _=r.child,r=_.sibling,g=no(_,{mode:"visible",children:g.children}),(s.mode&1)===0&&(g.lanes=d),g.return=s,g.sibling=null,r!==null&&(d=s.deletions,d===null?(s.deletions=[r],s.flags|=16):d.push(r)),s.child=g,s.memoizedState=null,g}function mu(r,s){return s=ka({mode:"visible",children:s},r.mode,0,null),s.return=r,r.child=s}function ca(r,s,d,g){return g!==null&&zl(g),gs(s,r.child,null,d),r=mu(s,s.pendingProps.children),r.flags|=2,s.memoizedState=null,r}function ig(r,s,d,g,w,_,U){if(d)return s.flags&256?(s.flags&=-257,g=au(Error(n(422))),ca(r,s,U,g)):s.memoizedState!==null?(s.child=r.child,s.flags|=128,null):(_=g.fallback,w=s.mode,g=ka({mode:"visible",children:g.children},w,0,null),_=qo(_,w,U,null),_.flags|=2,g.return=s,_.return=s,g.sibling=_,s.child=g,(s.mode&1)!==0&&gs(s,r.child,null,U),s.child.memoizedState=fu(U),s.memoizedState=du,_);if((s.mode&1)===0)return ca(r,s,U,null);if(w.data==="$!"){if(g=w.nextSibling&&w.nextSibling.dataset,g)var ee=g.dgst;return g=ee,_=Error(n(419)),g=au(_,g,void 0),ca(r,s,U,g)}if(ee=(U&r.childLanes)!==0,_n||ee){if(g=tn,g!==null){switch(U&-U){case 4:w=2;break;case 16:w=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:w=32;break;case 536870912:w=268435456;break;default:w=0}w=(w&(g.suspendedLanes|U))!==0?0:w,w!==0&&w!==_.retryLane&&(_.retryLane=w,br(r,w),or(g,r,w,-1))}return Iu(),g=au(Error(n(421))),ca(r,s,U,g)}return w.data==="$?"?(s.flags|=128,s.child=r.child,s=xg.bind(null,r),w._reactRetry=s,null):(r=_.treeContext,Pn=$r(w.nextSibling),Rn=s,Lt=!0,er=null,r!==null&&(zn[On++]=_r,zn[On++]=Er,zn[On++]=Ao,_r=r.id,Er=r.overflow,Ao=s),s=mu(s,g.children),s.flags|=4096,s)}function af(r,s,d){r.lanes|=s;var g=r.alternate;g!==null&&(g.lanes|=s),Gl(r.return,s,d)}function pu(r,s,d,g,w){var _=r.memoizedState;_===null?r.memoizedState={isBackwards:s,rendering:null,renderingStartTime:0,last:g,tail:d,tailMode:w}:(_.isBackwards=s,_.rendering=null,_.renderingStartTime=0,_.last=g,_.tail=d,_.tailMode=w)}function lf(r,s,d){var g=s.pendingProps,w=g.revealOrder,_=g.tail;if(xn(r,s,g.children,d),g=jt.current,(g&2)!==0)g=g&1|2,s.flags|=128;else{if(r!==null&&(r.flags&128)!==0)e:for(r=s.child;r!==null;){if(r.tag===13)r.memoizedState!==null&&af(r,d,s);else if(r.tag===19)af(r,d,s);else if(r.child!==null){r.child.return=r,r=r.child;continue}if(r===s)break e;for(;r.sibling===null;){if(r.return===null||r.return===s)break e;r=r.return}r.sibling.return=r.return,r=r.sibling}g&=1}if(At(jt,g),(s.mode&1)===0)s.memoizedState=null;else switch(w){case"forwards":for(d=s.child,w=null;d!==null;)r=d.alternate,r!==null&&ra(r)===null&&(w=d),d=d.sibling;d=w,d===null?(w=s.child,s.child=null):(w=d.sibling,d.sibling=null),pu(s,!1,w,d,_);break;case"backwards":for(d=null,w=s.child,s.child=null;w!==null;){if(r=w.alternate,r!==null&&ra(r)===null){s.child=w;break}r=w.sibling,w.sibling=d,d=w,w=r}pu(s,!0,d,null,_);break;case"together":pu(s,!1,null,null,void 0);break;default:s.memoizedState=null}return s.child}function da(r,s){(s.mode&1)===0&&r!==null&&(r.alternate=null,s.alternate=null,s.flags|=2)}function Ir(r,s,d){if(r!==null&&(s.dependencies=r.dependencies),Fo|=s.lanes,(d&s.childLanes)===0)return null;if(r!==null&&s.child!==r.child)throw Error(n(153));if(s.child!==null){for(r=s.child,d=no(r,r.pendingProps),s.child=d,d.return=s;r.sibling!==null;)r=r.sibling,d=d.sibling=no(r,r.pendingProps),d.return=s;d.sibling=null}return s.child}function ag(r,s,d){switch(s.tag){case 3:rf(s),hs();break;case 5:Cd(s);break;case 1:Tn(s.type)&&Wi(s);break;case 4:Wl(s,s.stateNode.containerInfo);break;case 10:var g=s.type._context,w=s.memoizedProps.value;At(Xi,g._currentValue),g._currentValue=w;break;case 13:if(g=s.memoizedState,g!==null)return g.dehydrated!==null?(At(jt,jt.current&1),s.flags|=128,null):(d&s.child.childLanes)!==0?sf(r,s,d):(At(jt,jt.current&1),r=Ir(r,s,d),r!==null?r.sibling:null);At(jt,jt.current&1);break;case 19:if(g=(d&s.childLanes)!==0,(r.flags&128)!==0){if(g)return lf(r,s,d);s.flags|=128}if(w=s.memoizedState,w!==null&&(w.rendering=null,w.tail=null,w.lastEffect=null),At(jt,jt.current),g)break;return null;case 22:case 23:return s.lanes=0,ef(r,s,d)}return Ir(r,s,d)}var uf,hu,cf,df;uf=function(r,s){for(var d=s.child;d!==null;){if(d.tag===5||d.tag===6)r.appendChild(d.stateNode);else if(d.tag!==4&&d.child!==null){d.child.return=d,d=d.child;continue}if(d===s)break;for(;d.sibling===null;){if(d.return===null||d.return===s)return;d=d.return}d.sibling.return=d.return,d=d.sibling}},hu=function(){},cf=function(r,s,d,g){var w=r.memoizedProps;if(w!==g){r=s.stateNode,Ro(mr.current);var _=null;switch(d){case"input":w=E(r,w),g=E(r,g),_=[];break;case"select":w=q({},w,{value:void 0}),g=q({},g,{value:void 0}),_=[];break;case"textarea":w=me(r,w),g=me(r,g),_=[];break;default:typeof w.onClick!="function"&&typeof g.onClick=="function"&&(r.onclick=Gi)}Gt(d,g);var U;d=null;for(we in w)if(!g.hasOwnProperty(we)&&w.hasOwnProperty(we)&&w[we]!=null)if(we==="style"){var ee=w[we];for(U in ee)ee.hasOwnProperty(U)&&(d||(d={}),d[U]="")}else we!=="dangerouslySetInnerHTML"&&we!=="children"&&we!=="suppressContentEditableWarning"&&we!=="suppressHydrationWarning"&&we!=="autoFocus"&&(i.hasOwnProperty(we)?_||(_=[]):(_=_||[]).push(we,null));for(we in g){var ie=g[we];if(ee=w!=null?w[we]:void 0,g.hasOwnProperty(we)&&ie!==ee&&(ie!=null||ee!=null))if(we==="style")if(ee){for(U in ee)!ee.hasOwnProperty(U)||ie&&ie.hasOwnProperty(U)||(d||(d={}),d[U]="");for(U in ie)ie.hasOwnProperty(U)&&ee[U]!==ie[U]&&(d||(d={}),d[U]=ie[U])}else d||(_||(_=[]),_.push(we,d)),d=ie;else we==="dangerouslySetInnerHTML"?(ie=ie?ie.__html:void 0,ee=ee?ee.__html:void 0,ie!=null&&ee!==ie&&(_=_||[]).push(we,ie)):we==="children"?typeof ie!="string"&&typeof ie!="number"||(_=_||[]).push(we,""+ie):we!=="suppressContentEditableWarning"&&we!=="suppressHydrationWarning"&&(i.hasOwnProperty(we)?(ie!=null&&we==="onScroll"&&Dt("scroll",r),_||ee===ie||(_=[])):(_=_||[]).push(we,ie))}d&&(_=_||[]).push("style",d);var we=_;(s.updateQueue=we)&&(s.flags|=4)}},df=function(r,s,d,g){d!==g&&(s.flags|=4)};function ri(r,s){if(!Lt)switch(r.tailMode){case"hidden":s=r.tail;for(var d=null;s!==null;)s.alternate!==null&&(d=s),s=s.sibling;d===null?r.tail=null:d.sibling=null;break;case"collapsed":d=r.tail;for(var g=null;d!==null;)d.alternate!==null&&(g=d),d=d.sibling;g===null?s||r.tail===null?r.tail=null:r.tail.sibling=null:g.sibling=null}}function mn(r){var s=r.alternate!==null&&r.alternate.child===r.child,d=0,g=0;if(s)for(var w=r.child;w!==null;)d|=w.lanes|w.childLanes,g|=w.subtreeFlags&14680064,g|=w.flags&14680064,w.return=r,w=w.sibling;else for(w=r.child;w!==null;)d|=w.lanes|w.childLanes,g|=w.subtreeFlags,g|=w.flags,w.return=r,w=w.sibling;return r.subtreeFlags|=g,r.childLanes=d,s}function lg(r,s,d){var g=s.pendingProps;switch(Ul(s),s.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return mn(s),null;case 1:return Tn(s.type)&&Hi(),mn(s),null;case 3:return g=s.stateNode,xs(),Mt(kn),Mt(dn),Ql(),g.pendingContext&&(g.context=g.pendingContext,g.pendingContext=null),(r===null||r.child===null)&&(Ki(s)?s.flags|=4:r===null||r.memoizedState.isDehydrated&&(s.flags&256)===0||(s.flags|=1024,er!==null&&(Eu(er),er=null))),hu(r,s),mn(s),null;case 5:Jl(s);var w=Ro(Zs.current);if(d=s.type,r!==null&&s.stateNode!=null)cf(r,s,d,g,w),r.ref!==s.ref&&(s.flags|=512,s.flags|=2097152);else{if(!g){if(s.stateNode===null)throw Error(n(166));return mn(s),null}if(r=Ro(mr.current),Ki(s)){g=s.stateNode,d=s.type;var _=s.memoizedProps;switch(g[fr]=s,g[Ws]=_,r=(s.mode&1)!==0,d){case"dialog":Dt("cancel",g),Dt("close",g);break;case"iframe":case"object":case"embed":Dt("load",g);break;case"video":case"audio":for(w=0;w<Gs.length;w++)Dt(Gs[w],g);break;case"source":Dt("error",g);break;case"img":case"image":case"link":Dt("error",g),Dt("load",g);break;case"details":Dt("toggle",g);break;case"input":fe(g,_),Dt("invalid",g);break;case"select":g._wrapperState={wasMultiple:!!_.multiple},Dt("invalid",g);break;case"textarea":Le(g,_),Dt("invalid",g)}Gt(d,_),w=null;for(var U in _)if(_.hasOwnProperty(U)){var ee=_[U];U==="children"?typeof ee=="string"?g.textContent!==ee&&(_.suppressHydrationWarning!==!0&&Vi(g.textContent,ee,r),w=["children",ee]):typeof ee=="number"&&g.textContent!==""+ee&&(_.suppressHydrationWarning!==!0&&Vi(g.textContent,ee,r),w=["children",""+ee]):i.hasOwnProperty(U)&&ee!=null&&U==="onScroll"&&Dt("scroll",g)}switch(d){case"input":Ne(g),H(g,_,!0);break;case"textarea":Ne(g),Fe(g);break;case"select":case"option":break;default:typeof _.onClick=="function"&&(g.onclick=Gi)}g=w,s.updateQueue=g,g!==null&&(s.flags|=4)}else{U=w.nodeType===9?w:w.ownerDocument,r==="http://www.w3.org/1999/xhtml"&&(r=Ve(d)),r==="http://www.w3.org/1999/xhtml"?d==="script"?(r=U.createElement("div"),r.innerHTML="<script><\/script>",r=r.removeChild(r.firstChild)):typeof g.is=="string"?r=U.createElement(d,{is:g.is}):(r=U.createElement(d),d==="select"&&(U=r,g.multiple?U.multiple=!0:g.size&&(U.size=g.size))):r=U.createElementNS(r,d),r[fr]=s,r[Ws]=g,uf(r,s,!1,!1),s.stateNode=r;e:{switch(U=qn(d,g),d){case"dialog":Dt("cancel",r),Dt("close",r),w=g;break;case"iframe":case"object":case"embed":Dt("load",r),w=g;break;case"video":case"audio":for(w=0;w<Gs.length;w++)Dt(Gs[w],r);w=g;break;case"source":Dt("error",r),w=g;break;case"img":case"image":case"link":Dt("error",r),Dt("load",r),w=g;break;case"details":Dt("toggle",r),w=g;break;case"input":fe(r,g),w=E(r,g),Dt("invalid",r);break;case"option":w=g;break;case"select":r._wrapperState={wasMultiple:!!g.multiple},w=q({},g,{value:void 0}),Dt("invalid",r);break;case"textarea":Le(r,g),w=me(r,g),Dt("invalid",r);break;default:w=g}Gt(d,w),ee=w;for(_ in ee)if(ee.hasOwnProperty(_)){var ie=ee[_];_==="style"?jn(r,ie):_==="dangerouslySetInnerHTML"?(ie=ie?ie.__html:void 0,ie!=null&&Nt(r,ie)):_==="children"?typeof ie=="string"?(d!=="textarea"||ie!=="")&&kt(r,ie):typeof ie=="number"&&kt(r,""+ie):_!=="suppressContentEditableWarning"&&_!=="suppressHydrationWarning"&&_!=="autoFocus"&&(i.hasOwnProperty(_)?ie!=null&&_==="onScroll"&&Dt("scroll",r):ie!=null&&L(r,_,ie,U))}switch(d){case"input":Ne(r),H(r,g,!1);break;case"textarea":Ne(r),Fe(r);break;case"option":g.value!=null&&r.setAttribute("value",""+ae(g.value));break;case"select":r.multiple=!!g.multiple,_=g.value,_!=null?_e(r,!!g.multiple,_,!1):g.defaultValue!=null&&_e(r,!!g.multiple,g.defaultValue,!0);break;default:typeof w.onClick=="function"&&(r.onclick=Gi)}switch(d){case"button":case"input":case"select":case"textarea":g=!!g.autoFocus;break e;case"img":g=!0;break e;default:g=!1}}g&&(s.flags|=4)}s.ref!==null&&(s.flags|=512,s.flags|=2097152)}return mn(s),null;case 6:if(r&&s.stateNode!=null)df(r,s,r.memoizedProps,g);else{if(typeof g!="string"&&s.stateNode===null)throw Error(n(166));if(d=Ro(Zs.current),Ro(mr.current),Ki(s)){if(g=s.stateNode,d=s.memoizedProps,g[fr]=s,(_=g.nodeValue!==d)&&(r=Rn,r!==null))switch(r.tag){case 3:Vi(g.nodeValue,d,(r.mode&1)!==0);break;case 5:r.memoizedProps.suppressHydrationWarning!==!0&&Vi(g.nodeValue,d,(r.mode&1)!==0)}_&&(s.flags|=4)}else g=(d.nodeType===9?d:d.ownerDocument).createTextNode(g),g[fr]=s,s.stateNode=g}return mn(s),null;case 13:if(Mt(jt),g=s.memoizedState,r===null||r.memoizedState!==null&&r.memoizedState.dehydrated!==null){if(Lt&&Pn!==null&&(s.mode&1)!==0&&(s.flags&128)===0)md(),hs(),s.flags|=98560,_=!1;else if(_=Ki(s),g!==null&&g.dehydrated!==null){if(r===null){if(!_)throw Error(n(318));if(_=s.memoizedState,_=_!==null?_.dehydrated:null,!_)throw Error(n(317));_[fr]=s}else hs(),(s.flags&128)===0&&(s.memoizedState=null),s.flags|=4;mn(s),_=!1}else er!==null&&(Eu(er),er=null),_=!0;if(!_)return s.flags&65536?s:null}return(s.flags&128)!==0?(s.lanes=d,s):(g=g!==null,g!==(r!==null&&r.memoizedState!==null)&&g&&(s.child.flags|=8192,(s.mode&1)!==0&&(r===null||(jt.current&1)!==0?Yt===0&&(Yt=3):Iu())),s.updateQueue!==null&&(s.flags|=4),mn(s),null);case 4:return xs(),hu(r,s),r===null&&$s(s.stateNode.containerInfo),mn(s),null;case 10:return Vl(s.type._context),mn(s),null;case 17:return Tn(s.type)&&Hi(),mn(s),null;case 19:if(Mt(jt),_=s.memoizedState,_===null)return mn(s),null;if(g=(s.flags&128)!==0,U=_.rendering,U===null)if(g)ri(_,!1);else{if(Yt!==0||r!==null&&(r.flags&128)!==0)for(r=s.child;r!==null;){if(U=ra(r),U!==null){for(s.flags|=128,ri(_,!1),g=U.updateQueue,g!==null&&(s.updateQueue=g,s.flags|=4),s.subtreeFlags=0,g=d,d=s.child;d!==null;)_=d,r=g,_.flags&=14680066,U=_.alternate,U===null?(_.childLanes=0,_.lanes=r,_.child=null,_.subtreeFlags=0,_.memoizedProps=null,_.memoizedState=null,_.updateQueue=null,_.dependencies=null,_.stateNode=null):(_.childLanes=U.childLanes,_.lanes=U.lanes,_.child=U.child,_.subtreeFlags=0,_.deletions=null,_.memoizedProps=U.memoizedProps,_.memoizedState=U.memoizedState,_.updateQueue=U.updateQueue,_.type=U.type,r=U.dependencies,_.dependencies=r===null?null:{lanes:r.lanes,firstContext:r.firstContext}),d=d.sibling;return At(jt,jt.current&1|2),s.child}r=r.sibling}_.tail!==null&&Pt()>ks&&(s.flags|=128,g=!0,ri(_,!1),s.lanes=4194304)}else{if(!g)if(r=ra(U),r!==null){if(s.flags|=128,g=!0,d=r.updateQueue,d!==null&&(s.updateQueue=d,s.flags|=4),ri(_,!0),_.tail===null&&_.tailMode==="hidden"&&!U.alternate&&!Lt)return mn(s),null}else 2*Pt()-_.renderingStartTime>ks&&d!==1073741824&&(s.flags|=128,g=!0,ri(_,!1),s.lanes=4194304);_.isBackwards?(U.sibling=s.child,s.child=U):(d=_.last,d!==null?d.sibling=U:s.child=U,_.last=U)}return _.tail!==null?(s=_.tail,_.rendering=s,_.tail=s.sibling,_.renderingStartTime=Pt(),s.sibling=null,d=jt.current,At(jt,g?d&1|2:d&1),s):(mn(s),null);case 22:case 23:return Nu(),g=s.memoizedState!==null,r!==null&&r.memoizedState!==null!==g&&(s.flags|=8192),g&&(s.mode&1)!==0?(Fn&1073741824)!==0&&(mn(s),s.subtreeFlags&6&&(s.flags|=8192)):mn(s),null;case 24:return null;case 25:return null}throw Error(n(156,s.tag))}function ug(r,s){switch(Ul(s),s.tag){case 1:return Tn(s.type)&&Hi(),r=s.flags,r&65536?(s.flags=r&-65537|128,s):null;case 3:return xs(),Mt(kn),Mt(dn),Ql(),r=s.flags,(r&65536)!==0&&(r&128)===0?(s.flags=r&-65537|128,s):null;case 5:return Jl(s),null;case 13:if(Mt(jt),r=s.memoizedState,r!==null&&r.dehydrated!==null){if(s.alternate===null)throw Error(n(340));hs()}return r=s.flags,r&65536?(s.flags=r&-65537|128,s):null;case 19:return Mt(jt),null;case 4:return xs(),null;case 10:return Vl(s.type._context),null;case 22:case 23:return Nu(),null;case 24:return null;default:return null}}var fa=!1,pn=!1,cg=typeof WeakSet=="function"?WeakSet:Set,Ge=null;function Cs(r,s){var d=r.ref;if(d!==null)if(typeof d=="function")try{d(null)}catch(g){zt(r,s,g)}else d.current=null}function gu(r,s,d){try{d()}catch(g){zt(r,s,g)}}var ff=!1;function dg(r,s){if(Nl=I,r=Vc(),wl(r)){if("selectionStart"in r)var d={start:r.selectionStart,end:r.selectionEnd};else e:{d=(d=r.ownerDocument)&&d.defaultView||window;var g=d.getSelection&&d.getSelection();if(g&&g.rangeCount!==0){d=g.anchorNode;var w=g.anchorOffset,_=g.focusNode;g=g.focusOffset;try{d.nodeType,_.nodeType}catch{d=null;break e}var U=0,ee=-1,ie=-1,we=0,Pe=0,Ue=r,Re=null;t:for(;;){for(var Be;Ue!==d||w!==0&&Ue.nodeType!==3||(ee=U+w),Ue!==_||g!==0&&Ue.nodeType!==3||(ie=U+g),Ue.nodeType===3&&(U+=Ue.nodeValue.length),(Be=Ue.firstChild)!==null;)Re=Ue,Ue=Be;for(;;){if(Ue===r)break t;if(Re===d&&++we===w&&(ee=U),Re===_&&++Pe===g&&(ie=U),(Be=Ue.nextSibling)!==null)break;Ue=Re,Re=Ue.parentNode}Ue=Be}d=ee===-1||ie===-1?null:{start:ee,end:ie}}else d=null}d=d||{start:0,end:0}}else d=null;for(Il={focusedElem:r,selectionRange:d},I=!1,Ge=s;Ge!==null;)if(s=Ge,r=s.child,(s.subtreeFlags&1028)!==0&&r!==null)r.return=s,Ge=r;else for(;Ge!==null;){s=Ge;try{var $e=s.alternate;if((s.flags&1024)!==0)switch(s.tag){case 0:case 11:case 15:break;case 1:if($e!==null){var Ye=$e.memoizedProps,Vt=$e.memoizedState,he=s.stateNode,ue=he.getSnapshotBeforeUpdate(s.elementType===s.type?Ye:tr(s.type,Ye),Vt);he.__reactInternalSnapshotBeforeUpdate=ue}break;case 3:var ye=s.stateNode.containerInfo;ye.nodeType===1?ye.textContent="":ye.nodeType===9&&ye.documentElement&&ye.removeChild(ye.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(n(163))}}catch(qe){zt(s,s.return,qe)}if(r=s.sibling,r!==null){r.return=s.return,Ge=r;break}Ge=s.return}return $e=ff,ff=!1,$e}function oi(r,s,d){var g=s.updateQueue;if(g=g!==null?g.lastEffect:null,g!==null){var w=g=g.next;do{if((w.tag&r)===r){var _=w.destroy;w.destroy=void 0,_!==void 0&&gu(s,d,_)}w=w.next}while(w!==g)}}function ma(r,s){if(s=s.updateQueue,s=s!==null?s.lastEffect:null,s!==null){var d=s=s.next;do{if((d.tag&r)===r){var g=d.create;d.destroy=g()}d=d.next}while(d!==s)}}function yu(r){var s=r.ref;if(s!==null){var d=r.stateNode;switch(r.tag){case 5:r=d;break;default:r=d}typeof s=="function"?s(r):s.current=r}}function mf(r){var s=r.alternate;s!==null&&(r.alternate=null,mf(s)),r.child=null,r.deletions=null,r.sibling=null,r.tag===5&&(s=r.stateNode,s!==null&&(delete s[fr],delete s[Ws],delete s[Rl],delete s[Wh],delete s[Jh])),r.stateNode=null,r.return=null,r.dependencies=null,r.memoizedProps=null,r.memoizedState=null,r.pendingProps=null,r.stateNode=null,r.updateQueue=null}function pf(r){return r.tag===5||r.tag===3||r.tag===4}function hf(r){e:for(;;){for(;r.sibling===null;){if(r.return===null||pf(r.return))return null;r=r.return}for(r.sibling.return=r.return,r=r.sibling;r.tag!==5&&r.tag!==6&&r.tag!==18;){if(r.flags&2||r.child===null||r.tag===4)continue e;r.child.return=r,r=r.child}if(!(r.flags&2))return r.stateNode}}function vu(r,s,d){var g=r.tag;if(g===5||g===6)r=r.stateNode,s?d.nodeType===8?d.parentNode.insertBefore(r,s):d.insertBefore(r,s):(d.nodeType===8?(s=d.parentNode,s.insertBefore(r,d)):(s=d,s.appendChild(r)),d=d._reactRootContainer,d!=null||s.onclick!==null||(s.onclick=Gi));else if(g!==4&&(r=r.child,r!==null))for(vu(r,s,d),r=r.sibling;r!==null;)vu(r,s,d),r=r.sibling}function xu(r,s,d){var g=r.tag;if(g===5||g===6)r=r.stateNode,s?d.insertBefore(r,s):d.appendChild(r);else if(g!==4&&(r=r.child,r!==null))for(xu(r,s,d),r=r.sibling;r!==null;)xu(r,s,d),r=r.sibling}var an=null,nr=!1;function Kr(r,s,d){for(d=d.child;d!==null;)gf(r,s,d),d=d.sibling}function gf(r,s,d){if(An&&typeof An.onCommitFiberUnmount=="function")try{An.onCommitFiberUnmount(po,d)}catch{}switch(d.tag){case 5:pn||Cs(d,s);case 6:var g=an,w=nr;an=null,Kr(r,s,d),an=g,nr=w,an!==null&&(nr?(r=an,d=d.stateNode,r.nodeType===8?r.parentNode.removeChild(d):r.removeChild(d)):an.removeChild(d.stateNode));break;case 18:an!==null&&(nr?(r=an,d=d.stateNode,r.nodeType===8?Ml(r.parentNode,d):r.nodeType===1&&Ml(r,d),y(r)):Ml(an,d.stateNode));break;case 4:g=an,w=nr,an=d.stateNode.containerInfo,nr=!0,Kr(r,s,d),an=g,nr=w;break;case 0:case 11:case 14:case 15:if(!pn&&(g=d.updateQueue,g!==null&&(g=g.lastEffect,g!==null))){w=g=g.next;do{var _=w,U=_.destroy;_=_.tag,U!==void 0&&((_&2)!==0||(_&4)!==0)&&gu(d,s,U),w=w.next}while(w!==g)}Kr(r,s,d);break;case 1:if(!pn&&(Cs(d,s),g=d.stateNode,typeof g.componentWillUnmount=="function"))try{g.props=d.memoizedProps,g.state=d.memoizedState,g.componentWillUnmount()}catch(ee){zt(d,s,ee)}Kr(r,s,d);break;case 21:Kr(r,s,d);break;case 22:d.mode&1?(pn=(g=pn)||d.memoizedState!==null,Kr(r,s,d),pn=g):Kr(r,s,d);break;default:Kr(r,s,d)}}function yf(r){var s=r.updateQueue;if(s!==null){r.updateQueue=null;var d=r.stateNode;d===null&&(d=r.stateNode=new cg),s.forEach(function(g){var w=wg.bind(null,r,g);d.has(g)||(d.add(g),g.then(w,w))})}}function rr(r,s){var d=s.deletions;if(d!==null)for(var g=0;g<d.length;g++){var w=d[g];try{var _=r,U=s,ee=U;e:for(;ee!==null;){switch(ee.tag){case 5:an=ee.stateNode,nr=!1;break e;case 3:an=ee.stateNode.containerInfo,nr=!0;break e;case 4:an=ee.stateNode.containerInfo,nr=!0;break e}ee=ee.return}if(an===null)throw Error(n(160));gf(_,U,w),an=null,nr=!1;var ie=w.alternate;ie!==null&&(ie.return=null),w.return=null}catch(we){zt(w,s,we)}}if(s.subtreeFlags&12854)for(s=s.child;s!==null;)vf(s,r),s=s.sibling}function vf(r,s){var d=r.alternate,g=r.flags;switch(r.tag){case 0:case 11:case 14:case 15:if(rr(s,r),hr(r),g&4){try{oi(3,r,r.return),ma(3,r)}catch(Ye){zt(r,r.return,Ye)}try{oi(5,r,r.return)}catch(Ye){zt(r,r.return,Ye)}}break;case 1:rr(s,r),hr(r),g&512&&d!==null&&Cs(d,d.return);break;case 5:if(rr(s,r),hr(r),g&512&&d!==null&&Cs(d,d.return),r.flags&32){var w=r.stateNode;try{kt(w,"")}catch(Ye){zt(r,r.return,Ye)}}if(g&4&&(w=r.stateNode,w!=null)){var _=r.memoizedProps,U=d!==null?d.memoizedProps:_,ee=r.type,ie=r.updateQueue;if(r.updateQueue=null,ie!==null)try{ee==="input"&&_.type==="radio"&&_.name!=null&&ce(w,_),qn(ee,U);var we=qn(ee,_);for(U=0;U<ie.length;U+=2){var Pe=ie[U],Ue=ie[U+1];Pe==="style"?jn(w,Ue):Pe==="dangerouslySetInnerHTML"?Nt(w,Ue):Pe==="children"?kt(w,Ue):L(w,Pe,Ue,we)}switch(ee){case"input":W(w,_);break;case"textarea":Oe(w,_);break;case"select":var Re=w._wrapperState.wasMultiple;w._wrapperState.wasMultiple=!!_.multiple;var Be=_.value;Be!=null?_e(w,!!_.multiple,Be,!1):Re!==!!_.multiple&&(_.defaultValue!=null?_e(w,!!_.multiple,_.defaultValue,!0):_e(w,!!_.multiple,_.multiple?[]:"",!1))}w[Ws]=_}catch(Ye){zt(r,r.return,Ye)}}break;case 6:if(rr(s,r),hr(r),g&4){if(r.stateNode===null)throw Error(n(162));w=r.stateNode,_=r.memoizedProps;try{w.nodeValue=_}catch(Ye){zt(r,r.return,Ye)}}break;case 3:if(rr(s,r),hr(r),g&4&&d!==null&&d.memoizedState.isDehydrated)try{y(s.containerInfo)}catch(Ye){zt(r,r.return,Ye)}break;case 4:rr(s,r),hr(r);break;case 13:rr(s,r),hr(r),w=r.child,w.flags&8192&&(_=w.memoizedState!==null,w.stateNode.isHidden=_,!_||w.alternate!==null&&w.alternate.memoizedState!==null||(Su=Pt())),g&4&&yf(r);break;case 22:if(Pe=d!==null&&d.memoizedState!==null,r.mode&1?(pn=(we=pn)||Pe,rr(s,r),pn=we):rr(s,r),hr(r),g&8192){if(we=r.memoizedState!==null,(r.stateNode.isHidden=we)&&!Pe&&(r.mode&1)!==0)for(Ge=r,Pe=r.child;Pe!==null;){for(Ue=Ge=Pe;Ge!==null;){switch(Re=Ge,Be=Re.child,Re.tag){case 0:case 11:case 14:case 15:oi(4,Re,Re.return);break;case 1:Cs(Re,Re.return);var $e=Re.stateNode;if(typeof $e.componentWillUnmount=="function"){g=Re,d=Re.return;try{s=g,$e.props=s.memoizedProps,$e.state=s.memoizedState,$e.componentWillUnmount()}catch(Ye){zt(g,d,Ye)}}break;case 5:Cs(Re,Re.return);break;case 22:if(Re.memoizedState!==null){Cf(Ue);continue}}Be!==null?(Be.return=Re,Ge=Be):Cf(Ue)}Pe=Pe.sibling}e:for(Pe=null,Ue=r;;){if(Ue.tag===5){if(Pe===null){Pe=Ue;try{w=Ue.stateNode,we?(_=w.style,typeof _.setProperty=="function"?_.setProperty("display","none","important"):_.display="none"):(ee=Ue.stateNode,ie=Ue.memoizedProps.style,U=ie!=null&&ie.hasOwnProperty("display")?ie.display:null,ee.style.display=Ct("display",U))}catch(Ye){zt(r,r.return,Ye)}}}else if(Ue.tag===6){if(Pe===null)try{Ue.stateNode.nodeValue=we?"":Ue.memoizedProps}catch(Ye){zt(r,r.return,Ye)}}else if((Ue.tag!==22&&Ue.tag!==23||Ue.memoizedState===null||Ue===r)&&Ue.child!==null){Ue.child.return=Ue,Ue=Ue.child;continue}if(Ue===r)break e;for(;Ue.sibling===null;){if(Ue.return===null||Ue.return===r)break e;Pe===Ue&&(Pe=null),Ue=Ue.return}Pe===Ue&&(Pe=null),Ue.sibling.return=Ue.return,Ue=Ue.sibling}}break;case 19:rr(s,r),hr(r),g&4&&yf(r);break;case 21:break;default:rr(s,r),hr(r)}}function hr(r){var s=r.flags;if(s&2){try{e:{for(var d=r.return;d!==null;){if(pf(d)){var g=d;break e}d=d.return}throw Error(n(160))}switch(g.tag){case 5:var w=g.stateNode;g.flags&32&&(kt(w,""),g.flags&=-33);var _=hf(r);xu(r,_,w);break;case 3:case 4:var U=g.stateNode.containerInfo,ee=hf(r);vu(r,ee,U);break;default:throw Error(n(161))}}catch(ie){zt(r,r.return,ie)}r.flags&=-3}s&4096&&(r.flags&=-4097)}function fg(r,s,d){Ge=r,xf(r)}function xf(r,s,d){for(var g=(r.mode&1)!==0;Ge!==null;){var w=Ge,_=w.child;if(w.tag===22&&g){var U=w.memoizedState!==null||fa;if(!U){var ee=w.alternate,ie=ee!==null&&ee.memoizedState!==null||pn;ee=fa;var we=pn;if(fa=U,(pn=ie)&&!we)for(Ge=w;Ge!==null;)U=Ge,ie=U.child,U.tag===22&&U.memoizedState!==null?Sf(w):ie!==null?(ie.return=U,Ge=ie):Sf(w);for(;_!==null;)Ge=_,xf(_),_=_.sibling;Ge=w,fa=ee,pn=we}wf(r)}else(w.subtreeFlags&8772)!==0&&_!==null?(_.return=w,Ge=_):wf(r)}}function wf(r){for(;Ge!==null;){var s=Ge;if((s.flags&8772)!==0){var d=s.alternate;try{if((s.flags&8772)!==0)switch(s.tag){case 0:case 11:case 15:pn||ma(5,s);break;case 1:var g=s.stateNode;if(s.flags&4&&!pn)if(d===null)g.componentDidMount();else{var w=s.elementType===s.type?d.memoizedProps:tr(s.type,d.memoizedProps);g.componentDidUpdate(w,d.memoizedState,g.__reactInternalSnapshotBeforeUpdate)}var _=s.updateQueue;_!==null&&wd(s,_,g);break;case 3:var U=s.updateQueue;if(U!==null){if(d=null,s.child!==null)switch(s.child.tag){case 5:d=s.child.stateNode;break;case 1:d=s.child.stateNode}wd(s,U,d)}break;case 5:var ee=s.stateNode;if(d===null&&s.flags&4){d=ee;var ie=s.memoizedProps;switch(s.type){case"button":case"input":case"select":case"textarea":ie.autoFocus&&d.focus();break;case"img":ie.src&&(d.src=ie.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(s.memoizedState===null){var we=s.alternate;if(we!==null){var Pe=we.memoizedState;if(Pe!==null){var Ue=Pe.dehydrated;Ue!==null&&y(Ue)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(n(163))}pn||s.flags&512&&yu(s)}catch(Re){zt(s,s.return,Re)}}if(s===r){Ge=null;break}if(d=s.sibling,d!==null){d.return=s.return,Ge=d;break}Ge=s.return}}function Cf(r){for(;Ge!==null;){var s=Ge;if(s===r){Ge=null;break}var d=s.sibling;if(d!==null){d.return=s.return,Ge=d;break}Ge=s.return}}function Sf(r){for(;Ge!==null;){var s=Ge;try{switch(s.tag){case 0:case 11:case 15:var d=s.return;try{ma(4,s)}catch(ie){zt(s,d,ie)}break;case 1:var g=s.stateNode;if(typeof g.componentDidMount=="function"){var w=s.return;try{g.componentDidMount()}catch(ie){zt(s,w,ie)}}var _=s.return;try{yu(s)}catch(ie){zt(s,_,ie)}break;case 5:var U=s.return;try{yu(s)}catch(ie){zt(s,U,ie)}}}catch(ie){zt(s,s.return,ie)}if(s===r){Ge=null;break}var ee=s.sibling;if(ee!==null){ee.return=s.return,Ge=ee;break}Ge=s.return}}var mg=Math.ceil,pa=R.ReactCurrentDispatcher,wu=R.ReactCurrentOwner,Gn=R.ReactCurrentBatchConfig,wt=0,tn=null,Ht=null,ln=0,Fn=0,Ss=Hr(0),Yt=0,si=null,Fo=0,ha=0,Cu=0,ii=null,En=null,Su=0,ks=1/0,Ar=null,ga=!1,ku=null,Zr=null,ya=!1,Xr=null,va=0,ai=0,Tu=null,xa=-1,wa=0;function wn(){return(wt&6)!==0?Pt():xa!==-1?xa:xa=Pt()}function eo(r){return(r.mode&1)===0?1:(wt&2)!==0&&ln!==0?ln&-ln:Qh.transition!==null?(wa===0&&(wa=yo()),wa):(r=xt,r!==0||(r=window.event,r=r===void 0?16:gt(r.type)),r)}function or(r,s,d,g){if(50<ai)throw ai=0,Tu=null,Error(n(185));vo(r,d,g),((wt&2)===0||r!==tn)&&(r===tn&&((wt&2)===0&&(ha|=d),Yt===4&&to(r,ln)),bn(r,g),d===1&&wt===0&&(s.mode&1)===0&&(ks=Pt()+500,Ji&&Jr()))}function bn(r,s){var d=r.callbackNode;Ko(r,s);var g=Ur(r,r===tn?ln:0);if(g===0)d!==null&&Jo(d),r.callbackNode=null,r.callbackPriority=0;else if(s=g&-g,r.callbackPriority!==s){if(d!=null&&Jo(d),s===1)r.tag===0?Yh(Tf.bind(null,r)):ld(Tf.bind(null,r)),$h(function(){(wt&6)===0&&Jr()}),d=null;else{switch(Rs(g)){case 1:d=Yo;break;case 4:d=fo;break;case 16:d=mo;break;case 536870912:d=Qo;break;default:d=mo}d=Mf(d,kf.bind(null,r))}r.callbackPriority=s,r.callbackNode=d}}function kf(r,s){if(xa=-1,wa=0,(wt&6)!==0)throw Error(n(327));var d=r.callbackNode;if(Ts()&&r.callbackNode!==d)return null;var g=Ur(r,r===tn?ln:0);if(g===0)return null;if((g&30)!==0||(g&r.expiredLanes)!==0||s)s=Ca(r,g);else{s=g;var w=wt;wt|=2;var _=Ef();(tn!==r||ln!==s)&&(Ar=null,ks=Pt()+500,Uo(r,s));do try{gg();break}catch(ee){_f(r,ee)}while(!0);Bl(),pa.current=_,wt=w,Ht!==null?s=0:(tn=null,ln=0,s=Yt)}if(s!==0){if(s===2&&(w=jr(r),w!==0&&(g=w,s=_u(r,w))),s===1)throw d=si,Uo(r,0),to(r,g),bn(r,Pt()),d;if(s===6)to(r,g);else{if(w=r.current.alternate,(g&30)===0&&!pg(w)&&(s=Ca(r,g),s===2&&(_=jr(r),_!==0&&(g=_,s=_u(r,_))),s===1))throw d=si,Uo(r,0),to(r,g),bn(r,Pt()),d;switch(r.finishedWork=w,r.finishedLanes=g,s){case 0:case 1:throw Error(n(345));case 2:jo(r,En,Ar);break;case 3:if(to(r,g),(g&130023424)===g&&(s=Su+500-Pt(),10<s)){if(Ur(r,0)!==0)break;if(w=r.suspendedLanes,(w&g)!==g){wn(),r.pingedLanes|=r.suspendedLanes&w;break}r.timeoutHandle=Dl(jo.bind(null,r,En,Ar),s);break}jo(r,En,Ar);break;case 4:if(to(r,g),(g&4194240)===g)break;for(s=r.eventTimes,w=-1;0<g;){var U=31-Dn(g);_=1<<U,U=s[U],U>w&&(w=U),g&=~_}if(g=w,g=Pt()-g,g=(120>g?120:480>g?480:1080>g?1080:1920>g?1920:3e3>g?3e3:4320>g?4320:1960*mg(g/1960))-g,10<g){r.timeoutHandle=Dl(jo.bind(null,r,En,Ar),g);break}jo(r,En,Ar);break;case 5:jo(r,En,Ar);break;default:throw Error(n(329))}}}return bn(r,Pt()),r.callbackNode===d?kf.bind(null,r):null}function _u(r,s){var d=ii;return r.current.memoizedState.isDehydrated&&(Uo(r,s).flags|=256),r=Ca(r,s),r!==2&&(s=En,En=d,s!==null&&Eu(s)),r}function Eu(r){En===null?En=r:En.push.apply(En,r)}function pg(r){for(var s=r;;){if(s.flags&16384){var d=s.updateQueue;if(d!==null&&(d=d.stores,d!==null))for(var g=0;g<d.length;g++){var w=d[g],_=w.getSnapshot;w=w.value;try{if(!Xn(_(),w))return!1}catch{return!1}}}if(d=s.child,s.subtreeFlags&16384&&d!==null)d.return=s,s=d;else{if(s===r)break;for(;s.sibling===null;){if(s.return===null||s.return===r)return!0;s=s.return}s.sibling.return=s.return,s=s.sibling}}return!0}function to(r,s){for(s&=~Cu,s&=~ha,r.suspendedLanes|=s,r.pingedLanes&=~s,r=r.expirationTimes;0<s;){var d=31-Dn(s),g=1<<d;r[d]=-1,s&=~g}}function Tf(r){if((wt&6)!==0)throw Error(n(327));Ts();var s=Ur(r,0);if((s&1)===0)return bn(r,Pt()),null;var d=Ca(r,s);if(r.tag!==0&&d===2){var g=jr(r);g!==0&&(s=g,d=_u(r,g))}if(d===1)throw d=si,Uo(r,0),to(r,s),bn(r,Pt()),d;if(d===6)throw Error(n(345));return r.finishedWork=r.current.alternate,r.finishedLanes=s,jo(r,En,Ar),bn(r,Pt()),null}function bu(r,s){var d=wt;wt|=1;try{return r(s)}finally{wt=d,wt===0&&(ks=Pt()+500,Ji&&Jr())}}function Lo(r){Xr!==null&&Xr.tag===0&&(wt&6)===0&&Ts();var s=wt;wt|=1;var d=Gn.transition,g=xt;try{if(Gn.transition=null,xt=1,r)return r()}finally{xt=g,Gn.transition=d,wt=s,(wt&6)===0&&Jr()}}function Nu(){Fn=Ss.current,Mt(Ss)}function Uo(r,s){r.finishedWork=null,r.finishedLanes=0;var d=r.timeoutHandle;if(d!==-1&&(r.timeoutHandle=-1,Gh(d)),Ht!==null)for(d=Ht.return;d!==null;){var g=d;switch(Ul(g),g.tag){case 1:g=g.type.childContextTypes,g!=null&&Hi();break;case 3:xs(),Mt(kn),Mt(dn),Ql();break;case 5:Jl(g);break;case 4:xs();break;case 13:Mt(jt);break;case 19:Mt(jt);break;case 10:Vl(g.type._context);break;case 22:case 23:Nu()}d=d.return}if(tn=r,Ht=r=no(r.current,null),ln=Fn=s,Yt=0,si=null,Cu=ha=Fo=0,En=ii=null,Mo!==null){for(s=0;s<Mo.length;s++)if(d=Mo[s],g=d.interleaved,g!==null){d.interleaved=null;var w=g.next,_=d.pending;if(_!==null){var U=_.next;_.next=w,g.next=U}d.pending=g}Mo=null}return r}function _f(r,s){do{var d=Ht;try{if(Bl(),oa.current=la,sa){for(var g=qt.memoizedState;g!==null;){var w=g.queue;w!==null&&(w.pending=null),g=g.next}sa=!1}if(Po=0,en=Jt=qt=null,Xs=!1,ei=0,wu.current=null,d===null||d.return===null){Yt=1,si=s,Ht=null;break}e:{var _=r,U=d.return,ee=d,ie=s;if(s=ln,ee.flags|=32768,ie!==null&&typeof ie=="object"&&typeof ie.then=="function"){var we=ie,Pe=ee,Ue=Pe.tag;if((Pe.mode&1)===0&&(Ue===0||Ue===11||Ue===15)){var Re=Pe.alternate;Re?(Pe.updateQueue=Re.updateQueue,Pe.memoizedState=Re.memoizedState,Pe.lanes=Re.lanes):(Pe.updateQueue=null,Pe.memoizedState=null)}var Be=Yd(U);if(Be!==null){Be.flags&=-257,Qd(Be,U,ee,_,s),Be.mode&1&&Jd(_,we,s),s=Be,ie=we;var $e=s.updateQueue;if($e===null){var Ye=new Set;Ye.add(ie),s.updateQueue=Ye}else $e.add(ie);break e}else{if((s&1)===0){Jd(_,we,s),Iu();break e}ie=Error(n(426))}}else if(Lt&&ee.mode&1){var Vt=Yd(U);if(Vt!==null){(Vt.flags&65536)===0&&(Vt.flags|=256),Qd(Vt,U,ee,_,s),zl(ws(ie,ee));break e}}_=ie=ws(ie,ee),Yt!==4&&(Yt=2),ii===null?ii=[_]:ii.push(_),_=U;do{switch(_.tag){case 3:_.flags|=65536,s&=-s,_.lanes|=s;var he=Hd(_,ie,s);xd(_,he);break e;case 1:ee=ie;var ue=_.type,ye=_.stateNode;if((_.flags&128)===0&&(typeof ue.getDerivedStateFromError=="function"||ye!==null&&typeof ye.componentDidCatch=="function"&&(Zr===null||!Zr.has(ye)))){_.flags|=65536,s&=-s,_.lanes|=s;var qe=Wd(_,ee,s);xd(_,qe);break e}}_=_.return}while(_!==null)}Nf(d)}catch(Ze){s=Ze,Ht===d&&d!==null&&(Ht=d=d.return);continue}break}while(!0)}function Ef(){var r=pa.current;return pa.current=la,r===null?la:r}function Iu(){(Yt===0||Yt===3||Yt===2)&&(Yt=4),tn===null||(Fo&268435455)===0&&(ha&268435455)===0||to(tn,ln)}function Ca(r,s){var d=wt;wt|=2;var g=Ef();(tn!==r||ln!==s)&&(Ar=null,Uo(r,s));do try{hg();break}catch(w){_f(r,w)}while(!0);if(Bl(),wt=d,pa.current=g,Ht!==null)throw Error(n(261));return tn=null,ln=0,Yt}function hg(){for(;Ht!==null;)bf(Ht)}function gg(){for(;Ht!==null&&!Ti();)bf(Ht)}function bf(r){var s=Df(r.alternate,r,Fn);r.memoizedProps=r.pendingProps,s===null?Nf(r):Ht=s,wu.current=null}function Nf(r){var s=r;do{var d=s.alternate;if(r=s.return,(s.flags&32768)===0){if(d=lg(d,s,Fn),d!==null){Ht=d;return}}else{if(d=ug(d,s),d!==null){d.flags&=32767,Ht=d;return}if(r!==null)r.flags|=32768,r.subtreeFlags=0,r.deletions=null;else{Yt=6,Ht=null;return}}if(s=s.sibling,s!==null){Ht=s;return}Ht=s=r}while(s!==null);Yt===0&&(Yt=5)}function jo(r,s,d){var g=xt,w=Gn.transition;try{Gn.transition=null,xt=1,yg(r,s,d,g)}finally{Gn.transition=w,xt=g}return null}function yg(r,s,d,g){do Ts();while(Xr!==null);if((wt&6)!==0)throw Error(n(327));d=r.finishedWork;var w=r.finishedLanes;if(d===null)return null;if(r.finishedWork=null,r.finishedLanes=0,d===r.current)throw Error(n(177));r.callbackNode=null,r.callbackPriority=0;var _=d.lanes|d.childLanes;if(nl(r,_),r===tn&&(Ht=tn=null,ln=0),(d.subtreeFlags&2064)===0&&(d.flags&2064)===0||ya||(ya=!0,Mf(mo,function(){return Ts(),null})),_=(d.flags&15990)!==0,(d.subtreeFlags&15990)!==0||_){_=Gn.transition,Gn.transition=null;var U=xt;xt=1;var ee=wt;wt|=4,wu.current=null,dg(r,d),vf(d,r),Uh(Il),I=!!Nl,Il=Nl=null,r.current=d,fg(d),_i(),wt=ee,xt=U,Gn.transition=_}else r.current=d;if(ya&&(ya=!1,Xr=r,va=w),_=r.pendingLanes,_===0&&(Zr=null),Ei(d.stateNode),bn(r,Pt()),s!==null)for(g=r.onRecoverableError,d=0;d<s.length;d++)w=s[d],g(w.value,{componentStack:w.stack,digest:w.digest});if(ga)throw ga=!1,r=ku,ku=null,r;return(va&1)!==0&&r.tag!==0&&Ts(),_=r.pendingLanes,(_&1)!==0?r===Tu?ai++:(ai=0,Tu=r):ai=0,Jr(),null}function Ts(){if(Xr!==null){var r=Rs(va),s=Gn.transition,d=xt;try{if(Gn.transition=null,xt=16>r?16:r,Xr===null)var g=!1;else{if(r=Xr,Xr=null,va=0,(wt&6)!==0)throw Error(n(331));var w=wt;for(wt|=4,Ge=r.current;Ge!==null;){var _=Ge,U=_.child;if((Ge.flags&16)!==0){var ee=_.deletions;if(ee!==null){for(var ie=0;ie<ee.length;ie++){var we=ee[ie];for(Ge=we;Ge!==null;){var Pe=Ge;switch(Pe.tag){case 0:case 11:case 15:oi(8,Pe,_)}var Ue=Pe.child;if(Ue!==null)Ue.return=Pe,Ge=Ue;else for(;Ge!==null;){Pe=Ge;var Re=Pe.sibling,Be=Pe.return;if(mf(Pe),Pe===we){Ge=null;break}if(Re!==null){Re.return=Be,Ge=Re;break}Ge=Be}}}var $e=_.alternate;if($e!==null){var Ye=$e.child;if(Ye!==null){$e.child=null;do{var Vt=Ye.sibling;Ye.sibling=null,Ye=Vt}while(Ye!==null)}}Ge=_}}if((_.subtreeFlags&2064)!==0&&U!==null)U.return=_,Ge=U;else e:for(;Ge!==null;){if(_=Ge,(_.flags&2048)!==0)switch(_.tag){case 0:case 11:case 15:oi(9,_,_.return)}var he=_.sibling;if(he!==null){he.return=_.return,Ge=he;break e}Ge=_.return}}var ue=r.current;for(Ge=ue;Ge!==null;){U=Ge;var ye=U.child;if((U.subtreeFlags&2064)!==0&&ye!==null)ye.return=U,Ge=ye;else e:for(U=ue;Ge!==null;){if(ee=Ge,(ee.flags&2048)!==0)try{switch(ee.tag){case 0:case 11:case 15:ma(9,ee)}}catch(Ze){zt(ee,ee.return,Ze)}if(ee===U){Ge=null;break e}var qe=ee.sibling;if(qe!==null){qe.return=ee.return,Ge=qe;break e}Ge=ee.return}}if(wt=w,Jr(),An&&typeof An.onPostCommitFiberRoot=="function")try{An.onPostCommitFiberRoot(po,r)}catch{}g=!0}return g}finally{xt=d,Gn.transition=s}}return!1}function If(r,s,d){s=ws(d,s),s=Hd(r,s,1),r=Qr(r,s,1),s=wn(),r!==null&&(vo(r,1,s),bn(r,s))}function zt(r,s,d){if(r.tag===3)If(r,r,d);else for(;s!==null;){if(s.tag===3){If(s,r,d);break}else if(s.tag===1){var g=s.stateNode;if(typeof s.type.getDerivedStateFromError=="function"||typeof g.componentDidCatch=="function"&&(Zr===null||!Zr.has(g))){r=ws(d,r),r=Wd(s,r,1),s=Qr(s,r,1),r=wn(),s!==null&&(vo(s,1,r),bn(s,r));break}}s=s.return}}function vg(r,s,d){var g=r.pingCache;g!==null&&g.delete(s),s=wn(),r.pingedLanes|=r.suspendedLanes&d,tn===r&&(ln&d)===d&&(Yt===4||Yt===3&&(ln&130023424)===ln&&500>Pt()-Su?Uo(r,0):Cu|=d),bn(r,s)}function Af(r,s){s===0&&((r.mode&1)===0?s=1:(s=Et,Et<<=1,(Et&130023424)===0&&(Et=4194304)));var d=wn();r=br(r,s),r!==null&&(vo(r,s,d),bn(r,d))}function xg(r){var s=r.memoizedState,d=0;s!==null&&(d=s.retryLane),Af(r,d)}function wg(r,s){var d=0;switch(r.tag){case 13:var g=r.stateNode,w=r.memoizedState;w!==null&&(d=w.retryLane);break;case 19:g=r.stateNode;break;default:throw Error(n(314))}g!==null&&g.delete(s),Af(r,d)}var Df;Df=function(r,s,d){if(r!==null)if(r.memoizedProps!==s.pendingProps||kn.current)_n=!0;else{if((r.lanes&d)===0&&(s.flags&128)===0)return _n=!1,ag(r,s,d);_n=(r.flags&131072)!==0}else _n=!1,Lt&&(s.flags&1048576)!==0&&ud(s,Qi,s.index);switch(s.lanes=0,s.tag){case 2:var g=s.type;da(r,s),r=s.pendingProps;var w=fs(s,dn.current);vs(s,d),w=Xl(null,s,g,r,w,d);var _=eu();return s.flags|=1,typeof w=="object"&&w!==null&&typeof w.render=="function"&&w.$$typeof===void 0?(s.tag=1,s.memoizedState=null,s.updateQueue=null,Tn(g)?(_=!0,Wi(s)):_=!1,s.memoizedState=w.state!==null&&w.state!==void 0?w.state:null,Hl(s),w.updater=ua,s.stateNode=w,w._reactInternals=s,iu(s,g,r,d),s=cu(null,s,g,!0,_,d)):(s.tag=0,Lt&&_&&Ll(s),xn(null,s,w,d),s=s.child),s;case 16:g=s.elementType;e:{switch(da(r,s),r=s.pendingProps,w=g._init,g=w(g._payload),s.type=g,w=s.tag=Sg(g),r=tr(g,r),w){case 0:s=uu(null,s,g,r,d);break e;case 1:s=nf(null,s,g,r,d);break e;case 11:s=Kd(null,s,g,r,d);break e;case 14:s=Zd(null,s,g,tr(g.type,r),d);break e}throw Error(n(306,g,""))}return s;case 0:return g=s.type,w=s.pendingProps,w=s.elementType===g?w:tr(g,w),uu(r,s,g,w,d);case 1:return g=s.type,w=s.pendingProps,w=s.elementType===g?w:tr(g,w),nf(r,s,g,w,d);case 3:e:{if(rf(s),r===null)throw Error(n(387));g=s.pendingProps,_=s.memoizedState,w=_.element,vd(r,s),na(s,g,null,d);var U=s.memoizedState;if(g=U.element,_.isDehydrated)if(_={element:g,isDehydrated:!1,cache:U.cache,pendingSuspenseBoundaries:U.pendingSuspenseBoundaries,transitions:U.transitions},s.updateQueue.baseState=_,s.memoizedState=_,s.flags&256){w=ws(Error(n(423)),s),s=of(r,s,g,d,w);break e}else if(g!==w){w=ws(Error(n(424)),s),s=of(r,s,g,d,w);break e}else for(Pn=$r(s.stateNode.containerInfo.firstChild),Rn=s,Lt=!0,er=null,d=gd(s,null,g,d),s.child=d;d;)d.flags=d.flags&-3|4096,d=d.sibling;else{if(hs(),g===w){s=Ir(r,s,d);break e}xn(r,s,g,d)}s=s.child}return s;case 5:return Cd(s),r===null&&ql(s),g=s.type,w=s.pendingProps,_=r!==null?r.memoizedProps:null,U=w.children,Al(g,w)?U=null:_!==null&&Al(g,_)&&(s.flags|=32),tf(r,s),xn(r,s,U,d),s.child;case 6:return r===null&&ql(s),null;case 13:return sf(r,s,d);case 4:return Wl(s,s.stateNode.containerInfo),g=s.pendingProps,r===null?s.child=gs(s,null,g,d):xn(r,s,g,d),s.child;case 11:return g=s.type,w=s.pendingProps,w=s.elementType===g?w:tr(g,w),Kd(r,s,g,w,d);case 7:return xn(r,s,s.pendingProps,d),s.child;case 8:return xn(r,s,s.pendingProps.children,d),s.child;case 12:return xn(r,s,s.pendingProps.children,d),s.child;case 10:e:{if(g=s.type._context,w=s.pendingProps,_=s.memoizedProps,U=w.value,At(Xi,g._currentValue),g._currentValue=U,_!==null)if(Xn(_.value,U)){if(_.children===w.children&&!kn.current){s=Ir(r,s,d);break e}}else for(_=s.child,_!==null&&(_.return=s);_!==null;){var ee=_.dependencies;if(ee!==null){U=_.child;for(var ie=ee.firstContext;ie!==null;){if(ie.context===g){if(_.tag===1){ie=Nr(-1,d&-d),ie.tag=2;var we=_.updateQueue;if(we!==null){we=we.shared;var Pe=we.pending;Pe===null?ie.next=ie:(ie.next=Pe.next,Pe.next=ie),we.pending=ie}}_.lanes|=d,ie=_.alternate,ie!==null&&(ie.lanes|=d),Gl(_.return,d,s),ee.lanes|=d;break}ie=ie.next}}else if(_.tag===10)U=_.type===s.type?null:_.child;else if(_.tag===18){if(U=_.return,U===null)throw Error(n(341));U.lanes|=d,ee=U.alternate,ee!==null&&(ee.lanes|=d),Gl(U,d,s),U=_.sibling}else U=_.child;if(U!==null)U.return=_;else for(U=_;U!==null;){if(U===s){U=null;break}if(_=U.sibling,_!==null){_.return=U.return,U=_;break}U=U.return}_=U}xn(r,s,w.children,d),s=s.child}return s;case 9:return w=s.type,g=s.pendingProps.children,vs(s,d),w=Bn(w),g=g(w),s.flags|=1,xn(r,s,g,d),s.child;case 14:return g=s.type,w=tr(g,s.pendingProps),w=tr(g.type,w),Zd(r,s,g,w,d);case 15:return Xd(r,s,s.type,s.pendingProps,d);case 17:return g=s.type,w=s.pendingProps,w=s.elementType===g?w:tr(g,w),da(r,s),s.tag=1,Tn(g)?(r=!0,Wi(s)):r=!1,vs(s,d),Gd(s,g,w),iu(s,g,w,d),cu(null,s,g,!0,r,d);case 19:return lf(r,s,d);case 22:return ef(r,s,d)}throw Error(n(156,s.tag))};function Mf(r,s){return uo(r,s)}function Cg(r,s,d,g){this.tag=r,this.key=d,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=s,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=g,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function $n(r,s,d,g){return new Cg(r,s,d,g)}function Au(r){return r=r.prototype,!(!r||!r.isReactComponent)}function Sg(r){if(typeof r=="function")return Au(r)?1:0;if(r!=null){if(r=r.$$typeof,r===Q)return 11;if(r===pe)return 14}return 2}function no(r,s){var d=r.alternate;return d===null?(d=$n(r.tag,s,r.key,r.mode),d.elementType=r.elementType,d.type=r.type,d.stateNode=r.stateNode,d.alternate=r,r.alternate=d):(d.pendingProps=s,d.type=r.type,d.flags=0,d.subtreeFlags=0,d.deletions=null),d.flags=r.flags&14680064,d.childLanes=r.childLanes,d.lanes=r.lanes,d.child=r.child,d.memoizedProps=r.memoizedProps,d.memoizedState=r.memoizedState,d.updateQueue=r.updateQueue,s=r.dependencies,d.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext},d.sibling=r.sibling,d.index=r.index,d.ref=r.ref,d}function Sa(r,s,d,g,w,_){var U=2;if(g=r,typeof r=="function")Au(r)&&(U=1);else if(typeof r=="string")U=5;else e:switch(r){case $:return qo(d.children,w,_,s);case oe:U=8,w|=8;break;case J:return r=$n(12,d,s,w|2),r.elementType=J,r.lanes=_,r;case Y:return r=$n(13,d,s,w),r.elementType=Y,r.lanes=_,r;case M:return r=$n(19,d,s,w),r.elementType=M,r.lanes=_,r;case ve:return ka(d,w,_,s);default:if(typeof r=="object"&&r!==null)switch(r.$$typeof){case Z:U=10;break e;case le:U=9;break e;case Q:U=11;break e;case pe:U=14;break e;case be:U=16,g=null;break e}throw Error(n(130,r==null?r:typeof r,""))}return s=$n(U,d,s,w),s.elementType=r,s.type=g,s.lanes=_,s}function qo(r,s,d,g){return r=$n(7,r,g,s),r.lanes=d,r}function ka(r,s,d,g){return r=$n(22,r,g,s),r.elementType=ve,r.lanes=d,r.stateNode={isHidden:!1},r}function Du(r,s,d){return r=$n(6,r,null,s),r.lanes=d,r}function Mu(r,s,d){return s=$n(4,r.children!==null?r.children:[],r.key,s),s.lanes=d,s.stateNode={containerInfo:r.containerInfo,pendingChildren:null,implementation:r.implementation},s}function kg(r,s,d,g,w){this.tag=s,this.containerInfo=r,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Sr(0),this.expirationTimes=Sr(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Sr(0),this.identifierPrefix=g,this.onRecoverableError=w,this.mutableSourceEagerHydrationData=null}function Ru(r,s,d,g,w,_,U,ee,ie){return r=new kg(r,s,d,ee,ie),s===1?(s=1,_===!0&&(s|=8)):s=0,_=$n(3,null,null,s),r.current=_,_.stateNode=r,_.memoizedState={element:g,isDehydrated:d,cache:null,transitions:null,pendingSuspenseBoundaries:null},Hl(_),r}function Tg(r,s,d){var g=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:G,key:g==null?null:""+g,children:r,containerInfo:s,implementation:d}}function Rf(r){if(!r)return Wr;r=r._reactInternals;e:{if(lr(r)!==r||r.tag!==1)throw Error(n(170));var s=r;do{switch(s.tag){case 3:s=s.stateNode.context;break e;case 1:if(Tn(s.type)){s=s.stateNode.__reactInternalMemoizedMergedChildContext;break e}}s=s.return}while(s!==null);throw Error(n(171))}if(r.tag===1){var d=r.type;if(Tn(d))return id(r,d,s)}return s}function Pf(r,s,d,g,w,_,U,ee,ie){return r=Ru(d,g,!0,r,w,_,U,ee,ie),r.context=Rf(null),d=r.current,g=wn(),w=eo(d),_=Nr(g,w),_.callback=s??null,Qr(d,_,w),r.current.lanes=w,vo(r,w,g),bn(r,g),r}function Ta(r,s,d,g){var w=s.current,_=wn(),U=eo(w);return d=Rf(d),s.context===null?s.context=d:s.pendingContext=d,s=Nr(_,U),s.payload={element:r},g=g===void 0?null:g,g!==null&&(s.callback=g),r=Qr(w,s,U),r!==null&&(or(r,w,U,_),ta(r,w,U)),U}function _a(r){if(r=r.current,!r.child)return null;switch(r.child.tag){case 5:return r.child.stateNode;default:return r.child.stateNode}}function Ff(r,s){if(r=r.memoizedState,r!==null&&r.dehydrated!==null){var d=r.retryLane;r.retryLane=d!==0&&d<s?d:s}}function Pu(r,s){Ff(r,s),(r=r.alternate)&&Ff(r,s)}function _g(){return null}var Lf=typeof reportError=="function"?reportError:function(r){console.error(r)};function Fu(r){this._internalRoot=r}Ea.prototype.render=Fu.prototype.render=function(r){var s=this._internalRoot;if(s===null)throw Error(n(409));Ta(r,s,null,null)},Ea.prototype.unmount=Fu.prototype.unmount=function(){var r=this._internalRoot;if(r!==null){this._internalRoot=null;var s=r.containerInfo;Lo(function(){Ta(null,r,null,null)}),s[kr]=null}};function Ea(r){this._internalRoot=r}Ea.prototype.unstable_scheduleHydration=function(r){if(r){var s=wo();r={blockedOn:null,target:r,priority:s};for(var d=0;d<He.length&&s!==0&&s<He[d].priority;d++);He.splice(d,0,r),d===0&&Or(r)}};function Lu(r){return!(!r||r.nodeType!==1&&r.nodeType!==9&&r.nodeType!==11)}function ba(r){return!(!r||r.nodeType!==1&&r.nodeType!==9&&r.nodeType!==11&&(r.nodeType!==8||r.nodeValue!==" react-mount-point-unstable "))}function Uf(){}function Eg(r,s,d,g,w){if(w){if(typeof g=="function"){var _=g;g=function(){var we=_a(U);_.call(we)}}var U=Pf(s,g,r,0,null,!1,!1,"",Uf);return r._reactRootContainer=U,r[kr]=U.current,$s(r.nodeType===8?r.parentNode:r),Lo(),U}for(;w=r.lastChild;)r.removeChild(w);if(typeof g=="function"){var ee=g;g=function(){var we=_a(ie);ee.call(we)}}var ie=Ru(r,0,!1,null,null,!1,!1,"",Uf);return r._reactRootContainer=ie,r[kr]=ie.current,$s(r.nodeType===8?r.parentNode:r),Lo(function(){Ta(s,ie,d,g)}),ie}function Na(r,s,d,g,w){var _=d._reactRootContainer;if(_){var U=_;if(typeof w=="function"){var ee=w;w=function(){var ie=_a(U);ee.call(ie)}}Ta(s,U,r,w)}else U=Eg(d,s,r,w,g);return _a(U)}Xo=function(r){switch(r.tag){case 3:var s=r.stateNode;if(s.current.memoizedState.isDehydrated){var d=Qn(s.pendingLanes);d!==0&&(Zo(s,d|1),bn(s,Pt()),(wt&6)===0&&(ks=Pt()+500,Jr()))}break;case 13:Lo(function(){var g=br(r,1);if(g!==null){var w=wn();or(g,r,1,w)}}),Pu(r,1)}},xo=function(r){if(r.tag===13){var s=br(r,134217728);if(s!==null){var d=wn();or(s,r,134217728,d)}Pu(r,134217728)}},Ii=function(r){if(r.tag===13){var s=eo(r),d=br(r,s);if(d!==null){var g=wn();or(d,r,s,g)}Pu(r,s)}},wo=function(){return xt},Co=function(r,s){var d=xt;try{return xt=r,s()}finally{xt=d}},yn=function(r,s,d){switch(s){case"input":if(W(r,d),s=d.name,d.type==="radio"&&s!=null){for(d=r;d.parentNode;)d=d.parentNode;for(d=d.querySelectorAll("input[name="+JSON.stringify(""+s)+'][type="radio"]'),s=0;s<d.length;s++){var g=d[s];if(g!==r&&g.form===r.form){var w=$i(g);if(!w)throw Error(n(90));je(g),W(g,w)}}}break;case"textarea":Oe(r,d);break;case"select":s=d.value,s!=null&&_e(r,!!d.multiple,s,!1)}},Ee=bu,st=Lo;var bg={usingClientEntryPoint:!1,Events:[Js,cs,$i,ze,Je,bu]},li={findFiberByHostInstance:No,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},Ng={bundleType:li.bundleType,version:li.version,rendererPackageName:li.rendererPackageName,rendererConfig:li.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:R.ReactCurrentDispatcher,findHostInstanceByFiber:function(r){return r=lo(r),r===null?null:r.stateNode},findFiberByHostInstance:li.findFiberByHostInstance||_g,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Ia=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Ia.isDisabled&&Ia.supportsFiber)try{po=Ia.inject(Ng),An=Ia}catch{}}return Nn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=bg,Nn.createPortal=function(r,s){var d=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Lu(s))throw Error(n(200));return Tg(r,s,null,d)},Nn.createRoot=function(r,s){if(!Lu(r))throw Error(n(299));var d=!1,g="",w=Lf;return s!=null&&(s.unstable_strictMode===!0&&(d=!0),s.identifierPrefix!==void 0&&(g=s.identifierPrefix),s.onRecoverableError!==void 0&&(w=s.onRecoverableError)),s=Ru(r,1,!1,null,null,d,!1,g,w),r[kr]=s.current,$s(r.nodeType===8?r.parentNode:r),new Fu(s)},Nn.findDOMNode=function(r){if(r==null)return null;if(r.nodeType===1)return r;var s=r._reactInternals;if(s===void 0)throw typeof r.render=="function"?Error(n(188)):(r=Object.keys(r).join(","),Error(n(268,r)));return r=lo(s),r=r===null?null:r.stateNode,r},Nn.flushSync=function(r){return Lo(r)},Nn.hydrate=function(r,s,d){if(!ba(s))throw Error(n(200));return Na(null,r,s,!0,d)},Nn.hydrateRoot=function(r,s,d){if(!Lu(r))throw Error(n(405));var g=d!=null&&d.hydratedSources||null,w=!1,_="",U=Lf;if(d!=null&&(d.unstable_strictMode===!0&&(w=!0),d.identifierPrefix!==void 0&&(_=d.identifierPrefix),d.onRecoverableError!==void 0&&(U=d.onRecoverableError)),s=Pf(s,null,r,1,d??null,w,!1,_,U),r[kr]=s.current,$s(r),g)for(r=0;r<g.length;r++)d=g[r],w=d._getVersion,w=w(d._source),s.mutableSourceEagerHydrationData==null?s.mutableSourceEagerHydrationData=[d,w]:s.mutableSourceEagerHydrationData.push(d,w);return new Ea(s)},Nn.render=function(r,s,d){if(!ba(s))throw Error(n(200));return Na(null,r,s,!1,d)},Nn.unmountComponentAtNode=function(r){if(!ba(r))throw Error(n(40));return r._reactRootContainer?(Lo(function(){Na(null,null,r,!1,function(){r._reactRootContainer=null,r[kr]=null})}),!0):!1},Nn.unstable_batchedUpdates=bu,Nn.unstable_renderSubtreeIntoContainer=function(r,s,d,g){if(!ba(d))throw Error(n(200));if(r==null||r._reactInternals===void 0)throw Error(n(38));return Na(r,s,d,!1,g)},Nn.version="18.3.1-next-f1338f8080-20240426",Nn}var $f;function jg(){if($f)return qu.exports;$f=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}return t(),qu.exports=Ug(),qu.exports}var Hf;function qg(){if(Hf)return Da;Hf=1;var t=jg();return Da.createRoot=t.createRoot,Da.hydrateRoot=t.hydrateRoot,Da}var zg=qg();const Og=yi(zg);var ft=(t=>(t[t.Again=1]="Again",t[t.Hard=2]="Hard",t[t.Good=3]="Good",t[t.Easy=4]="Easy",t))(ft||{}),We=(t=>(t.Flashcard="flashcard",t.Quiz="quiz",t))(We||{});const Bg="cogniflow-sync";let Bu=null;const Up=()=>(Bu||(Bu=new BroadcastChannel(Bg)),Bu),xr=()=>{Up().postMessage({type:"data-changed"})},Vg=t=>{const e=Up(),n=()=>{t()};return e.addEventListener("message",n),()=>{e.removeEventListener("message",n)}},Sc="Europe/Stockholm",Gg=()=>new Date().toLocaleDateString("sv-SE",{timeZone:Sc}),jp=()=>new Date().toLocaleString("sv-SE",{timeZone:Sc,year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1}).replace(/ /g,"_").replace(/:/g,"-"),$g=t=>{if(!t)return"N/A";try{return new Date(t).toLocaleString("sv-SE",{timeZone:Sc,year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"})}catch(e){return console.error("Failed to format date string:",t,e),"Invalid Date"}},qp="CogniFlowDB",Hg=6,gr="decks",Jn="folders",yr="deckSeries",vr="sessions",Mr="reviews";let so=null;function Wt(){return so||(so=new Promise((t,e)=>{const n=indexedDB.open(qp,Hg);n.onblocked=o=>{console.error("IndexedDB open request blocked. Please close other tabs with this app open.",o),e(new Error("Database upgrade is required, but it is blocked by another open tab of this application. Please close all other tabs and reload."))},n.onerror=()=>{var o;console.error("IndexedDB error:",n.error),so=null,e(new Error(`IndexedDB error: ${((o=n.error)==null?void 0:o.message)||"Unknown error"}`))},n.onsuccess=()=>{const o=n.result;o.onclose=()=>{so=null,console.warn("Database connection closed.")},t(o)},n.onupgradeneeded=o=>{const i=o.target.result;if(i.objectStoreNames.contains(gr)||i.createObjectStore(gr,{keyPath:"id"}),i.objectStoreNames.contains(Jn)||i.createObjectStore(Jn,{keyPath:"id"}),o.oldVersion<3&&!i.objectStoreNames.contains(yr)&&i.createObjectStore(yr,{keyPath:"id"}),o.oldVersion<4&&!i.objectStoreNames.contains(vr)&&i.createObjectStore(vr,{keyPath:"id"}),o.oldVersion<5&&(i.objectStoreNames.contains(Mr)||i.createObjectStore(Mr,{keyPath:"id",autoIncrement:!0}).createIndex("timestamp","timestamp",{unique:!1})),o.oldVersion<6){const c=o.target.transaction;if(c){const f=c.objectStore(Mr);f.indexNames.contains("deckId")||f.createIndex("deckId","deckId",{unique:!1})}}}}),so)}async function kc(){const t=await Wt();return new Promise((e,n)=>{const c=t.transaction(gr,"readonly").objectStore(gr).getAll();c.onerror=()=>n("Error fetching decks"),c.onsuccess=()=>e(c.result)})}async function mi(t){if(t.length===0)return;const e=await Wt();return new Promise((n,o)=>{const i=e.transaction(gr,"readwrite"),c=i.objectStore(gr);i.oncomplete=()=>{xr(),n()},i.onerror=()=>{console.error("Transaction error adding/updating decks",i.error),o("Transaction error adding/updating decks")},t.forEach(f=>{const m=c.put(f);m.onerror=()=>{console.error(`Error putting deck ${f.name}`,m.error)}})})}async function Wf(t){await mi(t)}async function oc(t){const e=await Wt();return new Promise((n,o)=>{const i=e.transaction(gr,"readwrite");i.oncomplete=()=>{xr(),n()},i.onerror=()=>o("Transaction error deleting deck"),i.objectStore(gr).delete(t)})}async function Wg(t){const e=await Wt();return new Promise((n,o)=>{const i=e.transaction(gr,"readwrite");i.oncomplete=()=>{xr(),n()},i.onerror=()=>o("Transaction error updating deck"),i.objectStore(gr).put(t)})}async function Tc(){const t=await Wt();return new Promise((e,n)=>{const c=t.transaction(Jn,"readonly").objectStore(Jn).getAll();c.onerror=()=>n("Error fetching folders"),c.onsuccess=()=>e(c.result)})}async function Jg(t){const e=await Wt();return new Promise((n,o)=>{const i=e.transaction(Jn,"readwrite");i.oncomplete=()=>{xr(),n()},i.onerror=()=>o("Transaction error adding folder"),i.objectStore(Jn).add(t)})}async function Yg(t){if(t.length===0)return;const e=await Wt();return new Promise((n,o)=>{const i=e.transaction(Jn,"readwrite");i.oncomplete=()=>{xr(),n()},i.onerror=()=>{console.error("Transaction error adding/updating folders",i.error),o("Transaction error adding/updating folders")};const c=i.objectStore(Jn);t.forEach(f=>{const m=c.put(f);m.onerror=()=>{console.error(`Error putting folder ${f.name}`,m.error)}})})}async function Qg(t){const e=await Wt();return new Promise((n,o)=>{const i=e.transaction(Jn,"readwrite");i.oncomplete=()=>{xr(),n()},i.onerror=()=>o("Transaction error updating folder"),i.objectStore(Jn).put(t)})}async function Kg(t){const e=await Wt();return new Promise((n,o)=>{const i=e.transaction(Jn,"readwrite");i.oncomplete=()=>{xr(),n()},i.onerror=()=>o("Transaction error deleting folder"),i.objectStore(Jn).delete(t)})}async function _c(){const t=await Wt();return new Promise((e,n)=>{const c=t.transaction(yr,"readonly").objectStore(yr).getAll();c.onerror=()=>n("Error fetching deck series"),c.onsuccess=()=>e(c.result)})}async function Ma(t){if(t.length===0)return;const e=await Wt();return new Promise((n,o)=>{const i=e.transaction(yr,"readwrite");i.oncomplete=()=>{xr(),n()},i.onerror=()=>o("Transaction error adding deck series");const c=i.objectStore(yr);t.forEach(f=>c.put(f))})}async function Vu(t){const e=await Wt();return new Promise((n,o)=>{const i=e.transaction(yr,"readwrite");i.oncomplete=()=>{xr(),n()},i.onerror=()=>o("Error updating deck series"),i.objectStore(yr).put(t)})}async function zp(t){const e=await Wt();return new Promise((n,o)=>{const i=e.transaction(yr,"readwrite");i.oncomplete=()=>{xr(),n()},i.onerror=()=>o("Error deleting deck series"),i.objectStore(yr).delete(t)})}async function Zg(t,e){const n=await Wt();return new Promise((o,i)=>{const c=n.transaction(vr,"readwrite");c.oncomplete=()=>o(),c.onerror=()=>i("Transaction error saving session state"),c.objectStore(vr).put({id:t,...e})})}async function Xg(t){const e=await Wt();return new Promise((n,o)=>{const f=e.transaction(vr,"readonly").objectStore(vr).get(t);f.onerror=()=>o("Error fetching session state"),f.onsuccess=()=>n(f.result||null)})}async function sc(t){const e=await Wt();return new Promise((n,o)=>{const i=e.transaction(vr,"readwrite");i.oncomplete=()=>n(),i.onerror=()=>o("Transaction error deleting session state"),i.objectStore(vr).delete(t)})}async function ey(){const t=await Wt();return new Promise((e,n)=>{const c=t.transaction(vr,"readonly").objectStore(vr).getAllKeys();c.onerror=()=>n("Error fetching session keys"),c.onsuccess=()=>e(c.result)})}async function ty(t){const e=await Wt();return new Promise((n,o)=>{const i=e.transaction(Mr,"readwrite");i.oncomplete=()=>n(),i.onerror=()=>{console.error("Transaction error adding review log",i.error),o("Transaction error adding review log")},i.objectStore(Mr).add(t)})}async function ny(t){const e=await Wt();return new Promise((n,o)=>{const f=e.transaction(Mr,"readonly").objectStore(Mr).index("timestamp"),m=IDBKeyRange.lowerBound(t.toISOString()),h=f.getAll(m);h.onerror=()=>o("Error fetching review logs"),h.onsuccess=()=>n(h.result)})}async function ry(t){const e=await Wt();return new Promise((n,o)=>{const m=e.transaction(Mr,"readonly").objectStore(Mr).index("deckId").getAll(t);m.onerror=()=>o("Error fetching reviews for deck"),m.onsuccess=()=>n(m.result)})}async function oy(){const[t,e,n]=await Promise.all([kc(),Tc(),_c()]);if(t.length===0&&e.length===0&&n.length===0)throw new Error("There is no data to export.");const i=JSON.stringify({version:3,decks:t,folders:e,deckSeries:n},null,2),c=new Blob([i],{type:"application/json"}),f=URL.createObjectURL(c),m=document.createElement("a");m.style.display="none",m.href=f;const h=jp();return m.download=`cogniflow-backup-${h}.json`,document.body.appendChild(m),m.click(),window.URL.revokeObjectURL(f),document.body.removeChild(m),m.download}async function sy(){return so&&(await so).close(),new Promise((t,e)=>{const n=indexedDB.deleteDatabase(qp);n.onerror=o=>{console.error("Error deleting database.",o),e(new Error("Error deleting database."))},n.onsuccess=()=>{console.log("Database deleted successfully."),t()},n.onblocked=()=>{console.error("Database deletion blocked. Please close other tabs of this app and try again."),e(new Error("Deletion blocked. Please close other tabs of this app."))}})}const iy=()=>{const[t,e]=B.useState(null);return B.useEffect(()=>{const o=i=>{i.preventDefault(),e(i)};return window.addEventListener("beforeinstallprompt",o),()=>{window.removeEventListener("beforeinstallprompt",o)}},[]),[t,()=>{t&&(t.prompt(),t.userChoice.then(o=>{o.outcome==="accepted"?console.log("User accepted the install prompt"):console.log("User dismissed the install prompt"),e(null)}))}]},ay=()=>{const[t,e]=B.useState(navigator.onLine);return B.useEffect(()=>{const n=()=>e(!0),o=()=>e(!1);return window.addEventListener("online",n),window.addEventListener("offline",o),()=>{window.removeEventListener("online",n),window.removeEventListener("offline",o)}},[]),t},ly=()=>ay()?null:u.jsx("div",{role:"status","aria-live":"assertive",className:"fixed bottom-0 left-0 right-0 bg-red-600 text-white text-center p-3 z-50 animate-fade-in",children:u.jsx("p",{className:"text-sm font-semibold",children:"You are currently offline. Some features may be unavailable."})}),uy={plus:u.jsxs(u.Fragment,{children:[u.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),u.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]}),"upload-cloud":u.jsxs(u.Fragment,{children:[u.jsx("path",{d:"M20 16.58A5 5 0 0 0 18 7h-1.26A8 8 0 1 0 4 15.25"}),u.jsx("polyline",{points:"16 16 12 12 8 16"}),u.jsx("line",{x1:"12",y1:"12",x2:"12",y2:"21"})]}),x:u.jsxs(u.Fragment,{children:[u.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),u.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]}),"chevron-left":u.jsx(u.Fragment,{children:u.jsx("polyline",{points:"15 18 9 12 15 6"})}),"trash-2":u.jsxs(u.Fragment,{children:[u.jsx("polyline",{points:"3 6 5 6 21 6"}),u.jsx("path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"}),u.jsx("line",{x1:"10",y1:"11",x2:"10",y2:"17"}),u.jsx("line",{x1:"14",y1:"11",x2:"14",y2:"17"})]}),"check-circle":u.jsxs(u.Fragment,{children:[u.jsx("path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14"}),u.jsx("polyline",{points:"22 4 12 14.01 9 11.01"})]}),"x-circle":u.jsxs(u.Fragment,{children:[u.jsx("circle",{cx:"12",cy:"12",r:"10"}),u.jsx("line",{x1:"15",y1:"9",x2:"9",y2:"15"}),u.jsx("line",{x1:"9",y1:"9",x2:"15",y2:"15"})]}),download:u.jsxs(u.Fragment,{children:[u.jsx("path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"}),u.jsx("polyline",{points:"7 10 12 15 17 10"}),u.jsx("line",{x1:"12",y1:"15",x2:"12",y2:"3"})]}),laptop:u.jsxs(u.Fragment,{children:[u.jsx("path",{d:"M20 16V7a2 2 0 0 0-2-2H6a2 2 0 0 0-2 2v9h16z"}),u.jsx("rect",{x:"2",y:"17",width:"20",height:"4",rx:"1"})]}),menu:u.jsxs(u.Fragment,{children:[u.jsx("line",{x1:"3",y1:"12",x2:"21",y2:"12"}),u.jsx("line",{x1:"3",y1:"6",x2:"21",y2:"6"}),u.jsx("line",{x1:"3",y1:"18",x2:"21",y2:"18"})]}),edit:u.jsxs(u.Fragment,{children:[u.jsx("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"}),u.jsx("path",{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"})]}),save:u.jsxs(u.Fragment,{children:[u.jsx("path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"}),u.jsx("polyline",{points:"17 21 17 13 7 13 7 21"}),u.jsx("polyline",{points:"7 3 7 8 15 8"})]}),sun:u.jsxs(u.Fragment,{children:[u.jsx("circle",{cx:"12",cy:"12",r:"5"}),u.jsx("line",{x1:"12",y1:"1",x2:"12",y2:"3"}),u.jsx("line",{x1:"12",y1:"21",x2:"12",y2:"23"}),u.jsx("line",{x1:"4.22",y1:"4.22",x2:"5.64",y2:"5.64"}),u.jsx("line",{x1:"18.36",y1:"18.36",x2:"19.78",y2:"19.78"}),u.jsx("line",{x1:"1",y1:"12",x2:"3",y2:"12"}),u.jsx("line",{x1:"21",y1:"12",x2:"23",y2:"12"}),u.jsx("line",{x1:"4.22",y1:"19.78",x2:"5.64",y2:"18.36"}),u.jsx("line",{x1:"18.36",y1:"5.64",x2:"19.78",y2:"4.22"})]}),moon:u.jsx(u.Fragment,{children:u.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})}),code:u.jsxs(u.Fragment,{children:[u.jsx("polyline",{points:"16 18 22 12 16 6"}),u.jsx("polyline",{points:"8 6 2 12 8 18"})]}),"refresh-ccw":u.jsxs(u.Fragment,{children:[u.jsx("polyline",{points:"1 4 1 10 7 10"}),u.jsx("polyline",{points:"23 20 23 14 17 14"}),u.jsx("path",{d:"M20.49 9A9 9 0 0 0 7.2 6.51"}),u.jsx("path",{d:"M3.51 15A9 9 0 0 0 16.8 17.49"})]}),broom:u.jsx(u.Fragment,{children:u.jsx("path",{d:"M9.59 4.59A2 2 0 1 1 11 8H2m10.59 11.41A2 2 0 1 0 14 16H2m15.73-8.27A2.5 2.5 0 1 1 19.5 12H2"})}),settings:u.jsxs(u.Fragment,{children:[u.jsx("circle",{cx:"12",cy:"12",r:"3"}),u.jsx("path",{d:"M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"})]}),info:u.jsxs(u.Fragment,{children:[u.jsx("circle",{cx:"12",cy:"12",r:"10"}),u.jsx("line",{x1:"12",y1:"16",x2:"12",y2:"12"}),u.jsx("line",{x1:"12",y1:"8",x2:"12.01",y2:"8"})]}),"chevron-down":u.jsx(u.Fragment,{children:u.jsx("polyline",{points:"6 9 12 15 18 9"})}),eye:u.jsxs(u.Fragment,{children:[u.jsx("path",{d:"M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"}),u.jsx("circle",{cx:"12",cy:"12",r:"3"})]}),"eye-off":u.jsxs(u.Fragment,{children:[u.jsx("path",{d:"M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24"}),u.jsx("line",{x1:"1",y1:"1",x2:"23",y2:"23"})]}),zap:u.jsx(u.Fragment,{children:u.jsx("polygon",{points:"13 2 3 14 12 14 11 22 21 10 12 10 13 2"})}),"help-circle":u.jsxs(u.Fragment,{children:[u.jsx("circle",{cx:"12",cy:"12",r:"10"}),u.jsx("path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"}),u.jsx("line",{x1:"12",y1:"17",x2:"12.01",y2:"17"})]}),google:u.jsxs(u.Fragment,{children:[u.jsx("path",{d:"M17.64 9.2c0-.63-.06-1.25-.16-1.84H9v3.48h4.84c-.2 1.12-.84 2.08-1.74 2.71v2.26h2.92c1.7-1.56 2.68-3.88 2.68-6.61z"}),u.jsx("path",{d:"M9 18c2.43 0 4.47-.8 5.96-2.18l-2.92-2.26c-.8.54-1.82.86-3.04.86-2.34 0-4.32-1.58-5.04-3.7H1v2.34C2.64 16.32 5.57 18 9 18z"}),u.jsx("path",{d:"M3.96 10.71c-.18-.54-.28-1.12-.28-1.71s.1-1.17.28-1.71V4.96H1c-.64 1.28-1 2.74-1 4.34s.36 3.06 1 4.34l2.96-2.34z"}),u.jsx("path",{d:"M9 3.6c1.32 0 2.52.45 3.44 1.34l2.6-2.6C13.46.8 11.43 0 9 0 5.57 0 2.64 1.68 1 4.34l2.96 2.34C4.68 4.54 6.66 3.6 9 3.6z"})]}),folder:u.jsx(u.Fragment,{children:u.jsx("path",{d:"M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"})}),"folder-plus":u.jsxs(u.Fragment,{children:[u.jsx("path",{d:"M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"}),u.jsx("line",{x1:"12",y1:"11",x2:"12",y2:"17"}),u.jsx("line",{x1:"9",y1:"14",x2:"15",y2:"14"})]}),"folder-edit":u.jsxs(u.Fragment,{children:[u.jsx("path",{d:"M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"}),u.jsx("path",{d:"M14 13.5l2 2-4 4-2-2 4-4zm-1.5 2.5l2-2"})]}),list:u.jsxs(u.Fragment,{children:[u.jsx("line",{x1:"8",y1:"6",x2:"21",y2:"6"}),u.jsx("line",{x1:"8",y1:"12",x2:"21",y2:"12"}),u.jsx("line",{x1:"8",y1:"18",x2:"21",y2:"18"}),u.jsx("line",{x1:"3",y1:"6",x2:"3.01",y2:"6"}),u.jsx("line",{x1:"3",y1:"12",x2:"3.01",y2:"12"}),u.jsx("line",{x1:"3",y1:"18",x2:"3.01",y2:"18"})]}),lock:u.jsxs(u.Fragment,{children:[u.jsx("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"}),u.jsx("path",{d:"M7 11V7a5 5 0 0 1 10 0v4"})]}),unlock:u.jsxs(u.Fragment,{children:[u.jsx("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"}),u.jsx("path",{d:"M7 11V7a5 5 0 0 1 9.9-1"})]}),archive:u.jsxs(u.Fragment,{children:[u.jsx("polyline",{points:"21 8 21 21 3 21 3 8"}),u.jsx("rect",{x:"1",y:"3",width:"22",height:"5"}),u.jsx("line",{x1:"10",y1:"12",x2:"14",y2:"12"})]}),unarchive:u.jsxs(u.Fragment,{children:[u.jsx("polyline",{points:"21 8 21 21 3 21 3 8"}),u.jsx("rect",{x:"1",y:"3",width:"22",height:"5"}),u.jsx("polyline",{points:"10 13 12 11 14 13"}),u.jsx("line",{x1:"12",y1:"11",x2:"12",y2:"17"})]}),"arrow-down":u.jsxs(u.Fragment,{children:[u.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),u.jsx("polyline",{points:"19 12 12 19 5 12"})]}),monitor:u.jsxs(u.Fragment,{children:[u.jsx("rect",{x:"2",y:"3",width:"20",height:"14",rx:"2",ry:"2"}),u.jsx("line",{x1:"8",y1:"21",x2:"16",y2:"21"}),u.jsx("line",{x1:"12",y1:"17",x2:"12",y2:"21"})]}),"more-vertical":u.jsxs(u.Fragment,{children:[u.jsx("circle",{cx:"12",cy:"12",r:"1"}),u.jsx("circle",{cx:"12",cy:"5",r:"1"}),u.jsx("circle",{cx:"12",cy:"19",r:"1"})]}),search:u.jsxs(u.Fragment,{children:[u.jsx("circle",{cx:"11",cy:"11",r:"8"}),u.jsx("line",{x1:"21",y1:"21",x2:"16.65",y2:"16.65"})]}),filter:u.jsx(u.Fragment,{children:u.jsx("polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3"})}),layers:u.jsxs(u.Fragment,{children:[u.jsx("polygon",{points:"12 2 2 7 12 12 22 7 12 2"}),u.jsx("polyline",{points:"2 17 12 22 22 17"}),u.jsx("polyline",{points:"2 12 12 17 22 12"})]}),terminal:u.jsxs(u.Fragment,{children:[u.jsx("polyline",{points:"4 17 10 11 4 5"}),u.jsx("line",{x1:"12",y1:"19",x2:"20",y2:"19"})]}),"trending-up":u.jsxs(u.Fragment,{children:[u.jsx("polyline",{points:"23 6 13.5 15.5 8.5 10.5 1 18"}),u.jsx("polyline",{points:"17 6 23 6 23 12"})]}),"grip-vertical":u.jsxs(u.Fragment,{children:[u.jsx("circle",{cx:"9",cy:"12",r:"1"}),u.jsx("circle",{cx:"9",cy:"5",r:"1"}),u.jsx("circle",{cx:"9",cy:"19",r:"1"}),u.jsx("circle",{cx:"15",cy:"12",r:"1"}),u.jsx("circle",{cx:"15",cy:"5",r:"1"}),u.jsx("circle",{cx:"15",cy:"19",r:"1"})]}),repeat:u.jsxs(u.Fragment,{children:[u.jsx("polyline",{points:"17 1 21 5 17 9"}),u.jsx("path",{d:"M3 11V9a4 4 0 0 1 4-4h14"}),u.jsx("polyline",{points:"7 23 3 19 7 15"}),u.jsx("path",{d:"M21 13v2a4 4 0 0 1-4 4H3"})]})},de=({name:t,className:e="w-6 h-6",...n})=>u.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:`${e} pointer-events-none`,...n,children:uy[t]}),Se=({children:t,variant:e="primary",size:n="md",className:o="",...i})=>{const c="inline-flex items-center justify-center rounded-md font-medium transition-colors focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-background disabled:opacity-50 disabled:pointer-events-none",f={primary:"bg-primary text-on-primary hover:bg-primary-hover focus:ring-primary",secondary:"bg-surface text-text border border-border hover:bg-border/20 focus:ring-primary",danger:"bg-red-600 text-white hover:bg-red-700 focus:ring-red-500",ghost:"text-text-muted hover:bg-border/50 hover:text-text focus:ring-primary"},m={sm:"px-2 py-1 text-xs",md:"px-4 py-2 text-sm",lg:"px-6 py-3 text-base"};return u.jsx("button",{className:`${c} ${f[e]} ${m[n]} ${o}`,...i,children:t})},cy='a[href], button:not([disabled]), textarea, input, select, [tabindex]:not([tabindex="-1"])',Un=(t,e)=>{const n=B.useRef([]);B.useEffect(()=>{if(e&&t.current){n.current=Array.from(t.current.querySelectorAll(cy));const o=n.current[0];o&&setTimeout(()=>o.focus(),100);const i=c=>{var h;if(c.key!=="Tab"||!((h=t.current)!=null&&h.contains(document.activeElement)))return;const f=n.current[0],m=n.current[n.current.length-1];c.shiftKey?document.activeElement===f&&(c.preventDefault(),m==null||m.focus()):document.activeElement===m&&(c.preventDefault(),f==null||f.focus())};return document.addEventListener("keydown",i),()=>{document.removeEventListener("keydown",i)}}},[e,t])},Op=B.createContext(void 0),Jf=()=>window.location.hash.startsWith("#/")?window.location.hash.substring(1):"/",dy=({children:t})=>{const[e,n]=B.useState(Jf()),o=B.useCallback(()=>{n(Jf())},[]);B.useEffect(()=>(window.addEventListener("hashchange",o),()=>{window.removeEventListener("hashchange",o)}),[o]);const i=B.useCallback((f,m)=>{const h=`#${f}`;if(m!=null&&m.replace){const p=new URL(window.location.href);p.hash=h,window.location.replace(p.toString())}else window.location.hash=h},[]),c={path:e,navigate:i};return u.jsx(Op.Provider,{value:c,children:t})},Rr=()=>{const t=B.useContext(Op);if(t===void 0)throw new Error("useRouter must be used within a RouterProvider");return t},Ot=({href:t,children:e,passAs:n,...o})=>{const{navigate:i}=Rr(),c=m=>{m.currentTarget.tagName==="A"&&(m.metaKey||m.ctrlKey)||(m.preventDefault(),o.onClick&&o.onClick(m),i(t))},f=`#${t}`;return n?u.jsx(n,{...o,onClick:c,children:e}):u.jsx("a",{...o,href:f,onClick:c,children:e})},Bp=B.createContext(void 0),Yf=(t,e)=>{if(typeof window>"u")return e;try{const n=window.localStorage.getItem(t);return n?JSON.parse(n)===!0:e}catch(n){return console.error(`Error reading ${t} from localStorage`,n),e}},fy=()=>{if(typeof window>"u")return!1;try{const t=window.localStorage.getItem("cogniflow-aiFeaturesEnabled");return t!==null?JSON.parse(t)===!0:!!(window.location.origin.endsWith("aistudio.google.com")||window.location.origin.endsWith("scf.usercontent.goog"))}catch(t){return console.error("Error reading cogniflow-aiFeaturesEnabled from localStorage",t),!1}},my=({children:t})=>{const[e,n]=B.useState(()=>Yf("cogniflow-disableAnimations",!1)),[o,i]=B.useState(()=>Yf("cogniflow-hapticsEnabled",!0)),[c,f]=B.useState(fy),m=B.useCallback(x=>{n(x);try{window.localStorage.setItem("cogniflow-disableAnimations",JSON.stringify(x))}catch(C){console.error("Error writing animation setting to localStorage",C)}},[]),h=B.useCallback(x=>{i(x);try{window.localStorage.setItem("cogniflow-hapticsEnabled",JSON.stringify(x))}catch(C){console.error("Error writing haptics setting to localStorage",C)}},[]),p=B.useCallback(x=>{f(x);try{window.localStorage.setItem("cogniflow-aiFeaturesEnabled",JSON.stringify(x))}catch(C){console.error("Error writing AI features setting to localStorage",C)}},[]),v={disableAnimations:e,setDisableAnimations:m,hapticsEnabled:o,setHapticsEnabled:h,aiFeaturesEnabled:c,setAiFeaturesEnabled:p};return u.jsx(Bp.Provider,{value:v,children:t})},Vo=()=>{const t=B.useContext(Bp);if(t===void 0)throw new Error("useSettings must be used within a SettingsProvider");return t},py=({isOpen:t,onClose:e,onImport:n,onCreateSeries:o,onGenerateAI:i,onInstall:c})=>{const f=B.useRef(null),{aiFeaturesEnabled:m}=Vo();return Un(f,t),B.useEffect(()=>{const h=p=>{p.key==="Escape"&&e()};return t&&document.addEventListener("keydown",h),()=>{document.removeEventListener("keydown",h)}},[t,e]),u.jsxs(u.Fragment,{children:[u.jsx("div",{className:`fixed inset-0 bg-black bg-opacity-60 z-50 transition-opacity duration-300 ${t?"opacity-100":"opacity-0 pointer-events-none"}`,onClick:e,"aria-hidden":"true"}),u.jsx("div",{ref:f,className:`fixed top-0 right-0 h-full w-full max-w-xs z-[51] transform transition-transform duration-300 ease-in-out ${t?"translate-x-0":"translate-x-full"}`,role:"dialog","aria-modal":"true","aria-labelledby":"sidebar-title",children:u.jsxs("div",{className:"bg-surface shadow-xl h-full flex flex-col",children:[u.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-border",children:[u.jsx("h2",{id:"sidebar-title",className:"text-xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-blue-400 to-teal-300",children:"Menu"}),u.jsx(Se,{variant:"ghost",onClick:e,className:"p-1 h-auto","aria-label":"Close menu",children:u.jsx(de,{name:"x"})})]}),u.jsxs("nav",{className:"flex-grow p-4 space-y-2",children:[u.jsxs(Ot,{href:"/",onClick:e,className:"flex items-center px-3 py-2 text-text rounded-md hover:bg-border/30 text-lg",children:[u.jsx(de,{name:"laptop",className:"w-6 h-6 mr-3"})," Home"]}),u.jsxs(Ot,{href:"/series",onClick:e,className:"flex items-center px-3 py-2 text-text rounded-md hover:bg-border/30 text-lg",children:[u.jsx(de,{name:"layers",className:"w-6 h-6 mr-3"})," Series"]}),u.jsxs(Ot,{href:"/decks",onClick:e,className:"flex items-center px-3 py-2 text-text rounded-md hover:bg-border/30 text-lg",children:[u.jsx(de,{name:"folder",className:"w-6 h-6 mr-3"})," Decks"]}),u.jsxs(Ot,{href:"/progress",onClick:e,className:"flex items-center px-3 py-2 text-text rounded-md hover:bg-border/30 text-lg",children:[u.jsx(de,{name:"trending-up",className:"w-6 h-6 mr-3"}),"Progress"]}),u.jsxs(Ot,{href:"/archive",onClick:e,className:"flex items-center px-3 py-2 text-text rounded-md hover:bg-border/30 text-lg",children:[u.jsx(de,{name:"archive",className:"w-6 h-6 mr-3"}),"Archive"]}),u.jsxs(Ot,{href:"/trash",onClick:e,className:"flex items-center px-3 py-2 text-text rounded-md hover:bg-border/30 text-lg",children:[u.jsx(de,{name:"trash-2",className:"w-6 h-6 mr-3"}),"Trash"]}),u.jsxs(Ot,{href:"/settings",onClick:e,className:"flex items-center px-3 py-2 text-text rounded-md hover:bg-border/30 text-lg",children:[u.jsx(de,{name:"settings",className:"w-6 h-6 mr-3"}),"Settings"]}),u.jsxs(Ot,{href:"/instructions/json",onClick:e,className:"flex items-center px-3 py-2 text-text rounded-md hover:bg-border/30 text-lg",children:[u.jsx(de,{name:"help-circle",className:"w-6 h-6 mr-3"}),"JSON Guide"]})]}),u.jsxs("div",{className:"p-4 border-t border-border space-y-2",children:[m&&u.jsxs(Se,{variant:"primary",onClick:i,className:"w-full",children:[u.jsx(de,{name:"zap",className:"w-5 h-5 mr-2"}),"Generate with AI"]}),u.jsxs(Se,{variant:"secondary",onClick:o,className:"w-full",children:[u.jsx(de,{name:"layers",className:"w-5 h-5 mr-2"}),"Create New Series"]}),u.jsxs(Se,{variant:"secondary",onClick:n,className:"w-full",children:[u.jsx(de,{name:"plus",className:"w-5 h-5 mr-2"}),"Create / Import Deck"]}),c&&u.jsxs(Se,{variant:"secondary",onClick:c,className:"w-full",children:[u.jsx(de,{name:"download",className:"w-5 h-5 mr-2"}),"Install App"]})]})]})})]})},hy={success:u.jsx(de,{name:"check-circle",className:"w-6 h-6 text-green-500"}),error:u.jsx(de,{name:"x-circle",className:"w-6 h-6 text-red-500"}),info:u.jsx(de,{name:"info",className:"w-6 h-6 text-blue-500"})},gy=({message:t,onDismiss:e})=>(B.useEffect(()=>{const n=setTimeout(()=>{e(t.id)},5e3);return()=>{clearTimeout(n)}},[t.id,e]),u.jsx("div",{className:"bg-surface shadow-lg rounded-lg pointer-events-auto ring-1 ring-black ring-opacity-5 overflow-hidden animate-fade-in-right",children:u.jsx("div",{className:"p-4",children:u.jsxs("div",{className:"flex items-start",children:[u.jsx("div",{className:"flex-shrink-0",children:hy[t.type]}),u.jsx("div",{className:"ml-3 w-0 flex-1 pt-0.5",children:u.jsx("p",{className:"text-sm font-medium text-text break-words",children:t.message})}),u.jsx("div",{className:"ml-4 flex-shrink-0 flex",children:u.jsxs("button",{onClick:()=>e(t.id),className:"bg-surface rounded-md inline-flex text-text-muted hover:text-text focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-surface focus:ring-primary",children:[u.jsx("span",{className:"sr-only",children:"Close"}),u.jsx(de,{name:"x",className:"h-5 w-5"})]})})]})})})),Vp=B.createContext(void 0),yy=({children:t})=>{const[e,n]=B.useState([]),o=B.useCallback((c,f)=>{const m=crypto.randomUUID();n(h=>[...h,{id:m,message:c,type:f}])},[]),i=B.useCallback(c=>{n(f=>f.filter(m=>m.id!==c))},[]);return u.jsxs(Vp.Provider,{value:{addToast:o},children:[t,u.jsx("div",{className:"fixed top-5 right-5 z-[100] w-full max-w-xs space-y-3",children:e.map(c=>u.jsx(gy,{message:c,onDismiss:i},c.id))})]})},gn=()=>{const t=B.useContext(Vp);if(t===void 0)throw new Error("useToast must be used within a ToastProvider");return t},Ln=({size:t="md"})=>{const e={sm:"h-6 w-6",md:"h-10 w-10",lg:"h-16 w-16"};return u.jsx("div",{className:"flex justify-center items-center p-4",role:"status","aria-label":"Loading",children:u.jsxs("svg",{className:`animate-spin text-blue-500 dark:text-blue-400 ${e[t]}`,xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[u.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),u.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]})})},Oo=2.5,ic=1.3,vy=1,xy=1.2,wy=1.3,Cy={1:-.2,2:-.15,3:0,4:.15},Gp=t=>{try{if(!t.trim())throw new Error("File content is empty.");const e=JSON.parse(t);if(typeof e=="object"&&e!==null&&"version"in e&&Array.isArray(e.decks)){if(e.version>3)throw new Error(`Unsupported backup version: ${e.version}`);const n=e.decks,o=e.folders||[],i=(Array.isArray(e.deckSeries)?e.deckSeries:[]).filter(c=>c&&typeof c.id=="string"&&typeof c.name=="string").map(c=>{if(Array.isArray(c.levels))return c.levels.forEach(f=>{Array.isArray(f.deckIds)||(f.deckIds=[])}),c;if(Array.isArray(c.deckIds)){const f={...c};return f.levels=[{title:"Decks",deckIds:f.deckIds}],delete f.deckIds,f}return{...c,levels:[]}});for(const c of n)if(typeof c.id!="string"||typeof c.name!="string"||!c.type)throw new Error("Invalid deck structure in backup file.");for(const c of o)if(typeof c.id!="string"||typeof c.name!="string")throw new Error("Invalid folder structure in backup file.");return{decks:n,folders:o,deckSeries:i}}if(Array.isArray(e)){const n=e.map(o=>(o.type||(Array.isArray(o.cards)?o.type=We.Flashcard:Array.isArray(o.questions)&&(o.type=We.Quiz)),o));for(const o of n)if(typeof o.id!="string"||typeof o.name!="string"||o.type!==We.Flashcard&&o.type!==We.Quiz)throw new Error("Invalid backup file. One or more decks have an incorrect structure.");return{decks:n,folders:[],deckSeries:[]}}throw new Error("The file is not a valid CogniFlow backup file.")}catch(e){throw console.error("Failed to parse backup file:",e),new Error(e instanceof Error?e.message:"Invalid JSON format")}},ac=t=>{try{if(!t.trim())throw new Error("Pasted content is empty.");const e=JSON.parse(t);if(typeof e=="object"&&e!==null&&"seriesName"in e&&"levels"in e){if(typeof e.seriesName!="string"||typeof e.seriesDescription!="string"||!Array.isArray(e.levels))throw new Error("Invalid series format. Must have 'seriesName' (string), 'seriesDescription' (string), and a 'levels' (array).");for(const n of e.levels){if(typeof n.title!="string"||!Array.isArray(n.decks))throw new Error("Each level in the series must have a 'title' (string) and a 'decks' (array).");for(const o of n.decks)if(typeof o.name!="string"||typeof o.description!="string"||!Array.isArray(o.questions))throw new Error("Each deck in a level must be a valid quiz deck object with 'name', 'description', and 'questions' properties.")}return{type:"quiz_series",data:e}}if(Array.isArray(e)){const n=[];for(const o of e){if(typeof o.front!="string"||typeof o.back!="string")throw new Error("Each item in the array must be an object with 'front' and 'back' string properties.");n.push({front:o.front,back:o.back})}return{type:We.Flashcard,data:n}}if(typeof e=="object"&&e!==null&&"questions"in e){if(typeof e.name!="string"||typeof e.description!="string"||!Array.isArray(e.questions))throw new Error("Quiz JSON must be an object with 'name' (string), 'description' (string), and 'questions' (array) properties.");for(const n of e.questions)if(typeof n.questionText!="string"||!Array.isArray(n.options)||typeof n.correctAnswerId!="string")throw new Error("Each question in a quiz must have 'questionText', an 'options' array, and a 'correctAnswerId'.");return{type:We.Quiz,data:e}}throw new Error("Unsupported JSON structure. Expected an array of flashcards, a single quiz object, or a series object.")}catch(e){throw console.error("Failed to parse JSON:",e),new Error(e instanceof Error?e.message:"Invalid JSON format")}},Sy=(t,e)=>{try{if(!t.trim())throw new Error("Pasted content is empty.");const n=JSON.parse(t);if(!Array.isArray(n))throw new Error("JSON must be an array of items.");if(n.length===0)return[];if(e===We.Flashcard){const o=[];for(const i of n){if(typeof i.front!="string"||typeof i.back!="string")throw new Error("Each item in the array must be an object with 'front' and 'back' string properties.");o.push({front:i.front,back:i.back})}return o}else{const o=[];for(const i of n){if(typeof i.questionText!="string"||!Array.isArray(i.options)||typeof i.correctAnswerId!="string")throw new Error("Each question must have 'questionText', an 'options' array, and a 'correctAnswerId'.");o.push(i)}return o}}catch(n){throw console.error("Failed to parse items JSON:",n),new Error(n instanceof Error?n.message:"Invalid JSON format")}},Ec=t=>{const e=new Date;return e.setHours(0,0,0,0),t.map(n=>({id:crypto.randomUUID(),front:n.front,back:n.back,dueDate:e.toISOString(),interval:0,easeFactor:Oo,masteryLevel:0,lapses:0}))},io=t=>{const e=new Date;return e.setHours(0,0,0,0),t.map(n=>({...n,id:crypto.randomUUID(),dueDate:e.toISOString(),interval:0,easeFactor:Oo,masteryLevel:0,lapses:0}))},ky=t=>{try{return{type:"backup",data:Gp(t)}}catch{}try{const e=ac(t);return{type:e.type,data:e.data}}catch{}return null};function Ra(t){throw new Error('Could not dynamically require "'+t+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var Gu={exports:{}};/*!

JSZip v3.10.1 - A JavaScript class for generating and reading zip files
<http://stuartk.com/jszip>

(c) 2009-2016 Stuart Knightley <stuart [at] stuartk.com>
Dual licenced under the MIT license or GPLv3. See https://raw.github.com/Stuk/jszip/main/LICENSE.markdown.

JSZip uses the library pako released under the MIT license :
https://github.com/nodeca/pako/blob/main/LICENSE
*/var Qf;function Ty(){return Qf||(Qf=1,function(t,e){(function(n){t.exports=n()})(function(){return function n(o,i,c){function f(p,v){if(!i[p]){if(!o[p]){var x=typeof Ra=="function"&&Ra;if(!v&&x)return x(p,!0);if(m)return m(p,!0);var C=new Error("Cannot find module '"+p+"'");throw C.code="MODULE_NOT_FOUND",C}var S=i[p]={exports:{}};o[p][0].call(S.exports,function(b){var T=o[p][1][b];return f(T||b)},S,S.exports,n,o,i,c)}return i[p].exports}for(var m=typeof Ra=="function"&&Ra,h=0;h<c.length;h++)f(c[h]);return f}({1:[function(n,o,i){var c=n("./utils"),f=n("./support"),m="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";i.encode=function(h){for(var p,v,x,C,S,b,T,A=[],D=0,F=h.length,L=F,R=c.getTypeOf(h)!=="string";D<h.length;)L=F-D,x=R?(p=h[D++],v=D<F?h[D++]:0,D<F?h[D++]:0):(p=h.charCodeAt(D++),v=D<F?h.charCodeAt(D++):0,D<F?h.charCodeAt(D++):0),C=p>>2,S=(3&p)<<4|v>>4,b=1<L?(15&v)<<2|x>>6:64,T=2<L?63&x:64,A.push(m.charAt(C)+m.charAt(S)+m.charAt(b)+m.charAt(T));return A.join("")},i.decode=function(h){var p,v,x,C,S,b,T=0,A=0,D="data:";if(h.substr(0,D.length)===D)throw new Error("Invalid base64 input, it looks like a data url.");var F,L=3*(h=h.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(h.charAt(h.length-1)===m.charAt(64)&&L--,h.charAt(h.length-2)===m.charAt(64)&&L--,L%1!=0)throw new Error("Invalid base64 input, bad content length.");for(F=f.uint8array?new Uint8Array(0|L):new Array(0|L);T<h.length;)p=m.indexOf(h.charAt(T++))<<2|(C=m.indexOf(h.charAt(T++)))>>4,v=(15&C)<<4|(S=m.indexOf(h.charAt(T++)))>>2,x=(3&S)<<6|(b=m.indexOf(h.charAt(T++))),F[A++]=p,S!==64&&(F[A++]=v),b!==64&&(F[A++]=x);return F}},{"./support":30,"./utils":32}],2:[function(n,o,i){var c=n("./external"),f=n("./stream/DataWorker"),m=n("./stream/Crc32Probe"),h=n("./stream/DataLengthProbe");function p(v,x,C,S,b){this.compressedSize=v,this.uncompressedSize=x,this.crc32=C,this.compression=S,this.compressedContent=b}p.prototype={getContentWorker:function(){var v=new f(c.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new h("data_length")),x=this;return v.on("end",function(){if(this.streamInfo.data_length!==x.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),v},getCompressedWorker:function(){return new f(c.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},p.createWorkerFrom=function(v,x,C){return v.pipe(new m).pipe(new h("uncompressedSize")).pipe(x.compressWorker(C)).pipe(new h("compressedSize")).withStreamInfo("compression",x)},o.exports=p},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(n,o,i){var c=n("./stream/GenericWorker");i.STORE={magic:"\0\0",compressWorker:function(){return new c("STORE compression")},uncompressWorker:function(){return new c("STORE decompression")}},i.DEFLATE=n("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(n,o,i){var c=n("./utils"),f=function(){for(var m,h=[],p=0;p<256;p++){m=p;for(var v=0;v<8;v++)m=1&m?3988292384^m>>>1:m>>>1;h[p]=m}return h}();o.exports=function(m,h){return m!==void 0&&m.length?c.getTypeOf(m)!=="string"?function(p,v,x,C){var S=f,b=C+x;p^=-1;for(var T=C;T<b;T++)p=p>>>8^S[255&(p^v[T])];return-1^p}(0|h,m,m.length,0):function(p,v,x,C){var S=f,b=C+x;p^=-1;for(var T=C;T<b;T++)p=p>>>8^S[255&(p^v.charCodeAt(T))];return-1^p}(0|h,m,m.length,0):0}},{"./utils":32}],5:[function(n,o,i){i.base64=!1,i.binary=!1,i.dir=!1,i.createFolders=!0,i.date=null,i.compression=null,i.compressionOptions=null,i.comment=null,i.unixPermissions=null,i.dosPermissions=null},{}],6:[function(n,o,i){var c=null;c=typeof Promise<"u"?Promise:n("lie"),o.exports={Promise:c}},{lie:37}],7:[function(n,o,i){var c=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Uint32Array<"u",f=n("pako"),m=n("./utils"),h=n("./stream/GenericWorker"),p=c?"uint8array":"array";function v(x,C){h.call(this,"FlateWorker/"+x),this._pako=null,this._pakoAction=x,this._pakoOptions=C,this.meta={}}i.magic="\b\0",m.inherits(v,h),v.prototype.processChunk=function(x){this.meta=x.meta,this._pako===null&&this._createPako(),this._pako.push(m.transformTo(p,x.data),!1)},v.prototype.flush=function(){h.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)},v.prototype.cleanUp=function(){h.prototype.cleanUp.call(this),this._pako=null},v.prototype._createPako=function(){this._pako=new f[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var x=this;this._pako.onData=function(C){x.push({data:C,meta:x.meta})}},i.compressWorker=function(x){return new v("Deflate",x)},i.uncompressWorker=function(){return new v("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(n,o,i){function c(S,b){var T,A="";for(T=0;T<b;T++)A+=String.fromCharCode(255&S),S>>>=8;return A}function f(S,b,T,A,D,F){var L,R,P=S.file,G=S.compression,$=F!==p.utf8encode,oe=m.transformTo("string",F(P.name)),J=m.transformTo("string",p.utf8encode(P.name)),Z=P.comment,le=m.transformTo("string",F(Z)),Q=m.transformTo("string",p.utf8encode(Z)),Y=J.length!==P.name.length,M=Q.length!==Z.length,pe="",be="",ve="",xe=P.dir,te=P.date,q={crc32:0,compressedSize:0,uncompressedSize:0};b&&!T||(q.crc32=S.crc32,q.compressedSize=S.compressedSize,q.uncompressedSize=S.uncompressedSize);var N=0;b&&(N|=8),$||!Y&&!M||(N|=2048);var j=0,O=0;xe&&(j|=16),D==="UNIX"?(O=798,j|=function(K,X){var se=K;return K||(se=X?16893:33204),(65535&se)<<16}(P.unixPermissions,xe)):(O=20,j|=function(K){return 63&(K||0)}(P.dosPermissions)),L=te.getUTCHours(),L<<=6,L|=te.getUTCMinutes(),L<<=5,L|=te.getUTCSeconds()/2,R=te.getUTCFullYear()-1980,R<<=4,R|=te.getUTCMonth()+1,R<<=5,R|=te.getUTCDate(),Y&&(be=c(1,1)+c(v(oe),4)+J,pe+="up"+c(be.length,2)+be),M&&(ve=c(1,1)+c(v(le),4)+Q,pe+="uc"+c(ve.length,2)+ve);var V="";return V+=`
\0`,V+=c(N,2),V+=G.magic,V+=c(L,2),V+=c(R,2),V+=c(q.crc32,4),V+=c(q.compressedSize,4),V+=c(q.uncompressedSize,4),V+=c(oe.length,2),V+=c(pe.length,2),{fileRecord:x.LOCAL_FILE_HEADER+V+oe+pe,dirRecord:x.CENTRAL_FILE_HEADER+c(O,2)+V+c(le.length,2)+"\0\0\0\0"+c(j,4)+c(A,4)+oe+pe+le}}var m=n("../utils"),h=n("../stream/GenericWorker"),p=n("../utf8"),v=n("../crc32"),x=n("../signature");function C(S,b,T,A){h.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=b,this.zipPlatform=T,this.encodeFileName=A,this.streamFiles=S,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}m.inherits(C,h),C.prototype.push=function(S){var b=S.meta.percent||0,T=this.entriesCount,A=this._sources.length;this.accumulate?this.contentBuffer.push(S):(this.bytesWritten+=S.data.length,h.prototype.push.call(this,{data:S.data,meta:{currentFile:this.currentFile,percent:T?(b+100*(T-A-1))/T:100}}))},C.prototype.openedSource=function(S){this.currentSourceOffset=this.bytesWritten,this.currentFile=S.file.name;var b=this.streamFiles&&!S.file.dir;if(b){var T=f(S,b,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:T.fileRecord,meta:{percent:0}})}else this.accumulate=!0},C.prototype.closedSource=function(S){this.accumulate=!1;var b=this.streamFiles&&!S.file.dir,T=f(S,b,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(T.dirRecord),b)this.push({data:function(A){return x.DATA_DESCRIPTOR+c(A.crc32,4)+c(A.compressedSize,4)+c(A.uncompressedSize,4)}(S),meta:{percent:100}});else for(this.push({data:T.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},C.prototype.flush=function(){for(var S=this.bytesWritten,b=0;b<this.dirRecords.length;b++)this.push({data:this.dirRecords[b],meta:{percent:100}});var T=this.bytesWritten-S,A=function(D,F,L,R,P){var G=m.transformTo("string",P(R));return x.CENTRAL_DIRECTORY_END+"\0\0\0\0"+c(D,2)+c(D,2)+c(F,4)+c(L,4)+c(G.length,2)+G}(this.dirRecords.length,T,S,this.zipComment,this.encodeFileName);this.push({data:A,meta:{percent:100}})},C.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},C.prototype.registerPrevious=function(S){this._sources.push(S);var b=this;return S.on("data",function(T){b.processChunk(T)}),S.on("end",function(){b.closedSource(b.previous.streamInfo),b._sources.length?b.prepareNextSource():b.end()}),S.on("error",function(T){b.error(T)}),this},C.prototype.resume=function(){return!!h.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},C.prototype.error=function(S){var b=this._sources;if(!h.prototype.error.call(this,S))return!1;for(var T=0;T<b.length;T++)try{b[T].error(S)}catch{}return!0},C.prototype.lock=function(){h.prototype.lock.call(this);for(var S=this._sources,b=0;b<S.length;b++)S[b].lock()},o.exports=C},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(n,o,i){var c=n("../compressions"),f=n("./ZipFileWorker");i.generateWorker=function(m,h,p){var v=new f(h.streamFiles,p,h.platform,h.encodeFileName),x=0;try{m.forEach(function(C,S){x++;var b=function(F,L){var R=F||L,P=c[R];if(!P)throw new Error(R+" is not a valid compression method !");return P}(S.options.compression,h.compression),T=S.options.compressionOptions||h.compressionOptions||{},A=S.dir,D=S.date;S._compressWorker(b,T).withStreamInfo("file",{name:C,dir:A,date:D,comment:S.comment||"",unixPermissions:S.unixPermissions,dosPermissions:S.dosPermissions}).pipe(v)}),v.entriesCount=x}catch(C){v.error(C)}return v}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(n,o,i){function c(){if(!(this instanceof c))return new c;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var f=new c;for(var m in this)typeof this[m]!="function"&&(f[m]=this[m]);return f}}(c.prototype=n("./object")).loadAsync=n("./load"),c.support=n("./support"),c.defaults=n("./defaults"),c.version="3.10.1",c.loadAsync=function(f,m){return new c().loadAsync(f,m)},c.external=n("./external"),o.exports=c},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(n,o,i){var c=n("./utils"),f=n("./external"),m=n("./utf8"),h=n("./zipEntries"),p=n("./stream/Crc32Probe"),v=n("./nodejsUtils");function x(C){return new f.Promise(function(S,b){var T=C.decompressed.getContentWorker().pipe(new p);T.on("error",function(A){b(A)}).on("end",function(){T.streamInfo.crc32!==C.decompressed.crc32?b(new Error("Corrupted zip : CRC32 mismatch")):S()}).resume()})}o.exports=function(C,S){var b=this;return S=c.extend(S||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:m.utf8decode}),v.isNode&&v.isStream(C)?f.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):c.prepareContent("the loaded zip file",C,!0,S.optimizedBinaryString,S.base64).then(function(T){var A=new h(S);return A.load(T),A}).then(function(T){var A=[f.Promise.resolve(T)],D=T.files;if(S.checkCRC32)for(var F=0;F<D.length;F++)A.push(x(D[F]));return f.Promise.all(A)}).then(function(T){for(var A=T.shift(),D=A.files,F=0;F<D.length;F++){var L=D[F],R=L.fileNameStr,P=c.resolve(L.fileNameStr);b.file(P,L.decompressed,{binary:!0,optimizedBinaryString:!0,date:L.date,dir:L.dir,comment:L.fileCommentStr.length?L.fileCommentStr:null,unixPermissions:L.unixPermissions,dosPermissions:L.dosPermissions,createFolders:S.createFolders}),L.dir||(b.file(P).unsafeOriginalName=R)}return A.zipComment.length&&(b.comment=A.zipComment),b})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(n,o,i){var c=n("../utils"),f=n("../stream/GenericWorker");function m(h,p){f.call(this,"Nodejs stream input adapter for "+h),this._upstreamEnded=!1,this._bindStream(p)}c.inherits(m,f),m.prototype._bindStream=function(h){var p=this;(this._stream=h).pause(),h.on("data",function(v){p.push({data:v,meta:{percent:0}})}).on("error",function(v){p.isPaused?this.generatedError=v:p.error(v)}).on("end",function(){p.isPaused?p._upstreamEnded=!0:p.end()})},m.prototype.pause=function(){return!!f.prototype.pause.call(this)&&(this._stream.pause(),!0)},m.prototype.resume=function(){return!!f.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},o.exports=m},{"../stream/GenericWorker":28,"../utils":32}],13:[function(n,o,i){var c=n("readable-stream").Readable;function f(m,h,p){c.call(this,h),this._helper=m;var v=this;m.on("data",function(x,C){v.push(x)||v._helper.pause(),p&&p(C)}).on("error",function(x){v.emit("error",x)}).on("end",function(){v.push(null)})}n("../utils").inherits(f,c),f.prototype._read=function(){this._helper.resume()},o.exports=f},{"../utils":32,"readable-stream":16}],14:[function(n,o,i){o.exports={isNode:typeof Buffer<"u",newBufferFrom:function(c,f){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(c,f);if(typeof c=="number")throw new Error('The "data" argument must not be a number');return new Buffer(c,f)},allocBuffer:function(c){if(Buffer.alloc)return Buffer.alloc(c);var f=new Buffer(c);return f.fill(0),f},isBuffer:function(c){return Buffer.isBuffer(c)},isStream:function(c){return c&&typeof c.on=="function"&&typeof c.pause=="function"&&typeof c.resume=="function"}}},{}],15:[function(n,o,i){function c(P,G,$){var oe,J=m.getTypeOf(G),Z=m.extend($||{},v);Z.date=Z.date||new Date,Z.compression!==null&&(Z.compression=Z.compression.toUpperCase()),typeof Z.unixPermissions=="string"&&(Z.unixPermissions=parseInt(Z.unixPermissions,8)),Z.unixPermissions&&16384&Z.unixPermissions&&(Z.dir=!0),Z.dosPermissions&&16&Z.dosPermissions&&(Z.dir=!0),Z.dir&&(P=D(P)),Z.createFolders&&(oe=A(P))&&F.call(this,oe,!0);var le=J==="string"&&Z.binary===!1&&Z.base64===!1;$&&$.binary!==void 0||(Z.binary=!le),(G instanceof x&&G.uncompressedSize===0||Z.dir||!G||G.length===0)&&(Z.base64=!1,Z.binary=!0,G="",Z.compression="STORE",J="string");var Q=null;Q=G instanceof x||G instanceof h?G:b.isNode&&b.isStream(G)?new T(P,G):m.prepareContent(P,G,Z.binary,Z.optimizedBinaryString,Z.base64);var Y=new C(P,Q,Z);this.files[P]=Y}var f=n("./utf8"),m=n("./utils"),h=n("./stream/GenericWorker"),p=n("./stream/StreamHelper"),v=n("./defaults"),x=n("./compressedObject"),C=n("./zipObject"),S=n("./generate"),b=n("./nodejsUtils"),T=n("./nodejs/NodejsStreamInputAdapter"),A=function(P){P.slice(-1)==="/"&&(P=P.substring(0,P.length-1));var G=P.lastIndexOf("/");return 0<G?P.substring(0,G):""},D=function(P){return P.slice(-1)!=="/"&&(P+="/"),P},F=function(P,G){return G=G!==void 0?G:v.createFolders,P=D(P),this.files[P]||c.call(this,P,null,{dir:!0,createFolders:G}),this.files[P]};function L(P){return Object.prototype.toString.call(P)==="[object RegExp]"}var R={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(P){var G,$,oe;for(G in this.files)oe=this.files[G],($=G.slice(this.root.length,G.length))&&G.slice(0,this.root.length)===this.root&&P($,oe)},filter:function(P){var G=[];return this.forEach(function($,oe){P($,oe)&&G.push(oe)}),G},file:function(P,G,$){if(arguments.length!==1)return P=this.root+P,c.call(this,P,G,$),this;if(L(P)){var oe=P;return this.filter(function(Z,le){return!le.dir&&oe.test(Z)})}var J=this.files[this.root+P];return J&&!J.dir?J:null},folder:function(P){if(!P)return this;if(L(P))return this.filter(function(J,Z){return Z.dir&&P.test(J)});var G=this.root+P,$=F.call(this,G),oe=this.clone();return oe.root=$.name,oe},remove:function(P){P=this.root+P;var G=this.files[P];if(G||(P.slice(-1)!=="/"&&(P+="/"),G=this.files[P]),G&&!G.dir)delete this.files[P];else for(var $=this.filter(function(J,Z){return Z.name.slice(0,P.length)===P}),oe=0;oe<$.length;oe++)delete this.files[$[oe].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(P){var G,$={};try{if(($=m.extend(P||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:f.utf8encode})).type=$.type.toLowerCase(),$.compression=$.compression.toUpperCase(),$.type==="binarystring"&&($.type="string"),!$.type)throw new Error("No output type specified.");m.checkSupport($.type),$.platform!=="darwin"&&$.platform!=="freebsd"&&$.platform!=="linux"&&$.platform!=="sunos"||($.platform="UNIX"),$.platform==="win32"&&($.platform="DOS");var oe=$.comment||this.comment||"";G=S.generateWorker(this,$,oe)}catch(J){(G=new h("error")).error(J)}return new p(G,$.type||"string",$.mimeType)},generateAsync:function(P,G){return this.generateInternalStream(P).accumulate(G)},generateNodeStream:function(P,G){return(P=P||{}).type||(P.type="nodebuffer"),this.generateInternalStream(P).toNodejsStream(G)}};o.exports=R},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(n,o,i){o.exports=n("stream")},{stream:void 0}],17:[function(n,o,i){var c=n("./DataReader");function f(m){c.call(this,m);for(var h=0;h<this.data.length;h++)m[h]=255&m[h]}n("../utils").inherits(f,c),f.prototype.byteAt=function(m){return this.data[this.zero+m]},f.prototype.lastIndexOfSignature=function(m){for(var h=m.charCodeAt(0),p=m.charCodeAt(1),v=m.charCodeAt(2),x=m.charCodeAt(3),C=this.length-4;0<=C;--C)if(this.data[C]===h&&this.data[C+1]===p&&this.data[C+2]===v&&this.data[C+3]===x)return C-this.zero;return-1},f.prototype.readAndCheckSignature=function(m){var h=m.charCodeAt(0),p=m.charCodeAt(1),v=m.charCodeAt(2),x=m.charCodeAt(3),C=this.readData(4);return h===C[0]&&p===C[1]&&v===C[2]&&x===C[3]},f.prototype.readData=function(m){if(this.checkOffset(m),m===0)return[];var h=this.data.slice(this.zero+this.index,this.zero+this.index+m);return this.index+=m,h},o.exports=f},{"../utils":32,"./DataReader":18}],18:[function(n,o,i){var c=n("../utils");function f(m){this.data=m,this.length=m.length,this.index=0,this.zero=0}f.prototype={checkOffset:function(m){this.checkIndex(this.index+m)},checkIndex:function(m){if(this.length<this.zero+m||m<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+m+"). Corrupted zip ?")},setIndex:function(m){this.checkIndex(m),this.index=m},skip:function(m){this.setIndex(this.index+m)},byteAt:function(){},readInt:function(m){var h,p=0;for(this.checkOffset(m),h=this.index+m-1;h>=this.index;h--)p=(p<<8)+this.byteAt(h);return this.index+=m,p},readString:function(m){return c.transformTo("string",this.readData(m))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var m=this.readInt(4);return new Date(Date.UTC(1980+(m>>25&127),(m>>21&15)-1,m>>16&31,m>>11&31,m>>5&63,(31&m)<<1))}},o.exports=f},{"../utils":32}],19:[function(n,o,i){var c=n("./Uint8ArrayReader");function f(m){c.call(this,m)}n("../utils").inherits(f,c),f.prototype.readData=function(m){this.checkOffset(m);var h=this.data.slice(this.zero+this.index,this.zero+this.index+m);return this.index+=m,h},o.exports=f},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(n,o,i){var c=n("./DataReader");function f(m){c.call(this,m)}n("../utils").inherits(f,c),f.prototype.byteAt=function(m){return this.data.charCodeAt(this.zero+m)},f.prototype.lastIndexOfSignature=function(m){return this.data.lastIndexOf(m)-this.zero},f.prototype.readAndCheckSignature=function(m){return m===this.readData(4)},f.prototype.readData=function(m){this.checkOffset(m);var h=this.data.slice(this.zero+this.index,this.zero+this.index+m);return this.index+=m,h},o.exports=f},{"../utils":32,"./DataReader":18}],21:[function(n,o,i){var c=n("./ArrayReader");function f(m){c.call(this,m)}n("../utils").inherits(f,c),f.prototype.readData=function(m){if(this.checkOffset(m),m===0)return new Uint8Array(0);var h=this.data.subarray(this.zero+this.index,this.zero+this.index+m);return this.index+=m,h},o.exports=f},{"../utils":32,"./ArrayReader":17}],22:[function(n,o,i){var c=n("../utils"),f=n("../support"),m=n("./ArrayReader"),h=n("./StringReader"),p=n("./NodeBufferReader"),v=n("./Uint8ArrayReader");o.exports=function(x){var C=c.getTypeOf(x);return c.checkSupport(C),C!=="string"||f.uint8array?C==="nodebuffer"?new p(x):f.uint8array?new v(c.transformTo("uint8array",x)):new m(c.transformTo("array",x)):new h(x)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(n,o,i){i.LOCAL_FILE_HEADER="PK",i.CENTRAL_FILE_HEADER="PK",i.CENTRAL_DIRECTORY_END="PK",i.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07",i.ZIP64_CENTRAL_DIRECTORY_END="PK",i.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(n,o,i){var c=n("./GenericWorker"),f=n("../utils");function m(h){c.call(this,"ConvertWorker to "+h),this.destType=h}f.inherits(m,c),m.prototype.processChunk=function(h){this.push({data:f.transformTo(this.destType,h.data),meta:h.meta})},o.exports=m},{"../utils":32,"./GenericWorker":28}],25:[function(n,o,i){var c=n("./GenericWorker"),f=n("../crc32");function m(){c.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}n("../utils").inherits(m,c),m.prototype.processChunk=function(h){this.streamInfo.crc32=f(h.data,this.streamInfo.crc32||0),this.push(h)},o.exports=m},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(n,o,i){var c=n("../utils"),f=n("./GenericWorker");function m(h){f.call(this,"DataLengthProbe for "+h),this.propName=h,this.withStreamInfo(h,0)}c.inherits(m,f),m.prototype.processChunk=function(h){if(h){var p=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=p+h.data.length}f.prototype.processChunk.call(this,h)},o.exports=m},{"../utils":32,"./GenericWorker":28}],27:[function(n,o,i){var c=n("../utils"),f=n("./GenericWorker");function m(h){f.call(this,"DataWorker");var p=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,h.then(function(v){p.dataIsReady=!0,p.data=v,p.max=v&&v.length||0,p.type=c.getTypeOf(v),p.isPaused||p._tickAndRepeat()},function(v){p.error(v)})}c.inherits(m,f),m.prototype.cleanUp=function(){f.prototype.cleanUp.call(this),this.data=null},m.prototype.resume=function(){return!!f.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,c.delay(this._tickAndRepeat,[],this)),!0)},m.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(c.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},m.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var h=null,p=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":h=this.data.substring(this.index,p);break;case"uint8array":h=this.data.subarray(this.index,p);break;case"array":case"nodebuffer":h=this.data.slice(this.index,p)}return this.index=p,this.push({data:h,meta:{percent:this.max?this.index/this.max*100:0}})},o.exports=m},{"../utils":32,"./GenericWorker":28}],28:[function(n,o,i){function c(f){this.name=f||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}c.prototype={push:function(f){this.emit("data",f)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(f){this.emit("error",f)}return!0},error:function(f){return!this.isFinished&&(this.isPaused?this.generatedError=f:(this.isFinished=!0,this.emit("error",f),this.previous&&this.previous.error(f),this.cleanUp()),!0)},on:function(f,m){return this._listeners[f].push(m),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(f,m){if(this._listeners[f])for(var h=0;h<this._listeners[f].length;h++)this._listeners[f][h].call(this,m)},pipe:function(f){return f.registerPrevious(this)},registerPrevious:function(f){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=f.streamInfo,this.mergeStreamInfo(),this.previous=f;var m=this;return f.on("data",function(h){m.processChunk(h)}),f.on("end",function(){m.end()}),f.on("error",function(h){m.error(h)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var f=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),f=!0),this.previous&&this.previous.resume(),!f},flush:function(){},processChunk:function(f){this.push(f)},withStreamInfo:function(f,m){return this.extraStreamInfo[f]=m,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var f in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,f)&&(this.streamInfo[f]=this.extraStreamInfo[f])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var f="Worker "+this.name;return this.previous?this.previous+" -> "+f:f}},o.exports=c},{}],29:[function(n,o,i){var c=n("../utils"),f=n("./ConvertWorker"),m=n("./GenericWorker"),h=n("../base64"),p=n("../support"),v=n("../external"),x=null;if(p.nodestream)try{x=n("../nodejs/NodejsStreamOutputAdapter")}catch{}function C(b,T){return new v.Promise(function(A,D){var F=[],L=b._internalType,R=b._outputType,P=b._mimeType;b.on("data",function(G,$){F.push(G),T&&T($)}).on("error",function(G){F=[],D(G)}).on("end",function(){try{var G=function($,oe,J){switch($){case"blob":return c.newBlob(c.transformTo("arraybuffer",oe),J);case"base64":return h.encode(oe);default:return c.transformTo($,oe)}}(R,function($,oe){var J,Z=0,le=null,Q=0;for(J=0;J<oe.length;J++)Q+=oe[J].length;switch($){case"string":return oe.join("");case"array":return Array.prototype.concat.apply([],oe);case"uint8array":for(le=new Uint8Array(Q),J=0;J<oe.length;J++)le.set(oe[J],Z),Z+=oe[J].length;return le;case"nodebuffer":return Buffer.concat(oe);default:throw new Error("concat : unsupported type '"+$+"'")}}(L,F),P);A(G)}catch($){D($)}F=[]}).resume()})}function S(b,T,A){var D=T;switch(T){case"blob":case"arraybuffer":D="uint8array";break;case"base64":D="string"}try{this._internalType=D,this._outputType=T,this._mimeType=A,c.checkSupport(D),this._worker=b.pipe(new f(D)),b.lock()}catch(F){this._worker=new m("error"),this._worker.error(F)}}S.prototype={accumulate:function(b){return C(this,b)},on:function(b,T){var A=this;return b==="data"?this._worker.on(b,function(D){T.call(A,D.data,D.meta)}):this._worker.on(b,function(){c.delay(T,arguments,A)}),this},resume:function(){return c.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(b){if(c.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new x(this,{objectMode:this._outputType!=="nodebuffer"},b)}},o.exports=S},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(n,o,i){if(i.base64=!0,i.array=!0,i.string=!0,i.arraybuffer=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u",i.nodebuffer=typeof Buffer<"u",i.uint8array=typeof Uint8Array<"u",typeof ArrayBuffer>"u")i.blob=!1;else{var c=new ArrayBuffer(0);try{i.blob=new Blob([c],{type:"application/zip"}).size===0}catch{try{var f=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);f.append(c),i.blob=f.getBlob("application/zip").size===0}catch{i.blob=!1}}}try{i.nodestream=!!n("readable-stream").Readable}catch{i.nodestream=!1}},{"readable-stream":16}],31:[function(n,o,i){for(var c=n("./utils"),f=n("./support"),m=n("./nodejsUtils"),h=n("./stream/GenericWorker"),p=new Array(256),v=0;v<256;v++)p[v]=252<=v?6:248<=v?5:240<=v?4:224<=v?3:192<=v?2:1;p[254]=p[254]=1;function x(){h.call(this,"utf-8 decode"),this.leftOver=null}function C(){h.call(this,"utf-8 encode")}i.utf8encode=function(S){return f.nodebuffer?m.newBufferFrom(S,"utf-8"):function(b){var T,A,D,F,L,R=b.length,P=0;for(F=0;F<R;F++)(64512&(A=b.charCodeAt(F)))==55296&&F+1<R&&(64512&(D=b.charCodeAt(F+1)))==56320&&(A=65536+(A-55296<<10)+(D-56320),F++),P+=A<128?1:A<2048?2:A<65536?3:4;for(T=f.uint8array?new Uint8Array(P):new Array(P),F=L=0;L<P;F++)(64512&(A=b.charCodeAt(F)))==55296&&F+1<R&&(64512&(D=b.charCodeAt(F+1)))==56320&&(A=65536+(A-55296<<10)+(D-56320),F++),A<128?T[L++]=A:(A<2048?T[L++]=192|A>>>6:(A<65536?T[L++]=224|A>>>12:(T[L++]=240|A>>>18,T[L++]=128|A>>>12&63),T[L++]=128|A>>>6&63),T[L++]=128|63&A);return T}(S)},i.utf8decode=function(S){return f.nodebuffer?c.transformTo("nodebuffer",S).toString("utf-8"):function(b){var T,A,D,F,L=b.length,R=new Array(2*L);for(T=A=0;T<L;)if((D=b[T++])<128)R[A++]=D;else if(4<(F=p[D]))R[A++]=65533,T+=F-1;else{for(D&=F===2?31:F===3?15:7;1<F&&T<L;)D=D<<6|63&b[T++],F--;1<F?R[A++]=65533:D<65536?R[A++]=D:(D-=65536,R[A++]=55296|D>>10&1023,R[A++]=56320|1023&D)}return R.length!==A&&(R.subarray?R=R.subarray(0,A):R.length=A),c.applyFromCharCode(R)}(S=c.transformTo(f.uint8array?"uint8array":"array",S))},c.inherits(x,h),x.prototype.processChunk=function(S){var b=c.transformTo(f.uint8array?"uint8array":"array",S.data);if(this.leftOver&&this.leftOver.length){if(f.uint8array){var T=b;(b=new Uint8Array(T.length+this.leftOver.length)).set(this.leftOver,0),b.set(T,this.leftOver.length)}else b=this.leftOver.concat(b);this.leftOver=null}var A=function(F,L){var R;for((L=L||F.length)>F.length&&(L=F.length),R=L-1;0<=R&&(192&F[R])==128;)R--;return R<0||R===0?L:R+p[F[R]]>L?R:L}(b),D=b;A!==b.length&&(f.uint8array?(D=b.subarray(0,A),this.leftOver=b.subarray(A,b.length)):(D=b.slice(0,A),this.leftOver=b.slice(A,b.length))),this.push({data:i.utf8decode(D),meta:S.meta})},x.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:i.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},i.Utf8DecodeWorker=x,c.inherits(C,h),C.prototype.processChunk=function(S){this.push({data:i.utf8encode(S.data),meta:S.meta})},i.Utf8EncodeWorker=C},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(n,o,i){var c=n("./support"),f=n("./base64"),m=n("./nodejsUtils"),h=n("./external");function p(T){return T}function v(T,A){for(var D=0;D<T.length;++D)A[D]=255&T.charCodeAt(D);return A}n("setimmediate"),i.newBlob=function(T,A){i.checkSupport("blob");try{return new Blob([T],{type:A})}catch{try{var D=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return D.append(T),D.getBlob(A)}catch{throw new Error("Bug : can't construct the Blob.")}}};var x={stringifyByChunk:function(T,A,D){var F=[],L=0,R=T.length;if(R<=D)return String.fromCharCode.apply(null,T);for(;L<R;)A==="array"||A==="nodebuffer"?F.push(String.fromCharCode.apply(null,T.slice(L,Math.min(L+D,R)))):F.push(String.fromCharCode.apply(null,T.subarray(L,Math.min(L+D,R)))),L+=D;return F.join("")},stringifyByChar:function(T){for(var A="",D=0;D<T.length;D++)A+=String.fromCharCode(T[D]);return A},applyCanBeUsed:{uint8array:function(){try{return c.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch{return!1}}(),nodebuffer:function(){try{return c.nodebuffer&&String.fromCharCode.apply(null,m.allocBuffer(1)).length===1}catch{return!1}}()}};function C(T){var A=65536,D=i.getTypeOf(T),F=!0;if(D==="uint8array"?F=x.applyCanBeUsed.uint8array:D==="nodebuffer"&&(F=x.applyCanBeUsed.nodebuffer),F)for(;1<A;)try{return x.stringifyByChunk(T,D,A)}catch{A=Math.floor(A/2)}return x.stringifyByChar(T)}function S(T,A){for(var D=0;D<T.length;D++)A[D]=T[D];return A}i.applyFromCharCode=C;var b={};b.string={string:p,array:function(T){return v(T,new Array(T.length))},arraybuffer:function(T){return b.string.uint8array(T).buffer},uint8array:function(T){return v(T,new Uint8Array(T.length))},nodebuffer:function(T){return v(T,m.allocBuffer(T.length))}},b.array={string:C,array:p,arraybuffer:function(T){return new Uint8Array(T).buffer},uint8array:function(T){return new Uint8Array(T)},nodebuffer:function(T){return m.newBufferFrom(T)}},b.arraybuffer={string:function(T){return C(new Uint8Array(T))},array:function(T){return S(new Uint8Array(T),new Array(T.byteLength))},arraybuffer:p,uint8array:function(T){return new Uint8Array(T)},nodebuffer:function(T){return m.newBufferFrom(new Uint8Array(T))}},b.uint8array={string:C,array:function(T){return S(T,new Array(T.length))},arraybuffer:function(T){return T.buffer},uint8array:p,nodebuffer:function(T){return m.newBufferFrom(T)}},b.nodebuffer={string:C,array:function(T){return S(T,new Array(T.length))},arraybuffer:function(T){return b.nodebuffer.uint8array(T).buffer},uint8array:function(T){return S(T,new Uint8Array(T.length))},nodebuffer:p},i.transformTo=function(T,A){if(A=A||"",!T)return A;i.checkSupport(T);var D=i.getTypeOf(A);return b[D][T](A)},i.resolve=function(T){for(var A=T.split("/"),D=[],F=0;F<A.length;F++){var L=A[F];L==="."||L===""&&F!==0&&F!==A.length-1||(L===".."?D.pop():D.push(L))}return D.join("/")},i.getTypeOf=function(T){return typeof T=="string"?"string":Object.prototype.toString.call(T)==="[object Array]"?"array":c.nodebuffer&&m.isBuffer(T)?"nodebuffer":c.uint8array&&T instanceof Uint8Array?"uint8array":c.arraybuffer&&T instanceof ArrayBuffer?"arraybuffer":void 0},i.checkSupport=function(T){if(!c[T.toLowerCase()])throw new Error(T+" is not supported by this platform")},i.MAX_VALUE_16BITS=65535,i.MAX_VALUE_32BITS=-1,i.pretty=function(T){var A,D,F="";for(D=0;D<(T||"").length;D++)F+="\\x"+((A=T.charCodeAt(D))<16?"0":"")+A.toString(16).toUpperCase();return F},i.delay=function(T,A,D){setImmediate(function(){T.apply(D||null,A||[])})},i.inherits=function(T,A){function D(){}D.prototype=A.prototype,T.prototype=new D},i.extend=function(){var T,A,D={};for(T=0;T<arguments.length;T++)for(A in arguments[T])Object.prototype.hasOwnProperty.call(arguments[T],A)&&D[A]===void 0&&(D[A]=arguments[T][A]);return D},i.prepareContent=function(T,A,D,F,L){return h.Promise.resolve(A).then(function(R){return c.blob&&(R instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(R))!==-1)&&typeof FileReader<"u"?new h.Promise(function(P,G){var $=new FileReader;$.onload=function(oe){P(oe.target.result)},$.onerror=function(oe){G(oe.target.error)},$.readAsArrayBuffer(R)}):R}).then(function(R){var P=i.getTypeOf(R);return P?(P==="arraybuffer"?R=i.transformTo("uint8array",R):P==="string"&&(L?R=f.decode(R):D&&F!==!0&&(R=function(G){return v(G,c.uint8array?new Uint8Array(G.length):new Array(G.length))}(R))),R):h.Promise.reject(new Error("Can't read the data of '"+T+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(n,o,i){var c=n("./reader/readerFor"),f=n("./utils"),m=n("./signature"),h=n("./zipEntry"),p=n("./support");function v(x){this.files=[],this.loadOptions=x}v.prototype={checkSignature:function(x){if(!this.reader.readAndCheckSignature(x)){this.reader.index-=4;var C=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+f.pretty(C)+", expected "+f.pretty(x)+")")}},isSignature:function(x,C){var S=this.reader.index;this.reader.setIndex(x);var b=this.reader.readString(4)===C;return this.reader.setIndex(S),b},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var x=this.reader.readData(this.zipCommentLength),C=p.uint8array?"uint8array":"array",S=f.transformTo(C,x);this.zipComment=this.loadOptions.decodeFileName(S)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var x,C,S,b=this.zip64EndOfCentralSize-44;0<b;)x=this.reader.readInt(2),C=this.reader.readInt(4),S=this.reader.readData(C),this.zip64ExtensibleData[x]={id:x,length:C,value:S}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var x,C;for(x=0;x<this.files.length;x++)C=this.files[x],this.reader.setIndex(C.localHeaderOffset),this.checkSignature(m.LOCAL_FILE_HEADER),C.readLocalPart(this.reader),C.handleUTF8(),C.processAttributes()},readCentralDir:function(){var x;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(m.CENTRAL_FILE_HEADER);)(x=new h({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(x);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var x=this.reader.lastIndexOfSignature(m.CENTRAL_DIRECTORY_END);if(x<0)throw this.isSignature(0,m.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(x);var C=x;if(this.checkSignature(m.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===f.MAX_VALUE_16BITS||this.diskWithCentralDirStart===f.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===f.MAX_VALUE_16BITS||this.centralDirRecords===f.MAX_VALUE_16BITS||this.centralDirSize===f.MAX_VALUE_32BITS||this.centralDirOffset===f.MAX_VALUE_32BITS){if(this.zip64=!0,(x=this.reader.lastIndexOfSignature(m.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(x),this.checkSignature(m.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,m.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(m.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(m.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var S=this.centralDirOffset+this.centralDirSize;this.zip64&&(S+=20,S+=12+this.zip64EndOfCentralSize);var b=C-S;if(0<b)this.isSignature(C,m.CENTRAL_FILE_HEADER)||(this.reader.zero=b);else if(b<0)throw new Error("Corrupted zip: missing "+Math.abs(b)+" bytes.")},prepareReader:function(x){this.reader=c(x)},load:function(x){this.prepareReader(x),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},o.exports=v},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(n,o,i){var c=n("./reader/readerFor"),f=n("./utils"),m=n("./compressedObject"),h=n("./crc32"),p=n("./utf8"),v=n("./compressions"),x=n("./support");function C(S,b){this.options=S,this.loadOptions=b}C.prototype={isEncrypted:function(){return(1&this.bitFlag)==1},useUTF8:function(){return(2048&this.bitFlag)==2048},readLocalPart:function(S){var b,T;if(S.skip(22),this.fileNameLength=S.readInt(2),T=S.readInt(2),this.fileName=S.readData(this.fileNameLength),S.skip(T),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if((b=function(A){for(var D in v)if(Object.prototype.hasOwnProperty.call(v,D)&&v[D].magic===A)return v[D];return null}(this.compressionMethod))===null)throw new Error("Corrupted zip : compression "+f.pretty(this.compressionMethod)+" unknown (inner file : "+f.transformTo("string",this.fileName)+")");this.decompressed=new m(this.compressedSize,this.uncompressedSize,this.crc32,b,S.readData(this.compressedSize))},readCentralPart:function(S){this.versionMadeBy=S.readInt(2),S.skip(2),this.bitFlag=S.readInt(2),this.compressionMethod=S.readString(2),this.date=S.readDate(),this.crc32=S.readInt(4),this.compressedSize=S.readInt(4),this.uncompressedSize=S.readInt(4);var b=S.readInt(2);if(this.extraFieldsLength=S.readInt(2),this.fileCommentLength=S.readInt(2),this.diskNumberStart=S.readInt(2),this.internalFileAttributes=S.readInt(2),this.externalFileAttributes=S.readInt(4),this.localHeaderOffset=S.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");S.skip(b),this.readExtraFields(S),this.parseZIP64ExtraField(S),this.fileComment=S.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var S=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),S==0&&(this.dosPermissions=63&this.externalFileAttributes),S==3&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||this.fileNameStr.slice(-1)!=="/"||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var S=c(this.extraFields[1].value);this.uncompressedSize===f.MAX_VALUE_32BITS&&(this.uncompressedSize=S.readInt(8)),this.compressedSize===f.MAX_VALUE_32BITS&&(this.compressedSize=S.readInt(8)),this.localHeaderOffset===f.MAX_VALUE_32BITS&&(this.localHeaderOffset=S.readInt(8)),this.diskNumberStart===f.MAX_VALUE_32BITS&&(this.diskNumberStart=S.readInt(4))}},readExtraFields:function(S){var b,T,A,D=S.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});S.index+4<D;)b=S.readInt(2),T=S.readInt(2),A=S.readData(T),this.extraFields[b]={id:b,length:T,value:A};S.setIndex(D)},handleUTF8:function(){var S=x.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=p.utf8decode(this.fileName),this.fileCommentStr=p.utf8decode(this.fileComment);else{var b=this.findExtraFieldUnicodePath();if(b!==null)this.fileNameStr=b;else{var T=f.transformTo(S,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(T)}var A=this.findExtraFieldUnicodeComment();if(A!==null)this.fileCommentStr=A;else{var D=f.transformTo(S,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(D)}}},findExtraFieldUnicodePath:function(){var S=this.extraFields[28789];if(S){var b=c(S.value);return b.readInt(1)!==1||h(this.fileName)!==b.readInt(4)?null:p.utf8decode(b.readData(S.length-5))}return null},findExtraFieldUnicodeComment:function(){var S=this.extraFields[25461];if(S){var b=c(S.value);return b.readInt(1)!==1||h(this.fileComment)!==b.readInt(4)?null:p.utf8decode(b.readData(S.length-5))}return null}},o.exports=C},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(n,o,i){function c(b,T,A){this.name=b,this.dir=A.dir,this.date=A.date,this.comment=A.comment,this.unixPermissions=A.unixPermissions,this.dosPermissions=A.dosPermissions,this._data=T,this._dataBinary=A.binary,this.options={compression:A.compression,compressionOptions:A.compressionOptions}}var f=n("./stream/StreamHelper"),m=n("./stream/DataWorker"),h=n("./utf8"),p=n("./compressedObject"),v=n("./stream/GenericWorker");c.prototype={internalStream:function(b){var T=null,A="string";try{if(!b)throw new Error("No output type specified.");var D=(A=b.toLowerCase())==="string"||A==="text";A!=="binarystring"&&A!=="text"||(A="string"),T=this._decompressWorker();var F=!this._dataBinary;F&&!D&&(T=T.pipe(new h.Utf8EncodeWorker)),!F&&D&&(T=T.pipe(new h.Utf8DecodeWorker))}catch(L){(T=new v("error")).error(L)}return new f(T,A,"")},async:function(b,T){return this.internalStream(b).accumulate(T)},nodeStream:function(b,T){return this.internalStream(b||"nodebuffer").toNodejsStream(T)},_compressWorker:function(b,T){if(this._data instanceof p&&this._data.compression.magic===b.magic)return this._data.getCompressedWorker();var A=this._decompressWorker();return this._dataBinary||(A=A.pipe(new h.Utf8EncodeWorker)),p.createWorkerFrom(A,b,T)},_decompressWorker:function(){return this._data instanceof p?this._data.getContentWorker():this._data instanceof v?this._data:new m(this._data)}};for(var x=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],C=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},S=0;S<x.length;S++)c.prototype[x[S]]=C;o.exports=c},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(n,o,i){(function(c){var f,m,h=c.MutationObserver||c.WebKitMutationObserver;if(h){var p=0,v=new h(b),x=c.document.createTextNode("");v.observe(x,{characterData:!0}),f=function(){x.data=p=++p%2}}else if(c.setImmediate||c.MessageChannel===void 0)f="document"in c&&"onreadystatechange"in c.document.createElement("script")?function(){var T=c.document.createElement("script");T.onreadystatechange=function(){b(),T.onreadystatechange=null,T.parentNode.removeChild(T),T=null},c.document.documentElement.appendChild(T)}:function(){setTimeout(b,0)};else{var C=new c.MessageChannel;C.port1.onmessage=b,f=function(){C.port2.postMessage(0)}}var S=[];function b(){var T,A;m=!0;for(var D=S.length;D;){for(A=S,S=[],T=-1;++T<D;)A[T]();D=S.length}m=!1}o.exports=function(T){S.push(T)!==1||m||f()}}).call(this,typeof Aa<"u"?Aa:typeof self<"u"?self:typeof window<"u"?window:{})},{}],37:[function(n,o,i){var c=n("immediate");function f(){}var m={},h=["REJECTED"],p=["FULFILLED"],v=["PENDING"];function x(D){if(typeof D!="function")throw new TypeError("resolver must be a function");this.state=v,this.queue=[],this.outcome=void 0,D!==f&&T(this,D)}function C(D,F,L){this.promise=D,typeof F=="function"&&(this.onFulfilled=F,this.callFulfilled=this.otherCallFulfilled),typeof L=="function"&&(this.onRejected=L,this.callRejected=this.otherCallRejected)}function S(D,F,L){c(function(){var R;try{R=F(L)}catch(P){return m.reject(D,P)}R===D?m.reject(D,new TypeError("Cannot resolve promise with itself")):m.resolve(D,R)})}function b(D){var F=D&&D.then;if(D&&(typeof D=="object"||typeof D=="function")&&typeof F=="function")return function(){F.apply(D,arguments)}}function T(D,F){var L=!1;function R($){L||(L=!0,m.reject(D,$))}function P($){L||(L=!0,m.resolve(D,$))}var G=A(function(){F(P,R)});G.status==="error"&&R(G.value)}function A(D,F){var L={};try{L.value=D(F),L.status="success"}catch(R){L.status="error",L.value=R}return L}(o.exports=x).prototype.finally=function(D){if(typeof D!="function")return this;var F=this.constructor;return this.then(function(L){return F.resolve(D()).then(function(){return L})},function(L){return F.resolve(D()).then(function(){throw L})})},x.prototype.catch=function(D){return this.then(null,D)},x.prototype.then=function(D,F){if(typeof D!="function"&&this.state===p||typeof F!="function"&&this.state===h)return this;var L=new this.constructor(f);return this.state!==v?S(L,this.state===p?D:F,this.outcome):this.queue.push(new C(L,D,F)),L},C.prototype.callFulfilled=function(D){m.resolve(this.promise,D)},C.prototype.otherCallFulfilled=function(D){S(this.promise,this.onFulfilled,D)},C.prototype.callRejected=function(D){m.reject(this.promise,D)},C.prototype.otherCallRejected=function(D){S(this.promise,this.onRejected,D)},m.resolve=function(D,F){var L=A(b,F);if(L.status==="error")return m.reject(D,L.value);var R=L.value;if(R)T(D,R);else{D.state=p,D.outcome=F;for(var P=-1,G=D.queue.length;++P<G;)D.queue[P].callFulfilled(F)}return D},m.reject=function(D,F){D.state=h,D.outcome=F;for(var L=-1,R=D.queue.length;++L<R;)D.queue[L].callRejected(F);return D},x.resolve=function(D){return D instanceof this?D:m.resolve(new this(f),D)},x.reject=function(D){var F=new this(f);return m.reject(F,D)},x.all=function(D){var F=this;if(Object.prototype.toString.call(D)!=="[object Array]")return this.reject(new TypeError("must be an array"));var L=D.length,R=!1;if(!L)return this.resolve([]);for(var P=new Array(L),G=0,$=-1,oe=new this(f);++$<L;)J(D[$],$);return oe;function J(Z,le){F.resolve(Z).then(function(Q){P[le]=Q,++G!==L||R||(R=!0,m.resolve(oe,P))},function(Q){R||(R=!0,m.reject(oe,Q))})}},x.race=function(D){var F=this;if(Object.prototype.toString.call(D)!=="[object Array]")return this.reject(new TypeError("must be an array"));var L=D.length,R=!1;if(!L)return this.resolve([]);for(var P=-1,G=new this(f);++P<L;)$=D[P],F.resolve($).then(function(oe){R||(R=!0,m.resolve(G,oe))},function(oe){R||(R=!0,m.reject(G,oe))});var $;return G}},{immediate:36}],38:[function(n,o,i){var c={};(0,n("./lib/utils/common").assign)(c,n("./lib/deflate"),n("./lib/inflate"),n("./lib/zlib/constants")),o.exports=c},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(n,o,i){var c=n("./zlib/deflate"),f=n("./utils/common"),m=n("./utils/strings"),h=n("./zlib/messages"),p=n("./zlib/zstream"),v=Object.prototype.toString,x=0,C=-1,S=0,b=8;function T(D){if(!(this instanceof T))return new T(D);this.options=f.assign({level:C,method:b,chunkSize:16384,windowBits:15,memLevel:8,strategy:S,to:""},D||{});var F=this.options;F.raw&&0<F.windowBits?F.windowBits=-F.windowBits:F.gzip&&0<F.windowBits&&F.windowBits<16&&(F.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new p,this.strm.avail_out=0;var L=c.deflateInit2(this.strm,F.level,F.method,F.windowBits,F.memLevel,F.strategy);if(L!==x)throw new Error(h[L]);if(F.header&&c.deflateSetHeader(this.strm,F.header),F.dictionary){var R;if(R=typeof F.dictionary=="string"?m.string2buf(F.dictionary):v.call(F.dictionary)==="[object ArrayBuffer]"?new Uint8Array(F.dictionary):F.dictionary,(L=c.deflateSetDictionary(this.strm,R))!==x)throw new Error(h[L]);this._dict_set=!0}}function A(D,F){var L=new T(F);if(L.push(D,!0),L.err)throw L.msg||h[L.err];return L.result}T.prototype.push=function(D,F){var L,R,P=this.strm,G=this.options.chunkSize;if(this.ended)return!1;R=F===~~F?F:F===!0?4:0,typeof D=="string"?P.input=m.string2buf(D):v.call(D)==="[object ArrayBuffer]"?P.input=new Uint8Array(D):P.input=D,P.next_in=0,P.avail_in=P.input.length;do{if(P.avail_out===0&&(P.output=new f.Buf8(G),P.next_out=0,P.avail_out=G),(L=c.deflate(P,R))!==1&&L!==x)return this.onEnd(L),!(this.ended=!0);P.avail_out!==0&&(P.avail_in!==0||R!==4&&R!==2)||(this.options.to==="string"?this.onData(m.buf2binstring(f.shrinkBuf(P.output,P.next_out))):this.onData(f.shrinkBuf(P.output,P.next_out)))}while((0<P.avail_in||P.avail_out===0)&&L!==1);return R===4?(L=c.deflateEnd(this.strm),this.onEnd(L),this.ended=!0,L===x):R!==2||(this.onEnd(x),!(P.avail_out=0))},T.prototype.onData=function(D){this.chunks.push(D)},T.prototype.onEnd=function(D){D===x&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=f.flattenChunks(this.chunks)),this.chunks=[],this.err=D,this.msg=this.strm.msg},i.Deflate=T,i.deflate=A,i.deflateRaw=function(D,F){return(F=F||{}).raw=!0,A(D,F)},i.gzip=function(D,F){return(F=F||{}).gzip=!0,A(D,F)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(n,o,i){var c=n("./zlib/inflate"),f=n("./utils/common"),m=n("./utils/strings"),h=n("./zlib/constants"),p=n("./zlib/messages"),v=n("./zlib/zstream"),x=n("./zlib/gzheader"),C=Object.prototype.toString;function S(T){if(!(this instanceof S))return new S(T);this.options=f.assign({chunkSize:16384,windowBits:0,to:""},T||{});var A=this.options;A.raw&&0<=A.windowBits&&A.windowBits<16&&(A.windowBits=-A.windowBits,A.windowBits===0&&(A.windowBits=-15)),!(0<=A.windowBits&&A.windowBits<16)||T&&T.windowBits||(A.windowBits+=32),15<A.windowBits&&A.windowBits<48&&(15&A.windowBits)==0&&(A.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new v,this.strm.avail_out=0;var D=c.inflateInit2(this.strm,A.windowBits);if(D!==h.Z_OK)throw new Error(p[D]);this.header=new x,c.inflateGetHeader(this.strm,this.header)}function b(T,A){var D=new S(A);if(D.push(T,!0),D.err)throw D.msg||p[D.err];return D.result}S.prototype.push=function(T,A){var D,F,L,R,P,G,$=this.strm,oe=this.options.chunkSize,J=this.options.dictionary,Z=!1;if(this.ended)return!1;F=A===~~A?A:A===!0?h.Z_FINISH:h.Z_NO_FLUSH,typeof T=="string"?$.input=m.binstring2buf(T):C.call(T)==="[object ArrayBuffer]"?$.input=new Uint8Array(T):$.input=T,$.next_in=0,$.avail_in=$.input.length;do{if($.avail_out===0&&($.output=new f.Buf8(oe),$.next_out=0,$.avail_out=oe),(D=c.inflate($,h.Z_NO_FLUSH))===h.Z_NEED_DICT&&J&&(G=typeof J=="string"?m.string2buf(J):C.call(J)==="[object ArrayBuffer]"?new Uint8Array(J):J,D=c.inflateSetDictionary(this.strm,G)),D===h.Z_BUF_ERROR&&Z===!0&&(D=h.Z_OK,Z=!1),D!==h.Z_STREAM_END&&D!==h.Z_OK)return this.onEnd(D),!(this.ended=!0);$.next_out&&($.avail_out!==0&&D!==h.Z_STREAM_END&&($.avail_in!==0||F!==h.Z_FINISH&&F!==h.Z_SYNC_FLUSH)||(this.options.to==="string"?(L=m.utf8border($.output,$.next_out),R=$.next_out-L,P=m.buf2string($.output,L),$.next_out=R,$.avail_out=oe-R,R&&f.arraySet($.output,$.output,L,R,0),this.onData(P)):this.onData(f.shrinkBuf($.output,$.next_out)))),$.avail_in===0&&$.avail_out===0&&(Z=!0)}while((0<$.avail_in||$.avail_out===0)&&D!==h.Z_STREAM_END);return D===h.Z_STREAM_END&&(F=h.Z_FINISH),F===h.Z_FINISH?(D=c.inflateEnd(this.strm),this.onEnd(D),this.ended=!0,D===h.Z_OK):F!==h.Z_SYNC_FLUSH||(this.onEnd(h.Z_OK),!($.avail_out=0))},S.prototype.onData=function(T){this.chunks.push(T)},S.prototype.onEnd=function(T){T===h.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=f.flattenChunks(this.chunks)),this.chunks=[],this.err=T,this.msg=this.strm.msg},i.Inflate=S,i.inflate=b,i.inflateRaw=function(T,A){return(A=A||{}).raw=!0,b(T,A)},i.ungzip=b},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(n,o,i){var c=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";i.assign=function(h){for(var p=Array.prototype.slice.call(arguments,1);p.length;){var v=p.shift();if(v){if(typeof v!="object")throw new TypeError(v+"must be non-object");for(var x in v)v.hasOwnProperty(x)&&(h[x]=v[x])}}return h},i.shrinkBuf=function(h,p){return h.length===p?h:h.subarray?h.subarray(0,p):(h.length=p,h)};var f={arraySet:function(h,p,v,x,C){if(p.subarray&&h.subarray)h.set(p.subarray(v,v+x),C);else for(var S=0;S<x;S++)h[C+S]=p[v+S]},flattenChunks:function(h){var p,v,x,C,S,b;for(p=x=0,v=h.length;p<v;p++)x+=h[p].length;for(b=new Uint8Array(x),p=C=0,v=h.length;p<v;p++)S=h[p],b.set(S,C),C+=S.length;return b}},m={arraySet:function(h,p,v,x,C){for(var S=0;S<x;S++)h[C+S]=p[v+S]},flattenChunks:function(h){return[].concat.apply([],h)}};i.setTyped=function(h){h?(i.Buf8=Uint8Array,i.Buf16=Uint16Array,i.Buf32=Int32Array,i.assign(i,f)):(i.Buf8=Array,i.Buf16=Array,i.Buf32=Array,i.assign(i,m))},i.setTyped(c)},{}],42:[function(n,o,i){var c=n("./common"),f=!0,m=!0;try{String.fromCharCode.apply(null,[0])}catch{f=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{m=!1}for(var h=new c.Buf8(256),p=0;p<256;p++)h[p]=252<=p?6:248<=p?5:240<=p?4:224<=p?3:192<=p?2:1;function v(x,C){if(C<65537&&(x.subarray&&m||!x.subarray&&f))return String.fromCharCode.apply(null,c.shrinkBuf(x,C));for(var S="",b=0;b<C;b++)S+=String.fromCharCode(x[b]);return S}h[254]=h[254]=1,i.string2buf=function(x){var C,S,b,T,A,D=x.length,F=0;for(T=0;T<D;T++)(64512&(S=x.charCodeAt(T)))==55296&&T+1<D&&(64512&(b=x.charCodeAt(T+1)))==56320&&(S=65536+(S-55296<<10)+(b-56320),T++),F+=S<128?1:S<2048?2:S<65536?3:4;for(C=new c.Buf8(F),T=A=0;A<F;T++)(64512&(S=x.charCodeAt(T)))==55296&&T+1<D&&(64512&(b=x.charCodeAt(T+1)))==56320&&(S=65536+(S-55296<<10)+(b-56320),T++),S<128?C[A++]=S:(S<2048?C[A++]=192|S>>>6:(S<65536?C[A++]=224|S>>>12:(C[A++]=240|S>>>18,C[A++]=128|S>>>12&63),C[A++]=128|S>>>6&63),C[A++]=128|63&S);return C},i.buf2binstring=function(x){return v(x,x.length)},i.binstring2buf=function(x){for(var C=new c.Buf8(x.length),S=0,b=C.length;S<b;S++)C[S]=x.charCodeAt(S);return C},i.buf2string=function(x,C){var S,b,T,A,D=C||x.length,F=new Array(2*D);for(S=b=0;S<D;)if((T=x[S++])<128)F[b++]=T;else if(4<(A=h[T]))F[b++]=65533,S+=A-1;else{for(T&=A===2?31:A===3?15:7;1<A&&S<D;)T=T<<6|63&x[S++],A--;1<A?F[b++]=65533:T<65536?F[b++]=T:(T-=65536,F[b++]=55296|T>>10&1023,F[b++]=56320|1023&T)}return v(F,b)},i.utf8border=function(x,C){var S;for((C=C||x.length)>x.length&&(C=x.length),S=C-1;0<=S&&(192&x[S])==128;)S--;return S<0||S===0?C:S+h[x[S]]>C?S:C}},{"./common":41}],43:[function(n,o,i){o.exports=function(c,f,m,h){for(var p=65535&c|0,v=c>>>16&65535|0,x=0;m!==0;){for(m-=x=2e3<m?2e3:m;v=v+(p=p+f[h++]|0)|0,--x;);p%=65521,v%=65521}return p|v<<16|0}},{}],44:[function(n,o,i){o.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(n,o,i){var c=function(){for(var f,m=[],h=0;h<256;h++){f=h;for(var p=0;p<8;p++)f=1&f?3988292384^f>>>1:f>>>1;m[h]=f}return m}();o.exports=function(f,m,h,p){var v=c,x=p+h;f^=-1;for(var C=p;C<x;C++)f=f>>>8^v[255&(f^m[C])];return-1^f}},{}],46:[function(n,o,i){var c,f=n("../utils/common"),m=n("./trees"),h=n("./adler32"),p=n("./crc32"),v=n("./messages"),x=0,C=4,S=0,b=-2,T=-1,A=4,D=2,F=8,L=9,R=286,P=30,G=19,$=2*R+1,oe=15,J=3,Z=258,le=Z+J+1,Q=42,Y=113,M=1,pe=2,be=3,ve=4;function xe(E,fe){return E.msg=v[fe],fe}function te(E){return(E<<1)-(4<E?9:0)}function q(E){for(var fe=E.length;0<=--fe;)E[fe]=0}function N(E){var fe=E.state,ce=fe.pending;ce>E.avail_out&&(ce=E.avail_out),ce!==0&&(f.arraySet(E.output,fe.pending_buf,fe.pending_out,ce,E.next_out),E.next_out+=ce,fe.pending_out+=ce,E.total_out+=ce,E.avail_out-=ce,fe.pending-=ce,fe.pending===0&&(fe.pending_out=0))}function j(E,fe){m._tr_flush_block(E,0<=E.block_start?E.block_start:-1,E.strstart-E.block_start,fe),E.block_start=E.strstart,N(E.strm)}function O(E,fe){E.pending_buf[E.pending++]=fe}function V(E,fe){E.pending_buf[E.pending++]=fe>>>8&255,E.pending_buf[E.pending++]=255&fe}function K(E,fe){var ce,W,H=E.max_chain_length,re=E.strstart,Te=E.prev_length,_e=E.nice_match,me=E.strstart>E.w_size-le?E.strstart-(E.w_size-le):0,Le=E.window,Oe=E.w_mask,Fe=E.prev,Ve=E.strstart+Z,at=Le[re+Te-1],et=Le[re+Te];E.prev_length>=E.good_match&&(H>>=2),_e>E.lookahead&&(_e=E.lookahead);do if(Le[(ce=fe)+Te]===et&&Le[ce+Te-1]===at&&Le[ce]===Le[re]&&Le[++ce]===Le[re+1]){re+=2,ce++;do;while(Le[++re]===Le[++ce]&&Le[++re]===Le[++ce]&&Le[++re]===Le[++ce]&&Le[++re]===Le[++ce]&&Le[++re]===Le[++ce]&&Le[++re]===Le[++ce]&&Le[++re]===Le[++ce]&&Le[++re]===Le[++ce]&&re<Ve);if(W=Z-(Ve-re),re=Ve-Z,Te<W){if(E.match_start=fe,_e<=(Te=W))break;at=Le[re+Te-1],et=Le[re+Te]}}while((fe=Fe[fe&Oe])>me&&--H!=0);return Te<=E.lookahead?Te:E.lookahead}function X(E){var fe,ce,W,H,re,Te,_e,me,Le,Oe,Fe=E.w_size;do{if(H=E.window_size-E.lookahead-E.strstart,E.strstart>=Fe+(Fe-le)){for(f.arraySet(E.window,E.window,Fe,Fe,0),E.match_start-=Fe,E.strstart-=Fe,E.block_start-=Fe,fe=ce=E.hash_size;W=E.head[--fe],E.head[fe]=Fe<=W?W-Fe:0,--ce;);for(fe=ce=Fe;W=E.prev[--fe],E.prev[fe]=Fe<=W?W-Fe:0,--ce;);H+=Fe}if(E.strm.avail_in===0)break;if(Te=E.strm,_e=E.window,me=E.strstart+E.lookahead,Le=H,Oe=void 0,Oe=Te.avail_in,Le<Oe&&(Oe=Le),ce=Oe===0?0:(Te.avail_in-=Oe,f.arraySet(_e,Te.input,Te.next_in,Oe,me),Te.state.wrap===1?Te.adler=h(Te.adler,_e,Oe,me):Te.state.wrap===2&&(Te.adler=p(Te.adler,_e,Oe,me)),Te.next_in+=Oe,Te.total_in+=Oe,Oe),E.lookahead+=ce,E.lookahead+E.insert>=J)for(re=E.strstart-E.insert,E.ins_h=E.window[re],E.ins_h=(E.ins_h<<E.hash_shift^E.window[re+1])&E.hash_mask;E.insert&&(E.ins_h=(E.ins_h<<E.hash_shift^E.window[re+J-1])&E.hash_mask,E.prev[re&E.w_mask]=E.head[E.ins_h],E.head[E.ins_h]=re,re++,E.insert--,!(E.lookahead+E.insert<J)););}while(E.lookahead<le&&E.strm.avail_in!==0)}function se(E,fe){for(var ce,W;;){if(E.lookahead<le){if(X(E),E.lookahead<le&&fe===x)return M;if(E.lookahead===0)break}if(ce=0,E.lookahead>=J&&(E.ins_h=(E.ins_h<<E.hash_shift^E.window[E.strstart+J-1])&E.hash_mask,ce=E.prev[E.strstart&E.w_mask]=E.head[E.ins_h],E.head[E.ins_h]=E.strstart),ce!==0&&E.strstart-ce<=E.w_size-le&&(E.match_length=K(E,ce)),E.match_length>=J)if(W=m._tr_tally(E,E.strstart-E.match_start,E.match_length-J),E.lookahead-=E.match_length,E.match_length<=E.max_lazy_match&&E.lookahead>=J){for(E.match_length--;E.strstart++,E.ins_h=(E.ins_h<<E.hash_shift^E.window[E.strstart+J-1])&E.hash_mask,ce=E.prev[E.strstart&E.w_mask]=E.head[E.ins_h],E.head[E.ins_h]=E.strstart,--E.match_length!=0;);E.strstart++}else E.strstart+=E.match_length,E.match_length=0,E.ins_h=E.window[E.strstart],E.ins_h=(E.ins_h<<E.hash_shift^E.window[E.strstart+1])&E.hash_mask;else W=m._tr_tally(E,0,E.window[E.strstart]),E.lookahead--,E.strstart++;if(W&&(j(E,!1),E.strm.avail_out===0))return M}return E.insert=E.strstart<J-1?E.strstart:J-1,fe===C?(j(E,!0),E.strm.avail_out===0?be:ve):E.last_lit&&(j(E,!1),E.strm.avail_out===0)?M:pe}function ae(E,fe){for(var ce,W,H;;){if(E.lookahead<le){if(X(E),E.lookahead<le&&fe===x)return M;if(E.lookahead===0)break}if(ce=0,E.lookahead>=J&&(E.ins_h=(E.ins_h<<E.hash_shift^E.window[E.strstart+J-1])&E.hash_mask,ce=E.prev[E.strstart&E.w_mask]=E.head[E.ins_h],E.head[E.ins_h]=E.strstart),E.prev_length=E.match_length,E.prev_match=E.match_start,E.match_length=J-1,ce!==0&&E.prev_length<E.max_lazy_match&&E.strstart-ce<=E.w_size-le&&(E.match_length=K(E,ce),E.match_length<=5&&(E.strategy===1||E.match_length===J&&4096<E.strstart-E.match_start)&&(E.match_length=J-1)),E.prev_length>=J&&E.match_length<=E.prev_length){for(H=E.strstart+E.lookahead-J,W=m._tr_tally(E,E.strstart-1-E.prev_match,E.prev_length-J),E.lookahead-=E.prev_length-1,E.prev_length-=2;++E.strstart<=H&&(E.ins_h=(E.ins_h<<E.hash_shift^E.window[E.strstart+J-1])&E.hash_mask,ce=E.prev[E.strstart&E.w_mask]=E.head[E.ins_h],E.head[E.ins_h]=E.strstart),--E.prev_length!=0;);if(E.match_available=0,E.match_length=J-1,E.strstart++,W&&(j(E,!1),E.strm.avail_out===0))return M}else if(E.match_available){if((W=m._tr_tally(E,0,E.window[E.strstart-1]))&&j(E,!1),E.strstart++,E.lookahead--,E.strm.avail_out===0)return M}else E.match_available=1,E.strstart++,E.lookahead--}return E.match_available&&(W=m._tr_tally(E,0,E.window[E.strstart-1]),E.match_available=0),E.insert=E.strstart<J-1?E.strstart:J-1,fe===C?(j(E,!0),E.strm.avail_out===0?be:ve):E.last_lit&&(j(E,!1),E.strm.avail_out===0)?M:pe}function ke(E,fe,ce,W,H){this.good_length=E,this.max_lazy=fe,this.nice_length=ce,this.max_chain=W,this.func=H}function Ae(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=F,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new f.Buf16(2*$),this.dyn_dtree=new f.Buf16(2*(2*P+1)),this.bl_tree=new f.Buf16(2*(2*G+1)),q(this.dyn_ltree),q(this.dyn_dtree),q(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new f.Buf16(oe+1),this.heap=new f.Buf16(2*R+1),q(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new f.Buf16(2*R+1),q(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function Ne(E){var fe;return E&&E.state?(E.total_in=E.total_out=0,E.data_type=D,(fe=E.state).pending=0,fe.pending_out=0,fe.wrap<0&&(fe.wrap=-fe.wrap),fe.status=fe.wrap?Q:Y,E.adler=fe.wrap===2?0:1,fe.last_flush=x,m._tr_init(fe),S):xe(E,b)}function je(E){var fe=Ne(E);return fe===S&&function(ce){ce.window_size=2*ce.w_size,q(ce.head),ce.max_lazy_match=c[ce.level].max_lazy,ce.good_match=c[ce.level].good_length,ce.nice_match=c[ce.level].nice_length,ce.max_chain_length=c[ce.level].max_chain,ce.strstart=0,ce.block_start=0,ce.lookahead=0,ce.insert=0,ce.match_length=ce.prev_length=J-1,ce.match_available=0,ce.ins_h=0}(E.state),fe}function De(E,fe,ce,W,H,re){if(!E)return b;var Te=1;if(fe===T&&(fe=6),W<0?(Te=0,W=-W):15<W&&(Te=2,W-=16),H<1||L<H||ce!==F||W<8||15<W||fe<0||9<fe||re<0||A<re)return xe(E,b);W===8&&(W=9);var _e=new Ae;return(E.state=_e).strm=E,_e.wrap=Te,_e.gzhead=null,_e.w_bits=W,_e.w_size=1<<_e.w_bits,_e.w_mask=_e.w_size-1,_e.hash_bits=H+7,_e.hash_size=1<<_e.hash_bits,_e.hash_mask=_e.hash_size-1,_e.hash_shift=~~((_e.hash_bits+J-1)/J),_e.window=new f.Buf8(2*_e.w_size),_e.head=new f.Buf16(_e.hash_size),_e.prev=new f.Buf16(_e.w_size),_e.lit_bufsize=1<<H+6,_e.pending_buf_size=4*_e.lit_bufsize,_e.pending_buf=new f.Buf8(_e.pending_buf_size),_e.d_buf=1*_e.lit_bufsize,_e.l_buf=3*_e.lit_bufsize,_e.level=fe,_e.strategy=re,_e.method=ce,je(E)}c=[new ke(0,0,0,0,function(E,fe){var ce=65535;for(ce>E.pending_buf_size-5&&(ce=E.pending_buf_size-5);;){if(E.lookahead<=1){if(X(E),E.lookahead===0&&fe===x)return M;if(E.lookahead===0)break}E.strstart+=E.lookahead,E.lookahead=0;var W=E.block_start+ce;if((E.strstart===0||E.strstart>=W)&&(E.lookahead=E.strstart-W,E.strstart=W,j(E,!1),E.strm.avail_out===0)||E.strstart-E.block_start>=E.w_size-le&&(j(E,!1),E.strm.avail_out===0))return M}return E.insert=0,fe===C?(j(E,!0),E.strm.avail_out===0?be:ve):(E.strstart>E.block_start&&(j(E,!1),E.strm.avail_out),M)}),new ke(4,4,8,4,se),new ke(4,5,16,8,se),new ke(4,6,32,32,se),new ke(4,4,16,16,ae),new ke(8,16,32,32,ae),new ke(8,16,128,128,ae),new ke(8,32,128,256,ae),new ke(32,128,258,1024,ae),new ke(32,258,258,4096,ae)],i.deflateInit=function(E,fe){return De(E,fe,F,15,8,0)},i.deflateInit2=De,i.deflateReset=je,i.deflateResetKeep=Ne,i.deflateSetHeader=function(E,fe){return E&&E.state?E.state.wrap!==2?b:(E.state.gzhead=fe,S):b},i.deflate=function(E,fe){var ce,W,H,re;if(!E||!E.state||5<fe||fe<0)return E?xe(E,b):b;if(W=E.state,!E.output||!E.input&&E.avail_in!==0||W.status===666&&fe!==C)return xe(E,E.avail_out===0?-5:b);if(W.strm=E,ce=W.last_flush,W.last_flush=fe,W.status===Q)if(W.wrap===2)E.adler=0,O(W,31),O(W,139),O(W,8),W.gzhead?(O(W,(W.gzhead.text?1:0)+(W.gzhead.hcrc?2:0)+(W.gzhead.extra?4:0)+(W.gzhead.name?8:0)+(W.gzhead.comment?16:0)),O(W,255&W.gzhead.time),O(W,W.gzhead.time>>8&255),O(W,W.gzhead.time>>16&255),O(W,W.gzhead.time>>24&255),O(W,W.level===9?2:2<=W.strategy||W.level<2?4:0),O(W,255&W.gzhead.os),W.gzhead.extra&&W.gzhead.extra.length&&(O(W,255&W.gzhead.extra.length),O(W,W.gzhead.extra.length>>8&255)),W.gzhead.hcrc&&(E.adler=p(E.adler,W.pending_buf,W.pending,0)),W.gzindex=0,W.status=69):(O(W,0),O(W,0),O(W,0),O(W,0),O(W,0),O(W,W.level===9?2:2<=W.strategy||W.level<2?4:0),O(W,3),W.status=Y);else{var Te=F+(W.w_bits-8<<4)<<8;Te|=(2<=W.strategy||W.level<2?0:W.level<6?1:W.level===6?2:3)<<6,W.strstart!==0&&(Te|=32),Te+=31-Te%31,W.status=Y,V(W,Te),W.strstart!==0&&(V(W,E.adler>>>16),V(W,65535&E.adler)),E.adler=1}if(W.status===69)if(W.gzhead.extra){for(H=W.pending;W.gzindex<(65535&W.gzhead.extra.length)&&(W.pending!==W.pending_buf_size||(W.gzhead.hcrc&&W.pending>H&&(E.adler=p(E.adler,W.pending_buf,W.pending-H,H)),N(E),H=W.pending,W.pending!==W.pending_buf_size));)O(W,255&W.gzhead.extra[W.gzindex]),W.gzindex++;W.gzhead.hcrc&&W.pending>H&&(E.adler=p(E.adler,W.pending_buf,W.pending-H,H)),W.gzindex===W.gzhead.extra.length&&(W.gzindex=0,W.status=73)}else W.status=73;if(W.status===73)if(W.gzhead.name){H=W.pending;do{if(W.pending===W.pending_buf_size&&(W.gzhead.hcrc&&W.pending>H&&(E.adler=p(E.adler,W.pending_buf,W.pending-H,H)),N(E),H=W.pending,W.pending===W.pending_buf_size)){re=1;break}re=W.gzindex<W.gzhead.name.length?255&W.gzhead.name.charCodeAt(W.gzindex++):0,O(W,re)}while(re!==0);W.gzhead.hcrc&&W.pending>H&&(E.adler=p(E.adler,W.pending_buf,W.pending-H,H)),re===0&&(W.gzindex=0,W.status=91)}else W.status=91;if(W.status===91)if(W.gzhead.comment){H=W.pending;do{if(W.pending===W.pending_buf_size&&(W.gzhead.hcrc&&W.pending>H&&(E.adler=p(E.adler,W.pending_buf,W.pending-H,H)),N(E),H=W.pending,W.pending===W.pending_buf_size)){re=1;break}re=W.gzindex<W.gzhead.comment.length?255&W.gzhead.comment.charCodeAt(W.gzindex++):0,O(W,re)}while(re!==0);W.gzhead.hcrc&&W.pending>H&&(E.adler=p(E.adler,W.pending_buf,W.pending-H,H)),re===0&&(W.status=103)}else W.status=103;if(W.status===103&&(W.gzhead.hcrc?(W.pending+2>W.pending_buf_size&&N(E),W.pending+2<=W.pending_buf_size&&(O(W,255&E.adler),O(W,E.adler>>8&255),E.adler=0,W.status=Y)):W.status=Y),W.pending!==0){if(N(E),E.avail_out===0)return W.last_flush=-1,S}else if(E.avail_in===0&&te(fe)<=te(ce)&&fe!==C)return xe(E,-5);if(W.status===666&&E.avail_in!==0)return xe(E,-5);if(E.avail_in!==0||W.lookahead!==0||fe!==x&&W.status!==666){var _e=W.strategy===2?function(me,Le){for(var Oe;;){if(me.lookahead===0&&(X(me),me.lookahead===0)){if(Le===x)return M;break}if(me.match_length=0,Oe=m._tr_tally(me,0,me.window[me.strstart]),me.lookahead--,me.strstart++,Oe&&(j(me,!1),me.strm.avail_out===0))return M}return me.insert=0,Le===C?(j(me,!0),me.strm.avail_out===0?be:ve):me.last_lit&&(j(me,!1),me.strm.avail_out===0)?M:pe}(W,fe):W.strategy===3?function(me,Le){for(var Oe,Fe,Ve,at,et=me.window;;){if(me.lookahead<=Z){if(X(me),me.lookahead<=Z&&Le===x)return M;if(me.lookahead===0)break}if(me.match_length=0,me.lookahead>=J&&0<me.strstart&&(Fe=et[Ve=me.strstart-1])===et[++Ve]&&Fe===et[++Ve]&&Fe===et[++Ve]){at=me.strstart+Z;do;while(Fe===et[++Ve]&&Fe===et[++Ve]&&Fe===et[++Ve]&&Fe===et[++Ve]&&Fe===et[++Ve]&&Fe===et[++Ve]&&Fe===et[++Ve]&&Fe===et[++Ve]&&Ve<at);me.match_length=Z-(at-Ve),me.match_length>me.lookahead&&(me.match_length=me.lookahead)}if(me.match_length>=J?(Oe=m._tr_tally(me,1,me.match_length-J),me.lookahead-=me.match_length,me.strstart+=me.match_length,me.match_length=0):(Oe=m._tr_tally(me,0,me.window[me.strstart]),me.lookahead--,me.strstart++),Oe&&(j(me,!1),me.strm.avail_out===0))return M}return me.insert=0,Le===C?(j(me,!0),me.strm.avail_out===0?be:ve):me.last_lit&&(j(me,!1),me.strm.avail_out===0)?M:pe}(W,fe):c[W.level].func(W,fe);if(_e!==be&&_e!==ve||(W.status=666),_e===M||_e===be)return E.avail_out===0&&(W.last_flush=-1),S;if(_e===pe&&(fe===1?m._tr_align(W):fe!==5&&(m._tr_stored_block(W,0,0,!1),fe===3&&(q(W.head),W.lookahead===0&&(W.strstart=0,W.block_start=0,W.insert=0))),N(E),E.avail_out===0))return W.last_flush=-1,S}return fe!==C?S:W.wrap<=0?1:(W.wrap===2?(O(W,255&E.adler),O(W,E.adler>>8&255),O(W,E.adler>>16&255),O(W,E.adler>>24&255),O(W,255&E.total_in),O(W,E.total_in>>8&255),O(W,E.total_in>>16&255),O(W,E.total_in>>24&255)):(V(W,E.adler>>>16),V(W,65535&E.adler)),N(E),0<W.wrap&&(W.wrap=-W.wrap),W.pending!==0?S:1)},i.deflateEnd=function(E){var fe;return E&&E.state?(fe=E.state.status)!==Q&&fe!==69&&fe!==73&&fe!==91&&fe!==103&&fe!==Y&&fe!==666?xe(E,b):(E.state=null,fe===Y?xe(E,-3):S):b},i.deflateSetDictionary=function(E,fe){var ce,W,H,re,Te,_e,me,Le,Oe=fe.length;if(!E||!E.state||(re=(ce=E.state).wrap)===2||re===1&&ce.status!==Q||ce.lookahead)return b;for(re===1&&(E.adler=h(E.adler,fe,Oe,0)),ce.wrap=0,Oe>=ce.w_size&&(re===0&&(q(ce.head),ce.strstart=0,ce.block_start=0,ce.insert=0),Le=new f.Buf8(ce.w_size),f.arraySet(Le,fe,Oe-ce.w_size,ce.w_size,0),fe=Le,Oe=ce.w_size),Te=E.avail_in,_e=E.next_in,me=E.input,E.avail_in=Oe,E.next_in=0,E.input=fe,X(ce);ce.lookahead>=J;){for(W=ce.strstart,H=ce.lookahead-(J-1);ce.ins_h=(ce.ins_h<<ce.hash_shift^ce.window[W+J-1])&ce.hash_mask,ce.prev[W&ce.w_mask]=ce.head[ce.ins_h],ce.head[ce.ins_h]=W,W++,--H;);ce.strstart=W,ce.lookahead=J-1,X(ce)}return ce.strstart+=ce.lookahead,ce.block_start=ce.strstart,ce.insert=ce.lookahead,ce.lookahead=0,ce.match_length=ce.prev_length=J-1,ce.match_available=0,E.next_in=_e,E.input=me,E.avail_in=Te,ce.wrap=re,S},i.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(n,o,i){o.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(n,o,i){o.exports=function(c,f){var m,h,p,v,x,C,S,b,T,A,D,F,L,R,P,G,$,oe,J,Z,le,Q,Y,M,pe;m=c.state,h=c.next_in,M=c.input,p=h+(c.avail_in-5),v=c.next_out,pe=c.output,x=v-(f-c.avail_out),C=v+(c.avail_out-257),S=m.dmax,b=m.wsize,T=m.whave,A=m.wnext,D=m.window,F=m.hold,L=m.bits,R=m.lencode,P=m.distcode,G=(1<<m.lenbits)-1,$=(1<<m.distbits)-1;e:do{L<15&&(F+=M[h++]<<L,L+=8,F+=M[h++]<<L,L+=8),oe=R[F&G];t:for(;;){if(F>>>=J=oe>>>24,L-=J,(J=oe>>>16&255)===0)pe[v++]=65535&oe;else{if(!(16&J)){if((64&J)==0){oe=R[(65535&oe)+(F&(1<<J)-1)];continue t}if(32&J){m.mode=12;break e}c.msg="invalid literal/length code",m.mode=30;break e}Z=65535&oe,(J&=15)&&(L<J&&(F+=M[h++]<<L,L+=8),Z+=F&(1<<J)-1,F>>>=J,L-=J),L<15&&(F+=M[h++]<<L,L+=8,F+=M[h++]<<L,L+=8),oe=P[F&$];n:for(;;){if(F>>>=J=oe>>>24,L-=J,!(16&(J=oe>>>16&255))){if((64&J)==0){oe=P[(65535&oe)+(F&(1<<J)-1)];continue n}c.msg="invalid distance code",m.mode=30;break e}if(le=65535&oe,L<(J&=15)&&(F+=M[h++]<<L,(L+=8)<J&&(F+=M[h++]<<L,L+=8)),S<(le+=F&(1<<J)-1)){c.msg="invalid distance too far back",m.mode=30;break e}if(F>>>=J,L-=J,(J=v-x)<le){if(T<(J=le-J)&&m.sane){c.msg="invalid distance too far back",m.mode=30;break e}if(Y=D,(Q=0)===A){if(Q+=b-J,J<Z){for(Z-=J;pe[v++]=D[Q++],--J;);Q=v-le,Y=pe}}else if(A<J){if(Q+=b+A-J,(J-=A)<Z){for(Z-=J;pe[v++]=D[Q++],--J;);if(Q=0,A<Z){for(Z-=J=A;pe[v++]=D[Q++],--J;);Q=v-le,Y=pe}}}else if(Q+=A-J,J<Z){for(Z-=J;pe[v++]=D[Q++],--J;);Q=v-le,Y=pe}for(;2<Z;)pe[v++]=Y[Q++],pe[v++]=Y[Q++],pe[v++]=Y[Q++],Z-=3;Z&&(pe[v++]=Y[Q++],1<Z&&(pe[v++]=Y[Q++]))}else{for(Q=v-le;pe[v++]=pe[Q++],pe[v++]=pe[Q++],pe[v++]=pe[Q++],2<(Z-=3););Z&&(pe[v++]=pe[Q++],1<Z&&(pe[v++]=pe[Q++]))}break}}break}}while(h<p&&v<C);h-=Z=L>>3,F&=(1<<(L-=Z<<3))-1,c.next_in=h,c.next_out=v,c.avail_in=h<p?p-h+5:5-(h-p),c.avail_out=v<C?C-v+257:257-(v-C),m.hold=F,m.bits=L}},{}],49:[function(n,o,i){var c=n("../utils/common"),f=n("./adler32"),m=n("./crc32"),h=n("./inffast"),p=n("./inftrees"),v=1,x=2,C=0,S=-2,b=1,T=852,A=592;function D(Q){return(Q>>>24&255)+(Q>>>8&65280)+((65280&Q)<<8)+((255&Q)<<24)}function F(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new c.Buf16(320),this.work=new c.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function L(Q){var Y;return Q&&Q.state?(Y=Q.state,Q.total_in=Q.total_out=Y.total=0,Q.msg="",Y.wrap&&(Q.adler=1&Y.wrap),Y.mode=b,Y.last=0,Y.havedict=0,Y.dmax=32768,Y.head=null,Y.hold=0,Y.bits=0,Y.lencode=Y.lendyn=new c.Buf32(T),Y.distcode=Y.distdyn=new c.Buf32(A),Y.sane=1,Y.back=-1,C):S}function R(Q){var Y;return Q&&Q.state?((Y=Q.state).wsize=0,Y.whave=0,Y.wnext=0,L(Q)):S}function P(Q,Y){var M,pe;return Q&&Q.state?(pe=Q.state,Y<0?(M=0,Y=-Y):(M=1+(Y>>4),Y<48&&(Y&=15)),Y&&(Y<8||15<Y)?S:(pe.window!==null&&pe.wbits!==Y&&(pe.window=null),pe.wrap=M,pe.wbits=Y,R(Q))):S}function G(Q,Y){var M,pe;return Q?(pe=new F,(Q.state=pe).window=null,(M=P(Q,Y))!==C&&(Q.state=null),M):S}var $,oe,J=!0;function Z(Q){if(J){var Y;for($=new c.Buf32(512),oe=new c.Buf32(32),Y=0;Y<144;)Q.lens[Y++]=8;for(;Y<256;)Q.lens[Y++]=9;for(;Y<280;)Q.lens[Y++]=7;for(;Y<288;)Q.lens[Y++]=8;for(p(v,Q.lens,0,288,$,0,Q.work,{bits:9}),Y=0;Y<32;)Q.lens[Y++]=5;p(x,Q.lens,0,32,oe,0,Q.work,{bits:5}),J=!1}Q.lencode=$,Q.lenbits=9,Q.distcode=oe,Q.distbits=5}function le(Q,Y,M,pe){var be,ve=Q.state;return ve.window===null&&(ve.wsize=1<<ve.wbits,ve.wnext=0,ve.whave=0,ve.window=new c.Buf8(ve.wsize)),pe>=ve.wsize?(c.arraySet(ve.window,Y,M-ve.wsize,ve.wsize,0),ve.wnext=0,ve.whave=ve.wsize):(pe<(be=ve.wsize-ve.wnext)&&(be=pe),c.arraySet(ve.window,Y,M-pe,be,ve.wnext),(pe-=be)?(c.arraySet(ve.window,Y,M-pe,pe,0),ve.wnext=pe,ve.whave=ve.wsize):(ve.wnext+=be,ve.wnext===ve.wsize&&(ve.wnext=0),ve.whave<ve.wsize&&(ve.whave+=be))),0}i.inflateReset=R,i.inflateReset2=P,i.inflateResetKeep=L,i.inflateInit=function(Q){return G(Q,15)},i.inflateInit2=G,i.inflate=function(Q,Y){var M,pe,be,ve,xe,te,q,N,j,O,V,K,X,se,ae,ke,Ae,Ne,je,De,E,fe,ce,W,H=0,re=new c.Buf8(4),Te=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!Q||!Q.state||!Q.output||!Q.input&&Q.avail_in!==0)return S;(M=Q.state).mode===12&&(M.mode=13),xe=Q.next_out,be=Q.output,q=Q.avail_out,ve=Q.next_in,pe=Q.input,te=Q.avail_in,N=M.hold,j=M.bits,O=te,V=q,fe=C;e:for(;;)switch(M.mode){case b:if(M.wrap===0){M.mode=13;break}for(;j<16;){if(te===0)break e;te--,N+=pe[ve++]<<j,j+=8}if(2&M.wrap&&N===35615){re[M.check=0]=255&N,re[1]=N>>>8&255,M.check=m(M.check,re,2,0),j=N=0,M.mode=2;break}if(M.flags=0,M.head&&(M.head.done=!1),!(1&M.wrap)||(((255&N)<<8)+(N>>8))%31){Q.msg="incorrect header check",M.mode=30;break}if((15&N)!=8){Q.msg="unknown compression method",M.mode=30;break}if(j-=4,E=8+(15&(N>>>=4)),M.wbits===0)M.wbits=E;else if(E>M.wbits){Q.msg="invalid window size",M.mode=30;break}M.dmax=1<<E,Q.adler=M.check=1,M.mode=512&N?10:12,j=N=0;break;case 2:for(;j<16;){if(te===0)break e;te--,N+=pe[ve++]<<j,j+=8}if(M.flags=N,(255&M.flags)!=8){Q.msg="unknown compression method",M.mode=30;break}if(57344&M.flags){Q.msg="unknown header flags set",M.mode=30;break}M.head&&(M.head.text=N>>8&1),512&M.flags&&(re[0]=255&N,re[1]=N>>>8&255,M.check=m(M.check,re,2,0)),j=N=0,M.mode=3;case 3:for(;j<32;){if(te===0)break e;te--,N+=pe[ve++]<<j,j+=8}M.head&&(M.head.time=N),512&M.flags&&(re[0]=255&N,re[1]=N>>>8&255,re[2]=N>>>16&255,re[3]=N>>>24&255,M.check=m(M.check,re,4,0)),j=N=0,M.mode=4;case 4:for(;j<16;){if(te===0)break e;te--,N+=pe[ve++]<<j,j+=8}M.head&&(M.head.xflags=255&N,M.head.os=N>>8),512&M.flags&&(re[0]=255&N,re[1]=N>>>8&255,M.check=m(M.check,re,2,0)),j=N=0,M.mode=5;case 5:if(1024&M.flags){for(;j<16;){if(te===0)break e;te--,N+=pe[ve++]<<j,j+=8}M.length=N,M.head&&(M.head.extra_len=N),512&M.flags&&(re[0]=255&N,re[1]=N>>>8&255,M.check=m(M.check,re,2,0)),j=N=0}else M.head&&(M.head.extra=null);M.mode=6;case 6:if(1024&M.flags&&(te<(K=M.length)&&(K=te),K&&(M.head&&(E=M.head.extra_len-M.length,M.head.extra||(M.head.extra=new Array(M.head.extra_len)),c.arraySet(M.head.extra,pe,ve,K,E)),512&M.flags&&(M.check=m(M.check,pe,K,ve)),te-=K,ve+=K,M.length-=K),M.length))break e;M.length=0,M.mode=7;case 7:if(2048&M.flags){if(te===0)break e;for(K=0;E=pe[ve+K++],M.head&&E&&M.length<65536&&(M.head.name+=String.fromCharCode(E)),E&&K<te;);if(512&M.flags&&(M.check=m(M.check,pe,K,ve)),te-=K,ve+=K,E)break e}else M.head&&(M.head.name=null);M.length=0,M.mode=8;case 8:if(4096&M.flags){if(te===0)break e;for(K=0;E=pe[ve+K++],M.head&&E&&M.length<65536&&(M.head.comment+=String.fromCharCode(E)),E&&K<te;);if(512&M.flags&&(M.check=m(M.check,pe,K,ve)),te-=K,ve+=K,E)break e}else M.head&&(M.head.comment=null);M.mode=9;case 9:if(512&M.flags){for(;j<16;){if(te===0)break e;te--,N+=pe[ve++]<<j,j+=8}if(N!==(65535&M.check)){Q.msg="header crc mismatch",M.mode=30;break}j=N=0}M.head&&(M.head.hcrc=M.flags>>9&1,M.head.done=!0),Q.adler=M.check=0,M.mode=12;break;case 10:for(;j<32;){if(te===0)break e;te--,N+=pe[ve++]<<j,j+=8}Q.adler=M.check=D(N),j=N=0,M.mode=11;case 11:if(M.havedict===0)return Q.next_out=xe,Q.avail_out=q,Q.next_in=ve,Q.avail_in=te,M.hold=N,M.bits=j,2;Q.adler=M.check=1,M.mode=12;case 12:if(Y===5||Y===6)break e;case 13:if(M.last){N>>>=7&j,j-=7&j,M.mode=27;break}for(;j<3;){if(te===0)break e;te--,N+=pe[ve++]<<j,j+=8}switch(M.last=1&N,j-=1,3&(N>>>=1)){case 0:M.mode=14;break;case 1:if(Z(M),M.mode=20,Y!==6)break;N>>>=2,j-=2;break e;case 2:M.mode=17;break;case 3:Q.msg="invalid block type",M.mode=30}N>>>=2,j-=2;break;case 14:for(N>>>=7&j,j-=7&j;j<32;){if(te===0)break e;te--,N+=pe[ve++]<<j,j+=8}if((65535&N)!=(N>>>16^65535)){Q.msg="invalid stored block lengths",M.mode=30;break}if(M.length=65535&N,j=N=0,M.mode=15,Y===6)break e;case 15:M.mode=16;case 16:if(K=M.length){if(te<K&&(K=te),q<K&&(K=q),K===0)break e;c.arraySet(be,pe,ve,K,xe),te-=K,ve+=K,q-=K,xe+=K,M.length-=K;break}M.mode=12;break;case 17:for(;j<14;){if(te===0)break e;te--,N+=pe[ve++]<<j,j+=8}if(M.nlen=257+(31&N),N>>>=5,j-=5,M.ndist=1+(31&N),N>>>=5,j-=5,M.ncode=4+(15&N),N>>>=4,j-=4,286<M.nlen||30<M.ndist){Q.msg="too many length or distance symbols",M.mode=30;break}M.have=0,M.mode=18;case 18:for(;M.have<M.ncode;){for(;j<3;){if(te===0)break e;te--,N+=pe[ve++]<<j,j+=8}M.lens[Te[M.have++]]=7&N,N>>>=3,j-=3}for(;M.have<19;)M.lens[Te[M.have++]]=0;if(M.lencode=M.lendyn,M.lenbits=7,ce={bits:M.lenbits},fe=p(0,M.lens,0,19,M.lencode,0,M.work,ce),M.lenbits=ce.bits,fe){Q.msg="invalid code lengths set",M.mode=30;break}M.have=0,M.mode=19;case 19:for(;M.have<M.nlen+M.ndist;){for(;ke=(H=M.lencode[N&(1<<M.lenbits)-1])>>>16&255,Ae=65535&H,!((ae=H>>>24)<=j);){if(te===0)break e;te--,N+=pe[ve++]<<j,j+=8}if(Ae<16)N>>>=ae,j-=ae,M.lens[M.have++]=Ae;else{if(Ae===16){for(W=ae+2;j<W;){if(te===0)break e;te--,N+=pe[ve++]<<j,j+=8}if(N>>>=ae,j-=ae,M.have===0){Q.msg="invalid bit length repeat",M.mode=30;break}E=M.lens[M.have-1],K=3+(3&N),N>>>=2,j-=2}else if(Ae===17){for(W=ae+3;j<W;){if(te===0)break e;te--,N+=pe[ve++]<<j,j+=8}j-=ae,E=0,K=3+(7&(N>>>=ae)),N>>>=3,j-=3}else{for(W=ae+7;j<W;){if(te===0)break e;te--,N+=pe[ve++]<<j,j+=8}j-=ae,E=0,K=11+(127&(N>>>=ae)),N>>>=7,j-=7}if(M.have+K>M.nlen+M.ndist){Q.msg="invalid bit length repeat",M.mode=30;break}for(;K--;)M.lens[M.have++]=E}}if(M.mode===30)break;if(M.lens[256]===0){Q.msg="invalid code -- missing end-of-block",M.mode=30;break}if(M.lenbits=9,ce={bits:M.lenbits},fe=p(v,M.lens,0,M.nlen,M.lencode,0,M.work,ce),M.lenbits=ce.bits,fe){Q.msg="invalid literal/lengths set",M.mode=30;break}if(M.distbits=6,M.distcode=M.distdyn,ce={bits:M.distbits},fe=p(x,M.lens,M.nlen,M.ndist,M.distcode,0,M.work,ce),M.distbits=ce.bits,fe){Q.msg="invalid distances set",M.mode=30;break}if(M.mode=20,Y===6)break e;case 20:M.mode=21;case 21:if(6<=te&&258<=q){Q.next_out=xe,Q.avail_out=q,Q.next_in=ve,Q.avail_in=te,M.hold=N,M.bits=j,h(Q,V),xe=Q.next_out,be=Q.output,q=Q.avail_out,ve=Q.next_in,pe=Q.input,te=Q.avail_in,N=M.hold,j=M.bits,M.mode===12&&(M.back=-1);break}for(M.back=0;ke=(H=M.lencode[N&(1<<M.lenbits)-1])>>>16&255,Ae=65535&H,!((ae=H>>>24)<=j);){if(te===0)break e;te--,N+=pe[ve++]<<j,j+=8}if(ke&&(240&ke)==0){for(Ne=ae,je=ke,De=Ae;ke=(H=M.lencode[De+((N&(1<<Ne+je)-1)>>Ne)])>>>16&255,Ae=65535&H,!(Ne+(ae=H>>>24)<=j);){if(te===0)break e;te--,N+=pe[ve++]<<j,j+=8}N>>>=Ne,j-=Ne,M.back+=Ne}if(N>>>=ae,j-=ae,M.back+=ae,M.length=Ae,ke===0){M.mode=26;break}if(32&ke){M.back=-1,M.mode=12;break}if(64&ke){Q.msg="invalid literal/length code",M.mode=30;break}M.extra=15&ke,M.mode=22;case 22:if(M.extra){for(W=M.extra;j<W;){if(te===0)break e;te--,N+=pe[ve++]<<j,j+=8}M.length+=N&(1<<M.extra)-1,N>>>=M.extra,j-=M.extra,M.back+=M.extra}M.was=M.length,M.mode=23;case 23:for(;ke=(H=M.distcode[N&(1<<M.distbits)-1])>>>16&255,Ae=65535&H,!((ae=H>>>24)<=j);){if(te===0)break e;te--,N+=pe[ve++]<<j,j+=8}if((240&ke)==0){for(Ne=ae,je=ke,De=Ae;ke=(H=M.distcode[De+((N&(1<<Ne+je)-1)>>Ne)])>>>16&255,Ae=65535&H,!(Ne+(ae=H>>>24)<=j);){if(te===0)break e;te--,N+=pe[ve++]<<j,j+=8}N>>>=Ne,j-=Ne,M.back+=Ne}if(N>>>=ae,j-=ae,M.back+=ae,64&ke){Q.msg="invalid distance code",M.mode=30;break}M.offset=Ae,M.extra=15&ke,M.mode=24;case 24:if(M.extra){for(W=M.extra;j<W;){if(te===0)break e;te--,N+=pe[ve++]<<j,j+=8}M.offset+=N&(1<<M.extra)-1,N>>>=M.extra,j-=M.extra,M.back+=M.extra}if(M.offset>M.dmax){Q.msg="invalid distance too far back",M.mode=30;break}M.mode=25;case 25:if(q===0)break e;if(K=V-q,M.offset>K){if((K=M.offset-K)>M.whave&&M.sane){Q.msg="invalid distance too far back",M.mode=30;break}X=K>M.wnext?(K-=M.wnext,M.wsize-K):M.wnext-K,K>M.length&&(K=M.length),se=M.window}else se=be,X=xe-M.offset,K=M.length;for(q<K&&(K=q),q-=K,M.length-=K;be[xe++]=se[X++],--K;);M.length===0&&(M.mode=21);break;case 26:if(q===0)break e;be[xe++]=M.length,q--,M.mode=21;break;case 27:if(M.wrap){for(;j<32;){if(te===0)break e;te--,N|=pe[ve++]<<j,j+=8}if(V-=q,Q.total_out+=V,M.total+=V,V&&(Q.adler=M.check=M.flags?m(M.check,be,V,xe-V):f(M.check,be,V,xe-V)),V=q,(M.flags?N:D(N))!==M.check){Q.msg="incorrect data check",M.mode=30;break}j=N=0}M.mode=28;case 28:if(M.wrap&&M.flags){for(;j<32;){if(te===0)break e;te--,N+=pe[ve++]<<j,j+=8}if(N!==(4294967295&M.total)){Q.msg="incorrect length check",M.mode=30;break}j=N=0}M.mode=29;case 29:fe=1;break e;case 30:fe=-3;break e;case 31:return-4;case 32:default:return S}return Q.next_out=xe,Q.avail_out=q,Q.next_in=ve,Q.avail_in=te,M.hold=N,M.bits=j,(M.wsize||V!==Q.avail_out&&M.mode<30&&(M.mode<27||Y!==4))&&le(Q,Q.output,Q.next_out,V-Q.avail_out)?(M.mode=31,-4):(O-=Q.avail_in,V-=Q.avail_out,Q.total_in+=O,Q.total_out+=V,M.total+=V,M.wrap&&V&&(Q.adler=M.check=M.flags?m(M.check,be,V,Q.next_out-V):f(M.check,be,V,Q.next_out-V)),Q.data_type=M.bits+(M.last?64:0)+(M.mode===12?128:0)+(M.mode===20||M.mode===15?256:0),(O==0&&V===0||Y===4)&&fe===C&&(fe=-5),fe)},i.inflateEnd=function(Q){if(!Q||!Q.state)return S;var Y=Q.state;return Y.window&&(Y.window=null),Q.state=null,C},i.inflateGetHeader=function(Q,Y){var M;return Q&&Q.state?(2&(M=Q.state).wrap)==0?S:((M.head=Y).done=!1,C):S},i.inflateSetDictionary=function(Q,Y){var M,pe=Y.length;return Q&&Q.state?(M=Q.state).wrap!==0&&M.mode!==11?S:M.mode===11&&f(1,Y,pe,0)!==M.check?-3:le(Q,Y,pe,pe)?(M.mode=31,-4):(M.havedict=1,C):S},i.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(n,o,i){var c=n("../utils/common"),f=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],m=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],h=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],p=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];o.exports=function(v,x,C,S,b,T,A,D){var F,L,R,P,G,$,oe,J,Z,le=D.bits,Q=0,Y=0,M=0,pe=0,be=0,ve=0,xe=0,te=0,q=0,N=0,j=null,O=0,V=new c.Buf16(16),K=new c.Buf16(16),X=null,se=0;for(Q=0;Q<=15;Q++)V[Q]=0;for(Y=0;Y<S;Y++)V[x[C+Y]]++;for(be=le,pe=15;1<=pe&&V[pe]===0;pe--);if(pe<be&&(be=pe),pe===0)return b[T++]=20971520,b[T++]=20971520,D.bits=1,0;for(M=1;M<pe&&V[M]===0;M++);for(be<M&&(be=M),Q=te=1;Q<=15;Q++)if(te<<=1,(te-=V[Q])<0)return-1;if(0<te&&(v===0||pe!==1))return-1;for(K[1]=0,Q=1;Q<15;Q++)K[Q+1]=K[Q]+V[Q];for(Y=0;Y<S;Y++)x[C+Y]!==0&&(A[K[x[C+Y]]++]=Y);if($=v===0?(j=X=A,19):v===1?(j=f,O-=257,X=m,se-=257,256):(j=h,X=p,-1),Q=M,G=T,xe=Y=N=0,R=-1,P=(q=1<<(ve=be))-1,v===1&&852<q||v===2&&592<q)return 1;for(;;){for(oe=Q-xe,Z=A[Y]<$?(J=0,A[Y]):A[Y]>$?(J=X[se+A[Y]],j[O+A[Y]]):(J=96,0),F=1<<Q-xe,M=L=1<<ve;b[G+(N>>xe)+(L-=F)]=oe<<24|J<<16|Z|0,L!==0;);for(F=1<<Q-1;N&F;)F>>=1;if(F!==0?(N&=F-1,N+=F):N=0,Y++,--V[Q]==0){if(Q===pe)break;Q=x[C+A[Y]]}if(be<Q&&(N&P)!==R){for(xe===0&&(xe=be),G+=M,te=1<<(ve=Q-xe);ve+xe<pe&&!((te-=V[ve+xe])<=0);)ve++,te<<=1;if(q+=1<<ve,v===1&&852<q||v===2&&592<q)return 1;b[R=N&P]=be<<24|ve<<16|G-T|0}}return N!==0&&(b[G+N]=Q-xe<<24|64<<16|0),D.bits=be,0}},{"../utils/common":41}],51:[function(n,o,i){o.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(n,o,i){var c=n("../utils/common"),f=0,m=1;function h(H){for(var re=H.length;0<=--re;)H[re]=0}var p=0,v=29,x=256,C=x+1+v,S=30,b=19,T=2*C+1,A=15,D=16,F=7,L=256,R=16,P=17,G=18,$=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],oe=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],J=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],Z=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],le=new Array(2*(C+2));h(le);var Q=new Array(2*S);h(Q);var Y=new Array(512);h(Y);var M=new Array(256);h(M);var pe=new Array(v);h(pe);var be,ve,xe,te=new Array(S);function q(H,re,Te,_e,me){this.static_tree=H,this.extra_bits=re,this.extra_base=Te,this.elems=_e,this.max_length=me,this.has_stree=H&&H.length}function N(H,re){this.dyn_tree=H,this.max_code=0,this.stat_desc=re}function j(H){return H<256?Y[H]:Y[256+(H>>>7)]}function O(H,re){H.pending_buf[H.pending++]=255&re,H.pending_buf[H.pending++]=re>>>8&255}function V(H,re,Te){H.bi_valid>D-Te?(H.bi_buf|=re<<H.bi_valid&65535,O(H,H.bi_buf),H.bi_buf=re>>D-H.bi_valid,H.bi_valid+=Te-D):(H.bi_buf|=re<<H.bi_valid&65535,H.bi_valid+=Te)}function K(H,re,Te){V(H,Te[2*re],Te[2*re+1])}function X(H,re){for(var Te=0;Te|=1&H,H>>>=1,Te<<=1,0<--re;);return Te>>>1}function se(H,re,Te){var _e,me,Le=new Array(A+1),Oe=0;for(_e=1;_e<=A;_e++)Le[_e]=Oe=Oe+Te[_e-1]<<1;for(me=0;me<=re;me++){var Fe=H[2*me+1];Fe!==0&&(H[2*me]=X(Le[Fe]++,Fe))}}function ae(H){var re;for(re=0;re<C;re++)H.dyn_ltree[2*re]=0;for(re=0;re<S;re++)H.dyn_dtree[2*re]=0;for(re=0;re<b;re++)H.bl_tree[2*re]=0;H.dyn_ltree[2*L]=1,H.opt_len=H.static_len=0,H.last_lit=H.matches=0}function ke(H){8<H.bi_valid?O(H,H.bi_buf):0<H.bi_valid&&(H.pending_buf[H.pending++]=H.bi_buf),H.bi_buf=0,H.bi_valid=0}function Ae(H,re,Te,_e){var me=2*re,Le=2*Te;return H[me]<H[Le]||H[me]===H[Le]&&_e[re]<=_e[Te]}function Ne(H,re,Te){for(var _e=H.heap[Te],me=Te<<1;me<=H.heap_len&&(me<H.heap_len&&Ae(re,H.heap[me+1],H.heap[me],H.depth)&&me++,!Ae(re,_e,H.heap[me],H.depth));)H.heap[Te]=H.heap[me],Te=me,me<<=1;H.heap[Te]=_e}function je(H,re,Te){var _e,me,Le,Oe,Fe=0;if(H.last_lit!==0)for(;_e=H.pending_buf[H.d_buf+2*Fe]<<8|H.pending_buf[H.d_buf+2*Fe+1],me=H.pending_buf[H.l_buf+Fe],Fe++,_e===0?K(H,me,re):(K(H,(Le=M[me])+x+1,re),(Oe=$[Le])!==0&&V(H,me-=pe[Le],Oe),K(H,Le=j(--_e),Te),(Oe=oe[Le])!==0&&V(H,_e-=te[Le],Oe)),Fe<H.last_lit;);K(H,L,re)}function De(H,re){var Te,_e,me,Le=re.dyn_tree,Oe=re.stat_desc.static_tree,Fe=re.stat_desc.has_stree,Ve=re.stat_desc.elems,at=-1;for(H.heap_len=0,H.heap_max=T,Te=0;Te<Ve;Te++)Le[2*Te]!==0?(H.heap[++H.heap_len]=at=Te,H.depth[Te]=0):Le[2*Te+1]=0;for(;H.heap_len<2;)Le[2*(me=H.heap[++H.heap_len]=at<2?++at:0)]=1,H.depth[me]=0,H.opt_len--,Fe&&(H.static_len-=Oe[2*me+1]);for(re.max_code=at,Te=H.heap_len>>1;1<=Te;Te--)Ne(H,Le,Te);for(me=Ve;Te=H.heap[1],H.heap[1]=H.heap[H.heap_len--],Ne(H,Le,1),_e=H.heap[1],H.heap[--H.heap_max]=Te,H.heap[--H.heap_max]=_e,Le[2*me]=Le[2*Te]+Le[2*_e],H.depth[me]=(H.depth[Te]>=H.depth[_e]?H.depth[Te]:H.depth[_e])+1,Le[2*Te+1]=Le[2*_e+1]=me,H.heap[1]=me++,Ne(H,Le,1),2<=H.heap_len;);H.heap[--H.heap_max]=H.heap[1],function(et,Nt){var kt,pt,Qt,Ct,jn,wr,Gt=Nt.dyn_tree,qn=Nt.max_code,ot=Nt.stat_desc.static_tree,ir=Nt.stat_desc.has_stree,yn=Nt.stat_desc.extra_bits,Kt=Nt.stat_desc.extra_base,$t=Nt.stat_desc.max_length,Yn=0;for(Ct=0;Ct<=A;Ct++)et.bl_count[Ct]=0;for(Gt[2*et.heap[et.heap_max]+1]=0,kt=et.heap_max+1;kt<T;kt++)$t<(Ct=Gt[2*Gt[2*(pt=et.heap[kt])+1]+1]+1)&&(Ct=$t,Yn++),Gt[2*pt+1]=Ct,qn<pt||(et.bl_count[Ct]++,jn=0,Kt<=pt&&(jn=yn[pt-Kt]),wr=Gt[2*pt],et.opt_len+=wr*(Ct+jn),ir&&(et.static_len+=wr*(ot[2*pt+1]+jn)));if(Yn!==0){do{for(Ct=$t-1;et.bl_count[Ct]===0;)Ct--;et.bl_count[Ct]--,et.bl_count[Ct+1]+=2,et.bl_count[$t]--,Yn-=2}while(0<Yn);for(Ct=$t;Ct!==0;Ct--)for(pt=et.bl_count[Ct];pt!==0;)qn<(Qt=et.heap[--kt])||(Gt[2*Qt+1]!==Ct&&(et.opt_len+=(Ct-Gt[2*Qt+1])*Gt[2*Qt],Gt[2*Qt+1]=Ct),pt--)}}(H,re),se(Le,at,H.bl_count)}function E(H,re,Te){var _e,me,Le=-1,Oe=re[1],Fe=0,Ve=7,at=4;for(Oe===0&&(Ve=138,at=3),re[2*(Te+1)+1]=65535,_e=0;_e<=Te;_e++)me=Oe,Oe=re[2*(_e+1)+1],++Fe<Ve&&me===Oe||(Fe<at?H.bl_tree[2*me]+=Fe:me!==0?(me!==Le&&H.bl_tree[2*me]++,H.bl_tree[2*R]++):Fe<=10?H.bl_tree[2*P]++:H.bl_tree[2*G]++,Le=me,at=(Fe=0)===Oe?(Ve=138,3):me===Oe?(Ve=6,3):(Ve=7,4))}function fe(H,re,Te){var _e,me,Le=-1,Oe=re[1],Fe=0,Ve=7,at=4;for(Oe===0&&(Ve=138,at=3),_e=0;_e<=Te;_e++)if(me=Oe,Oe=re[2*(_e+1)+1],!(++Fe<Ve&&me===Oe)){if(Fe<at)for(;K(H,me,H.bl_tree),--Fe!=0;);else me!==0?(me!==Le&&(K(H,me,H.bl_tree),Fe--),K(H,R,H.bl_tree),V(H,Fe-3,2)):Fe<=10?(K(H,P,H.bl_tree),V(H,Fe-3,3)):(K(H,G,H.bl_tree),V(H,Fe-11,7));Le=me,at=(Fe=0)===Oe?(Ve=138,3):me===Oe?(Ve=6,3):(Ve=7,4)}}h(te);var ce=!1;function W(H,re,Te,_e){V(H,(p<<1)+(_e?1:0),3),function(me,Le,Oe,Fe){ke(me),O(me,Oe),O(me,~Oe),c.arraySet(me.pending_buf,me.window,Le,Oe,me.pending),me.pending+=Oe}(H,re,Te)}i._tr_init=function(H){ce||(function(){var re,Te,_e,me,Le,Oe=new Array(A+1);for(me=_e=0;me<v-1;me++)for(pe[me]=_e,re=0;re<1<<$[me];re++)M[_e++]=me;for(M[_e-1]=me,me=Le=0;me<16;me++)for(te[me]=Le,re=0;re<1<<oe[me];re++)Y[Le++]=me;for(Le>>=7;me<S;me++)for(te[me]=Le<<7,re=0;re<1<<oe[me]-7;re++)Y[256+Le++]=me;for(Te=0;Te<=A;Te++)Oe[Te]=0;for(re=0;re<=143;)le[2*re+1]=8,re++,Oe[8]++;for(;re<=255;)le[2*re+1]=9,re++,Oe[9]++;for(;re<=279;)le[2*re+1]=7,re++,Oe[7]++;for(;re<=287;)le[2*re+1]=8,re++,Oe[8]++;for(se(le,C+1,Oe),re=0;re<S;re++)Q[2*re+1]=5,Q[2*re]=X(re,5);be=new q(le,$,x+1,C,A),ve=new q(Q,oe,0,S,A),xe=new q(new Array(0),J,0,b,F)}(),ce=!0),H.l_desc=new N(H.dyn_ltree,be),H.d_desc=new N(H.dyn_dtree,ve),H.bl_desc=new N(H.bl_tree,xe),H.bi_buf=0,H.bi_valid=0,ae(H)},i._tr_stored_block=W,i._tr_flush_block=function(H,re,Te,_e){var me,Le,Oe=0;0<H.level?(H.strm.data_type===2&&(H.strm.data_type=function(Fe){var Ve,at=4093624447;for(Ve=0;Ve<=31;Ve++,at>>>=1)if(1&at&&Fe.dyn_ltree[2*Ve]!==0)return f;if(Fe.dyn_ltree[18]!==0||Fe.dyn_ltree[20]!==0||Fe.dyn_ltree[26]!==0)return m;for(Ve=32;Ve<x;Ve++)if(Fe.dyn_ltree[2*Ve]!==0)return m;return f}(H)),De(H,H.l_desc),De(H,H.d_desc),Oe=function(Fe){var Ve;for(E(Fe,Fe.dyn_ltree,Fe.l_desc.max_code),E(Fe,Fe.dyn_dtree,Fe.d_desc.max_code),De(Fe,Fe.bl_desc),Ve=b-1;3<=Ve&&Fe.bl_tree[2*Z[Ve]+1]===0;Ve--);return Fe.opt_len+=3*(Ve+1)+5+5+4,Ve}(H),me=H.opt_len+3+7>>>3,(Le=H.static_len+3+7>>>3)<=me&&(me=Le)):me=Le=Te+5,Te+4<=me&&re!==-1?W(H,re,Te,_e):H.strategy===4||Le===me?(V(H,2+(_e?1:0),3),je(H,le,Q)):(V(H,4+(_e?1:0),3),function(Fe,Ve,at,et){var Nt;for(V(Fe,Ve-257,5),V(Fe,at-1,5),V(Fe,et-4,4),Nt=0;Nt<et;Nt++)V(Fe,Fe.bl_tree[2*Z[Nt]+1],3);fe(Fe,Fe.dyn_ltree,Ve-1),fe(Fe,Fe.dyn_dtree,at-1)}(H,H.l_desc.max_code+1,H.d_desc.max_code+1,Oe+1),je(H,H.dyn_ltree,H.dyn_dtree)),ae(H),_e&&ke(H)},i._tr_tally=function(H,re,Te){return H.pending_buf[H.d_buf+2*H.last_lit]=re>>>8&255,H.pending_buf[H.d_buf+2*H.last_lit+1]=255&re,H.pending_buf[H.l_buf+H.last_lit]=255&Te,H.last_lit++,re===0?H.dyn_ltree[2*Te]++:(H.matches++,re--,H.dyn_ltree[2*(M[Te]+x+1)]++,H.dyn_dtree[2*j(re)]++),H.last_lit===H.lit_bufsize-1},i._tr_align=function(H){V(H,2,3),K(H,L,le),function(re){re.bi_valid===16?(O(re,re.bi_buf),re.bi_buf=0,re.bi_valid=0):8<=re.bi_valid&&(re.pending_buf[re.pending++]=255&re.bi_buf,re.bi_buf>>=8,re.bi_valid-=8)}(H)}},{"../utils/common":41}],53:[function(n,o,i){o.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(n,o,i){(function(c){(function(f,m){if(!f.setImmediate){var h,p,v,x,C=1,S={},b=!1,T=f.document,A=Object.getPrototypeOf&&Object.getPrototypeOf(f);A=A&&A.setTimeout?A:f,h={}.toString.call(f.process)==="[object process]"?function(R){process.nextTick(function(){F(R)})}:function(){if(f.postMessage&&!f.importScripts){var R=!0,P=f.onmessage;return f.onmessage=function(){R=!1},f.postMessage("","*"),f.onmessage=P,R}}()?(x="setImmediate$"+Math.random()+"$",f.addEventListener?f.addEventListener("message",L,!1):f.attachEvent("onmessage",L),function(R){f.postMessage(x+R,"*")}):f.MessageChannel?((v=new MessageChannel).port1.onmessage=function(R){F(R.data)},function(R){v.port2.postMessage(R)}):T&&"onreadystatechange"in T.createElement("script")?(p=T.documentElement,function(R){var P=T.createElement("script");P.onreadystatechange=function(){F(R),P.onreadystatechange=null,p.removeChild(P),P=null},p.appendChild(P)}):function(R){setTimeout(F,0,R)},A.setImmediate=function(R){typeof R!="function"&&(R=new Function(""+R));for(var P=new Array(arguments.length-1),G=0;G<P.length;G++)P[G]=arguments[G+1];var $={callback:R,args:P};return S[C]=$,h(C),C++},A.clearImmediate=D}function D(R){delete S[R]}function F(R){if(b)setTimeout(F,0,R);else{var P=S[R];if(P){b=!0;try{(function(G){var $=G.callback,oe=G.args;switch(oe.length){case 0:$();break;case 1:$(oe[0]);break;case 2:$(oe[0],oe[1]);break;case 3:$(oe[0],oe[1],oe[2]);break;default:$.apply(m,oe)}})(P)}finally{D(R),b=!1}}}}function L(R){R.source===f&&typeof R.data=="string"&&R.data.indexOf(x)===0&&F(+R.data.slice(x.length))}})(typeof self>"u"?c===void 0?this:c:self)}).call(this,typeof Aa<"u"?Aa:typeof self<"u"?self:typeof window<"u"?window:{})},{}]},{},[10])(10)})}(Gu)),Gu.exports}var _y=Ty();const Ey=yi(_y);var $u={exports:{}};const by={},Ny=Object.freeze(Object.defineProperty({__proto__:null,default:by},Symbol.toStringTag,{value:"Module"})),Hu=Dg(Ny);var Kf;function Iy(){return Kf||(Kf=1,function(t,e){var n=void 0,o=function(i){return n||(n=new Promise(function(c,f){var m=typeof i<"u"?i:{},h=m.onAbort;m.onAbort=function(y){f(new Error(y)),h&&h(y)},m.postRun=m.postRun||[],m.postRun.push(function(){c(m)}),t=void 0;var p;p||(p=typeof m<"u"?m:{}),p.onRuntimeInitialized=function(){function y(ge,Me){switch(typeof Me){case"boolean":yl(ge,Me?1:0);break;case"number":pl(ge,Me);break;case"string":hl(ge,Me,-1,-1);break;case"object":if(Me===null)rs(ge);else if(Me.length!=null){var Ke=Co(Me,wo);gl(ge,Ke,Me.length,-1),ur(Ke)}else bo(ge,"Wrong API use : tried to return a value of an unknown type ("+Me+").",-1);break;default:rs(ge)}}function k(ge,Me){for(var Ke=[],lt=0;lt<ge;lt+=1){var ct=ce(Me+4*lt,"i32"),bt=cl(ct);if(bt===1||bt===2)ct=ml(ct);else if(bt===3)ct=dl(ct);else if(bt===4){bt=ct,ct=Pi(bt),bt=fl(bt);for(var sn=new Uint8Array(ct),Cn=0;Cn<ct;Cn+=1)sn[Cn]=Z[bt+Cn];ct=sn}else ct=null;Ke.push(ct)}return Ke}function I(ge,Me){this.La=ge,this.db=Me,this.Ja=1,this.fb=[]}function z(ge,Me){if(this.db=Me,Me=Nt(ge)+1,this.Ya=ko(Me),this.Ya===null)throw Error("Unable to allocate memory for the SQL string");kt(ge,le,this.Ya,Me),this.eb=this.Ya,this.Ua=this.ib=null}function ne(ge){if(this.filename="dbfile_"+(4294967295*Math.random()>>>0),ge!=null){var Me=this.filename,Ke="/",lt=Me;if(Ke&&(Ke=typeof Ke=="string"?Ke:dt(Ke),lt=Me?me(Ke+"/"+Me):Ke),Me=ir(!0,!0),lt=lo(lt,(Me!==void 0?Me:438)&4095|32768,0),ge){if(typeof ge=="string"){Ke=Array(ge.length);for(var ct=0,bt=ge.length;ct<bt;++ct)Ke[ct]=ge.charCodeAt(ct);ge=Ke}fo(lt,Me|146),Ke=Lr(lt,577),Ei(Ke,ge,0,ge.length,0),Qo(Ke),fo(lt,Me)}}this.handleError(rt(this.filename,Ce)),this.db=ce(Ce,"i32"),Li(this.db),this.Za={},this.Na={}}var Ce=Zn(4),Ie=p.cwrap,rt=Ie("sqlite3_open","number",["string","number"]),gt=Ie("sqlite3_close_v2","number",["number"]),it=Ie("sqlite3_exec","number",["number","string","number","number","number"]),Ft=Ie("sqlite3_changes","number",["number"]),Ut=Ie("sqlite3_prepare_v2","number",["number","string","number","number","number"]),Ps=Ie("sqlite3_sql","string",["number"]),ts=Ie("sqlite3_normalized_sql","string",["number"]),To=Ie("sqlite3_prepare_v2","number",["number","number","number","number","number"]),Mi=Ie("sqlite3_bind_text","number",["number","number","number","number","number"]),un=Ie("sqlite3_bind_blob","number",["number","number","number","number","number"]),Vr=Ie("sqlite3_bind_double","number",["number","number","number"]),Fs=Ie("sqlite3_bind_int","number",["number","number","number"]),_o=Ie("sqlite3_bind_parameter_index","number",["number","string"]),rl=Ie("sqlite3_step","number",["number"]),Ls=Ie("sqlite3_errmsg","string",["number"]),Us=Ie("sqlite3_column_count","number",["number"]),Eo=Ie("sqlite3_data_count","number",["number"]),ns=Ie("sqlite3_column_double","number",["number","number"]),js=Ie("sqlite3_column_text","string",["number","number"]),ol=Ie("sqlite3_column_blob","number",["number","number"]),sl=Ie("sqlite3_column_bytes","number",["number","number"]),il=Ie("sqlite3_column_type","number",["number","number"]),qs=Ie("sqlite3_column_name","string",["number","number"]),al=Ie("sqlite3_reset","number",["number"]),ll=Ie("sqlite3_clear_bindings","number",["number"]),ul=Ie("sqlite3_finalize","number",["number"]),Ri=Ie("sqlite3_create_function_v2","number","number string number number number number number number number".split(" ")),cl=Ie("sqlite3_value_type","number",["number"]),Pi=Ie("sqlite3_value_bytes","number",["number"]),dl=Ie("sqlite3_value_text","string",["number"]),fl=Ie("sqlite3_value_blob","number",["number"]),ml=Ie("sqlite3_value_double","number",["number"]),pl=Ie("sqlite3_result_double","",["number","number"]),rs=Ie("sqlite3_result_null","",["number"]),hl=Ie("sqlite3_result_text","",["number","string","number","number"]),gl=Ie("sqlite3_result_blob","",["number","number","number","number"]),yl=Ie("sqlite3_result_int","",["number","number"]),bo=Ie("sqlite3_result_error","",["number","string","number"]),Fi=Ie("sqlite3_aggregate_context","number",["number","number"]),Li=Ie("RegisterExtensionFunctions","number",["number"]);I.prototype.bind=function(ge){if(!this.La)throw"Statement closed";return this.reset(),Array.isArray(ge)?this.wb(ge):ge!=null&&typeof ge=="object"?this.xb(ge):!0},I.prototype.step=function(){if(!this.La)throw"Statement closed";this.Ja=1;var ge=rl(this.La);switch(ge){case 100:return!0;case 101:return!1;default:throw this.db.handleError(ge)}},I.prototype.rb=function(ge){return ge==null&&(ge=this.Ja,this.Ja+=1),ns(this.La,ge)},I.prototype.Ab=function(ge){if(ge==null&&(ge=this.Ja,this.Ja+=1),ge=js(this.La,ge),typeof BigInt!="function")throw Error("BigInt is not supported");return BigInt(ge)},I.prototype.Bb=function(ge){return ge==null&&(ge=this.Ja,this.Ja+=1),js(this.La,ge)},I.prototype.getBlob=function(ge){ge==null&&(ge=this.Ja,this.Ja+=1);var Me=sl(this.La,ge);ge=ol(this.La,ge);for(var Ke=new Uint8Array(Me),lt=0;lt<Me;lt+=1)Ke[lt]=Z[ge+lt];return Ke},I.prototype.get=function(ge,Me){Me=Me||{},ge!=null&&this.bind(ge)&&this.step(),ge=[];for(var Ke=Eo(this.La),lt=0;lt<Ke;lt+=1)switch(il(this.La,lt)){case 1:var ct=Me.useBigInt?this.Ab(lt):this.rb(lt);ge.push(ct);break;case 2:ge.push(this.rb(lt));break;case 3:ge.push(this.Bb(lt));break;case 4:ge.push(this.getBlob(lt));break;default:ge.push(null)}return ge},I.prototype.getColumnNames=function(){for(var ge=[],Me=Us(this.La),Ke=0;Ke<Me;Ke+=1)ge.push(qs(this.La,Ke));return ge},I.prototype.getAsObject=function(ge,Me){ge=this.get(ge,Me),Me=this.getColumnNames();for(var Ke={},lt=0;lt<Me.length;lt+=1)Ke[Me[lt]]=ge[lt];return Ke},I.prototype.getSQL=function(){return Ps(this.La)},I.prototype.getNormalizedSQL=function(){return ts(this.La)},I.prototype.run=function(ge){return ge!=null&&this.bind(ge),this.step(),this.reset()},I.prototype.nb=function(ge,Me){Me==null&&(Me=this.Ja,this.Ja+=1),ge=pt(ge);var Ke=Co(ge,wo);this.fb.push(Ke),this.db.handleError(Mi(this.La,Me,Ke,ge.length-1,0))},I.prototype.vb=function(ge,Me){Me==null&&(Me=this.Ja,this.Ja+=1);var Ke=Co(ge,wo);this.fb.push(Ke),this.db.handleError(un(this.La,Me,Ke,ge.length,0))},I.prototype.mb=function(ge,Me){Me==null&&(Me=this.Ja,this.Ja+=1),this.db.handleError((ge===(ge|0)?Fs:Vr)(this.La,Me,ge))},I.prototype.yb=function(ge){ge==null&&(ge=this.Ja,this.Ja+=1),un(this.La,ge,0,0,0)},I.prototype.ob=function(ge,Me){switch(Me==null&&(Me=this.Ja,this.Ja+=1),typeof ge){case"string":this.nb(ge,Me);return;case"number":this.mb(ge,Me);return;case"bigint":this.nb(ge.toString(),Me);return;case"boolean":this.mb(ge+0,Me);return;case"object":if(ge===null){this.yb(Me);return}if(ge.length!=null){this.vb(ge,Me);return}}throw"Wrong API use : tried to bind a value of an unknown type ("+ge+")."},I.prototype.xb=function(ge){var Me=this;return Object.keys(ge).forEach(function(Ke){var lt=_o(Me.La,Ke);lt!==0&&Me.ob(ge[Ke],lt)}),!0},I.prototype.wb=function(ge){for(var Me=0;Me<ge.length;Me+=1)this.ob(ge[Me],Me+1);return!0},I.prototype.reset=function(){return this.freemem(),ll(this.La)===0&&al(this.La)===0},I.prototype.freemem=function(){for(var ge;(ge=this.fb.pop())!==void 0;)ur(ge)},I.prototype.free=function(){this.freemem();var ge=ul(this.La)===0;return delete this.db.Za[this.La],this.La=0,ge},z.prototype.next=function(){if(this.Ya===null)return{done:!0};if(this.Ua!==null&&(this.Ua.free(),this.Ua=null),!this.db.db)throw this.gb(),Error("Database closed");var ge=Or(),Me=Zn(4);W(Ce),W(Me);try{this.db.handleError(To(this.db.db,this.eb,-1,Ce,Me)),this.eb=ce(Me,"i32");var Ke=ce(Ce,"i32");return Ke===0?(this.gb(),{done:!0}):(this.Ua=new I(Ke,this.db),this.db.Za[Ke]=this.Ua,{value:this.Ua,done:!1})}catch(lt){throw this.ib=Te(this.eb),this.gb(),lt}finally{cr(ge)}},z.prototype.gb=function(){ur(this.Ya),this.Ya=null},z.prototype.getRemainingSQL=function(){return this.ib!==null?this.ib:Te(this.eb)},typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"&&(z.prototype[Symbol.iterator]=function(){return this}),ne.prototype.run=function(ge,Me){if(!this.db)throw"Database closed";if(Me){ge=this.prepare(ge,Me);try{ge.step()}finally{ge.free()}}else this.handleError(it(this.db,ge,0,0,Ce));return this},ne.prototype.exec=function(ge,Me,Ke){if(!this.db)throw"Database closed";var lt=Or(),ct=null;try{var bt=xo(ge),sn=Zn(4);for(ge=[];ce(bt,"i8")!==0;){W(Ce),W(sn),this.handleError(To(this.db,bt,-1,Ce,sn));var Cn=ce(Ce,"i32");if(bt=ce(sn,"i32"),Cn!==0){var cn=null;for(ct=new I(Cn,this),Me!=null&&ct.bind(Me);ct.step();)cn===null&&(cn={columns:ct.getColumnNames(),values:[]},ge.push(cn)),cn.values.push(ct.get(null,Ke));ct.free()}}return ge}catch(Sn){throw ct&&ct.free(),Sn}finally{cr(lt)}},ne.prototype.each=function(ge,Me,Ke,lt,ct){typeof Me=="function"&&(lt=Ke,Ke=Me,Me=void 0),ge=this.prepare(ge,Me);try{for(;ge.step();)Ke(ge.getAsObject(null,ct))}finally{ge.free()}if(typeof lt=="function")return lt()},ne.prototype.prepare=function(ge,Me){if(W(Ce),this.handleError(Ut(this.db,ge,-1,Ce,0)),ge=ce(Ce,"i32"),ge===0)throw"Nothing to prepare";var Ke=new I(ge,this);return Me!=null&&Ke.bind(Me),this.Za[ge]=Ke},ne.prototype.iterateStatements=function(ge){return new z(ge,this)},ne.prototype.export=function(){Object.values(this.Za).forEach(function(Me){Me.free()}),Object.values(this.Na).forEach(vn),this.Na={},this.handleError(gt(this.db));var ge=Dn(this.filename);return this.handleError(rt(this.filename,Ce)),this.db=ce(Ce,"i32"),Li(this.db),ge},ne.prototype.close=function(){this.db!==null&&(Object.values(this.Za).forEach(function(ge){ge.free()}),Object.values(this.Na).forEach(vn),this.Na={},this.handleError(gt(this.db)),_i("/"+this.filename),this.db=null)},ne.prototype.handleError=function(ge){if(ge===0)return null;throw ge=Ls(this.db),Error(ge)},ne.prototype.getRowsModified=function(){return Ft(this.db)},ne.prototype.create_function=function(ge,Me){Object.prototype.hasOwnProperty.call(this.Na,ge)&&(vn(this.Na[ge]),delete this.Na[ge]);var Ke=Mn(function(lt,ct,bt){ct=k(ct,bt);try{var sn=Me.apply(null,ct)}catch(Cn){bo(lt,Cn,-1);return}y(lt,sn)},"viii");return this.Na[ge]=Ke,this.handleError(Ri(this.db,ge,Me.length,1,0,Ke,0,0,0)),this},ne.prototype.create_aggregate=function(ge,Me){var Ke=Me.init||function(){return null},lt=Me.finalize||function(cn){return cn},ct=Me.step;if(!ct)throw"An aggregate function must have a step function in "+ge;var bt={};Object.hasOwnProperty.call(this.Na,ge)&&(vn(this.Na[ge]),delete this.Na[ge]),Me=ge+"__finalize",Object.hasOwnProperty.call(this.Na,Me)&&(vn(this.Na[Me]),delete this.Na[Me]);var sn=Mn(function(cn,Sn,os){var dr=Fi(cn,1);Object.hasOwnProperty.call(bt,dr)||(bt[dr]=Ke()),Sn=k(Sn,os),Sn=[bt[dr]].concat(Sn);try{bt[dr]=ct.apply(null,Sn)}catch(Ui){delete bt[dr],bo(cn,Ui,-1)}},"viii"),Cn=Mn(function(cn){var Sn=Fi(cn,1);try{var os=lt(bt[Sn])}catch(dr){delete bt[Sn],bo(cn,dr,-1);return}y(cn,os),delete bt[Sn]},"vi");return this.Na[ge]=sn,this.Na[Me]=Cn,this.handleError(Ri(this.db,ge,ct.length-1,1,0,0,sn,Cn,0)),this},p.Database=ne};var v=Object.assign({},p),x="./this.program",C=typeof window=="object",S=typeof importScripts=="function",b=typeof process=="object"&&typeof process.versions=="object"&&typeof process.versions.node=="string",T="",A,D,F;if(b){var L=Hu,R=Hu;T=S?R.dirname(T)+"/":__dirname+"/",A=(y,k)=>(y=X(y)?new URL(y):R.normalize(y),L.readFileSync(y,k?void 0:"utf8")),F=y=>(y=A(y,!0),y.buffer||(y=new Uint8Array(y)),y),D=(y,k,I,z=!0)=>{y=X(y)?new URL(y):R.normalize(y),L.readFile(y,z?void 0:"utf8",(ne,Ce)=>{ne?I(ne):k(z?Ce.buffer:Ce)})},!p.thisProgram&&1<process.argv.length&&(x=process.argv[1].replace(/\\/g,"/")),process.argv.slice(2),t.exports=p,p.inspect=()=>"[Emscripten Module object]"}else(C||S)&&(S?T=self.location.href:typeof document<"u"&&document.currentScript&&(T=document.currentScript.src),T=T.indexOf("blob:")!==0?T.substr(0,T.replace(/[?#].*/,"").lastIndexOf("/")+1):"",A=y=>{var k=new XMLHttpRequest;return k.open("GET",y,!1),k.send(null),k.responseText},S&&(F=y=>{var k=new XMLHttpRequest;return k.open("GET",y,!1),k.responseType="arraybuffer",k.send(null),new Uint8Array(k.response)}),D=(y,k,I)=>{var z=new XMLHttpRequest;z.open("GET",y,!0),z.responseType="arraybuffer",z.onload=()=>{z.status==200||z.status==0&&z.response?k(z.response):I()},z.onerror=I,z.send(null)});var P=p.print||console.log.bind(console),G=p.printErr||console.error.bind(console);Object.assign(p,v),v=null,p.thisProgram&&(x=p.thisProgram);var $;p.wasmBinary&&($=p.wasmBinary),typeof WebAssembly!="object"&&V("no native wasm support detected");var oe,J=!1,Z,le,Q,Y,M,pe,be;function ve(){var y=oe.buffer;p.HEAP8=Z=new Int8Array(y),p.HEAP16=Q=new Int16Array(y),p.HEAPU8=le=new Uint8Array(y),p.HEAPU16=new Uint16Array(y),p.HEAP32=Y=new Int32Array(y),p.HEAPU32=M=new Uint32Array(y),p.HEAPF32=pe=new Float32Array(y),p.HEAPF64=be=new Float64Array(y)}var xe=[],te=[],q=[];function N(){var y=p.preRun.shift();xe.unshift(y)}var j=0,O=null;function V(y){var k;throw(k=p.onAbort)==null||k.call(p,y),y="Aborted("+y+")",G(y),J=!0,new WebAssembly.RuntimeError(y+". Build with -sASSERTIONS for more info.")}var K=y=>y.startsWith("data:application/octet-stream;base64,"),X=y=>y.startsWith("file://"),se;if(se="sql-wasm.wasm",!K(se)){var ae=se;se=p.locateFile?p.locateFile(ae,T):T+ae}function ke(y){if(y==se&&$)return new Uint8Array($);if(F)return F(y);throw"both async and sync fetching of the wasm failed"}function Ae(y){if(!$&&(C||S)){if(typeof fetch=="function"&&!X(y))return fetch(y,{credentials:"same-origin"}).then(k=>{if(!k.ok)throw"failed to load wasm binary file at '"+y+"'";return k.arrayBuffer()}).catch(()=>ke(y));if(D)return new Promise((k,I)=>{D(y,z=>k(new Uint8Array(z)),I)})}return Promise.resolve().then(()=>ke(y))}function Ne(y,k,I){return Ae(y).then(z=>WebAssembly.instantiate(z,k)).then(z=>z).then(I,z=>{G(`failed to asynchronously prepare wasm: ${z}`),V(z)})}function je(y,k){var I=se;$||typeof WebAssembly.instantiateStreaming!="function"||K(I)||X(I)||b||typeof fetch!="function"?Ne(I,y,k):fetch(I,{credentials:"same-origin"}).then(z=>WebAssembly.instantiateStreaming(z,y).then(k,function(ne){return G(`wasm streaming compile failed: ${ne}`),G("falling back to ArrayBuffer instantiation"),Ne(I,y,k)}))}var De,E,fe=y=>{for(;0<y.length;)y.shift()(p)};function ce(y,k="i8"){switch(k.endsWith("*")&&(k="*"),k){case"i1":return Z[y>>0];case"i8":return Z[y>>0];case"i16":return Q[y>>1];case"i32":return Y[y>>2];case"i64":V("to do getValue(i64) use WASM_BIGINT");case"float":return pe[y>>2];case"double":return be[y>>3];case"*":return M[y>>2];default:V(`invalid type for getValue: ${k}`)}}function W(y){var k="i32";switch(k.endsWith("*")&&(k="*"),k){case"i1":Z[y>>0]=0;break;case"i8":Z[y>>0]=0;break;case"i16":Q[y>>1]=0;break;case"i32":Y[y>>2]=0;break;case"i64":V("to do setValue(i64) use WASM_BIGINT");case"float":pe[y>>2]=0;break;case"double":be[y>>3]=0;break;case"*":M[y>>2]=0;break;default:V(`invalid type for setValue: ${k}`)}}var H=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0,re=(y,k,I)=>{var z=k+I;for(I=k;y[I]&&!(I>=z);)++I;if(16<I-k&&y.buffer&&H)return H.decode(y.subarray(k,I));for(z="";k<I;){var ne=y[k++];if(ne&128){var Ce=y[k++]&63;if((ne&224)==192)z+=String.fromCharCode((ne&31)<<6|Ce);else{var Ie=y[k++]&63;ne=(ne&240)==224?(ne&15)<<12|Ce<<6|Ie:(ne&7)<<18|Ce<<12|Ie<<6|y[k++]&63,65536>ne?z+=String.fromCharCode(ne):(ne-=65536,z+=String.fromCharCode(55296|ne>>10,56320|ne&1023))}}else z+=String.fromCharCode(ne)}return z},Te=(y,k)=>y?re(le,y,k):"",_e=(y,k)=>{for(var I=0,z=y.length-1;0<=z;z--){var ne=y[z];ne==="."?y.splice(z,1):ne===".."?(y.splice(z,1),I++):I&&(y.splice(z,1),I--)}if(k)for(;I;I--)y.unshift("..");return y},me=y=>{var k=y.charAt(0)==="/",I=y.substr(-1)==="/";return(y=_e(y.split("/").filter(z=>!!z),!k).join("/"))||k||(y="."),y&&I&&(y+="/"),(k?"/":"")+y},Le=y=>{var k=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/.exec(y).slice(1);return y=k[0],k=k[1],!y&&!k?".":(k&&(k=k.substr(0,k.length-1)),y+k)},Oe=y=>{if(y==="/")return"/";y=me(y),y=y.replace(/\/$/,"");var k=y.lastIndexOf("/");return k===-1?y:y.substr(k+1)},Fe=()=>{if(typeof crypto=="object"&&typeof crypto.getRandomValues=="function")return I=>crypto.getRandomValues(I);if(b)try{var y=Hu;if(y.randomFillSync)return I=>y.randomFillSync(I);var k=y.randomBytes;return I=>(I.set(k(I.byteLength)),I)}catch{}V("initRandomDevice")},Ve=y=>(Ve=Fe())(y);function at(){for(var y="",k=!1,I=arguments.length-1;-1<=I&&!k;I--){if(k=0<=I?arguments[I]:"/",typeof k!="string")throw new TypeError("Arguments to path.resolve must be strings");if(!k)return"";y=k+"/"+y,k=k.charAt(0)==="/"}return y=_e(y.split("/").filter(z=>!!z),!k).join("/"),(k?"/":"")+y||"."}var et=[],Nt=y=>{for(var k=0,I=0;I<y.length;++I){var z=y.charCodeAt(I);127>=z?k++:2047>=z?k+=2:55296<=z&&57343>=z?(k+=4,++I):k+=3}return k},kt=(y,k,I,z)=>{if(!(0<z))return 0;var ne=I;z=I+z-1;for(var Ce=0;Ce<y.length;++Ce){var Ie=y.charCodeAt(Ce);if(55296<=Ie&&57343>=Ie){var rt=y.charCodeAt(++Ce);Ie=65536+((Ie&1023)<<10)|rt&1023}if(127>=Ie){if(I>=z)break;k[I++]=Ie}else{if(2047>=Ie){if(I+1>=z)break;k[I++]=192|Ie>>6}else{if(65535>=Ie){if(I+2>=z)break;k[I++]=224|Ie>>12}else{if(I+3>=z)break;k[I++]=240|Ie>>18,k[I++]=128|Ie>>12&63}k[I++]=128|Ie>>6&63}k[I++]=128|Ie&63}}return k[I]=0,I-ne};function pt(y,k){var I=Array(Nt(y)+1);return y=kt(y,I,0,I.length),k&&(I.length=y),I}var Qt=[];function Ct(y,k){Qt[y]={input:[],output:[],Xa:k},Wo(y,jn)}var jn={open(y){var k=Qt[y.node.rdev];if(!k)throw new Ee(43);y.tty=k,y.seekable=!1},close(y){y.tty.Xa.fsync(y.tty)},fsync(y){y.tty.Xa.fsync(y.tty)},read(y,k,I,z){if(!y.tty||!y.tty.Xa.sb)throw new Ee(60);for(var ne=0,Ce=0;Ce<z;Ce++){try{var Ie=y.tty.Xa.sb(y.tty)}catch{throw new Ee(29)}if(Ie===void 0&&ne===0)throw new Ee(6);if(Ie==null)break;ne++,k[I+Ce]=Ie}return ne&&(y.node.timestamp=Date.now()),ne},write(y,k,I,z){if(!y.tty||!y.tty.Xa.jb)throw new Ee(60);try{for(var ne=0;ne<z;ne++)y.tty.Xa.jb(y.tty,k[I+ne])}catch{throw new Ee(29)}return z&&(y.node.timestamp=Date.now()),ne}},wr={sb(){e:{if(!et.length){var y=null;if(b){var k=Buffer.alloc(256),I=0,z=process.stdin.fd;try{I=L.readSync(z,k)}catch(ne){if(ne.toString().includes("EOF"))I=0;else throw ne}0<I?y=k.slice(0,I).toString("utf-8"):y=null}else typeof window<"u"&&typeof window.prompt=="function"?(y=window.prompt("Input: "),y!==null&&(y+=`
`)):typeof readline=="function"&&(y=readline(),y!==null&&(y+=`
`));if(!y){y=null;break e}et=pt(y,!0)}y=et.shift()}return y},jb(y,k){k===null||k===10?(P(re(y.output,0)),y.output=[]):k!=0&&y.output.push(k)},fsync(y){y.output&&0<y.output.length&&(P(re(y.output,0)),y.output=[])},Mb(){return{Ib:25856,Kb:5,Hb:191,Jb:35387,Gb:[3,28,127,21,4,0,1,0,17,19,26,0,18,15,23,22,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]}},Nb(){return 0},Ob(){return[24,80]}},Gt={jb(y,k){k===null||k===10?(G(re(y.output,0)),y.output=[]):k!=0&&y.output.push(k)},fsync(y){y.output&&0<y.output.length&&(G(re(y.output,0)),y.output=[])}};function qn(y,k){var I=y.Ia?y.Ia.length:0;I>=k||(k=Math.max(k,I*(1048576>I?2:1.125)>>>0),I!=0&&(k=Math.max(k,256)),I=y.Ia,y.Ia=new Uint8Array(k),0<y.Ma&&y.Ia.set(I.subarray(0,y.Ma),0))}var ot={Qa:null,Ra(){return ot.createNode(null,"/",16895,0)},createNode(y,k,I,z){if((I&61440)===24576||(I&61440)===4096)throw new Ee(63);return ot.Qa||(ot.Qa={dir:{node:{Pa:ot.Ga.Pa,Oa:ot.Ga.Oa,lookup:ot.Ga.lookup,ab:ot.Ga.ab,rename:ot.Ga.rename,unlink:ot.Ga.unlink,rmdir:ot.Ga.rmdir,readdir:ot.Ga.readdir,symlink:ot.Ga.symlink},stream:{Ta:ot.Ha.Ta}},file:{node:{Pa:ot.Ga.Pa,Oa:ot.Ga.Oa},stream:{Ta:ot.Ha.Ta,read:ot.Ha.read,write:ot.Ha.write,lb:ot.Ha.lb,bb:ot.Ha.bb,cb:ot.Ha.cb}},link:{node:{Pa:ot.Ga.Pa,Oa:ot.Ga.Oa,readlink:ot.Ga.readlink},stream:{}},pb:{node:{Pa:ot.Ga.Pa,Oa:ot.Ga.Oa},stream:Si}}),I=Bt(y,k,I,z),ht(I.mode)?(I.Ga=ot.Qa.dir.node,I.Ha=ot.Qa.dir.stream,I.Ia={}):(I.mode&61440)===32768?(I.Ga=ot.Qa.file.node,I.Ha=ot.Qa.file.stream,I.Ma=0,I.Ia=null):(I.mode&61440)===40960?(I.Ga=ot.Qa.link.node,I.Ha=ot.Qa.link.stream):(I.mode&61440)===8192&&(I.Ga=ot.Qa.pb.node,I.Ha=ot.Qa.pb.stream),I.timestamp=Date.now(),y&&(y.Ia[k]=I,y.timestamp=I.timestamp),I},Lb(y){return y.Ia?y.Ia.subarray?y.Ia.subarray(0,y.Ma):new Uint8Array(y.Ia):new Uint8Array(0)},Ga:{Pa(y){var k={};return k.dev=(y.mode&61440)===8192?y.id:1,k.ino=y.id,k.mode=y.mode,k.nlink=1,k.uid=0,k.gid=0,k.rdev=y.rdev,ht(y.mode)?k.size=4096:(y.mode&61440)===32768?k.size=y.Ma:(y.mode&61440)===40960?k.size=y.link.length:k.size=0,k.atime=new Date(y.timestamp),k.mtime=new Date(y.timestamp),k.ctime=new Date(y.timestamp),k.zb=4096,k.blocks=Math.ceil(k.size/k.zb),k},Oa(y,k){if(k.mode!==void 0&&(y.mode=k.mode),k.timestamp!==void 0&&(y.timestamp=k.timestamp),k.size!==void 0&&(k=k.size,y.Ma!=k))if(k==0)y.Ia=null,y.Ma=0;else{var I=y.Ia;y.Ia=new Uint8Array(k),I&&y.Ia.set(I.subarray(0,Math.min(k,y.Ma))),y.Ma=k}},lookup(){throw st[44]},ab(y,k,I,z){return ot.createNode(y,k,I,z)},rename(y,k,I){if(ht(y.mode)){try{var z=Tt(k,I)}catch{}if(z)for(var ne in z.Ia)throw new Ee(55)}delete y.parent.Ia[y.name],y.parent.timestamp=Date.now(),y.name=I,k.Ia[I]=y,k.timestamp=y.parent.timestamp,y.parent=k},unlink(y,k){delete y.Ia[k],y.timestamp=Date.now()},rmdir(y,k){var I=Tt(y,k),z;for(z in I.Ia)throw new Ee(55);delete y.Ia[k],y.timestamp=Date.now()},readdir(y){var k=[".",".."],I;for(I of Object.keys(y.Ia))k.push(I);return k},symlink(y,k,I){return y=ot.createNode(y,k,41471,0),y.link=I,y},readlink(y){if((y.mode&61440)!==40960)throw new Ee(28);return y.link}},Ha:{read(y,k,I,z,ne){var Ce=y.node.Ia;if(ne>=y.node.Ma)return 0;if(y=Math.min(y.node.Ma-ne,z),8<y&&Ce.subarray)k.set(Ce.subarray(ne,ne+y),I);else for(z=0;z<y;z++)k[I+z]=Ce[ne+z];return y},write(y,k,I,z,ne,Ce){if(k.buffer===Z.buffer&&(Ce=!1),!z)return 0;if(y=y.node,y.timestamp=Date.now(),k.subarray&&(!y.Ia||y.Ia.subarray)){if(Ce)return y.Ia=k.subarray(I,I+z),y.Ma=z;if(y.Ma===0&&ne===0)return y.Ia=k.slice(I,I+z),y.Ma=z;if(ne+z<=y.Ma)return y.Ia.set(k.subarray(I,I+z),ne),z}if(qn(y,ne+z),y.Ia.subarray&&k.subarray)y.Ia.set(k.subarray(I,I+z),ne);else for(Ce=0;Ce<z;Ce++)y.Ia[ne+Ce]=k[I+Ce];return y.Ma=Math.max(y.Ma,ne+z),z},Ta(y,k,I){if(I===1?k+=y.position:I===2&&(y.node.mode&61440)===32768&&(k+=y.node.Ma),0>k)throw new Ee(28);return k},lb(y,k,I){qn(y.node,k+I),y.node.Ma=Math.max(y.node.Ma,k+I)},bb(y,k,I,z,ne){if((y.node.mode&61440)!==32768)throw new Ee(43);if(y=y.node.Ia,ne&2||y.buffer!==Z.buffer){if((0<I||I+k<y.length)&&(y.subarray?y=y.subarray(I,I+k):y=Array.prototype.slice.call(y,I,I+k)),I=!0,k=65536*Math.ceil(k/65536),(ne=Di(65536,k))?(le.fill(0,ne,ne+k),k=ne):k=0,!k)throw new Ee(48);Z.set(y,k)}else I=!1,k=y.byteOffset;return{Db:k,ub:I}},cb(y,k,I,z){return ot.Ha.write(y,k,0,z,I,!1),0}}},ir=(y,k)=>{var I=0;return y&&(I|=365),k&&(I|=146),I},yn=null,Kt={},$t=[],Yn=1,ze=null,Je=!0,Ee=null,st={};function Xe(y,k={}){if(y=at(y),!y)return{path:"",node:null};if(k=Object.assign({qb:!0,kb:0},k),8<k.kb)throw new Ee(32);y=y.split("/").filter(Ie=>!!Ie);for(var I=yn,z="/",ne=0;ne<y.length;ne++){var Ce=ne===y.length-1;if(Ce&&k.parent)break;if(I=Tt(I,y[ne]),z=me(z+"/"+y[ne]),I.Va&&(!Ce||Ce&&k.qb)&&(I=I.Va.root),!Ce||k.Sa){for(Ce=0;(I.mode&61440)===40960;)if(I=Pt(z),z=at(Le(z),I),I=Xe(z,{kb:k.kb+1}).node,40<Ce++)throw new Ee(32)}}return{path:z,node:I}}function dt(y){for(var k;;){if(y===y.parent)return y=y.Ra.tb,k?y[y.length-1]!=="/"?`${y}/${k}`:y+k:y;k=k?`${y.name}/${k}`:y.name,y=y.parent}}function It(y,k){for(var I=0,z=0;z<k.length;z++)I=(I<<5)-I+k.charCodeAt(z)|0;return(y+I>>>0)%ze.length}function Zt(y){var k=It(y.parent.id,y.name);if(ze[k]===y)ze[k]=y.Wa;else for(k=ze[k];k;){if(k.Wa===y){k.Wa=y.Wa;break}k=k.Wa}}function Tt(y,k){var I;if(I=(I=rn(y,"x"))?I:y.Ga.lookup?0:2)throw new Ee(I,y);for(I=ze[It(y.id,k)];I;I=I.Wa){var z=I.name;if(I.parent.id===y.id&&z===k)return I}return y.Ga.lookup(y,k)}function Bt(y,k,I,z){return y=new zr(y,k,I,z),k=It(y.parent.id,y.name),y.Wa=ze[k],ze[k]=y}function ht(y){return(y&61440)===16384}function ar(y){var k=["r","w","rw"][y&3];return y&512&&(k+="w"),k}function rn(y,k){if(Je)return 0;if(!k.includes("r")||y.mode&292){if(k.includes("w")&&!(y.mode&146)||k.includes("x")&&!(y.mode&73))return 2}else return 2;return 0}function Ho(y,k){try{return Tt(y,k),20}catch{}return rn(y,"wx")}function Ci(y,k,I){try{var z=Tt(y,k)}catch(ne){return ne.Ka}if(y=rn(y,"wx"))return y;if(I){if(!ht(z.mode))return 54;if(z===z.parent||dt(z)==="/")return 10}else if(ht(z.mode))return 31;return 0}function tl(){for(var y=0;4096>=y;y++)if(!$t[y])return y;throw new Ee(33)}function on(y){if(y=$t[y],!y)throw new Ee(8);return y}function lr(y,k=-1){return Qn||(Qn=function(){this.$a={}},Qn.prototype={},Object.defineProperties(Qn.prototype,{object:{get(){return this.node},set(I){this.node=I}},flags:{get(){return this.$a.flags},set(I){this.$a.flags=I}},position:{get(){return this.$a.position},set(I){this.$a.position=I}}})),y=Object.assign(new Qn,y),k==-1&&(k=tl()),y.fd=k,$t[k]=y}var Si={open(y){var k,I;y.Ha=Kt[y.node.rdev].Ha,(I=(k=y.Ha).open)==null||I.call(k,y)},Ta(){throw new Ee(70)}};function Wo(y,k){Kt[y]={Ha:k}}function ki(y,k){var I=k==="/",z=!k;if(I&&yn)throw new Ee(10);if(!I&&!z){var ne=Xe(k,{qb:!1});if(k=ne.path,ne=ne.node,ne.Va)throw new Ee(10);if(!ht(ne.mode))throw new Ee(54)}k={type:y,Pb:{},tb:k,Cb:[]},y=y.Ra(k),y.Ra=k,k.root=y,I?yn=y:ne&&(ne.Va=k,ne.Ra&&ne.Ra.Cb.push(k))}function lo(y,k,I){var z=Xe(y,{parent:!0}).node;if(y=Oe(y),!y||y==="."||y==="..")throw new Ee(28);var ne=Ho(z,y);if(ne)throw new Ee(ne);if(!z.Ga.ab)throw new Ee(63);return z.Ga.ab(z,y,k,I)}function In(y,k){return lo(y,(k!==void 0?k:511)&1023|16384,0)}function uo(y,k,I){typeof I>"u"&&(I=k,k=438),lo(y,k|8192,I)}function Jo(y,k){if(!at(y))throw new Ee(44);var I=Xe(k,{parent:!0}).node;if(!I)throw new Ee(44);k=Oe(k);var z=Ho(I,k);if(z)throw new Ee(z);if(!I.Ga.symlink)throw new Ee(63);I.Ga.symlink(I,k,y)}function Ti(y){var k=Xe(y,{parent:!0}).node;y=Oe(y);var I=Tt(k,y),z=Ci(k,y,!0);if(z)throw new Ee(z);if(!k.Ga.rmdir)throw new Ee(63);if(I.Va)throw new Ee(10);k.Ga.rmdir(k,y),Zt(I)}function _i(y){var k=Xe(y,{parent:!0}).node;if(!k)throw new Ee(44);y=Oe(y);var I=Tt(k,y),z=Ci(k,y,!1);if(z)throw new Ee(z);if(!k.Ga.unlink)throw new Ee(63);if(I.Va)throw new Ee(10);k.Ga.unlink(k,y),Zt(I)}function Pt(y){if(y=Xe(y).node,!y)throw new Ee(44);if(!y.Ga.readlink)throw new Ee(28);return at(dt(y.parent),y.Ga.readlink(y))}function co(y,k){if(y=Xe(y,{Sa:!k}).node,!y)throw new Ee(44);if(!y.Ga.Pa)throw new Ee(63);return y.Ga.Pa(y)}function Yo(y){return co(y,!0)}function fo(y,k){if(y=typeof y=="string"?Xe(y,{Sa:!0}).node:y,!y.Ga.Oa)throw new Ee(63);y.Ga.Oa(y,{mode:k&4095|y.mode&-4096,timestamp:Date.now()})}function mo(y,k){if(0>k)throw new Ee(28);if(y=typeof y=="string"?Xe(y,{Sa:!0}).node:y,!y.Ga.Oa)throw new Ee(63);if(ht(y.mode))throw new Ee(31);if((y.mode&61440)!==32768)throw new Ee(28);var I=rn(y,"w");if(I)throw new Ee(I);y.Ga.Oa(y,{size:k,timestamp:Date.now()})}function Lr(y,k,I){if(y==="")throw new Ee(44);if(typeof k=="string"){var z={r:0,"r+":2,w:577,"w+":578,a:1089,"a+":1090}[k];if(typeof z>"u")throw Error(`Unknown file open mode: ${k}`);k=z}if(I=k&64?(typeof I>"u"?438:I)&4095|32768:0,typeof y=="object")var ne=y;else{y=me(y);try{ne=Xe(y,{Sa:!(k&131072)}).node}catch{}}if(z=!1,k&64)if(ne){if(k&128)throw new Ee(20)}else ne=lo(y,I,0),z=!0;if(!ne)throw new Ee(44);if((ne.mode&61440)===8192&&(k&=-513),k&65536&&!ht(ne.mode))throw new Ee(54);if(!z&&(I=ne?(ne.mode&61440)===40960?32:ht(ne.mode)&&(ar(k)!=="r"||k&512)?31:rn(ne,ar(k)):44))throw new Ee(I);return k&512&&!z&&mo(ne,0),k&=-131713,ne=lr({node:ne,path:dt(ne),flags:k,seekable:!0,position:0,Ha:ne.Ha,Fb:[],error:!1}),ne.Ha.open&&ne.Ha.open(ne),!p.logReadFiles||k&1||(Ur||(Ur={}),y in Ur||(Ur[y]=1)),ne}function Qo(y){if(y.fd===null)throw new Ee(8);y.hb&&(y.hb=null);try{y.Ha.close&&y.Ha.close(y)}catch(k){throw k}finally{$t[y.fd]=null}y.fd=null}function po(y,k,I){if(y.fd===null)throw new Ee(8);if(!y.seekable||!y.Ha.Ta)throw new Ee(70);if(I!=0&&I!=1&&I!=2)throw new Ee(28);y.position=y.Ha.Ta(y,k,I),y.Fb=[]}function An(y,k,I,z,ne){if(0>z||0>ne)throw new Ee(28);if(y.fd===null)throw new Ee(8);if((y.flags&2097155)===1)throw new Ee(8);if(ht(y.node.mode))throw new Ee(31);if(!y.Ha.read)throw new Ee(28);var Ce=typeof ne<"u";if(!Ce)ne=y.position;else if(!y.seekable)throw new Ee(70);return k=y.Ha.read(y,k,I,z,ne),Ce||(y.position+=k),k}function Ei(y,k,I,z,ne){if(0>z||0>ne)throw new Ee(28);if(y.fd===null)throw new Ee(8);if((y.flags&2097155)===0)throw new Ee(8);if(ht(y.node.mode))throw new Ee(31);if(!y.Ha.write)throw new Ee(28);y.seekable&&y.flags&1024&&po(y,0,2);var Ce=typeof ne<"u";if(!Ce)ne=y.position;else if(!y.seekable)throw new Ee(70);return k=y.Ha.write(y,k,I,z,ne,void 0),Ce||(y.position+=k),k}function Dn(y){var k,I=Lr(y,I||0);y=co(y).size;var z=new Uint8Array(y);return An(I,z,0,y,0),k=z,Qo(I),k}function bi(){Ee||(Ee=function(y,k){this.name="ErrnoError",this.node=k,this.Eb=function(I){this.Ka=I},this.Eb(y),this.message="FS error"},Ee.prototype=Error(),Ee.prototype.constructor=Ee,[44].forEach(y=>{st[y]=new Ee(y),st[y].stack="<generic error, no stack>"}))}var Ni;function ho(y,k,I){y=me("/dev/"+y);var z=ir(!!k,!!I);go||(go=64);var ne=go++<<8|0;Wo(ne,{open(Ce){Ce.seekable=!1},close(){var Ce;(Ce=I==null?void 0:I.buffer)!=null&&Ce.length&&I(10)},read(Ce,Ie,rt,gt){for(var it=0,Ft=0;Ft<gt;Ft++){try{var Ut=k()}catch{throw new Ee(29)}if(Ut===void 0&&it===0)throw new Ee(6);if(Ut==null)break;it++,Ie[rt+Ft]=Ut}return it&&(Ce.node.timestamp=Date.now()),it},write(Ce,Ie,rt,gt){for(var it=0;it<gt;it++)try{I(Ie[rt+it])}catch{throw new Ee(29)}return gt&&(Ce.node.timestamp=Date.now()),it}}),uo(y,z,ne)}var go,Et={},Qn,Ur;function Cr(y,k,I){if(k.charAt(0)==="/")return k;if(y=y===-100?"/":on(y).path,k.length==0){if(!I)throw new Ee(44);return y}return me(y+"/"+k)}function Ko(y,k,I){try{var z=y(k)}catch(Ce){if(Ce&&Ce.node&&me(k)!==me(dt(Ce.node)))return-54;throw Ce}Y[I>>2]=z.dev,Y[I+4>>2]=z.mode,M[I+8>>2]=z.nlink,Y[I+12>>2]=z.uid,Y[I+16>>2]=z.gid,Y[I+20>>2]=z.rdev,E=[z.size>>>0,(De=z.size,1<=+Math.abs(De)?0<De?+Math.floor(De/4294967296)>>>0:~~+Math.ceil((De-+(~~De>>>0))/4294967296)>>>0:0)],Y[I+24>>2]=E[0],Y[I+28>>2]=E[1],Y[I+32>>2]=4096,Y[I+36>>2]=z.blocks,y=z.atime.getTime(),k=z.mtime.getTime();var ne=z.ctime.getTime();return E=[Math.floor(y/1e3)>>>0,(De=Math.floor(y/1e3),1<=+Math.abs(De)?0<De?+Math.floor(De/4294967296)>>>0:~~+Math.ceil((De-+(~~De>>>0))/4294967296)>>>0:0)],Y[I+40>>2]=E[0],Y[I+44>>2]=E[1],M[I+48>>2]=y%1e3*1e3,E=[Math.floor(k/1e3)>>>0,(De=Math.floor(k/1e3),1<=+Math.abs(De)?0<De?+Math.floor(De/4294967296)>>>0:~~+Math.ceil((De-+(~~De>>>0))/4294967296)>>>0:0)],Y[I+56>>2]=E[0],Y[I+60>>2]=E[1],M[I+64>>2]=k%1e3*1e3,E=[Math.floor(ne/1e3)>>>0,(De=Math.floor(ne/1e3),1<=+Math.abs(De)?0<De?+Math.floor(De/4294967296)>>>0:~~+Math.ceil((De-+(~~De>>>0))/4294967296)>>>0:0)],Y[I+72>>2]=E[0],Y[I+76>>2]=E[1],M[I+80>>2]=ne%1e3*1e3,E=[z.ino>>>0,(De=z.ino,1<=+Math.abs(De)?0<De?+Math.floor(De/4294967296)>>>0:~~+Math.ceil((De-+(~~De>>>0))/4294967296)>>>0:0)],Y[I+88>>2]=E[0],Y[I+92>>2]=E[1],0}var jr=void 0;function yo(){var y=Y[+jr>>2];return jr+=4,y}var Sr=(y,k)=>k+2097152>>>0<4194305-!!y?(y>>>0)+4294967296*k:NaN,vo=[0,31,60,91,121,152,182,213,244,274,305,335],nl=[0,31,59,90,120,151,181,212,243,273,304,334],Zo=y=>{var k=Nt(y)+1,I=ko(k);return I&&kt(y,le,I,k),I},xt={},Rs=()=>{if(!Xo){var y={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:(typeof navigator=="object"&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8",_:x||"./this.program"},k;for(k in xt)xt[k]===void 0?delete y[k]:y[k]=xt[k];var I=[];for(k in y)I.push(`${k}=${y[k]}`);Xo=I}return Xo},Xo,xo=y=>{var k=Nt(y)+1,I=Zn(k);return kt(y,le,I,k),I},Ii=(y,k,I,z)=>{var ne={string:it=>{var Ft=0;return it!=null&&it!==0&&(Ft=xo(it)),Ft},array:it=>{var Ft=Zn(it.length);return Z.set(it,Ft),Ft}};y=p["_"+y];var Ce=[],Ie=0;if(z)for(var rt=0;rt<z.length;rt++){var gt=ne[I[rt]];gt?(Ie===0&&(Ie=Or()),Ce[rt]=gt(z[rt])):Ce[rt]=z[rt]}return I=y.apply(null,Ce),I=function(it){return Ie!==0&&cr(Ie),k==="string"?it?re(le,it):"":k==="boolean"?!!it:it}(I)},wo=0,Co=(y,k)=>(k=k==1?Zn(y.length):ko(y.length),y.subarray||y.slice||(y=new Uint8Array(y)),le.set(y,k),k),Kn,qr=[],Xt,vn=y=>{Kn.delete(Xt.get(y)),Xt.set(y,null),qr.push(y)},Mn=(y,k)=>{if(!Kn){Kn=new WeakMap;var I=Xt.length;if(Kn)for(var z=0;z<0+I;z++){var ne=Xt.get(z);ne&&Kn.set(ne,z)}}if(I=Kn.get(y)||0)return I;if(qr.length)I=qr.pop();else{try{Xt.grow(1)}catch(rt){throw rt instanceof RangeError?"Unable to grow wasm table. Set ALLOW_TABLE_GROWTH.":rt}I=Xt.length-1}try{Xt.set(I,y)}catch(rt){if(!(rt instanceof TypeError))throw rt;if(typeof WebAssembly.Function=="function"){z=WebAssembly.Function,ne={i:"i32",j:"i64",f:"f32",d:"f64",e:"externref",p:"i32"};for(var Ce={parameters:[],results:k[0]=="v"?[]:[ne[k[0]]]},Ie=1;Ie<k.length;++Ie)Ce.parameters.push(ne[k[Ie]]);k=new z(Ce,y)}else{for(z=[1],ne=k.slice(0,1),k=k.slice(1),Ce={i:127,p:127,j:126,f:125,d:124,e:111},z.push(96),Ie=k.length,128>Ie?z.push(Ie):z.push(Ie%128|128,Ie>>7),Ie=0;Ie<k.length;++Ie)z.push(Ce[k[Ie]]);ne=="v"?z.push(0):z.push(1,Ce[ne]),k=[0,97,115,109,1,0,0,0,1],ne=z.length,128>ne?k.push(ne):k.push(ne%128|128,ne>>7),k.push.apply(k,z),k.push(2,7,1,1,101,1,102,0,0,7,5,1,1,102,0,0),k=new WebAssembly.Module(new Uint8Array(k)),k=new WebAssembly.Instance(k,{e:{f:y}}).exports.f}Xt.set(I,k)}return Kn.set(y,I),I};function zr(y,k,I,z){y||(y=this),this.parent=y,this.Ra=y.Ra,this.Va=null,this.id=Yn++,this.name=k,this.mode=I,this.Ga={},this.Ha={},this.rdev=z}Object.defineProperties(zr.prototype,{read:{get:function(){return(this.mode&365)===365},set:function(y){y?this.mode|=365:this.mode&=-366}},write:{get:function(){return(this.mode&146)===146},set:function(y){y?this.mode|=146:this.mode&=-147}}}),bi(),ze=Array(4096),ki(ot,"/"),In("/tmp"),In("/home"),In("/home/web_user"),function(){In("/dev"),Wo(259,{read:()=>0,write:(z,ne,Ce,Ie)=>Ie}),uo("/dev/null",259),Ct(1280,wr),Ct(1536,Gt),uo("/dev/tty",1280),uo("/dev/tty1",1536);var y=new Uint8Array(1024),k=0,I=()=>(k===0&&(k=Ve(y).byteLength),y[--k]);ho("random",I),ho("urandom",I),In("/dev/shm"),In("/dev/shm/tmp")}(),function(){In("/proc");var y=In("/proc/self");In("/proc/self/fd"),ki({Ra(){var k=Bt(y,"fd",16895,73);return k.Ga={lookup(I,z){var ne=on(+z);return I={parent:null,Ra:{tb:"fake"},Ga:{readlink:()=>ne.path}},I.parent=I}},k}},"/proc/self/fd")}();var So={a:(y,k,I,z)=>{V(`Assertion failed: ${y?re(le,y):""}, at: `+[k?k?re(le,k):"":"unknown filename",I,z?z?re(le,z):"":"unknown function"])},h:function(y,k){try{return y=y?re(le,y):"",fo(y,k),0}catch(I){if(typeof Et>"u"||I.name!=="ErrnoError")throw I;return-I.Ka}},H:function(y,k,I){try{if(k=k?re(le,k):"",k=Cr(y,k),I&-8)return-28;var z=Xe(k,{Sa:!0}).node;return z?(y="",I&4&&(y+="r"),I&2&&(y+="w"),I&1&&(y+="x"),y&&rn(z,y)?-2:0):-44}catch(ne){if(typeof Et>"u"||ne.name!=="ErrnoError")throw ne;return-ne.Ka}},i:function(y,k){try{var I=on(y);return fo(I.node,k),0}catch(z){if(typeof Et>"u"||z.name!=="ErrnoError")throw z;return-z.Ka}},g:function(y){try{var k=on(y).node,I=typeof k=="string"?Xe(k,{Sa:!0}).node:k;if(!I.Ga.Oa)throw new Ee(63);return I.Ga.Oa(I,{timestamp:Date.now()}),0}catch(z){if(typeof Et>"u"||z.name!=="ErrnoError")throw z;return-z.Ka}},b:function(y,k,I){jr=I;try{var z=on(y);switch(k){case 0:var ne=yo();if(0>ne)return-28;for(;$t[ne];)ne++;return lr(z,ne).fd;case 1:case 2:return 0;case 3:return z.flags;case 4:return ne=yo(),z.flags|=ne,0;case 5:return ne=yo(),Q[ne+0>>1]=2,0;case 6:case 7:return 0;case 16:case 8:return-28;case 9:return Y[Ai()>>2]=28,-1;default:return-28}}catch(Ce){if(typeof Et>"u"||Ce.name!=="ErrnoError")throw Ce;return-Ce.Ka}},f:function(y,k){try{var I=on(y);return Ko(co,I.path,k)}catch(z){if(typeof Et>"u"||z.name!=="ErrnoError")throw z;return-z.Ka}},n:function(y,k,I){k=Sr(k,I);try{if(isNaN(k))return 61;var z=on(y);if((z.flags&2097155)===0)throw new Ee(28);return mo(z.node,k),0}catch(ne){if(typeof Et>"u"||ne.name!=="ErrnoError")throw ne;return-ne.Ka}},C:function(y,k){try{if(k===0)return-28;var I=Nt("/")+1;return k<I?-68:(kt("/",le,y,k),I)}catch(z){if(typeof Et>"u"||z.name!=="ErrnoError")throw z;return-z.Ka}},F:function(y,k){try{return y=y?re(le,y):"",Ko(Yo,y,k)}catch(I){if(typeof Et>"u"||I.name!=="ErrnoError")throw I;return-I.Ka}},z:function(y,k,I){try{return k=k?re(le,k):"",k=Cr(y,k),k=me(k),k[k.length-1]==="/"&&(k=k.substr(0,k.length-1)),In(k,I),0}catch(z){if(typeof Et>"u"||z.name!=="ErrnoError")throw z;return-z.Ka}},E:function(y,k,I,z){try{k=k?re(le,k):"";var ne=z&256;return k=Cr(y,k,z&4096),Ko(ne?Yo:co,k,I)}catch(Ce){if(typeof Et>"u"||Ce.name!=="ErrnoError")throw Ce;return-Ce.Ka}},y:function(y,k,I,z){jr=z;try{k=k?re(le,k):"",k=Cr(y,k);var ne=z?yo():0;return Lr(k,I,ne).fd}catch(Ce){if(typeof Et>"u"||Ce.name!=="ErrnoError")throw Ce;return-Ce.Ka}},w:function(y,k,I,z){try{if(k=k?re(le,k):"",k=Cr(y,k),0>=z)return-28;var ne=Pt(k),Ce=Math.min(z,Nt(ne)),Ie=Z[I+Ce];return kt(ne,le,I,z+1),Z[I+Ce]=Ie,Ce}catch(rt){if(typeof Et>"u"||rt.name!=="ErrnoError")throw rt;return-rt.Ka}},v:function(y){try{return y=y?re(le,y):"",Ti(y),0}catch(k){if(typeof Et>"u"||k.name!=="ErrnoError")throw k;return-k.Ka}},G:function(y,k){try{return y=y?re(le,y):"",Ko(co,y,k)}catch(I){if(typeof Et>"u"||I.name!=="ErrnoError")throw I;return-I.Ka}},r:function(y,k,I){try{return k=k?re(le,k):"",k=Cr(y,k),I===0?_i(k):I===512?Ti(k):V("Invalid flags passed to unlinkat"),0}catch(z){if(typeof Et>"u"||z.name!=="ErrnoError")throw z;return-z.Ka}},q:function(y,k,I){try{if(k=k?re(le,k):"",k=Cr(y,k,!0),I){var z=M[I>>2]+4294967296*Y[I+4>>2],ne=Y[I+8>>2];Ce=1e3*z+ne/1e6,I+=16,z=M[I>>2]+4294967296*Y[I+4>>2],ne=Y[I+8>>2],Ie=1e3*z+ne/1e6}else var Ce=Date.now(),Ie=Ce;y=Ce;var rt=Xe(k,{Sa:!0}).node;return rt.Ga.Oa(rt,{timestamp:Math.max(y,Ie)}),0}catch(gt){if(typeof Et>"u"||gt.name!=="ErrnoError")throw gt;return-gt.Ka}},l:function(y,k,I){y=new Date(1e3*Sr(y,k)),Y[I>>2]=y.getSeconds(),Y[I+4>>2]=y.getMinutes(),Y[I+8>>2]=y.getHours(),Y[I+12>>2]=y.getDate(),Y[I+16>>2]=y.getMonth(),Y[I+20>>2]=y.getFullYear()-1900,Y[I+24>>2]=y.getDay(),k=y.getFullYear(),Y[I+28>>2]=(k%4!==0||k%100===0&&k%400!==0?nl:vo)[y.getMonth()]+y.getDate()-1|0,Y[I+36>>2]=-(60*y.getTimezoneOffset()),k=new Date(y.getFullYear(),6,1).getTimezoneOffset();var z=new Date(y.getFullYear(),0,1).getTimezoneOffset();Y[I+32>>2]=(k!=z&&y.getTimezoneOffset()==Math.min(z,k))|0},j:function(y,k,I,z,ne,Ce,Ie,rt){ne=Sr(ne,Ce);try{if(isNaN(ne))return 61;var gt=on(z);if((k&2)!==0&&(I&2)===0&&(gt.flags&2097155)!==2)throw new Ee(2);if((gt.flags&2097155)===1)throw new Ee(2);if(!gt.Ha.bb)throw new Ee(43);var it=gt.Ha.bb(gt,y,ne,k,I),Ft=it.Db;return Y[Ie>>2]=it.ub,M[rt>>2]=Ft,0}catch(Ut){if(typeof Et>"u"||Ut.name!=="ErrnoError")throw Ut;return-Ut.Ka}},k:function(y,k,I,z,ne,Ce,Ie){Ce=Sr(Ce,Ie);try{if(isNaN(Ce))return 61;var rt=on(ne);if(I&2){if((rt.node.mode&61440)!==32768)throw new Ee(43);if(!(z&2)){var gt=le.slice(y,y+k);rt.Ha.cb&&rt.Ha.cb(rt,gt,Ce,k,z)}}}catch(it){if(typeof Et>"u"||it.name!=="ErrnoError")throw it;return-it.Ka}},s:(y,k,I)=>{function z(gt){return(gt=gt.toTimeString().match(/\(([A-Za-z ]+)\)$/))?gt[1]:"GMT"}var ne=new Date().getFullYear(),Ce=new Date(ne,0,1),Ie=new Date(ne,6,1);ne=Ce.getTimezoneOffset();var rt=Ie.getTimezoneOffset();M[y>>2]=60*Math.max(ne,rt),Y[k>>2]=+(ne!=rt),y=z(Ce),k=z(Ie),y=Zo(y),k=Zo(k),rt<ne?(M[I>>2]=y,M[I+4>>2]=k):(M[I>>2]=k,M[I+4>>2]=y)},d:()=>Date.now(),t:()=>2147483648,c:()=>performance.now(),o:y=>{var k=le.length;if(y>>>=0,2147483648<y)return!1;for(var I=1;4>=I;I*=2){var z=k*(1+.2/I);z=Math.min(z,y+100663296);var ne=Math;z=Math.max(y,z);e:{ne=(ne.min.call(ne,2147483648,z+(65536-z%65536)%65536)-oe.buffer.byteLength+65535)/65536;try{oe.grow(ne),ve();var Ce=1;break e}catch{}Ce=void 0}if(Ce)return!0}return!1},A:(y,k)=>{var I=0;return Rs().forEach((z,ne)=>{var Ce=k+I;for(ne=M[y+4*ne>>2]=Ce,Ce=0;Ce<z.length;++Ce)Z[ne++>>0]=z.charCodeAt(Ce);Z[ne>>0]=0,I+=z.length+1}),0},B:(y,k)=>{var I=Rs();M[y>>2]=I.length;var z=0;return I.forEach(ne=>z+=ne.length+1),M[k>>2]=z,0},e:function(y){try{var k=on(y);return Qo(k),0}catch(I){if(typeof Et>"u"||I.name!=="ErrnoError")throw I;return I.Ka}},p:function(y,k){try{var I=on(y);return Z[k>>0]=I.tty?2:ht(I.mode)?3:(I.mode&61440)===40960?7:4,Q[k+2>>1]=0,E=[0,(De=0,1<=+Math.abs(De)?0<De?+Math.floor(De/4294967296)>>>0:~~+Math.ceil((De-+(~~De>>>0))/4294967296)>>>0:0)],Y[k+8>>2]=E[0],Y[k+12>>2]=E[1],E=[0,(De=0,1<=+Math.abs(De)?0<De?+Math.floor(De/4294967296)>>>0:~~+Math.ceil((De-+(~~De>>>0))/4294967296)>>>0:0)],Y[k+16>>2]=E[0],Y[k+20>>2]=E[1],0}catch(z){if(typeof Et>"u"||z.name!=="ErrnoError")throw z;return z.Ka}},x:function(y,k,I,z){try{e:{var ne=on(y);y=k;for(var Ce,Ie=k=0;Ie<I;Ie++){var rt=M[y>>2],gt=M[y+4>>2];y+=8;var it=An(ne,Z,rt,gt,Ce);if(0>it){var Ft=-1;break e}if(k+=it,it<gt)break;typeof Ce<"u"&&(Ce+=it)}Ft=k}return M[z>>2]=Ft,0}catch(Ut){if(typeof Et>"u"||Ut.name!=="ErrnoError")throw Ut;return Ut.Ka}},m:function(y,k,I,z,ne){k=Sr(k,I);try{if(isNaN(k))return 61;var Ce=on(y);return po(Ce,k,z),E=[Ce.position>>>0,(De=Ce.position,1<=+Math.abs(De)?0<De?+Math.floor(De/4294967296)>>>0:~~+Math.ceil((De-+(~~De>>>0))/4294967296)>>>0:0)],Y[ne>>2]=E[0],Y[ne+4>>2]=E[1],Ce.hb&&k===0&&z===0&&(Ce.hb=null),0}catch(Ie){if(typeof Et>"u"||Ie.name!=="ErrnoError")throw Ie;return Ie.Ka}},D:function(y){var I;try{var k=on(y);return(I=k.Ha)!=null&&I.fsync?k.Ha.fsync(k):0}catch(z){if(typeof Et>"u"||z.name!=="ErrnoError")throw z;return z.Ka}},u:function(y,k,I,z){try{e:{var ne=on(y);y=k;for(var Ce,Ie=k=0;Ie<I;Ie++){var rt=M[y>>2],gt=M[y+4>>2];y+=8;var it=Ei(ne,Z,rt,gt,Ce);if(0>it){var Ft=-1;break e}k+=it,typeof Ce<"u"&&(Ce+=it)}Ft=k}return M[z>>2]=Ft,0}catch(Ut){if(typeof Et>"u"||Ut.name!=="ErrnoError")throw Ut;return Ut.Ka}}},He=function(){var I;function y(z){var ne;return He=z.exports,oe=He.I,ve(),Xt=He.Aa,te.unshift(He.J),j--,(ne=p.monitorRunDependencies)==null||ne.call(p,j),j==0&&O&&(z=O,O=null,z()),He}var k={a:So};if(j++,(I=p.monitorRunDependencies)==null||I.call(p,j),p.instantiateWasm)try{return p.instantiateWasm(k,y)}catch(z){return G(`Module.instantiateWasm callback failed with error: ${z}`),!1}return je(k,function(z){y(z.instance)}),{}}();p._sqlite3_free=y=>(p._sqlite3_free=He.K)(y),p._sqlite3_value_text=y=>(p._sqlite3_value_text=He.L)(y);var Ai=()=>(Ai=He.M)();p._sqlite3_prepare_v2=(y,k,I,z,ne)=>(p._sqlite3_prepare_v2=He.N)(y,k,I,z,ne),p._sqlite3_step=y=>(p._sqlite3_step=He.O)(y),p._sqlite3_reset=y=>(p._sqlite3_reset=He.P)(y),p._sqlite3_exec=(y,k,I,z,ne)=>(p._sqlite3_exec=He.Q)(y,k,I,z,ne),p._sqlite3_finalize=y=>(p._sqlite3_finalize=He.R)(y),p._sqlite3_column_name=(y,k)=>(p._sqlite3_column_name=He.S)(y,k),p._sqlite3_column_text=(y,k)=>(p._sqlite3_column_text=He.T)(y,k),p._sqlite3_column_type=(y,k)=>(p._sqlite3_column_type=He.U)(y,k),p._sqlite3_errmsg=y=>(p._sqlite3_errmsg=He.V)(y),p._sqlite3_clear_bindings=y=>(p._sqlite3_clear_bindings=He.W)(y),p._sqlite3_value_blob=y=>(p._sqlite3_value_blob=He.X)(y),p._sqlite3_value_bytes=y=>(p._sqlite3_value_bytes=He.Y)(y),p._sqlite3_value_double=y=>(p._sqlite3_value_double=He.Z)(y),p._sqlite3_value_int=y=>(p._sqlite3_value_int=He._)(y),p._sqlite3_value_type=y=>(p._sqlite3_value_type=He.$)(y),p._sqlite3_result_blob=(y,k,I,z)=>(p._sqlite3_result_blob=He.aa)(y,k,I,z),p._sqlite3_result_double=(y,k)=>(p._sqlite3_result_double=He.ba)(y,k),p._sqlite3_result_error=(y,k,I)=>(p._sqlite3_result_error=He.ca)(y,k,I),p._sqlite3_result_int=(y,k)=>(p._sqlite3_result_int=He.da)(y,k),p._sqlite3_result_int64=(y,k,I)=>(p._sqlite3_result_int64=He.ea)(y,k,I),p._sqlite3_result_null=y=>(p._sqlite3_result_null=He.fa)(y),p._sqlite3_result_text=(y,k,I,z)=>(p._sqlite3_result_text=He.ga)(y,k,I,z),p._sqlite3_aggregate_context=(y,k)=>(p._sqlite3_aggregate_context=He.ha)(y,k),p._sqlite3_column_count=y=>(p._sqlite3_column_count=He.ia)(y),p._sqlite3_data_count=y=>(p._sqlite3_data_count=He.ja)(y),p._sqlite3_column_blob=(y,k)=>(p._sqlite3_column_blob=He.ka)(y,k),p._sqlite3_column_bytes=(y,k)=>(p._sqlite3_column_bytes=He.la)(y,k),p._sqlite3_column_double=(y,k)=>(p._sqlite3_column_double=He.ma)(y,k),p._sqlite3_bind_blob=(y,k,I,z,ne)=>(p._sqlite3_bind_blob=He.na)(y,k,I,z,ne),p._sqlite3_bind_double=(y,k,I)=>(p._sqlite3_bind_double=He.oa)(y,k,I),p._sqlite3_bind_int=(y,k,I)=>(p._sqlite3_bind_int=He.pa)(y,k,I),p._sqlite3_bind_text=(y,k,I,z,ne)=>(p._sqlite3_bind_text=He.qa)(y,k,I,z,ne),p._sqlite3_bind_parameter_index=(y,k)=>(p._sqlite3_bind_parameter_index=He.ra)(y,k),p._sqlite3_sql=y=>(p._sqlite3_sql=He.sa)(y),p._sqlite3_normalized_sql=y=>(p._sqlite3_normalized_sql=He.ta)(y),p._sqlite3_changes=y=>(p._sqlite3_changes=He.ua)(y),p._sqlite3_close_v2=y=>(p._sqlite3_close_v2=He.va)(y),p._sqlite3_create_function_v2=(y,k,I,z,ne,Ce,Ie,rt,gt)=>(p._sqlite3_create_function_v2=He.wa)(y,k,I,z,ne,Ce,Ie,rt,gt),p._sqlite3_open=(y,k)=>(p._sqlite3_open=He.xa)(y,k);var ko=p._malloc=y=>(ko=p._malloc=He.ya)(y),ur=p._free=y=>(ur=p._free=He.za)(y);p._RegisterExtensionFunctions=y=>(p._RegisterExtensionFunctions=He.Ba)(y);var Di=(y,k)=>(Di=He.Ca)(y,k),Or=()=>(Or=He.Da)(),cr=y=>(cr=He.Ea)(y),Zn=y=>(Zn=He.Fa)(y);p.stackAlloc=Zn,p.stackSave=Or,p.stackRestore=cr,p.cwrap=(y,k,I,z)=>{var ne=!I||I.every(Ce=>Ce==="number"||Ce==="boolean");return k!=="string"&&ne&&!z?p["_"+y]:function(){return Ii(y,k,I,arguments)}},p.addFunction=Mn,p.removeFunction=vn,p.UTF8ToString=Te,p.ALLOC_NORMAL=wo,p.allocate=Co,p.allocateUTF8OnStack=xo;var es;O=function y(){es||Br(),es||(O=y)};function Br(){function y(){if(!es&&(es=!0,p.calledRun=!0,!J)){if(p.noFSInit||Ni||(Ni=!0,bi(),p.stdin=p.stdin,p.stdout=p.stdout,p.stderr=p.stderr,p.stdin?ho("stdin",p.stdin):Jo("/dev/tty","/dev/stdin"),p.stdout?ho("stdout",null,p.stdout):Jo("/dev/tty","/dev/stdout"),p.stderr?ho("stderr",null,p.stderr):Jo("/dev/tty1","/dev/stderr"),Lr("/dev/stdin",0),Lr("/dev/stdout",1),Lr("/dev/stderr",1)),Je=!1,fe(te),p.onRuntimeInitialized&&p.onRuntimeInitialized(),p.postRun)for(typeof p.postRun=="function"&&(p.postRun=[p.postRun]);p.postRun.length;){var k=p.postRun.shift();q.unshift(k)}fe(q)}}if(!(0<j)){if(p.preRun)for(typeof p.preRun=="function"&&(p.preRun=[p.preRun]);p.preRun.length;)N();fe(xe),0<j||(p.setStatus?(p.setStatus("Running..."),setTimeout(function(){setTimeout(function(){p.setStatus("")},1),y()},1)):y())}}if(p.preInit)for(typeof p.preInit=="function"&&(p.preInit=[p.preInit]);0<p.preInit.length;)p.preInit.pop()();return Br(),m}),n)};t.exports=o,t.exports.default=o}($u)),$u.exports}var Ay=Iy();const Dy=yi(Ay);function lc(t){return new Promise((e,n)=>{const o=new URL("/services/ankiImport.worker.ts",window.location.origin),i=new Worker(o,{type:"module"});i.onmessage=c=>{const{status:f,decks:m,error:h}=c.data;f==="success"?e(m):n(new Error(h)),i.terminate()},i.onerror=c=>{console.error("Worker error:",c);const f=c.message||"The worker script could not be loaded or an unexpected error occurred.";n(new Error(`Anki import worker failed: ${f}`)),i.terminate()},i.postMessage(t,[t])})}let Wu=null;async function My(){return Wu||(Wu=await Dy({locateFile:t=>`https://esm.sh/sql.js@1.10.3/dist/${t}`})),Wu}function Zf(t,e){let n=t;return n=n.replace(/<img\s[^>]*?src=(["'])(.*?)\1[^>]*?>/gi,(o,i,c)=>{const f=decodeURIComponent(c),m=e.get(f);if(m){const h=btoa(new Uint8Array(m.data).reduce((v,x)=>v+String.fromCharCode(x),"")),p=`src="data:${m.type};base64,${h}"`;return o.replace(/src=(["']).*?\1/i,p)}return o}),n=n.replace(/\[sound:(.*?)\]/g,(o,i)=>{const c=decodeURIComponent(i.trim()),f=e.get(c);if(f){const m=btoa(new Uint8Array(f.data).reduce((h,p)=>h+String.fromCharCode(p),""));return f.type.startsWith("video/")?`<video controls playsinline src="data:${f.type};base64,${m}"></video>`:`<audio controls src="data:${f.type};base64,${m}"></audio>`}return""}),n}function Xf(t,e,n,o,i){let c=t;const f=/{{c(\d+)::(.*?)(?:::(.*?))?}}/gs;c=c.replace(f,(v,x,C,S)=>{const b=parseInt(x,10);return o?b===n+1?`<span class="cloze">[${S||"..."}]</span>`:`<span class="cloze-inactive">${C}</span>`:b===n+1?`<span class="cloze"><b>${C}</b></span>`:`<span class="cloze-inactive">${C}</span>`}),i&&(c=c.replace(/<hr id=answer>/g,"").replace(/{{FrontSide}}/g,i));const m=/{{#([^}]+?)}}(.*?){{\/\1}}/gs;let h;do h=c,c=c.replace(m,(v,x,C)=>{const S=e.get(x.trim());return S&&S.trim()!==""?C:""});while(c!==h);const p=/{{\^([^}]+?)}}(.*?){{\/\1}}/gs;do h=c,c=c.replace(p,(v,x,C)=>{const S=e.get(x.trim());return!S||S.trim()===""?C:""});while(c!==h);return e.forEach((v,x)=>{const C=new RegExp(`{{${x}}}`,"g");c=c.replace(C,v)}),c=c.replace(/{{(.*?)}}/g,""),c}async function Ry(t){var R;const e=await My(),n=await Ey.loadAsync(t),o=n.file(/collection.anki2[1]?/);if(!o||o.length===0)throw new Error("collection.anki2 or .anki21 file not found.");const i=await o[0].async("uint8array"),c=new e.Database(i),f=n.file("media");let m={};if(f)try{m=JSON.parse(await f.async("string"))}catch(P){console.warn("Could not parse media file.",P)}const h=new Map;for(const P in m){const G=m[P],$=n.file(P);if($){const oe=await $.async("uint8array"),J=((R=G.split(".").pop())==null?void 0:R.toLowerCase())||"";let Z="application/octet-stream";["jpg","jpeg"].includes(J)?Z="image/jpeg":J==="png"?Z="image/png":J==="gif"?Z="image/gif":J==="svg"?Z="image/svg+xml":J==="mp3"?Z="audio/mpeg":J==="ogg"?Z="audio/ogg":J==="wav"?Z="audio/wav":J==="m4a"?Z="audio/mp4":J==="opus"?Z="audio/opus":J==="mp4"?Z="video/mp4":J==="webm"?Z="video/webm":J==="ogv"&&(Z="video/ogg"),h.set(G,{data:oe,type:Z})}}const p=c.exec("SELECT models, decks, crt FROM col");if(!p[0])throw new Error("Could not read collection data.");const[v,x,C]=p[0].values[0],S=JSON.parse(v),b=JSON.parse(x),T=c.exec("SELECT id, mid, flds FROM notes"),A=new Map(T[0].values.map(P=>[P[0],{mid:P[1],flds:P[2].split("")}])),F=c.exec("SELECT id, nid, did, ord, due, ivl, factor, type, lapses FROM cards")[0].values,L=new Map;for(const P in b){const G=b[P];L.set(P,{id:crypto.randomUUID(),name:G.name,description:G.desc||"Imported Anki deck.",type:We.Flashcard,cards:[]})}for(const P of F){const[G,$,oe,J,Z,le,Q,Y,M]=P,pe=A.get($);if(!pe)continue;const be=S[pe.mid];if(!(be!=null&&be.tmpls))continue;const ve=L.get(oe.toString());if(!ve)continue;const xe=be.tmpls[J];if(!xe)continue;const te=new Map((be.flds||[]).map((K,X)=>[K.name,pe.flds[X]||""]));let q=Xf(xe.qfmt,te,J,!0),N=Xf(xe.afmt,te,J,!1,q);q=Zf(q,h),N=Zf(N,h);let j,O;Y===2&&le>0?(j=new Date(C*1e3),j.setDate(j.getDate()+Z),O=new Date(j.getTime()),O.setDate(O.getDate()-le)):(j=new Date,j.setHours(0,0,0,0));const V=Math.min(1,Math.log1p(le)/Math.log1p(90));ve.cards.push({id:G.toString(),front:q,back:N,css:be.css?`<style>${be.css}</style>`:"",dueDate:j.toISOString(),interval:le,easeFactor:Q?Math.max(Q/1e3,ic):Oo,masteryLevel:V,lastReviewed:O==null?void 0:O.toISOString(),lapses:M||0})}return c.close(),Array.from(L.values()).filter(P=>P.cards.length>0)}const Py=({isOpen:t,onClose:e,onAddDecks:n,onAddSeriesWithDecks:o})=>{const[i,c]=B.useState("create"),[f,m]=B.useState(""),[h,p]=B.useState(""),[v,x]=B.useState(""),[C,S]=B.useState(!1),b=B.useRef(null),{addToast:T}=gn(),A=B.useRef(null);Un(A,t);const D=B.useCallback(()=>{c("create"),m(""),p(""),x(""),S(!1)},[]),F=B.useCallback(()=>{D(),e()},[D,e]),L=B.useCallback(J=>{p(J);try{const Z=ac(J);(Z==null?void 0:Z.type)===We.Quiz?m(Z.data.name):(Z==null?void 0:Z.type)==="quiz_series"&&m(Z.data.seriesName)}catch{}},[]),R=B.useCallback(async J=>{if(J){x(J.name),S(!0);try{if(J.name.toLowerCase().endsWith(".apkg")){m("");const Z=await J.arrayBuffer(),le=Z.slice(0);let Q=[];try{Q=await lc(Z)}catch(Y){console.warn("Anki worker failed, trying main thread fallback:",Y),T("Import via worker failed. Trying a slower fallback method... this may freeze the app.","info");try{Q=await Ry(le)}catch(M){throw console.error("Anki main thread fallback also failed:",M),M}}Q.length>0?(n(Q),T(`Successfully imported ${Q.length} deck(s) from ${J.name}.`,"success"),F()):(T("No valid decks found in the Anki package.","info"),D())}else if(J.name.toLowerCase().endsWith(".json")){const Z=await J.text();L(Z),S(!1),T("File loaded. Confirm name and import, or paste content directly.","info")}else T("Unsupported file type. Please upload a '.json' or '.apkg' file.","error"),x(""),S(!1)}catch(Z){console.error("Failed to process file:",Z),T(`An error occurred: ${Z instanceof Error?Z.message:"Unknown error"}`,"error"),D()}}},[T,F,L,n,D]),P=B.useCallback(()=>{if(i==="create"){if(!f.trim()){T("Please enter a deck name.","error");return}const J={id:crypto.randomUUID(),name:f.trim(),type:We.Flashcard,cards:[],description:`An empty deck created on ${Gg()}`};n([J]),T(`Deck "${J.name}" created.`,"success"),F();return}if(!h){T("Please paste or upload content.","error");return}try{const J=ac(h);if(!J)return;if(J.type==="quiz_series"){const{seriesName:le,seriesDescription:Q,levels:Y}=J.data,M=[],pe=Y.map(ve=>{const xe=ve.decks.map(te=>({id:crypto.randomUUID(),name:te.name,description:te.description,type:We.Quiz,questions:io(te.questions)}));return M.push(...xe),{title:ve.title,deckIds:xe.map(te=>te.id)}}),be={id:crypto.randomUUID(),type:"series",name:le,description:Q,levels:pe,archived:!1,createdAt:new Date().toISOString()};o(be,M),F();return}if(!f.trim()){T("Please enter a deck name.","error");return}let Z;if(J.type===We.Flashcard){const le=Ec(J.data);Z={id:crypto.randomUUID(),name:f.trim(),type:We.Flashcard,cards:le,description:`${le.length} imported flashcard${le.length===1?"":"s"}.`}}else{const le=io(J.data.questions);Z={id:crypto.randomUUID(),name:f.trim(),description:J.data.description,type:We.Quiz,questions:le}}n([Z]),T(`Deck "${Z.name}" imported successfully.`,"success"),F()}catch(J){T(J instanceof Error?J.message:"Invalid JSON content.","error")}},[f,i,h,n,F,T,o]),G=J=>{var le;const Z=(le=J.target.files)==null?void 0:le[0];Z&&R(Z),J.target&&(J.target.value="")};if(!t)return null;const $=()=>{const J=v.toLowerCase().endsWith(".apkg");if(i==="upload"&&J)return u.jsx("div",{className:"text-text-muted text-center py-12",children:"Anki file selected. Decks will be imported automatically."});switch(i){case"paste":return u.jsxs("div",{children:[u.jsx("textarea",{className:"w-full h-48 p-2 bg-background border border-border rounded-md focus:ring-2 focus:ring-primary focus:outline-none text-text",placeholder:'Paste JSON here... e.g., [{"front": "Q1", "back": "A1"}] or a Quiz/Series object.',value:h,onChange:Z=>L(Z.target.value)}),u.jsxs(Ot,{href:"/instructions/json",onClick:e,className:"text-sm text-primary hover:underline mt-2 inline-flex items-center gap-1",children:[u.jsx(de,{name:"help-circle",className:"w-4 h-4"}),"View JSON format guide"]})]});case"upload":return u.jsxs(u.Fragment,{children:[u.jsx("input",{type:"file",ref:b,className:"hidden",accept:".json,application/json,.apkg,application/zip,application/x-zip-compressed,application/octet-stream",onChange:G}),u.jsxs("label",{className:"flex flex-col items-center justify-center w-full h-48 border-2 border-dashed border-border rounded-lg cursor-pointer hover:bg-background transition-colors",children:[u.jsx(de,{name:"upload-cloud",className:"w-10 h-10 text-text-muted mb-2"}),u.jsxs("p",{className:"text-sm text-text-muted",children:[u.jsx("span",{className:"font-semibold text-primary",onClick:Z=>{var le;Z.preventDefault(),(le=b.current)==null||le.click()},children:"Click to upload"})," or drag and drop anywhere"]}),u.jsx("p",{className:"text-xs text-text-muted/70",children:"JSON or Anki Package (.apkg)"}),v&&u.jsx("p",{className:"text-sm text-green-500 dark:text-green-400 mt-2 truncate",title:v,children:v})]})]});case"create":default:return u.jsx("p",{className:"text-text-muted text-center py-12",children:"Create an empty flashcard deck."})}},oe=!(i==="upload"&&v.toLowerCase().endsWith(".apkg"));return u.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50 p-4",children:u.jsxs("div",{ref:A,className:"bg-surface rounded-lg shadow-xl w-full max-w-lg overflow-hidden transform transition-all relative",children:[C&&u.jsxs("div",{className:"absolute inset-0 bg-surface/80 flex flex-col items-center justify-center z-20",children:[u.jsx(Ln,{}),u.jsx("p",{className:"text-lg text-text mt-4",children:"Processing file..."})]}),u.jsxs("div",{className:"flex justify-between items-center p-4 border-b border-border",children:[u.jsx("h2",{className:"text-xl font-bold text-text",children:"Create / Import"}),u.jsx(Se,{variant:"ghost",onClick:F,className:"p-1 h-auto",children:u.jsx(de,{name:"x"})})]}),u.jsxs("div",{className:"p-6 space-y-4",children:[oe&&u.jsxs("div",{children:[u.jsx("label",{htmlFor:"deck-name",className:"block text-sm font-medium text-text-muted mb-1",children:"Deck / Series Name"}),u.jsx("input",{type:"text",id:"deck-name",value:f,onChange:J=>m(J.target.value),className:"w-full p-2 bg-background border border-border rounded-md focus:ring-2 focus:ring-primary focus:outline-none",placeholder:"e.g. Japanese Vocabulary"}),u.jsx("p",{className:"text-xs text-text-muted mt-1",children:"For single deck or new deck creation. This is auto-filled when pasting a Series object."})]}),u.jsx("div",{className:"flex border-b border-border",children:["create","paste","upload"].map(J=>u.jsx("button",{onClick:()=>c(J),className:`capitalize px-4 py-2 text-sm font-medium transition-colors ${i===J?"border-b-2 border-primary text-text":"text-text-muted hover:text-text"}`,children:J==="create"?"Create Empty":J},J))}),u.jsx("div",{className:"mt-4",children:$()})]}),u.jsxs("div",{className:"flex justify-end p-4 bg-background/50 border-t border-border",children:[u.jsx(Se,{variant:"secondary",onClick:F,className:"mr-2",children:"Cancel"}),u.jsx(Se,{variant:"primary",onClick:P,disabled:C||i==="create"&&!f.trim()||i!=="create"&&!h&&!v,children:i==="create"?"Create Deck":"Import"})]})]})})},Qa=({isOpen:t,onClose:e,onConfirm:n,title:o,message:i,confirmText:c})=>{const[f,m]=B.useState(""),h=B.useRef(null);Un(h,t),B.useEffect(()=>{t&&m("")},[t]);const p=!c||f===c,v=()=>{p&&(n(),e())};return t?u.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50 p-4",children:u.jsxs("div",{ref:h,className:"bg-surface rounded-lg shadow-xl w-full max-w-md transform transition-all relative",role:"alertdialog","aria-modal":"true","aria-labelledby":"confirm-title","aria-describedby":"confirm-message",children:[u.jsxs("div",{className:"flex justify-between items-center p-4 border-b border-border",children:[u.jsx("h2",{id:"confirm-title",className:"text-xl font-bold text-text",children:o}),u.jsx(Se,{type:"button",variant:"ghost",onClick:e,className:"p-1 h-auto","aria-label":"Close",children:u.jsx(de,{name:"x"})})]}),u.jsxs("div",{className:"p-6 space-y-4",children:[u.jsx("p",{id:"confirm-message",className:"text-text-muted",children:i}),c&&u.jsxs("div",{children:[u.jsxs("label",{htmlFor:"confirm-input",className:"block text-sm font-medium text-text-muted mb-1",children:['To confirm, type "',u.jsx("strong",{className:"text-text",children:c}),'" below:']}),u.jsx("input",{id:"confirm-input",type:"text",value:f,onChange:x=>m(x.target.value),className:"w-full p-2 bg-background border border-border rounded-md focus:ring-2 focus:ring-red-500 focus:outline-none"})]})]}),u.jsxs("div",{className:"flex justify-end p-4 bg-background/50 border-t border-border",children:[u.jsx(Se,{type:"button",variant:"secondary",onClick:e,className:"mr-2",children:"Cancel"}),u.jsx(Se,{type:"button",variant:"danger",onClick:v,disabled:!p,children:"Confirm"})]})]})}):null},Fy=({isOpen:t,onClose:e,onRestore:n})=>{const[o,i]=B.useState(""),[c,f]=B.useState(null),[m,h]=B.useState(null),[p,v]=B.useState(!1),x=B.useRef(null),{addToast:C}=gn(),S=B.useRef(null);Un(S,t);const b=()=>{i(""),f(null),h(null),e()},T=async R=>{if(R){i(R.name),h(null),f("Processing file...");try{if(R.name.toLowerCase().endsWith(".json")){const P=await R.text(),G=Gp(P);h(G),C(`Backup file "${R.name}" is valid and ready to restore.`,"success")}else C("Unsupported file type. Please upload a '.json' backup file.","error"),i("")}catch(P){console.error("Failed to process file:",P),C(`Restore failed: ${P instanceof Error?P.message:"Unknown error"}`,"error"),i("")}finally{f(null)}}},A=R=>{var G;if(c)return;const P=(G=R.target.files)==null?void 0:G[0];P&&T(P),R.target&&(R.target.value="")},D=R=>{var G;if(R.preventDefault(),c)return;const P=(G=R.dataTransfer.files)==null?void 0:G[0];P&&T(P)},F=R=>R.preventDefault(),L=async()=>{if(m){v(!1),f("Restoring data...");try{await n(m),b()}catch{f(null)}}};return t?u.jsxs(u.Fragment,{children:[u.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50 p-4",children:u.jsxs("div",{ref:S,className:"bg-surface rounded-lg shadow-xl w-full max-w-lg overflow-hidden transform transition-all relative",children:[c&&u.jsxs("div",{className:"absolute inset-0 bg-surface/80 flex flex-col items-center justify-center z-20",children:[u.jsx(Ln,{}),u.jsx("p",{className:"text-lg text-text mt-4",children:c})]}),u.jsxs("div",{className:"flex justify-between items-center p-4 border-b border-border",children:[u.jsx("h2",{className:"text-xl font-bold",children:"Restore from Backup"}),u.jsx(Se,{variant:"ghost",onClick:b,className:"p-1 h-auto",disabled:!!c,children:u.jsx(de,{name:"x"})})]}),u.jsxs("div",{className:"p-6 space-y-4",children:[u.jsx("div",{className:"bg-red-900/20 border border-red-500/30 rounded-lg p-4 text-sm text-red-700 dark:text-red-200",children:u.jsxs("p",{children:[u.jsx("strong",{className:"font-bold",children:"Warning:"})," Restoring from a backup will merge and overwrite data. Decks and folders with the same ID will be replaced. This action cannot be undone."]})}),u.jsx("input",{type:"file",ref:x,className:"hidden",accept:".json,application/json",onChange:A,disabled:!!c}),u.jsxs("label",{onDragOver:F,onDrop:D,className:`flex flex-col items-center justify-center w-full h-48 border-2 border-dashed border-border rounded-lg transition-colors ${c?"cursor-not-allowed opacity-70":"cursor-pointer hover:bg-background"}`,children:[u.jsx(de,{name:"upload-cloud",className:"w-10 h-10 text-text-muted mb-2"}),u.jsxs("p",{className:"text-sm text-text-muted",children:[u.jsx("span",{className:"font-semibold text-primary",onClick:R=>{var P;c||(R.preventDefault(),(P=x.current)==null||P.click())},children:"Click to upload"})," or drag and drop"]}),u.jsx("p",{className:"text-xs text-text-muted/70",children:"CogniFlow Backup JSON file"}),o&&u.jsx("p",{className:`text-sm mt-2 truncate ${m?"text-green-600":"text-red-600"}`,title:o,children:o})]})]}),u.jsxs("div",{className:"flex justify-end p-4 bg-background/50 border-t border-border",children:[u.jsx(Se,{variant:"secondary",onClick:b,className:"mr-2",disabled:!!c,children:"Cancel"}),u.jsx(Se,{variant:"danger",onClick:()=>v(!0),disabled:!m||!!c,children:c?"Please wait...":"Restore"})]})]})}),p&&u.jsx(Qa,{isOpen:p,onClose:()=>v(!1),onConfirm:L,title:"Confirm Restore",message:"Restoring from a backup will overwrite existing decks and folders with the same ID. This action cannot be undone. Are you sure you want to continue?"})]}):null},Ly=({isOpen:t,onClose:e,onReset:n,decks:o})=>{const[i,c]=B.useState(""),[f,m]=B.useState(""),{addToast:h}=gn(),p=B.useRef(null);Un(p,t);const v=B.useMemo(()=>o.find(b=>b.id===i),[o,i]),x=v?f===v.name:!1,C=()=>{if(!x||!v){h("Confirmation text does not match.","error");return}n(v.id),e()},S=()=>{c(""),m(""),e()};return t?u.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50 p-4",children:u.jsxs("div",{ref:p,className:"bg-surface rounded-lg shadow-xl w-full max-w-lg transform transition-all relative",children:[u.jsxs("div",{className:"flex justify-between items-center p-4 border-b border-border",children:[u.jsx("h2",{className:"text-xl font-bold",children:"Reset Deck Progress"}),u.jsx(Se,{type:"button",variant:"ghost",onClick:S,className:"p-1 h-auto",children:u.jsx(de,{name:"x"})})]}),u.jsxs("div",{className:"p-6 space-y-4",children:[u.jsx("div",{className:"bg-red-900/20 border border-red-500/30 rounded-lg p-4 text-sm text-red-700 dark:text-red-200",children:u.jsxs("p",{children:[u.jsx("strong",{className:"font-bold",children:"Warning:"})," This will reset all spaced repetition data (due dates, intervals) for the selected deck. The cards themselves will not be deleted. This action cannot be undone."]})}),u.jsxs("div",{children:[u.jsx("label",{htmlFor:"deck-select",className:"block text-sm font-medium text-text-muted mb-1",children:"Select Deck"}),u.jsxs("select",{id:"deck-select",value:i,onChange:b=>{c(b.target.value),m("")},className:"w-full p-2 bg-background border border-border rounded-md focus:ring-2 focus:ring-primary focus:outline-none",children:[u.jsx("option",{value:"",disabled:!0,children:"-- Select a deck --"}),o.map(b=>u.jsx("option",{value:b.id,children:b.name},b.id))]})]}),v&&u.jsxs("div",{className:"animate-fade-in",children:[u.jsxs("label",{htmlFor:"confirm-text",className:"block text-sm font-medium text-text-muted mb-1",children:['To confirm, type "',u.jsx("strong",{className:"text-text",children:v.name}),'" below:']}),u.jsx("input",{id:"confirm-text",type:"text",value:f,onChange:b=>m(b.target.value),className:"w-full p-2 bg-background border border-border rounded-md focus:ring-2 focus:ring-primary focus:outline-none"})]})]}),u.jsxs("div",{className:"flex justify-end p-4 bg-background/50 border-t border-border",children:[u.jsx(Se,{type:"button",variant:"secondary",onClick:S,className:"mr-2",children:"Cancel"}),u.jsxs(Se,{type:"button",variant:"danger",onClick:C,disabled:!x,children:[u.jsx(de,{name:"refresh-ccw",className:"w-5 h-5 mr-2"}),"Reset Progress"]})]})]})}):null},Uy=({folder:t,onClose:e,onSave:n})=>{const[o,i]=B.useState(""),{addToast:c}=gn(),f=B.useRef(null);Un(f,!0),B.useEffect(()=>{t&&i(t.name)},[t]);const m=h=>{if(h.preventDefault(),!o.trim()){c("Folder name cannot be empty.","error");return}n({id:(t==null?void 0:t.id)||null,name:o.trim()})};return u.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50 p-4",children:u.jsx("div",{ref:f,className:"bg-surface rounded-lg shadow-xl w-full max-w-md transform transition-all relative",children:u.jsxs("form",{onSubmit:m,children:[u.jsxs("div",{className:"flex justify-between items-center p-4 border-b border-border",children:[u.jsx("h2",{className:"text-xl font-bold",children:t?"Edit Folder":"Create New Folder"}),u.jsx(Se,{type:"button",variant:"ghost",onClick:e,className:"p-1 h-auto",children:u.jsx(de,{name:"x"})})]}),u.jsx("div",{className:"p-6 space-y-4",children:u.jsxs("div",{children:[u.jsx("label",{htmlFor:"folder-name",className:"block text-sm font-medium text-text-muted mb-1",children:"Folder Name"}),u.jsx("input",{id:"folder-name",type:"text",value:o,onChange:h=>i(h.target.value),className:"w-full p-2 bg-background border border-border rounded-md focus:ring-2 focus:ring-primary focus:outline-none",placeholder:"e.g., University Courses"})]})}),u.jsxs("div",{className:"flex justify-end p-4 bg-background/50 border-t border-border",children:[u.jsx(Se,{type:"button",variant:"secondary",onClick:e,className:"mr-2",children:"Cancel"}),u.jsxs(Se,{type:"submit",variant:"primary",children:[u.jsx(de,{name:"save",className:"w-4 h-4 mr-2"}),t?"Save Changes":"Create Folder"]})]})]})})})},jy=({series:t,onClose:e,onSave:n})=>{const[o,i]=B.useState(""),[c,f]=B.useState(""),[m,h]=B.useState(null),{addToast:p}=gn(),v=B.useRef(null);Un(v,!0);const x=t===null;B.useEffect(()=>{t?(i(t.name),f(t.description),h(null)):(i(""),f(""),h(null))},[t]);const C=b=>{if(!x)return;const T=b.clipboardData.getData("text");if(T.trim().startsWith("{"))try{const A=JSON.parse(T);typeof A.seriesName=="string"&&typeof A.seriesDescription=="string"&&Array.isArray(A.levels)&&(b.preventDefault(),i(A.seriesName),f(A.seriesDescription),h(A),p("Series details and structure populated from JSON scaffold!","success"))}catch{}},S=b=>{if(b.preventDefault(),!o.trim()){p("Series name cannot be empty.","error");return}n({id:x?null:t.id,name:o.trim(),description:c.trim(),scaffold:x?m:null})};return u.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50 p-4",children:u.jsx("div",{ref:v,className:"bg-surface rounded-lg shadow-xl w-full max-w-lg transform transition-all relative",children:u.jsxs("form",{onSubmit:S,children:[u.jsxs("div",{className:"flex justify-between items-center p-4 border-b border-border",children:[u.jsx("h2",{className:"text-xl font-bold",children:x?"Create New Series":"Edit Series"}),u.jsx(Se,{type:"button",variant:"ghost",onClick:e,className:"p-1 h-auto",children:u.jsx(de,{name:"x"})})]}),u.jsxs("div",{className:"p-6 space-y-4",children:[u.jsxs("div",{children:[u.jsx("label",{htmlFor:"series-name",className:"block text-sm font-medium text-text-muted mb-1",children:"Series Name"}),u.jsx("input",{id:"series-name",type:"text",value:o,onChange:b=>i(b.target.value),onPaste:C,className:"w-full p-2 bg-background border border-border rounded-md focus:ring-2 focus:ring-primary focus:outline-none",placeholder:"e.g., Introduction to Algebra"}),x&&u.jsx("p",{className:"text-xs text-text-muted mt-1",children:"You can paste a full JSON scaffold object here to auto-populate."})]}),u.jsxs("div",{children:[u.jsx("label",{htmlFor:"series-description",className:"block text-sm font-medium text-text-muted mb-1",children:"Description"}),u.jsx("textarea",{id:"series-description",value:c,onChange:b=>f(b.target.value),onPaste:C,rows:3,className:"w-full p-2 bg-background border border-border rounded-md focus:ring-2 focus:ring-primary focus:outline-none",placeholder:"A collection of decks covering core concepts."})]}),x&&m&&u.jsxs("div",{className:"space-y-2 animate-fade-in",children:[u.jsx("h4",{className:"text-sm font-semibold text-text-muted",children:"Structure Preview"}),u.jsx("div",{className:"bg-background border border-border rounded-md p-3 max-h-48 overflow-y-auto text-sm",children:u.jsx("ul",{className:"space-y-3",children:m.levels.map((b,T)=>u.jsxs("li",{children:[u.jsxs("div",{className:"flex items-center gap-2 font-medium text-text",children:[u.jsx(de,{name:"layers",className:"w-4 h-4 text-purple-500 flex-shrink-0"}),u.jsx("span",{className:"font-semibold",children:b.title})]}),u.jsxs("ul",{className:"pl-6 mt-1 space-y-1",children:[(b.decks||[]).map((A,D)=>u.jsxs("li",{className:"flex items-center gap-2 text-text-muted",children:[u.jsx(de,{name:"help-circle",className:"w-3.5 h-3.5 flex-shrink-0"}),u.jsx("span",{children:A.name})]},D)),(!b.decks||b.decks.length===0)&&u.jsx("li",{className:"flex items-center gap-2 text-xs text-text-muted/70 italic",children:"(No decks in this level)"})]})]},T))})})]})]}),u.jsxs("div",{className:"flex justify-end p-4 bg-background/50 border-t border-border",children:[u.jsx(Se,{type:"button",variant:"secondary",onClick:e,className:"mr-2",children:"Cancel"}),u.jsxs(Se,{type:"submit",variant:"primary",children:[u.jsx(de,{name:"save",className:"w-4 h-4 mr-2"}),x?"Create Series":"Save Changes"]})]})]})})})},qy=({pullDistance:t,isRefreshing:e,threshold:n})=>{if(e)return u.jsx("div",{className:"fixed top-0 left-0 right-0 h-20 flex items-center justify-center z-50 transition-all duration-300",children:u.jsx(Ln,{size:"md"})});if(t<=0)return null;const o=Math.min(t/n,1),i=o>=1,c=20,f=2*Math.PI*c,m=f-o*f;return u.jsx("div",{className:"fixed top-0 left-0 right-0 h-20 flex items-center justify-center z-10 pointer-events-none",style:{transform:`translateY(${Math.min(t,n*1.5)-80}px)`,opacity:Math.min(t/(n/2),1)},children:u.jsxs("div",{className:"relative w-12 h-12 flex items-center justify-center bg-white dark:bg-gray-800 rounded-full shadow-lg",children:[u.jsxs("svg",{className:"absolute w-full h-full transform -rotate-90",viewBox:"0 0 44 44",children:[u.jsx("circle",{className:"text-gray-300/50 dark:text-gray-600/50",stroke:"currentColor",strokeWidth:"4",fill:"transparent",r:c,cx:"22",cy:"22"}),u.jsx("circle",{className:"text-blue-500",stroke:"currentColor",strokeWidth:"4",strokeLinecap:"round",fill:"transparent",r:c,cx:"22",cy:"22",style:{strokeDasharray:f,strokeDashoffset:m,transition:i?"stroke-dashoffset 0.1s linear":"none"}})]}),u.jsx(de,{name:i?"refresh-ccw":"arrow-down",className:`w-6 h-6 transition-colors duration-200 ${i?"text-blue-500":"text-gray-500 dark:text-gray-400"}`})]})})},Hn=(t,e,n)=>{const o=new Date;o.setHours(0,0,0,0);const i=e.map(f=>({id:crypto.randomUUID(),text:f.text,explanation:f.explanation})),c=i[e.findIndex(f=>f.correct)];if(!c)throw new Error(`No correct option specified for question: "${t}"`);return{id:crypto.randomUUID(),questionType:"multipleChoice",questionText:t,tags:["nature","sample"],detailedExplanation:n,options:i,correctAnswerId:c.id,dueDate:o.toISOString(),interval:0,easeFactor:Oo,suspended:!1,masteryLevel:0,lastReviewed:void 0}},zy=()=>{const t={id:crypto.randomUUID(),name:"Level 1.1: Simple Addition",description:"Practice basic addition problems.",type:We.Quiz,questions:[Hn("What is 1 + 1?",[{text:"2",correct:!0},{text:"1"},{text:"3"}],"1 plus 1 equals 2."),Hn("What is 2 + 3?",[{text:"5",correct:!0},{text:"4"},{text:"6"}],"2 plus 3 equals 5."),Hn("What is 5 + 4?",[{text:"9",correct:!0},{text:"8"},{text:"10"}],"5 plus 4 equals 9.")]},e={id:crypto.randomUUID(),name:"Level 1.2: Simple Subtraction",description:"Practice basic subtraction problems.",type:We.Quiz,questions:[Hn("What is 5 - 2?",[{text:"3",correct:!0},{text:"2"},{text:"4"}],"5 minus 2 equals 3."),Hn("What is 10 - 4?",[{text:"6",correct:!0},{text:"5"},{text:"7"}],"10 minus 4 equals 6.")]},n={id:crypto.randomUUID(),name:"Level 2.1: Simple Multiplication",description:"Practice basic multiplication problems.",type:We.Quiz,questions:[Hn("What is 2 * 3?",[{text:"6",correct:!0},{text:"5"},{text:"8"}],"2 times 3 is 6."),Hn("What is 4 * 5?",[{text:"20",correct:!0},{text:"15"},{text:"25"}],"4 times 5 is 20.")]},o=[t,e,n];return{series:{id:crypto.randomUUID(),type:"series",name:"Sample: Basic Math Series",description:"A sample series to demonstrate the progressive learning path feature. Complete each deck to unlock the next!",levels:[{title:"Level 1: Fundamentals",deckIds:[t.id,e.id]},{title:"Level 2: Next Steps",deckIds:[n.id]}],createdAt:new Date().toISOString()},decks:o}},Oy=()=>{const t=[Hn("Which process allows plants to convert light energy into chemical energy?",[{text:"Respiration"},{text:"Photosynthesis",correct:!0},{text:"Transpiration"},{text:"Germination"}],"Photosynthesis is the vital process used by plants, algae, and certain bacteria to harness energy from sunlight and turn it into chemical energy in the form of glucose."),Hn("What is the largest rainforest in the world?",[{text:"The Congo Rainforest"},{text:"The Valdivian Temperate Rainforest"},{text:"The Daintree Rainforest"},{text:"The Amazon Rainforest",correct:!0}],"The Amazon Rainforest is the world's largest tropical rainforest, famed for its biodiversity. It spans across nine countries in South America."),Hn("What type of rock is formed from the cooling and solidification of magma or lava?",[{text:"Igneous Rock",correct:!0},{text:"Sedimentary Rock"},{text:"Metamorphic Rock"},{text:"Sandstone"}],"Igneous rock is formed through the cooling and solidification of magma (molten rock below the surface) or lava (molten rock on the surface). Examples include granite and basalt."),Hn("Which layer of the Earth's atmosphere is closest to the surface?",[{text:"Stratosphere"},{text:"Mesosphere"},{text:"Troposphere",correct:!0},{text:"Thermosphere"}],"The Troposphere is the lowest layer of Earth's atmosphere, and is also where nearly all weather conditions take place. It contains about 75% of the atmosphere's mass."),Hn("What is the name for the process of water movement through a plant and its evaporation from aerial parts, such as leaves, stems and flowers?",[{text:"Condensation"},{text:"Precipitation"},{text:"Transpiration",correct:!0},{text:"Photosynthesis"}],"Transpiration is essentially evaporation of water from plant leaves. It is a key part of the water cycle, and an important process in plant life.")];return{id:crypto.randomUUID(),name:"Sample: Wonders of Nature",description:"A sample quiz deck to introduce you to CogniFlow. Test your knowledge about the natural world!",type:We.Quiz,questions:t,lastOpened:new Date().toISOString()}};function By(t,e){const n=new Date(t);return n.setDate(n.getDate()+e),n}const Vy=(t,e)=>{const n=new Date;n.setHours(0,0,0,0);let o=t.lapses||0;e===ft.Again?o++:o>0&&(o=0);let i=Cy[e];e===ft.Again&&o>2&&(i-=(o-2)*.05);let c=t.easeFactor+i;c<ic&&(c=ic);let f;if(e===ft.Again)f=vy;else if(t.interval===0)switch(e){case ft.Hard:f=1;break;case ft.Good:f=3;break;case ft.Easy:f=5;break;default:f=1}else{let p=1;e===ft.Hard&&(p=xy),e===ft.Easy&&(p=wy),f=Math.ceil(t.interval*c*p)}const m=By(n,f),h=Math.min(1,Math.log1p(f)/Math.log1p(90));return{...t,interval:f,easeFactor:c,dueDate:m.toISOString(),lastReviewed:n.toISOString(),masteryLevel:h,lapses:o}},em=t=>{const e=new Date;return e.setHours(0,0,0,0),{...t,dueDate:e.toISOString(),interval:0,easeFactor:Oo,suspended:!1,masteryLevel:0,lastReviewed:void 0,lapses:0}},sr=t=>{const e=t.masteryLevel||0;if(e===0||!t.lastReviewed||t.suspended)return 0;const n=(t.interval||1)*2,o=new Date(t.lastReviewed),c=Math.max(0,(new Date().getTime()-o.getTime())/(1e3*60*60*24));if(c<=0)return e;const f=Math.pow(.5,c/n);return e*f},Gy={},tm=t=>{let e;const n=new Set,o=(v,x)=>{const C=typeof v=="function"?v(e):v;if(!Object.is(C,e)){const S=e;e=x??(typeof C!="object"||C===null)?C:Object.assign({},e,C),n.forEach(b=>b(e,S))}},i=()=>e,h={setState:o,getState:i,getInitialState:()=>p,subscribe:v=>(n.add(v),()=>n.delete(v)),destroy:()=>{(Gy?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),n.clear()}},p=e=t(o,i,h);return h},$y=t=>t?tm(t):tm;var Ju={exports:{}},Yu={},Qu={exports:{}},Ku={};/**
 * @license React
 * use-sync-external-store-shim.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var nm;function Hy(){if(nm)return Ku;nm=1;var t=vi();function e(x,C){return x===C&&(x!==0||1/x===1/C)||x!==x&&C!==C}var n=typeof Object.is=="function"?Object.is:e,o=t.useState,i=t.useEffect,c=t.useLayoutEffect,f=t.useDebugValue;function m(x,C){var S=C(),b=o({inst:{value:S,getSnapshot:C}}),T=b[0].inst,A=b[1];return c(function(){T.value=S,T.getSnapshot=C,h(T)&&A({inst:T})},[x,S,C]),i(function(){return h(T)&&A({inst:T}),x(function(){h(T)&&A({inst:T})})},[x]),f(S),S}function h(x){var C=x.getSnapshot;x=x.value;try{var S=C();return!n(x,S)}catch{return!0}}function p(x,C){return C()}var v=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?p:m;return Ku.useSyncExternalStore=t.useSyncExternalStore!==void 0?t.useSyncExternalStore:v,Ku}var rm;function Wy(){return rm||(rm=1,Qu.exports=Hy()),Qu.exports}/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var om;function Jy(){if(om)return Yu;om=1;var t=vi(),e=Wy();function n(p,v){return p===v&&(p!==0||1/p===1/v)||p!==p&&v!==v}var o=typeof Object.is=="function"?Object.is:n,i=e.useSyncExternalStore,c=t.useRef,f=t.useEffect,m=t.useMemo,h=t.useDebugValue;return Yu.useSyncExternalStoreWithSelector=function(p,v,x,C,S){var b=c(null);if(b.current===null){var T={hasValue:!1,value:null};b.current=T}else T=b.current;b=m(function(){function D(G){if(!F){if(F=!0,L=G,G=C(G),S!==void 0&&T.hasValue){var $=T.value;if(S($,G))return R=$}return R=G}if($=R,o(L,G))return $;var oe=C(G);return S!==void 0&&S($,oe)?$:(L=G,R=oe)}var F=!1,L,R,P=x===void 0?null:x;return[function(){return D(v())},P===null?void 0:function(){return D(P())}]},[v,x,C,S]);var A=i(p,b[0],b[1]);return f(function(){T.hasValue=!0,T.value=A},[A]),h(A),A},Yu}var sm;function Yy(){return sm||(sm=1,Ju.exports=Jy()),Ju.exports}var Qy=Yy();const Ky=yi(Qy),$p={},{useDebugValue:Zy}=hi,{useSyncExternalStoreWithSelector:Xy}=Ky;let im=!1;const ev=t=>t;function tv(t,e=ev,n){($p?"production":void 0)!=="production"&&n&&!im&&(console.warn("[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"),im=!0);const o=Xy(t.subscribe,t.getState,t.getServerState||t.getInitialState,e,n);return Zy(o),o}const am=t=>{($p?"production":void 0)!=="production"&&typeof t!="function"&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");const e=typeof t=="function"?$y(t):t,n=(o,i)=>tv(e,o,i);return Object.assign(n,e),n},nv=t=>t?am(t):am;function rv(t,e){switch(e.type){case"SET_LOADING":return{...t,isLoading:e.payload};case"SET_SERIES_PROGRESS":return{...t,seriesProgress:e.payload};case"LOAD_DATA":return{...t,...e.payload,isLoading:!1};case"ADD_DECKS":{const n=new Map(t.decks.map(o=>[o.id,o]));return e.payload.forEach(o=>n.set(o.id,o)),{...t,decks:Array.from(n.values())}}case"RESTORE_DATA":{const{decks:n,folders:o,deckSeries:i}=e.payload,c=new Map(t.decks.map(h=>[h.id,h]));n.forEach(h=>c.set(h.id,h));const f=new Map(t.folders.map(h=>[h.id,h]));o.forEach(h=>f.set(h.id,h));const m=new Map(t.deckSeries.map(h=>[h.id,h]));return i.forEach(h=>m.set(h.id,h)),{...t,decks:Array.from(c.values()),folders:Array.from(f.values()),deckSeries:Array.from(m.values())}}case"DELETE_DECK":return{...t,decks:t.decks.filter(n=>n.id!==e.payload),deckSeries:t.deckSeries.map(n=>n.levels?{...n,levels:n.levels.map(o=>({...o,deckIds:(o.deckIds||[]).filter(i=>i!==e.payload)})).filter(o=>o.deckIds.length>0)}:n)};case"UPDATE_DECK":return{...t,decks:t.decks.map(n=>n.id===e.payload.id?e.payload:n)};case"BULK_UPDATE_DECKS":{const n=new Map(t.decks.map(o=>[o.id,o]));return e.payload.forEach(o=>n.set(o.id,o)),{...t,decks:Array.from(n.values())}}case"ADD_FOLDER":return{...t,folders:[...t.folders,e.payload]};case"UPDATE_FOLDER":return{...t,folders:t.folders.map(n=>n.id===e.payload.id?e.payload:n)};case"DELETE_FOLDER":return{...t,folders:t.folders.filter(n=>n.id!==e.payload),decks:t.decks.map(n=>n.folderId===e.payload?{...n,folderId:null}:n)};case"ADD_SERIES":return{...t,deckSeries:[...t.deckSeries,e.payload]};case"ADD_SERIES_WITH_DECKS":{const{series:n,decks:o}=e.payload,i=new Map(t.decks.map(c=>[c.id,c]));return o.forEach(c=>i.set(c.id,c)),{...t,decks:Array.from(i.values()),deckSeries:[...t.deckSeries,n]}}case"UPDATE_SERIES":return{...t,deckSeries:t.deckSeries.map(n=>n.id===e.payload.id?e.payload:n)};case"DELETE_SERIES":return{...t,deckSeries:t.deckSeries.filter(n=>n.id!==e.payload)};case"SET_AI_GENERATION_STATUS":return{...t,aiGenerationStatus:e.payload};default:return t}}const ov={decks:[],folders:[],deckSeries:[],seriesProgress:new Map,isLoading:!0,aiGenerationStatus:{isGenerating:!1,generatingDeckId:null,generatingSeriesId:null}},yt=nv(t=>({...ov,dispatch:e=>t(n=>rv(n,e))})),sv=t=>{const e=new Date;e.setHours(23,59,59,999);const n=t.type===We.Quiz?t.questions:t.cards;return Array.isArray(n)?n.filter(o=>!o.suspended&&new Date(o.dueDate)<=e).length:0},Hp=()=>yt(t=>{const e=new Set;return t.deckSeries.forEach(n=>{(n.levels||[]).forEach(o=>(o.deckIds||[]).forEach(i=>e.add(i)))}),t.decks.filter(n=>!n.archived&&!n.deletedAt&&!e.has(n.id))}),iv=()=>yt(t=>t.deckSeries.filter(e=>!e.archived&&!e.deletedAt)),av=()=>yt(t=>{const e=new Set;t.deckSeries.forEach(o=>{o.levels.forEach(i=>i.deckIds.forEach(c=>e.add(c)))});const n=new Set;return t.deckSeries.forEach(o=>{var i;if(!o.archived&&!o.deletedAt){const c=((i=t.seriesProgress.get(o.id))==null?void 0:i.size)||0;(o.levels||[]).flatMap(m=>m.deckIds||[]).forEach((m,h)=>{h<=c&&n.add(m)})}}),t.decks.filter(o=>!(o.archived||o.deletedAt||e.has(o.id)&&!n.has(o.id))).reduce((o,i)=>o+sv(i),0)});/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */let lv,uv;function cv(){return{geminiUrl:lv,vertexUrl:uv}}function dv(t,e,n,o){var i,c;if(!(t!=null&&t.baseUrl)){const f=cv();return e?(i=f.vertexUrl)!==null&&i!==void 0?i:n:(c=f.geminiUrl)!==null&&c!==void 0?c:o}return t.baseUrl}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Go{}function Qe(t,e){const n=/\{([^}]+)\}/g;return t.replace(n,(o,i)=>{if(Object.prototype.hasOwnProperty.call(e,i)){const c=e[i];return c!=null?String(c):""}else throw new Error(`Key '${i}' not found in valueMap.`)})}function l(t,e,n){for(let c=0;c<e.length-1;c++){const f=e[c];if(f.endsWith("[]")){const m=f.slice(0,-2);if(!(m in t))if(Array.isArray(n))t[m]=Array.from({length:n.length},()=>({}));else throw new Error(`Value must be a list given an array path ${f}`);if(Array.isArray(t[m])){const h=t[m];if(Array.isArray(n))for(let p=0;p<h.length;p++){const v=h[p];l(v,e.slice(c+1),n[p])}else for(const p of h)l(p,e.slice(c+1),n)}return}else if(f.endsWith("[0]")){const m=f.slice(0,-3);m in t||(t[m]=[{}]);const h=t[m];l(h[0],e.slice(c+1),n);return}(!t[f]||typeof t[f]!="object")&&(t[f]={}),t=t[f]}const o=e[e.length-1],i=t[o];if(i!==void 0){if(!n||typeof n=="object"&&Object.keys(n).length===0||n===i)return;if(typeof i=="object"&&typeof n=="object"&&i!==null&&n!==null)Object.assign(i,n);else throw new Error(`Cannot set value for an existing key. Key: ${o}`)}else t[o]=n}function a(t,e){try{if(e.length===1&&e[0]==="_self")return t;for(let n=0;n<e.length;n++){if(typeof t!="object"||t===null)return;const o=e[n];if(o.endsWith("[]")){const i=o.slice(0,-2);if(i in t){const c=t[i];return Array.isArray(c)?c.map(f=>a(f,e.slice(n+1))):void 0}else return}else t=t[o]}return t}catch(n){if(n instanceof TypeError)return;throw n}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function uc(t){if(typeof t!="string")throw new Error("fromImageBytes must be a string");return t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var lm;(function(t){t.OUTCOME_UNSPECIFIED="OUTCOME_UNSPECIFIED",t.OUTCOME_OK="OUTCOME_OK",t.OUTCOME_FAILED="OUTCOME_FAILED",t.OUTCOME_DEADLINE_EXCEEDED="OUTCOME_DEADLINE_EXCEEDED"})(lm||(lm={}));var um;(function(t){t.LANGUAGE_UNSPECIFIED="LANGUAGE_UNSPECIFIED",t.PYTHON="PYTHON"})(um||(um={}));var vt;(function(t){t.TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",t.STRING="STRING",t.NUMBER="NUMBER",t.INTEGER="INTEGER",t.BOOLEAN="BOOLEAN",t.ARRAY="ARRAY",t.OBJECT="OBJECT",t.NULL="NULL"})(vt||(vt={}));var cm;(function(t){t.HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",t.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",t.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",t.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",t.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",t.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY",t.HARM_CATEGORY_IMAGE_HATE="HARM_CATEGORY_IMAGE_HATE",t.HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT="HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT",t.HARM_CATEGORY_IMAGE_HARASSMENT="HARM_CATEGORY_IMAGE_HARASSMENT",t.HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT="HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT"})(cm||(cm={}));var dm;(function(t){t.HARM_BLOCK_METHOD_UNSPECIFIED="HARM_BLOCK_METHOD_UNSPECIFIED",t.SEVERITY="SEVERITY",t.PROBABILITY="PROBABILITY"})(dm||(dm={}));var fm;(function(t){t.HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",t.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",t.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",t.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",t.BLOCK_NONE="BLOCK_NONE",t.OFF="OFF"})(fm||(fm={}));var mm;(function(t){t.MODE_UNSPECIFIED="MODE_UNSPECIFIED",t.MODE_DYNAMIC="MODE_DYNAMIC"})(mm||(mm={}));var pm;(function(t){t.AUTH_TYPE_UNSPECIFIED="AUTH_TYPE_UNSPECIFIED",t.NO_AUTH="NO_AUTH",t.API_KEY_AUTH="API_KEY_AUTH",t.HTTP_BASIC_AUTH="HTTP_BASIC_AUTH",t.GOOGLE_SERVICE_ACCOUNT_AUTH="GOOGLE_SERVICE_ACCOUNT_AUTH",t.OAUTH="OAUTH",t.OIDC_AUTH="OIDC_AUTH"})(pm||(pm={}));var hm;(function(t){t.API_SPEC_UNSPECIFIED="API_SPEC_UNSPECIFIED",t.SIMPLE_SEARCH="SIMPLE_SEARCH",t.ELASTIC_SEARCH="ELASTIC_SEARCH"})(hm||(hm={}));var gm;(function(t){t.URL_RETRIEVAL_STATUS_UNSPECIFIED="URL_RETRIEVAL_STATUS_UNSPECIFIED",t.URL_RETRIEVAL_STATUS_SUCCESS="URL_RETRIEVAL_STATUS_SUCCESS",t.URL_RETRIEVAL_STATUS_ERROR="URL_RETRIEVAL_STATUS_ERROR",t.URL_RETRIEVAL_STATUS_PAYWALL="URL_RETRIEVAL_STATUS_PAYWALL",t.URL_RETRIEVAL_STATUS_UNSAFE="URL_RETRIEVAL_STATUS_UNSAFE"})(gm||(gm={}));var ym;(function(t){t.FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",t.STOP="STOP",t.MAX_TOKENS="MAX_TOKENS",t.SAFETY="SAFETY",t.RECITATION="RECITATION",t.LANGUAGE="LANGUAGE",t.OTHER="OTHER",t.BLOCKLIST="BLOCKLIST",t.PROHIBITED_CONTENT="PROHIBITED_CONTENT",t.SPII="SPII",t.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",t.IMAGE_SAFETY="IMAGE_SAFETY",t.UNEXPECTED_TOOL_CALL="UNEXPECTED_TOOL_CALL"})(ym||(ym={}));var vm;(function(t){t.HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",t.NEGLIGIBLE="NEGLIGIBLE",t.LOW="LOW",t.MEDIUM="MEDIUM",t.HIGH="HIGH"})(vm||(vm={}));var xm;(function(t){t.HARM_SEVERITY_UNSPECIFIED="HARM_SEVERITY_UNSPECIFIED",t.HARM_SEVERITY_NEGLIGIBLE="HARM_SEVERITY_NEGLIGIBLE",t.HARM_SEVERITY_LOW="HARM_SEVERITY_LOW",t.HARM_SEVERITY_MEDIUM="HARM_SEVERITY_MEDIUM",t.HARM_SEVERITY_HIGH="HARM_SEVERITY_HIGH"})(xm||(xm={}));var wm;(function(t){t.BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",t.SAFETY="SAFETY",t.OTHER="OTHER",t.BLOCKLIST="BLOCKLIST",t.PROHIBITED_CONTENT="PROHIBITED_CONTENT",t.IMAGE_SAFETY="IMAGE_SAFETY"})(wm||(wm={}));var Cm;(function(t){t.TRAFFIC_TYPE_UNSPECIFIED="TRAFFIC_TYPE_UNSPECIFIED",t.ON_DEMAND="ON_DEMAND",t.PROVISIONED_THROUGHPUT="PROVISIONED_THROUGHPUT"})(Cm||(Cm={}));var $a;(function(t){t.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",t.TEXT="TEXT",t.IMAGE="IMAGE",t.AUDIO="AUDIO"})($a||($a={}));var Sm;(function(t){t.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",t.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",t.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",t.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH"})(Sm||(Sm={}));var cc;(function(t){t.JOB_STATE_UNSPECIFIED="JOB_STATE_UNSPECIFIED",t.JOB_STATE_QUEUED="JOB_STATE_QUEUED",t.JOB_STATE_PENDING="JOB_STATE_PENDING",t.JOB_STATE_RUNNING="JOB_STATE_RUNNING",t.JOB_STATE_SUCCEEDED="JOB_STATE_SUCCEEDED",t.JOB_STATE_FAILED="JOB_STATE_FAILED",t.JOB_STATE_CANCELLING="JOB_STATE_CANCELLING",t.JOB_STATE_CANCELLED="JOB_STATE_CANCELLED",t.JOB_STATE_PAUSED="JOB_STATE_PAUSED",t.JOB_STATE_EXPIRED="JOB_STATE_EXPIRED",t.JOB_STATE_UPDATING="JOB_STATE_UPDATING",t.JOB_STATE_PARTIALLY_SUCCEEDED="JOB_STATE_PARTIALLY_SUCCEEDED"})(cc||(cc={}));var km;(function(t){t.TUNING_MODE_UNSPECIFIED="TUNING_MODE_UNSPECIFIED",t.TUNING_MODE_FULL="TUNING_MODE_FULL",t.TUNING_MODE_PEFT_ADAPTER="TUNING_MODE_PEFT_ADAPTER"})(km||(km={}));var Tm;(function(t){t.ADAPTER_SIZE_UNSPECIFIED="ADAPTER_SIZE_UNSPECIFIED",t.ADAPTER_SIZE_ONE="ADAPTER_SIZE_ONE",t.ADAPTER_SIZE_TWO="ADAPTER_SIZE_TWO",t.ADAPTER_SIZE_FOUR="ADAPTER_SIZE_FOUR",t.ADAPTER_SIZE_EIGHT="ADAPTER_SIZE_EIGHT",t.ADAPTER_SIZE_SIXTEEN="ADAPTER_SIZE_SIXTEEN",t.ADAPTER_SIZE_THIRTY_TWO="ADAPTER_SIZE_THIRTY_TWO"})(Tm||(Tm={}));var _m;(function(t){t.FEATURE_SELECTION_PREFERENCE_UNSPECIFIED="FEATURE_SELECTION_PREFERENCE_UNSPECIFIED",t.PRIORITIZE_QUALITY="PRIORITIZE_QUALITY",t.BALANCED="BALANCED",t.PRIORITIZE_COST="PRIORITIZE_COST"})(_m||(_m={}));var Em;(function(t){t.UNSPECIFIED="UNSPECIFIED",t.BLOCKING="BLOCKING",t.NON_BLOCKING="NON_BLOCKING"})(Em||(Em={}));var bm;(function(t){t.MODE_UNSPECIFIED="MODE_UNSPECIFIED",t.MODE_DYNAMIC="MODE_DYNAMIC"})(bm||(bm={}));var Nm;(function(t){t.ENVIRONMENT_UNSPECIFIED="ENVIRONMENT_UNSPECIFIED",t.ENVIRONMENT_BROWSER="ENVIRONMENT_BROWSER"})(Nm||(Nm={}));var Im;(function(t){t.MODE_UNSPECIFIED="MODE_UNSPECIFIED",t.AUTO="AUTO",t.ANY="ANY",t.NONE="NONE"})(Im||(Im={}));var Am;(function(t){t.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",t.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",t.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",t.BLOCK_NONE="BLOCK_NONE"})(Am||(Am={}));var Dm;(function(t){t.DONT_ALLOW="DONT_ALLOW",t.ALLOW_ADULT="ALLOW_ADULT",t.ALLOW_ALL="ALLOW_ALL"})(Dm||(Dm={}));var Mm;(function(t){t.auto="auto",t.en="en",t.ja="ja",t.ko="ko",t.hi="hi",t.zh="zh",t.pt="pt",t.es="es"})(Mm||(Mm={}));var Rm;(function(t){t.MASK_MODE_DEFAULT="MASK_MODE_DEFAULT",t.MASK_MODE_USER_PROVIDED="MASK_MODE_USER_PROVIDED",t.MASK_MODE_BACKGROUND="MASK_MODE_BACKGROUND",t.MASK_MODE_FOREGROUND="MASK_MODE_FOREGROUND",t.MASK_MODE_SEMANTIC="MASK_MODE_SEMANTIC"})(Rm||(Rm={}));var Pm;(function(t){t.CONTROL_TYPE_DEFAULT="CONTROL_TYPE_DEFAULT",t.CONTROL_TYPE_CANNY="CONTROL_TYPE_CANNY",t.CONTROL_TYPE_SCRIBBLE="CONTROL_TYPE_SCRIBBLE",t.CONTROL_TYPE_FACE_MESH="CONTROL_TYPE_FACE_MESH"})(Pm||(Pm={}));var Fm;(function(t){t.SUBJECT_TYPE_DEFAULT="SUBJECT_TYPE_DEFAULT",t.SUBJECT_TYPE_PERSON="SUBJECT_TYPE_PERSON",t.SUBJECT_TYPE_ANIMAL="SUBJECT_TYPE_ANIMAL",t.SUBJECT_TYPE_PRODUCT="SUBJECT_TYPE_PRODUCT"})(Fm||(Fm={}));var Lm;(function(t){t.EDIT_MODE_DEFAULT="EDIT_MODE_DEFAULT",t.EDIT_MODE_INPAINT_REMOVAL="EDIT_MODE_INPAINT_REMOVAL",t.EDIT_MODE_INPAINT_INSERTION="EDIT_MODE_INPAINT_INSERTION",t.EDIT_MODE_OUTPAINT="EDIT_MODE_OUTPAINT",t.EDIT_MODE_CONTROLLED_EDITING="EDIT_MODE_CONTROLLED_EDITING",t.EDIT_MODE_STYLE="EDIT_MODE_STYLE",t.EDIT_MODE_BGSWAP="EDIT_MODE_BGSWAP",t.EDIT_MODE_PRODUCT_IMAGE="EDIT_MODE_PRODUCT_IMAGE"})(Lm||(Lm={}));var Um;(function(t){t.FOREGROUND="FOREGROUND",t.BACKGROUND="BACKGROUND",t.PROMPT="PROMPT",t.SEMANTIC="SEMANTIC",t.INTERACTIVE="INTERACTIVE"})(Um||(Um={}));var jm;(function(t){t.OPTIMIZED="OPTIMIZED",t.LOSSLESS="LOSSLESS"})(jm||(jm={}));var qm;(function(t){t.STATE_UNSPECIFIED="STATE_UNSPECIFIED",t.PROCESSING="PROCESSING",t.ACTIVE="ACTIVE",t.FAILED="FAILED"})(qm||(qm={}));var zm;(function(t){t.SOURCE_UNSPECIFIED="SOURCE_UNSPECIFIED",t.UPLOADED="UPLOADED",t.GENERATED="GENERATED"})(zm||(zm={}));var Om;(function(t){t.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",t.TEXT="TEXT",t.IMAGE="IMAGE",t.VIDEO="VIDEO",t.AUDIO="AUDIO",t.DOCUMENT="DOCUMENT"})(Om||(Om={}));var Bm;(function(t){t.START_SENSITIVITY_UNSPECIFIED="START_SENSITIVITY_UNSPECIFIED",t.START_SENSITIVITY_HIGH="START_SENSITIVITY_HIGH",t.START_SENSITIVITY_LOW="START_SENSITIVITY_LOW"})(Bm||(Bm={}));var Vm;(function(t){t.END_SENSITIVITY_UNSPECIFIED="END_SENSITIVITY_UNSPECIFIED",t.END_SENSITIVITY_HIGH="END_SENSITIVITY_HIGH",t.END_SENSITIVITY_LOW="END_SENSITIVITY_LOW"})(Vm||(Vm={}));var Gm;(function(t){t.ACTIVITY_HANDLING_UNSPECIFIED="ACTIVITY_HANDLING_UNSPECIFIED",t.START_OF_ACTIVITY_INTERRUPTS="START_OF_ACTIVITY_INTERRUPTS",t.NO_INTERRUPTION="NO_INTERRUPTION"})(Gm||(Gm={}));var $m;(function(t){t.TURN_COVERAGE_UNSPECIFIED="TURN_COVERAGE_UNSPECIFIED",t.TURN_INCLUDES_ONLY_ACTIVITY="TURN_INCLUDES_ONLY_ACTIVITY",t.TURN_INCLUDES_ALL_INPUT="TURN_INCLUDES_ALL_INPUT"})($m||($m={}));var Hm;(function(t){t.SCHEDULING_UNSPECIFIED="SCHEDULING_UNSPECIFIED",t.SILENT="SILENT",t.WHEN_IDLE="WHEN_IDLE",t.INTERRUPT="INTERRUPT"})(Hm||(Hm={}));var Wm;(function(t){t.SCALE_UNSPECIFIED="SCALE_UNSPECIFIED",t.C_MAJOR_A_MINOR="C_MAJOR_A_MINOR",t.D_FLAT_MAJOR_B_FLAT_MINOR="D_FLAT_MAJOR_B_FLAT_MINOR",t.D_MAJOR_B_MINOR="D_MAJOR_B_MINOR",t.E_FLAT_MAJOR_C_MINOR="E_FLAT_MAJOR_C_MINOR",t.E_MAJOR_D_FLAT_MINOR="E_MAJOR_D_FLAT_MINOR",t.F_MAJOR_D_MINOR="F_MAJOR_D_MINOR",t.G_FLAT_MAJOR_E_FLAT_MINOR="G_FLAT_MAJOR_E_FLAT_MINOR",t.G_MAJOR_E_MINOR="G_MAJOR_E_MINOR",t.A_FLAT_MAJOR_F_MINOR="A_FLAT_MAJOR_F_MINOR",t.A_MAJOR_G_FLAT_MINOR="A_MAJOR_G_FLAT_MINOR",t.B_FLAT_MAJOR_G_MINOR="B_FLAT_MAJOR_G_MINOR",t.B_MAJOR_A_FLAT_MINOR="B_MAJOR_A_FLAT_MINOR"})(Wm||(Wm={}));var Jm;(function(t){t.MUSIC_GENERATION_MODE_UNSPECIFIED="MUSIC_GENERATION_MODE_UNSPECIFIED",t.QUALITY="QUALITY",t.DIVERSITY="DIVERSITY",t.VOCALIZATION="VOCALIZATION"})(Jm||(Jm={}));var _s;(function(t){t.PLAYBACK_CONTROL_UNSPECIFIED="PLAYBACK_CONTROL_UNSPECIFIED",t.PLAY="PLAY",t.PAUSE="PAUSE",t.STOP="STOP",t.RESET_CONTEXT="RESET_CONTEXT"})(_s||(_s={}));class dc{constructor(e){const n={};for(const o of e.headers.entries())n[o[0]]=o[1];this.headers=n,this.responseInternal=e}json(){return this.responseInternal.json()}}class ci{get text(){var e,n,o,i,c,f,m,h;if(((i=(o=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||o===void 0?void 0:o.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning text from the first one.");let p="",v=!1;const x=[];for(const C of(h=(m=(f=(c=this.candidates)===null||c===void 0?void 0:c[0])===null||f===void 0?void 0:f.content)===null||m===void 0?void 0:m.parts)!==null&&h!==void 0?h:[]){for(const[S,b]of Object.entries(C))S!=="text"&&S!=="thought"&&(b!==null||b!==void 0)&&x.push(S);if(typeof C.text=="string"){if(typeof C.thought=="boolean"&&C.thought)continue;v=!0,p+=C.text}}return x.length>0&&console.warn(`there are non-text parts ${x} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),v?p:void 0}get data(){var e,n,o,i,c,f,m,h;if(((i=(o=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||o===void 0?void 0:o.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning data from the first one.");let p="";const v=[];for(const x of(h=(m=(f=(c=this.candidates)===null||c===void 0?void 0:c[0])===null||f===void 0?void 0:f.content)===null||m===void 0?void 0:m.parts)!==null&&h!==void 0?h:[]){for(const[C,S]of Object.entries(x))C!=="inlineData"&&(S!==null||S!==void 0)&&v.push(C);x.inlineData&&typeof x.inlineData.data=="string"&&(p+=atob(x.inlineData.data))}return v.length>0&&console.warn(`there are non-data parts ${v} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),p.length>0?btoa(p):void 0}get functionCalls(){var e,n,o,i,c,f,m,h;if(((i=(o=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||o===void 0?void 0:o.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning function calls from the first one.");const p=(h=(m=(f=(c=this.candidates)===null||c===void 0?void 0:c[0])===null||f===void 0?void 0:f.content)===null||m===void 0?void 0:m.parts)===null||h===void 0?void 0:h.filter(v=>v.functionCall).map(v=>v.functionCall).filter(v=>v!==void 0);if((p==null?void 0:p.length)!==0)return p}get executableCode(){var e,n,o,i,c,f,m,h,p;if(((i=(o=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||o===void 0?void 0:o.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning executable code from the first one.");const v=(h=(m=(f=(c=this.candidates)===null||c===void 0?void 0:c[0])===null||f===void 0?void 0:f.content)===null||m===void 0?void 0:m.parts)===null||h===void 0?void 0:h.filter(x=>x.executableCode).map(x=>x.executableCode).filter(x=>x!==void 0);if((v==null?void 0:v.length)!==0)return(p=v==null?void 0:v[0])===null||p===void 0?void 0:p.code}get codeExecutionResult(){var e,n,o,i,c,f,m,h,p;if(((i=(o=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||o===void 0?void 0:o.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning code execution result from the first one.");const v=(h=(m=(f=(c=this.candidates)===null||c===void 0?void 0:c[0])===null||f===void 0?void 0:f.content)===null||m===void 0?void 0:m.parts)===null||h===void 0?void 0:h.filter(x=>x.codeExecutionResult).map(x=>x.codeExecutionResult).filter(x=>x!==void 0);if((v==null?void 0:v.length)!==0)return(p=v==null?void 0:v[0])===null||p===void 0?void 0:p.output}}class Ym{}class Qm{}class fv{}class mv{}class pv{}class hv{}class Km{}class Zm{}class Xm{}class gv{}class ep{}class tp{}class np{}class rp{}class yv{}class vv{}class xv{}class op{}class wv{get text(){var e,n,o;let i="",c=!1;const f=[];for(const m of(o=(n=(e=this.serverContent)===null||e===void 0?void 0:e.modelTurn)===null||n===void 0?void 0:n.parts)!==null&&o!==void 0?o:[]){for(const[h,p]of Object.entries(m))h!=="text"&&h!=="thought"&&p!==null&&f.push(h);if(typeof m.text=="string"){if(typeof m.thought=="boolean"&&m.thought)continue;c=!0,i+=m.text}}return f.length>0&&console.warn(`there are non-text parts ${f} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),c?i:void 0}get data(){var e,n,o;let i="";const c=[];for(const f of(o=(n=(e=this.serverContent)===null||e===void 0?void 0:e.modelTurn)===null||n===void 0?void 0:n.parts)!==null&&o!==void 0?o:[]){for(const[m,h]of Object.entries(f))m!=="inlineData"&&h!==null&&c.push(m);f.inlineData&&typeof f.inlineData.data=="string"&&(i+=atob(f.inlineData.data))}return c.length>0&&console.warn(`there are non-data parts ${c} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),i.length>0?btoa(i):void 0}}class Ha{_fromAPIResponse({apiResponse:e,isVertexAI:n}){const o=new Ha;if(o.name=e.name,o.metadata=e.metadata,o.done=e.done,o.error=e.error,n){const i=e.response;if(i){const c=new ep,f=i.videos;c.generatedVideos=f==null?void 0:f.map(m=>({video:{uri:m.gcsUri,videoBytes:m.bytesBase64Encoded?uc(m.bytesBase64Encoded):void 0,mimeType:m.mimeType}})),c.raiMediaFilteredCount=i.raiMediaFilteredCount,c.raiMediaFilteredReasons=i.raiMediaFilteredReasons,o.response=c}}else{const i=e.response;if(i){const c=new ep,f=i.generateVideoResponse,m=f==null?void 0:f.generatedSamples;c.generatedVideos=m==null?void 0:m.map(h=>{const p=h.video;return{video:{uri:p==null?void 0:p.uri,videoBytes:p!=null&&p.encodedVideo?uc(p==null?void 0:p.encodedVideo):void 0,mimeType:h.encoding}}}),c.raiMediaFilteredCount=f==null?void 0:f.raiMediaFilteredCount,c.raiMediaFilteredReasons=f==null?void 0:f.raiMediaFilteredReasons,o.response=c}}return o}}class Cv{get audioChunk(){if(this.serverContent&&this.serverContent.audioChunks&&this.serverContent.audioChunks.length>0)return this.serverContent.audioChunks[0]}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function _t(t,e){if(!e||typeof e!="string")throw new Error("model is required and must be a string");if(t.isVertexAI()){if(e.startsWith("publishers/")||e.startsWith("projects/")||e.startsWith("models/"))return e;if(e.indexOf("/")>=0){const n=e.split("/",2);return`publishers/${n[0]}/models/${n[1]}`}else return`publishers/google/models/${e}`}else return e.startsWith("models/")||e.startsWith("tunedModels/")?e:`models/${e}`}function Wp(t,e){const n=_t(t,e);return n?n.startsWith("publishers/")&&t.isVertexAI()?`projects/${t.getProject()}/locations/${t.getLocation()}/${n}`:n.startsWith("models/")&&t.isVertexAI()?`projects/${t.getProject()}/locations/${t.getLocation()}/publishers/google/${n}`:n:""}function Jp(t){return Array.isArray(t)?t.map(e=>Wa(e)):[Wa(t)]}function Wa(t){if(typeof t=="object"&&t!==null)return t;throw new Error(`Could not parse input as Blob. Unsupported blob type: ${typeof t}`)}function Yp(t){const e=Wa(t);if(e.mimeType&&e.mimeType.startsWith("image/"))return e;throw new Error(`Unsupported mime type: ${e.mimeType}`)}function Qp(t){const e=Wa(t);if(e.mimeType&&e.mimeType.startsWith("audio/"))return e;throw new Error(`Unsupported mime type: ${e.mimeType}`)}function sp(t){if(t==null)throw new Error("PartUnion is required");if(typeof t=="object")return t;if(typeof t=="string")return{text:t};throw new Error(`Unsupported part type: ${typeof t}`)}function Kp(t){if(t==null||Array.isArray(t)&&t.length===0)throw new Error("PartListUnion is required");return Array.isArray(t)?t.map(e=>sp(e)):[sp(t)]}function fc(t){return t!=null&&typeof t=="object"&&"parts"in t&&Array.isArray(t.parts)}function ip(t){return t!=null&&typeof t=="object"&&"functionCall"in t}function ap(t){return t!=null&&typeof t=="object"&&"functionResponse"in t}function hn(t){if(t==null)throw new Error("ContentUnion is required");return fc(t)?t:{role:"user",parts:Kp(t)}}function Zp(t,e){if(!e)return[];if(t.isVertexAI()&&Array.isArray(e))return e.flatMap(n=>{const o=hn(n);return o.parts&&o.parts.length>0&&o.parts[0].text!==void 0?[o.parts[0].text]:[]});if(t.isVertexAI()){const n=hn(e);return n.parts&&n.parts.length>0&&n.parts[0].text!==void 0?[n.parts[0].text]:[]}return Array.isArray(e)?e.map(n=>hn(n)):[hn(e)]}function Wn(t){if(t==null||Array.isArray(t)&&t.length===0)throw new Error("contents are required");if(!Array.isArray(t)){if(ip(t)||ap(t))throw new Error("To specify functionCall or functionResponse parts, please wrap them in a Content object, specifying the role for them");return[hn(t)]}const e=[],n=[],o=fc(t[0]);for(const i of t){const c=fc(i);if(c!=o)throw new Error("Mixing Content and Parts is not supported, please group the parts into a the appropriate Content objects and specify the roles for them");if(c)e.push(i);else{if(ip(i)||ap(i))throw new Error("To specify functionCall or functionResponse parts, please wrap them, and any other parts, in Content objects as appropriate, specifying the role for them");n.push(i)}}return o||e.push({role:"user",parts:Kp(n)}),e}function Sv(t,e){t.includes("null")&&(e.nullable=!0);const n=t.filter(o=>o!=="null");if(n.length===1)e.type=Object.values(vt).includes(n[0].toUpperCase())?n[0].toUpperCase():vt.TYPE_UNSPECIFIED;else{e.anyOf=[];for(const o of n)e.anyOf.push({type:Object.values(vt).includes(o.toUpperCase())?o.toUpperCase():vt.TYPE_UNSPECIFIED})}}function Es(t){const e={},n=["items"],o=["anyOf"],i=["properties"];if(t.type&&t.anyOf)throw new Error("type and anyOf cannot be both populated.");const c=t.anyOf;c!=null&&c.length==2&&(c[0].type==="null"?(e.nullable=!0,t=c[1]):c[1].type==="null"&&(e.nullable=!0,t=c[0])),t.type instanceof Array&&Sv(t.type,e);for(const[f,m]of Object.entries(t))if(m!=null)if(f=="type"){if(m==="null")throw new Error("type: null can not be the only possible type for the field.");if(m instanceof Array)continue;e.type=Object.values(vt).includes(m.toUpperCase())?m.toUpperCase():vt.TYPE_UNSPECIFIED}else if(n.includes(f))e[f]=Es(m);else if(o.includes(f)){const h=[];for(const p of m){if(p.type=="null"){e.nullable=!0;continue}h.push(Es(p))}e[f]=h}else if(i.includes(f)){const h={};for(const[p,v]of Object.entries(m))h[p]=Es(v);e[f]=h}else{if(f==="additionalProperties")continue;e[f]=m}return e}function bc(t){return Es(t)}function Nc(t){if(typeof t=="object")return t;if(typeof t=="string")return{voiceConfig:{prebuiltVoiceConfig:{voiceName:t}}};throw new Error(`Unsupported speechConfig type: ${typeof t}`)}function Ic(t){if("multiSpeakerVoiceConfig"in t)throw new Error("multiSpeakerVoiceConfig is not supported in the live API.");return t}function Is(t){if(t.functionDeclarations)for(const e of t.functionDeclarations)e.parameters&&(Object.keys(e.parameters).includes("$schema")?e.parametersJsonSchema||(e.parametersJsonSchema=e.parameters,delete e.parameters):e.parameters=Es(e.parameters)),e.response&&(Object.keys(e.response).includes("$schema")?e.responseJsonSchema||(e.responseJsonSchema=e.response,delete e.response):e.response=Es(e.response));return t}function As(t){if(t==null)throw new Error("tools is required");if(!Array.isArray(t))throw new Error("tools is required and must be an array of Tools");const e=[];for(const n of t)e.push(n);return e}function kv(t,e,n,o=1){const i=!e.startsWith(`${n}/`)&&e.split("/").length===o;return t.isVertexAI()?e.startsWith("projects/")?e:e.startsWith("locations/")?`projects/${t.getProject()}/${e}`:e.startsWith(`${n}/`)?`projects/${t.getProject()}/locations/${t.getLocation()}/${e}`:i?`projects/${t.getProject()}/locations/${t.getLocation()}/${n}/${e}`:e:i?`${n}/${e}`:e}function Pr(t,e){if(typeof e!="string")throw new Error("name must be a string");return kv(t,e,"cachedContents")}function Xp(t){switch(t){case"STATE_UNSPECIFIED":return"JOB_STATE_UNSPECIFIED";case"CREATING":return"JOB_STATE_RUNNING";case"ACTIVE":return"JOB_STATE_SUCCEEDED";case"FAILED":return"JOB_STATE_FAILED";default:return t}}function $o(t){return uc(t)}function Tv(t){return t!=null&&typeof t=="object"&&"name"in t}function _v(t){return t!=null&&typeof t=="object"&&"video"in t}function Ev(t){return t!=null&&typeof t=="object"&&"uri"in t}function eh(t){var e;let n;if(Tv(t)&&(n=t.name),!(Ev(t)&&(n=t.uri,n===void 0))&&!(_v(t)&&(n=(e=t.video)===null||e===void 0?void 0:e.uri,n===void 0))){if(typeof t=="string"&&(n=t),n===void 0)throw new Error("Could not extract file name from the provided input.");if(n.startsWith("https://")){const i=n.split("files/")[1].match(/[a-z0-9]+/);if(i===null)throw new Error(`Could not extract file name from URI ${n}`);n=i[0]}else n.startsWith("files/")&&(n=n.split("files/")[1]);return n}}function th(t,e){let n;return t.isVertexAI()?n=e?"publishers/google/models":"models":n=e?"models":"tunedModels",n}function nh(t){for(const e of["models","tunedModels","publisherModels"])if(bv(t,e))return t[e];return[]}function bv(t,e){return t!==null&&typeof t=="object"&&e in t}function Nv(t,e={}){const n=t,o={name:n.name,description:n.description,parametersJsonSchema:n.inputSchema};return e.behavior&&(o.behavior=e.behavior),{functionDeclarations:[o]}}function Iv(t,e={}){const n=[],o=new Set;for(const i of t){const c=i.name;if(o.has(c))throw new Error(`Duplicate function name ${c} found in MCP tools. Please ensure function names are unique.`);o.add(c);const f=Nv(i,e);f.functionDeclarations&&n.push(...f.functionDeclarations)}return{functionDeclarations:n}}function rh(t,e){if(typeof e!="string"&&!Array.isArray(e)){if(t&&t.isVertexAI()){if(e.gcsUri&&e.bigqueryUri)throw new Error("Only one of `gcsUri` or `bigqueryUri` can be set.");if(!e.gcsUri&&!e.bigqueryUri)throw new Error("One of `gcsUri` or `bigqueryUri` must be set.")}else{if(e.inlinedRequests&&e.fileName)throw new Error("Only one of `inlinedRequests` or `fileName` can be set.");if(!e.inlinedRequests&&!e.fileName)throw new Error("One of `inlinedRequests` or `fileName` must be set.")}return e}else{if(Array.isArray(e))return{inlinedRequests:e};if(typeof e=="string"){if(e.startsWith("gs://"))return{format:"jsonl",gcsUri:[e]};if(e.startsWith("bq://"))return{format:"bigquery",bigqueryUri:e};if(e.startsWith("files/"))return{fileName:e}}}throw new Error(`Unsupported source: ${e}`)}function Av(t){if(typeof t!="string")return t;const e=t;if(e.startsWith("gs://"))return{format:"jsonl",gcsUri:e};if(e.startsWith("bq://"))return{format:"bigquery",bigqueryUri:e};throw new Error(`Unsupported destination: ${e}`)}function Ds(t,e){const n=e;if(!t.isVertexAI()){if(/batches\/[^/]+$/.test(n))return n.split("/").pop();throw new Error(`Invalid batch job name: ${n}.`)}if(/^projects\/[^/]+\/locations\/[^/]+\/batchPredictionJobs\/[^/]+$/.test(n))return n.split("/").pop();if(/^\d+$/.test(n))return n;throw new Error(`Invalid batch job name: ${n}.`)}function oh(t){const e=t;return e==="BATCH_STATE_UNSPECIFIED"?"JOB_STATE_UNSPECIFIED":e==="BATCH_STATE_PENDING"?"JOB_STATE_PENDING":e==="BATCH_STATE_SUCCEEDED"?"JOB_STATE_SUCCEEDED":e==="BATCH_STATE_FAILED"?"JOB_STATE_FAILED":e==="BATCH_STATE_CANCELLED"?"JOB_STATE_CANCELLED":e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Dv(t){const e={},n=a(t,["fps"]);n!=null&&l(e,["fps"],n);const o=a(t,["endOffset"]);o!=null&&l(e,["endOffset"],o);const i=a(t,["startOffset"]);return i!=null&&l(e,["startOffset"],i),e}function Mv(t){const e={};if(a(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=a(t,["data"]);n!=null&&l(e,["data"],n);const o=a(t,["mimeType"]);return o!=null&&l(e,["mimeType"],o),e}function Rv(t){const e={};if(a(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=a(t,["fileUri"]);n!=null&&l(e,["fileUri"],n);const o=a(t,["mimeType"]);return o!=null&&l(e,["mimeType"],o),e}function Pv(t){const e={},n=a(t,["videoMetadata"]);n!=null&&l(e,["videoMetadata"],Dv(n));const o=a(t,["thought"]);o!=null&&l(e,["thought"],o);const i=a(t,["inlineData"]);i!=null&&l(e,["inlineData"],Mv(i));const c=a(t,["fileData"]);c!=null&&l(e,["fileData"],Rv(c));const f=a(t,["thoughtSignature"]);f!=null&&l(e,["thoughtSignature"],f);const m=a(t,["codeExecutionResult"]);m!=null&&l(e,["codeExecutionResult"],m);const h=a(t,["executableCode"]);h!=null&&l(e,["executableCode"],h);const p=a(t,["functionCall"]);p!=null&&l(e,["functionCall"],p);const v=a(t,["functionResponse"]);v!=null&&l(e,["functionResponse"],v);const x=a(t,["text"]);return x!=null&&l(e,["text"],x),e}function sh(t){const e={},n=a(t,["parts"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(c=>Pv(c))),l(e,["parts"],i)}const o=a(t,["role"]);return o!=null&&l(e,["role"],o),e}function Fv(t){const e={},n=a(t,["anyOf"]);n!=null&&l(e,["anyOf"],n);const o=a(t,["default"]);o!=null&&l(e,["default"],o);const i=a(t,["description"]);i!=null&&l(e,["description"],i);const c=a(t,["enum"]);c!=null&&l(e,["enum"],c);const f=a(t,["example"]);f!=null&&l(e,["example"],f);const m=a(t,["format"]);m!=null&&l(e,["format"],m);const h=a(t,["items"]);h!=null&&l(e,["items"],h);const p=a(t,["maxItems"]);p!=null&&l(e,["maxItems"],p);const v=a(t,["maxLength"]);v!=null&&l(e,["maxLength"],v);const x=a(t,["maxProperties"]);x!=null&&l(e,["maxProperties"],x);const C=a(t,["maximum"]);C!=null&&l(e,["maximum"],C);const S=a(t,["minItems"]);S!=null&&l(e,["minItems"],S);const b=a(t,["minLength"]);b!=null&&l(e,["minLength"],b);const T=a(t,["minProperties"]);T!=null&&l(e,["minProperties"],T);const A=a(t,["minimum"]);A!=null&&l(e,["minimum"],A);const D=a(t,["nullable"]);D!=null&&l(e,["nullable"],D);const F=a(t,["pattern"]);F!=null&&l(e,["pattern"],F);const L=a(t,["properties"]);L!=null&&l(e,["properties"],L);const R=a(t,["propertyOrdering"]);R!=null&&l(e,["propertyOrdering"],R);const P=a(t,["required"]);P!=null&&l(e,["required"],P);const G=a(t,["title"]);G!=null&&l(e,["title"],G);const $=a(t,["type"]);return $!=null&&l(e,["type"],$),e}function Lv(t){const e={};if(a(t,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const n=a(t,["category"]);n!=null&&l(e,["category"],n);const o=a(t,["threshold"]);return o!=null&&l(e,["threshold"],o),e}function Uv(t){const e={},n=a(t,["behavior"]);n!=null&&l(e,["behavior"],n);const o=a(t,["description"]);o!=null&&l(e,["description"],o);const i=a(t,["name"]);i!=null&&l(e,["name"],i);const c=a(t,["parameters"]);c!=null&&l(e,["parameters"],c);const f=a(t,["parametersJsonSchema"]);f!=null&&l(e,["parametersJsonSchema"],f);const m=a(t,["response"]);m!=null&&l(e,["response"],m);const h=a(t,["responseJsonSchema"]);return h!=null&&l(e,["responseJsonSchema"],h),e}function jv(t){const e={},n=a(t,["startTime"]);n!=null&&l(e,["startTime"],n);const o=a(t,["endTime"]);return o!=null&&l(e,["endTime"],o),e}function qv(t){const e={},n=a(t,["timeRangeFilter"]);if(n!=null&&l(e,["timeRangeFilter"],jv(n)),a(t,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");return e}function zv(t){const e={},n=a(t,["mode"]);n!=null&&l(e,["mode"],n);const o=a(t,["dynamicThreshold"]);return o!=null&&l(e,["dynamicThreshold"],o),e}function Ov(t){const e={},n=a(t,["dynamicRetrievalConfig"]);return n!=null&&l(e,["dynamicRetrievalConfig"],zv(n)),e}function Bv(){return{}}function Vv(t){const e={},n=a(t,["environment"]);return n!=null&&l(e,["environment"],n),e}function Gv(t){const e={},n=a(t,["functionDeclarations"]);if(n!=null){let h=n;Array.isArray(h)&&(h=h.map(p=>Uv(p))),l(e,["functionDeclarations"],h)}if(a(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const o=a(t,["googleSearch"]);o!=null&&l(e,["googleSearch"],qv(o));const i=a(t,["googleSearchRetrieval"]);if(i!=null&&l(e,["googleSearchRetrieval"],Ov(i)),a(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(a(t,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");a(t,["urlContext"])!=null&&l(e,["urlContext"],Bv());const f=a(t,["computerUse"]);f!=null&&l(e,["computerUse"],Vv(f));const m=a(t,["codeExecution"]);return m!=null&&l(e,["codeExecution"],m),e}function $v(t){const e={},n=a(t,["mode"]);n!=null&&l(e,["mode"],n);const o=a(t,["allowedFunctionNames"]);return o!=null&&l(e,["allowedFunctionNames"],o),e}function Hv(t){const e={},n=a(t,["latitude"]);n!=null&&l(e,["latitude"],n);const o=a(t,["longitude"]);return o!=null&&l(e,["longitude"],o),e}function Wv(t){const e={},n=a(t,["latLng"]);n!=null&&l(e,["latLng"],Hv(n));const o=a(t,["languageCode"]);return o!=null&&l(e,["languageCode"],o),e}function Jv(t){const e={},n=a(t,["functionCallingConfig"]);n!=null&&l(e,["functionCallingConfig"],$v(n));const o=a(t,["retrievalConfig"]);return o!=null&&l(e,["retrievalConfig"],Wv(o)),e}function Yv(t){const e={},n=a(t,["voiceName"]);return n!=null&&l(e,["voiceName"],n),e}function ih(t){const e={},n=a(t,["prebuiltVoiceConfig"]);return n!=null&&l(e,["prebuiltVoiceConfig"],Yv(n)),e}function Qv(t){const e={},n=a(t,["speaker"]);n!=null&&l(e,["speaker"],n);const o=a(t,["voiceConfig"]);return o!=null&&l(e,["voiceConfig"],ih(o)),e}function Kv(t){const e={},n=a(t,["speakerVoiceConfigs"]);if(n!=null){let o=n;Array.isArray(o)&&(o=o.map(i=>Qv(i))),l(e,["speakerVoiceConfigs"],o)}return e}function Zv(t){const e={},n=a(t,["voiceConfig"]);n!=null&&l(e,["voiceConfig"],ih(n));const o=a(t,["multiSpeakerVoiceConfig"]);o!=null&&l(e,["multiSpeakerVoiceConfig"],Kv(o));const i=a(t,["languageCode"]);return i!=null&&l(e,["languageCode"],i),e}function Xv(t){const e={},n=a(t,["includeThoughts"]);n!=null&&l(e,["includeThoughts"],n);const o=a(t,["thinkingBudget"]);return o!=null&&l(e,["thinkingBudget"],o),e}function ex(t,e,n){const o={},i=a(e,["systemInstruction"]);n!==void 0&&i!=null&&l(n,["systemInstruction"],sh(hn(i)));const c=a(e,["temperature"]);c!=null&&l(o,["temperature"],c);const f=a(e,["topP"]);f!=null&&l(o,["topP"],f);const m=a(e,["topK"]);m!=null&&l(o,["topK"],m);const h=a(e,["candidateCount"]);h!=null&&l(o,["candidateCount"],h);const p=a(e,["maxOutputTokens"]);p!=null&&l(o,["maxOutputTokens"],p);const v=a(e,["stopSequences"]);v!=null&&l(o,["stopSequences"],v);const x=a(e,["responseLogprobs"]);x!=null&&l(o,["responseLogprobs"],x);const C=a(e,["logprobs"]);C!=null&&l(o,["logprobs"],C);const S=a(e,["presencePenalty"]);S!=null&&l(o,["presencePenalty"],S);const b=a(e,["frequencyPenalty"]);b!=null&&l(o,["frequencyPenalty"],b);const T=a(e,["seed"]);T!=null&&l(o,["seed"],T);const A=a(e,["responseMimeType"]);A!=null&&l(o,["responseMimeType"],A);const D=a(e,["responseSchema"]);D!=null&&l(o,["responseSchema"],Fv(bc(D)));const F=a(e,["responseJsonSchema"]);if(F!=null&&l(o,["responseJsonSchema"],F),a(e,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(a(e,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const L=a(e,["safetySettings"]);if(n!==void 0&&L!=null){let le=L;Array.isArray(le)&&(le=le.map(Q=>Lv(Q))),l(n,["safetySettings"],le)}const R=a(e,["tools"]);if(n!==void 0&&R!=null){let le=As(R);Array.isArray(le)&&(le=le.map(Q=>Gv(Is(Q)))),l(n,["tools"],le)}const P=a(e,["toolConfig"]);if(n!==void 0&&P!=null&&l(n,["toolConfig"],Jv(P)),a(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const G=a(e,["cachedContent"]);n!==void 0&&G!=null&&l(n,["cachedContent"],Pr(t,G));const $=a(e,["responseModalities"]);$!=null&&l(o,["responseModalities"],$);const oe=a(e,["mediaResolution"]);oe!=null&&l(o,["mediaResolution"],oe);const J=a(e,["speechConfig"]);if(J!=null&&l(o,["speechConfig"],Zv(Nc(J))),a(e,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const Z=a(e,["thinkingConfig"]);return Z!=null&&l(o,["thinkingConfig"],Xv(Z)),o}function tx(t,e){const n={},o=a(e,["model"]);o!=null&&l(n,["request","model"],_t(t,o));const i=a(e,["contents"]);if(i!=null){let f=Wn(i);Array.isArray(f)&&(f=f.map(m=>sh(m))),l(n,["request","contents"],f)}const c=a(e,["config"]);return c!=null&&l(n,["request","generationConfig"],ex(t,c,n)),n}function nx(t,e){const n={};if(a(e,["format"])!==void 0)throw new Error("format parameter is not supported in Gemini API.");if(a(e,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(a(e,["bigqueryUri"])!==void 0)throw new Error("bigqueryUri parameter is not supported in Gemini API.");const o=a(e,["fileName"]);o!=null&&l(n,["fileName"],o);const i=a(e,["inlinedRequests"]);if(i!=null){let c=i;Array.isArray(c)&&(c=c.map(f=>tx(t,f))),l(n,["requests","requests"],c)}return n}function rx(t,e){const n={},o=a(t,["displayName"]);if(e!==void 0&&o!=null&&l(e,["batch","displayName"],o),a(t,["dest"])!==void 0)throw new Error("dest parameter is not supported in Gemini API.");return n}function lp(t,e){const n={},o=a(e,["model"]);o!=null&&l(n,["_url","model"],_t(t,o));const i=a(e,["src"]);i!=null&&l(n,["batch","inputConfig"],nx(t,rh(t,i)));const c=a(e,["config"]);return c!=null&&l(n,["config"],rx(c,n)),n}function ox(t,e){const n={},o=a(e,["name"]);o!=null&&l(n,["_url","name"],Ds(t,o));const i=a(e,["config"]);return i!=null&&l(n,["config"],i),n}function sx(t,e){const n={},o=a(e,["name"]);o!=null&&l(n,["_url","name"],Ds(t,o));const i=a(e,["config"]);return i!=null&&l(n,["config"],i),n}function ix(t,e){const n={},o=a(t,["pageSize"]);e!==void 0&&o!=null&&l(e,["_query","pageSize"],o);const i=a(t,["pageToken"]);if(e!==void 0&&i!=null&&l(e,["_query","pageToken"],i),a(t,["filter"])!==void 0)throw new Error("filter parameter is not supported in Gemini API.");return n}function ax(t){const e={},n=a(t,["config"]);return n!=null&&l(e,["config"],ix(n,e)),e}function lx(t,e){const n={},o=a(e,["name"]);o!=null&&l(n,["_url","name"],Ds(t,o));const i=a(e,["config"]);return i!=null&&l(n,["config"],i),n}function ux(t){const e={},n=a(t,["format"]);n!=null&&l(e,["instancesFormat"],n);const o=a(t,["gcsUri"]);o!=null&&l(e,["gcsSource","uris"],o);const i=a(t,["bigqueryUri"]);if(i!=null&&l(e,["bigquerySource","inputUri"],i),a(t,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(a(t,["inlinedRequests"])!==void 0)throw new Error("inlinedRequests parameter is not supported in Vertex AI.");return e}function cx(t){const e={},n=a(t,["format"]);n!=null&&l(e,["predictionsFormat"],n);const o=a(t,["gcsUri"]);o!=null&&l(e,["gcsDestination","outputUriPrefix"],o);const i=a(t,["bigqueryUri"]);if(i!=null&&l(e,["bigqueryDestination","outputUri"],i),a(t,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(a(t,["inlinedResponses"])!==void 0)throw new Error("inlinedResponses parameter is not supported in Vertex AI.");return e}function dx(t,e){const n={},o=a(t,["displayName"]);e!==void 0&&o!=null&&l(e,["displayName"],o);const i=a(t,["dest"]);return e!==void 0&&i!=null&&l(e,["outputConfig"],cx(Av(i))),n}function fx(t,e){const n={},o=a(e,["model"]);o!=null&&l(n,["model"],_t(t,o));const i=a(e,["src"]);i!=null&&l(n,["inputConfig"],ux(rh(t,i)));const c=a(e,["config"]);return c!=null&&l(n,["config"],dx(c,n)),n}function mx(t,e){const n={},o=a(e,["name"]);o!=null&&l(n,["_url","name"],Ds(t,o));const i=a(e,["config"]);return i!=null&&l(n,["config"],i),n}function px(t,e){const n={},o=a(e,["name"]);o!=null&&l(n,["_url","name"],Ds(t,o));const i=a(e,["config"]);return i!=null&&l(n,["config"],i),n}function hx(t,e){const n={},o=a(t,["pageSize"]);e!==void 0&&o!=null&&l(e,["_query","pageSize"],o);const i=a(t,["pageToken"]);e!==void 0&&i!=null&&l(e,["_query","pageToken"],i);const c=a(t,["filter"]);return e!==void 0&&c!=null&&l(e,["_query","filter"],c),n}function gx(t){const e={},n=a(t,["config"]);return n!=null&&l(e,["config"],hx(n,e)),e}function yx(t,e){const n={},o=a(e,["name"]);o!=null&&l(n,["_url","name"],Ds(t,o));const i=a(e,["config"]);return i!=null&&l(n,["config"],i),n}function vx(t){const e={},n=a(t,["fps"]);n!=null&&l(e,["fps"],n);const o=a(t,["endOffset"]);o!=null&&l(e,["endOffset"],o);const i=a(t,["startOffset"]);return i!=null&&l(e,["startOffset"],i),e}function xx(t){const e={},n=a(t,["data"]);n!=null&&l(e,["data"],n);const o=a(t,["mimeType"]);return o!=null&&l(e,["mimeType"],o),e}function wx(t){const e={},n=a(t,["fileUri"]);n!=null&&l(e,["fileUri"],n);const o=a(t,["mimeType"]);return o!=null&&l(e,["mimeType"],o),e}function Cx(t){const e={},n=a(t,["videoMetadata"]);n!=null&&l(e,["videoMetadata"],vx(n));const o=a(t,["thought"]);o!=null&&l(e,["thought"],o);const i=a(t,["inlineData"]);i!=null&&l(e,["inlineData"],xx(i));const c=a(t,["fileData"]);c!=null&&l(e,["fileData"],wx(c));const f=a(t,["thoughtSignature"]);f!=null&&l(e,["thoughtSignature"],f);const m=a(t,["codeExecutionResult"]);m!=null&&l(e,["codeExecutionResult"],m);const h=a(t,["executableCode"]);h!=null&&l(e,["executableCode"],h);const p=a(t,["functionCall"]);p!=null&&l(e,["functionCall"],p);const v=a(t,["functionResponse"]);v!=null&&l(e,["functionResponse"],v);const x=a(t,["text"]);return x!=null&&l(e,["text"],x),e}function Sx(t){const e={},n=a(t,["parts"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(c=>Cx(c))),l(e,["parts"],i)}const o=a(t,["role"]);return o!=null&&l(e,["role"],o),e}function kx(t){const e={},n=a(t,["citationSources"]);return n!=null&&l(e,["citations"],n),e}function Tx(t){const e={},n=a(t,["retrievedUrl"]);n!=null&&l(e,["retrievedUrl"],n);const o=a(t,["urlRetrievalStatus"]);return o!=null&&l(e,["urlRetrievalStatus"],o),e}function _x(t){const e={},n=a(t,["urlMetadata"]);if(n!=null){let o=n;Array.isArray(o)&&(o=o.map(i=>Tx(i))),l(e,["urlMetadata"],o)}return e}function Ex(t){const e={},n=a(t,["content"]);n!=null&&l(e,["content"],Sx(n));const o=a(t,["citationMetadata"]);o!=null&&l(e,["citationMetadata"],kx(o));const i=a(t,["tokenCount"]);i!=null&&l(e,["tokenCount"],i);const c=a(t,["finishReason"]);c!=null&&l(e,["finishReason"],c);const f=a(t,["urlContextMetadata"]);f!=null&&l(e,["urlContextMetadata"],_x(f));const m=a(t,["avgLogprobs"]);m!=null&&l(e,["avgLogprobs"],m);const h=a(t,["groundingMetadata"]);h!=null&&l(e,["groundingMetadata"],h);const p=a(t,["index"]);p!=null&&l(e,["index"],p);const v=a(t,["logprobsResult"]);v!=null&&l(e,["logprobsResult"],v);const x=a(t,["safetyRatings"]);return x!=null&&l(e,["safetyRatings"],x),e}function bx(t){const e={},n=a(t,["sdkHttpResponse"]);n!=null&&l(e,["sdkHttpResponse"],n);const o=a(t,["candidates"]);if(o!=null){let h=o;Array.isArray(h)&&(h=h.map(p=>Ex(p))),l(e,["candidates"],h)}const i=a(t,["modelVersion"]);i!=null&&l(e,["modelVersion"],i);const c=a(t,["promptFeedback"]);c!=null&&l(e,["promptFeedback"],c);const f=a(t,["responseId"]);f!=null&&l(e,["responseId"],f);const m=a(t,["usageMetadata"]);return m!=null&&l(e,["usageMetadata"],m),e}function ah(t){const e={},n=a(t,["details"]);n!=null&&l(e,["details"],n);const o=a(t,["code"]);o!=null&&l(e,["code"],o);const i=a(t,["message"]);return i!=null&&l(e,["message"],i),e}function Nx(t){const e={},n=a(t,["response"]);n!=null&&l(e,["response"],bx(n));const o=a(t,["error"]);return o!=null&&l(e,["error"],ah(o)),e}function Ix(t){const e={},n=a(t,["responsesFile"]);n!=null&&l(e,["fileName"],n);const o=a(t,["inlinedResponses","inlinedResponses"]);if(o!=null){let i=o;Array.isArray(i)&&(i=i.map(c=>Nx(c))),l(e,["inlinedResponses"],i)}return e}function qa(t){const e={},n=a(t,["name"]);n!=null&&l(e,["name"],n);const o=a(t,["metadata","displayName"]);o!=null&&l(e,["displayName"],o);const i=a(t,["metadata","state"]);i!=null&&l(e,["state"],oh(i));const c=a(t,["metadata","createTime"]);c!=null&&l(e,["createTime"],c);const f=a(t,["metadata","endTime"]);f!=null&&l(e,["endTime"],f);const m=a(t,["metadata","updateTime"]);m!=null&&l(e,["updateTime"],m);const h=a(t,["metadata","model"]);h!=null&&l(e,["model"],h);const p=a(t,["metadata","output"]);return p!=null&&l(e,["dest"],Ix(p)),e}function Ax(t){const e={},n=a(t,["sdkHttpResponse"]);n!=null&&l(e,["sdkHttpResponse"],n);const o=a(t,["nextPageToken"]);o!=null&&l(e,["nextPageToken"],o);const i=a(t,["operations"]);if(i!=null){let c=i;Array.isArray(c)&&(c=c.map(f=>qa(f))),l(e,["batchJobs"],c)}return e}function Dx(t){const e={},n=a(t,["sdkHttpResponse"]);n!=null&&l(e,["sdkHttpResponse"],n);const o=a(t,["name"]);o!=null&&l(e,["name"],o);const i=a(t,["done"]);i!=null&&l(e,["done"],i);const c=a(t,["error"]);return c!=null&&l(e,["error"],ah(c)),e}function lh(t){const e={},n=a(t,["details"]);n!=null&&l(e,["details"],n);const o=a(t,["code"]);o!=null&&l(e,["code"],o);const i=a(t,["message"]);return i!=null&&l(e,["message"],i),e}function Mx(t){const e={},n=a(t,["instancesFormat"]);n!=null&&l(e,["format"],n);const o=a(t,["gcsSource","uris"]);o!=null&&l(e,["gcsUri"],o);const i=a(t,["bigquerySource","inputUri"]);return i!=null&&l(e,["bigqueryUri"],i),e}function Rx(t){const e={},n=a(t,["predictionsFormat"]);n!=null&&l(e,["format"],n);const o=a(t,["gcsDestination","outputUriPrefix"]);o!=null&&l(e,["gcsUri"],o);const i=a(t,["bigqueryDestination","outputUri"]);return i!=null&&l(e,["bigqueryUri"],i),e}function mc(t){const e={},n=a(t,["name"]);n!=null&&l(e,["name"],n);const o=a(t,["displayName"]);o!=null&&l(e,["displayName"],o);const i=a(t,["state"]);i!=null&&l(e,["state"],oh(i));const c=a(t,["error"]);c!=null&&l(e,["error"],lh(c));const f=a(t,["createTime"]);f!=null&&l(e,["createTime"],f);const m=a(t,["startTime"]);m!=null&&l(e,["startTime"],m);const h=a(t,["endTime"]);h!=null&&l(e,["endTime"],h);const p=a(t,["updateTime"]);p!=null&&l(e,["updateTime"],p);const v=a(t,["model"]);v!=null&&l(e,["model"],v);const x=a(t,["inputConfig"]);x!=null&&l(e,["src"],Mx(x));const C=a(t,["outputConfig"]);return C!=null&&l(e,["dest"],Rx(C)),e}function Px(t){const e={},n=a(t,["sdkHttpResponse"]);n!=null&&l(e,["sdkHttpResponse"],n);const o=a(t,["nextPageToken"]);o!=null&&l(e,["nextPageToken"],o);const i=a(t,["batchPredictionJobs"]);if(i!=null){let c=i;Array.isArray(c)&&(c=c.map(f=>mc(f))),l(e,["batchJobs"],c)}return e}function Fx(t){const e={},n=a(t,["sdkHttpResponse"]);n!=null&&l(e,["sdkHttpResponse"],n);const o=a(t,["name"]);o!=null&&l(e,["name"],o);const i=a(t,["done"]);i!=null&&l(e,["done"],i);const c=a(t,["error"]);return c!=null&&l(e,["error"],lh(c)),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var Bo;(function(t){t.PAGED_ITEM_BATCH_JOBS="batchJobs",t.PAGED_ITEM_MODELS="models",t.PAGED_ITEM_TUNING_JOBS="tuningJobs",t.PAGED_ITEM_FILES="files",t.PAGED_ITEM_CACHED_CONTENTS="cachedContents"})(Bo||(Bo={}));class xi{constructor(e,n,o,i){this.pageInternal=[],this.paramsInternal={},this.requestInternal=n,this.init(e,o,i)}init(e,n,o){var i,c;this.nameInternal=e,this.pageInternal=n[this.nameInternal]||[],this.sdkHttpResponseInternal=n==null?void 0:n.sdkHttpResponse,this.idxInternal=0;let f={config:{}};!o||Object.keys(o).length===0?f={config:{}}:typeof o=="object"?f=Object.assign({},o):f=o,f.config&&(f.config.pageToken=n.nextPageToken),this.paramsInternal=f,this.pageInternalSize=(c=(i=f.config)===null||i===void 0?void 0:i.pageSize)!==null&&c!==void 0?c:this.pageInternal.length}initNextPage(e){this.init(this.nameInternal,e,this.paramsInternal)}get page(){return this.pageInternal}get name(){return this.nameInternal}get pageSize(){return this.pageInternalSize}get sdkHttpResponse(){return this.sdkHttpResponseInternal}get params(){return this.paramsInternal}get pageLength(){return this.pageInternal.length}getItem(e){return this.pageInternal[e]}[Symbol.asyncIterator](){return{next:async()=>{if(this.idxInternal>=this.pageLength)if(this.hasNextPage())await this.nextPage();else return{value:void 0,done:!0};const e=this.getItem(this.idxInternal);return this.idxInternal+=1,{value:e,done:!1}},return:async()=>({value:void 0,done:!0})}}async nextPage(){if(!this.hasNextPage())throw new Error("No more pages to fetch.");const e=await this.requestInternal(this.params);return this.initNextPage(e),this.page}hasNextPage(){var e;return((e=this.params.config)===null||e===void 0?void 0:e.pageToken)!==void 0}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Lx extends Go{constructor(e){super(),this.apiClient=e,this.create=async n=>{var o,i;if(this.apiClient.isVertexAI()){const f=Date.now().toString();if(Array.isArray(n.src))throw new Error("InlinedRequest[] is not supported in Vertex AI. Please use Google Cloud Storage URI or BigQuery URI instead.");if(n.config=n.config||{},n.config.displayName===void 0&&(n.config.displayName="genaiBatchJob_${timestampStr}"),n.config.dest===void 0&&typeof n.src=="string")if(n.src.startsWith("gs://")&&n.src.endsWith(".jsonl"))n.config.dest=`${n.src.slice(0,-6)}/dest`;else if(n.src.startsWith("bq://"))n.config.dest=`${n.src}_dest_${f}`;else throw new Error("Unsupported source:"+n.src)}else if(Array.isArray(n.src)||typeof n.src!="string"&&n.src.inlinedRequests){let c="",f={};const m=lp(this.apiClient,n);c=Qe("{model}:batchGenerateContent",m._url),f=m._query;const v=m.batch.inputConfig.requests,x=v.requests,C=[];for(const b of x){const T=b;if(T.systemInstruction){const A=T.systemInstruction;delete T.systemInstruction;const D=T.request;D.systemInstruction=A,T.request=D}C.push(T)}return v.requests=C,delete m.config,delete m._url,delete m._query,this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(o=n.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(i=n.config)===null||i===void 0?void 0:i.abortSignal}).then(b=>b.json()).then(b=>qa(b))}return await this.createInternal(n)},this.list=async(n={})=>new xi(Bo.PAGED_ITEM_BATCH_JOBS,o=>this.listInternal(o),await this.listInternal(n),n)}async createInternal(e){var n,o,i,c;let f,m="",h={};if(this.apiClient.isVertexAI()){const p=fx(this.apiClient,e);return m=Qe("batchPredictionJobs",p._url),h=p._query,delete p.config,delete p._url,delete p._query,f=this.apiClient.request({path:m,queryParams:h,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(v=>v.json()),f.then(v=>mc(v))}else{const p=lp(this.apiClient,e);return m=Qe("{model}:batchGenerateContent",p._url),h=p._query,delete p.config,delete p._url,delete p._query,f=this.apiClient.request({path:m,queryParams:h,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(c=e.config)===null||c===void 0?void 0:c.abortSignal}).then(v=>v.json()),f.then(v=>qa(v))}}async get(e){var n,o,i,c;let f,m="",h={};if(this.apiClient.isVertexAI()){const p=mx(this.apiClient,e);return m=Qe("batchPredictionJobs/{name}",p._url),h=p._query,delete p.config,delete p._url,delete p._query,f=this.apiClient.request({path:m,queryParams:h,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(v=>v.json()),f.then(v=>mc(v))}else{const p=ox(this.apiClient,e);return m=Qe("batches/{name}",p._url),h=p._query,delete p.config,delete p._url,delete p._query,f=this.apiClient.request({path:m,queryParams:h,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(c=e.config)===null||c===void 0?void 0:c.abortSignal}).then(v=>v.json()),f.then(v=>qa(v))}}async cancel(e){var n,o,i,c;let f="",m={};if(this.apiClient.isVertexAI()){const h=px(this.apiClient,e);f=Qe("batchPredictionJobs/{name}:cancel",h._url),m=h._query,delete h.config,delete h._url,delete h._query,await this.apiClient.request({path:f,queryParams:m,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal})}else{const h=sx(this.apiClient,e);f=Qe("batches/{name}:cancel",h._url),m=h._query,delete h.config,delete h._url,delete h._query,await this.apiClient.request({path:f,queryParams:m,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(c=e.config)===null||c===void 0?void 0:c.abortSignal})}}async listInternal(e){var n,o,i,c;let f,m="",h={};if(this.apiClient.isVertexAI()){const p=gx(e);return m=Qe("batchPredictionJobs",p._url),h=p._query,delete p.config,delete p._url,delete p._query,f=this.apiClient.request({path:m,queryParams:h,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(v=>v.json().then(x=>{const C=x;return C.sdkHttpResponse={headers:v.headers},C})),f.then(v=>{const x=Px(v),C=new op;return Object.assign(C,x),C})}else{const p=ax(e);return m=Qe("batches",p._url),h=p._query,delete p.config,delete p._url,delete p._query,f=this.apiClient.request({path:m,queryParams:h,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(c=e.config)===null||c===void 0?void 0:c.abortSignal}).then(v=>v.json().then(x=>{const C=x;return C.sdkHttpResponse={headers:v.headers},C})),f.then(v=>{const x=Ax(v),C=new op;return Object.assign(C,x),C})}}async delete(e){var n,o,i,c;let f,m="",h={};if(this.apiClient.isVertexAI()){const p=yx(this.apiClient,e);return m=Qe("batchPredictionJobs/{name}",p._url),h=p._query,delete p.config,delete p._url,delete p._query,f=this.apiClient.request({path:m,queryParams:h,body:JSON.stringify(p),httpMethod:"DELETE",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(v=>v.json().then(x=>{const C=x;return C.sdkHttpResponse={headers:v.headers},C})),f.then(v=>Fx(v))}else{const p=lx(this.apiClient,e);return m=Qe("batches/{name}",p._url),h=p._query,delete p.config,delete p._url,delete p._query,f=this.apiClient.request({path:m,queryParams:h,body:JSON.stringify(p),httpMethod:"DELETE",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(c=e.config)===null||c===void 0?void 0:c.abortSignal}).then(v=>v.json().then(x=>{const C=x;return C.sdkHttpResponse={headers:v.headers},C})),f.then(v=>Dx(v))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Ux(t){const e={},n=a(t,["fps"]);n!=null&&l(e,["fps"],n);const o=a(t,["endOffset"]);o!=null&&l(e,["endOffset"],o);const i=a(t,["startOffset"]);return i!=null&&l(e,["startOffset"],i),e}function jx(t){const e={};if(a(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=a(t,["data"]);n!=null&&l(e,["data"],n);const o=a(t,["mimeType"]);return o!=null&&l(e,["mimeType"],o),e}function qx(t){const e={};if(a(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=a(t,["fileUri"]);n!=null&&l(e,["fileUri"],n);const o=a(t,["mimeType"]);return o!=null&&l(e,["mimeType"],o),e}function zx(t){const e={},n=a(t,["videoMetadata"]);n!=null&&l(e,["videoMetadata"],Ux(n));const o=a(t,["thought"]);o!=null&&l(e,["thought"],o);const i=a(t,["inlineData"]);i!=null&&l(e,["inlineData"],jx(i));const c=a(t,["fileData"]);c!=null&&l(e,["fileData"],qx(c));const f=a(t,["thoughtSignature"]);f!=null&&l(e,["thoughtSignature"],f);const m=a(t,["codeExecutionResult"]);m!=null&&l(e,["codeExecutionResult"],m);const h=a(t,["executableCode"]);h!=null&&l(e,["executableCode"],h);const p=a(t,["functionCall"]);p!=null&&l(e,["functionCall"],p);const v=a(t,["functionResponse"]);v!=null&&l(e,["functionResponse"],v);const x=a(t,["text"]);return x!=null&&l(e,["text"],x),e}function up(t){const e={},n=a(t,["parts"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(c=>zx(c))),l(e,["parts"],i)}const o=a(t,["role"]);return o!=null&&l(e,["role"],o),e}function Ox(t){const e={},n=a(t,["behavior"]);n!=null&&l(e,["behavior"],n);const o=a(t,["description"]);o!=null&&l(e,["description"],o);const i=a(t,["name"]);i!=null&&l(e,["name"],i);const c=a(t,["parameters"]);c!=null&&l(e,["parameters"],c);const f=a(t,["parametersJsonSchema"]);f!=null&&l(e,["parametersJsonSchema"],f);const m=a(t,["response"]);m!=null&&l(e,["response"],m);const h=a(t,["responseJsonSchema"]);return h!=null&&l(e,["responseJsonSchema"],h),e}function Bx(t){const e={},n=a(t,["startTime"]);n!=null&&l(e,["startTime"],n);const o=a(t,["endTime"]);return o!=null&&l(e,["endTime"],o),e}function Vx(t){const e={},n=a(t,["timeRangeFilter"]);if(n!=null&&l(e,["timeRangeFilter"],Bx(n)),a(t,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");return e}function Gx(t){const e={},n=a(t,["mode"]);n!=null&&l(e,["mode"],n);const o=a(t,["dynamicThreshold"]);return o!=null&&l(e,["dynamicThreshold"],o),e}function $x(t){const e={},n=a(t,["dynamicRetrievalConfig"]);return n!=null&&l(e,["dynamicRetrievalConfig"],Gx(n)),e}function Hx(){return{}}function Wx(t){const e={},n=a(t,["environment"]);return n!=null&&l(e,["environment"],n),e}function Jx(t){const e={},n=a(t,["functionDeclarations"]);if(n!=null){let h=n;Array.isArray(h)&&(h=h.map(p=>Ox(p))),l(e,["functionDeclarations"],h)}if(a(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const o=a(t,["googleSearch"]);o!=null&&l(e,["googleSearch"],Vx(o));const i=a(t,["googleSearchRetrieval"]);if(i!=null&&l(e,["googleSearchRetrieval"],$x(i)),a(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(a(t,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");a(t,["urlContext"])!=null&&l(e,["urlContext"],Hx());const f=a(t,["computerUse"]);f!=null&&l(e,["computerUse"],Wx(f));const m=a(t,["codeExecution"]);return m!=null&&l(e,["codeExecution"],m),e}function Yx(t){const e={},n=a(t,["mode"]);n!=null&&l(e,["mode"],n);const o=a(t,["allowedFunctionNames"]);return o!=null&&l(e,["allowedFunctionNames"],o),e}function Qx(t){const e={},n=a(t,["latitude"]);n!=null&&l(e,["latitude"],n);const o=a(t,["longitude"]);return o!=null&&l(e,["longitude"],o),e}function Kx(t){const e={},n=a(t,["latLng"]);n!=null&&l(e,["latLng"],Qx(n));const o=a(t,["languageCode"]);return o!=null&&l(e,["languageCode"],o),e}function Zx(t){const e={},n=a(t,["functionCallingConfig"]);n!=null&&l(e,["functionCallingConfig"],Yx(n));const o=a(t,["retrievalConfig"]);return o!=null&&l(e,["retrievalConfig"],Kx(o)),e}function Xx(t,e){const n={},o=a(t,["ttl"]);e!==void 0&&o!=null&&l(e,["ttl"],o);const i=a(t,["expireTime"]);e!==void 0&&i!=null&&l(e,["expireTime"],i);const c=a(t,["displayName"]);e!==void 0&&c!=null&&l(e,["displayName"],c);const f=a(t,["contents"]);if(e!==void 0&&f!=null){let v=Wn(f);Array.isArray(v)&&(v=v.map(x=>up(x))),l(e,["contents"],v)}const m=a(t,["systemInstruction"]);e!==void 0&&m!=null&&l(e,["systemInstruction"],up(hn(m)));const h=a(t,["tools"]);if(e!==void 0&&h!=null){let v=h;Array.isArray(v)&&(v=v.map(x=>Jx(x))),l(e,["tools"],v)}const p=a(t,["toolConfig"]);if(e!==void 0&&p!=null&&l(e,["toolConfig"],Zx(p)),a(t,["kmsKeyName"])!==void 0)throw new Error("kmsKeyName parameter is not supported in Gemini API.");return n}function e0(t,e){const n={},o=a(e,["model"]);o!=null&&l(n,["model"],Wp(t,o));const i=a(e,["config"]);return i!=null&&l(n,["config"],Xx(i,n)),n}function t0(t,e){const n={},o=a(e,["name"]);o!=null&&l(n,["_url","name"],Pr(t,o));const i=a(e,["config"]);return i!=null&&l(n,["config"],i),n}function n0(t,e){const n={},o=a(e,["name"]);o!=null&&l(n,["_url","name"],Pr(t,o));const i=a(e,["config"]);return i!=null&&l(n,["config"],i),n}function r0(t,e){const n={},o=a(t,["ttl"]);e!==void 0&&o!=null&&l(e,["ttl"],o);const i=a(t,["expireTime"]);return e!==void 0&&i!=null&&l(e,["expireTime"],i),n}function o0(t,e){const n={},o=a(e,["name"]);o!=null&&l(n,["_url","name"],Pr(t,o));const i=a(e,["config"]);return i!=null&&l(n,["config"],r0(i,n)),n}function s0(t,e){const n={},o=a(t,["pageSize"]);e!==void 0&&o!=null&&l(e,["_query","pageSize"],o);const i=a(t,["pageToken"]);return e!==void 0&&i!=null&&l(e,["_query","pageToken"],i),n}function i0(t){const e={},n=a(t,["config"]);return n!=null&&l(e,["config"],s0(n,e)),e}function a0(t){const e={},n=a(t,["fps"]);n!=null&&l(e,["fps"],n);const o=a(t,["endOffset"]);o!=null&&l(e,["endOffset"],o);const i=a(t,["startOffset"]);return i!=null&&l(e,["startOffset"],i),e}function l0(t){const e={},n=a(t,["displayName"]);n!=null&&l(e,["displayName"],n);const o=a(t,["data"]);o!=null&&l(e,["data"],o);const i=a(t,["mimeType"]);return i!=null&&l(e,["mimeType"],i),e}function u0(t){const e={},n=a(t,["displayName"]);n!=null&&l(e,["displayName"],n);const o=a(t,["fileUri"]);o!=null&&l(e,["fileUri"],o);const i=a(t,["mimeType"]);return i!=null&&l(e,["mimeType"],i),e}function c0(t){const e={},n=a(t,["videoMetadata"]);n!=null&&l(e,["videoMetadata"],a0(n));const o=a(t,["thought"]);o!=null&&l(e,["thought"],o);const i=a(t,["inlineData"]);i!=null&&l(e,["inlineData"],l0(i));const c=a(t,["fileData"]);c!=null&&l(e,["fileData"],u0(c));const f=a(t,["thoughtSignature"]);f!=null&&l(e,["thoughtSignature"],f);const m=a(t,["codeExecutionResult"]);m!=null&&l(e,["codeExecutionResult"],m);const h=a(t,["executableCode"]);h!=null&&l(e,["executableCode"],h);const p=a(t,["functionCall"]);p!=null&&l(e,["functionCall"],p);const v=a(t,["functionResponse"]);v!=null&&l(e,["functionResponse"],v);const x=a(t,["text"]);return x!=null&&l(e,["text"],x),e}function cp(t){const e={},n=a(t,["parts"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(c=>c0(c))),l(e,["parts"],i)}const o=a(t,["role"]);return o!=null&&l(e,["role"],o),e}function d0(t){const e={};if(a(t,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const n=a(t,["description"]);n!=null&&l(e,["description"],n);const o=a(t,["name"]);o!=null&&l(e,["name"],o);const i=a(t,["parameters"]);i!=null&&l(e,["parameters"],i);const c=a(t,["parametersJsonSchema"]);c!=null&&l(e,["parametersJsonSchema"],c);const f=a(t,["response"]);f!=null&&l(e,["response"],f);const m=a(t,["responseJsonSchema"]);return m!=null&&l(e,["responseJsonSchema"],m),e}function f0(t){const e={},n=a(t,["startTime"]);n!=null&&l(e,["startTime"],n);const o=a(t,["endTime"]);return o!=null&&l(e,["endTime"],o),e}function m0(t){const e={},n=a(t,["timeRangeFilter"]);n!=null&&l(e,["timeRangeFilter"],f0(n));const o=a(t,["excludeDomains"]);return o!=null&&l(e,["excludeDomains"],o),e}function p0(t){const e={},n=a(t,["mode"]);n!=null&&l(e,["mode"],n);const o=a(t,["dynamicThreshold"]);return o!=null&&l(e,["dynamicThreshold"],o),e}function h0(t){const e={},n=a(t,["dynamicRetrievalConfig"]);return n!=null&&l(e,["dynamicRetrievalConfig"],p0(n)),e}function g0(t){const e={},n=a(t,["excludeDomains"]);return n!=null&&l(e,["excludeDomains"],n),e}function y0(t){const e={},n=a(t,["apiKeyString"]);return n!=null&&l(e,["apiKeyString"],n),e}function v0(t){const e={},n=a(t,["apiKeyConfig"]);n!=null&&l(e,["apiKeyConfig"],y0(n));const o=a(t,["authType"]);o!=null&&l(e,["authType"],o);const i=a(t,["googleServiceAccountConfig"]);i!=null&&l(e,["googleServiceAccountConfig"],i);const c=a(t,["httpBasicAuthConfig"]);c!=null&&l(e,["httpBasicAuthConfig"],c);const f=a(t,["oauthConfig"]);f!=null&&l(e,["oauthConfig"],f);const m=a(t,["oidcConfig"]);return m!=null&&l(e,["oidcConfig"],m),e}function x0(t){const e={},n=a(t,["authConfig"]);return n!=null&&l(e,["authConfig"],v0(n)),e}function w0(){return{}}function C0(t){const e={},n=a(t,["environment"]);return n!=null&&l(e,["environment"],n),e}function S0(t){const e={},n=a(t,["functionDeclarations"]);if(n!=null){let x=n;Array.isArray(x)&&(x=x.map(C=>d0(C))),l(e,["functionDeclarations"],x)}const o=a(t,["retrieval"]);o!=null&&l(e,["retrieval"],o);const i=a(t,["googleSearch"]);i!=null&&l(e,["googleSearch"],m0(i));const c=a(t,["googleSearchRetrieval"]);c!=null&&l(e,["googleSearchRetrieval"],h0(c));const f=a(t,["enterpriseWebSearch"]);f!=null&&l(e,["enterpriseWebSearch"],g0(f));const m=a(t,["googleMaps"]);m!=null&&l(e,["googleMaps"],x0(m)),a(t,["urlContext"])!=null&&l(e,["urlContext"],w0());const p=a(t,["computerUse"]);p!=null&&l(e,["computerUse"],C0(p));const v=a(t,["codeExecution"]);return v!=null&&l(e,["codeExecution"],v),e}function k0(t){const e={},n=a(t,["mode"]);n!=null&&l(e,["mode"],n);const o=a(t,["allowedFunctionNames"]);return o!=null&&l(e,["allowedFunctionNames"],o),e}function T0(t){const e={},n=a(t,["latitude"]);n!=null&&l(e,["latitude"],n);const o=a(t,["longitude"]);return o!=null&&l(e,["longitude"],o),e}function _0(t){const e={},n=a(t,["latLng"]);n!=null&&l(e,["latLng"],T0(n));const o=a(t,["languageCode"]);return o!=null&&l(e,["languageCode"],o),e}function E0(t){const e={},n=a(t,["functionCallingConfig"]);n!=null&&l(e,["functionCallingConfig"],k0(n));const o=a(t,["retrievalConfig"]);return o!=null&&l(e,["retrievalConfig"],_0(o)),e}function b0(t,e){const n={},o=a(t,["ttl"]);e!==void 0&&o!=null&&l(e,["ttl"],o);const i=a(t,["expireTime"]);e!==void 0&&i!=null&&l(e,["expireTime"],i);const c=a(t,["displayName"]);e!==void 0&&c!=null&&l(e,["displayName"],c);const f=a(t,["contents"]);if(e!==void 0&&f!=null){let x=Wn(f);Array.isArray(x)&&(x=x.map(C=>cp(C))),l(e,["contents"],x)}const m=a(t,["systemInstruction"]);e!==void 0&&m!=null&&l(e,["systemInstruction"],cp(hn(m)));const h=a(t,["tools"]);if(e!==void 0&&h!=null){let x=h;Array.isArray(x)&&(x=x.map(C=>S0(C))),l(e,["tools"],x)}const p=a(t,["toolConfig"]);e!==void 0&&p!=null&&l(e,["toolConfig"],E0(p));const v=a(t,["kmsKeyName"]);return e!==void 0&&v!=null&&l(e,["encryption_spec","kmsKeyName"],v),n}function N0(t,e){const n={},o=a(e,["model"]);o!=null&&l(n,["model"],Wp(t,o));const i=a(e,["config"]);return i!=null&&l(n,["config"],b0(i,n)),n}function I0(t,e){const n={},o=a(e,["name"]);o!=null&&l(n,["_url","name"],Pr(t,o));const i=a(e,["config"]);return i!=null&&l(n,["config"],i),n}function A0(t,e){const n={},o=a(e,["name"]);o!=null&&l(n,["_url","name"],Pr(t,o));const i=a(e,["config"]);return i!=null&&l(n,["config"],i),n}function D0(t,e){const n={},o=a(t,["ttl"]);e!==void 0&&o!=null&&l(e,["ttl"],o);const i=a(t,["expireTime"]);return e!==void 0&&i!=null&&l(e,["expireTime"],i),n}function M0(t,e){const n={},o=a(e,["name"]);o!=null&&l(n,["_url","name"],Pr(t,o));const i=a(e,["config"]);return i!=null&&l(n,["config"],D0(i,n)),n}function R0(t,e){const n={},o=a(t,["pageSize"]);e!==void 0&&o!=null&&l(e,["_query","pageSize"],o);const i=a(t,["pageToken"]);return e!==void 0&&i!=null&&l(e,["_query","pageToken"],i),n}function P0(t){const e={},n=a(t,["config"]);return n!=null&&l(e,["config"],R0(n,e)),e}function za(t){const e={},n=a(t,["name"]);n!=null&&l(e,["name"],n);const o=a(t,["displayName"]);o!=null&&l(e,["displayName"],o);const i=a(t,["model"]);i!=null&&l(e,["model"],i);const c=a(t,["createTime"]);c!=null&&l(e,["createTime"],c);const f=a(t,["updateTime"]);f!=null&&l(e,["updateTime"],f);const m=a(t,["expireTime"]);m!=null&&l(e,["expireTime"],m);const h=a(t,["usageMetadata"]);return h!=null&&l(e,["usageMetadata"],h),e}function F0(){return{}}function L0(t){const e={},n=a(t,["sdkHttpResponse"]);n!=null&&l(e,["sdkHttpResponse"],n);const o=a(t,["nextPageToken"]);o!=null&&l(e,["nextPageToken"],o);const i=a(t,["cachedContents"]);if(i!=null){let c=i;Array.isArray(c)&&(c=c.map(f=>za(f))),l(e,["cachedContents"],c)}return e}function Oa(t){const e={},n=a(t,["name"]);n!=null&&l(e,["name"],n);const o=a(t,["displayName"]);o!=null&&l(e,["displayName"],o);const i=a(t,["model"]);i!=null&&l(e,["model"],i);const c=a(t,["createTime"]);c!=null&&l(e,["createTime"],c);const f=a(t,["updateTime"]);f!=null&&l(e,["updateTime"],f);const m=a(t,["expireTime"]);m!=null&&l(e,["expireTime"],m);const h=a(t,["usageMetadata"]);return h!=null&&l(e,["usageMetadata"],h),e}function U0(){return{}}function j0(t){const e={},n=a(t,["sdkHttpResponse"]);n!=null&&l(e,["sdkHttpResponse"],n);const o=a(t,["nextPageToken"]);o!=null&&l(e,["nextPageToken"],o);const i=a(t,["cachedContents"]);if(i!=null){let c=i;Array.isArray(c)&&(c=c.map(f=>Oa(f))),l(e,["cachedContents"],c)}return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class q0 extends Go{constructor(e){super(),this.apiClient=e,this.list=async(n={})=>new xi(Bo.PAGED_ITEM_CACHED_CONTENTS,o=>this.listInternal(o),await this.listInternal(n),n)}async create(e){var n,o,i,c;let f,m="",h={};if(this.apiClient.isVertexAI()){const p=N0(this.apiClient,e);return m=Qe("cachedContents",p._url),h=p._query,delete p.config,delete p._url,delete p._query,f=this.apiClient.request({path:m,queryParams:h,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(v=>v.json()),f.then(v=>Oa(v))}else{const p=e0(this.apiClient,e);return m=Qe("cachedContents",p._url),h=p._query,delete p.config,delete p._url,delete p._query,f=this.apiClient.request({path:m,queryParams:h,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(c=e.config)===null||c===void 0?void 0:c.abortSignal}).then(v=>v.json()),f.then(v=>za(v))}}async get(e){var n,o,i,c;let f,m="",h={};if(this.apiClient.isVertexAI()){const p=I0(this.apiClient,e);return m=Qe("{name}",p._url),h=p._query,delete p.config,delete p._url,delete p._query,f=this.apiClient.request({path:m,queryParams:h,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(v=>v.json()),f.then(v=>Oa(v))}else{const p=t0(this.apiClient,e);return m=Qe("{name}",p._url),h=p._query,delete p.config,delete p._url,delete p._query,f=this.apiClient.request({path:m,queryParams:h,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(c=e.config)===null||c===void 0?void 0:c.abortSignal}).then(v=>v.json()),f.then(v=>za(v))}}async delete(e){var n,o,i,c;let f,m="",h={};if(this.apiClient.isVertexAI()){const p=A0(this.apiClient,e);return m=Qe("{name}",p._url),h=p._query,delete p.config,delete p._url,delete p._query,f=this.apiClient.request({path:m,queryParams:h,body:JSON.stringify(p),httpMethod:"DELETE",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(v=>v.json()),f.then(()=>{const v=U0(),x=new np;return Object.assign(x,v),x})}else{const p=n0(this.apiClient,e);return m=Qe("{name}",p._url),h=p._query,delete p.config,delete p._url,delete p._query,f=this.apiClient.request({path:m,queryParams:h,body:JSON.stringify(p),httpMethod:"DELETE",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(c=e.config)===null||c===void 0?void 0:c.abortSignal}).then(v=>v.json()),f.then(()=>{const v=F0(),x=new np;return Object.assign(x,v),x})}}async update(e){var n,o,i,c;let f,m="",h={};if(this.apiClient.isVertexAI()){const p=M0(this.apiClient,e);return m=Qe("{name}",p._url),h=p._query,delete p.config,delete p._url,delete p._query,f=this.apiClient.request({path:m,queryParams:h,body:JSON.stringify(p),httpMethod:"PATCH",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(v=>v.json()),f.then(v=>Oa(v))}else{const p=o0(this.apiClient,e);return m=Qe("{name}",p._url),h=p._query,delete p.config,delete p._url,delete p._query,f=this.apiClient.request({path:m,queryParams:h,body:JSON.stringify(p),httpMethod:"PATCH",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(c=e.config)===null||c===void 0?void 0:c.abortSignal}).then(v=>v.json()),f.then(v=>za(v))}}async listInternal(e){var n,o,i,c;let f,m="",h={};if(this.apiClient.isVertexAI()){const p=P0(e);return m=Qe("cachedContents",p._url),h=p._query,delete p.config,delete p._url,delete p._query,f=this.apiClient.request({path:m,queryParams:h,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(v=>v.json().then(x=>{const C=x;return C.sdkHttpResponse={headers:v.headers},C})),f.then(v=>{const x=j0(v),C=new rp;return Object.assign(C,x),C})}else{const p=i0(e);return m=Qe("cachedContents",p._url),h=p._query,delete p.config,delete p._url,delete p._query,f=this.apiClient.request({path:m,queryParams:h,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(c=e.config)===null||c===void 0?void 0:c.abortSignal}).then(v=>v.json().then(x=>{const C=x;return C.sdkHttpResponse={headers:v.headers},C})),f.then(v=>{const x=L0(v),C=new rp;return Object.assign(C,x),C})}}}function dp(t){var e=typeof Symbol=="function"&&Symbol.iterator,n=e&&t[e],o=0;if(n)return n.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Rt(t){return this instanceof Rt?(this.v=t,this):new Rt(t)}function bs(t,e,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var o=n.apply(t,e||[]),i,c=[];return i=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),m("next"),m("throw"),m("return",f),i[Symbol.asyncIterator]=function(){return this},i;function f(S){return function(b){return Promise.resolve(b).then(S,x)}}function m(S,b){o[S]&&(i[S]=function(T){return new Promise(function(A,D){c.push([S,T,A,D])>1||h(S,T)})},b&&(i[S]=b(i[S])))}function h(S,b){try{p(o[S](b))}catch(T){C(c[0][3],T)}}function p(S){S.value instanceof Rt?Promise.resolve(S.value.v).then(v,x):C(c[0][2],S)}function v(S){h("next",S)}function x(S){h("throw",S)}function C(S,b){S(b),c.shift(),c.length&&h(c[0][0],c[0][1])}}function pi(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],n;return e?e.call(t):(t=typeof dp=="function"?dp(t):t[Symbol.iterator](),n={},o("next"),o("throw"),o("return"),n[Symbol.asyncIterator]=function(){return this},n);function o(c){n[c]=t[c]&&function(f){return new Promise(function(m,h){f=t[c](f),i(m,h,f.done,f.value)})}}function i(c,f,m,h){Promise.resolve(h).then(function(p){c({value:p,done:m})},f)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function z0(t){var e;if(t.candidates==null||t.candidates.length===0)return!1;const n=(e=t.candidates[0])===null||e===void 0?void 0:e.content;return n===void 0?!1:uh(n)}function uh(t){if(t.parts===void 0||t.parts.length===0)return!1;for(const e of t.parts)if(e===void 0||Object.keys(e).length===0)return!1;return!0}function O0(t){if(t.length!==0){for(const e of t)if(e.role!=="user"&&e.role!=="model")throw new Error(`Role must be user or model, but got ${e.role}.`)}}function fp(t){if(t===void 0||t.length===0)return[];const e=[],n=t.length;let o=0;for(;o<n;)if(t[o].role==="user")e.push(t[o]),o++;else{const i=[];let c=!0;for(;o<n&&t[o].role==="model";)i.push(t[o]),c&&!uh(t[o])&&(c=!1),o++;c?e.push(...i):e.pop()}return e}class B0{constructor(e,n){this.modelsModule=e,this.apiClient=n}create(e){return new V0(this.apiClient,this.modelsModule,e.model,e.config,structuredClone(e.history))}}class V0{constructor(e,n,o,i={},c=[]){this.apiClient=e,this.modelsModule=n,this.model=o,this.config=i,this.history=c,this.sendPromise=Promise.resolve(),O0(c)}async sendMessage(e){var n;await this.sendPromise;const o=hn(e.message),i=this.modelsModule.generateContent({model:this.model,contents:this.getHistory(!0).concat(o),config:(n=e.config)!==null&&n!==void 0?n:this.config});return this.sendPromise=(async()=>{var c,f,m;const h=await i,p=(f=(c=h.candidates)===null||c===void 0?void 0:c[0])===null||f===void 0?void 0:f.content,v=h.automaticFunctionCallingHistory,x=this.getHistory(!0).length;let C=[];v!=null&&(C=(m=v.slice(x))!==null&&m!==void 0?m:[]);const S=p?[p]:[];this.recordHistory(o,S,C)})(),await this.sendPromise.catch(()=>{this.sendPromise=Promise.resolve()}),i}async sendMessageStream(e){var n;await this.sendPromise;const o=hn(e.message),i=this.modelsModule.generateContentStream({model:this.model,contents:this.getHistory(!0).concat(o),config:(n=e.config)!==null&&n!==void 0?n:this.config});this.sendPromise=i.then(()=>{}).catch(()=>{});const c=await i;return this.processStreamResponse(c,o)}getHistory(e=!1){const n=e?fp(this.history):this.history;return structuredClone(n)}processStreamResponse(e,n){var o,i;return bs(this,arguments,function*(){var f,m,h,p;const v=[];try{for(var x=!0,C=pi(e),S;S=yield Rt(C.next()),f=S.done,!f;x=!0){p=S.value,x=!1;const b=p;if(z0(b)){const T=(i=(o=b.candidates)===null||o===void 0?void 0:o[0])===null||i===void 0?void 0:i.content;T!==void 0&&v.push(T)}yield yield Rt(b)}}catch(b){m={error:b}}finally{try{!x&&!f&&(h=C.return)&&(yield Rt(h.call(C)))}finally{if(m)throw m.error}}this.recordHistory(n,v)})}recordHistory(e,n,o){let i=[];n.length>0&&n.every(c=>c.role!==void 0)?i=n:i.push({role:"model",parts:[]}),o&&o.length>0?this.history.push(...fp(o)):this.history.push(e),this.history.push(...i)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Ka extends Error{constructor(e){super(e.message),this.name="ApiError",this.status=e.status,Object.setPrototypeOf(this,Ka.prototype)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function G0(t,e){const n={},o=a(t,["pageSize"]);e!==void 0&&o!=null&&l(e,["_query","pageSize"],o);const i=a(t,["pageToken"]);return e!==void 0&&i!=null&&l(e,["_query","pageToken"],i),n}function $0(t){const e={},n=a(t,["config"]);return n!=null&&l(e,["config"],G0(n,e)),e}function H0(t){const e={},n=a(t,["details"]);n!=null&&l(e,["details"],n);const o=a(t,["message"]);o!=null&&l(e,["message"],o);const i=a(t,["code"]);return i!=null&&l(e,["code"],i),e}function W0(t){const e={},n=a(t,["name"]);n!=null&&l(e,["name"],n);const o=a(t,["displayName"]);o!=null&&l(e,["displayName"],o);const i=a(t,["mimeType"]);i!=null&&l(e,["mimeType"],i);const c=a(t,["sizeBytes"]);c!=null&&l(e,["sizeBytes"],c);const f=a(t,["createTime"]);f!=null&&l(e,["createTime"],f);const m=a(t,["expirationTime"]);m!=null&&l(e,["expirationTime"],m);const h=a(t,["updateTime"]);h!=null&&l(e,["updateTime"],h);const p=a(t,["sha256Hash"]);p!=null&&l(e,["sha256Hash"],p);const v=a(t,["uri"]);v!=null&&l(e,["uri"],v);const x=a(t,["downloadUri"]);x!=null&&l(e,["downloadUri"],x);const C=a(t,["state"]);C!=null&&l(e,["state"],C);const S=a(t,["source"]);S!=null&&l(e,["source"],S);const b=a(t,["videoMetadata"]);b!=null&&l(e,["videoMetadata"],b);const T=a(t,["error"]);return T!=null&&l(e,["error"],H0(T)),e}function J0(t){const e={},n=a(t,["file"]);n!=null&&l(e,["file"],W0(n));const o=a(t,["config"]);return o!=null&&l(e,["config"],o),e}function Y0(t){const e={},n=a(t,["name"]);n!=null&&l(e,["_url","file"],eh(n));const o=a(t,["config"]);return o!=null&&l(e,["config"],o),e}function Q0(t){const e={},n=a(t,["name"]);n!=null&&l(e,["_url","file"],eh(n));const o=a(t,["config"]);return o!=null&&l(e,["config"],o),e}function K0(t){const e={},n=a(t,["details"]);n!=null&&l(e,["details"],n);const o=a(t,["message"]);o!=null&&l(e,["message"],o);const i=a(t,["code"]);return i!=null&&l(e,["code"],i),e}function pc(t){const e={},n=a(t,["name"]);n!=null&&l(e,["name"],n);const o=a(t,["displayName"]);o!=null&&l(e,["displayName"],o);const i=a(t,["mimeType"]);i!=null&&l(e,["mimeType"],i);const c=a(t,["sizeBytes"]);c!=null&&l(e,["sizeBytes"],c);const f=a(t,["createTime"]);f!=null&&l(e,["createTime"],f);const m=a(t,["expirationTime"]);m!=null&&l(e,["expirationTime"],m);const h=a(t,["updateTime"]);h!=null&&l(e,["updateTime"],h);const p=a(t,["sha256Hash"]);p!=null&&l(e,["sha256Hash"],p);const v=a(t,["uri"]);v!=null&&l(e,["uri"],v);const x=a(t,["downloadUri"]);x!=null&&l(e,["downloadUri"],x);const C=a(t,["state"]);C!=null&&l(e,["state"],C);const S=a(t,["source"]);S!=null&&l(e,["source"],S);const b=a(t,["videoMetadata"]);b!=null&&l(e,["videoMetadata"],b);const T=a(t,["error"]);return T!=null&&l(e,["error"],K0(T)),e}function Z0(t){const e={},n=a(t,["sdkHttpResponse"]);n!=null&&l(e,["sdkHttpResponse"],n);const o=a(t,["nextPageToken"]);o!=null&&l(e,["nextPageToken"],o);const i=a(t,["files"]);if(i!=null){let c=i;Array.isArray(c)&&(c=c.map(f=>pc(f))),l(e,["files"],c)}return e}function X0(t){const e={},n=a(t,["sdkHttpResponse"]);return n!=null&&l(e,["sdkHttpResponse"],n),e}function ew(){return{}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class tw extends Go{constructor(e){super(),this.apiClient=e,this.list=async(n={})=>new xi(Bo.PAGED_ITEM_FILES,o=>this.listInternal(o),await this.listInternal(n),n)}async upload(e){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files. You can share files through a GCS bucket.");return this.apiClient.uploadFile(e.file,e.config).then(n=>pc(n))}async download(e){await this.apiClient.downloadFile(e)}async listInternal(e){var n,o;let i,c="",f={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const m=$0(e);return c=Qe("files",m._url),f=m._query,delete m.config,delete m._url,delete m._query,i=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json().then(p=>{const v=p;return v.sdkHttpResponse={headers:h.headers},v})),i.then(h=>{const p=Z0(h),v=new yv;return Object.assign(v,p),v})}}async createInternal(e){var n,o;let i,c="",f={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const m=J0(e);return c=Qe("upload/v1beta/files",m._url),f=m._query,delete m.config,delete m._url,delete m._query,i=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json()),i.then(h=>{const p=X0(h),v=new vv;return Object.assign(v,p),v})}}async get(e){var n,o;let i,c="",f={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const m=Y0(e);return c=Qe("files/{file}",m._url),f=m._query,delete m.config,delete m._url,delete m._query,i=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json()),i.then(h=>pc(h))}}async delete(e){var n,o;let i,c="",f={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const m=Q0(e);return c=Qe("files/{file}",m._url),f=m._query,delete m.config,delete m._url,delete m._query,i=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(m),httpMethod:"DELETE",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json()),i.then(()=>{const h=ew(),p=new xv;return Object.assign(p,h),p})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function nw(t){const e={},n=a(t,["voiceName"]);return n!=null&&l(e,["voiceName"],n),e}function ch(t){const e={},n=a(t,["prebuiltVoiceConfig"]);return n!=null&&l(e,["prebuiltVoiceConfig"],nw(n)),e}function rw(t){const e={},n=a(t,["speaker"]);n!=null&&l(e,["speaker"],n);const o=a(t,["voiceConfig"]);return o!=null&&l(e,["voiceConfig"],ch(o)),e}function ow(t){const e={},n=a(t,["speakerVoiceConfigs"]);if(n!=null){let o=n;Array.isArray(o)&&(o=o.map(i=>rw(i))),l(e,["speakerVoiceConfigs"],o)}return e}function sw(t){const e={},n=a(t,["voiceConfig"]);n!=null&&l(e,["voiceConfig"],ch(n));const o=a(t,["multiSpeakerVoiceConfig"]);o!=null&&l(e,["multiSpeakerVoiceConfig"],ow(o));const i=a(t,["languageCode"]);return i!=null&&l(e,["languageCode"],i),e}function iw(t){const e={},n=a(t,["fps"]);n!=null&&l(e,["fps"],n);const o=a(t,["endOffset"]);o!=null&&l(e,["endOffset"],o);const i=a(t,["startOffset"]);return i!=null&&l(e,["startOffset"],i),e}function aw(t){const e={};if(a(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=a(t,["data"]);n!=null&&l(e,["data"],n);const o=a(t,["mimeType"]);return o!=null&&l(e,["mimeType"],o),e}function lw(t){const e={};if(a(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=a(t,["fileUri"]);n!=null&&l(e,["fileUri"],n);const o=a(t,["mimeType"]);return o!=null&&l(e,["mimeType"],o),e}function uw(t){const e={},n=a(t,["videoMetadata"]);n!=null&&l(e,["videoMetadata"],iw(n));const o=a(t,["thought"]);o!=null&&l(e,["thought"],o);const i=a(t,["inlineData"]);i!=null&&l(e,["inlineData"],aw(i));const c=a(t,["fileData"]);c!=null&&l(e,["fileData"],lw(c));const f=a(t,["thoughtSignature"]);f!=null&&l(e,["thoughtSignature"],f);const m=a(t,["codeExecutionResult"]);m!=null&&l(e,["codeExecutionResult"],m);const h=a(t,["executableCode"]);h!=null&&l(e,["executableCode"],h);const p=a(t,["functionCall"]);p!=null&&l(e,["functionCall"],p);const v=a(t,["functionResponse"]);v!=null&&l(e,["functionResponse"],v);const x=a(t,["text"]);return x!=null&&l(e,["text"],x),e}function cw(t){const e={},n=a(t,["parts"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(c=>uw(c))),l(e,["parts"],i)}const o=a(t,["role"]);return o!=null&&l(e,["role"],o),e}function dw(t){const e={},n=a(t,["behavior"]);n!=null&&l(e,["behavior"],n);const o=a(t,["description"]);o!=null&&l(e,["description"],o);const i=a(t,["name"]);i!=null&&l(e,["name"],i);const c=a(t,["parameters"]);c!=null&&l(e,["parameters"],c);const f=a(t,["parametersJsonSchema"]);f!=null&&l(e,["parametersJsonSchema"],f);const m=a(t,["response"]);m!=null&&l(e,["response"],m);const h=a(t,["responseJsonSchema"]);return h!=null&&l(e,["responseJsonSchema"],h),e}function fw(t){const e={},n=a(t,["startTime"]);n!=null&&l(e,["startTime"],n);const o=a(t,["endTime"]);return o!=null&&l(e,["endTime"],o),e}function mw(t){const e={},n=a(t,["timeRangeFilter"]);if(n!=null&&l(e,["timeRangeFilter"],fw(n)),a(t,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");return e}function pw(t){const e={},n=a(t,["mode"]);n!=null&&l(e,["mode"],n);const o=a(t,["dynamicThreshold"]);return o!=null&&l(e,["dynamicThreshold"],o),e}function hw(t){const e={},n=a(t,["dynamicRetrievalConfig"]);return n!=null&&l(e,["dynamicRetrievalConfig"],pw(n)),e}function gw(){return{}}function yw(t){const e={},n=a(t,["environment"]);return n!=null&&l(e,["environment"],n),e}function vw(t){const e={},n=a(t,["functionDeclarations"]);if(n!=null){let h=n;Array.isArray(h)&&(h=h.map(p=>dw(p))),l(e,["functionDeclarations"],h)}if(a(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const o=a(t,["googleSearch"]);o!=null&&l(e,["googleSearch"],mw(o));const i=a(t,["googleSearchRetrieval"]);if(i!=null&&l(e,["googleSearchRetrieval"],hw(i)),a(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(a(t,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");a(t,["urlContext"])!=null&&l(e,["urlContext"],gw());const f=a(t,["computerUse"]);f!=null&&l(e,["computerUse"],yw(f));const m=a(t,["codeExecution"]);return m!=null&&l(e,["codeExecution"],m),e}function xw(t){const e={},n=a(t,["handle"]);if(n!=null&&l(e,["handle"],n),a(t,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return e}function mp(){return{}}function ww(t){const e={},n=a(t,["disabled"]);n!=null&&l(e,["disabled"],n);const o=a(t,["startOfSpeechSensitivity"]);o!=null&&l(e,["startOfSpeechSensitivity"],o);const i=a(t,["endOfSpeechSensitivity"]);i!=null&&l(e,["endOfSpeechSensitivity"],i);const c=a(t,["prefixPaddingMs"]);c!=null&&l(e,["prefixPaddingMs"],c);const f=a(t,["silenceDurationMs"]);return f!=null&&l(e,["silenceDurationMs"],f),e}function Cw(t){const e={},n=a(t,["automaticActivityDetection"]);n!=null&&l(e,["automaticActivityDetection"],ww(n));const o=a(t,["activityHandling"]);o!=null&&l(e,["activityHandling"],o);const i=a(t,["turnCoverage"]);return i!=null&&l(e,["turnCoverage"],i),e}function Sw(t){const e={},n=a(t,["targetTokens"]);return n!=null&&l(e,["targetTokens"],n),e}function kw(t){const e={},n=a(t,["triggerTokens"]);n!=null&&l(e,["triggerTokens"],n);const o=a(t,["slidingWindow"]);return o!=null&&l(e,["slidingWindow"],Sw(o)),e}function Tw(t){const e={},n=a(t,["proactiveAudio"]);return n!=null&&l(e,["proactiveAudio"],n),e}function _w(t,e){const n={},o=a(t,["generationConfig"]);e!==void 0&&o!=null&&l(e,["setup","generationConfig"],o);const i=a(t,["responseModalities"]);e!==void 0&&i!=null&&l(e,["setup","generationConfig","responseModalities"],i);const c=a(t,["temperature"]);e!==void 0&&c!=null&&l(e,["setup","generationConfig","temperature"],c);const f=a(t,["topP"]);e!==void 0&&f!=null&&l(e,["setup","generationConfig","topP"],f);const m=a(t,["topK"]);e!==void 0&&m!=null&&l(e,["setup","generationConfig","topK"],m);const h=a(t,["maxOutputTokens"]);e!==void 0&&h!=null&&l(e,["setup","generationConfig","maxOutputTokens"],h);const p=a(t,["mediaResolution"]);e!==void 0&&p!=null&&l(e,["setup","generationConfig","mediaResolution"],p);const v=a(t,["seed"]);e!==void 0&&v!=null&&l(e,["setup","generationConfig","seed"],v);const x=a(t,["speechConfig"]);e!==void 0&&x!=null&&l(e,["setup","generationConfig","speechConfig"],sw(Ic(x)));const C=a(t,["enableAffectiveDialog"]);e!==void 0&&C!=null&&l(e,["setup","generationConfig","enableAffectiveDialog"],C);const S=a(t,["systemInstruction"]);e!==void 0&&S!=null&&l(e,["setup","systemInstruction"],cw(hn(S)));const b=a(t,["tools"]);if(e!==void 0&&b!=null){let P=As(b);Array.isArray(P)&&(P=P.map(G=>vw(Is(G)))),l(e,["setup","tools"],P)}const T=a(t,["sessionResumption"]);e!==void 0&&T!=null&&l(e,["setup","sessionResumption"],xw(T));const A=a(t,["inputAudioTranscription"]);e!==void 0&&A!=null&&l(e,["setup","inputAudioTranscription"],mp());const D=a(t,["outputAudioTranscription"]);e!==void 0&&D!=null&&l(e,["setup","outputAudioTranscription"],mp());const F=a(t,["realtimeInputConfig"]);e!==void 0&&F!=null&&l(e,["setup","realtimeInputConfig"],Cw(F));const L=a(t,["contextWindowCompression"]);e!==void 0&&L!=null&&l(e,["setup","contextWindowCompression"],kw(L));const R=a(t,["proactivity"]);return e!==void 0&&R!=null&&l(e,["setup","proactivity"],Tw(R)),n}function Ew(t,e){const n={},o=a(e,["model"]);o!=null&&l(n,["setup","model"],_t(t,o));const i=a(e,["config"]);return i!=null&&l(n,["config"],_w(i,n)),n}function bw(){return{}}function Nw(){return{}}function Iw(t){const e={},n=a(t,["media"]);n!=null&&l(e,["mediaChunks"],Jp(n));const o=a(t,["audio"]);o!=null&&l(e,["audio"],Qp(o));const i=a(t,["audioStreamEnd"]);i!=null&&l(e,["audioStreamEnd"],i);const c=a(t,["video"]);c!=null&&l(e,["video"],Yp(c));const f=a(t,["text"]);return f!=null&&l(e,["text"],f),a(t,["activityStart"])!=null&&l(e,["activityStart"],bw()),a(t,["activityEnd"])!=null&&l(e,["activityEnd"],Nw()),e}function dh(t){const e={},n=a(t,["text"]);n!=null&&l(e,["text"],n);const o=a(t,["weight"]);return o!=null&&l(e,["weight"],o),e}function Aw(t){const e={},n=a(t,["weightedPrompts"]);if(n!=null){let o=n;Array.isArray(o)&&(o=o.map(i=>dh(i))),l(e,["weightedPrompts"],o)}return e}function fh(t){const e={},n=a(t,["temperature"]);n!=null&&l(e,["temperature"],n);const o=a(t,["topK"]);o!=null&&l(e,["topK"],o);const i=a(t,["seed"]);i!=null&&l(e,["seed"],i);const c=a(t,["guidance"]);c!=null&&l(e,["guidance"],c);const f=a(t,["bpm"]);f!=null&&l(e,["bpm"],f);const m=a(t,["density"]);m!=null&&l(e,["density"],m);const h=a(t,["brightness"]);h!=null&&l(e,["brightness"],h);const p=a(t,["scale"]);p!=null&&l(e,["scale"],p);const v=a(t,["muteBass"]);v!=null&&l(e,["muteBass"],v);const x=a(t,["muteDrums"]);x!=null&&l(e,["muteDrums"],x);const C=a(t,["onlyBassAndDrums"]);C!=null&&l(e,["onlyBassAndDrums"],C);const S=a(t,["musicGenerationMode"]);return S!=null&&l(e,["musicGenerationMode"],S),e}function Dw(t){const e={},n=a(t,["musicGenerationConfig"]);return n!=null&&l(e,["musicGenerationConfig"],fh(n)),e}function mh(t){const e={},n=a(t,["model"]);return n!=null&&l(e,["model"],n),e}function ph(t){const e={},n=a(t,["weightedPrompts"]);if(n!=null){let o=n;Array.isArray(o)&&(o=o.map(i=>dh(i))),l(e,["weightedPrompts"],o)}return e}function hc(t){const e={},n=a(t,["setup"]);n!=null&&l(e,["setup"],mh(n));const o=a(t,["clientContent"]);o!=null&&l(e,["clientContent"],ph(o));const i=a(t,["musicGenerationConfig"]);i!=null&&l(e,["musicGenerationConfig"],fh(i));const c=a(t,["playbackControl"]);return c!=null&&l(e,["playbackControl"],c),e}function Mw(t){const e={},n=a(t,["voiceName"]);return n!=null&&l(e,["voiceName"],n),e}function Rw(t){const e={},n=a(t,["prebuiltVoiceConfig"]);return n!=null&&l(e,["prebuiltVoiceConfig"],Mw(n)),e}function Pw(t){const e={},n=a(t,["voiceConfig"]);if(n!=null&&l(e,["voiceConfig"],Rw(n)),a(t,["multiSpeakerVoiceConfig"])!==void 0)throw new Error("multiSpeakerVoiceConfig parameter is not supported in Vertex AI.");const o=a(t,["languageCode"]);return o!=null&&l(e,["languageCode"],o),e}function Fw(t){const e={},n=a(t,["fps"]);n!=null&&l(e,["fps"],n);const o=a(t,["endOffset"]);o!=null&&l(e,["endOffset"],o);const i=a(t,["startOffset"]);return i!=null&&l(e,["startOffset"],i),e}function Lw(t){const e={},n=a(t,["displayName"]);n!=null&&l(e,["displayName"],n);const o=a(t,["data"]);o!=null&&l(e,["data"],o);const i=a(t,["mimeType"]);return i!=null&&l(e,["mimeType"],i),e}function Uw(t){const e={},n=a(t,["displayName"]);n!=null&&l(e,["displayName"],n);const o=a(t,["fileUri"]);o!=null&&l(e,["fileUri"],o);const i=a(t,["mimeType"]);return i!=null&&l(e,["mimeType"],i),e}function jw(t){const e={},n=a(t,["videoMetadata"]);n!=null&&l(e,["videoMetadata"],Fw(n));const o=a(t,["thought"]);o!=null&&l(e,["thought"],o);const i=a(t,["inlineData"]);i!=null&&l(e,["inlineData"],Lw(i));const c=a(t,["fileData"]);c!=null&&l(e,["fileData"],Uw(c));const f=a(t,["thoughtSignature"]);f!=null&&l(e,["thoughtSignature"],f);const m=a(t,["codeExecutionResult"]);m!=null&&l(e,["codeExecutionResult"],m);const h=a(t,["executableCode"]);h!=null&&l(e,["executableCode"],h);const p=a(t,["functionCall"]);p!=null&&l(e,["functionCall"],p);const v=a(t,["functionResponse"]);v!=null&&l(e,["functionResponse"],v);const x=a(t,["text"]);return x!=null&&l(e,["text"],x),e}function qw(t){const e={},n=a(t,["parts"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(c=>jw(c))),l(e,["parts"],i)}const o=a(t,["role"]);return o!=null&&l(e,["role"],o),e}function zw(t){const e={};if(a(t,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const n=a(t,["description"]);n!=null&&l(e,["description"],n);const o=a(t,["name"]);o!=null&&l(e,["name"],o);const i=a(t,["parameters"]);i!=null&&l(e,["parameters"],i);const c=a(t,["parametersJsonSchema"]);c!=null&&l(e,["parametersJsonSchema"],c);const f=a(t,["response"]);f!=null&&l(e,["response"],f);const m=a(t,["responseJsonSchema"]);return m!=null&&l(e,["responseJsonSchema"],m),e}function Ow(t){const e={},n=a(t,["startTime"]);n!=null&&l(e,["startTime"],n);const o=a(t,["endTime"]);return o!=null&&l(e,["endTime"],o),e}function Bw(t){const e={},n=a(t,["timeRangeFilter"]);n!=null&&l(e,["timeRangeFilter"],Ow(n));const o=a(t,["excludeDomains"]);return o!=null&&l(e,["excludeDomains"],o),e}function Vw(t){const e={},n=a(t,["mode"]);n!=null&&l(e,["mode"],n);const o=a(t,["dynamicThreshold"]);return o!=null&&l(e,["dynamicThreshold"],o),e}function Gw(t){const e={},n=a(t,["dynamicRetrievalConfig"]);return n!=null&&l(e,["dynamicRetrievalConfig"],Vw(n)),e}function $w(t){const e={},n=a(t,["excludeDomains"]);return n!=null&&l(e,["excludeDomains"],n),e}function Hw(t){const e={},n=a(t,["apiKeyString"]);return n!=null&&l(e,["apiKeyString"],n),e}function Ww(t){const e={},n=a(t,["apiKeyConfig"]);n!=null&&l(e,["apiKeyConfig"],Hw(n));const o=a(t,["authType"]);o!=null&&l(e,["authType"],o);const i=a(t,["googleServiceAccountConfig"]);i!=null&&l(e,["googleServiceAccountConfig"],i);const c=a(t,["httpBasicAuthConfig"]);c!=null&&l(e,["httpBasicAuthConfig"],c);const f=a(t,["oauthConfig"]);f!=null&&l(e,["oauthConfig"],f);const m=a(t,["oidcConfig"]);return m!=null&&l(e,["oidcConfig"],m),e}function Jw(t){const e={},n=a(t,["authConfig"]);return n!=null&&l(e,["authConfig"],Ww(n)),e}function Yw(){return{}}function Qw(t){const e={},n=a(t,["environment"]);return n!=null&&l(e,["environment"],n),e}function Kw(t){const e={},n=a(t,["functionDeclarations"]);if(n!=null){let x=n;Array.isArray(x)&&(x=x.map(C=>zw(C))),l(e,["functionDeclarations"],x)}const o=a(t,["retrieval"]);o!=null&&l(e,["retrieval"],o);const i=a(t,["googleSearch"]);i!=null&&l(e,["googleSearch"],Bw(i));const c=a(t,["googleSearchRetrieval"]);c!=null&&l(e,["googleSearchRetrieval"],Gw(c));const f=a(t,["enterpriseWebSearch"]);f!=null&&l(e,["enterpriseWebSearch"],$w(f));const m=a(t,["googleMaps"]);m!=null&&l(e,["googleMaps"],Jw(m)),a(t,["urlContext"])!=null&&l(e,["urlContext"],Yw());const p=a(t,["computerUse"]);p!=null&&l(e,["computerUse"],Qw(p));const v=a(t,["codeExecution"]);return v!=null&&l(e,["codeExecution"],v),e}function Zw(t){const e={},n=a(t,["handle"]);n!=null&&l(e,["handle"],n);const o=a(t,["transparent"]);return o!=null&&l(e,["transparent"],o),e}function pp(){return{}}function Xw(t){const e={},n=a(t,["disabled"]);n!=null&&l(e,["disabled"],n);const o=a(t,["startOfSpeechSensitivity"]);o!=null&&l(e,["startOfSpeechSensitivity"],o);const i=a(t,["endOfSpeechSensitivity"]);i!=null&&l(e,["endOfSpeechSensitivity"],i);const c=a(t,["prefixPaddingMs"]);c!=null&&l(e,["prefixPaddingMs"],c);const f=a(t,["silenceDurationMs"]);return f!=null&&l(e,["silenceDurationMs"],f),e}function eC(t){const e={},n=a(t,["automaticActivityDetection"]);n!=null&&l(e,["automaticActivityDetection"],Xw(n));const o=a(t,["activityHandling"]);o!=null&&l(e,["activityHandling"],o);const i=a(t,["turnCoverage"]);return i!=null&&l(e,["turnCoverage"],i),e}function tC(t){const e={},n=a(t,["targetTokens"]);return n!=null&&l(e,["targetTokens"],n),e}function nC(t){const e={},n=a(t,["triggerTokens"]);n!=null&&l(e,["triggerTokens"],n);const o=a(t,["slidingWindow"]);return o!=null&&l(e,["slidingWindow"],tC(o)),e}function rC(t){const e={},n=a(t,["proactiveAudio"]);return n!=null&&l(e,["proactiveAudio"],n),e}function oC(t,e){const n={},o=a(t,["generationConfig"]);e!==void 0&&o!=null&&l(e,["setup","generationConfig"],o);const i=a(t,["responseModalities"]);e!==void 0&&i!=null&&l(e,["setup","generationConfig","responseModalities"],i);const c=a(t,["temperature"]);e!==void 0&&c!=null&&l(e,["setup","generationConfig","temperature"],c);const f=a(t,["topP"]);e!==void 0&&f!=null&&l(e,["setup","generationConfig","topP"],f);const m=a(t,["topK"]);e!==void 0&&m!=null&&l(e,["setup","generationConfig","topK"],m);const h=a(t,["maxOutputTokens"]);e!==void 0&&h!=null&&l(e,["setup","generationConfig","maxOutputTokens"],h);const p=a(t,["mediaResolution"]);e!==void 0&&p!=null&&l(e,["setup","generationConfig","mediaResolution"],p);const v=a(t,["seed"]);e!==void 0&&v!=null&&l(e,["setup","generationConfig","seed"],v);const x=a(t,["speechConfig"]);e!==void 0&&x!=null&&l(e,["setup","generationConfig","speechConfig"],Pw(Ic(x)));const C=a(t,["enableAffectiveDialog"]);e!==void 0&&C!=null&&l(e,["setup","generationConfig","enableAffectiveDialog"],C);const S=a(t,["systemInstruction"]);e!==void 0&&S!=null&&l(e,["setup","systemInstruction"],qw(hn(S)));const b=a(t,["tools"]);if(e!==void 0&&b!=null){let P=As(b);Array.isArray(P)&&(P=P.map(G=>Kw(Is(G)))),l(e,["setup","tools"],P)}const T=a(t,["sessionResumption"]);e!==void 0&&T!=null&&l(e,["setup","sessionResumption"],Zw(T));const A=a(t,["inputAudioTranscription"]);e!==void 0&&A!=null&&l(e,["setup","inputAudioTranscription"],pp());const D=a(t,["outputAudioTranscription"]);e!==void 0&&D!=null&&l(e,["setup","outputAudioTranscription"],pp());const F=a(t,["realtimeInputConfig"]);e!==void 0&&F!=null&&l(e,["setup","realtimeInputConfig"],eC(F));const L=a(t,["contextWindowCompression"]);e!==void 0&&L!=null&&l(e,["setup","contextWindowCompression"],nC(L));const R=a(t,["proactivity"]);return e!==void 0&&R!=null&&l(e,["setup","proactivity"],rC(R)),n}function sC(t,e){const n={},o=a(e,["model"]);o!=null&&l(n,["setup","model"],_t(t,o));const i=a(e,["config"]);return i!=null&&l(n,["config"],oC(i,n)),n}function iC(){return{}}function aC(){return{}}function lC(t){const e={},n=a(t,["media"]);n!=null&&l(e,["mediaChunks"],Jp(n));const o=a(t,["audio"]);o!=null&&l(e,["audio"],Qp(o));const i=a(t,["audioStreamEnd"]);i!=null&&l(e,["audioStreamEnd"],i);const c=a(t,["video"]);c!=null&&l(e,["video"],Yp(c));const f=a(t,["text"]);return f!=null&&l(e,["text"],f),a(t,["activityStart"])!=null&&l(e,["activityStart"],iC()),a(t,["activityEnd"])!=null&&l(e,["activityEnd"],aC()),e}function uC(){return{}}function cC(t){const e={},n=a(t,["fps"]);n!=null&&l(e,["fps"],n);const o=a(t,["endOffset"]);o!=null&&l(e,["endOffset"],o);const i=a(t,["startOffset"]);return i!=null&&l(e,["startOffset"],i),e}function dC(t){const e={},n=a(t,["data"]);n!=null&&l(e,["data"],n);const o=a(t,["mimeType"]);return o!=null&&l(e,["mimeType"],o),e}function fC(t){const e={},n=a(t,["fileUri"]);n!=null&&l(e,["fileUri"],n);const o=a(t,["mimeType"]);return o!=null&&l(e,["mimeType"],o),e}function mC(t){const e={},n=a(t,["videoMetadata"]);n!=null&&l(e,["videoMetadata"],cC(n));const o=a(t,["thought"]);o!=null&&l(e,["thought"],o);const i=a(t,["inlineData"]);i!=null&&l(e,["inlineData"],dC(i));const c=a(t,["fileData"]);c!=null&&l(e,["fileData"],fC(c));const f=a(t,["thoughtSignature"]);f!=null&&l(e,["thoughtSignature"],f);const m=a(t,["codeExecutionResult"]);m!=null&&l(e,["codeExecutionResult"],m);const h=a(t,["executableCode"]);h!=null&&l(e,["executableCode"],h);const p=a(t,["functionCall"]);p!=null&&l(e,["functionCall"],p);const v=a(t,["functionResponse"]);v!=null&&l(e,["functionResponse"],v);const x=a(t,["text"]);return x!=null&&l(e,["text"],x),e}function pC(t){const e={},n=a(t,["parts"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(c=>mC(c))),l(e,["parts"],i)}const o=a(t,["role"]);return o!=null&&l(e,["role"],o),e}function hp(t){const e={},n=a(t,["text"]);n!=null&&l(e,["text"],n);const o=a(t,["finished"]);return o!=null&&l(e,["finished"],o),e}function hC(t){const e={},n=a(t,["retrievedUrl"]);n!=null&&l(e,["retrievedUrl"],n);const o=a(t,["urlRetrievalStatus"]);return o!=null&&l(e,["urlRetrievalStatus"],o),e}function gC(t){const e={},n=a(t,["urlMetadata"]);if(n!=null){let o=n;Array.isArray(o)&&(o=o.map(i=>hC(i))),l(e,["urlMetadata"],o)}return e}function yC(t){const e={},n=a(t,["modelTurn"]);n!=null&&l(e,["modelTurn"],pC(n));const o=a(t,["turnComplete"]);o!=null&&l(e,["turnComplete"],o);const i=a(t,["interrupted"]);i!=null&&l(e,["interrupted"],i);const c=a(t,["groundingMetadata"]);c!=null&&l(e,["groundingMetadata"],c);const f=a(t,["generationComplete"]);f!=null&&l(e,["generationComplete"],f);const m=a(t,["inputTranscription"]);m!=null&&l(e,["inputTranscription"],hp(m));const h=a(t,["outputTranscription"]);h!=null&&l(e,["outputTranscription"],hp(h));const p=a(t,["urlContextMetadata"]);return p!=null&&l(e,["urlContextMetadata"],gC(p)),e}function vC(t){const e={},n=a(t,["id"]);n!=null&&l(e,["id"],n);const o=a(t,["args"]);o!=null&&l(e,["args"],o);const i=a(t,["name"]);return i!=null&&l(e,["name"],i),e}function xC(t){const e={},n=a(t,["functionCalls"]);if(n!=null){let o=n;Array.isArray(o)&&(o=o.map(i=>vC(i))),l(e,["functionCalls"],o)}return e}function wC(t){const e={},n=a(t,["ids"]);return n!=null&&l(e,["ids"],n),e}function Pa(t){const e={},n=a(t,["modality"]);n!=null&&l(e,["modality"],n);const o=a(t,["tokenCount"]);return o!=null&&l(e,["tokenCount"],o),e}function CC(t){const e={},n=a(t,["promptTokenCount"]);n!=null&&l(e,["promptTokenCount"],n);const o=a(t,["cachedContentTokenCount"]);o!=null&&l(e,["cachedContentTokenCount"],o);const i=a(t,["responseTokenCount"]);i!=null&&l(e,["responseTokenCount"],i);const c=a(t,["toolUsePromptTokenCount"]);c!=null&&l(e,["toolUsePromptTokenCount"],c);const f=a(t,["thoughtsTokenCount"]);f!=null&&l(e,["thoughtsTokenCount"],f);const m=a(t,["totalTokenCount"]);m!=null&&l(e,["totalTokenCount"],m);const h=a(t,["promptTokensDetails"]);if(h!=null){let C=h;Array.isArray(C)&&(C=C.map(S=>Pa(S))),l(e,["promptTokensDetails"],C)}const p=a(t,["cacheTokensDetails"]);if(p!=null){let C=p;Array.isArray(C)&&(C=C.map(S=>Pa(S))),l(e,["cacheTokensDetails"],C)}const v=a(t,["responseTokensDetails"]);if(v!=null){let C=v;Array.isArray(C)&&(C=C.map(S=>Pa(S))),l(e,["responseTokensDetails"],C)}const x=a(t,["toolUsePromptTokensDetails"]);if(x!=null){let C=x;Array.isArray(C)&&(C=C.map(S=>Pa(S))),l(e,["toolUsePromptTokensDetails"],C)}return e}function SC(t){const e={},n=a(t,["timeLeft"]);return n!=null&&l(e,["timeLeft"],n),e}function kC(t){const e={},n=a(t,["newHandle"]);n!=null&&l(e,["newHandle"],n);const o=a(t,["resumable"]);o!=null&&l(e,["resumable"],o);const i=a(t,["lastConsumedClientMessageIndex"]);return i!=null&&l(e,["lastConsumedClientMessageIndex"],i),e}function TC(t){const e={};a(t,["setupComplete"])!=null&&l(e,["setupComplete"],uC());const o=a(t,["serverContent"]);o!=null&&l(e,["serverContent"],yC(o));const i=a(t,["toolCall"]);i!=null&&l(e,["toolCall"],xC(i));const c=a(t,["toolCallCancellation"]);c!=null&&l(e,["toolCallCancellation"],wC(c));const f=a(t,["usageMetadata"]);f!=null&&l(e,["usageMetadata"],CC(f));const m=a(t,["goAway"]);m!=null&&l(e,["goAway"],SC(m));const h=a(t,["sessionResumptionUpdate"]);return h!=null&&l(e,["sessionResumptionUpdate"],kC(h)),e}function _C(){return{}}function EC(t){const e={},n=a(t,["text"]);n!=null&&l(e,["text"],n);const o=a(t,["weight"]);return o!=null&&l(e,["weight"],o),e}function bC(t){const e={},n=a(t,["weightedPrompts"]);if(n!=null){let o=n;Array.isArray(o)&&(o=o.map(i=>EC(i))),l(e,["weightedPrompts"],o)}return e}function NC(t){const e={},n=a(t,["temperature"]);n!=null&&l(e,["temperature"],n);const o=a(t,["topK"]);o!=null&&l(e,["topK"],o);const i=a(t,["seed"]);i!=null&&l(e,["seed"],i);const c=a(t,["guidance"]);c!=null&&l(e,["guidance"],c);const f=a(t,["bpm"]);f!=null&&l(e,["bpm"],f);const m=a(t,["density"]);m!=null&&l(e,["density"],m);const h=a(t,["brightness"]);h!=null&&l(e,["brightness"],h);const p=a(t,["scale"]);p!=null&&l(e,["scale"],p);const v=a(t,["muteBass"]);v!=null&&l(e,["muteBass"],v);const x=a(t,["muteDrums"]);x!=null&&l(e,["muteDrums"],x);const C=a(t,["onlyBassAndDrums"]);C!=null&&l(e,["onlyBassAndDrums"],C);const S=a(t,["musicGenerationMode"]);return S!=null&&l(e,["musicGenerationMode"],S),e}function IC(t){const e={},n=a(t,["clientContent"]);n!=null&&l(e,["clientContent"],bC(n));const o=a(t,["musicGenerationConfig"]);return o!=null&&l(e,["musicGenerationConfig"],NC(o)),e}function AC(t){const e={},n=a(t,["data"]);n!=null&&l(e,["data"],n);const o=a(t,["mimeType"]);o!=null&&l(e,["mimeType"],o);const i=a(t,["sourceMetadata"]);return i!=null&&l(e,["sourceMetadata"],IC(i)),e}function DC(t){const e={},n=a(t,["audioChunks"]);if(n!=null){let o=n;Array.isArray(o)&&(o=o.map(i=>AC(i))),l(e,["audioChunks"],o)}return e}function MC(t){const e={},n=a(t,["text"]);n!=null&&l(e,["text"],n);const o=a(t,["filteredReason"]);return o!=null&&l(e,["filteredReason"],o),e}function RC(t){const e={};a(t,["setupComplete"])!=null&&l(e,["setupComplete"],_C());const o=a(t,["serverContent"]);o!=null&&l(e,["serverContent"],DC(o));const i=a(t,["filteredPrompt"]);return i!=null&&l(e,["filteredPrompt"],MC(i)),e}function PC(t){const e={},n=a(t,["sessionId"]);return n!=null&&l(e,["sessionId"],n),e}function FC(t){const e={},n=a(t,["fps"]);n!=null&&l(e,["fps"],n);const o=a(t,["endOffset"]);o!=null&&l(e,["endOffset"],o);const i=a(t,["startOffset"]);return i!=null&&l(e,["startOffset"],i),e}function LC(t){const e={},n=a(t,["displayName"]);n!=null&&l(e,["displayName"],n);const o=a(t,["data"]);o!=null&&l(e,["data"],o);const i=a(t,["mimeType"]);return i!=null&&l(e,["mimeType"],i),e}function UC(t){const e={},n=a(t,["displayName"]);n!=null&&l(e,["displayName"],n);const o=a(t,["fileUri"]);o!=null&&l(e,["fileUri"],o);const i=a(t,["mimeType"]);return i!=null&&l(e,["mimeType"],i),e}function jC(t){const e={},n=a(t,["videoMetadata"]);n!=null&&l(e,["videoMetadata"],FC(n));const o=a(t,["thought"]);o!=null&&l(e,["thought"],o);const i=a(t,["inlineData"]);i!=null&&l(e,["inlineData"],LC(i));const c=a(t,["fileData"]);c!=null&&l(e,["fileData"],UC(c));const f=a(t,["thoughtSignature"]);f!=null&&l(e,["thoughtSignature"],f);const m=a(t,["codeExecutionResult"]);m!=null&&l(e,["codeExecutionResult"],m);const h=a(t,["executableCode"]);h!=null&&l(e,["executableCode"],h);const p=a(t,["functionCall"]);p!=null&&l(e,["functionCall"],p);const v=a(t,["functionResponse"]);v!=null&&l(e,["functionResponse"],v);const x=a(t,["text"]);return x!=null&&l(e,["text"],x),e}function qC(t){const e={},n=a(t,["parts"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(c=>jC(c))),l(e,["parts"],i)}const o=a(t,["role"]);return o!=null&&l(e,["role"],o),e}function gp(t){const e={},n=a(t,["text"]);n!=null&&l(e,["text"],n);const o=a(t,["finished"]);return o!=null&&l(e,["finished"],o),e}function zC(t){const e={},n=a(t,["modelTurn"]);n!=null&&l(e,["modelTurn"],qC(n));const o=a(t,["turnComplete"]);o!=null&&l(e,["turnComplete"],o);const i=a(t,["interrupted"]);i!=null&&l(e,["interrupted"],i);const c=a(t,["groundingMetadata"]);c!=null&&l(e,["groundingMetadata"],c);const f=a(t,["generationComplete"]);f!=null&&l(e,["generationComplete"],f);const m=a(t,["inputTranscription"]);m!=null&&l(e,["inputTranscription"],gp(m));const h=a(t,["outputTranscription"]);return h!=null&&l(e,["outputTranscription"],gp(h)),e}function OC(t){const e={},n=a(t,["args"]);n!=null&&l(e,["args"],n);const o=a(t,["name"]);return o!=null&&l(e,["name"],o),e}function BC(t){const e={},n=a(t,["functionCalls"]);if(n!=null){let o=n;Array.isArray(o)&&(o=o.map(i=>OC(i))),l(e,["functionCalls"],o)}return e}function VC(t){const e={},n=a(t,["ids"]);return n!=null&&l(e,["ids"],n),e}function Fa(t){const e={},n=a(t,["modality"]);n!=null&&l(e,["modality"],n);const o=a(t,["tokenCount"]);return o!=null&&l(e,["tokenCount"],o),e}function GC(t){const e={},n=a(t,["promptTokenCount"]);n!=null&&l(e,["promptTokenCount"],n);const o=a(t,["cachedContentTokenCount"]);o!=null&&l(e,["cachedContentTokenCount"],o);const i=a(t,["candidatesTokenCount"]);i!=null&&l(e,["responseTokenCount"],i);const c=a(t,["toolUsePromptTokenCount"]);c!=null&&l(e,["toolUsePromptTokenCount"],c);const f=a(t,["thoughtsTokenCount"]);f!=null&&l(e,["thoughtsTokenCount"],f);const m=a(t,["totalTokenCount"]);m!=null&&l(e,["totalTokenCount"],m);const h=a(t,["promptTokensDetails"]);if(h!=null){let S=h;Array.isArray(S)&&(S=S.map(b=>Fa(b))),l(e,["promptTokensDetails"],S)}const p=a(t,["cacheTokensDetails"]);if(p!=null){let S=p;Array.isArray(S)&&(S=S.map(b=>Fa(b))),l(e,["cacheTokensDetails"],S)}const v=a(t,["candidatesTokensDetails"]);if(v!=null){let S=v;Array.isArray(S)&&(S=S.map(b=>Fa(b))),l(e,["responseTokensDetails"],S)}const x=a(t,["toolUsePromptTokensDetails"]);if(x!=null){let S=x;Array.isArray(S)&&(S=S.map(b=>Fa(b))),l(e,["toolUsePromptTokensDetails"],S)}const C=a(t,["trafficType"]);return C!=null&&l(e,["trafficType"],C),e}function $C(t){const e={},n=a(t,["timeLeft"]);return n!=null&&l(e,["timeLeft"],n),e}function HC(t){const e={},n=a(t,["newHandle"]);n!=null&&l(e,["newHandle"],n);const o=a(t,["resumable"]);o!=null&&l(e,["resumable"],o);const i=a(t,["lastConsumedClientMessageIndex"]);return i!=null&&l(e,["lastConsumedClientMessageIndex"],i),e}function WC(t){const e={},n=a(t,["setupComplete"]);n!=null&&l(e,["setupComplete"],PC(n));const o=a(t,["serverContent"]);o!=null&&l(e,["serverContent"],zC(o));const i=a(t,["toolCall"]);i!=null&&l(e,["toolCall"],BC(i));const c=a(t,["toolCallCancellation"]);c!=null&&l(e,["toolCallCancellation"],VC(c));const f=a(t,["usageMetadata"]);f!=null&&l(e,["usageMetadata"],GC(f));const m=a(t,["goAway"]);m!=null&&l(e,["goAway"],$C(m));const h=a(t,["sessionResumptionUpdate"]);return h!=null&&l(e,["sessionResumptionUpdate"],HC(h)),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function JC(t){const e={},n=a(t,["fps"]);n!=null&&l(e,["fps"],n);const o=a(t,["endOffset"]);o!=null&&l(e,["endOffset"],o);const i=a(t,["startOffset"]);return i!=null&&l(e,["startOffset"],i),e}function YC(t){const e={};if(a(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=a(t,["data"]);n!=null&&l(e,["data"],n);const o=a(t,["mimeType"]);return o!=null&&l(e,["mimeType"],o),e}function QC(t){const e={};if(a(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=a(t,["fileUri"]);n!=null&&l(e,["fileUri"],n);const o=a(t,["mimeType"]);return o!=null&&l(e,["mimeType"],o),e}function KC(t){const e={},n=a(t,["videoMetadata"]);n!=null&&l(e,["videoMetadata"],JC(n));const o=a(t,["thought"]);o!=null&&l(e,["thought"],o);const i=a(t,["inlineData"]);i!=null&&l(e,["inlineData"],YC(i));const c=a(t,["fileData"]);c!=null&&l(e,["fileData"],QC(c));const f=a(t,["thoughtSignature"]);f!=null&&l(e,["thoughtSignature"],f);const m=a(t,["codeExecutionResult"]);m!=null&&l(e,["codeExecutionResult"],m);const h=a(t,["executableCode"]);h!=null&&l(e,["executableCode"],h);const p=a(t,["functionCall"]);p!=null&&l(e,["functionCall"],p);const v=a(t,["functionResponse"]);v!=null&&l(e,["functionResponse"],v);const x=a(t,["text"]);return x!=null&&l(e,["text"],x),e}function Za(t){const e={},n=a(t,["parts"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(c=>KC(c))),l(e,["parts"],i)}const o=a(t,["role"]);return o!=null&&l(e,["role"],o),e}function ZC(t){const e={},n=a(t,["anyOf"]);n!=null&&l(e,["anyOf"],n);const o=a(t,["default"]);o!=null&&l(e,["default"],o);const i=a(t,["description"]);i!=null&&l(e,["description"],i);const c=a(t,["enum"]);c!=null&&l(e,["enum"],c);const f=a(t,["example"]);f!=null&&l(e,["example"],f);const m=a(t,["format"]);m!=null&&l(e,["format"],m);const h=a(t,["items"]);h!=null&&l(e,["items"],h);const p=a(t,["maxItems"]);p!=null&&l(e,["maxItems"],p);const v=a(t,["maxLength"]);v!=null&&l(e,["maxLength"],v);const x=a(t,["maxProperties"]);x!=null&&l(e,["maxProperties"],x);const C=a(t,["maximum"]);C!=null&&l(e,["maximum"],C);const S=a(t,["minItems"]);S!=null&&l(e,["minItems"],S);const b=a(t,["minLength"]);b!=null&&l(e,["minLength"],b);const T=a(t,["minProperties"]);T!=null&&l(e,["minProperties"],T);const A=a(t,["minimum"]);A!=null&&l(e,["minimum"],A);const D=a(t,["nullable"]);D!=null&&l(e,["nullable"],D);const F=a(t,["pattern"]);F!=null&&l(e,["pattern"],F);const L=a(t,["properties"]);L!=null&&l(e,["properties"],L);const R=a(t,["propertyOrdering"]);R!=null&&l(e,["propertyOrdering"],R);const P=a(t,["required"]);P!=null&&l(e,["required"],P);const G=a(t,["title"]);G!=null&&l(e,["title"],G);const $=a(t,["type"]);return $!=null&&l(e,["type"],$),e}function XC(t){const e={};if(a(t,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const n=a(t,["category"]);n!=null&&l(e,["category"],n);const o=a(t,["threshold"]);return o!=null&&l(e,["threshold"],o),e}function eS(t){const e={},n=a(t,["behavior"]);n!=null&&l(e,["behavior"],n);const o=a(t,["description"]);o!=null&&l(e,["description"],o);const i=a(t,["name"]);i!=null&&l(e,["name"],i);const c=a(t,["parameters"]);c!=null&&l(e,["parameters"],c);const f=a(t,["parametersJsonSchema"]);f!=null&&l(e,["parametersJsonSchema"],f);const m=a(t,["response"]);m!=null&&l(e,["response"],m);const h=a(t,["responseJsonSchema"]);return h!=null&&l(e,["responseJsonSchema"],h),e}function tS(t){const e={},n=a(t,["startTime"]);n!=null&&l(e,["startTime"],n);const o=a(t,["endTime"]);return o!=null&&l(e,["endTime"],o),e}function nS(t){const e={},n=a(t,["timeRangeFilter"]);if(n!=null&&l(e,["timeRangeFilter"],tS(n)),a(t,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");return e}function rS(t){const e={},n=a(t,["mode"]);n!=null&&l(e,["mode"],n);const o=a(t,["dynamicThreshold"]);return o!=null&&l(e,["dynamicThreshold"],o),e}function oS(t){const e={},n=a(t,["dynamicRetrievalConfig"]);return n!=null&&l(e,["dynamicRetrievalConfig"],rS(n)),e}function sS(){return{}}function iS(t){const e={},n=a(t,["environment"]);return n!=null&&l(e,["environment"],n),e}function aS(t){const e={},n=a(t,["functionDeclarations"]);if(n!=null){let h=n;Array.isArray(h)&&(h=h.map(p=>eS(p))),l(e,["functionDeclarations"],h)}if(a(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const o=a(t,["googleSearch"]);o!=null&&l(e,["googleSearch"],nS(o));const i=a(t,["googleSearchRetrieval"]);if(i!=null&&l(e,["googleSearchRetrieval"],oS(i)),a(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(a(t,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");a(t,["urlContext"])!=null&&l(e,["urlContext"],sS());const f=a(t,["computerUse"]);f!=null&&l(e,["computerUse"],iS(f));const m=a(t,["codeExecution"]);return m!=null&&l(e,["codeExecution"],m),e}function lS(t){const e={},n=a(t,["mode"]);n!=null&&l(e,["mode"],n);const o=a(t,["allowedFunctionNames"]);return o!=null&&l(e,["allowedFunctionNames"],o),e}function uS(t){const e={},n=a(t,["latitude"]);n!=null&&l(e,["latitude"],n);const o=a(t,["longitude"]);return o!=null&&l(e,["longitude"],o),e}function cS(t){const e={},n=a(t,["latLng"]);n!=null&&l(e,["latLng"],uS(n));const o=a(t,["languageCode"]);return o!=null&&l(e,["languageCode"],o),e}function dS(t){const e={},n=a(t,["functionCallingConfig"]);n!=null&&l(e,["functionCallingConfig"],lS(n));const o=a(t,["retrievalConfig"]);return o!=null&&l(e,["retrievalConfig"],cS(o)),e}function fS(t){const e={},n=a(t,["voiceName"]);return n!=null&&l(e,["voiceName"],n),e}function hh(t){const e={},n=a(t,["prebuiltVoiceConfig"]);return n!=null&&l(e,["prebuiltVoiceConfig"],fS(n)),e}function mS(t){const e={},n=a(t,["speaker"]);n!=null&&l(e,["speaker"],n);const o=a(t,["voiceConfig"]);return o!=null&&l(e,["voiceConfig"],hh(o)),e}function pS(t){const e={},n=a(t,["speakerVoiceConfigs"]);if(n!=null){let o=n;Array.isArray(o)&&(o=o.map(i=>mS(i))),l(e,["speakerVoiceConfigs"],o)}return e}function hS(t){const e={},n=a(t,["voiceConfig"]);n!=null&&l(e,["voiceConfig"],hh(n));const o=a(t,["multiSpeakerVoiceConfig"]);o!=null&&l(e,["multiSpeakerVoiceConfig"],pS(o));const i=a(t,["languageCode"]);return i!=null&&l(e,["languageCode"],i),e}function gS(t){const e={},n=a(t,["includeThoughts"]);n!=null&&l(e,["includeThoughts"],n);const o=a(t,["thinkingBudget"]);return o!=null&&l(e,["thinkingBudget"],o),e}function yS(t,e,n){const o={},i=a(e,["systemInstruction"]);n!==void 0&&i!=null&&l(n,["systemInstruction"],Za(hn(i)));const c=a(e,["temperature"]);c!=null&&l(o,["temperature"],c);const f=a(e,["topP"]);f!=null&&l(o,["topP"],f);const m=a(e,["topK"]);m!=null&&l(o,["topK"],m);const h=a(e,["candidateCount"]);h!=null&&l(o,["candidateCount"],h);const p=a(e,["maxOutputTokens"]);p!=null&&l(o,["maxOutputTokens"],p);const v=a(e,["stopSequences"]);v!=null&&l(o,["stopSequences"],v);const x=a(e,["responseLogprobs"]);x!=null&&l(o,["responseLogprobs"],x);const C=a(e,["logprobs"]);C!=null&&l(o,["logprobs"],C);const S=a(e,["presencePenalty"]);S!=null&&l(o,["presencePenalty"],S);const b=a(e,["frequencyPenalty"]);b!=null&&l(o,["frequencyPenalty"],b);const T=a(e,["seed"]);T!=null&&l(o,["seed"],T);const A=a(e,["responseMimeType"]);A!=null&&l(o,["responseMimeType"],A);const D=a(e,["responseSchema"]);D!=null&&l(o,["responseSchema"],ZC(bc(D)));const F=a(e,["responseJsonSchema"]);if(F!=null&&l(o,["responseJsonSchema"],F),a(e,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(a(e,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const L=a(e,["safetySettings"]);if(n!==void 0&&L!=null){let le=L;Array.isArray(le)&&(le=le.map(Q=>XC(Q))),l(n,["safetySettings"],le)}const R=a(e,["tools"]);if(n!==void 0&&R!=null){let le=As(R);Array.isArray(le)&&(le=le.map(Q=>aS(Is(Q)))),l(n,["tools"],le)}const P=a(e,["toolConfig"]);if(n!==void 0&&P!=null&&l(n,["toolConfig"],dS(P)),a(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const G=a(e,["cachedContent"]);n!==void 0&&G!=null&&l(n,["cachedContent"],Pr(t,G));const $=a(e,["responseModalities"]);$!=null&&l(o,["responseModalities"],$);const oe=a(e,["mediaResolution"]);oe!=null&&l(o,["mediaResolution"],oe);const J=a(e,["speechConfig"]);if(J!=null&&l(o,["speechConfig"],hS(Nc(J))),a(e,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const Z=a(e,["thinkingConfig"]);return Z!=null&&l(o,["thinkingConfig"],gS(Z)),o}function yp(t,e){const n={},o=a(e,["model"]);o!=null&&l(n,["_url","model"],_t(t,o));const i=a(e,["contents"]);if(i!=null){let f=Wn(i);Array.isArray(f)&&(f=f.map(m=>Za(m))),l(n,["contents"],f)}const c=a(e,["config"]);return c!=null&&l(n,["generationConfig"],yS(t,c,n)),n}function vS(t,e){const n={},o=a(t,["taskType"]);e!==void 0&&o!=null&&l(e,["requests[]","taskType"],o);const i=a(t,["title"]);e!==void 0&&i!=null&&l(e,["requests[]","title"],i);const c=a(t,["outputDimensionality"]);if(e!==void 0&&c!=null&&l(e,["requests[]","outputDimensionality"],c),a(t,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(a(t,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return n}function xS(t,e){const n={},o=a(e,["model"]);o!=null&&l(n,["_url","model"],_t(t,o));const i=a(e,["contents"]);i!=null&&l(n,["requests[]","content"],Zp(t,i));const c=a(e,["config"]);c!=null&&l(n,["config"],vS(c,n));const f=a(e,["model"]);return f!==void 0&&l(n,["requests[]","model"],_t(t,f)),n}function wS(t,e){const n={};if(a(t,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(a(t,["negativePrompt"])!==void 0)throw new Error("negativePrompt parameter is not supported in Gemini API.");const o=a(t,["numberOfImages"]);e!==void 0&&o!=null&&l(e,["parameters","sampleCount"],o);const i=a(t,["aspectRatio"]);e!==void 0&&i!=null&&l(e,["parameters","aspectRatio"],i);const c=a(t,["guidanceScale"]);if(e!==void 0&&c!=null&&l(e,["parameters","guidanceScale"],c),a(t,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const f=a(t,["safetyFilterLevel"]);e!==void 0&&f!=null&&l(e,["parameters","safetySetting"],f);const m=a(t,["personGeneration"]);e!==void 0&&m!=null&&l(e,["parameters","personGeneration"],m);const h=a(t,["includeSafetyAttributes"]);e!==void 0&&h!=null&&l(e,["parameters","includeSafetyAttributes"],h);const p=a(t,["includeRaiReason"]);e!==void 0&&p!=null&&l(e,["parameters","includeRaiReason"],p);const v=a(t,["language"]);e!==void 0&&v!=null&&l(e,["parameters","language"],v);const x=a(t,["outputMimeType"]);e!==void 0&&x!=null&&l(e,["parameters","outputOptions","mimeType"],x);const C=a(t,["outputCompressionQuality"]);if(e!==void 0&&C!=null&&l(e,["parameters","outputOptions","compressionQuality"],C),a(t,["addWatermark"])!==void 0)throw new Error("addWatermark parameter is not supported in Gemini API.");const S=a(t,["imageSize"]);if(e!==void 0&&S!=null&&l(e,["parameters","sampleImageSize"],S),a(t,["enhancePrompt"])!==void 0)throw new Error("enhancePrompt parameter is not supported in Gemini API.");return n}function CS(t,e){const n={},o=a(e,["model"]);o!=null&&l(n,["_url","model"],_t(t,o));const i=a(e,["prompt"]);i!=null&&l(n,["instances[0]","prompt"],i);const c=a(e,["config"]);return c!=null&&l(n,["config"],wS(c,n)),n}function SS(t,e){const n={},o=a(e,["model"]);o!=null&&l(n,["_url","name"],_t(t,o));const i=a(e,["config"]);return i!=null&&l(n,["config"],i),n}function kS(t,e,n){const o={},i=a(e,["pageSize"]);n!==void 0&&i!=null&&l(n,["_query","pageSize"],i);const c=a(e,["pageToken"]);n!==void 0&&c!=null&&l(n,["_query","pageToken"],c);const f=a(e,["filter"]);n!==void 0&&f!=null&&l(n,["_query","filter"],f);const m=a(e,["queryBase"]);return n!==void 0&&m!=null&&l(n,["_url","models_url"],th(t,m)),o}function TS(t,e){const n={},o=a(e,["config"]);return o!=null&&l(n,["config"],kS(t,o,n)),n}function _S(t,e){const n={},o=a(t,["displayName"]);e!==void 0&&o!=null&&l(e,["displayName"],o);const i=a(t,["description"]);e!==void 0&&i!=null&&l(e,["description"],i);const c=a(t,["defaultCheckpointId"]);return e!==void 0&&c!=null&&l(e,["defaultCheckpointId"],c),n}function ES(t,e){const n={},o=a(e,["model"]);o!=null&&l(n,["_url","name"],_t(t,o));const i=a(e,["config"]);return i!=null&&l(n,["config"],_S(i,n)),n}function bS(t,e){const n={},o=a(e,["model"]);o!=null&&l(n,["_url","name"],_t(t,o));const i=a(e,["config"]);return i!=null&&l(n,["config"],i),n}function NS(t){const e={};if(a(t,["systemInstruction"])!==void 0)throw new Error("systemInstruction parameter is not supported in Gemini API.");if(a(t,["tools"])!==void 0)throw new Error("tools parameter is not supported in Gemini API.");if(a(t,["generationConfig"])!==void 0)throw new Error("generationConfig parameter is not supported in Gemini API.");return e}function IS(t,e){const n={},o=a(e,["model"]);o!=null&&l(n,["_url","model"],_t(t,o));const i=a(e,["contents"]);if(i!=null){let f=Wn(i);Array.isArray(f)&&(f=f.map(m=>Za(m))),l(n,["contents"],f)}const c=a(e,["config"]);return c!=null&&l(n,["config"],NS(c)),n}function AS(t){const e={};if(a(t,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");const n=a(t,["imageBytes"]);n!=null&&l(e,["bytesBase64Encoded"],$o(n));const o=a(t,["mimeType"]);return o!=null&&l(e,["mimeType"],o),e}function DS(t,e){const n={},o=a(t,["numberOfVideos"]);if(e!==void 0&&o!=null&&l(e,["parameters","sampleCount"],o),a(t,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(a(t,["fps"])!==void 0)throw new Error("fps parameter is not supported in Gemini API.");const i=a(t,["durationSeconds"]);if(e!==void 0&&i!=null&&l(e,["parameters","durationSeconds"],i),a(t,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const c=a(t,["aspectRatio"]);if(e!==void 0&&c!=null&&l(e,["parameters","aspectRatio"],c),a(t,["resolution"])!==void 0)throw new Error("resolution parameter is not supported in Gemini API.");const f=a(t,["personGeneration"]);if(e!==void 0&&f!=null&&l(e,["parameters","personGeneration"],f),a(t,["pubsubTopic"])!==void 0)throw new Error("pubsubTopic parameter is not supported in Gemini API.");const m=a(t,["negativePrompt"]);e!==void 0&&m!=null&&l(e,["parameters","negativePrompt"],m);const h=a(t,["enhancePrompt"]);if(e!==void 0&&h!=null&&l(e,["parameters","enhancePrompt"],h),a(t,["generateAudio"])!==void 0)throw new Error("generateAudio parameter is not supported in Gemini API.");if(a(t,["lastFrame"])!==void 0)throw new Error("lastFrame parameter is not supported in Gemini API.");if(a(t,["referenceImages"])!==void 0)throw new Error("referenceImages parameter is not supported in Gemini API.");if(a(t,["compressionQuality"])!==void 0)throw new Error("compressionQuality parameter is not supported in Gemini API.");return n}function MS(t,e){const n={},o=a(e,["model"]);o!=null&&l(n,["_url","model"],_t(t,o));const i=a(e,["prompt"]);i!=null&&l(n,["instances[0]","prompt"],i);const c=a(e,["image"]);if(c!=null&&l(n,["instances[0]","image"],AS(c)),a(e,["video"])!==void 0)throw new Error("video parameter is not supported in Gemini API.");const f=a(e,["config"]);return f!=null&&l(n,["config"],DS(f,n)),n}function RS(t){const e={},n=a(t,["fps"]);n!=null&&l(e,["fps"],n);const o=a(t,["endOffset"]);o!=null&&l(e,["endOffset"],o);const i=a(t,["startOffset"]);return i!=null&&l(e,["startOffset"],i),e}function PS(t){const e={},n=a(t,["displayName"]);n!=null&&l(e,["displayName"],n);const o=a(t,["data"]);o!=null&&l(e,["data"],o);const i=a(t,["mimeType"]);return i!=null&&l(e,["mimeType"],i),e}function FS(t){const e={},n=a(t,["displayName"]);n!=null&&l(e,["displayName"],n);const o=a(t,["fileUri"]);o!=null&&l(e,["fileUri"],o);const i=a(t,["mimeType"]);return i!=null&&l(e,["mimeType"],i),e}function LS(t){const e={},n=a(t,["videoMetadata"]);n!=null&&l(e,["videoMetadata"],RS(n));const o=a(t,["thought"]);o!=null&&l(e,["thought"],o);const i=a(t,["inlineData"]);i!=null&&l(e,["inlineData"],PS(i));const c=a(t,["fileData"]);c!=null&&l(e,["fileData"],FS(c));const f=a(t,["thoughtSignature"]);f!=null&&l(e,["thoughtSignature"],f);const m=a(t,["codeExecutionResult"]);m!=null&&l(e,["codeExecutionResult"],m);const h=a(t,["executableCode"]);h!=null&&l(e,["executableCode"],h);const p=a(t,["functionCall"]);p!=null&&l(e,["functionCall"],p);const v=a(t,["functionResponse"]);v!=null&&l(e,["functionResponse"],v);const x=a(t,["text"]);return x!=null&&l(e,["text"],x),e}function Ms(t){const e={},n=a(t,["parts"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(c=>LS(c))),l(e,["parts"],i)}const o=a(t,["role"]);return o!=null&&l(e,["role"],o),e}function US(t){const e={},n=a(t,["anyOf"]);n!=null&&l(e,["anyOf"],n);const o=a(t,["default"]);o!=null&&l(e,["default"],o);const i=a(t,["description"]);i!=null&&l(e,["description"],i);const c=a(t,["enum"]);c!=null&&l(e,["enum"],c);const f=a(t,["example"]);f!=null&&l(e,["example"],f);const m=a(t,["format"]);m!=null&&l(e,["format"],m);const h=a(t,["items"]);h!=null&&l(e,["items"],h);const p=a(t,["maxItems"]);p!=null&&l(e,["maxItems"],p);const v=a(t,["maxLength"]);v!=null&&l(e,["maxLength"],v);const x=a(t,["maxProperties"]);x!=null&&l(e,["maxProperties"],x);const C=a(t,["maximum"]);C!=null&&l(e,["maximum"],C);const S=a(t,["minItems"]);S!=null&&l(e,["minItems"],S);const b=a(t,["minLength"]);b!=null&&l(e,["minLength"],b);const T=a(t,["minProperties"]);T!=null&&l(e,["minProperties"],T);const A=a(t,["minimum"]);A!=null&&l(e,["minimum"],A);const D=a(t,["nullable"]);D!=null&&l(e,["nullable"],D);const F=a(t,["pattern"]);F!=null&&l(e,["pattern"],F);const L=a(t,["properties"]);L!=null&&l(e,["properties"],L);const R=a(t,["propertyOrdering"]);R!=null&&l(e,["propertyOrdering"],R);const P=a(t,["required"]);P!=null&&l(e,["required"],P);const G=a(t,["title"]);G!=null&&l(e,["title"],G);const $=a(t,["type"]);return $!=null&&l(e,["type"],$),e}function jS(t){const e={},n=a(t,["featureSelectionPreference"]);return n!=null&&l(e,["featureSelectionPreference"],n),e}function qS(t){const e={},n=a(t,["method"]);n!=null&&l(e,["method"],n);const o=a(t,["category"]);o!=null&&l(e,["category"],o);const i=a(t,["threshold"]);return i!=null&&l(e,["threshold"],i),e}function zS(t){const e={};if(a(t,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const n=a(t,["description"]);n!=null&&l(e,["description"],n);const o=a(t,["name"]);o!=null&&l(e,["name"],o);const i=a(t,["parameters"]);i!=null&&l(e,["parameters"],i);const c=a(t,["parametersJsonSchema"]);c!=null&&l(e,["parametersJsonSchema"],c);const f=a(t,["response"]);f!=null&&l(e,["response"],f);const m=a(t,["responseJsonSchema"]);return m!=null&&l(e,["responseJsonSchema"],m),e}function OS(t){const e={},n=a(t,["startTime"]);n!=null&&l(e,["startTime"],n);const o=a(t,["endTime"]);return o!=null&&l(e,["endTime"],o),e}function BS(t){const e={},n=a(t,["timeRangeFilter"]);n!=null&&l(e,["timeRangeFilter"],OS(n));const o=a(t,["excludeDomains"]);return o!=null&&l(e,["excludeDomains"],o),e}function VS(t){const e={},n=a(t,["mode"]);n!=null&&l(e,["mode"],n);const o=a(t,["dynamicThreshold"]);return o!=null&&l(e,["dynamicThreshold"],o),e}function GS(t){const e={},n=a(t,["dynamicRetrievalConfig"]);return n!=null&&l(e,["dynamicRetrievalConfig"],VS(n)),e}function $S(t){const e={},n=a(t,["excludeDomains"]);return n!=null&&l(e,["excludeDomains"],n),e}function HS(t){const e={},n=a(t,["apiKeyString"]);return n!=null&&l(e,["apiKeyString"],n),e}function WS(t){const e={},n=a(t,["apiKeyConfig"]);n!=null&&l(e,["apiKeyConfig"],HS(n));const o=a(t,["authType"]);o!=null&&l(e,["authType"],o);const i=a(t,["googleServiceAccountConfig"]);i!=null&&l(e,["googleServiceAccountConfig"],i);const c=a(t,["httpBasicAuthConfig"]);c!=null&&l(e,["httpBasicAuthConfig"],c);const f=a(t,["oauthConfig"]);f!=null&&l(e,["oauthConfig"],f);const m=a(t,["oidcConfig"]);return m!=null&&l(e,["oidcConfig"],m),e}function JS(t){const e={},n=a(t,["authConfig"]);return n!=null&&l(e,["authConfig"],WS(n)),e}function YS(){return{}}function QS(t){const e={},n=a(t,["environment"]);return n!=null&&l(e,["environment"],n),e}function gh(t){const e={},n=a(t,["functionDeclarations"]);if(n!=null){let x=n;Array.isArray(x)&&(x=x.map(C=>zS(C))),l(e,["functionDeclarations"],x)}const o=a(t,["retrieval"]);o!=null&&l(e,["retrieval"],o);const i=a(t,["googleSearch"]);i!=null&&l(e,["googleSearch"],BS(i));const c=a(t,["googleSearchRetrieval"]);c!=null&&l(e,["googleSearchRetrieval"],GS(c));const f=a(t,["enterpriseWebSearch"]);f!=null&&l(e,["enterpriseWebSearch"],$S(f));const m=a(t,["googleMaps"]);m!=null&&l(e,["googleMaps"],JS(m)),a(t,["urlContext"])!=null&&l(e,["urlContext"],YS());const p=a(t,["computerUse"]);p!=null&&l(e,["computerUse"],QS(p));const v=a(t,["codeExecution"]);return v!=null&&l(e,["codeExecution"],v),e}function KS(t){const e={},n=a(t,["mode"]);n!=null&&l(e,["mode"],n);const o=a(t,["allowedFunctionNames"]);return o!=null&&l(e,["allowedFunctionNames"],o),e}function ZS(t){const e={},n=a(t,["latitude"]);n!=null&&l(e,["latitude"],n);const o=a(t,["longitude"]);return o!=null&&l(e,["longitude"],o),e}function XS(t){const e={},n=a(t,["latLng"]);n!=null&&l(e,["latLng"],ZS(n));const o=a(t,["languageCode"]);return o!=null&&l(e,["languageCode"],o),e}function e1(t){const e={},n=a(t,["functionCallingConfig"]);n!=null&&l(e,["functionCallingConfig"],KS(n));const o=a(t,["retrievalConfig"]);return o!=null&&l(e,["retrievalConfig"],XS(o)),e}function t1(t){const e={},n=a(t,["voiceName"]);return n!=null&&l(e,["voiceName"],n),e}function n1(t){const e={},n=a(t,["prebuiltVoiceConfig"]);return n!=null&&l(e,["prebuiltVoiceConfig"],t1(n)),e}function r1(t){const e={},n=a(t,["voiceConfig"]);if(n!=null&&l(e,["voiceConfig"],n1(n)),a(t,["multiSpeakerVoiceConfig"])!==void 0)throw new Error("multiSpeakerVoiceConfig parameter is not supported in Vertex AI.");const o=a(t,["languageCode"]);return o!=null&&l(e,["languageCode"],o),e}function o1(t){const e={},n=a(t,["includeThoughts"]);n!=null&&l(e,["includeThoughts"],n);const o=a(t,["thinkingBudget"]);return o!=null&&l(e,["thinkingBudget"],o),e}function s1(t,e,n){const o={},i=a(e,["systemInstruction"]);n!==void 0&&i!=null&&l(n,["systemInstruction"],Ms(hn(i)));const c=a(e,["temperature"]);c!=null&&l(o,["temperature"],c);const f=a(e,["topP"]);f!=null&&l(o,["topP"],f);const m=a(e,["topK"]);m!=null&&l(o,["topK"],m);const h=a(e,["candidateCount"]);h!=null&&l(o,["candidateCount"],h);const p=a(e,["maxOutputTokens"]);p!=null&&l(o,["maxOutputTokens"],p);const v=a(e,["stopSequences"]);v!=null&&l(o,["stopSequences"],v);const x=a(e,["responseLogprobs"]);x!=null&&l(o,["responseLogprobs"],x);const C=a(e,["logprobs"]);C!=null&&l(o,["logprobs"],C);const S=a(e,["presencePenalty"]);S!=null&&l(o,["presencePenalty"],S);const b=a(e,["frequencyPenalty"]);b!=null&&l(o,["frequencyPenalty"],b);const T=a(e,["seed"]);T!=null&&l(o,["seed"],T);const A=a(e,["responseMimeType"]);A!=null&&l(o,["responseMimeType"],A);const D=a(e,["responseSchema"]);D!=null&&l(o,["responseSchema"],US(bc(D)));const F=a(e,["responseJsonSchema"]);F!=null&&l(o,["responseJsonSchema"],F);const L=a(e,["routingConfig"]);L!=null&&l(o,["routingConfig"],L);const R=a(e,["modelSelectionConfig"]);R!=null&&l(o,["modelConfig"],jS(R));const P=a(e,["safetySettings"]);if(n!==void 0&&P!=null){let pe=P;Array.isArray(pe)&&(pe=pe.map(be=>qS(be))),l(n,["safetySettings"],pe)}const G=a(e,["tools"]);if(n!==void 0&&G!=null){let pe=As(G);Array.isArray(pe)&&(pe=pe.map(be=>gh(Is(be)))),l(n,["tools"],pe)}const $=a(e,["toolConfig"]);n!==void 0&&$!=null&&l(n,["toolConfig"],e1($));const oe=a(e,["labels"]);n!==void 0&&oe!=null&&l(n,["labels"],oe);const J=a(e,["cachedContent"]);n!==void 0&&J!=null&&l(n,["cachedContent"],Pr(t,J));const Z=a(e,["responseModalities"]);Z!=null&&l(o,["responseModalities"],Z);const le=a(e,["mediaResolution"]);le!=null&&l(o,["mediaResolution"],le);const Q=a(e,["speechConfig"]);Q!=null&&l(o,["speechConfig"],r1(Nc(Q)));const Y=a(e,["audioTimestamp"]);Y!=null&&l(o,["audioTimestamp"],Y);const M=a(e,["thinkingConfig"]);return M!=null&&l(o,["thinkingConfig"],o1(M)),o}function vp(t,e){const n={},o=a(e,["model"]);o!=null&&l(n,["_url","model"],_t(t,o));const i=a(e,["contents"]);if(i!=null){let f=Wn(i);Array.isArray(f)&&(f=f.map(m=>Ms(m))),l(n,["contents"],f)}const c=a(e,["config"]);return c!=null&&l(n,["generationConfig"],s1(t,c,n)),n}function i1(t,e){const n={},o=a(t,["taskType"]);e!==void 0&&o!=null&&l(e,["instances[]","task_type"],o);const i=a(t,["title"]);e!==void 0&&i!=null&&l(e,["instances[]","title"],i);const c=a(t,["outputDimensionality"]);e!==void 0&&c!=null&&l(e,["parameters","outputDimensionality"],c);const f=a(t,["mimeType"]);e!==void 0&&f!=null&&l(e,["instances[]","mimeType"],f);const m=a(t,["autoTruncate"]);return e!==void 0&&m!=null&&l(e,["parameters","autoTruncate"],m),n}function a1(t,e){const n={},o=a(e,["model"]);o!=null&&l(n,["_url","model"],_t(t,o));const i=a(e,["contents"]);i!=null&&l(n,["instances[]","content"],Zp(t,i));const c=a(e,["config"]);return c!=null&&l(n,["config"],i1(c,n)),n}function l1(t,e){const n={},o=a(t,["outputGcsUri"]);e!==void 0&&o!=null&&l(e,["parameters","storageUri"],o);const i=a(t,["negativePrompt"]);e!==void 0&&i!=null&&l(e,["parameters","negativePrompt"],i);const c=a(t,["numberOfImages"]);e!==void 0&&c!=null&&l(e,["parameters","sampleCount"],c);const f=a(t,["aspectRatio"]);e!==void 0&&f!=null&&l(e,["parameters","aspectRatio"],f);const m=a(t,["guidanceScale"]);e!==void 0&&m!=null&&l(e,["parameters","guidanceScale"],m);const h=a(t,["seed"]);e!==void 0&&h!=null&&l(e,["parameters","seed"],h);const p=a(t,["safetyFilterLevel"]);e!==void 0&&p!=null&&l(e,["parameters","safetySetting"],p);const v=a(t,["personGeneration"]);e!==void 0&&v!=null&&l(e,["parameters","personGeneration"],v);const x=a(t,["includeSafetyAttributes"]);e!==void 0&&x!=null&&l(e,["parameters","includeSafetyAttributes"],x);const C=a(t,["includeRaiReason"]);e!==void 0&&C!=null&&l(e,["parameters","includeRaiReason"],C);const S=a(t,["language"]);e!==void 0&&S!=null&&l(e,["parameters","language"],S);const b=a(t,["outputMimeType"]);e!==void 0&&b!=null&&l(e,["parameters","outputOptions","mimeType"],b);const T=a(t,["outputCompressionQuality"]);e!==void 0&&T!=null&&l(e,["parameters","outputOptions","compressionQuality"],T);const A=a(t,["addWatermark"]);e!==void 0&&A!=null&&l(e,["parameters","addWatermark"],A);const D=a(t,["imageSize"]);e!==void 0&&D!=null&&l(e,["parameters","sampleImageSize"],D);const F=a(t,["enhancePrompt"]);return e!==void 0&&F!=null&&l(e,["parameters","enhancePrompt"],F),n}function u1(t,e){const n={},o=a(e,["model"]);o!=null&&l(n,["_url","model"],_t(t,o));const i=a(e,["prompt"]);i!=null&&l(n,["instances[0]","prompt"],i);const c=a(e,["config"]);return c!=null&&l(n,["config"],l1(c,n)),n}function Fr(t){const e={},n=a(t,["gcsUri"]);n!=null&&l(e,["gcsUri"],n);const o=a(t,["imageBytes"]);o!=null&&l(e,["bytesBase64Encoded"],$o(o));const i=a(t,["mimeType"]);return i!=null&&l(e,["mimeType"],i),e}function c1(t){const e={},n=a(t,["maskMode"]);n!=null&&l(e,["maskMode"],n);const o=a(t,["segmentationClasses"]);o!=null&&l(e,["maskClasses"],o);const i=a(t,["maskDilation"]);return i!=null&&l(e,["dilation"],i),e}function d1(t){const e={},n=a(t,["controlType"]);n!=null&&l(e,["controlType"],n);const o=a(t,["enableControlImageComputation"]);return o!=null&&l(e,["computeControl"],o),e}function f1(t){const e={},n=a(t,["styleDescription"]);return n!=null&&l(e,["styleDescription"],n),e}function m1(t){const e={},n=a(t,["subjectType"]);n!=null&&l(e,["subjectType"],n);const o=a(t,["subjectDescription"]);return o!=null&&l(e,["subjectDescription"],o),e}function p1(t){const e={},n=a(t,["referenceImage"]);n!=null&&l(e,["referenceImage"],Fr(n));const o=a(t,["referenceId"]);o!=null&&l(e,["referenceId"],o);const i=a(t,["referenceType"]);i!=null&&l(e,["referenceType"],i);const c=a(t,["maskImageConfig"]);c!=null&&l(e,["maskImageConfig"],c1(c));const f=a(t,["controlImageConfig"]);f!=null&&l(e,["controlImageConfig"],d1(f));const m=a(t,["styleImageConfig"]);m!=null&&l(e,["styleImageConfig"],f1(m));const h=a(t,["subjectImageConfig"]);return h!=null&&l(e,["subjectImageConfig"],m1(h)),e}function h1(t,e){const n={},o=a(t,["outputGcsUri"]);e!==void 0&&o!=null&&l(e,["parameters","storageUri"],o);const i=a(t,["negativePrompt"]);e!==void 0&&i!=null&&l(e,["parameters","negativePrompt"],i);const c=a(t,["numberOfImages"]);e!==void 0&&c!=null&&l(e,["parameters","sampleCount"],c);const f=a(t,["aspectRatio"]);e!==void 0&&f!=null&&l(e,["parameters","aspectRatio"],f);const m=a(t,["guidanceScale"]);e!==void 0&&m!=null&&l(e,["parameters","guidanceScale"],m);const h=a(t,["seed"]);e!==void 0&&h!=null&&l(e,["parameters","seed"],h);const p=a(t,["safetyFilterLevel"]);e!==void 0&&p!=null&&l(e,["parameters","safetySetting"],p);const v=a(t,["personGeneration"]);e!==void 0&&v!=null&&l(e,["parameters","personGeneration"],v);const x=a(t,["includeSafetyAttributes"]);e!==void 0&&x!=null&&l(e,["parameters","includeSafetyAttributes"],x);const C=a(t,["includeRaiReason"]);e!==void 0&&C!=null&&l(e,["parameters","includeRaiReason"],C);const S=a(t,["language"]);e!==void 0&&S!=null&&l(e,["parameters","language"],S);const b=a(t,["outputMimeType"]);e!==void 0&&b!=null&&l(e,["parameters","outputOptions","mimeType"],b);const T=a(t,["outputCompressionQuality"]);e!==void 0&&T!=null&&l(e,["parameters","outputOptions","compressionQuality"],T);const A=a(t,["addWatermark"]);e!==void 0&&A!=null&&l(e,["parameters","addWatermark"],A);const D=a(t,["editMode"]);e!==void 0&&D!=null&&l(e,["parameters","editMode"],D);const F=a(t,["baseSteps"]);return e!==void 0&&F!=null&&l(e,["parameters","editConfig","baseSteps"],F),n}function g1(t,e){const n={},o=a(e,["model"]);o!=null&&l(n,["_url","model"],_t(t,o));const i=a(e,["prompt"]);i!=null&&l(n,["instances[0]","prompt"],i);const c=a(e,["referenceImages"]);if(c!=null){let m=c;Array.isArray(m)&&(m=m.map(h=>p1(h))),l(n,["instances[0]","referenceImages"],m)}const f=a(e,["config"]);return f!=null&&l(n,["config"],h1(f,n)),n}function y1(t,e){const n={},o=a(t,["includeRaiReason"]);e!==void 0&&o!=null&&l(e,["parameters","includeRaiReason"],o);const i=a(t,["outputMimeType"]);e!==void 0&&i!=null&&l(e,["parameters","outputOptions","mimeType"],i);const c=a(t,["outputCompressionQuality"]);e!==void 0&&c!=null&&l(e,["parameters","outputOptions","compressionQuality"],c);const f=a(t,["enhanceInputImage"]);e!==void 0&&f!=null&&l(e,["parameters","upscaleConfig","enhanceInputImage"],f);const m=a(t,["imagePreservationFactor"]);e!==void 0&&m!=null&&l(e,["parameters","upscaleConfig","imagePreservationFactor"],m);const h=a(t,["numberOfImages"]);e!==void 0&&h!=null&&l(e,["parameters","sampleCount"],h);const p=a(t,["mode"]);return e!==void 0&&p!=null&&l(e,["parameters","mode"],p),n}function v1(t,e){const n={},o=a(e,["model"]);o!=null&&l(n,["_url","model"],_t(t,o));const i=a(e,["image"]);i!=null&&l(n,["instances[0]","image"],Fr(i));const c=a(e,["upscaleFactor"]);c!=null&&l(n,["parameters","upscaleConfig","upscaleFactor"],c);const f=a(e,["config"]);return f!=null&&l(n,["config"],y1(f,n)),n}function x1(t){const e={},n=a(t,["productImage"]);return n!=null&&l(e,["image"],Fr(n)),e}function w1(t,e){const n={},o=a(t,["prompt"]);e!==void 0&&o!=null&&l(e,["instances[0]","prompt"],o);const i=a(t,["personImage"]);e!==void 0&&i!=null&&l(e,["instances[0]","personImage","image"],Fr(i));const c=a(t,["productImages"]);if(e!==void 0&&c!=null){let f=c;Array.isArray(f)&&(f=f.map(m=>x1(m))),l(e,["instances[0]","productImages"],f)}return n}function C1(t,e){const n={},o=a(t,["numberOfImages"]);e!==void 0&&o!=null&&l(e,["parameters","sampleCount"],o);const i=a(t,["baseSteps"]);e!==void 0&&i!=null&&l(e,["parameters","editConfig","baseSteps"],i);const c=a(t,["outputGcsUri"]);e!==void 0&&c!=null&&l(e,["parameters","storageUri"],c);const f=a(t,["seed"]);e!==void 0&&f!=null&&l(e,["parameters","seed"],f);const m=a(t,["safetyFilterLevel"]);e!==void 0&&m!=null&&l(e,["parameters","safetySetting"],m);const h=a(t,["personGeneration"]);e!==void 0&&h!=null&&l(e,["parameters","personGeneration"],h);const p=a(t,["outputMimeType"]);e!==void 0&&p!=null&&l(e,["parameters","outputOptions","mimeType"],p);const v=a(t,["outputCompressionQuality"]);e!==void 0&&v!=null&&l(e,["parameters","outputOptions","compressionQuality"],v);const x=a(t,["enhancePrompt"]);return e!==void 0&&x!=null&&l(e,["parameters","enhancePrompt"],x),n}function S1(t,e){const n={},o=a(e,["model"]);o!=null&&l(n,["_url","model"],_t(t,o));const i=a(e,["source"]);i!=null&&l(n,["config"],w1(i,n));const c=a(e,["config"]);return c!=null&&l(n,["config"],C1(c,n)),n}function k1(t){const e={},n=a(t,["image"]);return n!=null&&l(e,["image"],Fr(n)),e}function T1(t,e){const n={},o=a(t,["prompt"]);e!==void 0&&o!=null&&l(e,["instances[0]","prompt"],o);const i=a(t,["image"]);e!==void 0&&i!=null&&l(e,["instances[0]","image"],Fr(i));const c=a(t,["scribbleImage"]);return e!==void 0&&c!=null&&l(e,["instances[0]","scribble"],k1(c)),n}function _1(t,e){const n={},o=a(t,["mode"]);e!==void 0&&o!=null&&l(e,["parameters","mode"],o);const i=a(t,["maxPredictions"]);e!==void 0&&i!=null&&l(e,["parameters","maxPredictions"],i);const c=a(t,["confidenceThreshold"]);e!==void 0&&c!=null&&l(e,["parameters","confidenceThreshold"],c);const f=a(t,["maskDilation"]);e!==void 0&&f!=null&&l(e,["parameters","maskDilation"],f);const m=a(t,["binaryColorThreshold"]);return e!==void 0&&m!=null&&l(e,["parameters","binaryColorThreshold"],m),n}function E1(t,e){const n={},o=a(e,["model"]);o!=null&&l(n,["_url","model"],_t(t,o));const i=a(e,["source"]);i!=null&&l(n,["config"],T1(i,n));const c=a(e,["config"]);return c!=null&&l(n,["config"],_1(c,n)),n}function b1(t,e){const n={},o=a(e,["model"]);o!=null&&l(n,["_url","name"],_t(t,o));const i=a(e,["config"]);return i!=null&&l(n,["config"],i),n}function N1(t,e,n){const o={},i=a(e,["pageSize"]);n!==void 0&&i!=null&&l(n,["_query","pageSize"],i);const c=a(e,["pageToken"]);n!==void 0&&c!=null&&l(n,["_query","pageToken"],c);const f=a(e,["filter"]);n!==void 0&&f!=null&&l(n,["_query","filter"],f);const m=a(e,["queryBase"]);return n!==void 0&&m!=null&&l(n,["_url","models_url"],th(t,m)),o}function I1(t,e){const n={},o=a(e,["config"]);return o!=null&&l(n,["config"],N1(t,o,n)),n}function A1(t,e){const n={},o=a(t,["displayName"]);e!==void 0&&o!=null&&l(e,["displayName"],o);const i=a(t,["description"]);e!==void 0&&i!=null&&l(e,["description"],i);const c=a(t,["defaultCheckpointId"]);return e!==void 0&&c!=null&&l(e,["defaultCheckpointId"],c),n}function D1(t,e){const n={},o=a(e,["model"]);o!=null&&l(n,["_url","model"],_t(t,o));const i=a(e,["config"]);return i!=null&&l(n,["config"],A1(i,n)),n}function M1(t,e){const n={},o=a(e,["model"]);o!=null&&l(n,["_url","name"],_t(t,o));const i=a(e,["config"]);return i!=null&&l(n,["config"],i),n}function R1(t,e){const n={},o=a(t,["systemInstruction"]);e!==void 0&&o!=null&&l(e,["systemInstruction"],Ms(hn(o)));const i=a(t,["tools"]);if(e!==void 0&&i!=null){let f=i;Array.isArray(f)&&(f=f.map(m=>gh(m))),l(e,["tools"],f)}const c=a(t,["generationConfig"]);return e!==void 0&&c!=null&&l(e,["generationConfig"],c),n}function P1(t,e){const n={},o=a(e,["model"]);o!=null&&l(n,["_url","model"],_t(t,o));const i=a(e,["contents"]);if(i!=null){let f=Wn(i);Array.isArray(f)&&(f=f.map(m=>Ms(m))),l(n,["contents"],f)}const c=a(e,["config"]);return c!=null&&l(n,["config"],R1(c,n)),n}function F1(t,e){const n={},o=a(e,["model"]);o!=null&&l(n,["_url","model"],_t(t,o));const i=a(e,["contents"]);if(i!=null){let f=Wn(i);Array.isArray(f)&&(f=f.map(m=>Ms(m))),l(n,["contents"],f)}const c=a(e,["config"]);return c!=null&&l(n,["config"],c),n}function L1(t){const e={},n=a(t,["uri"]);n!=null&&l(e,["gcsUri"],n);const o=a(t,["videoBytes"]);o!=null&&l(e,["bytesBase64Encoded"],$o(o));const i=a(t,["mimeType"]);return i!=null&&l(e,["mimeType"],i),e}function U1(t){const e={},n=a(t,["image"]);n!=null&&l(e,["image"],Fr(n));const o=a(t,["referenceType"]);return o!=null&&l(e,["referenceType"],o),e}function j1(t,e){const n={},o=a(t,["numberOfVideos"]);e!==void 0&&o!=null&&l(e,["parameters","sampleCount"],o);const i=a(t,["outputGcsUri"]);e!==void 0&&i!=null&&l(e,["parameters","storageUri"],i);const c=a(t,["fps"]);e!==void 0&&c!=null&&l(e,["parameters","fps"],c);const f=a(t,["durationSeconds"]);e!==void 0&&f!=null&&l(e,["parameters","durationSeconds"],f);const m=a(t,["seed"]);e!==void 0&&m!=null&&l(e,["parameters","seed"],m);const h=a(t,["aspectRatio"]);e!==void 0&&h!=null&&l(e,["parameters","aspectRatio"],h);const p=a(t,["resolution"]);e!==void 0&&p!=null&&l(e,["parameters","resolution"],p);const v=a(t,["personGeneration"]);e!==void 0&&v!=null&&l(e,["parameters","personGeneration"],v);const x=a(t,["pubsubTopic"]);e!==void 0&&x!=null&&l(e,["parameters","pubsubTopic"],x);const C=a(t,["negativePrompt"]);e!==void 0&&C!=null&&l(e,["parameters","negativePrompt"],C);const S=a(t,["enhancePrompt"]);e!==void 0&&S!=null&&l(e,["parameters","enhancePrompt"],S);const b=a(t,["generateAudio"]);e!==void 0&&b!=null&&l(e,["parameters","generateAudio"],b);const T=a(t,["lastFrame"]);e!==void 0&&T!=null&&l(e,["instances[0]","lastFrame"],Fr(T));const A=a(t,["referenceImages"]);if(e!==void 0&&A!=null){let F=A;Array.isArray(F)&&(F=F.map(L=>U1(L))),l(e,["instances[0]","referenceImages"],F)}const D=a(t,["compressionQuality"]);return e!==void 0&&D!=null&&l(e,["parameters","compressionQuality"],D),n}function q1(t,e){const n={},o=a(e,["model"]);o!=null&&l(n,["_url","model"],_t(t,o));const i=a(e,["prompt"]);i!=null&&l(n,["instances[0]","prompt"],i);const c=a(e,["image"]);c!=null&&l(n,["instances[0]","image"],Fr(c));const f=a(e,["video"]);f!=null&&l(n,["instances[0]","video"],L1(f));const m=a(e,["config"]);return m!=null&&l(n,["config"],j1(m,n)),n}function z1(t){const e={},n=a(t,["fps"]);n!=null&&l(e,["fps"],n);const o=a(t,["endOffset"]);o!=null&&l(e,["endOffset"],o);const i=a(t,["startOffset"]);return i!=null&&l(e,["startOffset"],i),e}function O1(t){const e={},n=a(t,["data"]);n!=null&&l(e,["data"],n);const o=a(t,["mimeType"]);return o!=null&&l(e,["mimeType"],o),e}function B1(t){const e={},n=a(t,["fileUri"]);n!=null&&l(e,["fileUri"],n);const o=a(t,["mimeType"]);return o!=null&&l(e,["mimeType"],o),e}function V1(t){const e={},n=a(t,["videoMetadata"]);n!=null&&l(e,["videoMetadata"],z1(n));const o=a(t,["thought"]);o!=null&&l(e,["thought"],o);const i=a(t,["inlineData"]);i!=null&&l(e,["inlineData"],O1(i));const c=a(t,["fileData"]);c!=null&&l(e,["fileData"],B1(c));const f=a(t,["thoughtSignature"]);f!=null&&l(e,["thoughtSignature"],f);const m=a(t,["codeExecutionResult"]);m!=null&&l(e,["codeExecutionResult"],m);const h=a(t,["executableCode"]);h!=null&&l(e,["executableCode"],h);const p=a(t,["functionCall"]);p!=null&&l(e,["functionCall"],p);const v=a(t,["functionResponse"]);v!=null&&l(e,["functionResponse"],v);const x=a(t,["text"]);return x!=null&&l(e,["text"],x),e}function G1(t){const e={},n=a(t,["parts"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(c=>V1(c))),l(e,["parts"],i)}const o=a(t,["role"]);return o!=null&&l(e,["role"],o),e}function $1(t){const e={},n=a(t,["citationSources"]);return n!=null&&l(e,["citations"],n),e}function H1(t){const e={},n=a(t,["retrievedUrl"]);n!=null&&l(e,["retrievedUrl"],n);const o=a(t,["urlRetrievalStatus"]);return o!=null&&l(e,["urlRetrievalStatus"],o),e}function W1(t){const e={},n=a(t,["urlMetadata"]);if(n!=null){let o=n;Array.isArray(o)&&(o=o.map(i=>H1(i))),l(e,["urlMetadata"],o)}return e}function J1(t){const e={},n=a(t,["content"]);n!=null&&l(e,["content"],G1(n));const o=a(t,["citationMetadata"]);o!=null&&l(e,["citationMetadata"],$1(o));const i=a(t,["tokenCount"]);i!=null&&l(e,["tokenCount"],i);const c=a(t,["finishReason"]);c!=null&&l(e,["finishReason"],c);const f=a(t,["urlContextMetadata"]);f!=null&&l(e,["urlContextMetadata"],W1(f));const m=a(t,["avgLogprobs"]);m!=null&&l(e,["avgLogprobs"],m);const h=a(t,["groundingMetadata"]);h!=null&&l(e,["groundingMetadata"],h);const p=a(t,["index"]);p!=null&&l(e,["index"],p);const v=a(t,["logprobsResult"]);v!=null&&l(e,["logprobsResult"],v);const x=a(t,["safetyRatings"]);return x!=null&&l(e,["safetyRatings"],x),e}function xp(t){const e={},n=a(t,["sdkHttpResponse"]);n!=null&&l(e,["sdkHttpResponse"],n);const o=a(t,["candidates"]);if(o!=null){let h=o;Array.isArray(h)&&(h=h.map(p=>J1(p))),l(e,["candidates"],h)}const i=a(t,["modelVersion"]);i!=null&&l(e,["modelVersion"],i);const c=a(t,["promptFeedback"]);c!=null&&l(e,["promptFeedback"],c);const f=a(t,["responseId"]);f!=null&&l(e,["responseId"],f);const m=a(t,["usageMetadata"]);return m!=null&&l(e,["usageMetadata"],m),e}function Y1(t){const e={},n=a(t,["values"]);return n!=null&&l(e,["values"],n),e}function Q1(){return{}}function K1(t){const e={},n=a(t,["sdkHttpResponse"]);n!=null&&l(e,["sdkHttpResponse"],n);const o=a(t,["embeddings"]);if(o!=null){let c=o;Array.isArray(c)&&(c=c.map(f=>Y1(f))),l(e,["embeddings"],c)}return a(t,["metadata"])!=null&&l(e,["metadata"],Q1()),e}function Z1(t){const e={},n=a(t,["bytesBase64Encoded"]);n!=null&&l(e,["imageBytes"],$o(n));const o=a(t,["mimeType"]);return o!=null&&l(e,["mimeType"],o),e}function yh(t){const e={},n=a(t,["safetyAttributes","categories"]);n!=null&&l(e,["categories"],n);const o=a(t,["safetyAttributes","scores"]);o!=null&&l(e,["scores"],o);const i=a(t,["contentType"]);return i!=null&&l(e,["contentType"],i),e}function X1(t){const e={},n=a(t,["_self"]);n!=null&&l(e,["image"],Z1(n));const o=a(t,["raiFilteredReason"]);o!=null&&l(e,["raiFilteredReason"],o);const i=a(t,["_self"]);return i!=null&&l(e,["safetyAttributes"],yh(i)),e}function ek(t){const e={},n=a(t,["sdkHttpResponse"]);n!=null&&l(e,["sdkHttpResponse"],n);const o=a(t,["predictions"]);if(o!=null){let c=o;Array.isArray(c)&&(c=c.map(f=>X1(f))),l(e,["generatedImages"],c)}const i=a(t,["positivePromptSafetyAttributes"]);return i!=null&&l(e,["positivePromptSafetyAttributes"],yh(i)),e}function tk(t){const e={},n=a(t,["baseModel"]);n!=null&&l(e,["baseModel"],n);const o=a(t,["createTime"]);o!=null&&l(e,["createTime"],o);const i=a(t,["updateTime"]);return i!=null&&l(e,["updateTime"],i),e}function gc(t){const e={},n=a(t,["name"]);n!=null&&l(e,["name"],n);const o=a(t,["displayName"]);o!=null&&l(e,["displayName"],o);const i=a(t,["description"]);i!=null&&l(e,["description"],i);const c=a(t,["version"]);c!=null&&l(e,["version"],c);const f=a(t,["_self"]);f!=null&&l(e,["tunedModelInfo"],tk(f));const m=a(t,["inputTokenLimit"]);m!=null&&l(e,["inputTokenLimit"],m);const h=a(t,["outputTokenLimit"]);h!=null&&l(e,["outputTokenLimit"],h);const p=a(t,["supportedGenerationMethods"]);return p!=null&&l(e,["supportedActions"],p),e}function nk(t){const e={},n=a(t,["sdkHttpResponse"]);n!=null&&l(e,["sdkHttpResponse"],n);const o=a(t,["nextPageToken"]);o!=null&&l(e,["nextPageToken"],o);const i=a(t,["_self"]);if(i!=null){let c=nh(i);Array.isArray(c)&&(c=c.map(f=>gc(f))),l(e,["models"],c)}return e}function rk(){return{}}function ok(t){const e={},n=a(t,["sdkHttpResponse"]);n!=null&&l(e,["sdkHttpResponse"],n);const o=a(t,["totalTokens"]);o!=null&&l(e,["totalTokens"],o);const i=a(t,["cachedContentTokenCount"]);return i!=null&&l(e,["cachedContentTokenCount"],i),e}function sk(t){const e={},n=a(t,["video","uri"]);n!=null&&l(e,["uri"],n);const o=a(t,["video","encodedVideo"]);o!=null&&l(e,["videoBytes"],$o(o));const i=a(t,["encoding"]);return i!=null&&l(e,["mimeType"],i),e}function ik(t){const e={},n=a(t,["_self"]);return n!=null&&l(e,["video"],sk(n)),e}function ak(t){const e={},n=a(t,["generatedSamples"]);if(n!=null){let c=n;Array.isArray(c)&&(c=c.map(f=>ik(f))),l(e,["generatedVideos"],c)}const o=a(t,["raiMediaFilteredCount"]);o!=null&&l(e,["raiMediaFilteredCount"],o);const i=a(t,["raiMediaFilteredReasons"]);return i!=null&&l(e,["raiMediaFilteredReasons"],i),e}function lk(t){const e={},n=a(t,["name"]);n!=null&&l(e,["name"],n);const o=a(t,["metadata"]);o!=null&&l(e,["metadata"],o);const i=a(t,["done"]);i!=null&&l(e,["done"],i);const c=a(t,["error"]);c!=null&&l(e,["error"],c);const f=a(t,["response","generateVideoResponse"]);return f!=null&&l(e,["response"],ak(f)),e}function uk(t){const e={},n=a(t,["fps"]);n!=null&&l(e,["fps"],n);const o=a(t,["endOffset"]);o!=null&&l(e,["endOffset"],o);const i=a(t,["startOffset"]);return i!=null&&l(e,["startOffset"],i),e}function ck(t){const e={},n=a(t,["displayName"]);n!=null&&l(e,["displayName"],n);const o=a(t,["data"]);o!=null&&l(e,["data"],o);const i=a(t,["mimeType"]);return i!=null&&l(e,["mimeType"],i),e}function dk(t){const e={},n=a(t,["displayName"]);n!=null&&l(e,["displayName"],n);const o=a(t,["fileUri"]);o!=null&&l(e,["fileUri"],o);const i=a(t,["mimeType"]);return i!=null&&l(e,["mimeType"],i),e}function fk(t){const e={},n=a(t,["videoMetadata"]);n!=null&&l(e,["videoMetadata"],uk(n));const o=a(t,["thought"]);o!=null&&l(e,["thought"],o);const i=a(t,["inlineData"]);i!=null&&l(e,["inlineData"],ck(i));const c=a(t,["fileData"]);c!=null&&l(e,["fileData"],dk(c));const f=a(t,["thoughtSignature"]);f!=null&&l(e,["thoughtSignature"],f);const m=a(t,["codeExecutionResult"]);m!=null&&l(e,["codeExecutionResult"],m);const h=a(t,["executableCode"]);h!=null&&l(e,["executableCode"],h);const p=a(t,["functionCall"]);p!=null&&l(e,["functionCall"],p);const v=a(t,["functionResponse"]);v!=null&&l(e,["functionResponse"],v);const x=a(t,["text"]);return x!=null&&l(e,["text"],x),e}function mk(t){const e={},n=a(t,["parts"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(c=>fk(c))),l(e,["parts"],i)}const o=a(t,["role"]);return o!=null&&l(e,["role"],o),e}function pk(t){const e={},n=a(t,["citations"]);return n!=null&&l(e,["citations"],n),e}function hk(t){const e={},n=a(t,["retrievedUrl"]);n!=null&&l(e,["retrievedUrl"],n);const o=a(t,["urlRetrievalStatus"]);return o!=null&&l(e,["urlRetrievalStatus"],o),e}function gk(t){const e={},n=a(t,["urlMetadata"]);if(n!=null){let o=n;Array.isArray(o)&&(o=o.map(i=>hk(i))),l(e,["urlMetadata"],o)}return e}function yk(t){const e={},n=a(t,["content"]);n!=null&&l(e,["content"],mk(n));const o=a(t,["citationMetadata"]);o!=null&&l(e,["citationMetadata"],pk(o));const i=a(t,["finishMessage"]);i!=null&&l(e,["finishMessage"],i);const c=a(t,["finishReason"]);c!=null&&l(e,["finishReason"],c);const f=a(t,["urlContextMetadata"]);f!=null&&l(e,["urlContextMetadata"],gk(f));const m=a(t,["avgLogprobs"]);m!=null&&l(e,["avgLogprobs"],m);const h=a(t,["groundingMetadata"]);h!=null&&l(e,["groundingMetadata"],h);const p=a(t,["index"]);p!=null&&l(e,["index"],p);const v=a(t,["logprobsResult"]);v!=null&&l(e,["logprobsResult"],v);const x=a(t,["safetyRatings"]);return x!=null&&l(e,["safetyRatings"],x),e}function wp(t){const e={},n=a(t,["sdkHttpResponse"]);n!=null&&l(e,["sdkHttpResponse"],n);const o=a(t,["candidates"]);if(o!=null){let p=o;Array.isArray(p)&&(p=p.map(v=>yk(v))),l(e,["candidates"],p)}const i=a(t,["createTime"]);i!=null&&l(e,["createTime"],i);const c=a(t,["modelVersion"]);c!=null&&l(e,["modelVersion"],c);const f=a(t,["promptFeedback"]);f!=null&&l(e,["promptFeedback"],f);const m=a(t,["responseId"]);m!=null&&l(e,["responseId"],m);const h=a(t,["usageMetadata"]);return h!=null&&l(e,["usageMetadata"],h),e}function vk(t){const e={},n=a(t,["truncated"]);n!=null&&l(e,["truncated"],n);const o=a(t,["token_count"]);return o!=null&&l(e,["tokenCount"],o),e}function xk(t){const e={},n=a(t,["values"]);n!=null&&l(e,["values"],n);const o=a(t,["statistics"]);return o!=null&&l(e,["statistics"],vk(o)),e}function wk(t){const e={},n=a(t,["billableCharacterCount"]);return n!=null&&l(e,["billableCharacterCount"],n),e}function Ck(t){const e={},n=a(t,["sdkHttpResponse"]);n!=null&&l(e,["sdkHttpResponse"],n);const o=a(t,["predictions[]","embeddings"]);if(o!=null){let c=o;Array.isArray(c)&&(c=c.map(f=>xk(f))),l(e,["embeddings"],c)}const i=a(t,["metadata"]);return i!=null&&l(e,["metadata"],wk(i)),e}function vh(t){const e={},n=a(t,["gcsUri"]);n!=null&&l(e,["gcsUri"],n);const o=a(t,["bytesBase64Encoded"]);o!=null&&l(e,["imageBytes"],$o(o));const i=a(t,["mimeType"]);return i!=null&&l(e,["mimeType"],i),e}function xh(t){const e={},n=a(t,["safetyAttributes","categories"]);n!=null&&l(e,["categories"],n);const o=a(t,["safetyAttributes","scores"]);o!=null&&l(e,["scores"],o);const i=a(t,["contentType"]);return i!=null&&l(e,["contentType"],i),e}function Xa(t){const e={},n=a(t,["_self"]);n!=null&&l(e,["image"],vh(n));const o=a(t,["raiFilteredReason"]);o!=null&&l(e,["raiFilteredReason"],o);const i=a(t,["_self"]);i!=null&&l(e,["safetyAttributes"],xh(i));const c=a(t,["prompt"]);return c!=null&&l(e,["enhancedPrompt"],c),e}function Sk(t){const e={},n=a(t,["sdkHttpResponse"]);n!=null&&l(e,["sdkHttpResponse"],n);const o=a(t,["predictions"]);if(o!=null){let c=o;Array.isArray(c)&&(c=c.map(f=>Xa(f))),l(e,["generatedImages"],c)}const i=a(t,["positivePromptSafetyAttributes"]);return i!=null&&l(e,["positivePromptSafetyAttributes"],xh(i)),e}function kk(t){const e={},n=a(t,["sdkHttpResponse"]);n!=null&&l(e,["sdkHttpResponse"],n);const o=a(t,["predictions"]);if(o!=null){let i=o;Array.isArray(i)&&(i=i.map(c=>Xa(c))),l(e,["generatedImages"],i)}return e}function Tk(t){const e={},n=a(t,["sdkHttpResponse"]);n!=null&&l(e,["sdkHttpResponse"],n);const o=a(t,["predictions"]);if(o!=null){let i=o;Array.isArray(i)&&(i=i.map(c=>Xa(c))),l(e,["generatedImages"],i)}return e}function _k(t){const e={},n=a(t,["predictions"]);if(n!=null){let o=n;Array.isArray(o)&&(o=o.map(i=>Xa(i))),l(e,["generatedImages"],o)}return e}function Ek(t){const e={},n=a(t,["label"]);n!=null&&l(e,["label"],n);const o=a(t,["score"]);return o!=null&&l(e,["score"],o),e}function bk(t){const e={},n=a(t,["_self"]);n!=null&&l(e,["mask"],vh(n));const o=a(t,["labels"]);if(o!=null){let i=o;Array.isArray(i)&&(i=i.map(c=>Ek(c))),l(e,["labels"],i)}return e}function Nk(t){const e={},n=a(t,["predictions"]);if(n!=null){let o=n;Array.isArray(o)&&(o=o.map(i=>bk(i))),l(e,["generatedMasks"],o)}return e}function Ik(t){const e={},n=a(t,["endpoint"]);n!=null&&l(e,["name"],n);const o=a(t,["deployedModelId"]);return o!=null&&l(e,["deployedModelId"],o),e}function Ak(t){const e={},n=a(t,["labels","google-vertex-llm-tuning-base-model-id"]);n!=null&&l(e,["baseModel"],n);const o=a(t,["createTime"]);o!=null&&l(e,["createTime"],o);const i=a(t,["updateTime"]);return i!=null&&l(e,["updateTime"],i),e}function Dk(t){const e={},n=a(t,["checkpointId"]);n!=null&&l(e,["checkpointId"],n);const o=a(t,["epoch"]);o!=null&&l(e,["epoch"],o);const i=a(t,["step"]);return i!=null&&l(e,["step"],i),e}function yc(t){const e={},n=a(t,["name"]);n!=null&&l(e,["name"],n);const o=a(t,["displayName"]);o!=null&&l(e,["displayName"],o);const i=a(t,["description"]);i!=null&&l(e,["description"],i);const c=a(t,["versionId"]);c!=null&&l(e,["version"],c);const f=a(t,["deployedModels"]);if(f!=null){let x=f;Array.isArray(x)&&(x=x.map(C=>Ik(C))),l(e,["endpoints"],x)}const m=a(t,["labels"]);m!=null&&l(e,["labels"],m);const h=a(t,["_self"]);h!=null&&l(e,["tunedModelInfo"],Ak(h));const p=a(t,["defaultCheckpointId"]);p!=null&&l(e,["defaultCheckpointId"],p);const v=a(t,["checkpoints"]);if(v!=null){let x=v;Array.isArray(x)&&(x=x.map(C=>Dk(C))),l(e,["checkpoints"],x)}return e}function Mk(t){const e={},n=a(t,["sdkHttpResponse"]);n!=null&&l(e,["sdkHttpResponse"],n);const o=a(t,["nextPageToken"]);o!=null&&l(e,["nextPageToken"],o);const i=a(t,["_self"]);if(i!=null){let c=nh(i);Array.isArray(c)&&(c=c.map(f=>yc(f))),l(e,["models"],c)}return e}function Rk(){return{}}function Pk(t){const e={},n=a(t,["sdkHttpResponse"]);n!=null&&l(e,["sdkHttpResponse"],n);const o=a(t,["totalTokens"]);return o!=null&&l(e,["totalTokens"],o),e}function Fk(t){const e={},n=a(t,["sdkHttpResponse"]);n!=null&&l(e,["sdkHttpResponse"],n);const o=a(t,["tokensInfo"]);return o!=null&&l(e,["tokensInfo"],o),e}function Lk(t){const e={},n=a(t,["gcsUri"]);n!=null&&l(e,["uri"],n);const o=a(t,["bytesBase64Encoded"]);o!=null&&l(e,["videoBytes"],$o(o));const i=a(t,["mimeType"]);return i!=null&&l(e,["mimeType"],i),e}function Uk(t){const e={},n=a(t,["_self"]);return n!=null&&l(e,["video"],Lk(n)),e}function jk(t){const e={},n=a(t,["videos"]);if(n!=null){let c=n;Array.isArray(c)&&(c=c.map(f=>Uk(f))),l(e,["generatedVideos"],c)}const o=a(t,["raiMediaFilteredCount"]);o!=null&&l(e,["raiMediaFilteredCount"],o);const i=a(t,["raiMediaFilteredReasons"]);return i!=null&&l(e,["raiMediaFilteredReasons"],i),e}function qk(t){const e={},n=a(t,["name"]);n!=null&&l(e,["name"],n);const o=a(t,["metadata"]);o!=null&&l(e,["metadata"],o);const i=a(t,["done"]);i!=null&&l(e,["done"],i);const c=a(t,["error"]);c!=null&&l(e,["error"],c);const f=a(t,["response"]);return f!=null&&l(e,["response"],jk(f)),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const zk="Content-Type",Ok="X-Server-Timeout",Bk="User-Agent",vc="x-goog-api-client",Vk="1.15.0",Gk=`google-genai-sdk/${Vk}`,$k="v1beta1",Hk="v1beta",Cp=/^data: (.*)(?:\n\n|\r\r|\r\n\r\n)/;class Wk{constructor(e){var n,o;this.clientOptions=Object.assign(Object.assign({},e),{project:e.project,location:e.location,apiKey:e.apiKey,vertexai:e.vertexai});const i={};this.clientOptions.vertexai?(i.apiVersion=(n=this.clientOptions.apiVersion)!==null&&n!==void 0?n:$k,i.baseUrl=this.baseUrlFromProjectLocation(),this.normalizeAuthParameters()):(i.apiVersion=(o=this.clientOptions.apiVersion)!==null&&o!==void 0?o:Hk,i.baseUrl="https://generativelanguage.googleapis.com/"),i.headers=this.getDefaultHeaders(),this.clientOptions.httpOptions=i,e.httpOptions&&(this.clientOptions.httpOptions=this.patchHttpOptions(i,e.httpOptions))}baseUrlFromProjectLocation(){return this.clientOptions.project&&this.clientOptions.location&&this.clientOptions.location!=="global"?`https://${this.clientOptions.location}-aiplatform.googleapis.com/`:"https://aiplatform.googleapis.com/"}normalizeAuthParameters(){if(this.clientOptions.project&&this.clientOptions.location){this.clientOptions.apiKey=void 0;return}this.clientOptions.project=void 0,this.clientOptions.location=void 0}isVertexAI(){var e;return(e=this.clientOptions.vertexai)!==null&&e!==void 0?e:!1}getProject(){return this.clientOptions.project}getLocation(){return this.clientOptions.location}getApiVersion(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.apiVersion!==void 0)return this.clientOptions.httpOptions.apiVersion;throw new Error("API version is not set.")}getBaseUrl(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.baseUrl!==void 0)return this.clientOptions.httpOptions.baseUrl;throw new Error("Base URL is not set.")}getRequestUrl(){return this.getRequestUrlInternal(this.clientOptions.httpOptions)}getHeaders(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.headers!==void 0)return this.clientOptions.httpOptions.headers;throw new Error("Headers are not set.")}getRequestUrlInternal(e){if(!e||e.baseUrl===void 0||e.apiVersion===void 0)throw new Error("HTTP options are not correctly set.");const o=[e.baseUrl.endsWith("/")?e.baseUrl.slice(0,-1):e.baseUrl];return e.apiVersion&&e.apiVersion!==""&&o.push(e.apiVersion),o.join("/")}getBaseResourcePath(){return`projects/${this.clientOptions.project}/locations/${this.clientOptions.location}`}getApiKey(){return this.clientOptions.apiKey}getWebsocketBaseUrl(){const e=this.getBaseUrl(),n=new URL(e);return n.protocol=n.protocol=="http:"?"ws":"wss",n.toString()}setBaseUrl(e){if(this.clientOptions.httpOptions)this.clientOptions.httpOptions.baseUrl=e;else throw new Error("HTTP options are not correctly set.")}constructUrl(e,n,o){const i=[this.getRequestUrlInternal(n)];return o&&i.push(this.getBaseResourcePath()),e!==""&&i.push(e),new URL(`${i.join("/")}`)}shouldPrependVertexProjectPath(e){return!(this.clientOptions.apiKey||!this.clientOptions.vertexai||e.path.startsWith("projects/")||e.httpMethod==="GET"&&e.path.startsWith("publishers/google/models"))}async request(e){let n=this.clientOptions.httpOptions;e.httpOptions&&(n=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const o=this.shouldPrependVertexProjectPath(e),i=this.constructUrl(e.path,n,o);if(e.queryParams)for(const[f,m]of Object.entries(e.queryParams))i.searchParams.append(f,String(m));let c={};if(e.httpMethod==="GET"){if(e.body&&e.body!=="{}")throw new Error("Request body should be empty for GET request, but got non empty request body")}else c.body=e.body;return c=await this.includeExtraHttpOptionsToRequestInit(c,n,e.abortSignal),this.unaryApiCall(i,c,e.httpMethod)}patchHttpOptions(e,n){const o=JSON.parse(JSON.stringify(e));for(const[i,c]of Object.entries(n))typeof c=="object"?o[i]=Object.assign(Object.assign({},o[i]),c):c!==void 0&&(o[i]=c);return o}async requestStream(e){let n=this.clientOptions.httpOptions;e.httpOptions&&(n=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const o=this.shouldPrependVertexProjectPath(e),i=this.constructUrl(e.path,n,o);(!i.searchParams.has("alt")||i.searchParams.get("alt")!=="sse")&&i.searchParams.set("alt","sse");let c={};return c.body=e.body,c=await this.includeExtraHttpOptionsToRequestInit(c,n,e.abortSignal),this.streamApiCall(i,c,e.httpMethod)}async includeExtraHttpOptionsToRequestInit(e,n,o){if(n&&n.timeout||o){const i=new AbortController,c=i.signal;if(n.timeout&&(n==null?void 0:n.timeout)>0){const f=setTimeout(()=>i.abort(),n.timeout);f&&typeof f.unref=="function"&&f.unref()}o&&o.addEventListener("abort",()=>{i.abort()}),e.signal=c}return n&&n.extraBody!==null&&Jk(e,n.extraBody),e.headers=await this.getHeadersInternal(n),e}async unaryApiCall(e,n,o){return this.apiCall(e.toString(),Object.assign(Object.assign({},n),{method:o})).then(async i=>(await Sp(i),new dc(i))).catch(i=>{throw i instanceof Error?i:new Error(JSON.stringify(i))})}async streamApiCall(e,n,o){return this.apiCall(e.toString(),Object.assign(Object.assign({},n),{method:o})).then(async i=>(await Sp(i),this.processStreamResponse(i))).catch(i=>{throw i instanceof Error?i:new Error(JSON.stringify(i))})}processStreamResponse(e){var n;return bs(this,arguments,function*(){const i=(n=e==null?void 0:e.body)===null||n===void 0?void 0:n.getReader(),c=new TextDecoder("utf-8");if(!i)throw new Error("Response body is empty");try{let f="";for(;;){const{done:m,value:h}=yield Rt(i.read());if(m){if(f.trim().length>0)throw new Error("Incomplete JSON segment at the end");break}const p=c.decode(h,{stream:!0});try{const x=JSON.parse(p);if("error"in x){const C=JSON.parse(JSON.stringify(x.error)),S=C.status,b=C.code,T=`got status: ${S}. ${JSON.stringify(x)}`;if(b>=400&&b<600)throw new Ka({message:T,status:b})}}catch(x){if(x.name==="ApiError")throw x}f+=p;let v=f.match(Cp);for(;v;){const x=v[1];try{const C=new Response(x,{headers:e==null?void 0:e.headers,status:e==null?void 0:e.status,statusText:e==null?void 0:e.statusText});yield yield Rt(new dc(C)),f=f.slice(v[0].length),v=f.match(Cp)}catch(C){throw new Error(`exception parsing stream chunk ${x}. ${C}`)}}}}finally{i.releaseLock()}})}async apiCall(e,n){return fetch(e,n).catch(o=>{throw new Error(`exception ${o} sending request`)})}getDefaultHeaders(){const e={},n=Gk+" "+this.clientOptions.userAgentExtra;return e[Bk]=n,e[vc]=n,e[zk]="application/json",e}async getHeadersInternal(e){const n=new Headers;if(e&&e.headers){for(const[o,i]of Object.entries(e.headers))n.append(o,i);e.timeout&&e.timeout>0&&n.append(Ok,String(Math.ceil(e.timeout/1e3)))}return await this.clientOptions.auth.addAuthHeaders(n),n}async uploadFile(e,n){var o;const i={};n!=null&&(i.mimeType=n.mimeType,i.name=n.name,i.displayName=n.displayName),i.name&&!i.name.startsWith("files/")&&(i.name=`files/${i.name}`);const c=this.clientOptions.uploader,f=await c.stat(e);i.sizeBytes=String(f.size);const m=(o=n==null?void 0:n.mimeType)!==null&&o!==void 0?o:f.type;if(m===void 0||m==="")throw new Error("Can not determine mimeType. Please provide mimeType in the config.");i.mimeType=m;const h=await this.fetchUploadUrl(i,n);return c.upload(e,h,this)}async downloadFile(e){await this.clientOptions.downloader.download(e,this)}async fetchUploadUrl(e,n){var o;let i={};n!=null&&n.httpOptions?i=n.httpOptions:i={apiVersion:"",headers:{"Content-Type":"application/json","X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${e.sizeBytes}`,"X-Goog-Upload-Header-Content-Type":`${e.mimeType}`}};const c={file:e},f=await this.request({path:Qe("upload/v1beta/files",c._url),body:JSON.stringify(c),httpMethod:"POST",httpOptions:i});if(!f||!(f!=null&&f.headers))throw new Error("Server did not return an HttpResponse or the returned HttpResponse did not have headers.");const m=(o=f==null?void 0:f.headers)===null||o===void 0?void 0:o["x-goog-upload-url"];if(m===void 0)throw new Error("Failed to get upload url. Server did not return the x-google-upload-url in the headers");return m}}async function Sp(t){var e;if(t===void 0)throw new Error("response is undefined");if(!t.ok){const n=t.status;let o;!((e=t.headers.get("content-type"))===null||e===void 0)&&e.includes("application/json")?o=await t.json():o={error:{message:await t.text(),code:t.status,status:t.statusText}};const i=JSON.stringify(o);throw n>=400&&n<600?new Ka({message:i,status:n}):new Error(i)}}function Jk(t,e){if(!e||Object.keys(e).length===0)return;if(t.body instanceof Blob){console.warn("includeExtraBodyToRequestInit: extraBody provided but current request body is a Blob. extraBody will be ignored as merging is not supported for Blob bodies.");return}let n={};if(typeof t.body=="string"&&t.body.length>0)try{const c=JSON.parse(t.body);if(typeof c=="object"&&c!==null&&!Array.isArray(c))n=c;else{console.warn("includeExtraBodyToRequestInit: Original request body is valid JSON but not a non-array object. Skip applying extraBody to the request body.");return}}catch{console.warn("includeExtraBodyToRequestInit: Original request body is not valid JSON. Skip applying extraBody to the request body.");return}function o(c,f){const m=Object.assign({},c);for(const h in f)if(Object.prototype.hasOwnProperty.call(f,h)){const p=f[h],v=m[h];p&&typeof p=="object"&&!Array.isArray(p)&&v&&typeof v=="object"&&!Array.isArray(v)?m[h]=o(v,p):(v&&p&&typeof v!=typeof p&&console.warn(`includeExtraBodyToRequestInit:deepMerge: Type mismatch for key "${h}". Original type: ${typeof v}, New type: ${typeof p}. Overwriting.`),m[h]=p)}return m}const i=o(n,e);t.body=JSON.stringify(i)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Yk="mcp_used/unknown";let Qk=!1;function wh(t){for(const e of t)if(Kk(e)||typeof e=="object"&&"inputSchema"in e)return!0;return Qk}function Ch(t){var e;const n=(e=t[vc])!==null&&e!==void 0?e:"";t[vc]=(n+` ${Yk}`).trimStart()}function Kk(t){return t!==null&&typeof t=="object"&&t instanceof Ac}function Zk(t,e=100){return bs(this,arguments,function*(){let o,i=0;for(;i<e;){const c=yield Rt(t.listTools({cursor:o}));for(const f of c.tools)yield yield Rt(f),i++;if(!c.nextCursor)break;o=c.nextCursor}})}class Ac{constructor(e=[],n){this.mcpTools=[],this.functionNameToMcpClient={},this.mcpClients=e,this.config=n}static create(e,n){return new Ac(e,n)}async initialize(){var e,n,o,i;if(this.mcpTools.length>0)return;const c={},f=[];for(const v of this.mcpClients)try{for(var m=!0,h=(n=void 0,pi(Zk(v))),p;p=await h.next(),e=p.done,!e;m=!0){i=p.value,m=!1;const x=i;f.push(x);const C=x.name;if(c[C])throw new Error(`Duplicate function name ${C} found in MCP tools. Please ensure function names are unique.`);c[C]=v}}catch(x){n={error:x}}finally{try{!m&&!e&&(o=h.return)&&await o.call(h)}finally{if(n)throw n.error}}this.mcpTools=f,this.functionNameToMcpClient=c}async tool(){return await this.initialize(),Iv(this.mcpTools,this.config)}async callTool(e){await this.initialize();const n=[];for(const o of e)if(o.name in this.functionNameToMcpClient){const i=this.functionNameToMcpClient[o.name];let c;this.config.timeout&&(c={timeout:this.config.timeout});const f=await i.callTool({name:o.name,arguments:o.args},void 0,c);n.push({functionResponse:{name:o.name,response:f.isError?{error:f}:f}})}return n}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */async function Xk(t,e,n){const o=new Cv;let i;n.data instanceof Blob?i=JSON.parse(await n.data.text()):i=JSON.parse(n.data);const c=RC(i);Object.assign(o,c),e(o)}class eT{constructor(e,n,o){this.apiClient=e,this.auth=n,this.webSocketFactory=o}async connect(e){var n,o;if(this.apiClient.isVertexAI())throw new Error("Live music is not supported for Vertex AI.");console.warn("Live music generation is experimental and may change in future versions.");const i=this.apiClient.getWebsocketBaseUrl(),c=this.apiClient.getApiVersion(),f=rT(this.apiClient.getDefaultHeaders()),m=this.apiClient.getApiKey(),h=`${i}/ws/google.ai.generativelanguage.${c}.GenerativeService.BidiGenerateMusic?key=${m}`;let p=()=>{};const v=new Promise(L=>{p=L}),x=e.callbacks,C=function(){p({})},S=this.apiClient,b={onopen:C,onmessage:L=>{Xk(S,x.onmessage,L)},onerror:(n=x==null?void 0:x.onerror)!==null&&n!==void 0?n:function(L){},onclose:(o=x==null?void 0:x.onclose)!==null&&o!==void 0?o:function(L){}},T=this.webSocketFactory.create(h,nT(f),b);T.connect(),await v;const A=_t(this.apiClient,e.model),D=mh({model:A}),F=hc({setup:D});return T.send(JSON.stringify(F)),new tT(T,this.apiClient)}}class tT{constructor(e,n){this.conn=e,this.apiClient=n}async setWeightedPrompts(e){if(!e.weightedPrompts||Object.keys(e.weightedPrompts).length===0)throw new Error("Weighted prompts must be set and contain at least one entry.");const n=Aw(e),o=ph(n);this.conn.send(JSON.stringify({clientContent:o}))}async setMusicGenerationConfig(e){e.musicGenerationConfig||(e.musicGenerationConfig={});const n=Dw(e),o=hc(n);this.conn.send(JSON.stringify(o))}sendPlaybackControl(e){const n=hc({playbackControl:e});this.conn.send(JSON.stringify(n))}play(){this.sendPlaybackControl(_s.PLAY)}pause(){this.sendPlaybackControl(_s.PAUSE)}stop(){this.sendPlaybackControl(_s.STOP)}resetContext(){this.sendPlaybackControl(_s.RESET_CONTEXT)}close(){this.conn.close()}}function nT(t){const e={};return t.forEach((n,o)=>{e[o]=n}),e}function rT(t){const e=new Headers;for(const[n,o]of Object.entries(t))e.append(n,o);return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const oT="FunctionResponse request must have an `id` field from the response of a ToolCall.FunctionalCalls in Google AI.";async function sT(t,e,n){const o=new wv;let i;n.data instanceof Blob?i=await n.data.text():n.data instanceof ArrayBuffer?i=new TextDecoder().decode(n.data):i=n.data;const c=JSON.parse(i);if(t.isVertexAI()){const f=WC(c);Object.assign(o,f)}else{const f=TC(c);Object.assign(o,f)}e(o)}class iT{constructor(e,n,o){this.apiClient=e,this.auth=n,this.webSocketFactory=o,this.music=new eT(this.apiClient,this.auth,this.webSocketFactory)}async connect(e){var n,o,i,c,f,m;if(e.config&&e.config.httpOptions)throw new Error("The Live module does not support httpOptions at request-level in LiveConnectConfig yet. Please use the client-level httpOptions configuration instead.");const h=this.apiClient.getWebsocketBaseUrl(),p=this.apiClient.getApiVersion();let v;const x=this.apiClient.getHeaders();e.config&&e.config.tools&&wh(e.config.tools)&&Ch(x);const C=cT(x);if(this.apiClient.isVertexAI())v=`${h}/ws/google.cloud.aiplatform.${p}.LlmBidiService/BidiGenerateContent`,await this.auth.addAuthHeaders(C);else{const J=this.apiClient.getApiKey();let Z="BidiGenerateContent",le="key";J!=null&&J.startsWith("auth_tokens/")&&(console.warn("Warning: Ephemeral token support is experimental and may change in future versions."),p!=="v1alpha"&&console.warn("Warning: The SDK's ephemeral token support is in v1alpha only. Please use const ai = new GoogleGenAI({apiKey: token.name, httpOptions: { apiVersion: 'v1alpha' }}); before session connection."),Z="BidiGenerateContentConstrained",le="access_token"),v=`${h}/ws/google.ai.generativelanguage.${p}.GenerativeService.${Z}?${le}=${J}`}let S=()=>{};const b=new Promise(J=>{S=J}),T=e.callbacks,A=function(){var J;(J=T==null?void 0:T.onopen)===null||J===void 0||J.call(T),S({})},D=this.apiClient,F={onopen:A,onmessage:J=>{sT(D,T.onmessage,J)},onerror:(n=T==null?void 0:T.onerror)!==null&&n!==void 0?n:function(J){},onclose:(o=T==null?void 0:T.onclose)!==null&&o!==void 0?o:function(J){}},L=this.webSocketFactory.create(v,uT(C),F);L.connect(),await b;let R=_t(this.apiClient,e.model);if(this.apiClient.isVertexAI()&&R.startsWith("publishers/")){const J=this.apiClient.getProject(),Z=this.apiClient.getLocation();R=`projects/${J}/locations/${Z}/`+R}let P={};this.apiClient.isVertexAI()&&((i=e.config)===null||i===void 0?void 0:i.responseModalities)===void 0&&(e.config===void 0?e.config={responseModalities:[$a.AUDIO]}:e.config.responseModalities=[$a.AUDIO]),!((c=e.config)===null||c===void 0)&&c.generationConfig&&console.warn("Setting `LiveConnectConfig.generation_config` is deprecated, please set the fields on `LiveConnectConfig` directly. This will become an error in a future version (not before Q3 2025).");const G=(m=(f=e.config)===null||f===void 0?void 0:f.tools)!==null&&m!==void 0?m:[],$=[];for(const J of G)if(this.isCallableTool(J)){const Z=J;$.push(await Z.tool())}else $.push(J);$.length>0&&(e.config.tools=$);const oe={model:R,config:e.config,callbacks:e.callbacks};return this.apiClient.isVertexAI()?P=sC(this.apiClient,oe):P=Ew(this.apiClient,oe),delete P.config,L.send(JSON.stringify(P)),new lT(L,this.apiClient)}isCallableTool(e){return"callTool"in e&&typeof e.callTool=="function"}}const aT={turnComplete:!0};class lT{constructor(e,n){this.conn=e,this.apiClient=n}tLiveClientContent(e,n){if(n.turns!==null&&n.turns!==void 0){let o=[];try{o=Wn(n.turns),e.isVertexAI()?o=o.map(i=>Ms(i)):o=o.map(i=>Za(i))}catch{throw new Error(`Failed to parse client content "turns", type: '${typeof n.turns}'`)}return{clientContent:{turns:o,turnComplete:n.turnComplete}}}return{clientContent:{turnComplete:n.turnComplete}}}tLiveClienttToolResponse(e,n){let o=[];if(n.functionResponses==null)throw new Error("functionResponses is required.");if(Array.isArray(n.functionResponses)?o=n.functionResponses:o=[n.functionResponses],o.length===0)throw new Error("functionResponses is required.");for(const c of o){if(typeof c!="object"||c===null||!("name"in c)||!("response"in c))throw new Error(`Could not parse function response, type '${typeof c}'.`);if(!e.isVertexAI()&&!("id"in c))throw new Error(oT)}return{toolResponse:{functionResponses:o}}}sendClientContent(e){e=Object.assign(Object.assign({},aT),e);const n=this.tLiveClientContent(this.apiClient,e);this.conn.send(JSON.stringify(n))}sendRealtimeInput(e){let n={};this.apiClient.isVertexAI()?n={realtimeInput:lC(e)}:n={realtimeInput:Iw(e)},this.conn.send(JSON.stringify(n))}sendToolResponse(e){if(e.functionResponses==null)throw new Error("Tool response parameters are required.");const n=this.tLiveClienttToolResponse(this.apiClient,e);this.conn.send(JSON.stringify(n))}close(){this.conn.close()}}function uT(t){const e={};return t.forEach((n,o)=>{e[o]=n}),e}function cT(t){const e=new Headers;for(const[n,o]of Object.entries(t))e.append(n,o);return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const kp=10;function Tp(t){var e,n,o;if(!((e=t==null?void 0:t.automaticFunctionCalling)===null||e===void 0)&&e.disable)return!0;let i=!1;for(const f of(n=t==null?void 0:t.tools)!==null&&n!==void 0?n:[])if(Ns(f)){i=!0;break}if(!i)return!0;const c=(o=t==null?void 0:t.automaticFunctionCalling)===null||o===void 0?void 0:o.maximumRemoteCalls;return c&&(c<0||!Number.isInteger(c))||c==0?(console.warn("Invalid maximumRemoteCalls value provided for automatic function calling. Disabled automatic function calling. Please provide a valid integer value greater than 0. maximumRemoteCalls provided:",c),!0):!1}function Ns(t){return"callTool"in t&&typeof t.callTool=="function"}function dT(t){var e,n,o;return(o=(n=(e=t.config)===null||e===void 0?void 0:e.tools)===null||n===void 0?void 0:n.some(i=>Ns(i)))!==null&&o!==void 0?o:!1}function fT(t){var e,n,o;return(o=(n=(e=t.config)===null||e===void 0?void 0:e.tools)===null||n===void 0?void 0:n.some(i=>!Ns(i)))!==null&&o!==void 0?o:!1}function _p(t){var e;return!(!((e=t==null?void 0:t.automaticFunctionCalling)===null||e===void 0)&&e.ignoreCallHistory)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class mT extends Go{constructor(e){super(),this.apiClient=e,this.generateContent=async n=>{var o,i,c,f,m;const h=await this.processParamsMaybeAddMcpUsage(n);if(this.maybeMoveToResponseJsonSchem(n),!dT(n)||Tp(n.config))return await this.generateContentInternal(h);if(fT(n))throw new Error("Automatic function calling with CallableTools and Tools is not yet supported.");let p,v;const x=Wn(h.contents),C=(c=(i=(o=h.config)===null||o===void 0?void 0:o.automaticFunctionCalling)===null||i===void 0?void 0:i.maximumRemoteCalls)!==null&&c!==void 0?c:kp;let S=0;for(;S<C&&(p=await this.generateContentInternal(h),!(!p.functionCalls||p.functionCalls.length===0));){const b=p.candidates[0].content,T=[];for(const A of(m=(f=n.config)===null||f===void 0?void 0:f.tools)!==null&&m!==void 0?m:[])if(Ns(A)){const F=await A.callTool(p.functionCalls);T.push(...F)}S++,v={role:"user",parts:T},h.contents=Wn(h.contents),h.contents.push(b),h.contents.push(v),_p(h.config)&&(x.push(b),x.push(v))}return _p(h.config)&&(p.automaticFunctionCallingHistory=x),p},this.generateContentStream=async n=>{if(this.maybeMoveToResponseJsonSchem(n),Tp(n.config)){const o=await this.processParamsMaybeAddMcpUsage(n);return await this.generateContentStreamInternal(o)}else return await this.processAfcStream(n)},this.generateImages=async n=>await this.generateImagesInternal(n).then(o=>{var i;let c;const f=[];if(o!=null&&o.generatedImages)for(const h of o.generatedImages)h&&(h!=null&&h.safetyAttributes)&&((i=h==null?void 0:h.safetyAttributes)===null||i===void 0?void 0:i.contentType)==="Positive Prompt"?c=h==null?void 0:h.safetyAttributes:f.push(h);let m;return c?m={generatedImages:f,positivePromptSafetyAttributes:c,sdkHttpResponse:o.sdkHttpResponse}:m={generatedImages:f,sdkHttpResponse:o.sdkHttpResponse},m}),this.list=async n=>{var o;const f={config:Object.assign(Object.assign({},{queryBase:!0}),n==null?void 0:n.config)};if(this.apiClient.isVertexAI()&&!f.config.queryBase){if(!((o=f.config)===null||o===void 0)&&o.filter)throw new Error("Filtering tuned models list for Vertex AI is not currently supported");f.config.filter="labels.tune-type:*"}return new xi(Bo.PAGED_ITEM_MODELS,m=>this.listInternal(m),await this.listInternal(f),f)},this.editImage=async n=>{const o={model:n.model,prompt:n.prompt,referenceImages:[],config:n.config};return n.referenceImages&&n.referenceImages&&(o.referenceImages=n.referenceImages.map(i=>i.toReferenceImageAPI())),await this.editImageInternal(o)},this.upscaleImage=async n=>{let o={numberOfImages:1,mode:"upscale"};n.config&&(o=Object.assign(Object.assign({},o),n.config));const i={model:n.model,image:n.image,upscaleFactor:n.upscaleFactor,config:o};return await this.upscaleImageInternal(i)},this.generateVideos=async n=>await this.generateVideosInternal(n)}maybeMoveToResponseJsonSchem(e){e.config&&e.config.responseSchema&&(e.config.responseJsonSchema||Object.keys(e.config.responseSchema).includes("$schema")&&(e.config.responseJsonSchema=e.config.responseSchema,delete e.config.responseSchema))}async processParamsMaybeAddMcpUsage(e){var n,o,i;const c=(n=e.config)===null||n===void 0?void 0:n.tools;if(!c)return e;const f=await Promise.all(c.map(async h=>Ns(h)?await h.tool():h)),m={model:e.model,contents:e.contents,config:Object.assign(Object.assign({},e.config),{tools:f})};if(m.config.tools=f,e.config&&e.config.tools&&wh(e.config.tools)){const h=(i=(o=e.config.httpOptions)===null||o===void 0?void 0:o.headers)!==null&&i!==void 0?i:{};let p=Object.assign({},h);Object.keys(p).length===0&&(p=this.apiClient.getDefaultHeaders()),Ch(p),m.config.httpOptions=Object.assign(Object.assign({},e.config.httpOptions),{headers:p})}return m}async initAfcToolsMap(e){var n,o,i;const c=new Map;for(const f of(o=(n=e.config)===null||n===void 0?void 0:n.tools)!==null&&o!==void 0?o:[])if(Ns(f)){const m=f,h=await m.tool();for(const p of(i=h.functionDeclarations)!==null&&i!==void 0?i:[]){if(!p.name)throw new Error("Function declaration name is required.");if(c.has(p.name))throw new Error(`Duplicate tool declaration name: ${p.name}`);c.set(p.name,m)}}return c}async processAfcStream(e){var n,o,i;const c=(i=(o=(n=e.config)===null||n===void 0?void 0:n.automaticFunctionCalling)===null||o===void 0?void 0:o.maximumRemoteCalls)!==null&&i!==void 0?i:kp;let f=!1,m=0;const h=await this.initAfcToolsMap(e);return function(p,v,x){var C,S;return bs(this,arguments,function*(){for(var b,T,A,D;m<c;){f&&(m++,f=!1);const P=yield Rt(p.processParamsMaybeAddMcpUsage(x)),G=yield Rt(p.generateContentStreamInternal(P)),$=[],oe=[];try{for(var F=!0,L=(T=void 0,pi(G)),R;R=yield Rt(L.next()),b=R.done,!b;F=!0){D=R.value,F=!1;const J=D;if(yield yield Rt(J),J.candidates&&(!((C=J.candidates[0])===null||C===void 0)&&C.content)){oe.push(J.candidates[0].content);for(const Z of(S=J.candidates[0].content.parts)!==null&&S!==void 0?S:[])if(m<c&&Z.functionCall){if(!Z.functionCall.name)throw new Error("Function call name was not returned by the model.");if(v.has(Z.functionCall.name)){const le=yield Rt(v.get(Z.functionCall.name).callTool([Z.functionCall]));$.push(...le)}else throw new Error(`Automatic function calling was requested, but not all the tools the model used implement the CallableTool interface. Available tools: ${v.keys()}, mising tool: ${Z.functionCall.name}`)}}}}catch(J){T={error:J}}finally{try{!F&&!b&&(A=L.return)&&(yield Rt(A.call(L)))}finally{if(T)throw T.error}}if($.length>0){f=!0;const J=new ci;J.candidates=[{content:{role:"user",parts:$}}],yield yield Rt(J);const Z=[];Z.push(...oe),Z.push({role:"user",parts:$});const le=Wn(x.contents).concat(Z);x.contents=le}else break}})}(this,h,e)}async generateContentInternal(e){var n,o,i,c;let f,m="",h={};if(this.apiClient.isVertexAI()){const p=vp(this.apiClient,e);return m=Qe("{model}:generateContent",p._url),h=p._query,delete p.config,delete p._url,delete p._query,f=this.apiClient.request({path:m,queryParams:h,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(v=>v.json().then(x=>{const C=x;return C.sdkHttpResponse={headers:v.headers},C})),f.then(v=>{const x=wp(v),C=new ci;return Object.assign(C,x),C})}else{const p=yp(this.apiClient,e);return m=Qe("{model}:generateContent",p._url),h=p._query,delete p.config,delete p._url,delete p._query,f=this.apiClient.request({path:m,queryParams:h,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(c=e.config)===null||c===void 0?void 0:c.abortSignal}).then(v=>v.json().then(x=>{const C=x;return C.sdkHttpResponse={headers:v.headers},C})),f.then(v=>{const x=xp(v),C=new ci;return Object.assign(C,x),C})}}async generateContentStreamInternal(e){var n,o,i,c;let f,m="",h={};if(this.apiClient.isVertexAI()){const p=vp(this.apiClient,e);return m=Qe("{model}:streamGenerateContent?alt=sse",p._url),h=p._query,delete p.config,delete p._url,delete p._query,f=this.apiClient.requestStream({path:m,queryParams:h,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}),f.then(function(x){return bs(this,arguments,function*(){var C,S,b,T;try{for(var A=!0,D=pi(x),F;F=yield Rt(D.next()),C=F.done,!C;A=!0){T=F.value,A=!1;const L=T,R=wp(yield Rt(L.json()));R.sdkHttpResponse={headers:L.headers};const P=new ci;Object.assign(P,R),yield yield Rt(P)}}catch(L){S={error:L}}finally{try{!A&&!C&&(b=D.return)&&(yield Rt(b.call(D)))}finally{if(S)throw S.error}}})})}else{const p=yp(this.apiClient,e);return m=Qe("{model}:streamGenerateContent?alt=sse",p._url),h=p._query,delete p.config,delete p._url,delete p._query,f=this.apiClient.requestStream({path:m,queryParams:h,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(c=e.config)===null||c===void 0?void 0:c.abortSignal}),f.then(function(x){return bs(this,arguments,function*(){var C,S,b,T;try{for(var A=!0,D=pi(x),F;F=yield Rt(D.next()),C=F.done,!C;A=!0){T=F.value,A=!1;const L=T,R=xp(yield Rt(L.json()));R.sdkHttpResponse={headers:L.headers};const P=new ci;Object.assign(P,R),yield yield Rt(P)}}catch(L){S={error:L}}finally{try{!A&&!C&&(b=D.return)&&(yield Rt(b.call(D)))}finally{if(S)throw S.error}}})})}}async embedContent(e){var n,o,i,c;let f,m="",h={};if(this.apiClient.isVertexAI()){const p=a1(this.apiClient,e);return m=Qe("{model}:predict",p._url),h=p._query,delete p.config,delete p._url,delete p._query,f=this.apiClient.request({path:m,queryParams:h,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(v=>v.json().then(x=>{const C=x;return C.sdkHttpResponse={headers:v.headers},C})),f.then(v=>{const x=Ck(v),C=new Ym;return Object.assign(C,x),C})}else{const p=xS(this.apiClient,e);return m=Qe("{model}:batchEmbedContents",p._url),h=p._query,delete p.config,delete p._url,delete p._query,f=this.apiClient.request({path:m,queryParams:h,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(c=e.config)===null||c===void 0?void 0:c.abortSignal}).then(v=>v.json().then(x=>{const C=x;return C.sdkHttpResponse={headers:v.headers},C})),f.then(v=>{const x=K1(v),C=new Ym;return Object.assign(C,x),C})}}async generateImagesInternal(e){var n,o,i,c;let f,m="",h={};if(this.apiClient.isVertexAI()){const p=u1(this.apiClient,e);return m=Qe("{model}:predict",p._url),h=p._query,delete p.config,delete p._url,delete p._query,f=this.apiClient.request({path:m,queryParams:h,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(v=>v.json().then(x=>{const C=x;return C.sdkHttpResponse={headers:v.headers},C})),f.then(v=>{const x=Sk(v),C=new Qm;return Object.assign(C,x),C})}else{const p=CS(this.apiClient,e);return m=Qe("{model}:predict",p._url),h=p._query,delete p.config,delete p._url,delete p._query,f=this.apiClient.request({path:m,queryParams:h,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(c=e.config)===null||c===void 0?void 0:c.abortSignal}).then(v=>v.json().then(x=>{const C=x;return C.sdkHttpResponse={headers:v.headers},C})),f.then(v=>{const x=ek(v),C=new Qm;return Object.assign(C,x),C})}}async editImageInternal(e){var n,o;let i,c="",f={};if(this.apiClient.isVertexAI()){const m=g1(this.apiClient,e);return c=Qe("{model}:predict",m._url),f=m._query,delete m.config,delete m._url,delete m._query,i=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json().then(p=>{const v=p;return v.sdkHttpResponse={headers:h.headers},v})),i.then(h=>{const p=kk(h),v=new fv;return Object.assign(v,p),v})}else throw new Error("This method is only supported by the Vertex AI.")}async upscaleImageInternal(e){var n,o;let i,c="",f={};if(this.apiClient.isVertexAI()){const m=v1(this.apiClient,e);return c=Qe("{model}:predict",m._url),f=m._query,delete m.config,delete m._url,delete m._query,i=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json().then(p=>{const v=p;return v.sdkHttpResponse={headers:h.headers},v})),i.then(h=>{const p=Tk(h),v=new mv;return Object.assign(v,p),v})}else throw new Error("This method is only supported by the Vertex AI.")}async recontextImage(e){var n,o;let i,c="",f={};if(this.apiClient.isVertexAI()){const m=S1(this.apiClient,e);return c=Qe("{model}:predict",m._url),f=m._query,delete m.config,delete m._url,delete m._query,i=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json()),i.then(h=>{const p=_k(h),v=new pv;return Object.assign(v,p),v})}else throw new Error("This method is only supported by the Vertex AI.")}async segmentImage(e){var n,o;let i,c="",f={};if(this.apiClient.isVertexAI()){const m=E1(this.apiClient,e);return c=Qe("{model}:predict",m._url),f=m._query,delete m.config,delete m._url,delete m._query,i=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json()),i.then(h=>{const p=Nk(h),v=new hv;return Object.assign(v,p),v})}else throw new Error("This method is only supported by the Vertex AI.")}async get(e){var n,o,i,c;let f,m="",h={};if(this.apiClient.isVertexAI()){const p=b1(this.apiClient,e);return m=Qe("{name}",p._url),h=p._query,delete p.config,delete p._url,delete p._query,f=this.apiClient.request({path:m,queryParams:h,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(v=>v.json()),f.then(v=>yc(v))}else{const p=SS(this.apiClient,e);return m=Qe("{name}",p._url),h=p._query,delete p.config,delete p._url,delete p._query,f=this.apiClient.request({path:m,queryParams:h,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(c=e.config)===null||c===void 0?void 0:c.abortSignal}).then(v=>v.json()),f.then(v=>gc(v))}}async listInternal(e){var n,o,i,c;let f,m="",h={};if(this.apiClient.isVertexAI()){const p=I1(this.apiClient,e);return m=Qe("{models_url}",p._url),h=p._query,delete p.config,delete p._url,delete p._query,f=this.apiClient.request({path:m,queryParams:h,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(v=>v.json().then(x=>{const C=x;return C.sdkHttpResponse={headers:v.headers},C})),f.then(v=>{const x=Mk(v),C=new Km;return Object.assign(C,x),C})}else{const p=TS(this.apiClient,e);return m=Qe("{models_url}",p._url),h=p._query,delete p.config,delete p._url,delete p._query,f=this.apiClient.request({path:m,queryParams:h,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(c=e.config)===null||c===void 0?void 0:c.abortSignal}).then(v=>v.json().then(x=>{const C=x;return C.sdkHttpResponse={headers:v.headers},C})),f.then(v=>{const x=nk(v),C=new Km;return Object.assign(C,x),C})}}async update(e){var n,o,i,c;let f,m="",h={};if(this.apiClient.isVertexAI()){const p=D1(this.apiClient,e);return m=Qe("{model}",p._url),h=p._query,delete p.config,delete p._url,delete p._query,f=this.apiClient.request({path:m,queryParams:h,body:JSON.stringify(p),httpMethod:"PATCH",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(v=>v.json()),f.then(v=>yc(v))}else{const p=ES(this.apiClient,e);return m=Qe("{name}",p._url),h=p._query,delete p.config,delete p._url,delete p._query,f=this.apiClient.request({path:m,queryParams:h,body:JSON.stringify(p),httpMethod:"PATCH",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(c=e.config)===null||c===void 0?void 0:c.abortSignal}).then(v=>v.json()),f.then(v=>gc(v))}}async delete(e){var n,o,i,c;let f,m="",h={};if(this.apiClient.isVertexAI()){const p=M1(this.apiClient,e);return m=Qe("{name}",p._url),h=p._query,delete p.config,delete p._url,delete p._query,f=this.apiClient.request({path:m,queryParams:h,body:JSON.stringify(p),httpMethod:"DELETE",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(v=>v.json()),f.then(()=>{const v=Rk(),x=new Zm;return Object.assign(x,v),x})}else{const p=bS(this.apiClient,e);return m=Qe("{name}",p._url),h=p._query,delete p.config,delete p._url,delete p._query,f=this.apiClient.request({path:m,queryParams:h,body:JSON.stringify(p),httpMethod:"DELETE",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(c=e.config)===null||c===void 0?void 0:c.abortSignal}).then(v=>v.json()),f.then(()=>{const v=rk(),x=new Zm;return Object.assign(x,v),x})}}async countTokens(e){var n,o,i,c;let f,m="",h={};if(this.apiClient.isVertexAI()){const p=P1(this.apiClient,e);return m=Qe("{model}:countTokens",p._url),h=p._query,delete p.config,delete p._url,delete p._query,f=this.apiClient.request({path:m,queryParams:h,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(v=>v.json().then(x=>{const C=x;return C.sdkHttpResponse={headers:v.headers},C})),f.then(v=>{const x=Pk(v),C=new Xm;return Object.assign(C,x),C})}else{const p=IS(this.apiClient,e);return m=Qe("{model}:countTokens",p._url),h=p._query,delete p.config,delete p._url,delete p._query,f=this.apiClient.request({path:m,queryParams:h,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(c=e.config)===null||c===void 0?void 0:c.abortSignal}).then(v=>v.json().then(x=>{const C=x;return C.sdkHttpResponse={headers:v.headers},C})),f.then(v=>{const x=ok(v),C=new Xm;return Object.assign(C,x),C})}}async computeTokens(e){var n,o;let i,c="",f={};if(this.apiClient.isVertexAI()){const m=F1(this.apiClient,e);return c=Qe("{model}:computeTokens",m._url),f=m._query,delete m.config,delete m._url,delete m._query,i=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json().then(p=>{const v=p;return v.sdkHttpResponse={headers:h.headers},v})),i.then(h=>{const p=Fk(h),v=new gv;return Object.assign(v,p),v})}else throw new Error("This method is only supported by the Vertex AI.")}async generateVideosInternal(e){var n,o,i,c;let f,m="",h={};if(this.apiClient.isVertexAI()){const p=q1(this.apiClient,e);return m=Qe("{model}:predictLongRunning",p._url),h=p._query,delete p.config,delete p._url,delete p._query,f=this.apiClient.request({path:m,queryParams:h,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(v=>v.json()),f.then(v=>{const x=qk(v),C=new Ha;return Object.assign(C,x),C})}else{const p=MS(this.apiClient,e);return m=Qe("{model}:predictLongRunning",p._url),h=p._query,delete p.config,delete p._url,delete p._query,f=this.apiClient.request({path:m,queryParams:h,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(c=e.config)===null||c===void 0?void 0:c.abortSignal}).then(v=>v.json()),f.then(v=>{const x=lk(v),C=new Ha;return Object.assign(C,x),C})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function pT(t){const e={},n=a(t,["operationName"]);n!=null&&l(e,["_url","operationName"],n);const o=a(t,["config"]);return o!=null&&l(e,["config"],o),e}function hT(t){const e={},n=a(t,["operationName"]);n!=null&&l(e,["_url","operationName"],n);const o=a(t,["config"]);return o!=null&&l(e,["config"],o),e}function gT(t){const e={},n=a(t,["operationName"]);n!=null&&l(e,["operationName"],n);const o=a(t,["resourceName"]);o!=null&&l(e,["_url","resourceName"],o);const i=a(t,["config"]);return i!=null&&l(e,["config"],i),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class yT extends Go{constructor(e){super(),this.apiClient=e}async getVideosOperation(e){const n=e.operation,o=e.config;if(n.name===void 0||n.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const i=n.name.split("/operations/")[0];let c;o&&"httpOptions"in o&&(c=o.httpOptions);const f=await this.fetchPredictVideosOperationInternal({operationName:n.name,resourceName:i,config:{httpOptions:c}});return n._fromAPIResponse({apiResponse:f,isVertexAI:!0})}else{const i=await this.getVideosOperationInternal({operationName:n.name,config:o});return n._fromAPIResponse({apiResponse:i,isVertexAI:!1})}}async get(e){const n=e.operation,o=e.config;if(n.name===void 0||n.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const i=n.name.split("/operations/")[0];let c;o&&"httpOptions"in o&&(c=o.httpOptions);const f=await this.fetchPredictVideosOperationInternal({operationName:n.name,resourceName:i,config:{httpOptions:c}});return n._fromAPIResponse({apiResponse:f,isVertexAI:!0})}else{const i=await this.getVideosOperationInternal({operationName:n.name,config:o});return n._fromAPIResponse({apiResponse:i,isVertexAI:!1})}}async getVideosOperationInternal(e){var n,o,i,c;let f,m="",h={};if(this.apiClient.isVertexAI()){const p=hT(e);return m=Qe("{operationName}",p._url),h=p._query,delete p.config,delete p._url,delete p._query,f=this.apiClient.request({path:m,queryParams:h,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(v=>v.json()),f}else{const p=pT(e);return m=Qe("{operationName}",p._url),h=p._query,delete p.config,delete p._url,delete p._query,f=this.apiClient.request({path:m,queryParams:h,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(c=e.config)===null||c===void 0?void 0:c.abortSignal}).then(v=>v.json()),f}}async fetchPredictVideosOperationInternal(e){var n,o;let i,c="",f={};if(this.apiClient.isVertexAI()){const m=gT(e);return c=Qe("{resourceName}:fetchPredictOperation",m._url),f=m._query,delete m.config,delete m._url,delete m._query,i=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json()),i}else throw new Error("This method is only supported by the Vertex AI.")}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function vT(t){const e={},n=a(t,["voiceName"]);return n!=null&&l(e,["voiceName"],n),e}function Sh(t){const e={},n=a(t,["prebuiltVoiceConfig"]);return n!=null&&l(e,["prebuiltVoiceConfig"],vT(n)),e}function xT(t){const e={},n=a(t,["speaker"]);n!=null&&l(e,["speaker"],n);const o=a(t,["voiceConfig"]);return o!=null&&l(e,["voiceConfig"],Sh(o)),e}function wT(t){const e={},n=a(t,["speakerVoiceConfigs"]);if(n!=null){let o=n;Array.isArray(o)&&(o=o.map(i=>xT(i))),l(e,["speakerVoiceConfigs"],o)}return e}function CT(t){const e={},n=a(t,["voiceConfig"]);n!=null&&l(e,["voiceConfig"],Sh(n));const o=a(t,["multiSpeakerVoiceConfig"]);o!=null&&l(e,["multiSpeakerVoiceConfig"],wT(o));const i=a(t,["languageCode"]);return i!=null&&l(e,["languageCode"],i),e}function ST(t){const e={},n=a(t,["fps"]);n!=null&&l(e,["fps"],n);const o=a(t,["endOffset"]);o!=null&&l(e,["endOffset"],o);const i=a(t,["startOffset"]);return i!=null&&l(e,["startOffset"],i),e}function kT(t){const e={};if(a(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=a(t,["data"]);n!=null&&l(e,["data"],n);const o=a(t,["mimeType"]);return o!=null&&l(e,["mimeType"],o),e}function TT(t){const e={};if(a(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=a(t,["fileUri"]);n!=null&&l(e,["fileUri"],n);const o=a(t,["mimeType"]);return o!=null&&l(e,["mimeType"],o),e}function _T(t){const e={},n=a(t,["videoMetadata"]);n!=null&&l(e,["videoMetadata"],ST(n));const o=a(t,["thought"]);o!=null&&l(e,["thought"],o);const i=a(t,["inlineData"]);i!=null&&l(e,["inlineData"],kT(i));const c=a(t,["fileData"]);c!=null&&l(e,["fileData"],TT(c));const f=a(t,["thoughtSignature"]);f!=null&&l(e,["thoughtSignature"],f);const m=a(t,["codeExecutionResult"]);m!=null&&l(e,["codeExecutionResult"],m);const h=a(t,["executableCode"]);h!=null&&l(e,["executableCode"],h);const p=a(t,["functionCall"]);p!=null&&l(e,["functionCall"],p);const v=a(t,["functionResponse"]);v!=null&&l(e,["functionResponse"],v);const x=a(t,["text"]);return x!=null&&l(e,["text"],x),e}function ET(t){const e={},n=a(t,["parts"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(c=>_T(c))),l(e,["parts"],i)}const o=a(t,["role"]);return o!=null&&l(e,["role"],o),e}function bT(t){const e={},n=a(t,["behavior"]);n!=null&&l(e,["behavior"],n);const o=a(t,["description"]);o!=null&&l(e,["description"],o);const i=a(t,["name"]);i!=null&&l(e,["name"],i);const c=a(t,["parameters"]);c!=null&&l(e,["parameters"],c);const f=a(t,["parametersJsonSchema"]);f!=null&&l(e,["parametersJsonSchema"],f);const m=a(t,["response"]);m!=null&&l(e,["response"],m);const h=a(t,["responseJsonSchema"]);return h!=null&&l(e,["responseJsonSchema"],h),e}function NT(t){const e={},n=a(t,["startTime"]);n!=null&&l(e,["startTime"],n);const o=a(t,["endTime"]);return o!=null&&l(e,["endTime"],o),e}function IT(t){const e={},n=a(t,["timeRangeFilter"]);if(n!=null&&l(e,["timeRangeFilter"],NT(n)),a(t,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");return e}function AT(t){const e={},n=a(t,["mode"]);n!=null&&l(e,["mode"],n);const o=a(t,["dynamicThreshold"]);return o!=null&&l(e,["dynamicThreshold"],o),e}function DT(t){const e={},n=a(t,["dynamicRetrievalConfig"]);return n!=null&&l(e,["dynamicRetrievalConfig"],AT(n)),e}function MT(){return{}}function RT(t){const e={},n=a(t,["environment"]);return n!=null&&l(e,["environment"],n),e}function PT(t){const e={},n=a(t,["functionDeclarations"]);if(n!=null){let h=n;Array.isArray(h)&&(h=h.map(p=>bT(p))),l(e,["functionDeclarations"],h)}if(a(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const o=a(t,["googleSearch"]);o!=null&&l(e,["googleSearch"],IT(o));const i=a(t,["googleSearchRetrieval"]);if(i!=null&&l(e,["googleSearchRetrieval"],DT(i)),a(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(a(t,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");a(t,["urlContext"])!=null&&l(e,["urlContext"],MT());const f=a(t,["computerUse"]);f!=null&&l(e,["computerUse"],RT(f));const m=a(t,["codeExecution"]);return m!=null&&l(e,["codeExecution"],m),e}function FT(t){const e={},n=a(t,["handle"]);if(n!=null&&l(e,["handle"],n),a(t,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return e}function Ep(){return{}}function LT(t){const e={},n=a(t,["disabled"]);n!=null&&l(e,["disabled"],n);const o=a(t,["startOfSpeechSensitivity"]);o!=null&&l(e,["startOfSpeechSensitivity"],o);const i=a(t,["endOfSpeechSensitivity"]);i!=null&&l(e,["endOfSpeechSensitivity"],i);const c=a(t,["prefixPaddingMs"]);c!=null&&l(e,["prefixPaddingMs"],c);const f=a(t,["silenceDurationMs"]);return f!=null&&l(e,["silenceDurationMs"],f),e}function UT(t){const e={},n=a(t,["automaticActivityDetection"]);n!=null&&l(e,["automaticActivityDetection"],LT(n));const o=a(t,["activityHandling"]);o!=null&&l(e,["activityHandling"],o);const i=a(t,["turnCoverage"]);return i!=null&&l(e,["turnCoverage"],i),e}function jT(t){const e={},n=a(t,["targetTokens"]);return n!=null&&l(e,["targetTokens"],n),e}function qT(t){const e={},n=a(t,["triggerTokens"]);n!=null&&l(e,["triggerTokens"],n);const o=a(t,["slidingWindow"]);return o!=null&&l(e,["slidingWindow"],jT(o)),e}function zT(t){const e={},n=a(t,["proactiveAudio"]);return n!=null&&l(e,["proactiveAudio"],n),e}function OT(t,e){const n={},o=a(t,["generationConfig"]);e!==void 0&&o!=null&&l(e,["setup","generationConfig"],o);const i=a(t,["responseModalities"]);e!==void 0&&i!=null&&l(e,["setup","generationConfig","responseModalities"],i);const c=a(t,["temperature"]);e!==void 0&&c!=null&&l(e,["setup","generationConfig","temperature"],c);const f=a(t,["topP"]);e!==void 0&&f!=null&&l(e,["setup","generationConfig","topP"],f);const m=a(t,["topK"]);e!==void 0&&m!=null&&l(e,["setup","generationConfig","topK"],m);const h=a(t,["maxOutputTokens"]);e!==void 0&&h!=null&&l(e,["setup","generationConfig","maxOutputTokens"],h);const p=a(t,["mediaResolution"]);e!==void 0&&p!=null&&l(e,["setup","generationConfig","mediaResolution"],p);const v=a(t,["seed"]);e!==void 0&&v!=null&&l(e,["setup","generationConfig","seed"],v);const x=a(t,["speechConfig"]);e!==void 0&&x!=null&&l(e,["setup","generationConfig","speechConfig"],CT(Ic(x)));const C=a(t,["enableAffectiveDialog"]);e!==void 0&&C!=null&&l(e,["setup","generationConfig","enableAffectiveDialog"],C);const S=a(t,["systemInstruction"]);e!==void 0&&S!=null&&l(e,["setup","systemInstruction"],ET(hn(S)));const b=a(t,["tools"]);if(e!==void 0&&b!=null){let P=As(b);Array.isArray(P)&&(P=P.map(G=>PT(Is(G)))),l(e,["setup","tools"],P)}const T=a(t,["sessionResumption"]);e!==void 0&&T!=null&&l(e,["setup","sessionResumption"],FT(T));const A=a(t,["inputAudioTranscription"]);e!==void 0&&A!=null&&l(e,["setup","inputAudioTranscription"],Ep());const D=a(t,["outputAudioTranscription"]);e!==void 0&&D!=null&&l(e,["setup","outputAudioTranscription"],Ep());const F=a(t,["realtimeInputConfig"]);e!==void 0&&F!=null&&l(e,["setup","realtimeInputConfig"],UT(F));const L=a(t,["contextWindowCompression"]);e!==void 0&&L!=null&&l(e,["setup","contextWindowCompression"],qT(L));const R=a(t,["proactivity"]);return e!==void 0&&R!=null&&l(e,["setup","proactivity"],zT(R)),n}function BT(t,e){const n={},o=a(e,["model"]);o!=null&&l(n,["setup","model"],_t(t,o));const i=a(e,["config"]);return i!=null&&l(n,["config"],OT(i,n)),n}function VT(t,e,n){const o={},i=a(e,["expireTime"]);n!==void 0&&i!=null&&l(n,["expireTime"],i);const c=a(e,["newSessionExpireTime"]);n!==void 0&&c!=null&&l(n,["newSessionExpireTime"],c);const f=a(e,["uses"]);n!==void 0&&f!=null&&l(n,["uses"],f);const m=a(e,["liveConnectConstraints"]);n!==void 0&&m!=null&&l(n,["bidiGenerateContentSetup"],BT(t,m));const h=a(e,["lockAdditionalFields"]);return n!==void 0&&h!=null&&l(n,["fieldMask"],h),o}function GT(t,e){const n={},o=a(e,["config"]);return o!=null&&l(n,["config"],VT(t,o,n)),n}function $T(t){const e={},n=a(t,["name"]);return n!=null&&l(e,["name"],n),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function HT(t){const e=[];for(const n in t)if(Object.prototype.hasOwnProperty.call(t,n)){const o=t[n];if(typeof o=="object"&&o!=null&&Object.keys(o).length>0){const i=Object.keys(o).map(c=>`${n}.${c}`);e.push(...i)}else e.push(n)}return e.join(",")}function WT(t,e){let n=null;const o=t.bidiGenerateContentSetup;if(typeof o=="object"&&o!==null&&"setup"in o){const c=o.setup;typeof c=="object"&&c!==null?(t.bidiGenerateContentSetup=c,n=c):delete t.bidiGenerateContentSetup}else o!==void 0&&delete t.bidiGenerateContentSetup;const i=t.fieldMask;if(n){const c=HT(n);if(Array.isArray(e==null?void 0:e.lockAdditionalFields)&&(e==null?void 0:e.lockAdditionalFields.length)===0)c?t.fieldMask=c:delete t.fieldMask;else if(e!=null&&e.lockAdditionalFields&&e.lockAdditionalFields.length>0&&i!==null&&Array.isArray(i)&&i.length>0){const f=["temperature","topK","topP","maxOutputTokens","responseModalities","seed","speechConfig"];let m=[];i.length>0&&(m=i.map(p=>f.includes(p)?`generationConfig.${p}`:p));const h=[];c&&h.push(c),m.length>0&&h.push(...m),h.length>0?t.fieldMask=h.join(","):delete t.fieldMask}else delete t.fieldMask}else i!==null&&Array.isArray(i)&&i.length>0?t.fieldMask=i.join(","):delete t.fieldMask;return t}class JT extends Go{constructor(e){super(),this.apiClient=e}async create(e){var n,o;let i,c="",f={};if(this.apiClient.isVertexAI())throw new Error("The client.tokens.create method is only supported by the Gemini Developer API.");{const m=GT(this.apiClient,e);c=Qe("auth_tokens",m._url),f=m._query,delete m.config,delete m._url,delete m._query;const h=WT(m,e.config);return i=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(p=>p.json()),i.then(p=>$T(p))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function YT(t){const e={},n=a(t,["name"]);n!=null&&l(e,["_url","name"],n);const o=a(t,["config"]);return o!=null&&l(e,["config"],o),e}function QT(t,e){const n={},o=a(t,["pageSize"]);e!==void 0&&o!=null&&l(e,["_query","pageSize"],o);const i=a(t,["pageToken"]);e!==void 0&&i!=null&&l(e,["_query","pageToken"],i);const c=a(t,["filter"]);return e!==void 0&&c!=null&&l(e,["_query","filter"],c),n}function KT(t){const e={},n=a(t,["config"]);return n!=null&&l(e,["config"],QT(n,e)),e}function ZT(t){const e={},n=a(t,["textInput"]);n!=null&&l(e,["textInput"],n);const o=a(t,["output"]);return o!=null&&l(e,["output"],o),e}function XT(t){const e={};if(a(t,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(a(t,["vertexDatasetResource"])!==void 0)throw new Error("vertexDatasetResource parameter is not supported in Gemini API.");const n=a(t,["examples"]);if(n!=null){let o=n;Array.isArray(o)&&(o=o.map(i=>ZT(i))),l(e,["examples","examples"],o)}return e}function e_(t,e){const n={};if(a(t,["validationDataset"])!==void 0)throw new Error("validationDataset parameter is not supported in Gemini API.");const o=a(t,["tunedModelDisplayName"]);if(e!==void 0&&o!=null&&l(e,["displayName"],o),a(t,["description"])!==void 0)throw new Error("description parameter is not supported in Gemini API.");const i=a(t,["epochCount"]);e!==void 0&&i!=null&&l(e,["tuningTask","hyperparameters","epochCount"],i);const c=a(t,["learningRateMultiplier"]);if(c!=null&&l(n,["tuningTask","hyperparameters","learningRateMultiplier"],c),a(t,["exportLastCheckpointOnly"])!==void 0)throw new Error("exportLastCheckpointOnly parameter is not supported in Gemini API.");if(a(t,["preTunedModelCheckpointId"])!==void 0)throw new Error("preTunedModelCheckpointId parameter is not supported in Gemini API.");if(a(t,["adapterSize"])!==void 0)throw new Error("adapterSize parameter is not supported in Gemini API.");const f=a(t,["batchSize"]);e!==void 0&&f!=null&&l(e,["tuningTask","hyperparameters","batchSize"],f);const m=a(t,["learningRate"]);return e!==void 0&&m!=null&&l(e,["tuningTask","hyperparameters","learningRate"],m),n}function t_(t){const e={},n=a(t,["baseModel"]);n!=null&&l(e,["baseModel"],n);const o=a(t,["preTunedModel"]);o!=null&&l(e,["preTunedModel"],o);const i=a(t,["trainingDataset"]);i!=null&&l(e,["tuningTask","trainingData"],XT(i));const c=a(t,["config"]);return c!=null&&l(e,["config"],e_(c,e)),e}function n_(t){const e={},n=a(t,["name"]);n!=null&&l(e,["_url","name"],n);const o=a(t,["config"]);return o!=null&&l(e,["config"],o),e}function r_(t,e){const n={},o=a(t,["pageSize"]);e!==void 0&&o!=null&&l(e,["_query","pageSize"],o);const i=a(t,["pageToken"]);e!==void 0&&i!=null&&l(e,["_query","pageToken"],i);const c=a(t,["filter"]);return e!==void 0&&c!=null&&l(e,["_query","filter"],c),n}function o_(t){const e={},n=a(t,["config"]);return n!=null&&l(e,["config"],r_(n,e)),e}function s_(t,e){const n={},o=a(t,["gcsUri"]);e!==void 0&&o!=null&&l(e,["supervisedTuningSpec","trainingDatasetUri"],o);const i=a(t,["vertexDatasetResource"]);if(e!==void 0&&i!=null&&l(e,["supervisedTuningSpec","trainingDatasetUri"],i),a(t,["examples"])!==void 0)throw new Error("examples parameter is not supported in Vertex AI.");return n}function i_(t,e){const n={},o=a(t,["gcsUri"]);o!=null&&l(n,["validationDatasetUri"],o);const i=a(t,["vertexDatasetResource"]);return e!==void 0&&i!=null&&l(e,["supervisedTuningSpec","trainingDatasetUri"],i),n}function a_(t,e){const n={},o=a(t,["validationDataset"]);e!==void 0&&o!=null&&l(e,["supervisedTuningSpec"],i_(o,n));const i=a(t,["tunedModelDisplayName"]);e!==void 0&&i!=null&&l(e,["tunedModelDisplayName"],i);const c=a(t,["description"]);e!==void 0&&c!=null&&l(e,["description"],c);const f=a(t,["epochCount"]);e!==void 0&&f!=null&&l(e,["supervisedTuningSpec","hyperParameters","epochCount"],f);const m=a(t,["learningRateMultiplier"]);e!==void 0&&m!=null&&l(e,["supervisedTuningSpec","hyperParameters","learningRateMultiplier"],m);const h=a(t,["exportLastCheckpointOnly"]);e!==void 0&&h!=null&&l(e,["supervisedTuningSpec","exportLastCheckpointOnly"],h);const p=a(t,["preTunedModelCheckpointId"]);p!=null&&l(n,["preTunedModel","checkpointId"],p);const v=a(t,["adapterSize"]);if(e!==void 0&&v!=null&&l(e,["supervisedTuningSpec","hyperParameters","adapterSize"],v),a(t,["batchSize"])!==void 0)throw new Error("batchSize parameter is not supported in Vertex AI.");if(a(t,["learningRate"])!==void 0)throw new Error("learningRate parameter is not supported in Vertex AI.");return n}function l_(t){const e={},n=a(t,["baseModel"]);n!=null&&l(e,["baseModel"],n);const o=a(t,["preTunedModel"]);o!=null&&l(e,["preTunedModel"],o);const i=a(t,["trainingDataset"]);i!=null&&l(e,["supervisedTuningSpec","trainingDatasetUri"],s_(i,e));const c=a(t,["config"]);return c!=null&&l(e,["config"],a_(c,e)),e}function u_(t){const e={},n=a(t,["name"]);n!=null&&l(e,["model"],n);const o=a(t,["name"]);return o!=null&&l(e,["endpoint"],o),e}function kh(t){const e={},n=a(t,["sdkHttpResponse"]);n!=null&&l(e,["sdkHttpResponse"],n);const o=a(t,["name"]);o!=null&&l(e,["name"],o);const i=a(t,["state"]);i!=null&&l(e,["state"],Xp(i));const c=a(t,["createTime"]);c!=null&&l(e,["createTime"],c);const f=a(t,["tuningTask","startTime"]);f!=null&&l(e,["startTime"],f);const m=a(t,["tuningTask","completeTime"]);m!=null&&l(e,["endTime"],m);const h=a(t,["updateTime"]);h!=null&&l(e,["updateTime"],h);const p=a(t,["description"]);p!=null&&l(e,["description"],p);const v=a(t,["baseModel"]);v!=null&&l(e,["baseModel"],v);const x=a(t,["_self"]);x!=null&&l(e,["tunedModel"],u_(x));const C=a(t,["customBaseModel"]);C!=null&&l(e,["customBaseModel"],C);const S=a(t,["experiment"]);S!=null&&l(e,["experiment"],S);const b=a(t,["labels"]);b!=null&&l(e,["labels"],b);const T=a(t,["outputUri"]);T!=null&&l(e,["outputUri"],T);const A=a(t,["pipelineJob"]);A!=null&&l(e,["pipelineJob"],A);const D=a(t,["serviceAccount"]);D!=null&&l(e,["serviceAccount"],D);const F=a(t,["tunedModelDisplayName"]);return F!=null&&l(e,["tunedModelDisplayName"],F),e}function c_(t){const e={},n=a(t,["sdkHttpResponse"]);n!=null&&l(e,["sdkHttpResponse"],n);const o=a(t,["nextPageToken"]);o!=null&&l(e,["nextPageToken"],o);const i=a(t,["tunedModels"]);if(i!=null){let c=i;Array.isArray(c)&&(c=c.map(f=>kh(f))),l(e,["tuningJobs"],c)}return e}function d_(t){const e={},n=a(t,["sdkHttpResponse"]);n!=null&&l(e,["sdkHttpResponse"],n);const o=a(t,["name"]);o!=null&&l(e,["name"],o);const i=a(t,["metadata"]);i!=null&&l(e,["metadata"],i);const c=a(t,["done"]);c!=null&&l(e,["done"],c);const f=a(t,["error"]);return f!=null&&l(e,["error"],f),e}function f_(t){const e={},n=a(t,["checkpointId"]);n!=null&&l(e,["checkpointId"],n);const o=a(t,["epoch"]);o!=null&&l(e,["epoch"],o);const i=a(t,["step"]);i!=null&&l(e,["step"],i);const c=a(t,["endpoint"]);return c!=null&&l(e,["endpoint"],c),e}function m_(t){const e={},n=a(t,["model"]);n!=null&&l(e,["model"],n);const o=a(t,["endpoint"]);o!=null&&l(e,["endpoint"],o);const i=a(t,["checkpoints"]);if(i!=null){let c=i;Array.isArray(c)&&(c=c.map(f=>f_(f))),l(e,["checkpoints"],c)}return e}function xc(t){const e={},n=a(t,["sdkHttpResponse"]);n!=null&&l(e,["sdkHttpResponse"],n);const o=a(t,["name"]);o!=null&&l(e,["name"],o);const i=a(t,["state"]);i!=null&&l(e,["state"],Xp(i));const c=a(t,["createTime"]);c!=null&&l(e,["createTime"],c);const f=a(t,["startTime"]);f!=null&&l(e,["startTime"],f);const m=a(t,["endTime"]);m!=null&&l(e,["endTime"],m);const h=a(t,["updateTime"]);h!=null&&l(e,["updateTime"],h);const p=a(t,["error"]);p!=null&&l(e,["error"],p);const v=a(t,["description"]);v!=null&&l(e,["description"],v);const x=a(t,["baseModel"]);x!=null&&l(e,["baseModel"],x);const C=a(t,["tunedModel"]);C!=null&&l(e,["tunedModel"],m_(C));const S=a(t,["preTunedModel"]);S!=null&&l(e,["preTunedModel"],S);const b=a(t,["supervisedTuningSpec"]);b!=null&&l(e,["supervisedTuningSpec"],b);const T=a(t,["tuningDataStats"]);T!=null&&l(e,["tuningDataStats"],T);const A=a(t,["encryptionSpec"]);A!=null&&l(e,["encryptionSpec"],A);const D=a(t,["partnerModelTuningSpec"]);D!=null&&l(e,["partnerModelTuningSpec"],D);const F=a(t,["customBaseModel"]);F!=null&&l(e,["customBaseModel"],F);const L=a(t,["experiment"]);L!=null&&l(e,["experiment"],L);const R=a(t,["labels"]);R!=null&&l(e,["labels"],R);const P=a(t,["outputUri"]);P!=null&&l(e,["outputUri"],P);const G=a(t,["pipelineJob"]);G!=null&&l(e,["pipelineJob"],G);const $=a(t,["serviceAccount"]);$!=null&&l(e,["serviceAccount"],$);const oe=a(t,["tunedModelDisplayName"]);return oe!=null&&l(e,["tunedModelDisplayName"],oe),e}function p_(t){const e={},n=a(t,["sdkHttpResponse"]);n!=null&&l(e,["sdkHttpResponse"],n);const o=a(t,["nextPageToken"]);o!=null&&l(e,["nextPageToken"],o);const i=a(t,["tuningJobs"]);if(i!=null){let c=i;Array.isArray(c)&&(c=c.map(f=>xc(f))),l(e,["tuningJobs"],c)}return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class h_ extends Go{constructor(e){super(),this.apiClient=e,this.get=async n=>await this.getInternal(n),this.list=async(n={})=>new xi(Bo.PAGED_ITEM_TUNING_JOBS,o=>this.listInternal(o),await this.listInternal(n),n),this.tune=async n=>{if(this.apiClient.isVertexAI())if(n.baseModel.startsWith("projects/")){const o={tunedModelName:n.baseModel},i=Object.assign(Object.assign({},n),{preTunedModel:o});return i.baseModel=void 0,await this.tuneInternal(i)}else{const o=Object.assign({},n);return await this.tuneInternal(o)}else{const o=Object.assign({},n),i=await this.tuneMldevInternal(o);let c="";return i.metadata!==void 0&&i.metadata.tunedModel!==void 0?c=i.metadata.tunedModel:i.name!==void 0&&i.name.includes("/operations/")&&(c=i.name.split("/operations/")[0]),{name:c,state:cc.JOB_STATE_QUEUED}}}}async getInternal(e){var n,o,i,c;let f,m="",h={};if(this.apiClient.isVertexAI()){const p=n_(e);return m=Qe("{name}",p._url),h=p._query,delete p.config,delete p._url,delete p._query,f=this.apiClient.request({path:m,queryParams:h,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(v=>v.json().then(x=>{const C=x;return C.sdkHttpResponse={headers:v.headers},C})),f.then(v=>xc(v))}else{const p=YT(e);return m=Qe("{name}",p._url),h=p._query,delete p.config,delete p._url,delete p._query,f=this.apiClient.request({path:m,queryParams:h,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(c=e.config)===null||c===void 0?void 0:c.abortSignal}).then(v=>v.json().then(x=>{const C=x;return C.sdkHttpResponse={headers:v.headers},C})),f.then(v=>kh(v))}}async listInternal(e){var n,o,i,c;let f,m="",h={};if(this.apiClient.isVertexAI()){const p=o_(e);return m=Qe("tuningJobs",p._url),h=p._query,delete p.config,delete p._url,delete p._query,f=this.apiClient.request({path:m,queryParams:h,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(v=>v.json().then(x=>{const C=x;return C.sdkHttpResponse={headers:v.headers},C})),f.then(v=>{const x=p_(v),C=new tp;return Object.assign(C,x),C})}else{const p=KT(e);return m=Qe("tunedModels",p._url),h=p._query,delete p.config,delete p._url,delete p._query,f=this.apiClient.request({path:m,queryParams:h,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(c=e.config)===null||c===void 0?void 0:c.abortSignal}).then(v=>v.json().then(x=>{const C=x;return C.sdkHttpResponse={headers:v.headers},C})),f.then(v=>{const x=c_(v),C=new tp;return Object.assign(C,x),C})}}async tuneInternal(e){var n,o;let i,c="",f={};if(this.apiClient.isVertexAI()){const m=l_(e);return c=Qe("tuningJobs",m._url),f=m._query,delete m.config,delete m._url,delete m._query,i=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json().then(p=>{const v=p;return v.sdkHttpResponse={headers:h.headers},v})),i.then(h=>xc(h))}else throw new Error("This method is only supported by the Vertex AI.")}async tuneMldevInternal(e){var n,o;let i,c="",f={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const m=t_(e);return c=Qe("tunedModels",m._url),f=m._query,delete m.config,delete m._url,delete m._query,i=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json().then(p=>{const v=p;return v.sdkHttpResponse={headers:h.headers},v})),i.then(h=>d_(h))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class g_{async download(e,n){throw new Error("Download to file is not supported in the browser, please use a browser compliant download like an <a> tag.")}}const y_=1024*1024*8,v_=3,x_=1e3,w_=2,Zu="x-goog-upload-status";async function C_(t,e,n){var o,i,c;let f=0,m=0,h=new dc(new Response),p="upload";for(f=t.size;m<f;){const x=Math.min(y_,f-m),C=t.slice(m,m+x);m+x>=f&&(p+=", finalize");let S=0,b=x_;for(;S<v_&&(h=await n.request({path:"",body:C,httpMethod:"POST",httpOptions:{apiVersion:"",baseUrl:e,headers:{"X-Goog-Upload-Command":p,"X-Goog-Upload-Offset":String(m),"Content-Length":String(x)}}}),!(!((o=h==null?void 0:h.headers)===null||o===void 0)&&o[Zu]));)S++,await k_(b),b=b*w_;if(m+=x,((i=h==null?void 0:h.headers)===null||i===void 0?void 0:i[Zu])!=="active")break;if(f<=m)throw new Error("All content has been uploaded, but the upload status is not finalized.")}const v=await(h==null?void 0:h.json());if(((c=h==null?void 0:h.headers)===null||c===void 0?void 0:c[Zu])!=="final")throw new Error("Failed to upload file: Upload status is not finalized.");return v.file}async function S_(t){return{size:t.size,type:t.type}}function k_(t){return new Promise(e=>setTimeout(e,t))}class T_{async upload(e,n,o){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await C_(e,n,o)}async stat(e){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await S_(e)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class __{create(e,n,o){return new E_(e,n,o)}}class E_{constructor(e,n,o){this.url=e,this.headers=n,this.callbacks=o}connect(){this.ws=new WebSocket(this.url),this.ws.onopen=this.callbacks.onopen,this.ws.onerror=this.callbacks.onerror,this.ws.onclose=this.callbacks.onclose,this.ws.onmessage=this.callbacks.onmessage}send(e){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.send(e)}close(){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.close()}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const bp="x-goog-api-key";class b_{constructor(e){this.apiKey=e}async addAuthHeaders(e){if(e.get(bp)===null){if(this.apiKey.startsWith("auth_tokens/"))throw new Error("Ephemeral tokens are only supported by the live API.");if(!this.apiKey)throw new Error("API key is missing. Please provide a valid API key.");e.append(bp,this.apiKey)}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const N_="gl-node/";class I_{constructor(e){var n;if(e.apiKey==null)throw new Error("An API Key must be set when running in a browser");if(e.project||e.location)throw new Error("Vertex AI project based authentication is not supported on browser runtimes. Please do not provide a project or location.");this.vertexai=(n=e.vertexai)!==null&&n!==void 0?n:!1,this.apiKey=e.apiKey;const o=dv(e.httpOptions,e.vertexai,void 0,void 0);o&&(e.httpOptions?e.httpOptions.baseUrl=o:e.httpOptions={baseUrl:o}),this.apiVersion=e.apiVersion;const i=new b_(this.apiKey);this.apiClient=new Wk({auth:i,apiVersion:this.apiVersion,apiKey:this.apiKey,vertexai:this.vertexai,httpOptions:e.httpOptions,userAgentExtra:N_+"web",uploader:new T_,downloader:new g_}),this.models=new mT(this.apiClient),this.live=new iT(this.apiClient,i,new __),this.batches=new Lx(this.apiClient),this.chats=new B0(this.models,this.apiClient),this.caches=new q0(this.apiClient),this.files=new tw(this.apiClient),this.operations=new yT(this.apiClient),this.authTokens=new JT(this.apiClient),this.tunings=new h_(this.apiClient)}}const el=new I_({apiKey:void 0}),Dc={type:vt.OBJECT,properties:{seriesName:{type:vt.STRING,description:"A creative and descriptive name for the entire learning series."},seriesDescription:{type:vt.STRING,description:"A brief, engaging summary of what the series covers."},levels:{type:vt.ARRAY,description:"An array of 2 to 4 learning levels, progressing in difficulty.",items:{type:vt.OBJECT,properties:{title:{type:vt.STRING,description:"The title for this level (e.g., 'Level 1: Fundamentals')."},decks:{type:vt.ARRAY,description:"An array of 1 to 3 quiz decks for this level.",items:{type:vt.OBJECT,properties:{name:{type:vt.STRING,description:"The name of the quiz deck, including its level number (e.g., 'Level 1.1: Core Concepts')."},description:{type:vt.STRING,description:"A brief summary of this specific deck's content."},questions:{type:vt.ARRAY,description:"This MUST be an empty array: []. The questions will be generated later.",maxItems:0,items:{type:vt.OBJECT,properties:{question:{type:vt.STRING}}}},suggestedQuestionCount:{type:vt.NUMBER,description:"A suggested number of questions (e.g., 10, 15, 20) for this deck to ensure comprehensive topic coverage."}},required:["name","description","questions","suggestedQuestionCount"]}}},required:["title","decks"]}}},required:["seriesName","seriesDescription","levels"]},A_={type:vt.OBJECT,properties:{questions:{type:vt.ARRAY,description:"An array of high-quality multiple-choice questions for the deck.",items:{type:vt.OBJECT,properties:{questionText:{type:vt.STRING},detailedExplanation:{type:vt.STRING,description:"A thorough explanation of the correct answer, providing context and educational value."},correctAnswerId:{type:vt.STRING},options:{type:vt.ARRAY,description:"An array of 3 to 4 answer options.",items:{type:vt.OBJECT,properties:{id:{type:vt.STRING,description:"A unique identifier for the option (e.g., 'opt1')."},text:{type:vt.STRING}},required:["id","text"]}}},required:["questionText","detailedExplanation","correctAnswerId","options"]}}},required:["questions"]},D_={type:vt.ARRAY,description:"An array of 1 to 2 new, unique learning levels that logically follow the existing ones.",items:Dc.properties.levels.items},M_={type:vt.ARRAY,description:"An array of 1 to 2 new, unique quiz decks for this level.",items:Dc.properties.levels.items.properties.decks.items},R_=async(t,e,n=5,o=20)=>{const i=JSON.parse(JSON.stringify(Dc));i.properties.levels.items.properties.decks.description=`An array of 1 to ${n} quiz decks for this level.`;const c=`
        Please act as an expert instructional designer. Your task is to generate a JSON object that acts as a scaffold for a learning path.

        **Topic:** ${t}
        **Target Audience Level:** ${e}
        
        **Instructions:**
        1.  Create a progressive learning path with 2-4 distinct levels.
        2.  Each level should contain 1 to ${n} decks. You should decide the optimal number of decks within this range to properly cover the material for that level.
        3.  For each deck, provide a \`suggestedQuestionCount\`. Aim for approximately ${o} questions, but you have the flexibility to suggest a higher or lower number if it is better for covering the deck's specific topic comprehensively.
        4.  **Crucially, for every deck object, you must include a "questions" key with an empty array as its value, like this: "questions": []**
        5.  The entire output must conform to the provided JSON schema. Do not output any text or markdown before or after the JSON object.
    `;try{const m=(await el.models.generateContent({model:"gemini-2.5-flash",contents:c,config:{responseMimeType:"application/json",responseSchema:i}})).text.trim(),h=JSON.parse(m);if(!h.seriesName||!Array.isArray(h.levels))throw new Error("AI response is missing required series data.");return h}catch(f){throw console.error("Error generating series scaffold with AI:",f),f instanceof Error&&f.message.includes("SAFETY")?new Error("The request was blocked due to safety settings. Please try a different topic."):new Error("Failed to generate content. The AI model may be overloaded or the topic is too complex. Please try again later.")}},P_=async(t,e)=>{const n=t.levels.map((i,c)=>{const f=i.deckIds.map(m=>{var h;return`- ${(h=e.find(p=>p.id===m))==null?void 0:h.name}`}).join(`
  `);return`Level ${c+1}: ${i.title}
Decks:
  ${f}`}).join(`

`),o=`
        You are an expert instructional designer continuing to build a learning path.
        Here is the existing series structure:
        Series Name: ${t.name}
        Series Description: ${t.description}
        
        Existing Levels:
        ${n}

        Your task is to generate 1-2 NEW levels that logically follow the existing ones. Do not repeat topics.
        The new levels should continue the progression of difficulty and knowledge.
        For each new level, suggest 1-3 new decks with names, descriptions, and a suggested question count.
        The entire output must conform to the provided JSON schema, containing only an array of the new levels.
    `;try{const c=(await el.models.generateContent({model:"gemini-2.5-flash",contents:o,config:{responseMimeType:"application/json",responseSchema:D_}})).text.trim();return JSON.parse(c)}catch(i){throw console.error("Error generating more levels with AI:",i),i instanceof Error&&i.message.includes("SAFETY")?new Error("The request was blocked due to safety settings."):new Error("Failed to generate new levels. Please try again later.")}},F_=async(t,e,n)=>{const o=t.levels[e];if(!o)throw new Error("Invalid level index.");const i=o.deckIds.map(f=>{var m;return`- ${(m=n.find(h=>h.id===f))==null?void 0:m.name}`}).join(`
`),c=`
        You are an expert instructional designer. I need you to expand a specific level within an existing learning series.

        Series Topic: ${t.name}
        Level to expand: "${o.title}"

        This level currently contains the following decks:
        ${i}

        Please generate 1-2 NEW, unique decks that fit logically within this level and do not repeat the topics already covered.
        For each new deck, provide a name, description, and a suggested question count.
        The entire output must conform to the provided JSON schema, containing only an array of the new decks.
    `;try{const m=(await el.models.generateContent({model:"gemini-2.5-flash",contents:c,config:{responseMimeType:"application/json",responseSchema:M_}})).text.trim();return JSON.parse(m)}catch(f){throw console.error("Error generating more decks with AI:",f),f instanceof Error&&f.message.includes("SAFETY")?new Error("The request was blocked due to safety settings."):new Error("Failed to generate new decks. Please try again later.")}},Np=async(t,e,n)=>{const i=el.chats.create({model:"gemini-2.5-flash",history:t.aiChatHistory||[],config:{responseMimeType:"application/json",responseSchema:A_}});if(!t.aiChatHistory||t.aiChatHistory.length===0){const c=e.map(m=>`- ${m.name}: ${m.description}`).join(`
`),f=`
            You are an expert instructional designer creating a learning series on the topic: "${t.name}".
            I will ask you to generate questions for the following decks, one by one. Maintain context and avoid creating duplicate questions across the entire series.
            The decks we will populate are:
            ${c}
            
            For each request, you must respond with a JSON object containing a "questions" array.
        `;await i.sendMessage({message:f})}for(const c of e){const f=c.suggestedQuestionCount||Math.floor(Math.random()*11)+15;let m=[];const h=Math.ceil(f/20);for(let p=0;p<h;p++){const v=Math.min(20,f-m.length);if(v<=0)break;const x=`
                Now, generate exactly ${v} unique, high-quality questions for the deck: "${c.name}".
                Description: "${c.description}".
                Ensure these are different from any questions you have generated previously in this conversation.
            `;try{const S=(await i.sendMessage({message:x})).text.trim(),b=JSON.parse(S);Array.isArray(b.questions)?m.push(...b.questions):console.warn(`AI did not return a valid questions array for deck "${c.name}", batch ${p+1}.`)}catch(C){throw console.error(`Error generating questions for deck "${c.name}", batch ${p+1}:`,C),C instanceof Error&&C.message.includes("SAFETY")?new Error(`Request for "${c.name}" was blocked due to safety settings. Please try a different topic.`):new Error(`An error occurred while communicating with the AI for deck "${c.name}". Process stopped.`)}}n(c.id,m)}return await i.getHistory()},L_=({sessionsToResume:t,setSessionsToResume:e,setGeneralStudyDeck:n,openConfirmModal:o,setFolderToEdit:i,setSeriesToEdit:c})=>{const{addToast:f}=gn(),{navigate:m}=Rr(),h=yt(O=>O.dispatch),p=B.useCallback(async(O,V)=>{h({type:"UPDATE_DECK",payload:O}),V!=null&&V.silent||(V!=null&&V.toastMessage?f(V.toastMessage,"success"):O.archived?f(`Deck "${O.name}" archived.`,"success"):O.archived===!1?f(`Deck "${O.name}" unarchived.`,"success"):f(`Deck "${O.name}" updated.`,"success"));try{await Wg(O)}catch(K){console.error("Failed to update deck:",K),f("There was an error syncing the deck update.","error")}},[f,h]),v=B.useCallback(async O=>{const V=yt.getState().decks.find(K=>K.id===O);if(V){const K={...V,lastOpened:new Date().toISOString()};await p(K,{silent:!0})}},[p]),x=B.useCallback(async O=>{const V=yt.getState().deckSeries.find(K=>K.id===O);if(V){const K={...V,lastOpened:new Date().toISOString()};h({type:"UPDATE_SERIES",payload:K});try{await Vu(K)}catch(X){console.error("Failed to update series lastOpened:",X)}}},[h]),C=B.useCallback(async O=>{try{h({type:"ADD_DECKS",payload:O}),await mi(O)}catch(V){console.error("Failed to add decks:",V),f("There was an error saving the new deck(s).","error")}},[f,h]),S=B.useCallback(async(O,V)=>{const K=`session_deck_${O}`;if(t.has(O)){const X=new Set(t);X.delete(O),e(X)}try{await sc(K)}catch(X){console.error(`Failed to clean up session state for ${K} from DB`,X)}O==="general-study-deck"&&n(null),m(V?`/series/${V}`:"/")},[m,t,e,n]),b=B.useCallback(async()=>{const O=Oy();await C([O]),f(`Sample deck "${O.name}" created!`,"success")},[C,f]),T=B.useCallback(async()=>{const{series:O,decks:V}=zy();try{h({type:"ADD_SERIES_WITH_DECKS",payload:{series:O,decks:V}}),await Promise.all([mi(V),Ma([O])]),f(`Sample series "${O.name}" created!`,"success")}catch(K){console.error("Failed to create sample series:",K),f("There was an error creating the sample series.","error")}},[f,h]),A=B.useCallback(async O=>{try{h({type:"RESTORE_DATA",payload:O}),await Promise.all([mi(O.decks),Yg(O.folders),Ma(O.deckSeries)]),f("Successfully restored data.","success")}catch(V){throw console.error("Failed to restore from backup:",V),f("There was an error restoring from the backup file.","error"),V}},[f,h]),D=B.useCallback(async O=>{const V=yt.getState().decks.find(X=>X.id===O);if(!V)return;const K={...V,deletedAt:new Date().toISOString(),archived:!1};await p(K,{toastMessage:`Moved "${V.name}" to Trash.`})},[p]),F=B.useCallback(async(O,V)=>{const{decks:K,folders:X}=yt.getState(),se=K.find(Ne=>Ne.id===O),ae=X.find(Ne=>Ne.id===V);if(!se||se.folderId===V)return;const ke={...se,folderId:V},Ae=ae?`"${ae.name}"`:"the ungrouped area";await p(ke,{toastMessage:`Moved "${se.name}" to ${Ae}.`})},[p]),L=B.useCallback(async(O,V,K,X)=>{const{decks:se,deckSeries:ae,seriesProgress:ke}=yt.getState(),Ae=se.find(_e=>_e.id===O);if(!Ae)return;let Ne;const{id:je,dueDate:De,interval:E,easeFactor:fe,suspended:ce,masteryLevel:W,lastReviewed:H,lapses:re}=V,Te={dueDate:De,interval:E,easeFactor:fe,suspended:ce,masteryLevel:W,lastReviewed:H,lapses:re};Ae.type===We.Flashcard?Ne={...Ae,cards:Ae.cards.map(_e=>_e.id===je?{..._e,...Te}:_e)}:Ne={...Ae,questions:Ae.questions.map(_e=>_e.id===je?{..._e,...Te}:_e)},await p(Ne,{silent:!0});try{const _e={itemId:V.id,deckId:O,seriesId:X,timestamp:new Date().toISOString(),rating:K,newInterval:V.interval,easeFactor:V.easeFactor,masteryLevel:V.masteryLevel||0};await ty(_e)}catch(_e){console.error("Failed to log review:",_e)}if(X){const _e=Ne,me=_e.type===We.Flashcard?_e.cards:_e.questions,Le=me.some(Fe=>!Fe.suspended&&Fe.interval===0),Oe=(ke.get(X)||new Set).has(O);if(!Le&&!Oe&&me.length>0){const Fe=new Map(ke),Ve=new Set(Fe.get(X)||[]);Ve.add(O),Fe.set(X,Ve);try{localStorage.setItem(`series-progress-${X}`,JSON.stringify(Array.from(Ve)));const at=ae.find(kt=>kt.id===X),et=(at==null?void 0:at.levels.flatMap(kt=>kt.deckIds))||[];et.indexOf(O)===et.length-1&&et.length>0?f(`Congratulations! You've completed the series: "${at==null?void 0:at.name}"!`,"success"):f(`Deck "${_e.name}" completed! Next chapter unlocked.`,"success"),h({type:"SET_SERIES_PROGRESS",payload:Fe})}catch(at){console.error("Could not save series progress",at)}}}},[p,f,h]),R=B.useCallback(async O=>{const V=yt.getState().decks.find(X=>X.id===O);if(!V)return;let K;V.type===We.Flashcard?K={...V,cards:V.cards.map(X=>em(X))}:K={...V,questions:V.questions.map(X=>em(X))},await p(K,{toastMessage:`Progress for deck "${K.name}" has been reset.`})},[p]),P=async()=>{try{const O=await oy();O&&f(`Data exported to ${O}`,"success")}catch(O){const V=O instanceof Error?O.message:"Unknown error";f(`Export failed: ${V}`,"error")}},G=B.useCallback(()=>{const{decks:O,deckSeries:V,seriesProgress:K}=yt.getState(),X=new Set;V.forEach(Ne=>{Ne.levels.forEach(je=>je.deckIds.forEach(De=>X.add(De)))});const se=new Set;V.forEach(Ne=>{var je;if(!Ne.archived&&!Ne.deletedAt){const De=((je=K.get(Ne.id))==null?void 0:je.size)||0;let E=0;Ne.levels.forEach(fe=>{fe.deckIds.forEach(ce=>{E<=De&&se.add(ce),E++})})}});const ae=new Date;ae.setHours(23,59,59,999);const ke=O.filter(Ne=>!(Ne.type!==We.Quiz||Ne.archived||Ne.deletedAt||X.has(Ne.id)&&!se.has(Ne.id))).flatMap(Ne=>Ne.questions.filter(je=>!je.suspended&&new Date(je.dueDate)<=ae).map(je=>({...je,originalDeckId:Ne.id,originalDeckName:Ne.name}))).sort(()=>Math.random()-.5),Ae={id:"general-study-deck",name:"General Study Session",type:We.Quiz,questions:ke};n(Ae),m("/study/general")},[m,n]),$=B.useCallback(async O=>{var fe;const{decks:V,deckSeries:K,seriesProgress:X}=yt.getState(),se=K.find(ce=>ce.id===O);if(!se)return;const ae=new Set,ke=((fe=X.get(se.id))==null?void 0:fe.size)||0;let Ae=0;se.levels.forEach(ce=>{ce.deckIds.forEach(W=>{Ae<=ke&&ae.add(W),Ae++})});const Ne=new Date;Ne.setHours(23,59,59,999);const De=se.levels.flatMap(ce=>ce.deckIds).map(ce=>V.find(W=>W.id===ce)).filter(ce=>!!(ce&&ce.type===We.Quiz)).filter(ce=>ae.has(ce.id)).flatMap(ce=>ce.questions.filter(W=>!W.suspended&&new Date(W.dueDate)<=Ne).map(W=>({...W,originalDeckId:ce.id,originalDeckName:ce.name}))).sort(()=>Math.random()-.5),E={id:"general-study-deck",name:`${se.name} - Study Session`,type:We.Quiz,questions:De};n(E),m(`/study/general?seriesId=${O}`)},[m,n]),oe=B.useCallback(async O=>{if(O.id){const V={id:O.id,name:O.name};h({type:"UPDATE_FOLDER",payload:V}),f(`Folder "${V.name}" updated.`,"success"),await Qg(V)}else{const V={id:crypto.randomUUID(),name:O.name};h({type:"ADD_FOLDER",payload:V}),f(`Folder "${V.name}" created.`,"success"),await Jg(V)}i(null)},[f,h,i]),J=B.useCallback(async O=>{const{folders:V,decks:K}=yt.getState(),X=V.find(se=>se.id===O);X&&o({title:"Delete Folder",message:`Are you sure you want to delete folder "${X.name}"? Decks inside will not be deleted.`,onConfirm:async()=>{h({type:"DELETE_FOLDER",payload:O}),f(`Folder "${X.name}" deleted.`,"success");const se=K.filter(ae=>ae.folderId===O).map(ae=>({...ae,folderId:null}));se.length>0&&await Wf(se),await Kg(O)}})},[f,h,o]),Z=B.useCallback(async(O,V)=>{h({type:"UPDATE_SERIES",payload:O}),V!=null&&V.silent||(V!=null&&V.toastMessage?f(V.toastMessage,"success"):O.archived?f(`Series "${O.name}" archived.`,"success"):O.archived===!1?f(`Series "${O.name}" unarchived.`,"success"):f(`Series "${O.name}" updated.`,"success"));try{await Vu(O)}catch(K){console.error("Failed to update series:",K),f("There was an error updating the series.","error")}},[f,h]),le=B.useCallback(async(O,V)=>{try{h({type:"ADD_SERIES_WITH_DECKS",payload:{series:O,decks:V}}),await Promise.all([mi(V),Ma([O])]),f(`Successfully imported series "${O.name}" with ${V.length} decks.`,"success")}catch(K){console.error("Failed to create series with decks:",K),f("There was an error creating the new series.","error")}},[h,f]),Q=B.useCallback(async O=>{if(O.id){const V=yt.getState().deckSeries.find(K=>K.id===O.id);if(V){const K={...V,name:O.name,description:O.description};await Z(K)}}else if(O.scaffold&&Array.isArray(O.scaffold.levels)){const{levels:V}=O.scaffold,K=[],X=V.map(ae=>{const ke=(ae.decks||[]).map(Ae=>({id:crypto.randomUUID(),name:Ae.name,description:Ae.description,type:We.Quiz,questions:io(Ae.questions||[])}));return K.push(...ke),{title:ae.title,deckIds:ke.map(Ae=>Ae.id)}}),se={id:crypto.randomUUID(),type:"series",name:O.name,description:O.description,levels:X,archived:!1,createdAt:new Date().toISOString()};await le(se,K),f(`Series "${se.name}" created from scaffold.`,"success"),m(`/series/${se.id}?edit=true`)}else{const V={id:crypto.randomUUID(),type:"series",name:O.name,description:O.description,levels:[],createdAt:new Date().toISOString()};h({type:"ADD_SERIES",payload:V}),f(`Series "${V.name}" created.`,"success"),await Ma([V]),m(`/series/${V.id}?edit=true`)}c(null)},[f,Z,h,c,m,le]),Y=B.useCallback(async O=>{const{deckSeries:V,decks:K}=yt.getState(),X=V.find(Ae=>Ae.id===O);if(!X)return;const se=X.levels.flatMap(Ae=>Ae.deckIds),ae=K.filter(Ae=>se.includes(Ae.id)).map(Ae=>({...Ae,deletedAt:new Date().toISOString(),archived:!1})),ke={...X,deletedAt:new Date().toISOString(),archived:!1};h({type:"BULK_UPDATE_DECKS",payload:ae}),h({type:"UPDATE_SERIES",payload:ke}),f(`Series "${X.name}" and its ${ae.length} deck(s) moved to Trash.`,"success");try{await Promise.all([Wf(ae),Vu(ke)])}catch(Ae){console.error("Failed to move series and its decks to trash:",Ae),f("Error moving series to trash.","error")}},[h,f]),M=B.useCallback(async(O,V)=>{const K=yt.getState().deckSeries.find(ae=>ae.id===O);if(!K)return;await C([V]);const X={title:V.name,deckIds:[V.id]},se={...K,levels:[...K.levels,X]};await Z(se)},[C,Z]),pe=B.useCallback(async O=>{const V=yt.getState().decks.find(se=>se.id===O);if(!V)return;const{deletedAt:K,...X}=V;await p(X,{toastMessage:`Restored deck "${X.name}".`})},[p]),be=B.useCallback(async O=>{const V=yt.getState().deckSeries.find(se=>se.id===O);if(!V)return;const{deletedAt:K,...X}=V;await Z(X,{toastMessage:`Restored series "${X.name}".`})},[Z]),ve=B.useCallback(async O=>{var V;try{const K=(V=yt.getState().decks.find(X=>X.id===O))==null?void 0:V.name;h({type:"DELETE_DECK",payload:O}),f(`Deck "${K||"Deck"}" permanently deleted.`,"success"),await oc(O)}catch(K){console.error("Failed to permanently delete deck:",K),f("There was an error permanently deleting the deck.","error")}},[h,f]),xe=B.useCallback(async O=>{const V=yt.getState().deckSeries.find(se=>se.id===O);if(!V)return;const K=V.levels.flatMap(se=>se.deckIds),X=V.name;try{K.forEach(se=>{h({type:"DELETE_DECK",payload:se})}),h({type:"DELETE_SERIES",payload:O}),f(`Series "${X}" and its ${K.length} deck(s) permanently deleted.`,"success"),await Promise.all([...K.map(se=>oc(se)),zp(O)])}catch(se){console.error("Failed to permanently delete series and its decks:",se),f("There was an error permanently deleting the series.","error")}},[h,f]),te=B.useCallback(()=>{o({title:"Factory Reset",message:"Are you sure you want to perform a factory reset? All of your decks, folders, series, and settings will be permanently deleted. This action cannot be undone.",confirmText:"RESET",onConfirm:async()=>{try{f("Resetting application...","info"),navigator.serviceWorker&&navigator.serviceWorker.controller&&(navigator.serviceWorker.controller.postMessage({type:"CLEAR_APP_CACHE"}),navigator.serviceWorker.controller.postMessage({type:"CLEAR_CDN_CACHE"})),await sy();const O=[];for(let V=0;V<localStorage.length;V++){const K=localStorage.key(V);K&&(K.startsWith("cogniflow-")||K.startsWith("session_deck_")||K.startsWith("series-progress-"))&&O.push(K)}O.forEach(V=>localStorage.removeItem(V)),setTimeout(()=>{window.location.reload()},1500)}catch(O){console.error("Factory reset failed:",O);const V=O instanceof Error?O.message:"Factory reset failed. Please try again.";f(V,"error")}}})},[f,o]),q=B.useCallback(()=>{const{deckSeries:O,decks:V,seriesProgress:K}=yt.getState();if(!O.length||!V.length)return;let X=!1;const se=new Map(K);for(const ae of O){if(ae.archived||ae.deletedAt)continue;const ke=new Set(se.get(ae.id)||[]);let Ae=!1;const Ne=ae.levels.flatMap(je=>je.deckIds);for(const je of Ne){if(ke.has(je))continue;const De=V.find(ce=>ce.id===je);if(!De)continue;const E=De.type===We.Quiz?De.questions:De.cards;!E.some(ce=>!ce.suspended&&ce.interval===0)&&E.length>0&&(ke.add(je),Ae=!0)}Ae&&(se.set(ae.id,ke),X=!0)}X&&(se.forEach((ae,ke)=>{try{localStorage.setItem(`series-progress-${ke}`,JSON.stringify(Array.from(ae)))}catch(Ae){console.error(`Could not save reconciled series progress for ${ke}`,Ae)}}),f("Unlocked decks based on your progress.","info"),h({type:"SET_SERIES_PROGRESS",payload:se}))},[f,h]),N=B.useCallback(async O=>{const{deckSeries:V,decks:K}=yt.getState(),X=V.find(Ne=>Ne.id===O);if(!X)throw new Error("Series not found");const se=await P_(X,K.filter(Ne=>Ne.type==="quiz"));if(!se||se.length===0){f("The AI didn't suggest any new levels.","info");return}const ae=[],ke=se.map(Ne=>{const je=Ne.decks.map(De=>({id:crypto.randomUUID(),name:De.name,description:De.description,type:We.Quiz,questions:[],suggestedQuestionCount:De.suggestedQuestionCount}));return ae.push(...je),{title:Ne.title,deckIds:je.map(De=>De.id)}}),Ae={...X,levels:[...X.levels,...ke]};await C(ae),await Z(Ae,{toastMessage:`Added ${ke.length} new level(s) to "${X.name}"!`})},[C,Z,f]),j=B.useCallback(async(O,V)=>{const{deckSeries:K,decks:X}=yt.getState(),se=K.find(je=>je.id===O);if(!se)throw new Error("Series not found");const ae=await F_(se,V,X.filter(je=>je.type==="quiz"));if(!ae||ae.length===0){f("The AI didn't suggest any new decks for this level.","info");return}const ke=ae.map(je=>({id:crypto.randomUUID(),name:je.name,description:je.description,type:We.Quiz,questions:[],suggestedQuestionCount:je.suggestedQuestionCount}));await C(ke);const Ae=JSON.parse(JSON.stringify(se)),Ne=ke.map(je=>je.id);Ae.levels[V].deckIds.push(...Ne),await Z(Ae,{toastMessage:`Added ${ke.length} new deck(s) to "${se.levels[V].title}"!`})},[C,Z,f]);return{updateLastOpened:v,updateLastOpenedSeries:x,handleSessionEnd:S,handleAddDecks:C,handleCreateSampleDeck:b,handleCreateSampleSeries:T,handleRestoreData:A,handleDeleteDeck:D,handleUpdateDeck:p,handleMoveDeck:F,handleItemReviewed:L,handleExportData:P,handleResetDeckProgress:R,handleFactoryReset:te,handleStartGeneralStudy:G,handleStartSeriesStudy:$,handleSaveFolder:oe,handleDeleteFolder:J,handleUpdateSeries:Z,handleSaveSeries:Q,handleDeleteSeries:Y,handleAddDeckToSeries:M,handleAddSeriesWithDecks:le,handleRestoreDeck:pe,handleRestoreSeries:be,handleDeleteDeckPermanently:ve,handleDeleteSeriesPermanently:xe,reconcileSeriesProgress:q,handleAiAddLevelsToSeries:N,handleAiAddDecksToLevel:j}},La=120,U_=()=>{const[t,e]=B.useState({startY:0,pullDistance:0,isRefreshing:!1,thresholdMet:!1}),{hapticsEnabled:n}=Vo(),o=B.useCallback(f=>{window.scrollY===0?e(m=>({...m,startY:f.touches[0].clientY,pullDistance:0,isRefreshing:!1,thresholdMet:!1})):e(m=>({...m,startY:0}))},[]),i=B.useCallback(f=>{if(t.startY===0)return;const m=f.touches[0].clientY-t.startY;m>5&&(f.preventDefault(),m>La&&!t.thresholdMet&&n&&"vibrate"in navigator&&navigator.vibrate(50),e(p=>({...p,pullDistance:m,thresholdMet:m>La})))},[t.startY,t.thresholdMet,n]),c=B.useCallback(()=>{t.startY!==0&&(t.pullDistance>La?(e(f=>({...f,isRefreshing:!0})),setTimeout(()=>{window.location.reload()},500)):e({startY:0,pullDistance:0,isRefreshing:!1,thresholdMet:!1}))},[t.startY,t.pullDistance]);return{pullToRefreshState:t,handleTouchStart:o,handleTouchMove:i,handleTouchEnd:c,REFRESH_THRESHOLD:La}},j_=({onOpenMenu:t,onOpenCommandPalette:e,activeDeck:n})=>{const{path:o,navigate:i}=Rr();let c;const[f]=o.split("?"),m=u.jsx("span",{className:"text-xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-blue-400 to-teal-300",children:"CogniFlow"}),h=n==null?void 0:n.id;if(f.startsWith("/decks/")&&f.endsWith("/study")){const p=new URLSearchParams(window.location.hash.split("?")[1]).get("seriesId"),v=h?`/decks/${h}?${p?`seriesId=${p}`:""}`:p?`/series/${p}`:"/decks";c=u.jsxs(Se,{variant:"ghost",onClick:()=>i(v),className:"flex items-center space-x-2 -ml-3 min-w-0",children:[u.jsx(de,{name:"chevron-left"}),u.jsx("span",{className:"truncate",children:(n==null?void 0:n.name)||"Back"})]})}else if(f.startsWith("/decks/")){const p=new URLSearchParams(window.location.hash.split("?")[1]).get("seriesId");p?c=u.jsxs(Se,{variant:"ghost",onClick:()=>i(`/series/${p}`),className:"flex items-center space-x-2 -ml-3",children:[u.jsx(de,{name:"chevron-left"}),u.jsx("span",{children:"Back to Series"})]}):c=u.jsxs(Se,{variant:"ghost",onClick:()=>i("/decks"),className:"flex items-center space-x-2 -ml-3",children:[u.jsx(de,{name:"chevron-left"}),u.jsx("span",{children:"All Decks"})]})}else f.startsWith("/series/")?c=u.jsxs(Se,{variant:"ghost",onClick:()=>i("/series"),className:"flex items-center space-x-2 -ml-3",children:[u.jsx(de,{name:"chevron-left"}),u.jsx("span",{children:"All Series"})]}):f==="/study/general"||["/settings","/instructions/json","/archive","/trash","/decks","/series","/progress"].includes(f)?c=u.jsxs(Se,{variant:"ghost",onClick:()=>i("/"),className:"flex items-center space-x-2 -ml-3",children:[u.jsx(de,{name:"chevron-left"}),m]}):c=u.jsx(Ot,{href:"/",className:"no-underline",children:u.jsx("h1",{className:"text-2xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-blue-400 to-teal-300",children:"CogniFlow"})});return u.jsx("header",{className:"bg-surface/80 backdrop-blur-sm sticky top-0 z-20 border-b border-border",children:u.jsxs("nav",{className:"container mx-auto px-4 sm:px-6 lg:px-8 flex items-center justify-between h-16",children:[u.jsx("div",{className:"flex items-center flex-1 min-w-0",children:c}),u.jsxs("div",{className:"flex items-center space-x-1",children:[u.jsx(Se,{variant:"ghost",onClick:e,className:"p-1 h-auto","aria-label":"Open command palette",children:u.jsx(de,{name:"search"})}),u.jsx(Se,{variant:"ghost",onClick:t,className:"p-1 h-auto","aria-label":"Open menu",children:u.jsx(de,{name:"menu"})})]})]})})},Ip=({html:t,className:e})=>{const n=`html-container-${hi.useId()}`;return hi.useEffect(()=>{const o=document.getElementById(n);if(!o)return;const i=Array.from(o.getElementsByTagName("script")),c=[];return i.forEach(f=>{const m=document.createElement("script");Array.from(f.attributes).forEach(h=>{m.setAttribute(h.name,h.value)}),m.text=f.text,document.body.appendChild(m),c.push(m)}),()=>{c.forEach(f=>document.body.removeChild(f))}},[t,n]),u.jsx("div",{id:n,className:e,dangerouslySetInnerHTML:{__html:t}})},ao=({level:t})=>{const e=Math.round(t*100);let n="bg-red-500",o="Novice";return e>85?(n="bg-green-500",o="Mastered"):e>65?(n="bg-teal-500",o="Proficient"):e>40?(n="bg-blue-500",o="Familiar"):e>15&&(n="bg-orange-500",o="Learning"),u.jsxs("div",{className:"w-full",children:[u.jsxs("div",{className:"flex justify-between mb-1 text-xs",children:[u.jsxs("span",{className:"font-semibold text-gray-600 dark:text-gray-300",children:["Mastery: ",o]}),u.jsxs("span",{className:"font-semibold text-gray-500 dark:text-gray-400",children:[e,"%"]})]}),u.jsx("div",{className:"w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2",children:u.jsx("div",{className:`${n} h-2 rounded-full transition-all duration-500`,style:{width:`${e}%`},role:"progressbar","aria-valuenow":e,"aria-valuemin":0,"aria-valuemax":100,"aria-label":`Mastery level: ${o}, ${e}%`})})]})},q_=({card:t,isFlipped:e})=>{const n="text-xl text-left text-text break-words prose dark:prose-invert max-w-none prose-img:mx-auto prose-img:max-h-64 prose-audio:mx-auto",o=sr(t);return u.jsxs("div",{className:"w-full bg-surface rounded-lg shadow-lg border border-border",children:[t.css&&u.jsx("div",{dangerouslySetInnerHTML:{__html:t.css}}),u.jsx("div",{className:"p-6 md:p-8 min-h-[12rem] flex items-center justify-center",children:u.jsx(Ip,{html:t.front,className:n})}),e&&u.jsxs("div",{className:"animate-fade-in",style:{animationDuration:"400ms"},children:[u.jsx("hr",{className:"border-border/50"}),u.jsxs("div",{className:"p-6 md:p-8 bg-background/30 dark:bg-black/10",children:[u.jsx(Ip,{html:t.back,className:n}),u.jsx("div",{className:"mt-6 pt-6 border-t border-border/50",children:u.jsx(ao,{level:o})})]})]})]})},z_=({question:t,selectedAnswerId:e,onSelectAnswer:n,deckName:o})=>{const i=e!==null,[c,f]=B.useState(!1),[m,h]=B.useState(null),[p,v]=B.useState(!1),x=B.useMemo(()=>{const b=[...t.options];for(let T=b.length-1;T>0;T--){const A=Math.floor(Math.random()*(T+1));[b[T],b[A]]=[b[A],b[T]]}return b},[t.id]),C=b=>{let T="flex items-start text-left w-full p-4 rounded-lg border-2 transition-all duration-200";if(i){const A=b.id===t.correctAnswerId,D=b.id===e;return A?`${T} bg-green-500/10 border-green-500 cursor-default`:D?`${T} bg-red-500/10 border-red-500 cursor-default`:`${T} bg-surface/50 border-border opacity-60 cursor-default`}return`${T} bg-surface border-border hover:border-primary hover:bg-border/20`},S=sr(t);return u.jsxs("div",{className:"bg-surface/50 rounded-lg p-6 w-full border border-border",children:[o&&u.jsxs("div",{className:"mb-3 text-xs text-text-muted font-medium tracking-wider uppercase",children:["From: ",o]}),u.jsx("p",{className:"text-lg md:text-xl font-semibold mb-6 text-text break-words",children:t.questionText}),u.jsx("div",{className:"space-y-3",children:x.map(b=>{const T=b.id===t.correctAnswerId,A=b.id===e;return u.jsxs("button",{onClick:()=>n(b.id),disabled:i,className:C(b),"aria-pressed":A,children:[u.jsxs("div",{className:"flex-shrink-0 w-6 h-6 mr-4 mt-1",children:[i&&T&&u.jsx(de,{name:"check-circle",className:"text-green-500"}),i&&A&&!T&&u.jsx(de,{name:"x-circle",className:"text-red-500"})]}),u.jsxs("div",{className:"flex-grow min-w-0",children:[u.jsx("span",{className:"text-text break-words",children:b.text}),i&&b.explanation&&u.jsx("p",{className:"text-sm text-text-muted mt-1 break-words",children:b.explanation})]})]},b.id)})}),i&&u.jsxs("div",{className:"mt-8 p-4 bg-background rounded-lg animate-fade-in space-y-4 border border-border",children:[u.jsxs("div",{children:[u.jsx("h4",{className:"font-bold text-lg text-primary mb-2",children:"Detailed Explanation"}),u.jsx("p",{className:"text-text-muted whitespace-pre-wrap",children:t.detailedExplanation})]}),u.jsx("div",{className:"pt-4 border-t border-border/50",children:u.jsx(ao,{level:S})})]})]})},Mc=({current:t,total:e})=>{const n=e>0?t/e*100:0;return u.jsx("div",{className:"w-full bg-border/30 rounded-full h-2.5",children:u.jsx("div",{className:"bg-primary h-2.5 rounded-full transition-all duration-500",style:{width:`${n}%`}})})};var wi={};(function t(e,n,o,i){var c=!!(e.Worker&&e.Blob&&e.Promise&&e.OffscreenCanvas&&e.OffscreenCanvasRenderingContext2D&&e.HTMLCanvasElement&&e.HTMLCanvasElement.prototype.transferControlToOffscreen&&e.URL&&e.URL.createObjectURL),f=typeof Path2D=="function"&&typeof DOMMatrix=="function",m=function(){if(!e.OffscreenCanvas)return!1;var q=new OffscreenCanvas(1,1),N=q.getContext("2d");N.fillRect(0,0,1,1);var j=q.transferToImageBitmap();try{N.createPattern(j,"no-repeat")}catch{return!1}return!0}();function h(){}function p(q){var N=n.exports.Promise,j=N!==void 0?N:e.Promise;return typeof j=="function"?new j(q):(q(h,h),null)}var v=function(q,N){return{transform:function(j){if(q)return j;if(N.has(j))return N.get(j);var O=new OffscreenCanvas(j.width,j.height),V=O.getContext("2d");return V.drawImage(j,0,0),N.set(j,O),O},clear:function(){N.clear()}}}(m,new Map),x=function(){var q=Math.floor(16.666666666666668),N,j,O={},V=0;return typeof requestAnimationFrame=="function"&&typeof cancelAnimationFrame=="function"?(N=function(K){var X=Math.random();return O[X]=requestAnimationFrame(function se(ae){V===ae||V+q-1<ae?(V=ae,delete O[X],K()):O[X]=requestAnimationFrame(se)}),X},j=function(K){O[K]&&cancelAnimationFrame(O[K])}):(N=function(K){return setTimeout(K,q)},j=function(K){return clearTimeout(K)}),{frame:N,cancel:j}}(),C=function(){var q,N,j={};function O(V){function K(X,se){V.postMessage({options:X||{},callback:se})}V.init=function(se){var ae=se.transferControlToOffscreen();V.postMessage({canvas:ae},[ae])},V.fire=function(se,ae,ke){if(N)return K(se,null),N;var Ae=Math.random().toString(36).slice(2);return N=p(function(Ne){function je(De){De.data.callback===Ae&&(delete j[Ae],V.removeEventListener("message",je),N=null,v.clear(),ke(),Ne())}V.addEventListener("message",je),K(se,Ae),j[Ae]=je.bind(null,{data:{callback:Ae}})}),N},V.reset=function(){V.postMessage({reset:!0});for(var se in j)j[se](),delete j[se]}}return function(){if(q)return q;if(!o&&c){var V=["var CONFETTI, SIZE = {}, module = {};","("+t.toString()+")(this, module, true, SIZE);","onmessage = function(msg) {","  if (msg.data.options) {","    CONFETTI(msg.data.options).then(function () {","      if (msg.data.callback) {","        postMessage({ callback: msg.data.callback });","      }","    });","  } else if (msg.data.reset) {","    CONFETTI && CONFETTI.reset();","  } else if (msg.data.resize) {","    SIZE.width = msg.data.resize.width;","    SIZE.height = msg.data.resize.height;","  } else if (msg.data.canvas) {","    SIZE.width = msg.data.canvas.width;","    SIZE.height = msg.data.canvas.height;","    CONFETTI = module.exports.create(msg.data.canvas);","  }","}"].join(`
`);try{q=new Worker(URL.createObjectURL(new Blob([V])))}catch(K){return typeof console!==void 0&&typeof console.warn=="function"&&console.warn("🎊 Could not load worker",K),null}O(q)}return q}}(),S={particleCount:50,angle:90,spread:45,startVelocity:45,decay:.9,gravity:1,drift:0,ticks:200,x:.5,y:.5,shapes:["square","circle"],zIndex:100,colors:["#26ccff","#a25afd","#ff5e7e","#88ff5a","#fcff42","#ffa62d","#ff36ff"],disableForReducedMotion:!1,scalar:1};function b(q,N){return N?N(q):q}function T(q){return q!=null}function A(q,N,j){return b(q&&T(q[N])?q[N]:S[N],j)}function D(q){return q<0?0:Math.floor(q)}function F(q,N){return Math.floor(Math.random()*(N-q))+q}function L(q){return parseInt(q,16)}function R(q){return q.map(P)}function P(q){var N=String(q).replace(/[^0-9a-f]/gi,"");return N.length<6&&(N=N[0]+N[0]+N[1]+N[1]+N[2]+N[2]),{r:L(N.substring(0,2)),g:L(N.substring(2,4)),b:L(N.substring(4,6))}}function G(q){var N=A(q,"origin",Object);return N.x=A(N,"x",Number),N.y=A(N,"y",Number),N}function $(q){q.width=document.documentElement.clientWidth,q.height=document.documentElement.clientHeight}function oe(q){var N=q.getBoundingClientRect();q.width=N.width,q.height=N.height}function J(q){var N=document.createElement("canvas");return N.style.position="fixed",N.style.top="0px",N.style.left="0px",N.style.pointerEvents="none",N.style.zIndex=q,N}function Z(q,N,j,O,V,K,X,se,ae){q.save(),q.translate(N,j),q.rotate(K),q.scale(O,V),q.arc(0,0,1,X,se,ae),q.restore()}function le(q){var N=q.angle*(Math.PI/180),j=q.spread*(Math.PI/180);return{x:q.x,y:q.y,wobble:Math.random()*10,wobbleSpeed:Math.min(.11,Math.random()*.1+.05),velocity:q.startVelocity*.5+Math.random()*q.startVelocity,angle2D:-N+(.5*j-Math.random()*j),tiltAngle:(Math.random()*(.75-.25)+.25)*Math.PI,color:q.color,shape:q.shape,tick:0,totalTicks:q.ticks,decay:q.decay,drift:q.drift,random:Math.random()+2,tiltSin:0,tiltCos:0,wobbleX:0,wobbleY:0,gravity:q.gravity*3,ovalScalar:.6,scalar:q.scalar,flat:q.flat}}function Q(q,N){N.x+=Math.cos(N.angle2D)*N.velocity+N.drift,N.y+=Math.sin(N.angle2D)*N.velocity+N.gravity,N.velocity*=N.decay,N.flat?(N.wobble=0,N.wobbleX=N.x+10*N.scalar,N.wobbleY=N.y+10*N.scalar,N.tiltSin=0,N.tiltCos=0,N.random=1):(N.wobble+=N.wobbleSpeed,N.wobbleX=N.x+10*N.scalar*Math.cos(N.wobble),N.wobbleY=N.y+10*N.scalar*Math.sin(N.wobble),N.tiltAngle+=.1,N.tiltSin=Math.sin(N.tiltAngle),N.tiltCos=Math.cos(N.tiltAngle),N.random=Math.random()+2);var j=N.tick++/N.totalTicks,O=N.x+N.random*N.tiltCos,V=N.y+N.random*N.tiltSin,K=N.wobbleX+N.random*N.tiltCos,X=N.wobbleY+N.random*N.tiltSin;if(q.fillStyle="rgba("+N.color.r+", "+N.color.g+", "+N.color.b+", "+(1-j)+")",q.beginPath(),f&&N.shape.type==="path"&&typeof N.shape.path=="string"&&Array.isArray(N.shape.matrix))q.fill(ve(N.shape.path,N.shape.matrix,N.x,N.y,Math.abs(K-O)*.1,Math.abs(X-V)*.1,Math.PI/10*N.wobble));else if(N.shape.type==="bitmap"){var se=Math.PI/10*N.wobble,ae=Math.abs(K-O)*.1,ke=Math.abs(X-V)*.1,Ae=N.shape.bitmap.width*N.scalar,Ne=N.shape.bitmap.height*N.scalar,je=new DOMMatrix([Math.cos(se)*ae,Math.sin(se)*ae,-Math.sin(se)*ke,Math.cos(se)*ke,N.x,N.y]);je.multiplySelf(new DOMMatrix(N.shape.matrix));var De=q.createPattern(v.transform(N.shape.bitmap),"no-repeat");De.setTransform(je),q.globalAlpha=1-j,q.fillStyle=De,q.fillRect(N.x-Ae/2,N.y-Ne/2,Ae,Ne),q.globalAlpha=1}else if(N.shape==="circle")q.ellipse?q.ellipse(N.x,N.y,Math.abs(K-O)*N.ovalScalar,Math.abs(X-V)*N.ovalScalar,Math.PI/10*N.wobble,0,2*Math.PI):Z(q,N.x,N.y,Math.abs(K-O)*N.ovalScalar,Math.abs(X-V)*N.ovalScalar,Math.PI/10*N.wobble,0,2*Math.PI);else if(N.shape==="star")for(var E=Math.PI/2*3,fe=4*N.scalar,ce=8*N.scalar,W=N.x,H=N.y,re=5,Te=Math.PI/re;re--;)W=N.x+Math.cos(E)*ce,H=N.y+Math.sin(E)*ce,q.lineTo(W,H),E+=Te,W=N.x+Math.cos(E)*fe,H=N.y+Math.sin(E)*fe,q.lineTo(W,H),E+=Te;else q.moveTo(Math.floor(N.x),Math.floor(N.y)),q.lineTo(Math.floor(N.wobbleX),Math.floor(V)),q.lineTo(Math.floor(K),Math.floor(X)),q.lineTo(Math.floor(O),Math.floor(N.wobbleY));return q.closePath(),q.fill(),N.tick<N.totalTicks}function Y(q,N,j,O,V){var K=N.slice(),X=q.getContext("2d"),se,ae,ke=p(function(Ae){function Ne(){se=ae=null,X.clearRect(0,0,O.width,O.height),v.clear(),V(),Ae()}function je(){o&&!(O.width===i.width&&O.height===i.height)&&(O.width=q.width=i.width,O.height=q.height=i.height),!O.width&&!O.height&&(j(q),O.width=q.width,O.height=q.height),X.clearRect(0,0,O.width,O.height),K=K.filter(function(De){return Q(X,De)}),K.length?se=x.frame(je):Ne()}se=x.frame(je),ae=Ne});return{addFettis:function(Ae){return K=K.concat(Ae),ke},canvas:q,promise:ke,reset:function(){se&&x.cancel(se),ae&&ae()}}}function M(q,N){var j=!q,O=!!A(N||{},"resize"),V=!1,K=A(N,"disableForReducedMotion",Boolean),X=c&&!!A(N||{},"useWorker"),se=X?C():null,ae=j?$:oe,ke=q&&se?!!q.__confetti_initialized:!1,Ae=typeof matchMedia=="function"&&matchMedia("(prefers-reduced-motion)").matches,Ne;function je(E,fe,ce){for(var W=A(E,"particleCount",D),H=A(E,"angle",Number),re=A(E,"spread",Number),Te=A(E,"startVelocity",Number),_e=A(E,"decay",Number),me=A(E,"gravity",Number),Le=A(E,"drift",Number),Oe=A(E,"colors",R),Fe=A(E,"ticks",Number),Ve=A(E,"shapes"),at=A(E,"scalar"),et=!!A(E,"flat"),Nt=G(E),kt=W,pt=[],Qt=q.width*Nt.x,Ct=q.height*Nt.y;kt--;)pt.push(le({x:Qt,y:Ct,angle:H,spread:re,startVelocity:Te,color:Oe[kt%Oe.length],shape:Ve[F(0,Ve.length)],ticks:Fe,decay:_e,gravity:me,drift:Le,scalar:at,flat:et}));return Ne?Ne.addFettis(pt):(Ne=Y(q,pt,ae,fe,ce),Ne.promise)}function De(E){var fe=K||A(E,"disableForReducedMotion",Boolean),ce=A(E,"zIndex",Number);if(fe&&Ae)return p(function(Te){Te()});j&&Ne?q=Ne.canvas:j&&!q&&(q=J(ce),document.body.appendChild(q)),O&&!ke&&ae(q);var W={width:q.width,height:q.height};se&&!ke&&se.init(q),ke=!0,se&&(q.__confetti_initialized=!0);function H(){if(se){var Te={getBoundingClientRect:function(){if(!j)return q.getBoundingClientRect()}};ae(Te),se.postMessage({resize:{width:Te.width,height:Te.height}});return}W.width=W.height=null}function re(){Ne=null,O&&(V=!1,e.removeEventListener("resize",H)),j&&q&&(document.body.contains(q)&&document.body.removeChild(q),q=null,ke=!1)}return O&&!V&&(V=!0,e.addEventListener("resize",H,!1)),se?se.fire(E,W,re):je(E,W,re)}return De.reset=function(){se&&se.reset(),Ne&&Ne.reset()},De}var pe;function be(){return pe||(pe=M(null,{useWorker:!0,resize:!0})),pe}function ve(q,N,j,O,V,K,X){var se=new Path2D(q),ae=new Path2D;ae.addPath(se,new DOMMatrix(N));var ke=new Path2D;return ke.addPath(ae,new DOMMatrix([Math.cos(X)*V,Math.sin(X)*V,-Math.sin(X)*K,Math.cos(X)*K,j,O])),ke}function xe(q){if(!f)throw new Error("path confetti are not supported in this browser");var N,j;typeof q=="string"?N=q:(N=q.path,j=q.matrix);var O=new Path2D(N),V=document.createElement("canvas"),K=V.getContext("2d");if(!j){for(var X=1e3,se=X,ae=X,ke=0,Ae=0,Ne,je,De=0;De<X;De+=2)for(var E=0;E<X;E+=2)K.isPointInPath(O,De,E,"nonzero")&&(se=Math.min(se,De),ae=Math.min(ae,E),ke=Math.max(ke,De),Ae=Math.max(Ae,E));Ne=ke-se,je=Ae-ae;var fe=10,ce=Math.min(fe/Ne,fe/je);j=[ce,0,0,ce,-Math.round(Ne/2+se)*ce,-Math.round(je/2+ae)*ce]}return{type:"path",path:N,matrix:j}}function te(q){var N,j=1,O="#000000",V='"Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji", "EmojiOne Color", "Android Emoji", "Twemoji Mozilla", "system emoji", sans-serif';typeof q=="string"?N=q:(N=q.text,j="scalar"in q?q.scalar:j,V="fontFamily"in q?q.fontFamily:V,O="color"in q?q.color:O);var K=10*j,X=""+K+"px "+V,se=new OffscreenCanvas(K,K),ae=se.getContext("2d");ae.font=X;var ke=ae.measureText(N),Ae=Math.ceil(ke.actualBoundingBoxRight+ke.actualBoundingBoxLeft),Ne=Math.ceil(ke.actualBoundingBoxAscent+ke.actualBoundingBoxDescent),je=2,De=ke.actualBoundingBoxLeft+je,E=ke.actualBoundingBoxAscent+je;Ae+=je+je,Ne+=je+je,se=new OffscreenCanvas(Ae,Ne),ae=se.getContext("2d"),ae.font=X,ae.fillStyle=O,ae.fillText(N,De,E);var fe=1/j;return{type:"bitmap",bitmap:se.transferToImageBitmap(),matrix:[fe,0,0,fe,-Ae*fe/2,-Ne*fe/2]}}n.exports=function(){return be().apply(this,arguments)},n.exports.reset=function(){be().reset()},n.exports.create=M,n.exports.shapeFromPath=xe,n.exports.shapeFromText=te})(function(){return typeof window<"u"?window:typeof self<"u"?self:this||{}}(),wi,!1);const Xu=wi.exports;wi.exports.create;const Ap=()=>(B.useEffect(()=>{const e=Date.now()+1e3,o={startVelocity:30,spread:360,ticks:90,zIndex:99,colors:["#60a5fa","#5eead4","#a78bfa","#fde047","#f9fafb"]};function i(f,m){return Math.random()*(m-f)+f}const c=window.setInterval(()=>{const f=e-Date.now();if(f<=0)return clearInterval(c);const m=50*(f/1e3);Xu({...o,particleCount:m,origin:{x:i(.1,.3),y:Math.random()-.2}}),Xu({...o,particleCount:m,origin:{x:i(.7,.9),y:Math.random()-.2}})},250);return()=>{clearInterval(c),Xu.reset()}},[]),null),Dp=t=>{const e=Math.round(t*100);return e>85?"Mastered":e>65?"Proficient":e>40?"Familiar":e>15?"Learning":"Novice"},di=({deck:t,onSessionEnd:e,onItemReviewed:n,onUpdateLastOpened:o,sessionKeySuffix:i="",seriesId:c})=>{const[f,m]=B.useState([]),[h,p]=B.useState([]),[v,x]=B.useState(0),[C,S]=B.useState(0),[b,T]=B.useState(!1),[A,D]=B.useState(null),[F,L]=B.useState(!1),[R,P]=B.useState(!1),{hapticsEnabled:G}=Vo(),{addToast:$}=gn(),oe=B.useMemo(()=>t.id==="general-study-deck",[t.id]),J=`session_deck_${t.id}${i}`,Z=B.useMemo(()=>({reviewQueue:f,currentIndex:v}),[f,v]);B.useEffect(()=>{o(t.id)},[t.id]),B.useEffect(()=>{(async()=>{const X=oe||i==="_cram"||i==="_flip";if(F&&!X)return;if(X){const ae=t.type===We.Flashcard?t.cards:t.questions;m(ae),x(0),S(0),L(!0);return}let se=!1;try{const ae=await Xg(J);ae&&ae.reviewQueue&&ae.reviewQueue.length>0&&typeof ae.currentIndex=="number"?(m(ae.reviewQueue),x(ae.currentIndex),S(ae.currentIndex),se=!0):ae&&await sc(J)}catch(ae){console.error("Failed to load saved session from DB",ae)}if(!se){const ae=new Date;ae.setHours(23,59,59,999);const Ae=(t.type===We.Quiz?t.questions:t.cards).filter(Ne=>!Ne.suspended&&new Date(Ne.dueDate)<=ae).sort(()=>Math.random()-.5);m(Ae),x(0),S(0)}L(!0)})()},[t,t.type,i,oe,J,F]),B.useEffect(()=>{(async()=>{if(!oe&&i===""&&F&&v<f.length)try{await Zg(J,Z)}catch(se){console.error("Could not save session state to DB",se),$("Could not save session progress. It may be lost on refresh.","error")}})()},[Z,oe,F,J,v,f.length,i,$]);const le=B.useMemo(()=>f[C],[f,C]),Q=C<v,Y=C===v,M=le&&"questionText"in le&&t.type===We.Quiz,pe=A!==null,be=le?le.originalDeckName:void 0,ve=B.useCallback(K=>{if(!(!Y||pe)&&(D(K),G&&"vibrate"in navigator)){const X=(le==null?void 0:le.correctAnswerId)===K;navigator.vibrate(X?50:[100,50,100])}},[Y,pe,le,G]),xe=B.useCallback(()=>{T(!1),D(null);const K=v+1;K<=f.length&&(x(K),S(K)),K>=f.length&&!oe&&i===""&&sc(J).catch(se=>console.error("Failed to delete session state",se))},[v,f.length,oe,J,i]),te=B.useCallback(async K=>{if(!le||!Y||R)return;if(i==="_cram"){P(!0),xe(),P(!1);return}P(!0),G&&"vibrate"in navigator&&navigator.vibrate(20);const se=sr(le);let ae=Vy(le,K);const ke=ae.masteryLevel||0;(ae.lapses||0)>=8&&!le.suspended&&(ae={...ae,suspended:!0},$("This item is proving difficult. It has been automatically suspended to let you focus on other material.","info"));const Ae=Math.round(se*100),Ne=Math.round(ke*100);Ae<=85&&Ne>85&&$("Item Mastered!","success"),p(je=>[...je,{oldItem:le,newItem:ae,rating:K}]);try{const je=le.originalDeckId||t.id;await n(je,ae,K,c)}catch(je){console.error("Failed to save review:",je),$("Failed to save review. Your progress for this card may not be saved.","error")}finally{m(je=>je.map((De,E)=>E===v?ae:De)),setTimeout(()=>{xe(),P(!1)},800)}},[le,Y,R,G,xe,t.id,n,$,c,v,i]),q=B.useCallback(async()=>{if(!le||!Y||R)return;P(!0);const K={...le,suspended:!0};p(X=>[...X,{oldItem:le,newItem:K,rating:null}]);try{const X=le.originalDeckId||t.id;await n(X,K,null,c),$("Card suspended for future sessions.","info")}catch(X){console.error("Failed to suspend card:",X),$("Failed to save suspended state. Please try again.","error")}finally{setTimeout(()=>{xe(),P(!1)},300)}},[le,Y,R,$,xe,t.id,n,c]),N=B.useCallback(()=>{C>0&&S(K=>K-1)},[C]),j=B.useCallback(()=>{C<v&&S(K=>K+1)},[C,v]);if(B.useEffect(()=>{const K=X=>{if(!(X.target instanceof HTMLInputElement||X.target instanceof HTMLTextAreaElement)){if(X.key==="ArrowLeft"){C>0&&(X.preventDefault(),N());return}if(X.key==="ArrowRight"){C<v&&(X.preventDefault(),j());return}!Y||R||(M&&pe?(X.key==="1"&&te(ft.Again),X.key==="2"&&te(ft.Hard),X.key==="3"&&te(ft.Good),X.key==="4"&&te(ft.Easy)):M||(b?(X.key==="1"&&te(ft.Again),X.key==="2"&&te(ft.Hard),X.key==="3"&&te(ft.Good),X.key==="4"&&te(ft.Easy)):X.code==="Space"&&(X.preventDefault(),T(!0))))}};return window.addEventListener("keydown",K),()=>window.removeEventListener("keydown",K)},[b,pe,M,Y,R,te,N,j,C,v]),!F)return u.jsx("div",{className:"text-center p-8",children:u.jsx("p",{className:"text-text-muted",children:"Initializing session..."})});if(f.length===0)return u.jsxs("div",{className:"text-center p-8",children:[u.jsx("h2",{className:"text-2xl font-bold",children:"All caught up!"}),u.jsx("p",{className:"text-text-muted mt-2",children:oe?"There are no quiz questions due for review across all your decks.":"There are no items due for review in this deck."}),u.jsx(Se,{onClick:()=>e(t.id,c),className:"mt-6",children:"Back to Decks"})]});if(v>=f.length){if(i==="_cram")return u.jsxs("div",{className:"text-center p-8 animate-fade-in relative",children:[u.jsx(Ap,{}),u.jsx("h2",{className:"text-2xl font-bold text-green-500",children:"Cram Session Complete!"}),u.jsxs("p",{className:"text-text-muted mt-2",children:["You've reviewed all ",f.length," items in this deck."]}),u.jsx(Se,{onClick:()=>e(t.id,c),className:"mt-8",children:"Finish Session"})]});const K=new Date;K.setHours(0,0,0,0);const X=new Date(K);X.setDate(K.getDate()+1);const se=new Date(K);se.setDate(K.getDate()+7);let ae=0,ke=0;h.forEach(({newItem:E})=>{if(E.suspended)return;const fe=new Date(E.dueDate);fe.getTime()>K.getTime()&&fe.getTime()<=X.getTime()&&ae++,fe.getTime()>X.getTime()&&fe.getTime()<=se.getTime()&&ke++});const Ae={};h.forEach(({oldItem:E,newItem:fe,rating:ce})=>{if(ce!==null){const W=sr(E),H=fe.masteryLevel||0,re=Dp(W),Te=Dp(H);if(re!==Te){const _e=`${re} → ${Te}`;Ae[_e]=(Ae[_e]||0)+1}}});const Ne=Object.entries(Ae).sort(([,E],[,fe])=>fe-E),je=Math.max(...Object.values(Ae),1),De=h.filter(E=>E.rating===ft.Again||E.rating===ft.Hard).sort((E,fe)=>(E.rating??5)-(fe.rating??5)).slice(0,5).map(E=>E.newItem);return u.jsxs("div",{className:"text-center p-8 animate-fade-in relative",children:[u.jsx(Ap,{}),u.jsx("h2",{className:"text-2xl font-bold text-green-500",children:"Congratulations!"}),u.jsx("p",{className:"text-text-muted mt-2",children:"You've completed this study session."}),u.jsxs("div",{className:"mt-6 bg-surface rounded-lg p-4 max-w-sm mx-auto space-y-2 border border-border",children:[u.jsxs("div",{className:"flex justify-between items-center text-text",children:[u.jsx("span",{children:"Due tomorrow:"}),u.jsxs("span",{className:"font-bold",children:[ae," items"]})]}),u.jsxs("div",{className:"flex justify-between items-center text-text",children:[u.jsx("span",{children:"Due in the next 7 days:"}),u.jsxs("span",{className:"font-bold",children:[ke," items"]})]})]}),Ne.length>0&&u.jsxs("div",{className:"mt-6 bg-surface rounded-lg p-4 max-w-sm mx-auto space-y-3 border border-border",children:[u.jsxs("h4",{className:"font-bold text-text text-left flex items-center gap-2",children:[u.jsx(de,{name:"trending-up",className:"w-5 h-5"}),"Session Impact"]}),u.jsx("ul",{className:"text-left text-sm space-y-3",children:Ne.map(([E,fe])=>u.jsxs("li",{children:[u.jsxs("div",{className:"flex justify-between items-center mb-1 text-xs text-text-muted",children:[u.jsx("span",{className:"font-medium",children:E}),u.jsxs("span",{className:"font-semibold",children:[fe," item",fe>1?"s":""]})]}),u.jsx("div",{className:"w-full bg-border/30 rounded-full h-2",children:u.jsx("div",{className:"bg-primary h-2 rounded-full transition-all duration-500",style:{width:`${fe/je*100}%`}})})]},E))})]}),De.length>0&&u.jsxs("div",{className:"mt-6 bg-orange-500/10 rounded-lg p-4 max-w-sm mx-auto space-y-3 border border-orange-500/20",children:[u.jsxs("h4",{className:"font-bold text-orange-800 dark:text-orange-200 text-left flex items-center gap-2",children:[u.jsx(de,{name:"zap",className:"w-5 h-5"}),"Challenging Items"]}),u.jsx("ul",{className:"text-left text-sm space-y-2",children:De.map(E=>{const fe="questionText"in E,ce=(fe?E.questionText:E.front).replace(/<[^>]+>/g,"").trim();let W;if(fe){const H=E,re=H.options.find(Te=>Te.id===H.correctAnswerId);W=((re==null?void 0:re.text)??"N/A").replace(/<[^>]+>/g,"").trim()}else W=E.back.replace(/<[^>]+>/g,"").trim();return u.jsxs("li",{className:"text-orange-700 dark:text-orange-300 border-l-2 border-orange-400 pl-3",children:[u.jsx("p",{className:"font-semibold break-words",children:ce}),u.jsxs("p",{className:"text-sm opacity-80 pl-2 break-words",children:[u.jsx("span",{className:"font-semibold mr-1",children:"Answer:"})," ",W]})]},E.id)})})]}),u.jsx(Se,{onClick:()=>e(t.id,c),className:"mt-8",children:"Finish Session"})]})}const O=(b||pe)&&Y,V=f.length>1;return u.jsxs("div",{className:"w-full max-w-3xl mx-auto p-4 flex flex-col h-full overflow-x-hidden",children:[u.jsx(Mc,{current:v+1,total:f.length}),u.jsx("div",{className:"flex-grow flex flex-col items-center justify-center my-4 w-full",children:le&&u.jsx("div",{className:"w-full relative animate-fade-in",children:M?u.jsx(z_,{question:le,selectedAnswerId:Q?le.correctAnswerId:A,onSelectAnswer:ve,deckName:be}):u.jsx(q_,{card:le,isFlipped:b||Q})},C)}),u.jsxs("div",{className:"flex-shrink-0 mt-4 flex flex-col items-center justify-center space-y-4 min-h-[10rem]",children:[u.jsx("div",{className:"w-full flex-grow flex items-center justify-center",children:Q?u.jsxs("div",{className:"text-center animate-fade-in",children:[u.jsx(Se,{onClick:()=>S(v),variant:"primary",className:"text-lg py-3",children:"Return to Current Card"}),u.jsx("div",{className:"text-xs mt-2 font-semibold text-yellow-600 dark:text-yellow-400",children:"(Reviewing Past Item)"})]}):O?u.jsxs("div",{className:"space-y-4 animate-fade-in w-full",children:[u.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[u.jsxs(Se,{onClick:()=>te(ft.Again),className:"bg-red-600 hover:bg-red-700 focus:ring-red-500 py-3 text-base text-white",disabled:R,children:["Again ",u.jsx("span",{className:"hidden sm:inline",children:"(1)"})]}),u.jsxs(Se,{onClick:()=>te(ft.Hard),className:"bg-orange-500 hover:bg-orange-600 focus:ring-orange-400 py-3 text-base text-white",disabled:R,children:["Hard ",u.jsx("span",{className:"hidden sm:inline",children:"(2)"})]}),u.jsxs(Se,{onClick:()=>te(ft.Good),className:"bg-green-600 hover:bg-green-700 focus:ring-green-500 py-3 text-base text-white",disabled:R,children:["Good ",u.jsx("span",{className:"hidden sm:inline",children:"(3)"})]}),u.jsxs(Se,{onClick:()=>te(ft.Easy),className:"bg-blue-600 hover:bg-blue-700 focus:ring-blue-500 py-3 text-base text-white",disabled:R,children:["Easy ",u.jsx("span",{className:"hidden sm:inline",children:"(4)"})]})]}),i!=="_cram"&&u.jsx("div",{className:"text-center",children:u.jsxs(Se,{variant:"ghost",onClick:q,className:"text-xs",disabled:R,children:[u.jsx(de,{name:"eye-off",className:"w-4 h-4 mr-1"})," Suspend this card"]})})]}):!M&&Y&&u.jsxs(Se,{onClick:()=>T(!0),variant:"primary",className:"w-full max-w-md text-lg py-3 animate-fade-in mx-auto flex items-center justify-center",children:["Show Answer ",u.jsx("span",{className:"hidden sm:inline ml-2",children:"(Space)"})]})}),V&&u.jsxs("div",{className:"flex justify-center items-center w-full max-w-xs gap-4 animate-fade-in h-12",children:[u.jsx(Se,{variant:"ghost",onClick:N,disabled:C===0,className:"p-3 rounded-full disabled:opacity-30","aria-label":"Previous item",children:u.jsx(de,{name:"chevron-left",className:"w-8 h-8"})}),u.jsx("div",{className:"text-center w-28",children:u.jsxs("span",{className:"text-sm text-text-muted",children:["Item ",C+1," of ",f.length]})}),u.jsx(Se,{variant:"ghost",onClick:j,disabled:C>=v,className:"p-3 rounded-full disabled:opacity-30","aria-label":"Next item",children:u.jsx(de,{name:"chevron-left",className:"w-8 h-8 rotate-180"})})]})]})]})},ec=({label:t,checked:e,onChange:n,description:o})=>{const i=hi.useId();return u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs("span",{className:"flex flex-col",children:[u.jsx("label",{htmlFor:i,className:"font-medium text-text cursor-pointer",children:t}),o&&u.jsx("span",{id:`${i}-description`,className:"text-sm text-text-muted",children:o})]}),u.jsx("button",{id:i,type:"button",role:"switch","aria-checked":e,"aria-describedby":o?`${i}-description`:void 0,onClick:()=>n(!e),className:`${e?"bg-primary":"bg-border"} relative inline-flex h-6 w-11 flex-shrink-0 cursor-pointer rounded-full border-2 border-transparent transition-colors duration-200 ease-in-out focus:outline-none focus:ring-2 focus:ring-primary focus:ring-offset-2 dark:focus:ring-offset-surface`,children:u.jsx("span",{"aria-hidden":"true",className:`${e?"translate-x-5":"translate-x-0"} pointer-events-none inline-block h-5 w-5 transform rounded-full bg-white shadow ring-0 transition duration-200 ease-in-out`})})]})},O_="AIzaSyCxQD2rTQvfarBU5QQLwjHdRTJ-jq3GFMY",B_="727276393482-almsrnelboiul2343hvs643ok8onqtna.apps.googleusercontent.com",V_="https://www.googleapis.com/discovery/v1/apis/drive/v3/rest",G_="https://www.googleapis.com/auth/drive.appdata https://www.googleapis.com/auth/userinfo.profile https://www.googleapis.com/auth/userinfo.email";let Ja=!1,Ya=!1,gi=null,Ba=[],Va=[];const wc=(t,e)=>{Ba.forEach(n=>n(t,e))},$_=t=>{Va.forEach(e=>e(t))},H_=async t=>{if(t.error){localStorage.removeItem("gdrive-previously-signed-in"),wc(!1);return}localStorage.setItem("gdrive-previously-signed-in","true"),gapi.client.setToken({access_token:t.access_token});const e=await X_(t.access_token);wc(!0,e)};let Ua=null;const W_=()=>Ua||(Ua=new Promise((t,e)=>{const n=()=>{Ja&&Ya&&($_(!0),t())},o=()=>{gapi.load("client",async()=>{try{await gapi.client.init({apiKey:O_,discoveryDocs:[V_]}),Ja=!0,n()}catch(m){console.error("Error initializing GAPI client",m),e(m)}})},i=()=>{try{gi=google.accounts.oauth2.initTokenClient({client_id:B_,scope:G_,callback:H_}),Ya=!0,n()}catch(m){console.error("Error initializing GIS client",m),e(m)}},c=document.createElement("script");c.src="https://apis.google.com/js/api.js",c.async=!0,c.defer=!0,c.onload=o,c.onerror=()=>e(new Error("Failed to load GAPI script")),document.body.appendChild(c);const f=document.createElement("script");f.src="https://accounts.google.com/gsi/client",f.async=!0,f.defer=!0,f.onload=i,f.onerror=()=>e(new Error("Failed to load GIS script")),document.body.appendChild(f)}),Ua),J_=t=>(Va.push(t),t(Ya&&Ja),()=>{Va=Va.filter(e=>e!==t)}),Y_=t=>(Ba.push(t),()=>{Ba=Ba.filter(e=>e!==t)}),Q_=()=>{if(!Ya||!Ja||!gi){console.error("Google services not ready for sign-in.");return}gi.requestAccessToken({prompt:"consent"})},K_=()=>{gi&&gi.requestAccessToken({prompt:"none"})},Z_=()=>{const t=gapi.client.getToken();gapi.client.setToken(null),localStorage.removeItem("gdrive-previously-signed-in"),wc(!1),t!==null&&google.accounts.oauth2.revoke(t.access_token,()=>{console.log("Google token revoked.")})},X_=async t=>{const e=await fetch("https://www.googleapis.com/oauth2/v2/userinfo",{headers:{Authorization:`Bearer ${t}`}});if(!e.ok)throw new Error("Failed to fetch user profile.");return e.json()},eE=async()=>{const[t,e,n]=await Promise.all([kc(),Tc(),_c()]);if(t.length===0&&e.length===0&&n.length===0)throw new Error("There is no data to back up.");const i=JSON.stringify({version:3,decks:t,folders:e,deckSeries:n}),m={name:`cogniflow-backup-${jp()}.json`,parents:["appDataFolder"]},h="-------314159265358979323846",p=`\r
--${h}\r
`,v=`\r
--${h}--`,x=p+`Content-Type: application/json; charset=UTF-8\r
\r
`+JSON.stringify(m)+p+`Content-Type: application/json; charset=UTF-8\r
\r
`+i+v,C=await gapi.client.request({path:"https://www.googleapis.com/upload/drive/v3/files",method:"POST",params:{uploadType:"multipart",fields:"id, name, modifiedTime"},headers:{"Content-Type":`multipart/related; boundary=${h}`},body:x});if(C.status!==200)throw new Error("Failed to upload backup file.");return C.result},tE=async()=>(await gapi.client.drive.files.list({spaces:"appDataFolder",fields:"files(id, name, modifiedTime)",orderBy:"modifiedTime desc"})).result.files,nE=async t=>{const e=await gapi.client.drive.files.get({fileId:t,alt:"media"});if(e.status!==200)throw new Error("Failed to download backup file.");const n=e.result;if(typeof n=="object"&&n!==null&&"version"in n&&Array.isArray(n.decks)){const o=n.folders||[],i=(Array.isArray(n.deckSeries)?n.deckSeries:[]).filter(c=>c&&typeof c.id=="string"&&typeof c.name=="string").map(c=>{if(Array.isArray(c.levels))return c.levels.forEach(f=>{Array.isArray(f.deckIds)||(f.deckIds=[])}),c;if(Array.isArray(c.deckIds)){const f={...c};return f.levels=[{title:"Decks",deckIds:f.deckIds}],delete f.deckIds,f}return{...c,levels:[]}});return{decks:n.decks,folders:o,deckSeries:i}}if(Array.isArray(n))return{decks:n.map(i=>(i.type||(Array.isArray(i.cards)?i.type=We.Flashcard:Array.isArray(i.questions)&&(i.type=We.Quiz)),i)),folders:[],deckSeries:[]};throw new Error("Backup file content is not a valid format.")},rE=async t=>{var e,n;try{await gapi.client.drive.files.delete({fileId:t})}catch(o){console.error("Failed to delete file from Google Drive",o);const i=((n=(e=o==null?void 0:o.result)==null?void 0:e.error)==null?void 0:n.message)||"Unknown Google Drive API error.";throw new Error(`Failed to delete backup: ${i}`)}},tc="cogniflow-themeId",zo=[{id:"system",name:"System",isDark:!1,metaColor:"#f9fafb",metaColorDark:"#111827",palette:{background:"249 250 251",surface:"255 255 255",primary:"37 99 235",text:"17 24 39"},paletteDark:{background:"17 24 39",surface:"31 41 55",primary:"37 99 235",text:"243 244 246"}},{id:"light",name:"Light",isDark:!1,metaColor:"#f9fafb",palette:{background:"249 250 251",surface:"255 255 255",primary:"37 99 235",text:"17 24 39"}},{id:"rose",name:"Rose",isDark:!1,metaColor:"#fff1f2",palette:{background:"255 241 242",surface:"254 226 226",primary:"225 29 72",text:"136 25 55"}},{id:"matcha",name:"Matcha",isDark:!1,metaColor:"#f0fdf4",palette:{background:"240 253 244",surface:"220 252 231",primary:"22 163 74",text:"21 94 53"}},{id:"latte",name:"Latte",isDark:!1,metaColor:"#fffbeb",palette:{background:"255 251 235",surface:"254 243 199",primary:"217 119 6",text:"113 63 18"}},{id:"sky",name:"Sky",isDark:!1,metaColor:"#f0f9ff",palette:{background:"240 249 255",surface:"224 242 254",primary:"14 165 233",text:"7 89 133"}},{id:"sunrise",name:"Sunrise",isDark:!1,metaColor:"#fffbeb",palette:{background:"255 251 235",surface:"254 243 199",primary:"249 115 22",text:"124 45 18"}},{id:"lavender",name:"Lavender",isDark:!1,metaColor:"#f5f3ff",palette:{background:"245 243 255",surface:"237 233 254",primary:"124 58 237",text:"76 29 149"}},{id:"terracotta",name:"Terracotta",isDark:!1,metaColor:"#faf3e8",palette:{background:"250 243 232",surface:"245 233 218",primary:"226 114 91",text:"93 64 55"}},{id:"alabaster",name:"Alabaster",isDark:!1,metaColor:"#fcfcfc",palette:{background:"252 252 252",surface:"255 255 255",primary:"96 165 250",text:"50 50 50"}},{id:"dark",name:"Dark",isDark:!0,metaColor:"#111827",palette:{background:"17 24 39",surface:"31 41 55",primary:"37 99 235",text:"243 244 246"}},{id:"espresso",name:"Espresso",isDark:!0,metaColor:"#211713",palette:{background:"33 23 19",surface:"58 45 39",primary:"196 154 108",text:"224 213 208"}},{id:"midnight",name:"Midnight",isDark:!0,metaColor:"#0c0d11",palette:{background:"12 13 17",surface:"26 27 38",primary:"133 137 230",text:"200 201 215"}}],Th=B.createContext(void 0),Mp=t=>{let e=zo.find(f=>f.id===t);e||(e=zo[0]);const n=window.document.documentElement,o=document.querySelector('meta[name="theme-color"]');let i,c;e.id==="system"?(i=window.matchMedia("(prefers-color-scheme: dark)").matches,c=i?e.metaColorDark:e.metaColor):(i=e.isDark,c=e.metaColor),zo.forEach(f=>{f.id!=="system"&&n.classList.remove(`theme-${f.id}`)}),n.classList.remove("theme-dark","theme-light"),e.id!=="system"&&n.classList.add(`theme-${e.id}`),n.classList.toggle("dark",i),o&&c&&o.setAttribute("content",c)},oE=({children:t})=>{const[e,n]=B.useState(()=>{try{const c=localStorage.getItem(tc);return zo.some(f=>f.id===c)?c:"system"}catch(c){return console.error("Could not access localStorage. Defaulting to 'system'.",c),"system"}});B.useEffect(()=>{try{localStorage.setItem(tc,e)}catch(c){console.error("Could not set theme in localStorage.",c)}Mp(e)},[e]),B.useEffect(()=>{const c=window.matchMedia("(prefers-color-scheme: dark)"),f=()=>{let m="system";try{m=localStorage.getItem(tc)||"system"}catch{}m==="system"&&Mp("system")};return c.addEventListener("change",f),()=>c.removeEventListener("change",f)},[]);const o=B.useCallback(c=>{n(c)},[]),i=zo.find(c=>c.id===e)||zo[0];return u.jsx(Th.Provider,{value:{themeId:e,setThemeById:o,currentTheme:i},children:t})},sE=()=>{const t=B.useContext(Th);if(t===void 0)throw new Error("useTheme must be used within a ThemeProvider");return t},fi=({id:t,title:e,children:n,openSection:o,setOpenSection:i,isDanger:c=!1})=>{const f=o===t,m=c?"bg-red-900/20 text-red-400 dark:text-red-300":"bg-surface",h=c?"border border-red-500/30":"border border-border";return u.jsxs("div",{className:`rounded-lg shadow-md overflow-hidden ${h}`,children:[u.jsxs("button",{onClick:()=>i(f?null:t),className:`w-full flex justify-between items-center text-left p-6 ${m}`,"aria-expanded":f,children:[u.jsx("h3",{className:"text-xl font-semibold",children:e}),u.jsx(de,{name:"chevron-down",className:`w-6 h-6 transition-transform duration-300 ${f?"":"-rotate-90"} text-text-muted`})]}),f&&u.jsx("div",{className:`p-6 pt-0 animate-fade-in ${c?"bg-red-900/10":"bg-surface"}`,children:u.jsx("div",{className:"pt-6 border-t border-border",children:n})})]})},iE=({onExport:t,onRestore:e,onRestoreData:n,onResetProgress:o,onFactoryReset:i})=>{var be,ve,xe;const{disableAnimations:c,setDisableAnimations:f,hapticsEnabled:m,setHapticsEnabled:h,aiFeaturesEnabled:p,setAiFeaturesEnabled:v}=Vo(),{addToast:x}=gn(),{themeId:C,setThemeById:S}=sE(),[b,T]=B.useState("data"),[A,D]=B.useState({isReady:!1,isSignedIn:!1,isProcessing:!1,user:null}),[F,L]=B.useState([]),[R,P]=B.useState(!1),G=B.useCallback(async()=>{P(!0);try{const te=await tE();L(te)}catch(te){x(`Could not list files: ${te.message||"Unknown error"}`,"error"),L([])}finally{P(!1)}},[x]);B.useEffect(()=>{let te=!0;(async()=>{try{await W_(),te&&localStorage.getItem("gdrive-previously-signed-in")==="true"&&K_()}catch(O){te&&(console.error("Failed to initialize Google Drive service",O),x("Could not initialize Google Drive.","error"),D(V=>({...V,isReady:!1,isProcessing:!1})))}})();const N=J_(O=>{te&&D(V=>({...V,isReady:O}))}),j=Y_((O,V)=>{te&&(D(K=>({...K,isSignedIn:O,user:V,isProcessing:!1})),O?G():L([]))});return()=>{te=!1,N(),j()}},[x,G]);const $=()=>{D(te=>({...te,isProcessing:!0})),Q_()},oe=()=>{Z_()},J=async()=>{D(te=>({...te,isProcessing:!0}));try{const te=await eE();x("Successfully backed up data to Google Drive.","success"),L(q=>[te,...q])}catch(te){console.error("Google Drive Backup failed",te),x(`Backup failed: ${te.message||"Unknown error"}`,"error")}finally{D(te=>({...te,isProcessing:!1}))}},Z=async te=>{D(q=>({...q,isProcessing:!0}));try{const q=await nE(te);await n(q)}catch(q){x(`Restore failed: ${q.message||"Unknown error"}`,"error")}finally{D(q=>({...q,isProcessing:!1}))}},le=te=>{window.confirm(`Are you sure you want to restore from "${te.name}"? This will merge and overwrite existing data.`)&&Z(te.id)},Q=async te=>{if(window.confirm(`Are you sure you want to permanently delete the backup "${te.name}"? This action cannot be undone.`)){D(q=>({...q,isProcessing:!0}));try{await rE(te.id),x(`Backup "${te.name}" deleted.`,"success"),L(q=>q.filter(N=>N.id!==te.id))}catch(q){console.error("Google Drive Delete failed",q),x(`Delete failed: ${q.message||"Unknown error"}`,"error")}finally{D(q=>({...q,isProcessing:!1}))}}},Y=te=>{if(!navigator.serviceWorker||!navigator.serviceWorker.controller){x("Service worker is not active. Please reload the page and try again.","error");return}const q={type:te==="APP"?"CLEAR_APP_CACHE":"CLEAR_CDN_CACHE"};navigator.serviceWorker.controller.postMessage(q),x(`${te} cache cleared. Please reload the page to apply changes.`,"success")},M=()=>{if(!navigator.serviceWorker||!navigator.serviceWorker.controller){x("Service worker is not active. Please reload the page and try again.","error");return}navigator.serviceWorker.controller.postMessage({type:"CLEAR_APP_CACHE"}),navigator.serviceWorker.controller.postMessage({type:"CLEAR_CDN_CACHE"}),x("All caches cleared. The application will now reload.","info"),setTimeout(()=>{window.location.reload()},1500)},pe=B.useMemo(()=>window.matchMedia("(prefers-color-scheme: dark)").matches,[]);return u.jsx(u.Fragment,{children:u.jsxs("div",{className:"max-w-4xl mx-auto animate-fade-in space-y-6",children:[u.jsx("h2",{className:"text-3xl font-bold mb-6 text-text border-b border-border pb-4",children:"Settings"}),u.jsx(fi,{id:"data",title:"Data Management",openSection:b,setOpenSection:T,children:u.jsxs("div",{className:"space-y-6",children:[u.jsxs("div",{id:"settings-local-backup",children:[u.jsx("h4",{className:"font-semibold text-text",children:"Local File Backup"}),u.jsx("p",{className:"text-text-muted my-2",children:"Backup all your decks and study progress to a JSON file on your device."}),u.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[u.jsxs(Se,{onClick:t,variant:"secondary",className:"w-full sm:w-auto",children:[u.jsx(de,{name:"download",className:"w-5 h-5 mr-2"}),"Backup to File"]}),u.jsxs(Se,{onClick:e,variant:"secondary",className:"w-full sm:w-auto",children:[u.jsx(de,{name:"upload-cloud",className:"w-5 h-5 mr-2"}),"Restore from File"]})]})]}),u.jsxs("div",{id:"google-drive-backup",className:"border-t border-border pt-6",children:[u.jsx("h4",{className:"font-semibold text-text",children:"Google Drive Cloud Backup"}),u.jsx("p",{className:"text-text-muted my-2",children:"Securely back up and restore your data to a private folder in your Google Drive."}),A.isReady?A.isSignedIn?u.jsxs("div",{className:"space-y-4",children:[u.jsxs("div",{className:"flex items-center gap-4",children:[u.jsx("img",{src:(be=A.user)==null?void 0:be.picture,alt:"User profile",className:"w-10 h-10 rounded-full"}),u.jsxs("div",{children:[u.jsx("p",{className:"font-semibold text-text",children:(ve=A.user)==null?void 0:ve.name}),u.jsx("p",{className:"text-sm text-text-muted",children:(xe=A.user)==null?void 0:xe.email})]}),u.jsx(Se,{variant:"ghost",onClick:oe,className:"ml-auto",children:"Sign Out"})]}),u.jsx("div",{className:"flex flex-col sm:flex-row gap-4",children:u.jsxs(Se,{onClick:J,variant:"secondary",className:"w-full sm:w-auto",disabled:A.isProcessing,children:[u.jsx(de,{name:"upload-cloud",className:"w-5 h-5 mr-2"}),A.isProcessing?"Backing up...":"Backup to Drive Now"]})}),u.jsxs("div",{className:"pt-4 mt-4 border-t border-border/50",children:[u.jsx("h5",{className:"font-semibold text-text mb-2",children:"Available Backups"}),R?u.jsxs("div",{className:"flex items-center text-text-muted",children:[u.jsx(Ln,{size:"sm"}),u.jsx("span",{className:"ml-2",children:"Loading backups..."})]}):F.length>0?u.jsx("ul",{className:"space-y-2 max-h-60 overflow-y-auto border border-border rounded-md p-2",children:F.map(te=>u.jsxs("li",{className:"flex justify-between items-center p-2 rounded-md hover:bg-border/20",children:[u.jsxs("div",{className:"min-w-0 mr-2",children:[u.jsx("p",{className:"font-medium text-sm text-text truncate",title:te.name,children:te.name}),u.jsx("p",{className:"text-xs text-text-muted",children:$g(te.modifiedTime)})]}),u.jsxs("div",{className:"flex-shrink-0 flex items-center gap-1",children:[u.jsx(Se,{variant:"ghost",size:"sm",onClick:()=>le(te),disabled:A.isProcessing,children:"Restore"}),u.jsx(Se,{variant:"ghost",size:"sm",className:"text-red-500",onClick:()=>Q(te),disabled:A.isProcessing,children:"Delete"})]})]},te.id))}):u.jsx("p",{className:"text-text-muted text-sm",children:"No backups found in your Google Drive."}),u.jsxs(Se,{variant:"ghost",size:"sm",className:"mt-2",onClick:G,disabled:R,children:[u.jsx(de,{name:"refresh-ccw",className:`w-4 h-4 mr-2 ${R?"animate-spin":""}`})," Refresh list"]})]})]}):u.jsx("div",{className:"flex flex-col sm:flex-row gap-4",children:u.jsxs(Se,{onClick:$,variant:"secondary",disabled:A.isProcessing,children:[u.jsx(de,{name:"google",className:"w-5 h-5 mr-2"}),A.isProcessing?"Signing in...":"Sign in with Google"]})}):u.jsxs("div",{className:"h-10 flex items-center",children:[u.jsx(Ln,{size:"sm"}),u.jsx("span",{className:"ml-2 text-text-muted",children:"Initializing Google Drive..."})]})]})]})}),u.jsx(fi,{id:"cache-management",title:"Cache Management",openSection:b,setOpenSection:T,children:u.jsxs("div",{id:"settings-cache-management",className:"space-y-4",children:[u.jsx("p",{className:"text-text-muted",children:'If you are experiencing issues, clearing the cache can help. "Hard Reload" clears all caches and reloads the application, which is the strongest reset option.'}),u.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[u.jsxs(Se,{variant:"secondary",onClick:()=>Y("APP"),children:[u.jsx(de,{name:"broom",className:"w-5 h-5 mr-2"})," Clear App Cache"]}),u.jsxs(Se,{variant:"secondary",onClick:()=>Y("CDN"),children:[u.jsx(de,{name:"broom",className:"w-5 h-5 mr-2"})," Clear CDN Cache"]}),u.jsxs(Se,{variant:"danger",onClick:M,children:[u.jsx(de,{name:"refresh-ccw",className:"w-5 h-5 mr-2"})," Hard Reload"]})]})]})}),u.jsxs(fi,{id:"appearance",title:"Appearance",openSection:b,setOpenSection:T,children:[u.jsxs("div",{className:"border-b border-border pb-6 mb-6",children:[u.jsx("h4",{className:"font-semibold text-text",children:"Theme"}),u.jsx("p",{className:"text-text-muted my-2",children:`Select a theme to change the application's color scheme. The "System" theme will automatically match your device's light or dark mode.`}),u.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 gap-4 mt-4",children:zo.map(te=>{const q=C===te.id,N=te.id==="system"&&pe?te.paletteDark:te.palette;return u.jsxs("button",{onClick:()=>S(te.id),className:`relative p-4 rounded-lg border-2 transition-all duration-200 ${q?"border-primary ring-2 ring-primary/50":"border-border hover:border-primary/70"}`,"aria-pressed":q,"aria-label":`Select ${te.name} theme`,children:[q&&u.jsx(de,{name:"check-circle",className:"absolute top-2 right-2 w-5 h-5 text-primary"}),u.jsxs("div",{className:"flex items-center justify-center gap-1.5 mb-2",children:[u.jsx("div",{className:"w-5 h-5 rounded-full border border-border/50",style:{backgroundColor:`rgb(${N.background})`}}),u.jsx("div",{className:"w-5 h-5 rounded-full border border-border/50",style:{backgroundColor:`rgb(${N.surface})`}}),u.jsx("div",{className:"w-5 h-5 rounded-full",style:{backgroundColor:`rgb(${N.primary})`}}),u.jsx("div",{className:"w-5 h-5 rounded-full",style:{backgroundColor:`rgb(${N.text})`}})]}),u.jsx("p",{className:"text-center text-sm font-medium text-text",children:te.name})]},te.id)})})]}),u.jsxs("div",{className:"space-y-4",children:[u.jsx(ec,{label:"Disable card flip animation",checked:c,onChange:f,description:"For a faster, no-frills study session."}),u.jsx(ec,{label:"Haptic feedback",checked:m,onChange:h,description:"Provides physical feedback on supported devices."})]})]}),u.jsx(fi,{id:"ai-features",title:"AI Features",openSection:b,setOpenSection:T,children:u.jsxs("div",{className:"space-y-4",children:[u.jsx(ec,{label:"Enable AI Content Generation",checked:p,onChange:v,description:"Use Google's Gemini API to generate new study series and decks from a topic."}),u.jsx("div",{className:"text-xs text-text-muted p-3 bg-background rounded-md border border-border",children:u.jsx("p",{children:"By enabling this feature, you agree to send prompts to Google's servers to generate content. This feature requires a valid Gemini API key to be configured in the application's environment. CogniFlow does not store your prompts or the generated content."})})]})}),u.jsx(fi,{id:"danger-zone",title:"Danger Zone",openSection:b,setOpenSection:T,isDanger:!0,children:u.jsxs("div",{className:"space-y-6",children:[u.jsxs("div",{id:"settings-reset-progress",children:[u.jsx("h4",{className:"font-semibold text-red-300",children:"Reset Deck Progress"}),u.jsx("p",{className:"text-red-300/80 my-2",children:"This will reset the spaced repetition data (due dates, intervals) for a single deck. The cards themselves will not be deleted."}),u.jsxs(Se,{onClick:o,variant:"danger",children:[u.jsx(de,{name:"refresh-ccw",className:"w-5 h-5 mr-2"}),"Reset Deck Progress..."]})]}),u.jsxs("div",{id:"settings-factory-reset",className:"border-t border-red-500/30 pt-6",children:[u.jsx("h4",{className:"font-semibold text-red-300",children:"Factory Reset"}),u.jsx("p",{className:"text-red-300/80 my-2",children:"This will permanently delete ALL of your data, including decks, folders, series, and settings. This action cannot be undone."}),u.jsxs(Se,{onClick:i,variant:"danger",children:[u.jsx(de,{name:"trash-2",className:"w-5 h-5 mr-2"}),"Factory Reset..."]})]})]})}),u.jsxs("div",{className:"text-center text-xs text-text-muted pt-4 pb-2",children:[u.jsx("p",{children:"CogniFlow v1.2.0"}),u.jsxs("p",{children:["Running on: ",u.jsx("strong",{children:window.location.hostname||"localhost"})]})]})]})})},aE=({card:t,onClose:e,onSave:n})=>{const[o,i]=B.useState(""),[c,f]=B.useState(""),{addToast:m}=gn(),h=B.useRef(null);Un(h,!0),B.useEffect(()=>{t&&(i(t.front),f(t.back))},[t]);const p=x=>{if(x.preventDefault(),!o.trim()||!c.trim()){m("Both front and back fields are required.","error");return}n({id:(t==null?void 0:t.id)||"",front:o.trim(),back:c.trim()})},v=x=>{if(x.key==="Tab"){x.preventDefault();const C=x.target,S=C.selectionStart,b=C.selectionEnd;C.value=C.value.substring(0,S)+"	"+C.value.substring(b),C.selectionStart=C.selectionEnd=S+1}};return u.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50 p-4",children:u.jsx("div",{ref:h,className:"bg-surface rounded-lg shadow-xl w-full max-w-2xl transform transition-all relative",children:u.jsxs("form",{onSubmit:p,children:[u.jsxs("div",{className:"flex justify-between items-center p-4 border-b border-border",children:[u.jsx("h2",{className:"text-xl font-bold",children:t?"Edit Card":"Add New Card"}),u.jsx(Se,{type:"button",variant:"ghost",onClick:e,className:"p-1 h-auto",children:u.jsx(de,{name:"x"})})]}),u.jsxs("div",{className:"p-6 space-y-4",children:[u.jsxs("div",{children:[u.jsx("label",{htmlFor:"card-front",className:"block text-sm font-medium text-text-muted mb-1",children:"Front"}),u.jsx("textarea",{id:"card-front",value:o,onChange:x=>i(x.target.value),onKeyDown:v,rows:5,className:"w-full p-2 bg-background border border-border rounded-md focus:ring-2 focus:ring-primary focus:outline-none",placeholder:"Enter front content (question, term, etc.)"})]}),u.jsxs("div",{children:[u.jsx("label",{htmlFor:"card-back",className:"block text-sm font-medium text-text-muted mb-1",children:"Back"}),u.jsx("textarea",{id:"card-back",value:c,onChange:x=>f(x.target.value),onKeyDown:v,rows:5,className:"w-full p-2 bg-background border border-border rounded-md focus:ring-2 focus:ring-primary focus:outline-none",placeholder:"Enter back content (answer, definition, etc.)"})]})]}),u.jsxs("div",{className:"flex justify-end p-4 bg-background/50 border-t border-border",children:[u.jsx(Se,{type:"button",variant:"secondary",onClick:e,className:"mr-2",children:"Cancel"}),u.jsx(Se,{type:"submit",variant:"primary",children:t?"Save Changes":"Add Card"})]})]})})})},lE=t=>{const e=new Date;e.setHours(0,0,0,0);const n=new Date(t);n.setHours(0,0,0,0);const o=n.getTime()-e.getTime(),i=Math.round(o/(1e3*60*60*24)),c=i<=0;let f;return i<0?f="Due":i===0?f="Due today":i===1?f="Due tomorrow":f=`Due in ${i} days`,{text:f,isDue:c}},uE=({cards:t,onCardsChange:e,onAddCard:n,onBulkAdd:o})=>{const[i,c]=B.useState(null),[f,m]=B.useState(!1),[h,p]=B.useState(null),[v,x]=B.useState(!0),C=B.useRef(null),S=(L,R)=>{c(L),R&&(C.current=R.currentTarget),m(!0)},b=()=>{var L;m(!1),(L=C.current)==null||L.focus(),c(null)},T=(L,R)=>{p(L),R&&(C.current=R.currentTarget)},A=()=>{h&&e(t.filter(L=>L.id!==h.id)),p(null)},D=L=>{i?e(t.map(R=>R.id===L.id?{...R,...L}:R)):n(L),b()},F=L=>{e(t.map(R=>R.id===L?{...R,suspended:!1}:R))};return u.jsxs("div",{children:[u.jsx("div",{className:"border-b border-border",children:u.jsxs("button",{onClick:()=>x(!v),className:"w-full flex justify-between items-center text-left p-6","aria-expanded":v,"aria-controls":"card-list-content",children:[u.jsx("h3",{className:"text-xl font-semibold text-text",children:"Cards"}),u.jsx(de,{name:"chevron-down",className:`w-6 h-6 transition-transform duration-300 ${v?"":"-rotate-90"} text-text-muted`})]})}),v&&u.jsxs("div",{id:"card-list-content",className:"animate-fade-in",children:[u.jsx("div",{className:"p-6",children:t.length>0?u.jsx("ul",{className:"space-y-4",children:t.map(L=>{const{text:R,isDue:P}=lE(L.dueDate);return u.jsxs("li",{className:`p-4 rounded-lg flex items-start justify-between transition-all ${L.suspended?"bg-yellow-500/10 opacity-70":"bg-background"}`,children:[u.jsxs("div",{className:"flex-1 min-w-0 mr-4",children:[u.jsxs("p",{className:"text-sm font-medium text-text truncate",children:[u.jsx("strong",{children:"Front:"})," ",L.front.replace(/<[^>]+>/g,"")]}),u.jsxs("p",{className:"text-sm text-text-muted truncate",children:[u.jsx("strong",{children:"Back:"})," ",L.back.replace(/<[^>]+>/g,"")]}),u.jsxs("div",{className:"mt-3 space-y-2",children:[u.jsx(ao,{level:sr(L)}),u.jsx("div",{className:"flex items-center gap-4 text-xs text-text-muted",children:u.jsxs("span",{className:`font-semibold ${P?"text-primary":""}`,children:[u.jsx(de,{name:"zap",className:"w-3 h-3 inline-block mr-1"}),R]})})]})]}),u.jsxs("div",{className:"flex-shrink-0 flex items-center gap-2",children:[L.suspended?u.jsx(Se,{variant:"ghost",className:"p-2 h-auto text-yellow-600 dark:text-yellow-400",onClick:()=>F(L.id),title:"Unsuspend this card",children:u.jsx(de,{name:"eye",className:"w-4 h-4"})}):u.jsx(Se,{variant:"ghost",className:"p-2 h-auto",onClick:G=>S(L,G),title:"Edit this card",children:u.jsx(de,{name:"edit",className:"w-4 h-4"})}),u.jsx(Se,{variant:"ghost",className:"p-2 h-auto text-text-muted hover:text-red-500",onClick:G=>T(L,G),title:"Delete this card",children:u.jsx(de,{name:"trash-2",className:"w-4 h-4"})})]})]},L.id)})}):u.jsxs("div",{className:"text-center text-text-muted py-8",children:[u.jsx(de,{name:"laptop",className:"w-12 h-12 mx-auto mb-2 opacity-50"}),u.jsx("p",{children:"This deck has no cards yet."})]})}),u.jsxs("div",{className:"px-6 py-4 border-t border-border flex flex-wrap gap-2",children:[u.jsxs(Se,{variant:"secondary",onClick:L=>S(null,L),className:"flex-grow sm:flex-grow-0",children:[u.jsx(de,{name:"plus",className:"w-5 h-5 mr-2"}),"Add New Card"]}),u.jsxs(Se,{variant:"ghost",onClick:o,className:"flex-grow sm:flex-grow-0",children:[u.jsx(de,{name:"code",className:"w-5 h-5 mr-2"}),"Bulk Add via JSON"]})]})]}),f&&u.jsx(aE,{card:i,onClose:b,onSave:D}),h&&u.jsx(Qa,{isOpen:!!h,onClose:()=>p(null),onConfirm:A,title:"Delete Card",message:"Are you sure you want to delete this card? This action cannot be undone."})]})},cE=({question:t,onClose:e,onSave:n})=>{const[o,i]=B.useState(""),[c,f]=B.useState(""),[m,h]=B.useState([]),[p,v]=B.useState(""),{addToast:x}=gn(),C=B.useRef(null);Un(C,!0),B.useEffect(()=>{if(t)i(t.questionText),f(t.detailedExplanation),h(t.options.map(D=>({...D}))),v(t.correctAnswerId);else{const D=[{id:crypto.randomUUID(),text:""},{id:crypto.randomUUID(),text:""}];h(D)}},[t]);const S=(D,F)=>{h(m.map(L=>L.id===D?{...L,text:F}:L))},b=()=>{h([...m,{id:crypto.randomUUID(),text:""}])},T=D=>{if(m.length<=2){x("A question must have at least two options.","error");return}h(m.filter(F=>F.id!==D)),p===D&&v("")},A=D=>{if(D.preventDefault(),!o.trim()){x("Question text is required.","error");return}if(m.some(F=>!F.text.trim())){x("All options must have text.","error");return}if(!p){x("You must select a correct answer.","error");return}n({id:t==null?void 0:t.id,questionText:o.trim(),detailedExplanation:c.trim(),options:m,correctAnswerId:p,tags:(t==null?void 0:t.tags)||[]})};return u.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50 p-4",children:u.jsx("div",{ref:C,className:"bg-surface rounded-lg shadow-xl w-full max-w-3xl transform transition-all relative max-h-[90vh] flex flex-col",children:u.jsxs("form",{onSubmit:A,className:"flex flex-col h-full",children:[u.jsxs("div",{className:"flex-shrink-0 flex justify-between items-center p-4 border-b border-border",children:[u.jsx("h2",{className:"text-xl font-bold",children:t?"Edit Question":"Add New Question"}),u.jsx(Se,{type:"button",variant:"ghost",onClick:e,className:"p-1 h-auto",children:u.jsx(de,{name:"x"})})]}),u.jsxs("div",{className:"p-6 space-y-4 overflow-y-auto",children:[u.jsxs("div",{children:[u.jsx("label",{htmlFor:"question-text",className:"block text-sm font-medium text-text-muted mb-1",children:"Question Text"}),u.jsx("textarea",{id:"question-text",value:o,onChange:D=>i(D.target.value),rows:3,className:"w-full p-2 bg-background border border-border rounded-md focus:ring-2 focus:ring-primary focus:outline-none",placeholder:"What is the capital of France?"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-text-muted mb-1",children:"Options"}),u.jsx("div",{className:"space-y-2",children:m.map((D,F)=>u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("input",{type:"radio",name:"correct-answer",checked:p===D.id,onChange:()=>v(D.id),className:"h-5 w-5 text-primary bg-border/50 border-border focus:ring-primary","aria-label":`Set option ${F+1} as correct`}),u.jsx("input",{type:"text",value:D.text,onChange:L=>S(D.id,L.target.value),className:"flex-grow p-2 bg-background border border-border rounded-md focus:ring-2 focus:ring-primary focus:outline-none",placeholder:`Option ${F+1}`}),u.jsx(Se,{type:"button",variant:"ghost",onClick:()=>T(D.id),className:"p-2 h-auto","aria-label":`Remove option ${F+1}`,children:u.jsx(de,{name:"trash-2",className:"w-4 h-4"})})]},D.id))}),u.jsxs(Se,{type:"button",variant:"ghost",onClick:b,className:"mt-2 text-primary",children:[u.jsx(de,{name:"plus",className:"w-4 h-4 mr-2"}),"Add Option"]})]}),u.jsxs("div",{children:[u.jsx("label",{htmlFor:"detailed-explanation",className:"block text-sm font-medium text-text-muted mb-1",children:"Detailed Explanation (Optional)"}),u.jsx("textarea",{id:"detailed-explanation",value:c,onChange:D=>f(D.target.value),rows:4,className:"w-full p-2 bg-background border border-border rounded-md focus:ring-2 focus:ring-primary focus:outline-none",placeholder:"Explain why the correct answer is right and others are wrong."})]})]}),u.jsxs("div",{className:"flex-shrink-0 flex justify-end p-4 bg-background/50 border-t border-border",children:[u.jsx(Se,{type:"button",variant:"secondary",onClick:e,className:"mr-2",children:"Cancel"}),u.jsx(Se,{type:"submit",variant:"primary",children:t?"Save Changes":"Add Question"})]})]})})})},dE=t=>{const e=new Date;e.setHours(0,0,0,0);const n=new Date(t);n.setHours(0,0,0,0);const o=n.getTime()-e.getTime(),i=Math.round(o/(1e3*60*60*24)),c=i<=0;let f;return i<0?f="Due":i===0?f="Due today":i===1?f="Due tomorrow":f=`Due in ${i} days`,{text:f,isDue:c}},fE=({questions:t,onQuestionsChange:e,onAddQuestion:n,onBulkAdd:o})=>{const[i,c]=B.useState(null),[f,m]=B.useState(!1),[h,p]=B.useState(null),[v,x]=B.useState(!0),[C,S]=B.useState(null),b=B.useRef(null),T=B.useRef(null);B.useEffect(()=>{const $=oe=>{T.current&&!T.current.contains(oe.target)&&S(null)};return C&&document.addEventListener("mousedown",$),()=>{document.removeEventListener("mousedown",$)}},[C]);const A=($,oe)=>{c($),oe&&(b.current=oe.currentTarget),m(!0)},D=()=>{var $;m(!1),($=b.current)==null||$.focus(),c(null)},F=($,oe)=>{p($),oe&&(b.current=oe.currentTarget)},L=()=>{h&&e(t.filter($=>$.id!==h.id)),p(null)},R=$=>{if(i&&$.id)e(t.map(oe=>oe.id===$.id?{...oe,...$}:oe));else{const{id:oe,...J}=$,Z={...J,questionType:"multipleChoice",suspended:!1};n(Z)}D()},P=$=>{e(t.map(oe=>oe.id===$?{...oe,suspended:!0}:oe)),S(null)},G=$=>{e(t.map(oe=>oe.id===$?{...oe,suspended:!1}:oe)),S(null)};return u.jsxs("div",{children:[u.jsx("div",{className:"border-b border-border",children:u.jsxs("button",{onClick:()=>x(!v),className:"w-full flex justify-between items-center text-left p-6","aria-expanded":v,"aria-controls":"question-list-content",children:[u.jsx("h3",{className:"text-xl font-semibold text-text",children:"Questions"}),u.jsx(de,{name:"chevron-down",className:`w-6 h-6 transition-transform duration-300 ${v?"":"-rotate-90"} text-text-muted`})]})}),v&&u.jsxs("div",{id:"question-list-content",className:"animate-fade-in",children:[u.jsx("div",{className:"p-6",children:t.length>0?u.jsx("ul",{className:"space-y-4",children:t.map($=>{const{text:oe,isDue:J}=dE($.dueDate);return u.jsxs("li",{className:`p-4 rounded-lg flex items-start justify-between transition-all ${$.suspended?"bg-yellow-500/10 opacity-70":"bg-background"}`,children:[u.jsxs("div",{className:"flex-1 min-w-0 mr-4",children:[u.jsx("p",{className:"text-base font-medium text-text break-words",children:$.questionText}),u.jsxs("div",{className:"mt-3 space-y-2",children:[u.jsx(ao,{level:sr($)}),u.jsxs("div",{className:"flex items-center gap-4 text-xs text-text-muted",children:[u.jsxs("span",{className:`font-semibold ${J?"text-primary":""}`,children:[u.jsx(de,{name:"zap",className:"w-3 h-3 inline-block mr-1"}),oe]}),u.jsxs("span",{children:[u.jsx(de,{name:"list",className:"w-3 h-3 inline-block mr-1"}),$.options.length," options"]})]})]})]}),u.jsxs("div",{className:"flex-shrink-0 relative",ref:C===$.id?T:null,children:[u.jsx(Se,{variant:"ghost",className:"p-2 h-auto",onClick:Z=>{Z.stopPropagation(),S(le=>le===$.id?null:$.id)},"aria-label":"More options for question",children:u.jsx(de,{name:"more-vertical",className:"w-5 h-5"})}),C===$.id&&u.jsxs("div",{className:"absolute right-0 mt-2 w-48 bg-surface rounded-md shadow-lg py-1 z-10 ring-1 ring-black ring-opacity-5 animate-fade-in",style:{animationDuration:"150ms"},children:[u.jsxs("button",{type:"button",onClick:Z=>{A($,Z),S(null)},className:"flex items-center w-full px-4 py-2 text-sm text-left text-text hover:bg-border/20",children:[u.jsx(de,{name:"edit",className:"w-4 h-4 mr-3"}),"Edit"]}),$.suspended?u.jsxs("button",{type:"button",onClick:()=>G($.id),className:"flex items-center w-full px-4 py-2 text-sm text-left text-text hover:bg-border/20",children:[u.jsx(de,{name:"eye",className:"w-4 h-4 mr-3"}),"Unsuspend"]}):u.jsxs("button",{type:"button",onClick:()=>P($.id),className:"flex items-center w-full px-4 py-2 text-sm text-left text-text hover:bg-border/20",children:[u.jsx(de,{name:"eye-off",className:"w-4 h-4 mr-3"}),"Suspend"]}),u.jsx("div",{className:"border-t border-border my-1"}),u.jsxs("button",{type:"button",onClick:Z=>{F($,Z),S(null)},className:"flex items-center w-full px-4 py-2 text-sm text-left text-red-600 dark:text-red-400 hover:bg-red-50 dark:hover:bg-red-900/20",children:[u.jsx(de,{name:"trash-2",className:"w-4 h-4 mr-3"}),"Delete"]})]})]})]},$.id)})}):u.jsxs("div",{className:"text-center text-text-muted py-8",children:[u.jsx(de,{name:"help-circle",className:"w-12 h-12 mx-auto mb-2 opacity-50"}),u.jsx("p",{children:"This deck has no questions yet."})]})}),u.jsxs("div",{className:"px-6 py-4 border-t border-border flex flex-wrap gap-2",children:[u.jsxs(Se,{variant:"secondary",onClick:$=>A(null,$),className:"flex-grow sm:flex-grow-0",children:[u.jsx(de,{name:"plus",className:"w-5 h-5 mr-2"}),"Add New Question"]}),u.jsxs(Se,{variant:"ghost",onClick:o,className:"flex-grow sm:flex-grow-0",children:[u.jsx(de,{name:"code",className:"w-5 h-5 mr-2"}),"Bulk Add via JSON"]})]})]}),f&&u.jsx(cE,{question:i,onClose:D,onSave:R}),h&&u.jsx(Qa,{isOpen:!!h,onClose:()=>p(null),onConfirm:L,title:"Delete Question",message:"Are you sure you want to delete this question? This action cannot be undone."})]})},mE=({isOpen:t,onClose:e,onAddItems:n,deckType:o})=>{const[i,c]=B.useState(""),{addToast:f}=gn(),m=B.useRef(null);Un(m,t);const h=B.useMemo(()=>o===We.Flashcard?`[
  {
    "front": "What is the capital of Japan?",
    "back": "Tokyo"
  },
  {
    "front": "What is 2 + 2?",
    "back": "4"
  }
]`:`[
  {
    "questionText": "Which planet is known as the Red Planet?",
    "options": [
      { "id": "1", "text": "Earth" },
      { "id": "2", "text": "Mars" }
    ],
    "correctAnswerId": "2",
    "detailedExplanation": "Mars is called the Red Planet because of its reddish appearance."
  }
]`,[o]),p=x=>{if(x.preventDefault(),!i.trim()){f("JSON content cannot be empty.","error");return}try{const C=Sy(i,o);if(C.length===0){f("The JSON array is empty. No items were added.","info"),e();return}n(C),f(`Successfully added ${C.length} item(s).`,"success"),e()}catch(C){f(C instanceof Error?C.message:"Invalid JSON format.","error")}},v=x=>{if(x.key==="Tab"){x.preventDefault();const C=x.target,S=C.selectionStart,b=C.selectionEnd;C.value=C.value.substring(0,S)+"  "+C.value.substring(b),C.selectionStart=C.selectionEnd=S+2}};return t?u.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50 p-4",children:u.jsx("div",{ref:m,className:"bg-surface rounded-lg shadow-xl w-full max-w-2xl transform transition-all relative",children:u.jsxs("form",{onSubmit:p,children:[u.jsxs("div",{className:"flex justify-between items-center p-4 border-b border-border",children:[u.jsx("h2",{className:"text-xl font-bold",children:"Bulk Add via JSON"}),u.jsx(Se,{type:"button",variant:"ghost",onClick:e,className:"p-1 h-auto",children:u.jsx(de,{name:"x"})})]}),u.jsxs("div",{className:"p-6",children:[u.jsxs("div",{className:"flex justify-between items-baseline mb-1",children:[u.jsxs("label",{htmlFor:"json-content",className:"block text-sm font-medium text-text-muted",children:["Paste an array of ",o===We.Flashcard?"card":"question"," objects"]}),u.jsxs(Ot,{href:"/instructions/json",onClick:e,className:"text-sm text-primary hover:underline inline-flex items-center gap-1",children:[u.jsx(de,{name:"help-circle",className:"w-4 h-4"}),"Format Guide"]})]}),u.jsx("textarea",{id:"json-content",value:i,onChange:x=>c(x.target.value),onKeyDown:v,rows:15,className:"w-full p-2 bg-background border border-border rounded-md focus:ring-2 focus:ring-primary focus:outline-none font-mono text-sm",placeholder:h})]}),u.jsxs("div",{className:"flex justify-end p-4 bg-background/50 border-t border-border",children:[u.jsx(Se,{type:"button",variant:"secondary",onClick:e,className:"mr-2",children:"Cancel"}),u.jsx(Se,{type:"submit",variant:"primary",children:"Add Items"})]})]})})}):null},pE=({data:t,total:e})=>e===0?u.jsx("div",{className:"w-full bg-gray-200 dark:bg-gray-700 rounded-full h-4"}):u.jsx("div",{className:"flex w-full h-4 bg-gray-200 dark:bg-gray-700 rounded-full overflow-hidden",role:"progressbar","aria-valuenow":t.reduce((n,o)=>n+o.value,0),"aria-valuemin":0,"aria-valuemax":e,children:t.map((n,o)=>{if(n.value===0)return null;const i=n.value/e*100;return u.jsx("div",{className:`${n.color} transition-all duration-500`,style:{width:`${i}%`},title:`${n.label}: ${n.value} item(s)`},o)})}),hE=({data:t})=>{const e=Math.max(...t.map(p=>p.count),1),n=350,o=120,i={top:25,right:15,bottom:25,left:15},c=n-i.left-i.right,f=o-i.top-i.bottom,m=c/t.length,h=Math.max(6,m*.1);return u.jsxs("div",{className:"w-full",children:[u.jsx("h4",{className:"text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2",children:"Upcoming Due Dates (Next 7 Days)"}),u.jsx("div",{className:"bg-gray-50 dark:bg-gray-900/50 p-2 rounded-lg border border-gray-200 dark:border-gray-700/50",children:u.jsxs("svg",{viewBox:`0 0 ${n} ${o}`,width:"100%",height:"auto","aria-labelledby":"due-date-graph-title",role:"img",className:"overflow-visible",children:[u.jsx("title",{id:"due-date-graph-title",children:"A bar chart showing the number of items due over the next 7 days."}),t.map((p,v)=>{const x=p.count>0?p.count/e*f:0,C=i.left+v*m+(m-h)/2,S=i.top+f-x;return u.jsxs("g",{className:"group",style:{cursor:"pointer"},children:[u.jsxs("title",{children:[p.date,": ",p.count," item",p.count!==1?"s":""," due"]}),u.jsx("rect",{x:C,y:S,width:h,height:x,rx:"2",className:"fill-blue-500 transition-colors group-hover:fill-blue-400"}),u.jsx("text",{x:C+h/2,y:S-6,textAnchor:"middle",className:"fill-gray-600 dark:fill-gray-300 font-semibold text-sm transition-opacity opacity-0 group-hover:opacity-100 pointer-events-none",children:p.count}),u.jsx("text",{x:C+h/2,y:o-i.bottom+15,textAnchor:"middle",className:"fill-gray-400 dark:fill-gray-500 text-xs pointer-events-none",children:p.dayLabel})]},v)})]})})]})},gE=({reviews:t})=>{const[e,n]=B.useState(null),o=B.useMemo(()=>{if(!t||t.length===0)return[];const T=new Map;t.forEach(D=>{const F=new Date(D.timestamp).toISOString().split("T")[0],L=T.get(F)||{totalMastery:0,count:0};L.totalMastery+=D.masteryLevel,L.count++,T.set(F,L)});const A=Array.from(T.entries()).map(([D,{totalMastery:F,count:L}])=>({date:new Date(D),avgMastery:F/L}));return A.sort((D,F)=>D.date.getTime()-F.date.getTime()),A.slice(-90)},[t]);if(o.length<2)return u.jsx("div",{className:"text-center text-sm text-text-muted py-8",children:"Not enough review history to plot a graph."});const i=350,c=150,f={top:10,right:10,bottom:20,left:30},m=i-f.left-f.right,h=c-f.top-f.bottom,p=o[0].date.getTime(),v=o[o.length-1].date.getTime(),x=T=>(T.getTime()-p)/(v-p)*m+f.left,C=T=>c-f.bottom-T*h,S=o.map(T=>`${x(T.date)},${C(T.avgMastery)}`).join(" L "),b=T=>{const A=T.currentTarget.getBoundingClientRect(),D=T.clientX-A.left;let F=o[0],L=1/0;o.forEach(R=>{const P=x(R.date),G=Math.abs(D-P);G<L&&(L=G,F=R)}),L<20?n({x:x(F.date),y:C(F.avgMastery),data:F}):n(null)};return u.jsx("div",{className:"w-full",children:u.jsxs("svg",{viewBox:`0 0 ${i} ${c}`,width:"100%",height:"auto","aria-labelledby":"mastery-graph-title",role:"img",className:"overflow-visible",onMouseMove:b,onMouseLeave:()=>n(null),children:[u.jsx("title",{id:"mastery-graph-title",children:"A line chart showing average mastery over time."}),[0,.25,.5,.75,1].map(T=>u.jsxs("g",{children:[u.jsx("line",{x1:f.left,y1:C(T),x2:i-f.right,y2:C(T),className:"stroke-current text-border/70",strokeWidth:"0.5"}),u.jsx("text",{x:f.left-8,y:C(T)+4,textAnchor:"end",className:"text-xs fill-text-muted",children:`${T*100}%`})]},T)),u.jsx("text",{x:f.left,y:c-5,textAnchor:"start",className:"text-xs fill-text-muted",children:o[0].date.toLocaleDateString("en-us",{month:"short",day:"numeric"})}),u.jsx("text",{x:i-f.right,y:c-5,textAnchor:"end",className:"text-xs fill-text-muted",children:o[o.length-1].date.toLocaleDateString("en-us",{month:"short",day:"numeric"})}),u.jsx("path",{d:`M ${S}`,className:"stroke-primary",fill:"none",strokeWidth:"2",strokeLinejoin:"round",strokeLinecap:"round"}),e&&u.jsxs("g",{children:[u.jsx("line",{x1:e.x,y1:f.top,x2:e.x,y2:c-f.bottom,className:"stroke-current text-border",strokeDasharray:"2,2"}),u.jsx("circle",{cx:e.x,cy:e.y,r:"4",className:"fill-primary"}),u.jsxs("g",{transform:`translate(${e.x>i/2?e.x-100:e.x+10}, ${f.top})`,children:[u.jsx("rect",{x:"0",y:"0",width:"90",height:"35",rx:"4",className:"fill-surface opacity-90",stroke:"rgb(var(--color-border))"}),u.jsx("text",{x:"5",y:"15",className:"text-xs fill-text font-semibold",children:e.data.date.toLocaleDateString("en-us",{month:"short",day:"numeric"})}),u.jsxs("text",{x:"5",y:"30",className:"text-xs fill-text-muted",children:["Mastery: ",Math.round(e.data.avgMastery*100),"%"]})]})]})]})})},yE=t=>{const e=new Date;e.setHours(23,59,59,999);const n=t.type===We.Flashcard?t.cards:t.questions;return Array.isArray(n)?n.filter(o=>!o.suspended&&new Date(o.dueDate)<=e).length:0},vE=t=>{const e={new:0,learning:0,young:0,mature:0};return t.forEach(n=>{n.interval===0?e.new++:n.interval<7?e.learning++:n.interval<21?e.young++:e.mature++}),e},xE=({deck:t})=>{const[e,n]=B.useState([]),[o,i]=B.useState(!0),c=t.type===We.Flashcard?t.cards:t.questions;B.useEffect(()=>{(async()=>{i(!0);try{const h=await ry(t.id);n(h)}catch(h){console.error("Failed to fetch review history for deck:",h)}finally{i(!1)}})()},[t.id]);const f=B.useMemo(()=>{if(!e.length)return[];const m=new Map;return e.forEach(h=>{h.rating===ft.Again&&m.set(h.itemId,(m.get(h.itemId)||0)+1)}),Array.from(m.entries()).sort((h,p)=>p[1]-h[1]).slice(0,5).map(([h,p])=>{const v=c.find(x=>x.id===h);return v?{...v,failureCount:p}:null}).filter(h=>!!h)},[e,c]);return o?u.jsx("div",{className:"flex justify-center items-center p-8",children:u.jsx(Ln,{})}):e.length===0?u.jsxs("div",{className:"text-center py-10 bg-surface rounded-lg border border-border",children:[u.jsx(de,{name:"trending-up",className:"w-12 h-12 mx-auto text-text-muted/50"}),u.jsx("h3",{className:"mt-2 text-xl font-medium text-text",children:"No Statistics Yet"}),u.jsx("p",{className:"mt-1 text-sm text-text-muted",children:"Complete a study session for this deck to see your stats."})]}):u.jsx("div",{className:"space-y-8",children:u.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[u.jsxs("div",{className:"bg-surface p-6 rounded-lg shadow-md border border-border",children:[u.jsx("h3",{className:"text-xl font-semibold text-text mb-4",children:"Mastery Over Time"}),u.jsx("p",{className:"text-sm text-text-muted mb-4",children:"Average mastery level of reviewed cards per day over the last 90 days of activity."}),u.jsx(gE,{reviews:e})]}),u.jsxs("div",{className:"bg-surface p-6 rounded-lg shadow-md border border-border",children:[u.jsx("h3",{className:"text-xl font-semibold text-text mb-4",children:"Most Difficult Items"}),u.jsx("p",{className:"text-sm text-text-muted mb-4",children:`Items you've marked "Again" most frequently.`}),f.length>0?u.jsx("ul",{className:"space-y-3",children:f.map(m=>{const p=("questionText"in m?m.questionText:m.front).replace(/<[^>]+>/g,"").trim();return u.jsxs("li",{className:"p-3 bg-background rounded-md border border-border",children:[u.jsx("p",{className:"font-semibold text-sm text-text break-words truncate",title:p,children:p}),u.jsxs("p",{className:"text-xs text-red-500 font-medium",children:['Marked "Again" ',m.failureCount," time",m.failureCount>1?"s":""]})]},m.id)})}):u.jsx("p",{className:"text-sm text-text-muted",children:"No items have been repeatedly marked as difficult. Great job!"})]})]})})},wE=({deck:t,sessionsToResume:e,onUpdateDeck:n,onDeleteDeck:o,onUpdateLastOpened:i,openConfirmModal:c})=>{var te;const[f,m]=B.useState(!1),[h,p]=B.useState(t.name),[v,x]=B.useState(t.description||""),[C,S]=B.useState(t.folderId||""),[b,T]=B.useState(!1),[A,D]=B.useState("overview"),{navigate:F}=Rr(),L=yt(q=>q.folders),R=t.type===We.Flashcard?t.cards:t.questions;B.useEffect(()=>{i(t.id)},[t.id,i]),B.useEffect(()=>{(t.archived||t.deletedAt)&&F("/")},[t.archived,t.deletedAt,F]);const P=()=>{n({...t,name:h,description:v,folderId:C||null}),m(!1)},G=()=>{p(t.name),x(t.description||""),S(t.folderId||""),m(!1)},$=q=>{if(t.type===We.Flashcard&&q.every(N=>"front"in N)){const N=Ec(q),j=[...t.cards,...N];n({...t,cards:j})}else if(t.type===We.Quiz&&q.every(N=>"questionText"in N)){const N=io(q),j=[...t.questions,...N];n({...t,questions:j})}},oe=()=>{c({title:"Move Deck to Trash",message:`Are you sure you want to move the deck "${t.name}" to the trash? It will be permanently deleted after 10 days. This will also remove it from any series it belongs to.`,onConfirm:()=>o(t.id)})},J=R.filter(q=>!q.suspended),Z=R.length-J.length,le=vE(J),Q=yE(t),Y=e.has(t.id),M=B.useMemo(()=>J.length===0?0:J.reduce((N,j)=>N+sr(j),0)/J.length,[J]),pe=B.useMemo(()=>{const q=new Date;q.setHours(0,0,0,0);const N=Array(7).fill(0),j=[],O=[];for(let V=0;V<7;V++){const K=new Date(q);K.setDate(q.getDate()+V),V===0?j.push("Today"):V===1?j.push("Tom"):j.push(K.toLocaleDateString("en-US",{weekday:"short"})),O.push(K.toLocaleDateString("en-US",{month:"short",day:"numeric"}));const X=K.getTime();R.forEach(se=>{if(se.suspended)return;const ae=new Date(se.dueDate);ae.setHours(0,0,0,0),ae.getTime()===X&&N[V]++})}return j.map((V,K)=>({dayLabel:V,count:N[K],date:O[K]}))},[R]),be=B.useMemo(()=>t.locked?"Deck is Locked":t.type===We.Quiz?Y?"Resume Quiz":`Start Quiz (${Q} due)`:Y?"Resume Study":`Study Cards (${Q} due)`,[t.type,Y,Q,t.locked]),ve=[{value:le.new,color:"bg-blue-500",label:"New"},{value:le.learning,color:"bg-orange-500",label:"Learning"},{value:le.young,color:"bg-teal-500",label:"Young"},{value:le.mature,color:"bg-green-500",label:"Mature"}],xe=q=>`px-4 py-2 text-sm font-medium transition-colors ${A===q?"border-b-2 border-primary text-text":"text-text-muted hover:text-text"}`;return u.jsxs("div",{className:"max-w-4xl mx-auto animate-fade-in space-y-6",children:[u.jsx("div",{className:"bg-surface rounded-lg shadow-md p-6 border border-border",children:f?u.jsxs("div",{className:"space-y-4 animate-fade-in",children:[u.jsxs("div",{children:[u.jsx("label",{htmlFor:"deck-name-edit",className:"block text-sm font-medium text-text-muted mb-1",children:"Deck Name"}),u.jsx("input",{id:"deck-name-edit",type:"text",value:h,onChange:q=>p(q.target.value),className:"w-full p-2 bg-background border border-border rounded-md focus:ring-2 focus:ring-primary focus:outline-none text-2xl font-bold",autoFocus:!0})]}),u.jsxs("div",{children:[u.jsx("label",{htmlFor:"deck-folder",className:"block text-sm font-medium text-text-muted mb-1",children:"Folder"}),u.jsxs("select",{id:"deck-folder",value:C,onChange:q=>S(q.target.value),className:"w-full p-2 bg-background border border-border rounded-md focus:ring-2 focus:ring-primary focus:outline-none",children:[u.jsx("option",{value:"",children:"No folder"}),L.map(q=>u.jsx("option",{value:q.id,children:q.name},q.id))]})]}),u.jsxs("div",{children:[u.jsx("label",{htmlFor:"deck-desc",className:"block text-sm font-medium text-text-muted mb-1",children:"Description"}),u.jsx("textarea",{id:"deck-desc",value:v,onChange:q=>x(q.target.value),rows:4,className:"w-full p-2 bg-background border border-border rounded-md focus:ring-2 focus:ring-primary focus:outline-none"})]}),u.jsxs("div",{className:"flex justify-start gap-2 pt-2",children:[u.jsxs(Se,{onClick:P,children:[u.jsx(de,{name:"save",className:"mr-2"})," Save Changes"]}),u.jsx(Se,{variant:"secondary",onClick:G,children:"Cancel"})]})]}):u.jsxs("div",{children:[u.jsxs("div",{className:"min-w-0",children:[u.jsx("h2",{className:"text-3xl font-bold mb-2 text-text break-words",children:t.name}),t.folderId&&u.jsxs("div",{className:"flex items-center text-sm text-text-muted mb-2",children:[u.jsx(de,{name:"folder",className:"w-4 h-4 mr-2"}),u.jsx("span",{children:((te=L.find(q=>q.id===t.folderId))==null?void 0:te.name)||"..."})]})]}),u.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[u.jsxs(Se,{variant:"ghost",onClick:()=>m(!0),children:[u.jsx(de,{name:"edit",className:"mr-2"})," Edit"]}),u.jsxs(Se,{variant:"ghost",onClick:()=>n({...t,archived:!0}),children:[u.jsx(de,{name:"archive",className:"mr-2"})," Archive"]})]}),t.description&&u.jsx("p",{className:"text-text-muted mt-1 mb-4 prose dark:prose-invert max-w-none",dangerouslySetInnerHTML:{__html:t.description}})]})}),u.jsxs("div",{className:"border-b border-border flex space-x-4",children:[u.jsx("button",{className:xe("overview"),onClick:()=>D("overview"),children:"Overview"}),u.jsxs("button",{className:xe("items"),onClick:()=>D("items"),children:["Items (",R.length,")"]}),u.jsx("button",{className:xe("stats"),onClick:()=>D("stats"),children:"Statistics"})]}),u.jsxs("div",{className:"mt-6",children:[A==="overview"&&u.jsxs("div",{className:"space-y-8 animate-fade-in",children:[u.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[u.jsxs("div",{className:"space-y-4 bg-surface p-6 rounded-lg shadow-md border border-border",children:[u.jsxs("div",{children:[u.jsx("h4",{className:"text-sm font-semibold text-text mb-2",children:"Deck Statistics"}),u.jsxs("div",{className:"space-y-1",children:[u.jsxs("p",{className:"text-sm text-text-muted",children:["Active Items: ",u.jsx("strong",{className:"text-text",children:J.length})]}),u.jsxs("p",{className:"text-sm text-text-muted",children:["Items Due Today: ",u.jsx("strong",{className:Q>0?"text-primary":"text-text",children:Q})]}),Z>0&&u.jsxs("p",{className:"text-sm text-yellow-600 dark:text-yellow-400",children:["Suspended Items: ",u.jsx("strong",{children:Z})]})]})]}),u.jsxs("div",{children:[u.jsx("h4",{className:"text-sm font-semibold text-text mb-2",children:"Overall Mastery"}),u.jsx(ao,{level:M})]}),u.jsxs("div",{children:[u.jsx("h4",{className:"text-sm font-semibold text-text mb-2",children:"Progress by Stage"}),u.jsx(pE,{data:ve,total:J.length}),u.jsxs("div",{className:"grid grid-cols-2 gap-x-4 gap-y-1 mt-3 text-xs",children:[u.jsxs("div",{className:"flex items-center",children:[u.jsx("span",{className:"w-2.5 h-2.5 rounded-full bg-blue-500 mr-2"}),u.jsxs("span",{className:"text-text-muted",children:["New: ",u.jsx("strong",{children:le.new})]})]}),u.jsxs("div",{className:"flex items-center",children:[u.jsx("span",{className:"w-2.5 h-2.5 rounded-full bg-orange-500 mr-2"}),u.jsxs("span",{className:"text-text-muted",children:["Learning: ",u.jsx("strong",{children:le.learning})]})]}),u.jsxs("div",{className:"flex items-center",children:[u.jsx("span",{className:"w-2.5 h-2.5 rounded-full bg-teal-500 mr-2"}),u.jsxs("span",{className:"text-text-muted",children:["Young: ",u.jsx("strong",{children:le.young})]})]}),u.jsxs("div",{className:"flex items-center",children:[u.jsx("span",{className:"w-2.5 h-2.5 rounded-full bg-green-500 mr-2"}),u.jsxs("span",{className:"text-text-muted",children:["Mature: ",u.jsx("strong",{children:le.mature})]})]})]})]})]}),u.jsx("div",{className:"bg-surface p-6 rounded-lg shadow-md border border-border",children:u.jsx(hE,{data:pe})})]}),u.jsxs("div",{className:"border-t border-border pt-6 flex flex-wrap items-center justify-center gap-4",children:[u.jsxs(Ot,{href:`/decks/${t.id}/study`,passAs:Se,variant:"primary",size:"lg",onClick:()=>i(t.id),disabled:Q===0&&!Y||!!t.locked,className:"font-semibold w-full sm:w-auto",children:[u.jsx(de,{name:t.locked?"lock":Y?"zap":"laptop",className:"w-5 h-5 mr-2"})," ",be]}),u.jsxs(Ot,{href:`/decks/${t.id}/cram`,passAs:Se,variant:"secondary",size:"lg",onClick:()=>i(t.id),disabled:R.length===0,className:"font-semibold w-full sm:w-auto",title:"Review all cards in random order, without affecting your SRS schedule.",children:[u.jsx(de,{name:"refresh-ccw",className:"w-5 h-5 mr-2"})," Cram"]}),t.type===We.Flashcard&&J.length>0&&u.jsxs(Ot,{href:`/decks/${t.id}/study-reversed`,passAs:Se,variant:"secondary",size:"lg",onClick:()=>i(t.id),disabled:!!t.locked,className:"font-semibold w-full sm:w-auto",title:"Study cards from back to front.",children:[u.jsx(de,{name:"repeat",className:"w-5 h-5 mr-2"})," Study Reversed"]}),t.type===We.Quiz&&J.length>0&&u.jsxs(Ot,{href:`/decks/${t.id}/study-flip`,passAs:Se,variant:"secondary",size:"lg",onClick:()=>i(t.id),disabled:!!t.locked,className:"font-semibold w-full sm:w-auto",children:[u.jsx(de,{name:"refresh-ccw",className:"w-5 h-5 mr-2"})," Review as Flashcards"]})]})]}),A==="items"&&u.jsx("div",{className:"bg-surface rounded-lg shadow-md border border-border animate-fade-in",children:t.type===We.Flashcard?u.jsx(uE,{cards:t.cards,onCardsChange:q=>n({...t,cards:q},{silent:!0}),onAddCard:q=>n({...t,cards:[...t.cards,{...q,id:crypto.randomUUID(),dueDate:new Date().toISOString(),interval:0,easeFactor:Oo}]},{silent:!0}),onBulkAdd:()=>T(!0)}):t.type===We.Quiz?u.jsx(fE,{questions:t.questions,onQuestionsChange:q=>n({...t,questions:q},{silent:!0}),onAddQuestion:q=>n({...t,questions:[...t.questions,{...q,id:crypto.randomUUID(),dueDate:new Date().toISOString(),interval:0,easeFactor:Oo}]},{silent:!0}),onBulkAdd:()=>T(!0)}):u.jsx("div",{className:"p-6 text-center text-text-muted",children:u.jsx("p",{children:"Unsupported deck type."})})}),A==="stats"&&u.jsx("div",{className:"animate-fade-in",children:u.jsx(xE,{deck:t})})]}),u.jsxs("div",{className:"bg-red-900/20 border border-red-500/30 rounded-lg p-6",children:[u.jsx("h3",{className:"text-xl font-semibold text-red-400 dark:text-red-300 mb-2",children:"Danger Zone"}),u.jsx("p",{className:"text-red-500/80 dark:text-red-300/80 mb-4",children:"Moving a deck to the trash will make it unavailable for study. It will be permanently deleted after 10 days."}),u.jsxs(Se,{variant:"danger",onClick:oe,children:[u.jsx(de,{name:"trash-2",className:"mr-2"})," Move to Trash"]})]}),b&&u.jsx(mE,{isOpen:b,onClose:()=>T(!1),onAddItems:$,deckType:t.type})]})},oo=({children:t})=>u.jsx("pre",{className:"bg-gray-100 dark:bg-gray-900/70 p-4 rounded-lg overflow-x-auto text-sm text-gray-800 dark:text-gray-200 border border-gray-200 dark:border-gray-700",children:u.jsx("code",{children:t})}),Dr=({title:t,iconName:e,children:n,defaultOpen:o=!1})=>{const[i,c]=B.useState(o);return u.jsxs("div",{className:"border border-gray-200 dark:border-gray-700 rounded-lg overflow-hidden",children:[u.jsxs("button",{onClick:()=>c(!i),className:"w-full flex justify-between items-center text-left p-4 bg-gray-50 dark:bg-gray-800/50 hover:bg-gray-100 dark:hover:bg-gray-700/50 transition-colors","aria-expanded":i,children:[u.jsxs("div",{className:"flex items-center",children:[e&&u.jsx(de,{name:e,className:"w-6 h-6 mr-3 text-gray-500 dark:text-gray-400"}),u.jsx("h3",{className:"text-xl font-semibold text-gray-800 dark:text-gray-200",children:t})]}),u.jsx(de,{name:"chevron-down",className:`w-6 h-6 transition-transform duration-300 ${i?"":"-rotate-90"} text-gray-500`})]}),i&&u.jsx("div",{className:"p-6 bg-white dark:bg-gray-800 animate-fade-in",children:n})]})},Rp=({fields:t})=>u.jsx("div",{className:"overflow-x-auto",children:u.jsxs("table",{className:"w-full text-left border-collapse mt-4 min-w-[500px]",children:[u.jsx("thead",{children:u.jsxs("tr",{children:[u.jsx("th",{className:"border-b-2 dark:border-gray-600 p-2 text-sm font-semibold text-gray-700 dark:text-gray-300",children:"Field"}),u.jsx("th",{className:"border-b-2 dark:border-gray-600 p-2 text-sm font-semibold text-gray-700 dark:text-gray-300",children:"Type"}),u.jsx("th",{className:"border-b-2 dark:border-gray-600 p-2 text-sm font-semibold text-gray-700 dark:text-gray-300",children:"Required"}),u.jsx("th",{className:"border-b-2 dark:border-gray-600 p-2 text-sm font-semibold text-gray-700 dark:text-gray-300",children:"Description"})]})}),u.jsx("tbody",{children:t.map(({field:e,type:n,description:o,required:i})=>u.jsxs("tr",{className:"border-b dark:border-gray-700/50",children:[u.jsx("td",{className:"p-2 align-top",children:u.jsx("code",{className:"bg-gray-200 dark:bg-gray-700 px-1 py-0.5 rounded-sm",children:e})}),u.jsx("td",{className:"p-2 align-top text-gray-600 dark:text-gray-400",children:n}),u.jsx("td",{className:"p-2 align-top",children:i?u.jsx(de,{name:"check-circle",className:"text-green-500"}):"No"}),u.jsx("td",{className:"p-2 align-top text-gray-600 dark:text-gray-400",children:o})]},e))})]})}),CE=()=>{const{addToast:t}=gn(),[e,n]=B.useState(""),[o,i]=B.useState("Beginner"),[c,f]=B.useState(""),[m,h]=B.useState(""),[p,v]=B.useState("Beginner"),[x,C]=B.useState("Beginner"),[S,b]=B.useState(null),T=["Novice","Beginner","Intermediate","Advanced","Expert","Mastery"],A=`[
  {
    "front": "What is the capital of France?",
    "back": "Paris"
  },
  {
    "front": "What is H2O?",
    "back": "Water"
  }
]`,D=`{
  "name": "Sample Science Quiz",
  "description": "A few questions to test your basic science knowledge.",
  "questions": [
    {
      "questionType": "multipleChoice",
      "questionText": "Which planet is known as the Red Planet?",
      "tags": ["astronomy", "planets"],
      "detailedExplanation": "Mars is often called the Red Planet...",
      "options": [
        { "id": "opt1", "text": "Venus" },
        { "id": "opt2", "text": "Mars" },
        { "id": "opt3", "text": "Jupiter", "explanation": "Jupiter is a gas giant..." }
      ],
      "correctAnswerId": "opt2"
    }
  ]
}`,F=[{field:"name",type:"string",required:!0,description:"The title of the quiz deck."},{field:"description",type:"string",required:!0,description:"A brief summary of the deck's content."},{field:"questions",type:"Array<Question>",required:!0,description:"An array containing all question objects for the deck."},{field:"questionType",type:"string",required:!0,description:'Must be "multipleChoice" for now.'},{field:"questionText",type:"string",required:!0,description:"The question being asked."},{field:"tags",type:"Array<string>",required:!1,description:"An array of keywords for organization."},{field:"detailedExplanation",type:"string",required:!0,description:"The full explanation shown after answering."},{field:"options",type:"Array<Option>",required:!0,description:"An array of possible answers."},{field:"correctAnswerId",type:"string",required:!0,description:"The `id` of the correct option."},{field:"options[].id",type:"string",required:!0,description:"A unique identifier for this option within the question."},{field:"options[].text",type:"string",required:!0,description:"The answer text shown to the user."},{field:"options[].explanation",type:"string",required:!1,description:"A brief explanation for why this specific option is right or wrong."}],L=`{
  "seriesName": "Intro to Web Development",
  "seriesDescription": "A progressive series covering the fundamentals of web development.",
  "levels": [
    {
      "title": "Level 1: The Foundation",
      "decks": [
        {
          "name": "Level 1.1: HTML Basics",
          "description": "The building blocks of the web.",
          "questions": [
            {
              "questionType": "multipleChoice",
              "questionText": "What does HTML stand for?",
              "tags": ["html", "basics"],
              "detailedExplanation": "HTML stands for HyperText Markup Language...",
              "options": [
                { "id": "1", "text": "HyperText Markup Language" },
                { "id": "2", "text": "High-Level Text Machine Language" }
              ],
              "correctAnswerId": "1"
            }
          ]
        },
        { "name": "Level 1.2: CSS Fundamentals", "description": "...", "questions": [] }
      ]
    }
  ]
}`,R=[{field:"seriesName",type:"string",required:!0,description:"The title for the entire series."},{field:"seriesDescription",type:"string",required:!0,description:"A brief summary of what the whole series covers."},{field:"levels",type:"Array<Level>",required:!0,description:"An array containing all the levels in the series."},{field:"levels[].title",type:"string",required:!0,description:'The heading for a group of decks (e.g., "Level 1: Core Concepts").'},{field:"levels[].decks",type:"Array<QuizDeck>",required:!0,description:"An array of quiz decks for that level. The schema for each deck is the same as the Single Quiz Deck format."}],P=`Please act as a world-class instructional designer and subject matter expert. Your task is to generate a comprehensive, detailed, and world-class TEXT outline for a learning path. The output must be plain text, not a JSON object.

**Topic:** [YOUR TOPIC HERE]
**User's Current Level:** [USER'S LEVEL HERE]

The goal is to create a structured and progressive learning path that guides the user towards mastery, similar in quality and detail to the provided example structure.

**INSTRUCTIONS & REQUIREMENTS:**

1.  **Learning Path Structure:**
    -   Organize the learning path into logical "Levels" (e.g., Level 1, Level 2, up to Level 4 or 5). Each level must have a title and represent a significant step up in knowledge.
    -   Each Level should contain one or more related "Decks".
    -   The name of each deck must reflect this structure, e.g., "Level 1.1: Foundations of X", "Level 1.2: Core Concepts of Y", "Level 2.1: Advanced Techniques in Z".

2.  **High-Quality Content (Crucial):**
    -   **Series Name & Description:** Create a compelling and descriptive name (e.g., "Topic Mastery Path: The Contextual Approach") and a comprehensive summary for the entire learning path.
    -   **Level Goal & Focus:** For each Level, provide a clear "Goal" and "Focus".
    -   **Deck Topics:** For each Deck, provide a detailed, itemized list of specific "Topics" to be covered.
    -   **Progressive Difficulty:** The path must be logically sequenced, starting with foundational definitions and historical context, moving to practical applications, then to assessment and planning, and finally to interdisciplinary challenges.
    -   **Context-Specific:** If the user's topic has a specific context (e.g., a geographical location, a particular framework), embed that context deeply into the entire outline.
    -   **Approximate Question Count:** Suggest an approximate number of questions for each deck.

**EXAMPLE STRUCTURE:**
Ecological Sustainable Forestry Mastery Path: The Scanian Approach
This learning path provides a deep understanding of...
Level 1: Core Principles & Historical Context in Skåne
Goal: Define ecological sustainable forestry...
Focus: Shifting from purely extractive forestry...
Level 1.1: Foundations of Sustainable Forest Management (SFM) in Skåne
Topics: Definitional evolution of forestry...
Approx. Questions: 30-40

---

Now, based on all the above requirements, generate the complete text outline.

Finally, at the very end of your response, provide a JSON object with the series name and description you created, like this:
{
  "seriesName": "The full series name you generated above",
  "seriesDescription": "The full series description you generated above"
}
`,G=`You are an expert content creator. I have provided a text outline for a learning path. Your task is to convert this outline into a structured JSON object that will serve as a scaffold.

**PRIMARY INSTRUCTIONS:**

1.  **Source Material:** Use ONLY the text outline I've provided as your source.
2.  **Structure:** Create a single JSON object with \`seriesName\`, \`seriesDescription\`, and a \`levels\` array.
3.  **Levels and Decks:** Inside the \`levels\` array, create objects for each level, including its \`title\`. Each level object should have a \`decks\` array. Populate this with deck objects, each containing its \`name\` and \`description\` from the outline.
4.  **Empty Questions:** For every deck object, include a \`"questions": []\` key-value pair. The questions array MUST be empty.

**JSON OUTPUT FORMAT:**
- The final output MUST be ONLY a single, raw JSON object, starting with \`{\` and ending with \`}\`. Do not include any surrounding text, explanations, or markdown formatting.
- The JSON object must follow this exact schema:
{
  "seriesName": "The full series name from the outline",
  "seriesDescription": "The full series description from the outline",
  "levels": [
    {
      "title": "The title of the first level",
      "decks": [
        {
          "name": "The name of the first deck in this level",
          "description": "The description for this deck",
          "questions": []
        },
        {
          "name": "The name of the second deck in this level",
          "description": "The description for this deck",
          "questions": []
        }
      ]
    }
  ]
}

Now, based on the text outline I provided, please generate the complete JSON scaffold.`,$=`You are an expert content creator. I have provided a text outline for a learning path. Your task is to generate the JSON for the **first deck (e.g., Level 1.1)** from that outline.

**PRIMARY INSTRUCTIONS:**

1.  **Source Material:** Use ONLY the text outline I've provided as your source.
2.  **Question Quantity:** Generate the approximate number of questions specified in the outline for this first deck.
3.  **Content Generation:** Create world-class questions and answers based *only* on the "Topics" listed for this specific deck in the outline.

**CRITICAL CONTENT QUALITY REQUIREMENTS:**
- **Factual Accuracy:** This is paramount. The correct answer and all parts of the explanation must be unequivocally correct and verifiable.
- **Relevance & Practical Application:** Frame questions in real-world scenarios to help a user apply the information. Questions must be relevant to the deck's topics.
- **Clarity & Simplicity:** Questions must be easy to understand, unambiguous, and free of jargon (unless the jargon is the learning objective). Test only one core concept per question.
- **Problem-Solving Focus:** Design questions that require applying knowledge, not just recalling facts. Avoid trivial pursuit and focus on genuinely useful information. For practical topics, ask skill-based questions that test the ability to perform a task or make a decision.
- **High-Quality Explanations:** The \`detailedExplanation\` is crucial. It must explain the reasoning, principles, or facts behind the correct answer. Provide additional context, examples, or connections to related concepts to deepen understanding. If applicable, cite sources for complex information.
- **Engaging Content:** While factual, make the questions and explanations as engaging as possible to maintain learner interest.

**JSON OUTPUT FORMAT:**
- The final output MUST be ONLY a single, raw JSON object, starting with \`{\` and ending with \`}\`. Do not include any surrounding text, explanations, or markdown formatting.
- The JSON object must follow this exact schema:
{
  "name": "The exact name for the deck from your outline, e.g., 'Level 1.1: Foundations...'",
  "description": "A concise description of this specific deck's content, based on its topics.",
  "questions": [
    {
      "questionType": "multipleChoice",
      "questionText": "The text of the first question...",
      "tags": ["relevant", "tags"],
      "detailedExplanation": "A thorough explanation that meets all quality requirements.",
      "options": [
        { "id": "q1_opt1", "text": "First answer option" },
        { "id": "q1_opt2", "text": "Second answer option" }
      ],
      "correctAnswerId": "q1_opt2"
    }
  ]
}

Now, based on the text outline I provided, please generate the JSON for the **first deck**.`,oe=`Please act as an expert instructional designer and generate a complete, structured Deck Series in a single JSON object.

**Topic:** [YOUR TOPIC HERE]
**User's Current Level:** [USER'S LEVEL HERE]

**CONTENT REQUIREMENTS FOR ALL QUESTIONS:**
-   **Factual Accuracy:** All correct answers and explanations must be verifiable and factually correct.
-   **Practical Application:** Frame questions to enable the user to put the learned information into practice.
-   **Clarity:** Questions must be easy to understand and unambiguous.

**FINAL JSON OUTPUT FORMAT:**
The final output MUST be ONLY a single, raw JSON object without any surrounding text or markdown. The root object must have this exact schema:
{
  "seriesName": "A descriptive name for the whole series",
  "seriesDescription": "A brief description of what the series covers.",
  "levels": [
    {
      "title": "Level 1: The Basics",
      "decks": [
        {
          "name": "Level 1.1: Deck Name",
          "description": "Description of this deck's content.",
          "questions": [
            {
              "questionType": "multipleChoice",
              "questionText": "...",
              "tags": ["tag1", "tag2"],
              "detailedExplanation": "...",
              "options": [ { "id": "q1_opt1", "text": "..." }, { "id": "q1_opt2", "text": "..." } ],
              "correctAnswerId": "q1_opt2"
            }
          ]
        }
      ]
    }
  ]
}

Now, generate the complete JSON object based on all the above requirements.`,J='Please generate a JSON object for a single multiple-choice quiz.\n\n**Topic:** [YOUR TOPIC HERE]\n**Designed for Level:** [USER\'S LEVEL HERE]\n\n**CONTENT REQUIREMENTS:**\n-   **Factual Accuracy:** All correct answers and explanations must be verifiable and factually correct.\n-   **Relevance:** Questions must be directly pertinent to the chosen topic and appropriate for the specified level.\n-   **Practical Application:** Frame questions to enable the user to put the learned information into practice.\n-   **Question Quantity:** Generate 10-100 high-quality questions. Do not include multiple questions that are essentially asking the same thing.\n-   **Clarity:** Questions must be easy to understand and unambiguous.\n-   **Problem-Solving Focus:** Prioritize questions that require applying knowledge to solve a problem.\n-   **Explanation Quality:** The `detailedExplanation` must explain the reasoning behind the correct answer and provide additional context.\n\n**JSON SCHEMA & RULES:**\n-   The final output must be ONLY the raw JSON object, starting with `{` and ending with `}`.\n-   The root object must contain `name`, `description`, and `questions` (array).\n-   Each question object must contain `questionType` ("multipleChoice"), `questionText`, `tags` (array), `detailedExplanation`, `options` (array), and `correctAnswerId`.\n-   Each option object must contain a unique `id` and `text`.\n-   Do NOT include top-level SRS fields like `id` or `dueDate` on the questions.\n\nNow, generate the complete JSON deck based on all the above requirements.',Z=(be,ve)=>{navigator.clipboard.writeText(be).then(()=>{t("Prompt copied to clipboard!","success"),b(ve),setTimeout(()=>b(null),2e3)}).catch(xe=>{t("Failed to copy prompt.","error"),console.error("Could not copy text: ",xe)})},le=()=>{const be=e.trim()||"[YOUR TOPIC HERE]",ve=P.replace("[YOUR TOPIC HERE]",be).replace("[USER'S LEVEL HERE]",o);Z(ve,"outline-prompt")},Q=()=>{Z(G,"scaffold-prompt")},Y=()=>{Z($,"deck-from-outline-prompt")},M=()=>{const be=c.trim()||"[YOUR TOPIC HERE]",ve=oe.replace("[YOUR TOPIC HERE]",be).replace("[USER'S LEVEL HERE]",p);Z(ve,"series-prompt")},pe=()=>{const be=m.trim()||"[YOUR TOPIC HERE]",ve=J.replace("[YOUR TOPIC HERE]",be).replace("[USER'S LEVEL HERE]",x);Z(ve,"quiz-prompt")};return u.jsxs("div",{className:"max-w-4xl mx-auto animate-fade-in space-y-6 pb-10",children:[u.jsxs("div",{children:[u.jsx("h1",{className:"text-4xl font-bold text-gray-900 dark:text-gray-100",children:"AI & JSON Import Guide"}),u.jsx("p",{className:"mt-2 text-lg text-gray-500 dark:text-gray-400",children:"Use this expert-led workflow to generate high-quality learning content with AI, or follow the formats to import your own data."})]}),u.jsx(Dr,{title:"Step 1: Generate Learning Outline (Text)",iconName:"list",defaultOpen:!0,children:u.jsxs("div",{className:"space-y-4 bg-green-900/10 dark:bg-green-900/20 p-6 rounded-lg border border-green-500/20",children:[u.jsx("p",{className:"text-green-800/90 dark:text-green-200/90",children:"Begin by generating a high-level, human-readable outline for your learning path using an external AI chat service. This allows you to review and approve the structure before generating the full content."}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[u.jsxs("div",{children:[u.jsx("label",{htmlFor:"outline-topic-input",className:"block text-sm font-medium text-green-700 dark:text-green-300",children:"Enter Topic"}),u.jsx("input",{id:"outline-topic-input",type:"text",value:e,onChange:be=>n(be.target.value),className:"w-full p-2 mt-1 bg-green-50 dark:bg-gray-900 border border-green-300 dark:border-green-700 rounded-md focus:ring-2 focus:ring-green-500 focus:outline-none",placeholder:"e.g., The History of Ancient Rome"})]}),u.jsxs("div",{children:[u.jsx("label",{htmlFor:"outline-level-select",className:"block text-sm font-medium text-green-700 dark:text-green-300",children:"My Current Level Is"}),u.jsx("select",{id:"outline-level-select",value:o,onChange:be=>i(be.target.value),className:"w-full p-2 mt-1 bg-green-50 dark:bg-gray-900 border border-green-300 dark:border-green-700 rounded-md focus:ring-2 focus:ring-green-500 focus:outline-none",children:T.map(be=>u.jsx("option",{value:be,children:be},be))})]})]}),u.jsx("p",{className:"text-xs text-green-600/80 dark:text-green-400/80 mt-1",children:"Your topic and level will be inserted into the prompt."}),u.jsxs("div",{className:"relative",children:[u.jsx(oo,{children:P}),u.jsx(Se,{variant:"secondary",className:"absolute top-2 right-2 px-2 py-1 text-xs bg-gray-200/50 dark:bg-gray-900/50 border border-gray-300 dark:border-gray-600",onClick:le,children:S==="outline-prompt"?u.jsxs(u.Fragment,{children:[u.jsx(de,{name:"check-circle",className:"w-4 h-4 mr-1"})," Copied!"]}):u.jsxs(u.Fragment,{children:[u.jsx(de,{name:"download",className:"w-4 h-4 mr-1"})," Copy Prompt"]})})]})]})}),u.jsx(Dr,{title:"Step 2: Create the Series Scaffold",iconName:"code",children:u.jsxs("div",{className:"space-y-4 bg-yellow-900/10 dark:bg-yellow-900/20 p-6 rounded-lg border border-yellow-500/20",children:[u.jsx("p",{className:"text-yellow-800/90 dark:text-yellow-200/90",children:'You can now create the series structure in CogniFlow. Use the in-app "Generate with AI" feature with your topic. This will automatically create the series with empty decks, ready for you to populate.'}),u.jsx("p",{className:"text-sm text-yellow-700/90 dark:text-yellow-300/90",children:'Alternatively, you can manually convert your text outline from Step 1 into a JSON "scaffold" using the prompt below and import it via the "Create / Import" modal.'}),u.jsxs("div",{className:"relative",children:[u.jsx(oo,{children:G}),u.jsx(Se,{variant:"secondary",className:"absolute top-2 right-2 px-2 py-1 text-xs bg-gray-200/50 dark:bg-gray-900/50 border border-gray-300 dark:border-gray-600",onClick:Q,children:S==="scaffold-prompt"?u.jsxs(u.Fragment,{children:[u.jsx(de,{name:"check-circle",className:"w-4 h-4 mr-1"})," Copied!"]}):u.jsxs(u.Fragment,{children:[u.jsx(de,{name:"download",className:"w-4 h-4 mr-1"})," Copy Prompt"]})})]})]})}),u.jsx(Dr,{title:"Step 3: Generate Questions for Each Deck",iconName:"zap",children:u.jsxs("div",{className:"space-y-4 bg-blue-900/10 dark:bg-blue-900/20 p-6 rounded-lg border border-blue-500/20",children:[u.jsx("p",{className:"text-blue-800/90 dark:text-blue-200/90",children:'Navigate to your newly created series page in CogniFlow. Each empty deck will have a "Generate Questions" button. Click it to have the AI populate that specific deck with high-quality, relevant questions automatically.'}),u.jsx("p",{className:"text-sm text-blue-700/90 dark:text-blue-300/90",children:"If you are working with an external AI and your JSON scaffold from Step 2, you can use the prompt below to generate the questions for each deck. Paste your text outline into the chat first, then use the prompt. Copy the generated `questions` array into the correct deck in your scaffold JSON. Repeat for all decks, then import the final JSON file."}),u.jsxs("div",{className:"relative",children:[u.jsx(oo,{children:$}),u.jsx(Se,{variant:"secondary",className:"absolute top-2 right-2 px-2 py-1 text-xs bg-gray-200/50 dark:bg-gray-900/50 border border-gray-300 dark:border-gray-600",onClick:Y,children:S==="deck-from-outline-prompt"?u.jsxs(u.Fragment,{children:[u.jsx(de,{name:"check-circle",className:"w-4 h-4 mr-1"})," Copied!"]}):u.jsxs(u.Fragment,{children:[u.jsx(de,{name:"download",className:"w-4 h-4 mr-1"})," Copy Prompt"]})})]})]})}),u.jsx(Dr,{title:"Alternative: Generate Full Series at Once (JSON)",iconName:"zap",children:u.jsxs("div",{className:"space-y-4 bg-purple-900/10 dark:bg-purple-900/20 p-6 rounded-lg border border-purple-500/20",children:[u.jsx("p",{className:"text-purple-700/90 dark:text-purple-300/90",children:"For a faster, one-shot approach, use this powerful prompt to generate a complete, structured learning path on any topic. This is less controlled but much quicker."}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[u.jsxs("div",{children:[u.jsx("label",{htmlFor:"series-topic-input",className:"block text-sm font-medium text-purple-700 dark:text-purple-300",children:"Enter Topic"}),u.jsx("input",{id:"series-topic-input",type:"text",value:c,onChange:be=>f(be.target.value),className:"w-full p-2 mt-1 bg-purple-50 dark:bg-gray-900 border border-purple-300 dark:border-purple-700 rounded-md focus:ring-2 focus:ring-purple-500 focus:outline-none",placeholder:"e.g., Quantum Physics"})]}),u.jsxs("div",{children:[u.jsx("label",{htmlFor:"series-level-select",className:"block text-sm font-medium text-purple-700 dark:text-purple-300",children:"My Current Level Is"}),u.jsx("select",{id:"series-level-select",value:p,onChange:be=>v(be.target.value),className:"w-full p-2 mt-1 bg-purple-50 dark:bg-gray-900 border border-purple-300 dark:border-purple-700 rounded-md focus:ring-2 focus:ring-purple-500 focus:outline-none",children:T.map(be=>u.jsx("option",{value:be,children:be},be))})]})]}),u.jsx("p",{className:"text-xs text-purple-600/80 dark:text-purple-400/80 mt-1",children:"Your topic and level will be inserted into the prompt."}),u.jsxs("div",{className:"relative",children:[u.jsx(oo,{children:oe}),u.jsx(Se,{variant:"secondary",className:"absolute top-2 right-2 px-2 py-1 text-xs bg-gray-200/50 dark:bg-gray-900/50 border border-gray-300 dark:border-gray-600",onClick:M,children:S==="series-prompt"?u.jsxs(u.Fragment,{children:[u.jsx(de,{name:"check-circle",className:"w-4 h-4 mr-1"})," Copied!"]}):u.jsxs(u.Fragment,{children:[u.jsx(de,{name:"download",className:"w-4 h-4 mr-1"})," Copy Prompt"]})})]})]})}),u.jsx(Dr,{title:"Alternative: Generate a Single Quiz Deck",iconName:"zap",children:u.jsxs("div",{className:"space-y-4 bg-blue-900/10 dark:bg-blue-900/20 p-6 rounded-lg border border-blue-500/20",children:[u.jsx("p",{className:"text-blue-700/90 dark:text-blue-300/90",children:"Use this prompt to generate a single quiz deck on any topic, tailored to a specific difficulty level."}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[u.jsxs("div",{children:[u.jsx("label",{htmlFor:"quiz-topic-input",className:"block text-sm font-medium text-blue-700 dark:text-blue-300",children:"Enter Topic"}),u.jsx("input",{id:"quiz-topic-input",type:"text",value:m,onChange:be=>h(be.target.value),className:"w-full p-2 mt-1 bg-blue-50 dark:bg-gray-900 border border-blue-300 dark:border-blue-700 rounded-md focus:ring-2 focus:ring-blue-500 focus:outline-none",placeholder:"e.g., The Roman Empire"})]}),u.jsxs("div",{children:[u.jsx("label",{htmlFor:"quiz-level-select",className:"block text-sm font-medium text-blue-700 dark:text-blue-300",children:"Deck Difficulty Level"}),u.jsx("select",{id:"quiz-level-select",value:x,onChange:be=>C(be.target.value),className:"w-full p-2 mt-1 bg-blue-50 dark:bg-gray-900 border border-blue-300 dark:border-blue-700 rounded-md focus:ring-2 focus:ring-blue-500 focus:outline-none",children:T.map(be=>u.jsx("option",{value:be,children:be},be))})]})]}),u.jsxs("div",{className:"relative",children:[u.jsx(oo,{children:J}),u.jsx(Se,{variant:"secondary",className:"absolute top-2 right-2 px-2 py-1 text-xs bg-gray-200/50 dark:bg-gray-900/50 border border-gray-300 dark:border-gray-600",onClick:pe,children:S==="quiz-prompt"?u.jsxs(u.Fragment,{children:[u.jsx(de,{name:"check-circle",className:"w-4 h-4 mr-1"})," Copied!"]}):u.jsxs(u.Fragment,{children:[u.jsx(de,{name:"download",className:"w-4 h-4 mr-1"})," Copy Prompt"]})})]})]})}),u.jsxs(Dr,{title:"Format 1: Full Deck Series (JSON)",iconName:"list",children:[u.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-4",children:"To import an entire learning path at once, provide a single JSON object containing the series details and a `levels` array. Each level has a title and contains its own array of decks."}),u.jsx(oo,{children:L}),u.jsx("h4",{className:"text-lg font-semibold mt-6 mb-2",children:"Field Definitions"}),u.jsx(Rp,{fields:R})]}),u.jsxs(Dr,{title:"Format 2: Single Quiz Deck (JSON)",iconName:"help-circle",children:[u.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-4",children:"For a single multiple-choice quiz, provide a JSON object with a name, description, and an array of question objects. See the field definitions below for more details."}),u.jsx(oo,{children:D}),u.jsx("h4",{className:"text-lg font-semibold mt-6 mb-2",children:"Field Definitions"}),u.jsx(Rp,{fields:F})]}),u.jsxs(Dr,{title:"Format 3: Simple Flashcard Deck (JSON)",iconName:"laptop",children:[u.jsxs("p",{className:"text-gray-600 dark:text-gray-400 mb-4",children:["For basic front-and-back flashcards, provide a JSON array. Each object in the array must have a ",u.jsx("code",{className:"bg-gray-200 dark:bg-gray-700 px-1 py-0.5 rounded-sm",children:"front"})," and a ",u.jsx("code",{className:"bg-gray-200 dark:bg-gray-700 px-1 py-0.5 rounded-sm",children:"back"})," key, both with string values. This format is ideal for quick, manual creation or for exporting from other simple flashcard apps."]}),u.jsx(oo,{children:A})]}),u.jsx(Dr,{title:"General Tips & Troubleshooting",iconName:"settings",children:u.jsxs("ul",{className:"space-y-4 list-disc list-inside text-gray-600 dark:text-gray-400",children:[u.jsxs("li",{children:[u.jsx("strong",{children:"Validate Your JSON:"})," Before importing, it's a good idea to paste your JSON into an online validator to check for syntax errors. A common mistake is a trailing comma after the last item in an array or object.",u.jsx("br",{}),u.jsx("code",{children:'[ { "key": "value" }, ] &larr; Invalid Trailing Comma'})]}),u.jsxs("li",{children:[u.jsx("strong",{children:"Check Your Quotes:"}),` All keys and string values in JSON must be enclosed in double quotes ("). Single quotes (') are not valid.`]}),u.jsxs("li",{children:[u.jsx("strong",{children:"Schema Mismatches:"}),' Ensure your JSON structure matches one of the three formats above. For example, pasting an array of flashcards into the "Bulk Add" modal inside a quiz deck will fail. The main "Import" modal is more flexible and can detect the format automatically.']}),u.jsxs("li",{children:[u.jsx("strong",{children:"Unique IDs:"}),' When creating quiz questions, ensure the `id` for each option within a single question is unique. You can use simple strings like "opt1", "opt2", or a UUID.']}),u.jsxs("li",{children:[u.jsx("strong",{children:"AI-Generated Content:"})," Always review content generated by an AI for factual accuracy before studying it. The prompts are designed to request accuracy, but AI can still make mistakes."]})]})})]})},Pp=t=>{if(!t)return 0;const e=new Date;return e.setHours(23,59,59,999),t.questions.filter(n=>!n.suspended&&new Date(n.dueDate)<=e).length},SE=({series:t,sessionsToResume:e,onUpdateSeries:n,onDeleteSeries:o,onAddDeckToSeries:i,onUpdateDeck:c,onStartSeriesStudy:f,onUpdateLastOpened:m,openConfirmModal:h,onAiAddLevelsToSeries:p,onAiAddDecksToLevel:v})=>{const{decks:x,seriesProgress:C,aiGenerationStatus:S,dispatch:b}=yt(),{navigate:T,path:A}=Rr(),{addToast:D}=gn(),[F,L]=B.useState(!1),[R,P]=B.useState(!1),[G,$]=B.useState(t.name),[oe,J]=B.useState(t.description),[Z,le]=B.useState(!1),[Q,Y]=B.useState(null);B.useEffect(()=>{new URLSearchParams(A.split("?")[1]).get("edit")==="true"&&(L(!0),T(`/series/${t.id}`,{replace:!0}))},[A,t.id,T]),B.useEffect(()=>{m(t.id)},[t.id,m]),B.useEffect(()=>{(t.archived||t.deletedAt)&&T("/series")},[t.archived,t.deletedAt,T]);const M=B.useMemo(()=>{const X=new Map,se=new Set(t.levels.flatMap(ae=>ae.deckIds));return x.forEach(ae=>{se.has(ae.id)&&ae.type===We.Quiz&&X.set(ae.id,ae)}),X},[t.levels,x]),pe=B.useMemo(()=>C.get(t.id)||new Set,[C,t.id]),be=t.levels.reduce((X,se)=>X+se.deckIds.length,0),{totalDueCount:ve,averageMastery:xe}=B.useMemo(()=>{let X=0;const se=[];let ae=0;for(const Ae of t.levels)for(const Ne of Ae.deckIds){const je=M.get(Ne);je&&(ae<=pe.size&&(X+=Pp(je)),se.push(...je.questions.filter(De=>!De.suspended))),ae++}const ke=se.length>0?se.reduce((Ae,Ne)=>Ae+sr(Ne),0)/se.length:0;return{totalDueCount:X,averageMastery:ke}},[t.levels,M,pe]),te=()=>{n({...t,name:G,description:oe}),P(!1)},q=()=>{const X=t.levels.reduce((se,ae)=>se+ae.deckIds.length,0);h({title:"Move Series to Trash",message:`Are you sure you want to move the series "${t.name}" and all of its ${X} deck(s) to the trash?`,onConfirm:()=>o(t.id)})},N=X=>{if(S.isGenerating){D("An AI generation task is already in progress.","info");return}b({type:"SET_AI_GENERATION_STATUS",payload:{isGenerating:!0,generatingDeckId:X.id,generatingSeriesId:t.id}}),D(`AI is now generating questions for "${X.name}". This will continue in the background.`,"info"),(async()=>{try{const se=await Np(t,[X],(ae,ke)=>{const Ae=io(ke),Ne=M.get(ae);if(Ne){const je={...Ne,questions:Ae};c(je)}});n({...t,aiChatHistory:se},{silent:!0}),D(`Successfully generated questions for "${X.name}"!`,"success")}catch(se){const ae=se instanceof Error?se.message:"An unknown error occurred during AI generation.";D(ae,"error")}finally{yt.getState().aiGenerationStatus.generatingDeckId===X.id&&b({type:"SET_AI_GENERATION_STATUS",payload:{isGenerating:!1,generatingDeckId:null,generatingSeriesId:null}})}})()},j=()=>{if(S.isGenerating){D("An AI generation task is already in progress.","info");return}const X=Array.from(M.values()).filter(se=>{var ae;return(((ae=se.questions)==null?void 0:ae.length)||0)===0});if(X.length===0){D("All decks in this series already have questions.","info");return}b({type:"SET_AI_GENERATION_STATUS",payload:{isGenerating:!0,generatingDeckId:X[0].id,generatingSeriesId:t.id}}),D(`AI is generating questions for ${X.length} empty decks. This will continue in the background.`,"info"),(async()=>{try{const se=await Np(t,X,(ae,ke)=>{const Ae=io(ke),Ne=X.find(E=>E.id===ae);if(Ne){const E={...Ne,questions:Ae};c(E)}const je=X.findIndex(E=>E.id===ae),De=X[je+1];De&&b({type:"SET_AI_GENERATION_STATUS",payload:{isGenerating:!0,generatingDeckId:De.id,generatingSeriesId:t.id}})});n({...t,aiChatHistory:se},{silent:!0}),D("Successfully generated questions for all empty decks!","success")}catch(se){const ae=se instanceof Error?se.message:"An unknown error occurred during AI generation.";D(ae,"error")}finally{yt.getState().aiGenerationStatus.generatingSeriesId===t.id&&b({type:"SET_AI_GENERATION_STATUS",payload:{isGenerating:!1,generatingDeckId:null,generatingSeriesId:null}})}})()},O=async()=>{le(!0);try{await p(t.id)}catch(X){const se=X instanceof Error?X.message:"Failed to add levels.";D(se,"error")}finally{le(!1)}},V=async X=>{Y(X);try{await v(t.id,X)}catch(se){const ae=se instanceof Error?se.message:"Failed to add decks.";D(ae,"error")}finally{Y(null)}},K=B.useMemo(()=>Array.from(M.values()).some(X=>{var se;return(((se=X.questions)==null?void 0:se.length)||0)===0}),[M]);return u.jsxs("div",{className:"max-w-4xl mx-auto animate-fade-in space-y-6",children:[u.jsx("div",{className:"bg-surface rounded-lg shadow-md p-6 border border-border",children:R?u.jsxs("div",{className:"space-y-4",children:[u.jsxs("div",{children:[u.jsx("label",{htmlFor:"series-name-edit",className:"block text-sm font-medium text-text-muted mb-1",children:"Series Name"}),u.jsx("input",{id:"series-name-edit",type:"text",value:G,onChange:X=>$(X.target.value),className:"w-full p-2 bg-background border border-border rounded-md focus:ring-2 focus:ring-primary focus:outline-none text-2xl font-bold",autoFocus:!0})]}),u.jsxs("div",{children:[u.jsx("label",{htmlFor:"series-desc-edit",className:"block text-sm font-medium text-text-muted mb-1",children:"Description"}),u.jsx("textarea",{id:"series-desc-edit",value:oe,onChange:X=>J(X.target.value),rows:3,className:"w-full p-2 bg-background border border-border rounded-md focus:ring-2 focus:ring-primary focus:outline-none"})]}),u.jsxs("div",{className:"flex justify-start gap-2 pt-2",children:[u.jsxs(Se,{onClick:te,children:[u.jsx(de,{name:"save",className:"mr-2"})," Save Changes"]}),u.jsx(Se,{variant:"secondary",onClick:()=>P(!1),children:"Cancel"})]})]}):u.jsxs("div",{children:[u.jsx("h2",{className:"text-3xl font-bold mb-2 text-text break-words",children:t.name}),u.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[u.jsxs(Se,{variant:"ghost",onClick:()=>P(!0),children:[u.jsx(de,{name:"edit",className:"mr-2"})," Edit"]}),u.jsxs(Se,{variant:"ghost",onClick:()=>n({...t,archived:!0}),children:[u.jsx(de,{name:"archive",className:"mr-2"})," Archive"]}),u.jsxs(Se,{variant:"ghost",onClick:()=>L(X=>!X),children:[u.jsx(de,{name:"list",className:"mr-2"})," ",F?"Done Organizing":"Organize"]})]}),u.jsx("p",{className:"text-text-muted mt-1 prose dark:prose-invert max-w-none",children:t.description})]})}),u.jsxs("div",{className:"bg-surface rounded-lg shadow-md p-6 border border-border space-y-4",children:[u.jsxs("div",{children:[u.jsxs("div",{className:"flex justify-between items-center text-sm mb-1",children:[u.jsx("span",{className:"font-medium text-text-muted",children:"Completion"}),u.jsxs("span",{className:"font-semibold text-text-muted",children:[pe.size," / ",be," Decks"]})]}),u.jsx(Mc,{current:pe.size,total:be})]}),u.jsxs("div",{children:[u.jsx("h4",{className:"text-sm font-medium text-text-muted mb-1",children:"Overall Mastery"}),u.jsx(ao,{level:xe})]}),u.jsxs("div",{className:"border-t border-border pt-4 flex flex-wrap items-center justify-center gap-4",children:[u.jsxs(Se,{variant:"primary",size:"lg",onClick:()=>f(t.id),disabled:ve===0,className:"font-semibold w-full sm:w-auto",children:[u.jsx(de,{name:"zap",className:"w-5 h-5 mr-2"}),"Study Due Items (",ve,")"]}),K&&u.jsxs(Se,{variant:"secondary",size:"lg",onClick:j,disabled:S.isGenerating,className:"font-semibold w-full sm:w-auto",children:[S.isGenerating&&S.generatingSeriesId===t.id?u.jsx(Ln,{size:"sm"}):u.jsx(de,{name:"zap",className:"w-5 h-5 mr-2"}),"Generate All Questions"]})]})]}),u.jsxs("div",{className:"space-y-6",children:[t.levels.map((X,se)=>{let ae=0;for(let ke=0;ke<se;ke++)ae+=t.levels[ke].deckIds.length;return u.jsxs("div",{className:"bg-surface rounded-lg shadow-md border border-border p-6",children:[u.jsx("h3",{className:"text-xl font-bold text-text mb-4",children:X.title}),u.jsx("div",{className:"space-y-4",children:X.deckIds.map((ke,Ae)=>{var W;const Ne=M.get(ke),je=ae+Ae,De=pe.has(ke),E=je>pe.size,fe=Pp(Ne);if(!Ne)return u.jsxs("div",{className:"text-red-500",children:["Deck with ID ",ke," not found."]},ke);const ce=S.isGenerating&&S.generatingDeckId===Ne.id;return u.jsxs("div",{className:`p-4 rounded-lg flex items-center justify-between transition-opacity ${E?"opacity-50 bg-background":"bg-background"}`,children:[u.jsxs("div",{className:"flex items-center min-w-0",children:[u.jsx("div",{className:`mr-4 flex-shrink-0 ${E?"text-text-muted":De?"text-green-500":"text-primary"}`,children:E?u.jsx(de,{name:"lock"}):De?u.jsx(de,{name:"check-circle"}):u.jsx(de,{name:"unlock"})}),u.jsxs("div",{className:"min-w-0",children:[u.jsx("p",{className:`font-bold truncate ${E?"text-text-muted":"text-text"}`,children:Ne.name}),u.jsx("p",{className:"text-sm text-text-muted truncate",children:Ne.description}),u.jsxs("p",{className:"text-xs text-text-muted mt-1",children:[Ne.questions.length," questions",!E&&` • ${fe} due`]})]})]}),u.jsxs("div",{className:"flex-shrink-0 ml-4 flex items-center gap-2",children:[F&&(((W=Ne.questions)==null?void 0:W.length)||0)===0&&u.jsxs(Se,{variant:"ghost",size:"sm",onClick:()=>N(Ne),disabled:ce||S.isGenerating,children:[ce?u.jsx(Ln,{size:"sm"}):u.jsx(de,{name:"zap",className:"w-4 h-4 mr-1"})," Generate"]}),u.jsx(Ot,{href:`/decks/${Ne.id}/study?seriesId=${t.id}`,passAs:Se,variant:"secondary",size:"sm",disabled:E,children:"Study"})]})]},ke)})}),F&&u.jsx("div",{className:"mt-4 pt-4 border-t border-border/50 flex justify-end",children:u.jsxs(Se,{variant:"ghost",size:"sm",onClick:()=>V(se),disabled:Q===se||Z||S.isGenerating,children:[Q===se?u.jsx(Ln,{size:"sm"}):u.jsx(de,{name:"zap",className:"w-4 h-4 mr-2"}),"Add Decks with AI"]})})]},se)}),F&&u.jsx("div",{className:"mt-4 pt-4 flex justify-center",children:u.jsxs(Se,{variant:"secondary",onClick:O,disabled:Z||Q!==null||S.isGenerating,children:[Z?u.jsx(Ln,{size:"sm"}):u.jsx(de,{name:"zap",className:"w-5 h-5 mr-2"}),"Add Levels with AI"]})})]}),u.jsxs("div",{className:"bg-red-900/20 border border-red-500/30 rounded-lg p-6",children:[u.jsx("h3",{className:"text-xl font-semibold text-red-400 dark:text-red-300 mb-2",children:"Danger Zone"}),u.jsx("p",{className:"text-red-500/80 dark:text-red-300/80 mb-4",children:"Moving a series to the trash will also move all of its decks to the trash."}),u.jsxs(Se,{variant:"danger",onClick:q,children:[u.jsx(de,{name:"trash-2",className:"mr-2"})," Move to Trash"]})]})]})},kE=({onUpdateDeck:t,onUpdateSeries:e,onDeleteDeck:n,onDeleteSeries:o,openConfirmModal:i})=>{const{decks:c,deckSeries:f}=yt(),m=B.useMemo(()=>c.filter(S=>S.archived&&!S.deletedAt),[c]),h=B.useMemo(()=>f.filter(S=>S.archived&&!S.deletedAt),[f]),p=S=>{t({...S,archived:!1})},v=S=>{e({...S,archived:!1})},x=S=>{i({title:"Move Deck to Trash",message:`Are you sure you want to move the archived deck "${S.name}" to the trash? This will un-archive it and place it in the trash for 10 days, after which it will be permanently deleted.`,onConfirm:()=>n(S.id)})},C=S=>{i({title:"Move Series to Trash",message:`Are you sure you want to move the archived series "${S.name}" to the trash? It will be un-archived and placed in the trash for 10 days. Decks within the series will NOT be deleted.`,onConfirm:()=>o(S.id)})};return u.jsxs("div",{className:"max-w-4xl mx-auto animate-fade-in space-y-8",children:[u.jsx("h1",{className:"text-3xl font-bold mb-6 text-text border-b border-border pb-4",children:"Archive"}),u.jsxs("section",{children:[u.jsx("h2",{className:"text-2xl font-semibold text-text mb-4",children:"Archived Series"}),h.length>0?u.jsx("div",{className:"bg-surface rounded-lg shadow-md divide-y divide-border",children:h.map(S=>u.jsxs("div",{className:"p-4 flex justify-between items-center",children:[u.jsxs("div",{className:"flex items-center min-w-0",children:[u.jsx(de,{name:"list",className:"w-6 h-6 mr-4 text-purple-500 dark:text-purple-400 flex-shrink-0"}),u.jsxs("div",{className:"min-w-0",children:[u.jsx("p",{className:"font-semibold truncate text-text",children:S.name}),u.jsx("p",{className:"text-sm text-text-muted truncate",children:S.description})]})]}),u.jsxs("div",{className:"flex-shrink-0 flex items-center gap-2",children:[u.jsxs(Se,{variant:"secondary",size:"sm",onClick:()=>v(S),children:[u.jsx(de,{name:"unarchive",className:"w-4 h-4 mr-2"}),"Unarchive"]}),u.jsxs(Se,{variant:"danger",size:"sm",onClick:()=>C(S),children:[u.jsx(de,{name:"trash-2",className:"w-4 h-4 mr-2"}),"Move to Trash"]})]})]},S.id))}):u.jsxs("div",{className:"text-center py-10 bg-surface rounded-lg border border-border",children:[u.jsx(de,{name:"archive",className:"w-12 h-12 mx-auto text-text-muted/50"}),u.jsx("h3",{className:"mt-2 text-xl font-medium text-text",children:"No Archived Series"}),u.jsx("p",{className:"mt-1 text-sm text-text-muted",children:"You can archive series from their page to hide them from the main list."})]})]}),u.jsxs("section",{children:[u.jsx("h2",{className:"text-2xl font-semibold text-text mb-4",children:"Archived Decks"}),m.length>0?u.jsx("div",{className:"bg-surface rounded-lg shadow-md divide-y divide-border",children:m.map(S=>u.jsxs("div",{className:"p-4 flex justify-between items-center",children:[u.jsxs("div",{className:"flex items-center min-w-0",children:[u.jsx(de,{name:S.type==="quiz"?"help-circle":"laptop",className:"w-6 h-6 mr-4 text-text-muted flex-shrink-0"}),u.jsxs("div",{className:"min-w-0",children:[u.jsx("p",{className:"font-semibold truncate text-text",children:S.name}),u.jsx("p",{className:"text-sm text-text-muted truncate",children:S.description})]})]}),u.jsxs("div",{className:"flex-shrink-0 flex items-center gap-2",children:[u.jsxs(Se,{variant:"secondary",size:"sm",onClick:()=>p(S),children:[u.jsx(de,{name:"unarchive",className:"w-4 h-4 mr-2"}),"Unarchive"]}),u.jsxs(Se,{variant:"danger",size:"sm",onClick:()=>x(S),children:[u.jsx(de,{name:"trash-2",className:"w-4 h-4 mr-2"}),"Move to Trash"]})]})]},S.id))}):u.jsxs("div",{className:"text-center py-10 bg-surface rounded-lg border border-border",children:[u.jsx(de,{name:"archive",className:"w-12 h-12 mx-auto text-text-muted/50"}),u.jsx("h3",{className:"mt-2 text-xl font-medium text-text",children:"No Archived Decks"}),u.jsx("p",{className:"mt-1 text-sm text-text-muted",children:"You can archive decks from their details page to hide them from view."})]})]})]})},Ga=10,Fp=t=>{const e=new Date(t),i=(new Date().getTime()-e.getTime())/(1e3*60*60*24);return Math.max(0,Math.ceil(Ga-i))},TE=({onRestoreDeck:t,onRestoreSeries:e,onDeleteDeckPermanently:n,onDeleteSeriesPermanently:o,openConfirmModal:i})=>{const{decks:c,deckSeries:f}=yt(),m=B.useMemo(()=>c.filter(x=>x.deletedAt),[c]),h=B.useMemo(()=>f.filter(x=>x.deletedAt),[f]),p=x=>{i({title:"Permanently Delete Deck",message:`Are you sure you want to permanently delete the deck "${x.name}"? This action cannot be undone.`,onConfirm:()=>n(x.id)})},v=x=>{const C=x.levels.reduce((S,b)=>S+b.deckIds.length,0);i({title:"Permanently Delete Series",message:`Are you sure you want to permanently delete the series "${x.name}"? All ${C} deck(s) inside it will also be permanently deleted. This action cannot be undone.`,onConfirm:()=>o(x.id)})};return u.jsxs("div",{className:"max-w-4xl mx-auto animate-fade-in space-y-8",children:[u.jsxs("div",{className:"border-b border-border pb-4",children:[u.jsx("h1",{className:"text-3xl font-bold text-text",children:"Trash"}),u.jsxs("p",{className:"mt-2 text-text-muted",children:["Items in the trash will be permanently deleted after ",Ga," days."]})]}),u.jsxs("section",{children:[u.jsx("h2",{className:"text-2xl font-semibold text-text mb-4",children:"Trashed Series"}),h.length>0?u.jsx("div",{className:"bg-surface rounded-lg shadow-md divide-y divide-border",children:h.map(x=>{const C=Fp(x.deletedAt);return u.jsxs("div",{className:"p-4 flex justify-between items-center",children:[u.jsxs("div",{className:"flex items-center min-w-0",children:[u.jsx(de,{name:"list",className:"w-6 h-6 mr-4 text-purple-500 dark:text-purple-400 flex-shrink-0"}),u.jsxs("div",{className:"min-w-0",children:[u.jsx("p",{className:"font-semibold truncate text-text",children:x.name}),u.jsx("p",{className:`text-sm ${C<=2?"text-red-500":"text-text-muted"}`,children:C>0?`${C} days left`:"Deleting soon..."})]})]}),u.jsxs("div",{className:"flex-shrink-0 flex items-center gap-2",children:[u.jsxs(Se,{variant:"secondary",size:"sm",onClick:()=>e(x.id),children:[u.jsx(de,{name:"unarchive",className:"w-4 h-4 mr-2"}),"Restore"]}),u.jsxs(Se,{variant:"danger",size:"sm",onClick:()=>v(x),children:[u.jsx(de,{name:"trash-2",className:"w-4 h-4 mr-2"}),"Delete Now"]})]})]},x.id)})}):u.jsxs("div",{className:"text-center py-10 bg-surface rounded-lg border border-border",children:[u.jsx(de,{name:"trash-2",className:"w-12 h-12 mx-auto text-text-muted/50"}),u.jsx("h3",{className:"mt-2 text-xl font-medium text-text",children:"Trash is Empty"}),u.jsxs("p",{className:"mt-1 text-sm text-text-muted",children:["Deleted series will appear here for ",Ga," days."]})]})]}),u.jsxs("section",{children:[u.jsx("h2",{className:"text-2xl font-semibold text-text mb-4",children:"Trashed Decks"}),m.length>0?u.jsx("div",{className:"bg-surface rounded-lg shadow-md divide-y divide-border",children:m.map(x=>{const C=Fp(x.deletedAt);return u.jsxs("div",{className:"p-4 flex justify-between items-center",children:[u.jsxs("div",{className:"flex items-center min-w-0",children:[u.jsx(de,{name:x.type==="quiz"?"help-circle":"laptop",className:"w-6 h-6 mr-4 text-text-muted flex-shrink-0"}),u.jsxs("div",{className:"min-w-0",children:[u.jsx("p",{className:"font-semibold truncate text-text",children:x.name}),u.jsx("p",{className:`text-sm ${C<=2?"text-red-500":"text-text-muted"}`,children:C>0?`${C} days left`:"Deleting soon..."})]})]}),u.jsxs("div",{className:"flex-shrink-0 flex items-center gap-2",children:[u.jsxs(Se,{variant:"secondary",size:"sm",onClick:()=>t(x.id),children:[u.jsx(de,{name:"unarchive",className:"w-4 h-4 mr-2"}),"Restore"]}),u.jsxs(Se,{variant:"danger",size:"sm",onClick:()=>p(x),children:[u.jsx(de,{name:"trash-2",className:"w-4 h-4 mr-2"}),"Delete Now"]})]})]},x.id)})}):u.jsxs("div",{className:"text-center py-10 bg-surface rounded-lg border border-border",children:[u.jsx(de,{name:"trash-2",className:"w-12 h-12 mx-auto text-text-muted/50"}),u.jsx("h3",{className:"mt-2 text-xl font-medium text-text",children:"Trash is Empty"}),u.jsxs("p",{className:"mt-1 text-sm text-text-muted",children:["Deleted decks will appear here for ",Ga," days."]})]})]})]})},_h=({series:t,completedCount:e,dueCount:n,onStartSeriesStudy:o,masteryLevel:i,nextUpDeckId:c})=>{const f=t.levels.reduce((h,p)=>h+p.deckIds.length,0),m=e>=f&&f>0;return u.jsx(Ot,{href:`/series/${t.id}`,className:"block bg-surface rounded-lg shadow-md hover:shadow-lg transition-all duration-200 border border-transparent hover:border-primary",children:u.jsxs("div",{className:"p-4",children:[u.jsxs("div",{className:"flex items-start justify-between",children:[u.jsxs("div",{className:"flex-1 min-w-0 mr-4",children:[u.jsxs("div",{className:"flex items-center mb-1",children:[u.jsx(de,{name:"layers",className:"w-5 h-5 mr-2 text-purple-500 dark:text-purple-400"}),u.jsx("h3",{className:"text-xl font-bold text-text break-words",children:t.name})]}),t.description&&u.jsx("p",{className:"text-sm text-text-muted mt-1 truncate",children:t.description})]}),m&&u.jsxs("div",{className:"flex-shrink-0 flex items-center gap-2 text-green-500 dark:text-green-400 bg-green-100 dark:bg-green-900/50 px-3 py-1 rounded-full",children:[u.jsx(de,{name:"check-circle",className:"w-4 h-4"}),u.jsx("span",{className:"text-sm font-semibold",children:"Completed"})]})]}),f>0&&u.jsxs("div",{className:"mt-3 space-y-3",children:[u.jsxs("div",{children:[u.jsxs("div",{className:"flex justify-between items-center text-sm mb-1",children:[u.jsx("span",{className:"font-medium text-text-muted",children:"Completion"}),u.jsxs("span",{className:"font-semibold text-text-muted",children:[e," / ",f]})]}),u.jsx(Mc,{current:e,total:f})]}),u.jsx("div",{children:u.jsx(ao,{level:i})})]}),u.jsxs("div",{className:"mt-4 pt-4 border-t border-border/50 flex justify-end gap-2",children:[c&&u.jsxs(Ot,{href:`/decks/${c}/study?seriesId=${t.id}`,passAs:Se,variant:"primary",size:"sm",onClick:h=>{h.stopPropagation()},children:[u.jsx(de,{name:"laptop",className:"w-4 h-4 mr-2"}),"Continue"]}),u.jsxs(Se,{variant:"secondary",size:"sm",onClick:h=>{h.preventDefault(),h.stopPropagation(),o(t.id)},disabled:n===0,children:[u.jsx(de,{name:"zap",className:"w-4 h-4 mr-2"}),"Study Due (",n,")"]})]})]})})},_E=t=>{const e=new Date;e.setHours(23,59,59,999);const n=t.type===We.Quiz?t.questions:t.cards;return Array.isArray(n)?n.filter(o=>!o.suspended&&new Date(o.dueDate)<=e).length:0},EE=t=>t&&new DOMParser().parseFromString(t,"text/html").body.textContent||"",Rc=({deck:t,sessionsToResume:e,onUpdateLastOpened:n,draggedDeckId:o,onDragStart:i,onDragEnd:c,onUpdateDeck:f,onDeleteDeck:m,openConfirmModal:h})=>{const{navigate:p}=Rr(),v=_E(t),x=e.has(t.id),C=t.type===We.Quiz?t.questions:t.cards,S=(C==null?void 0:C.length)||0,b=t.type===We.Quiz?S===1?"question":"questions":S===1?"card":"cards",[T,A]=B.useState(!1),D=B.useRef(null);B.useEffect(()=>{const G=$=>{D.current&&!D.current.contains($.target)&&A(!1)};return T?document.addEventListener("mousedown",G):document.removeEventListener("mousedown",G),()=>document.removeEventListener("mousedown",G)},[T]);const F=G=>{G.target.closest("button, a")||(n(t.id),p(`/decks/${t.id}`))},L=G=>{f({...t,archived:!0}),A(!1)},R=G=>{h({title:"Move Deck to Trash",message:`Are you sure you want to move the deck "${t.name}" to the trash? It will be permanently deleted after 10 days.`,onConfirm:()=>m(t.id)}),A(!1)},P=B.useMemo(()=>{if(!C)return 0;const G=C.filter(oe=>!oe.suspended);return G.length===0?0:G.reduce((oe,J)=>oe+sr(J),0)/G.length},[C]);return u.jsxs("div",{draggable:"true",onClick:F,onDragStart:G=>{G.dataTransfer.setData("text/plain",t.id),setTimeout(()=>i(t.id),0)},onDragEnd:c,className:`bg-surface rounded-lg shadow-md hover:shadow-lg transition-all duration-200 group relative ${o===t.id?"border-2 border-dashed border-border bg-background/50":"cursor-pointer"}`,children:[u.jsxs("div",{className:`p-4 pr-10 flex flex-col justify-between h-full space-y-3 ${o===t.id?"opacity-0":""}`,children:[u.jsxs("div",{children:[u.jsx("h3",{className:"text-xl font-bold text-text break-words group-hover:text-primary transition-colors",children:t.name}),t.description&&u.jsx("div",{className:"prose prose-sm dark:prose-invert max-w-none text-text-muted mt-1 truncate",title:EE(t.description),dangerouslySetInnerHTML:{__html:t.description}})]}),u.jsx(ao,{level:P}),u.jsxs("div",{className:"flex justify-between items-center",children:[u.jsxs("div",{className:"flex items-center gap-4 text-sm text-text-muted",children:[u.jsxs("span",{className:"flex items-center gap-1.5",children:[u.jsx(de,{name:"list",className:"w-4 h-4"}),S," ",b]}),u.jsxs("span",{className:`flex items-center gap-1.5 font-semibold ${v>0?"text-primary":""}`,children:[u.jsx(de,{name:"zap",className:"w-4 h-4"}),v," due"]})]}),u.jsxs("div",{className:"flex items-center space-x-1",children:[u.jsx(Ot,{href:`/decks/${t.id}/study`,passAs:Se,variant:"primary",size:"sm",onClick:()=>n(t.id),disabled:v===0&&!x,className:"font-semibold",children:x?"Resume":"Study"}),u.jsxs("div",{className:"relative",ref:D,children:[u.jsx(Se,{variant:"ghost",size:"sm",className:"p-2 h-auto",onClick:()=>A(G=>!G),"aria-label":`More options for ${t.name}`,children:u.jsx(de,{name:"more-vertical",className:"w-5 h-5"})}),T&&u.jsxs("div",{className:"absolute right-0 mt-2 w-48 bg-surface rounded-md shadow-lg py-1 z-20 ring-1 ring-black ring-opacity-5 animate-fade-in",style:{animationDuration:"150ms"},children:[u.jsxs("button",{onClick:L,className:"flex items-center w-full px-4 py-2 text-sm text-left text-text hover:bg-border/20",children:[u.jsx(de,{name:"archive",className:"w-4 h-4 mr-3"}),"Archive"]}),u.jsx("div",{className:"border-t border-border my-1"}),u.jsxs("button",{onClick:R,className:"flex items-center w-full px-4 py-2 text-sm text-left text-red-600 dark:text-red-400 hover:bg-red-50 dark:hover:bg-red-900/20",children:[u.jsx(de,{name:"trash-2",className:"w-4 h-4 mr-3"}),"Move to Trash"]})]})]})]})]})]}),u.jsx("div",{className:"absolute top-0 right-0 h-full flex items-center px-3 text-text-muted/60 cursor-grab","aria-hidden":"true",children:u.jsx(de,{name:"grip-vertical",className:"w-5 h-5"})})]},t.id)},bE=t=>{const e=new Date;e.setHours(23,59,59,999);const n=t.type==="quiz"?t.questions:t.cards;return Array.isArray(n)?n.filter(o=>!o.suspended&&new Date(o.dueDate)<=e).length:0},NE=({totalDueQuestions:t,onStartGeneralStudy:e,sessionsToResume:n,onUpdateLastOpened:o,onUpdateDeck:i,onDeleteDeck:c,openConfirmModal:f,seriesProgress:m,onStartSeriesStudy:h})=>{const{decks:p,deckSeries:v}=yt(),{recentDecks:x,recentSeries:C,seriesData:S}=B.useMemo(()=>{const b=new Set;v.forEach(R=>{(R.levels||[]).forEach(P=>(P.deckIds||[]).forEach(G=>b.add(G)))});const T=p.filter(R=>!R.archived&&!R.deletedAt&&!b.has(R.id)),D=[...v.filter(R=>!R.archived&&!R.deletedAt)].sort((R,P)=>{const G=R.levels.flatMap(Z=>Z.deckIds).map(Z=>p.find(le=>le.id===Z)).filter(Boolean),$=P.levels.flatMap(Z=>Z.deckIds).map(Z=>p.find(le=>le.id===Z)).filter(Boolean),oe=Math.max(new Date(R.lastOpened||R.createdAt||0).getTime(),...G.map(Z=>new Date(Z.lastOpened||0).getTime()));return Math.max(new Date(P.lastOpened||P.createdAt||0).getTime(),...$.map(Z=>new Date(Z.lastOpened||0).getTime()))-oe}).slice(0,2),F=[...T].sort((R,P)=>(P.lastOpened||"").localeCompare(R.lastOpened||"")).slice(0,2),L=new Map;return v.forEach(R=>{var Q;const P=(R.levels||[]).flatMap(Y=>Y.deckIds||[]).map(Y=>p.find(M=>M.id===Y)).filter(Boolean),G=((Q=m.get(R.id))==null?void 0:Q.size)||0,$=new Set;(R.levels||[]).flatMap(Y=>Y.deckIds||[]).forEach((Y,M)=>{M<=G&&$.add(Y)});const J=P.reduce((Y,M)=>$.has(M.id)?Y+bE(M):Y,0),Z=P.flatMap(Y=>Y.type===We.Flashcard?Y.cards:Y.questions).filter(Y=>!Y.suspended),le=Z.length>0?Z.reduce((Y,M)=>Y+sr(M),0)/Z.length:0;L.set(R.id,{dueCount:J,mastery:le})}),{recentDecks:F,recentSeries:D,seriesData:L}},[p,v,m]);return u.jsxs("div",{className:"space-y-12",children:[t>0&&u.jsx("div",{className:"mb-6",children:u.jsxs(Se,{onClick:e,variant:"primary",className:"w-full sm:w-auto text-lg py-3",children:[u.jsx(de,{name:"zap",className:"w-5 h-5 mr-2"}),"Study All Due Items (",t,")"]})}),C.length>0&&u.jsxs("section",{children:[u.jsxs("div",{className:"flex justify-between items-center mb-4",children:[u.jsx("h2",{className:"text-3xl font-bold text-gray-900 dark:text-gray-100",children:"Recent Series"}),u.jsxs(Ot,{href:"/series",passAs:Se,variant:"ghost",children:["View all ",u.jsx(de,{name:"chevron-left",className:"w-4 h-4 ml-2 rotate-180"})]})]}),u.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:C.map(b=>{var L;const T=S.get(b.id)||{dueCount:0,mastery:0},A=m.get(b.id)||new Set,F=(b.levels||[]).flatMap(R=>R.deckIds||[]).find(R=>!A.has(R))||null;return u.jsx(_h,{series:b,completedCount:((L=m.get(b.id))==null?void 0:L.size)||0,dueCount:T.dueCount,masteryLevel:T.mastery,onStartSeriesStudy:h,nextUpDeckId:F},b.id)})})]}),x.length>0&&u.jsxs("section",{children:[u.jsxs("div",{className:"flex justify-between items-center mb-4",children:[u.jsx("h2",{className:"text-3xl font-bold text-gray-900 dark:text-gray-100",children:"Recent Decks"}),u.jsxs(Ot,{href:"/decks",passAs:Se,variant:"ghost",children:["View all ",u.jsx(de,{name:"chevron-left",className:"w-4 h-4 ml-2 rotate-180"})]})]}),u.jsx("div",{className:"space-y-4",children:x.map(b=>u.jsx(Rc,{deck:b,sessionsToResume:n,onUpdateLastOpened:o,draggedDeckId:null,onDragStart:()=>{},onDragEnd:()=>{},onUpdateDeck:i,onDeleteDeck:c,openConfirmModal:f},b.id))})]})]})},IE=({folder:t,decks:e,isOpen:n,onToggle:o,sessionsToResume:i,onUpdateLastOpened:c,onDeleteFolder:f,draggedDeckId:m,onDragStart:h,onDragEnd:p,onMoveDeck:v,onUpdateDeck:x,onDeleteDeck:C,openConfirmModal:S,onSaveFolder:b})=>{const[T,A]=B.useState(!1),[D,F]=B.useState(!1),[L,R]=B.useState(t.name),P=B.useRef(null),{addToast:G}=gn();B.useEffect(()=>{D&&P.current&&(P.current.focus(),P.current.select())},[D]);const $=Y=>{Y.stopPropagation(),R(t.name),F(!0)},oe=Y=>{Y.stopPropagation(),F(!1)},J=Y=>{if(Y==null||Y.stopPropagation(),L.trim()===""){G("Folder name cannot be empty.","error");return}b({id:t.id,name:L.trim()}),F(!1)},Z=Y=>{Y.preventDefault(),Y.stopPropagation();const M=Y.dataTransfer.getData("text/plain");M&&M===m&&(v(M,t.id),p()),A(!1)},le=Y=>{Y.preventDefault(),Y.dataTransfer.dropEffect="move",A(!0)},Q=()=>{A(!1)};return u.jsxs("div",{className:`rounded-lg transition-all duration-200 ${T?"bg-primary/20 ring-2 ring-primary ring-inset":"bg-surface border border-border"}`,onDrop:Z,onDragOver:le,onDragLeave:Q,children:[u.jsx("div",{className:"border-b border-border",children:u.jsxs("div",{onClick:D?void 0:o,className:"w-full flex justify-between items-center text-left p-4 cursor-pointer","aria-expanded":n,children:[u.jsxs("div",{className:"flex items-center flex-grow min-w-0",children:[u.jsx(de,{name:"chevron-down",className:`w-5 h-5 transition-transform duration-300 mr-3 ${n?"":"-rotate-90"} text-text-muted`}),D?u.jsxs("div",{className:"flex items-center flex-grow gap-2 min-w-0",onClick:Y=>Y.stopPropagation(),children:[u.jsx(de,{name:"folder",className:"w-6 h-6 text-yellow-600 dark:text-yellow-500 flex-shrink-0"}),u.jsx("input",{ref:P,type:"text",value:L,onChange:Y=>R(Y.target.value),onKeyDown:Y=>{Y.key==="Enter"&&J(Y),Y.key==="Escape"&&oe(Y)},className:"text-xl font-bold p-1 bg-background rounded-md w-full"})]}):u.jsxs(u.Fragment,{children:[u.jsx(de,{name:"folder",className:"w-6 h-6 mr-3 text-yellow-600 dark:text-yellow-500"}),u.jsx("h3",{className:"text-xl font-bold text-text truncate",children:t.name})]})]}),u.jsx("div",{className:"flex items-center gap-1 flex-shrink-0",children:D?u.jsxs(u.Fragment,{children:[u.jsx(Se,{variant:"primary",size:"sm",onClick:J,"aria-label":`Save changes for folder ${t.name}`,children:"Save"}),u.jsx(Se,{variant:"secondary",size:"sm",onClick:oe,"aria-label":"Cancel editing",children:"Cancel"})]}):u.jsxs(u.Fragment,{children:[u.jsx(Se,{variant:"ghost",className:"p-2 h-auto",onClick:$,"aria-label":`Edit folder ${t.name}`,children:u.jsx(de,{name:"edit",className:"w-4 h-4"})}),u.jsx(Se,{variant:"ghost",className:"p-2 h-auto hover:text-red-500",onClick:Y=>{Y.stopPropagation(),f(t.id)},"aria-label":`Delete folder ${t.name}`,children:u.jsx(de,{name:"trash-2",className:"w-4 h-4"})})]})})]})}),n&&u.jsx("div",{className:"p-4 space-y-4",children:e.length>0?e.map(Y=>u.jsx(Rc,{deck:Y,sessionsToResume:i,onUpdateLastOpened:c,draggedDeckId:m,onDragStart:h,onDragEnd:p,onUpdateDeck:x,onDeleteDeck:C,openConfirmModal:S},Y.id)):u.jsxs("div",{className:"flex flex-col items-center justify-center p-6 border-2 border-dashed border-border rounded-md m-4 text-center",children:[u.jsx(de,{name:"grip-vertical",className:"w-8 h-8 text-text-muted mb-2"}),u.jsx("p",{className:"text-sm font-medium text-text-muted",children:"Drag a deck here to organize it!"})]})})]})},AE=({decks:t,folders:e,sessionsToResume:n,onUpdateLastOpened:o,onDeleteFolder:i,draggedDeckId:c,onDragStart:f,onDragEnd:m,onMoveDeck:h,openFolderIds:p,onToggleFolder:v,onUpdateDeck:x,onDeleteDeck:C,openConfirmModal:S,onSaveFolder:b})=>{const{decksByFolder:T,ungroupedDecks:A}=B.useMemo(()=>{const P=new Map,G=[];return t.forEach($=>{$.folderId&&e.some(oe=>oe.id===$.folderId)?(P.has($.folderId)||P.set($.folderId,[]),P.get($.folderId).push($)):G.push($)}),{decksByFolder:P,ungroupedDecks:G}},[t,e]),[D,F]=B.useState(!1),L=P=>{P.preventDefault();const G=P.dataTransfer.getData("text/plain");G&&G===c&&(h(G,null),m()),F(!1)},R=P=>{P.preventDefault(),P.dataTransfer.dropEffect="move",F(!0)};return u.jsxs("div",{className:"space-y-4",children:[e.map(P=>u.jsx(IE,{folder:P,decks:T.get(P.id)||[],isOpen:p.has(P.id),onToggle:()=>v(P.id),sessionsToResume:n,onUpdateLastOpened:o,onDeleteFolder:i,draggedDeckId:c,onDragStart:f,onDragEnd:m,onMoveDeck:h,onUpdateDeck:x,onDeleteDeck:C,openConfirmModal:S,onSaveFolder:b},P.id)),u.jsx("div",{onDrop:L,onDragOver:R,onDragLeave:()=>F(!1),className:`p-2 -m-2 rounded-lg transition-all duration-200 ${D?"bg-primary/20 ring-2 ring-primary ring-inset":""}`,children:u.jsx("div",{className:"space-y-4",children:A.map(P=>u.jsx(Rc,{deck:P,sessionsToResume:n,onUpdateLastOpened:o,draggedDeckId:c,onDragStart:f,onDragEnd:m,onUpdateDeck:x,onDeleteDeck:C,openConfirmModal:S},P.id))})})]})},DE=[{key:"lastOpened",label:"Recent"},{key:"name",label:"Name"},{key:"dueCount",label:"Due"}],Cc=({currentSort:t,onSortChange:e,sortOptions:n})=>{const o=n??DE;return u.jsx("div",{className:"inline-flex rounded-md shadow-sm bg-gray-100 dark:bg-gray-800 p-1",role:"group",children:o&&o.map((i,c)=>u.jsx("button",{type:"button",onClick:()=>e(i.key),className:`px-4 py-1.5 text-sm font-medium transition-colors focus:z-10 focus:outline-none focus:ring-2 focus:ring-blue-500
            ${t===i.key?"bg-white dark:bg-gray-700 text-blue-600 dark:text-blue-300 shadow-sm":"text-gray-600 dark:text-gray-400 hover:bg-gray-200/50 dark:hover:bg-gray-700/50"}
            ${c===0?"rounded-l-md":""}
            ${c===o.length-1?"rounded-r-md":""}
          `,"aria-pressed":t===i.key,children:i.label},i.key))})},ja=t=>{const e=new Date;e.setHours(23,59,59,999);const n=t.type==="quiz"?t.questions:t.cards;return Array.isArray(n)?n.filter(o=>!o.suspended&&new Date(o.dueDate)<=e).length:0},nc=t=>{if(!t)return"";try{return new DOMParser().parseFromString(t,"text/html").body.textContent||""}catch{return t}},ME=t=>{const[e,n]=B.useState(""),o=yt(h=>h.folders),i=Hp(),c=B.useMemo(()=>{const h=e.toLowerCase().trim();if(!h){const x=[...i];switch(t.sortPreference){case"name":return x.sort((C,S)=>C.name.localeCompare(S.name));case"dueCount":return x.sort((C,S)=>ja(S)-ja(C));case"lastOpened":default:return x.sort((C,S)=>(S.lastOpened||"").localeCompare(C.lastOpened||""))}}const p=h.split(/\s+/).filter(Boolean),v=i.map(x=>{let C=0;const S=x.name.toLowerCase(),b=nc(x.description).toLowerCase();S.startsWith(h)?C+=20:S.includes(h)&&(C+=10),b.includes(h)&&(C+=2);for(const D of p)S.includes(D)&&(C+=5),b.includes(D)&&(C+=1);const T=x.type===We.Flashcard?x.cards:x.questions;let A=0;if(T)for(const D of T){let F;if(x.type===We.Flashcard){const L=D;F=nc(`${L.front} ${L.back}`).toLowerCase()}else{const L=D,R=L.options.map(P=>P.text).join(" ");F=nc(`${L.questionText} ${R} ${L.detailedExplanation}`).toLowerCase()}p.some(L=>F.includes(L))&&A++}return C+=Math.min(A,20)*.5,{deck:x,score:C}}).filter(({score:x})=>x>0);return v.sort((x,C)=>{if(x.score!==C.score)return C.score-x.score;switch(t.sortPreference){case"name":return x.deck.name.localeCompare(C.deck.name);case"dueCount":return ja(C.deck)-ja(x.deck);case"lastOpened":default:return(C.deck.lastOpened||"").localeCompare(x.deck.lastOpened||"")}}),v.map(({deck:x})=>x)},[i,e,t.sortPreference]),f=B.useMemo(()=>[...o].sort((h,p)=>h.name.localeCompare(p.name)),[o]);return i.length>0||o.length>0?u.jsxs("div",{className:"space-y-6",children:[u.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-center gap-4",children:[u.jsx("h1",{className:"text-3xl font-bold text-text",children:"All Decks"}),u.jsxs(Se,{variant:"primary",onClick:t.onImportDecks,children:[u.jsx(de,{name:"plus",className:"w-5 h-5 mr-2"}),"Create / Import Deck"]})]}),u.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-center gap-4 p-4 bg-surface rounded-lg border border-border",children:[u.jsxs("div",{className:"relative w-full md:max-w-xs",children:[u.jsx(de,{name:"search",className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-text-muted"}),u.jsx("input",{type:"text",placeholder:"Search decks...",value:e,onChange:h=>n(h.target.value),className:"w-full pl-10 pr-4 py-2 bg-background border border-border rounded-md focus:ring-2 focus:ring-primary focus:outline-none"})]}),u.jsxs("div",{className:"flex flex-wrap items-center justify-center gap-2",children:[u.jsxs(Se,{variant:"ghost",onClick:t.onNewFolder,children:[u.jsx(de,{name:"folder-plus",className:"w-5 h-5 mr-2"}),u.jsx("span",{className:"hidden sm:inline",children:"New Folder"})]}),u.jsx(Cc,{currentSort:t.sortPreference,onSortChange:t.onSortChange})]})]}),c.length===0&&e?u.jsxs("div",{className:"text-center py-20",children:[u.jsx(de,{name:"search",className:"w-16 h-16 mx-auto text-text-muted/50"}),u.jsx("h2",{className:"mt-4 text-2xl font-bold text-text-muted",children:"No Decks Found"}),u.jsxs("p",{className:"mt-2 text-text-muted",children:['Your search for "',e,'" did not match any decks.']}),u.jsx(Se,{variant:"secondary",onClick:()=>n(""),className:"mt-6",children:"Clear Search"})]}):u.jsx(AE,{decks:c,folders:f,sessionsToResume:t.sessionsToResume,onUpdateLastOpened:t.onUpdateLastOpened,onDeleteFolder:t.onDeleteFolder,draggedDeckId:t.draggedDeckId,onDragStart:t.onDragStart,onDragEnd:t.onDragEnd,onMoveDeck:t.onMoveDeck,openFolderIds:t.openFolderIds,onToggleFolder:t.onToggleFolder,onUpdateDeck:t.onUpdateDeck,onDeleteDeck:t.onDeleteDeck,openConfirmModal:t.openConfirmModal,onSaveFolder:t.handleSaveFolder})]}):u.jsxs("div",{className:"text-center py-20",children:[u.jsx(de,{name:"folder",className:"w-16 h-16 mx-auto text-gray-300 dark:text-gray-600"}),u.jsx("h2",{className:"mt-4 text-2xl font-bold text-text-muted",children:"Your deck collection is empty"}),u.jsx("p",{className:"mt-2 text-text-muted",children:"Create a new deck, import from a file, or try a sample deck to get started."}),u.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-center gap-4 mt-8",children:[u.jsxs(Se,{onClick:t.onImportDecks,children:[u.jsx(de,{name:"plus",className:"w-5 h-5 mr-2"}),"Create or Import Deck"]}),u.jsxs(Se,{onClick:t.onCreateSampleDeck,variant:"secondary",children:[u.jsx(de,{name:"laptop",className:"w-5 h-5 mr-2"}),"Create Sample Deck"]})]})]})},RE=t=>{const e=new Date;e.setHours(23,59,59,999);const n=t.type==="quiz"?t.questions:t.cards;return Array.isArray(n)?n.filter(o=>!o.suspended&&new Date(o.dueDate)<=e).length:0},PE=({onStartSeriesStudy:t,onCreateNewSeries:e,onCreateSampleSeries:n,onGenerateAI:o})=>{const{deckSeries:i,decks:c,seriesProgress:f}=yt(),{aiFeaturesEnabled:m}=Vo(),[h,p]=B.useState(""),[v,x]=B.useState("recent"),[C,S]=B.useState("all"),b=B.useMemo(()=>i.filter(L=>!L.archived&&!L.deletedAt),[i]),T=B.useMemo(()=>{const L=new Map;return b.forEach(R=>{var Q;const P=(R.levels||[]).flatMap(Y=>Y.deckIds||[]).map(Y=>c.find(M=>M.id===Y)).filter(Boolean),G=((Q=f.get(R.id))==null?void 0:Q.size)||0,$=new Set;(R.levels||[]).flatMap(Y=>Y.deckIds||[]).forEach((Y,M)=>{M<=G&&$.add(Y)});const J=P.reduce((Y,M)=>$.has(M.id)?Y+RE(M):Y,0),Z=P.flatMap(Y=>Y.type===We.Flashcard?Y.cards:Y.questions).filter(Y=>!Y.suspended),le=Z.length>0?Z.reduce((Y,M)=>Y+sr(M),0)/Z.length:0;L.set(R.id,{dueCount:J,mastery:le})}),L},[b,c,f]),A=B.useMemo(()=>{let L=b.filter(R=>R.name.toLowerCase().includes(h.toLowerCase())||R.description.toLowerCase().includes(h.toLowerCase()));switch(C!=="all"&&(L=L.filter(R=>{var oe;const P=(R.levels||[]).reduce((J,Z)=>J+(Z.deckIds||[]).length,0);if(P===0)return C==="inProgress";const $=(((oe=f.get(R.id))==null?void 0:oe.size)||0)>=P;return C==="completed"?$:!$})),v){case"recent":return L.sort((R,P)=>{const G=new Date(R.lastOpened||R.createdAt||0).getTime();return new Date(P.lastOpened||P.createdAt||0).getTime()-G});case"progress":return L.sort((R,P)=>{var oe,J;const G=(((oe=f.get(R.id))==null?void 0:oe.size)||0)/((R.levels||[]).reduce((Z,le)=>Z+(le.deckIds||[]).length,0)||1);return(((J=f.get(P.id))==null?void 0:J.size)||0)/((P.levels||[]).reduce((Z,le)=>Z+(le.deckIds||[]).length,0)||1)-G});case"mastery":return L.sort((R,P)=>{var oe,J;const G=((oe=T.get(R.id))==null?void 0:oe.mastery)||0;return(((J=T.get(P.id))==null?void 0:J.mastery)||0)-G});case"name":default:return L.sort((R,P)=>R.name.localeCompare(P.name))}},[b,h,v,C,f,T]),D=[{key:"recent",label:"Recent"},{key:"name",label:"Name"},{key:"progress",label:"Progress"},{key:"mastery",label:"Mastery"}],F=[{key:"all",label:"All"},{key:"inProgress",label:"In Progress"},{key:"completed",label:"Completed"}];return u.jsxs("div",{className:"space-y-6",children:[u.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-center gap-4",children:[u.jsx("h1",{className:"text-3xl font-bold text-text",children:"All Series"}),u.jsxs("div",{className:"flex gap-2",children:[m&&u.jsxs(Se,{variant:"primary",onClick:o,children:[u.jsx(de,{name:"zap",className:"w-5 h-5 mr-2"}),"Generate with AI"]}),u.jsxs(Se,{variant:"secondary",onClick:e,children:[u.jsx(de,{name:"layers",className:"w-5 h-5 mr-2"}),"Create New Series"]})]})]}),u.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-center gap-4 p-4 bg-surface rounded-lg border border-border",children:[u.jsxs("div",{className:"relative w-full md:max-w-xs",children:[u.jsx(de,{name:"search",className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-text-muted"}),u.jsx("input",{type:"text",placeholder:"Search series...",value:h,onChange:L=>p(L.target.value),className:"w-full pl-10 pr-4 py-2 bg-background border border-border rounded-md focus:ring-2 focus:ring-primary focus:outline-none"})]}),u.jsxs("div",{className:"flex flex-wrap items-center justify-center gap-4",children:[u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx(de,{name:"filter",className:"w-5 h-5 text-text-muted"}),u.jsx(Cc,{currentSort:C,onSortChange:L=>S(L),sortOptions:F})]}),u.jsx(Cc,{currentSort:v,onSortChange:L=>x(L),sortOptions:D})]})]}),A.length>0?u.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:A.map(L=>{const R=T.get(L.id)||{dueCount:0,mastery:0},P=f.get(L.id)||new Set,$=(L.levels||[]).flatMap(oe=>oe.deckIds||[]).find(oe=>!P.has(oe))||null;return u.jsx(_h,{series:L,completedCount:P.size,dueCount:R.dueCount,masteryLevel:R.mastery,onStartSeriesStudy:t,nextUpDeckId:$},L.id)})}):u.jsxs("div",{className:"text-center py-10",children:[u.jsx(de,{name:"layers",className:"w-12 h-12 mx-auto text-gray-300 dark:text-gray-600"}),u.jsx("h3",{className:"mt-2 text-xl font-medium text-text",children:h?"No series found":"Your series collection is empty"}),u.jsx("p",{className:"mt-1 text-sm text-text-muted",children:h?"Try adjusting your search or filter.":"Create a new series or try a sample to get started."}),!h&&b.length===0&&u.jsx("div",{className:"mt-6",children:u.jsxs(Se,{onClick:n,variant:"secondary",children:[u.jsx(de,{name:"zap",className:"w-4 h-4 mr-2"})," Create Sample Series"]})})]})]})},rc=({icon:t,label:e,value:n})=>u.jsxs("div",{className:"bg-surface p-6 rounded-lg shadow-md border border-border flex items-center",children:[u.jsx("div",{className:"flex-shrink-0",children:t}),u.jsxs("div",{className:"ml-5 w-0 flex-1",children:[u.jsx("dt",{className:"text-sm font-medium text-text-muted truncate",children:e}),u.jsx("dd",{className:"text-2xl font-bold text-text",children:n})]})]}),FE=({stats:t})=>u.jsxs("div",{className:"grid grid-cols-1 gap-5 sm:grid-cols-3",children:[u.jsx(rc,{icon:u.jsx(de,{name:"zap",className:"h-8 w-8 text-orange-400"}),label:"Current Streak",value:`${t.streak} day${t.streak!==1?"s":""}`}),u.jsx(rc,{icon:u.jsx(de,{name:"check-circle",className:"h-8 w-8 text-blue-400"}),label:"Total Reviews",value:t.totalReviews.toLocaleString()}),u.jsx(rc,{icon:u.jsx(de,{name:"trending-up",className:"h-8 w-8 text-green-400"}),label:"Mature Items",value:t.matureCount.toLocaleString()})]}),LE=({reviews:t})=>{const{grid:e,maxCount:n}=B.useMemo(()=>{const c=new Date;c.setHours(0,0,0,0);const f=new Date(c);f.setDate(f.getDate()+1);const m=new Date(f);m.setDate(m.getDate()-364-c.getDay());const h=new Map;t.forEach(C=>{const S=new Date(C.timestamp);S.setHours(0,0,0,0);const b=S.toISOString().split("T")[0];h.set(b,(h.get(b)||0)+1)});const p=Math.max(...Array.from(h.values()),1),v=[];let x=new Date(m);for(;v.length<371;){const C=x.toISOString().split("T")[0],S=h.get(C)||0;v.push({date:new Date(x),count:S}),x.setDate(x.getDate()+1)}return{grid:v,maxCount:p}},[t]),o=c=>{if(c===0)return"fill-gray-200 dark:fill-gray-700/50";const f=Math.min(c/(n*.75),1);return f>.8?"fill-green-600":f>.5?"fill-green-500":f>.2?"fill-green-400":"fill-green-300"},i=B.useMemo(()=>{var m;const c=[];let f=-1;for(let h=0;h<53;h++){const p=(m=e[h*7])==null?void 0:m.date;if(p){const v=p.getMonth();v!==f&&c.push({month:p.toLocaleString("default",{month:"short"}),col:h}),f=v}}return c},[e]);return u.jsx("div",{className:"overflow-x-auto",children:u.jsxs("svg",{width:"100%",viewBox:"0 0 848 128",children:[i.map(({month:c,col:f})=>u.jsx("text",{x:16*f+24,y:"15",className:"text-xs fill-text-muted",children:c},f)),u.jsx("text",{x:"0",y:"37",className:"text-xs fill-text-muted",children:"Mon"}),u.jsx("text",{x:"0",y:"69",className:"text-xs fill-text-muted",children:"Wed"}),u.jsx("text",{x:"0",y:"101",className:"text-xs fill-text-muted",children:"Fri"}),e.map((c,f)=>{if(!c)return null;const m=Math.floor(f/7),h=f%7;return u.jsx("rect",{x:16*m+24,y:16*h+24,width:"12",height:"12",rx:"2",ry:"2",className:o(c.count),children:u.jsx("title",{children:`${c.date.toDateString()}: ${c.count} review${c.count!==1?"s":""}`})},f)})]})})},UE=({items:t})=>{const e=B.useMemo(()=>{const p=new Date;p.setHours(0,0,0,0);const v=Array(30).fill(0);t.forEach(C=>{const S=new Date(C.dueDate);S.setHours(0,0,0,0);const b=S.getTime()-p.getTime();if(b>=0){const T=Math.floor(b/864e5);T<30&&v[T]++}});const x=Array.from({length:30},(C,S)=>{const b=new Date(p);return b.setDate(b.getDate()+S),S%7===0||S===0?b.toLocaleDateString("en-US",{month:"short",day:"numeric"}):""});return{counts:v,labels:x}},[t]),n=Math.max(...e.counts,1),o=350,i=180,c={top:25,right:10,bottom:25,left:10},f=o-c.left-c.right,m=i-c.top-c.bottom,h=f/e.counts.length-2;return u.jsx("div",{className:"w-full",children:u.jsxs("svg",{viewBox:`0 0 ${o} ${i}`,width:"100%",height:"auto","aria-labelledby":"forecast-graph-title",role:"img",className:"overflow-visible",children:[u.jsx("title",{id:"forecast-graph-title",children:"A bar chart showing the number of items due each day for the next 30 days."}),e.counts.map((p,v)=>{const x=p>0?p/n*m:0,C=c.left+v*(h+2),S=c.top+m-x;return u.jsxs("g",{className:"group cursor-pointer",children:[u.jsxs("title",{children:[e.labels[v]||new Date(new Date().setDate(new Date().getDate()+v)).toLocaleDateString(),": ",p," items"]}),u.jsx("rect",{x:C,y:S,width:h,height:x,rx:"2",className:"fill-primary/60 transition-colors group-hover:fill-primary"}),u.jsx("text",{x:C+h/2,y:S-6,textAnchor:"middle",className:"text-xs font-semibold fill-text-muted transition-opacity opacity-0 group-hover:opacity-100 pointer-events-none",children:p})]},v)}),e.labels.map((p,v)=>p?u.jsx("text",{x:c.left+v*(h+2)+h/2,y:i-c.bottom+15,textAnchor:"middle",className:"text-xs fill-text-muted",children:p},v):null)]})})},jE=({reviews:t})=>{const e=B.useMemo(()=>{const o=new Date;o.setDate(o.getDate()-30);const i=t.filter(h=>h.rating!==null&&new Date(h.timestamp)>=o),c={[ft.Again]:0,[ft.Hard]:0,[ft.Good]:0,[ft.Easy]:0};let f=0;i.forEach(h=>{h.rating&&c.hasOwnProperty(h.rating)&&(c[h.rating]++,f++)});const m=h=>f>0?(h/f*100).toFixed(1):"0.0";return{total:f,again:{count:c[ft.Again],percent:m(c[ft.Again])},hard:{count:c[ft.Hard],percent:m(c[ft.Hard])},good:{count:c[ft.Good],percent:m(c[ft.Good])},easy:{count:c[ft.Easy],percent:m(c[ft.Easy])},correctPercent:m(c[ft.Hard]+c[ft.Good]+c[ft.Easy])}},[t]);if(e.total===0)return u.jsx("div",{className:"text-center py-10",children:u.jsx("p",{className:"text-text-muted",children:"Not enough data from the last 30 days."})});const n=[{label:"Again",percent:e.again.percent,color:"bg-red-500"},{label:"Hard",percent:e.hard.percent,color:"bg-orange-500"},{label:"Good",percent:e.good.percent,color:"bg-green-500"},{label:"Easy",percent:e.easy.percent,color:"bg-blue-500"}];return u.jsxs("div",{className:"space-y-6",children:[u.jsxs("div",{className:"text-center",children:[u.jsx("p",{className:"text-lg text-text-muted",children:"Reviews Marked Correct"}),u.jsxs("p",{className:"text-4xl font-bold text-green-500",children:[e.correctPercent,"%"]})]}),u.jsx("div",{className:"flex w-full h-4 rounded-full overflow-hidden",role:"progressbar",children:n.map(o=>o.percent!=="0.0"&&u.jsx("div",{className:o.color,style:{width:`${o.percent}%`},title:`${o.label}: ${o.percent}%`},o.label))}),u.jsxs("div",{className:"grid grid-cols-2 gap-x-4 gap-y-2 text-sm",children:[u.jsxs("div",{className:"flex items-center",children:[u.jsx("span",{className:"w-2.5 h-2.5 rounded-full bg-red-500 mr-2"}),u.jsxs("span",{className:"text-text-muted",children:["Again: ",u.jsx("strong",{children:e.again.count})," (",e.again.percent,"%)"]})]}),u.jsxs("div",{className:"flex items-center",children:[u.jsx("span",{className:"w-2.5 h-2.5 rounded-full bg-orange-500 mr-2"}),u.jsxs("span",{className:"text-text-muted",children:["Hard: ",u.jsx("strong",{children:e.hard.count})," (",e.hard.percent,"%)"]})]}),u.jsxs("div",{className:"flex items-center",children:[u.jsx("span",{className:"w-2.5 h-2.5 rounded-full bg-green-500 mr-2"}),u.jsxs("span",{className:"text-text-muted",children:["Good: ",u.jsx("strong",{children:e.good.count})," (",e.good.percent,"%)"]})]}),u.jsxs("div",{className:"flex items-center",children:[u.jsx("span",{className:"w-2.5 h-2.5 rounded-full bg-blue-500 mr-2"}),u.jsxs("span",{className:"text-text-muted",children:["Easy: ",u.jsx("strong",{children:e.easy.count})," (",e.easy.percent,"%)"]})]})]})]})},qE=()=>{const[t,e]=B.useState([]),[n,o]=B.useState(!0),[i,c]=B.useState(null),f=yt(p=>p.decks);B.useEffect(()=>{(async()=>{try{const v=new Date;v.setFullYear(v.getFullYear()-1);const x=await ny(v);e(x)}catch(v){console.error("Failed to load review data:",v),c("Could not load your review data. Please try again later.")}finally{o(!1)}})()},[]);const m=B.useMemo(()=>{if(n)return null;let p=0;const v=t.map(b=>new Date(b.timestamp).setHours(0,0,0,0)),x=[...new Set(v)];if(x.sort((b,T)=>T-b),x.length>0){const b=new Date().setHours(0,0,0,0),T=new Date(b).setDate(new Date(b).getDate()-1);if(x[0]===b||x[0]===T){p=1;for(let A=1;A<x.length;A++){const D=x[A-1],F=x[A],L=new Date(D).setDate(new Date(D).getDate()-1);if(F===L)p++;else break}}}const S=f.reduce((b,T)=>T.type==="flashcard"?b.concat(T.cards):b.concat(T.questions),[]).filter(b=>(b.interval||0)>=21&&!b.suspended).length;return{streak:p,totalReviews:t.length,matureCount:S}},[t,f,n]),h=B.useMemo(()=>f.reduce((v,x)=>x.type==="flashcard"?v.concat(x.cards):v.concat(x.questions),[]).filter(v=>!v.suspended),[f]);return n?u.jsxs("div",{className:"flex items-center justify-center h-64",children:[u.jsx(Ln,{size:"lg"}),u.jsx("p",{className:"ml-4 text-text-muted",children:"Calculating your progress..."})]}):i?u.jsx("div",{className:"text-center py-10",children:u.jsx("p",{className:"text-red-500",children:i})}):t.length===0?u.jsxs("div",{className:"text-center py-20",children:[u.jsx("h2",{className:"text-2xl font-bold text-text-muted",children:"No review history yet."}),u.jsx("p",{className:"mt-2 text-text-muted",children:"Complete a study session to start tracking your progress!"})]}):u.jsxs("div",{className:"max-w-5xl mx-auto animate-fade-in space-y-8",children:[u.jsx("h1",{className:"text-3xl font-bold text-text border-b border-border pb-4",children:"Your Progress"}),u.jsx(FE,{stats:m}),u.jsxs("div",{className:"bg-surface p-6 rounded-lg shadow-md border border-border",children:[u.jsx("h2",{className:"text-xl font-semibold text-text mb-4",children:"Activity"}),u.jsx(LE,{reviews:t})]}),u.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[u.jsxs("div",{className:"bg-surface p-6 rounded-lg shadow-md border border-border",children:[u.jsx("h2",{className:"text-xl font-semibold text-text mb-4",children:"30-Day Forecast"}),u.jsx(UE,{items:h})]}),u.jsxs("div",{className:"bg-surface p-6 rounded-lg shadow-md border border-border",children:[u.jsx("h2",{className:"text-xl font-semibold text-text mb-4",children:"Retention (Last 30 Days)"}),u.jsx(jE,{reviews:t})]})]})]})},zE=t=>{const{path:e}=Rr(),{activeDeck:n,activeSeries:o,generalStudyDeck:i}=t,{aiFeaturesEnabled:c}=Vo(),[f]=e.split("?"),m=Hp(),h=iv(),p=av(),v=yt(x=>x.seriesProgress);if(f==="/trash")return u.jsx(TE,{onRestoreDeck:t.handleRestoreDeck,onRestoreSeries:t.handleRestoreSeries,onDeleteDeckPermanently:t.handleDeleteDeckPermanently,onDeleteSeriesPermanently:t.handleDeleteSeriesPermanently,openConfirmModal:t.openConfirmModal});if(f==="/archive")return u.jsx(kE,{onUpdateDeck:t.handleUpdateDeck,onUpdateSeries:t.handleUpdateSeries,onDeleteDeck:t.handleDeleteDeck,onDeleteSeries:t.handleDeleteSeries,openConfirmModal:t.openConfirmModal});if(f==="/progress")return u.jsx(qE,{});if(f.startsWith("/series/")&&o)return u.jsx(SE,{series:o,sessionsToResume:t.sessionsToResume,onUpdateSeries:t.handleUpdateSeries,onDeleteSeries:t.handleDeleteSeries,onAddDeckToSeries:t.handleAddDeckToSeries,onUpdateDeck:t.handleUpdateDeck,onStartSeriesStudy:t.handleStartSeriesStudy,openConfirmModal:t.openConfirmModal,onUpdateLastOpened:t.updateLastOpenedSeries,onAiAddLevelsToSeries:t.handleAiAddLevelsToSeries,onAiAddDecksToLevel:t.handleAiAddDecksToLevel},o.id);if(f==="/study/general"){const x=new URLSearchParams(window.location.hash.split("?")[1]).get("seriesId")||void 0;return i&&u.jsx(di,{deck:i,seriesId:x,onSessionEnd:C=>t.handleSessionEnd(C,x),onItemReviewed:t.handleItemReviewed,onUpdateLastOpened:()=>{}},"general-study")}if(f.startsWith("/decks/")&&f.endsWith("/cram")&&n){const C=[...(n.type===We.Flashcard?n.cards:n.questions).filter(T=>!T.suspended)].sort(()=>Math.random()-.5),S=n.type===We.Flashcard?{...n,name:`${n.name} (Cram)`,cards:C}:{...n,name:`${n.name} (Cram)`,questions:C},b=new URLSearchParams(window.location.hash.split("?")[1]).get("seriesId")||void 0;return u.jsx(di,{deck:S,seriesId:b,onSessionEnd:T=>t.handleSessionEnd(T,b),onItemReviewed:t.handleItemReviewed,onUpdateLastOpened:t.updateLastOpened,sessionKeySuffix:"_cram"},`${n.id}-cram`)}if(f.startsWith("/decks/")&&f.endsWith("/study-reversed")&&n&&n.type==="flashcard"){const x={...n,name:`${n.name} (Reversed)`,cards:n.cards.map(S=>({...S,front:S.back,back:S.front}))},C=new URLSearchParams(window.location.hash.split("?")[1]).get("seriesId")||void 0;return u.jsx(di,{deck:x,seriesId:C,onSessionEnd:S=>t.handleSessionEnd(S,C),onItemReviewed:t.handleItemReviewed,onUpdateLastOpened:t.updateLastOpened,sessionKeySuffix:"_reversed"},`${n.id}-reversed`)}if(f.startsWith("/decks/")&&f.endsWith("/study-flip")&&n&&n.type==="quiz"){const x=n,C=(x.questions||[]).filter(T=>!T.suspended).map(T=>{const A=T.options.find(F=>F.id===T.correctAnswerId),D=`
                        <div class="text-left w-full">
                            <p class="text-xl"><b>Answer:</b> ${(A==null?void 0:A.text)||"N/A"}</p>
                            <hr class="my-4 border-gray-300 dark:border-gray-600"/>
                            <p class="text-sm font-semibold uppercase tracking-wider text-gray-500 dark:text-gray-400">Explanation</p>
                            <div class="prose prose-sm dark:prose-invert max-w-none mt-2">${T.detailedExplanation||"No detailed explanation provided."}</div>
                        </div>
                    `;return{...T,front:T.questionText,back:D}}),S={...x,name:`${x.name} (Review)`,type:We.Flashcard,cards:C.sort(()=>Math.random()-.5)},b=new URLSearchParams(window.location.hash.split("?")[1]).get("seriesId")||void 0;return u.jsx(di,{deck:S,seriesId:b,onSessionEnd:T=>t.handleSessionEnd(T,b),onItemReviewed:t.handleItemReviewed,onUpdateLastOpened:t.updateLastOpened,sessionKeySuffix:"_flip"},`${n.id}-flip`)}if(f.startsWith("/decks/")&&f.endsWith("/study")){const x=new URLSearchParams(window.location.hash.split("?")[1]).get("seriesId")||void 0;return n&&u.jsx(di,{deck:n,seriesId:x,onSessionEnd:C=>t.handleSessionEnd(C,x),onItemReviewed:t.handleItemReviewed,onUpdateLastOpened:t.updateLastOpened},n.id)}return f.startsWith("/decks/")?n&&u.jsx(wE,{deck:n,sessionsToResume:t.sessionsToResume,onUpdateDeck:t.handleUpdateDeck,onDeleteDeck:t.handleDeleteDeck,onUpdateLastOpened:t.updateLastOpened,openConfirmModal:t.openConfirmModal},n.id):f==="/settings"?u.jsx(iE,{onExport:t.handleExportData,onRestore:()=>t.setRestoreModalOpen(!0),onRestoreData:t.handleRestoreData,onResetProgress:()=>t.setResetProgressModalOpen(!0),onFactoryReset:t.handleFactoryReset}):f==="/instructions/json"?u.jsx(CE,{}):f==="/decks"?u.jsx(ME,{sessionsToResume:t.sessionsToResume,sortPreference:t.sortPreference,onSortChange:t.setSortPreference,onUpdateLastOpened:t.updateLastOpened,onDeleteFolder:t.handleDeleteFolder,draggedDeckId:t.draggedDeckId,onDragStart:t.setDraggedDeckId,onDragEnd:()=>t.setDraggedDeckId(null),onMoveDeck:t.handleMoveDeck,openFolderIds:t.openFolderIds,onToggleFolder:t.onToggleFolder,onUpdateDeck:t.handleUpdateDeck,onDeleteDeck:t.handleDeleteDeck,openConfirmModal:t.openConfirmModal,onNewFolder:()=>t.openFolderModal("new"),onImportDecks:()=>t.setImportModalOpen(!0),onCreateSampleDeck:t.handleCreateSampleDeck,handleSaveFolder:t.handleSaveFolder}):f==="/series"?u.jsx(PE,{onStartSeriesStudy:t.handleStartSeriesStudy,onCreateNewSeries:t.openCreateSeriesModal,onCreateSampleSeries:t.handleCreateSampleSeries,onGenerateAI:t.openAIGenerationModal}):m.length>0||h.length>0?u.jsx(NE,{onStartGeneralStudy:t.handleStartGeneralStudy,sessionsToResume:t.sessionsToResume,onUpdateLastOpened:t.updateLastOpened,onUpdateDeck:t.handleUpdateDeck,onDeleteDeck:t.handleDeleteDeck,openConfirmModal:t.openConfirmModal,onStartSeriesStudy:t.handleStartSeriesStudy,totalDueQuestions:p,seriesProgress:v}):u.jsxs("div",{className:"text-center py-20",children:[u.jsx("h2",{className:"text-3xl font-bold text-gray-600 dark:text-gray-400",children:"Welcome to CogniFlow"}),u.jsx("p",{className:"mt-4 text-gray-500 dark:text-gray-500",children:"Create decks, import content, restore from a backup, or try a sample to get started."}),u.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-center gap-4 mt-8 flex-wrap",children:[c&&u.jsxs(Se,{onClick:t.openAIGenerationModal,variant:"primary",children:[u.jsx(de,{name:"zap",className:"w-5 h-5 mr-2"}),"Generate with AI"]}),u.jsxs(Se,{onClick:()=>t.setImportModalOpen(!0),children:[u.jsx(de,{name:"plus",className:"w-5 h-5 mr-2"}),"Create or Import Deck"]}),u.jsxs(Se,{onClick:()=>t.setRestoreModalOpen(!0),variant:"secondary",children:[u.jsx(de,{name:"upload-cloud",className:"w-5 h-5 mr-2"}),"Restore from Backup"]}),u.jsxs(Se,{onClick:t.openCreateSeriesModal,variant:"secondary",children:[u.jsx(de,{name:"layers",className:"w-5 h-5 mr-2"}),"Create New Series"]}),u.jsxs(Se,{onClick:t.handleCreateSampleDeck,variant:"ghost",children:[u.jsx(de,{name:"laptop",className:"w-5 h-5 mr-2"}),"Create Sample Deck"]}),u.jsxs(Se,{onClick:t.handleCreateSampleSeries,variant:"ghost",children:[u.jsx(de,{name:"zap",className:"w-5 h-5 mr-2"}),"Create Sample Series"]})]})]})},Lp=t=>new DOMParser().parseFromString(t,"text/html").body.textContent||"",OE=({isOpen:t,onClose:e,actions:n})=>{const[o,i]=B.useState(""),[c,f]=B.useState(0),m=B.useRef(null),h=B.useRef(null),{navigate:p}=Rr(),{decks:v,deckSeries:x}=yt();Un(m,t);const C=B.useMemo(()=>{const R=[];return n.forEach(P=>R.push({type:"action",id:P.id,label:P.label,icon:P.icon,run:P.action,keywords:P.keywords,searchableOnly:P.searchableOnly})),v.filter(P=>!P.archived&&!P.deletedAt).forEach(P=>R.push({type:"deck",id:P.id,name:P.name,itemType:P.type})),x.filter(P=>!P.archived&&!P.deletedAt).forEach(P=>R.push({type:"series",id:P.id,name:P.name})),v.filter(P=>!P.archived&&!P.deletedAt).forEach(P=>{P.type==="flashcard"?P.cards.forEach(G=>R.push({type:"card",id:G.id,deckId:P.id,deckName:P.name,front:G.front})):P.questions.forEach(G=>R.push({type:"question",id:G.id,deckId:P.id,deckName:P.name,text:G.questionText}))}),R},[n,v,x]),S=B.useMemo(()=>{if(!o.trim())return C.filter(G=>G.type==="action"&&!G.searchableOnly);const R=o.toLowerCase();return C.filter(G=>{switch(G.type){case"action":{const $=G,oe=$.label.toLowerCase().includes(R),J=($.keywords||[]).some(Z=>Z.toLowerCase().includes(R));return oe||J}case"deck":return G.name.toLowerCase().includes(R);case"series":return G.name.toLowerCase().includes(R);case"card":return Lp(G.front).toLowerCase().includes(R);case"question":return G.text.toLowerCase().includes(R);default:return!1}}).slice(0,50)},[o,C]),b=B.useMemo(()=>{const R={Actions:[],Series:[],Decks:[],Cards:[]};return S.forEach(P=>{P.type==="action"?R.Actions.push(P):P.type==="series"?R.Series.push(P):P.type==="deck"?R.Decks.push(P):(P.type==="card"||P.type==="question")&&R.Cards.push(P)}),Object.entries(R).filter(([,P])=>P.length>0)},[S]),T=B.useMemo(()=>b.flatMap(([,R])=>R),[b]),A=B.useCallback(R=>{switch(R.type){case"action":R.run();break;case"deck":p(`/decks/${R.id}`);break;case"series":p(`/series/${R.id}`);break;case"card":case"question":p(`/decks/${R.deckId}`);break}e()},[p,e]);B.useEffect(()=>{const R=P=>{if(t)if(P.key==="ArrowDown")P.preventDefault(),f(G=>(G+1)%(T.length||1));else if(P.key==="ArrowUp")P.preventDefault(),f(G=>(G-1+(T.length||1))%(T.length||1));else if(P.key==="Enter"){P.preventDefault();const G=T[c];G&&A(G)}else P.key==="Escape"&&e()};return window.addEventListener("keydown",R),()=>window.removeEventListener("keydown",R)},[t,c,T,A,e]),B.useEffect(()=>{t&&(i(""),f(0))},[t]),B.useEffect(()=>{f(0)},[o]),B.useEffect(()=>{var R;(R=document.getElementById(`cmdk-item-${c}`))==null||R.scrollIntoView({block:"nearest"})},[c]);const D=R=>{R.target===R.currentTarget&&e()};if(!t)return null;const F=(R,P)=>{let G,$="",oe;switch(R.type){case"action":G=R.icon,$=R.label;break;case"deck":G=R.itemType==="quiz"?"help-circle":"laptop",$=R.name;break;case"series":G="layers",$=R.name;break;case"card":G="laptop",$=Lp(R.front),oe=`In: ${R.deckName}`;break;case"question":G="help-circle",$=R.text,oe=`In: ${R.deckName}`;break}return u.jsxs("li",{id:`cmdk-item-${P}`,role:"option","aria-selected":c===P,onClick:()=>A(R),className:`flex items-center gap-4 px-4 py-3 cursor-pointer rounded-md ${c===P?"bg-primary/10":"hover:bg-border/30"}`,children:[u.jsx(de,{name:G,className:"w-5 h-5 text-text-muted flex-shrink-0"}),u.jsxs("div",{className:"flex-grow min-w-0",children:[u.jsx("p",{className:`font-medium truncate ${c===P?"text-primary":"text-text"}`,children:$}),oe&&u.jsx("p",{className:`text-sm truncate ${c===P?"text-primary/80":"text-text-muted"}`,children:oe})]})]},R.id)};let L=0;return u.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-70 flex justify-center items-start pt-4 sm:pt-[15vh] z-50 p-4",onClick:D,children:u.jsxs("div",{ref:m,role:"dialog","aria-modal":"true",className:"bg-surface rounded-lg shadow-xl w-full max-w-2xl transform transition-all relative max-h-[70vh] flex flex-col",children:[u.jsxs("div",{className:"flex items-center gap-2 p-4 border-b border-border",children:[u.jsx(de,{name:"search",className:"w-5 h-5 text-text-muted"}),u.jsx("input",{type:"text",value:o,onChange:R=>i(R.target.value),placeholder:"Search for anything or type a command...",className:"w-full bg-transparent focus:outline-none text-lg placeholder:text-text-muted",autoFocus:!0}),u.jsx("div",{className:"hidden sm:block text-xs text-text-muted border border-border rounded px-1.5 py-0.5",children:"ESC"})]}),u.jsx("div",{className:"flex-grow overflow-y-auto p-2",children:T.length>0?u.jsx("ul",{ref:h,role:"listbox",children:b.map(([R,P])=>u.jsxs("li",{children:[u.jsx("p",{className:"px-4 py-2 text-xs font-semibold text-text-muted uppercase tracking-wider",children:R}),u.jsx("ul",{className:"space-y-1",children:P.map(G=>F(G,L++))})]},R))}):u.jsx("div",{className:"text-center py-10 px-4",children:u.jsxs("p",{className:"text-text-muted",children:['No results found for "',o,'".']})})}),u.jsx("div",{className:"hidden sm:flex flex-shrink-0 justify-end items-center p-2 border-t border-border",children:u.jsxs("span",{className:"text-sm text-text-muted",children:[u.jsx(de,{name:"terminal",className:"inline-block w-4 h-4 mr-2"}),u.jsx("kbd",{className:"font-sans",children:"Cmd+K"})," to toggle"]})})]})})},BE=({isOpen:t,onClose:e,onConfirm:n,analysis:o})=>{const[i,c]=B.useState(""),f=B.useRef(null);Un(f,t),B.useEffect(()=>{o.type==="quiz"&&o.data.name?c(o.data.name):c("")},[o]);const{title:m,message:h,confirmText:p}=B.useMemo(()=>{switch(o.type){case"backup":return{title:"Restore from Backup",message:`You dropped the backup file "${o.fileName}". Restoring will merge its content with your current data. Do you want to continue?`,confirmText:"Restore"};case"quiz_series":return{title:"Import Series",message:`You dropped a file containing the series "${o.data.seriesName}". Would you like to import it?`,confirmText:"Import Series"};case"quiz":return{title:"Import Quiz Deck",message:`You dropped a file for the quiz deck "${o.data.name}". Would you like to import it?`,confirmText:"Import Deck"};case"flashcard":return{title:"Import Flashcard Deck",message:`You dropped a file with ${o.data.length} flashcard(s). Please provide a name for the new deck.`,confirmText:"Import Deck"};default:return{title:"Confirm Import",message:"Unknown file type.",confirmText:"Confirm"}}},[o]),v=o.type==="flashcard"&&!i.trim(),x=()=>{n(o,i.trim())};return t?u.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50 p-4",children:u.jsxs("div",{ref:f,className:"bg-surface rounded-lg shadow-xl w-full max-w-lg transform transition-all relative",children:[u.jsxs("div",{className:"flex justify-between items-center p-4 border-b border-border",children:[u.jsx("h2",{className:"text-xl font-bold text-text",children:m}),u.jsx(Se,{type:"button",variant:"ghost",onClick:e,className:"p-1 h-auto","aria-label":"Close",children:u.jsx(de,{name:"x"})})]}),u.jsxs("div",{className:"p-6 space-y-4",children:[u.jsx("p",{className:"text-text-muted",children:h}),(o.type==="flashcard"||o.type==="quiz")&&u.jsxs("div",{children:[u.jsx("label",{htmlFor:"deck-name-input",className:"block text-sm font-medium text-text-muted mb-1",children:"Deck Name"}),u.jsx("input",{id:"deck-name-input",type:"text",value:i,onChange:C=>c(C.target.value),className:"w-full p-2 bg-background border border-border rounded-md focus:ring-2 focus:ring-primary focus:outline-none",placeholder:"Enter a name for the new deck",autoFocus:!0})]})]}),u.jsxs("div",{className:"flex justify-end p-4 bg-background/50 border-t border-border",children:[u.jsx(Se,{type:"button",variant:"secondary",onClick:e,className:"mr-2",children:"Cancel"}),u.jsx(Se,{type:"button",variant:"primary",onClick:x,disabled:v,children:p})]})]})}):null},VE=({items:t})=>t.length<=1?null:u.jsx("nav",{"aria-label":"Breadcrumb",className:"mb-6",children:u.jsx("ol",{className:"flex items-center space-x-2 text-sm text-text-muted flex-wrap",children:t.map((e,n)=>{const o=n===t.length-1;return u.jsxs("li",{className:"flex items-center",children:[n>0&&u.jsx(de,{name:"chevron-left",className:"w-4 h-4 rotate-180 mx-2 flex-shrink-0"}),o?u.jsx("span",{className:"font-semibold text-text truncate","aria-current":"page",title:e.label,children:e.label}):u.jsx(Ot,{href:e.href,className:"hover:underline hover:text-primary truncate",title:e.label,children:e.label})]},n)})})}),GE=({isOpen:t,onClose:e,onAddSeriesWithDecks:n})=>{const[o,i]=B.useState(""),[c,f]=B.useState("Beginner"),[m,h]=B.useState(!1),{addToast:p}=gn(),v=B.useRef(null);Un(v,t);const x=["Novice","Beginner","Intermediate","Advanced","Expert"],C=async S=>{if(S.preventDefault(),!o.trim()){p("Please enter a topic.","error");return}h(!0);try{const b=await R_(o,c),{seriesName:T,seriesDescription:A,levels:D}=b,F=[],L=D.map(P=>{const G=P.decks.map($=>({id:crypto.randomUUID(),name:$.name,description:$.description,type:We.Quiz,questions:[],suggestedQuestionCount:$.suggestedQuestionCount}));return F.push(...G),{title:P.title,deckIds:G.map($=>$.id)}}),R={id:crypto.randomUUID(),type:"series",name:T,description:A,levels:L,archived:!1,createdAt:new Date().toISOString()};n(R,F),p(`Successfully generated series scaffold: "${R.name}"`,"success"),e()}catch(b){p(b instanceof Error?b.message:"An unknown error occurred.","error")}finally{h(!1)}};return t?u.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50 p-4",children:u.jsxs("div",{ref:v,className:"bg-surface rounded-lg shadow-xl w-full max-w-lg overflow-hidden transform transition-all relative",children:[m&&u.jsxs("div",{className:"absolute inset-0 bg-surface/80 flex flex-col items-center justify-center z-20",children:[u.jsx(Ln,{}),u.jsx("p",{className:"text-lg text-text mt-4",children:"Generating series scaffold..."}),u.jsx("p",{className:"text-sm text-text-muted",children:"This may take a moment."})]}),u.jsxs("form",{onSubmit:C,children:[u.jsxs("div",{className:"flex justify-between items-center p-4 border-b border-border",children:[u.jsx("h2",{className:"text-xl font-bold",children:"Generate with AI"}),u.jsx(Se,{type:"button",variant:"ghost",onClick:e,className:"p-1 h-auto",disabled:m,children:u.jsx(de,{name:"x"})})]}),u.jsxs("div",{className:"p-6 space-y-4",children:[u.jsxs("div",{children:[u.jsx("label",{htmlFor:"ai-topic",className:"block text-sm font-medium text-text-muted mb-1",children:"Topic"}),u.jsx("input",{type:"text",id:"ai-topic",value:o,onChange:S=>i(S.target.value),className:"w-full p-2 bg-background border border-border rounded-md focus:ring-2 focus:ring-primary focus:outline-none",placeholder:"e.g. The History of Ancient Rome"})]}),u.jsxs("div",{children:[u.jsx("label",{htmlFor:"ai-level",className:"block text-sm font-medium text-text-muted mb-1",children:"Target Level"}),u.jsx("select",{id:"ai-level",value:c,onChange:S=>f(S.target.value),className:"w-full p-2 bg-background border border-border rounded-md focus:ring-2 focus:ring-primary focus:outline-none",children:x.map(S=>u.jsx("option",{value:S,children:S},S))})]}),u.jsx("p",{className:"text-xs text-text-muted p-2 bg-background/50 rounded-md border border-border",children:"This will generate a series outline with empty decks. You can then generate questions for each deck individually."})]}),u.jsxs("div",{className:"flex justify-end p-4 bg-background/50 border-t border-border",children:[u.jsx(Se,{type:"button",variant:"secondary",onClick:e,className:"mr-2",disabled:m,children:"Cancel"}),u.jsxs(Se,{type:"submit",variant:"primary",disabled:m||!o.trim(),children:[u.jsx(de,{name:"zap",className:"w-5 h-5 mr-2"}),"Generate Scaffold"]})]})]})]})}):null},$E=()=>{const{dispatch:t,...e}=yt(),[n,o]=B.useState(!1),[i,c]=B.useState(!1),[f,m]=B.useState(!1),[h,p]=B.useState(!1),[v,x]=B.useState(!1),[C,S]=B.useState(!1),[b,T]=B.useState(null),[A,D]=B.useState(null),[F,L]=B.useState({title:"",message:"",onConfirm:()=>{}}),[R,P]=B.useState(!1),[G,$]=B.useState(new Set),[oe,J]=B.useState(null),[Z,le]=B.useState("lastOpened"),[Q,Y]=B.useState(null),[M,pe]=B.useState(new Set),[be,ve]=B.useState(!1),[xe,te]=B.useState(null),q=B.useRef(0),[N,j]=iy(),{addToast:O}=gn(),V=B.useRef(null),{path:K,navigate:X}=Rr(),se=B.useRef(!1),{aiFeaturesEnabled:ae}=Vo(),{pullToRefreshState:ke,handleTouchStart:Ae,handleTouchMove:Ne,handleTouchEnd:je,REFRESH_THRESHOLD:De}=U_(),E=B.useCallback(ze=>{V.current=document.activeElement,ze(!0)},[]),fe=B.useCallback(ze=>{ze(!1),setTimeout(()=>{var Je;(Je=V.current)==null||Je.focus()},300)},[]),ce=B.useCallback(()=>E(P),[E]),W=B.useCallback(()=>fe(P),[fe]),H=B.useCallback(()=>E(S),[E]),re=B.useCallback(()=>fe(S),[fe]),Te=B.useCallback(()=>E(o),[E]),_e=B.useCallback(()=>fe(o),[fe]),me=B.useCallback(()=>E(c),[E]),Le=B.useCallback(()=>fe(c),[fe]);B.useCallback(()=>E(m),[E]);const Oe=B.useCallback(()=>fe(m),[fe]);B.useCallback(()=>E(p),[E]);const Fe=B.useCallback(()=>fe(p),[fe]),Ve=B.useCallback(()=>E(x),[E]),at=B.useCallback(()=>fe(x),[fe]),et=B.useCallback(ze=>{L(ze),Ve()},[Ve]),Nt=B.useCallback(ze=>{V.current=document.activeElement,T(ze)},[]),kt=B.useCallback(ze=>{V.current=document.activeElement,D(ze)},[]),pt=L_({sessionsToResume:G,setSessionsToResume:$,setGeneralStudyDeck:J,openConfirmModal:et,setFolderToEdit:Nt,setSeriesToEdit:kt}),{handleAddDecks:Qt,handleAddSeriesWithDecks:Ct,handleRestoreData:jn}=pt,wr=(ze,Je)=>{te(null);try{switch(ze.type){case"backup":jn(ze.data);break;case"quiz_series":const{seriesName:Ee,seriesDescription:st,levels:Xe}=ze.data,dt=[],It=Xe.map(ht=>{const ar=ht.decks.map(rn=>({id:crypto.randomUUID(),name:rn.name,description:rn.description,type:We.Quiz,questions:io(rn.questions)}));return dt.push(...ar),{title:ht.title,deckIds:ar.map(rn=>rn.id)}}),Zt={id:crypto.randomUUID(),type:"series",name:Ee,description:st,levels:It,createdAt:new Date().toISOString()};Ct(Zt,dt);break;case"quiz":case"flashcard":const Tt=Je||(ze.type==="quiz"?ze.data.name:"");if(!Tt){O("A deck name is required.","error");return}let Bt;if(ze.type==="flashcard"){const ht=Ec(ze.data);Bt={id:crypto.randomUUID(),name:Tt,type:We.Flashcard,cards:ht,description:`${ht.length} imported flashcard${ht.length===1?"":"s"}.`}}else{const ht=io(ze.data.questions);Bt={id:crypto.randomUUID(),name:Tt,description:ze.data.description,type:We.Quiz,questions:ht}}Qt([Bt]),O(`Deck "${Bt.name}" imported successfully.`,"success");break}}catch(Ee){console.error("Failed to confirm dropped file action:",Ee),O(`An error occurred: ${Ee instanceof Error?Ee.message:"Unknown error"}`,"error")}};B.useEffect(()=>{const ze=Je=>{if((Je.metaKey||Je.ctrlKey)&&Je.key==="k"){Je.preventDefault();const Ee=Je.target;!(Ee.tagName==="INPUT"||Ee.tagName==="TEXTAREA"||Ee.isContentEditable)&&!(n||f||h||v||b!==null||A!==null||xe!==null)&&H()}};return window.addEventListener("keydown",ze),()=>window.removeEventListener("keydown",ze)},[n,f,h,v,b,A,xe,H]),B.useEffect(()=>{const ze=dt=>{var It;return(It=dt.dataTransfer)==null?void 0:It.types.includes("Files")},Je=dt=>{ze(dt)&&(dt.preventDefault(),q.current++,ve(!0))},Ee=dt=>{ze(dt)&&dt.preventDefault()},st=dt=>{q.current>0&&(dt.preventDefault(),q.current--,q.current===0&&ve(!1))},Xe=async dt=>{var It,Zt;if(ze(dt)){dt.preventDefault(),q.current=0,ve(!1);const Tt=(Zt=(It=dt.dataTransfer)==null?void 0:It.files)==null?void 0:Zt[0];if(!Tt)return;O(`Processing ${Tt.name}...`,"info");try{if(Tt.name.toLowerCase().endsWith(".apkg")){const Bt=await Tt.arrayBuffer(),ht=await lc(Bt);ht.length>0?(await Qt(ht),O(`Successfully imported ${ht.length} deck(s) from ${Tt.name}.`,"success")):O("No valid decks found in the Anki package.","info")}else if(Tt.name.toLowerCase().endsWith(".json")){const Bt=await Tt.text(),ht=ky(Bt);ht?te({...ht,fileName:Tt.name}):O(`"${Tt.name}" is not a recognized CogniFlow file format.`,"error")}else O(`Unsupported file type: "${Tt.name}".`,"error")}catch(Bt){console.error("Failed to process dropped file:",Bt),O(`An error occurred: ${Bt instanceof Error?Bt.message:"Unknown error"}`,"error")}}};return window.addEventListener("dragenter",Je),window.addEventListener("dragover",Ee),window.addEventListener("dragleave",st),window.addEventListener("drop",Xe),()=>{window.removeEventListener("dragenter",Je),window.removeEventListener("dragover",Ee),window.removeEventListener("dragleave",st),window.removeEventListener("drop",Xe)}},[Qt,jn,Ct,O]);const Gt=B.useCallback(async(ze=!1)=>{ze&&t({type:"SET_LOADING",payload:!0});try{const[Je,Ee,st]=await Promise.all([kc(),Tc(),_c()]);t({type:"LOAD_DATA",payload:{decks:Je,folders:Ee,deckSeries:st}}),ze||O("Data synced from another tab.","info")}catch(Je){console.error("Failed to load data from IndexedDB",Je);const Ee=Je instanceof Error?Je.message:"Could not load your data. Please try refreshing.";O(Ee,"error"),t({type:"SET_LOADING",payload:!1})}},[O,t]),qn=B.useCallback(async()=>{const ze=new Date;ze.setDate(ze.getDate()-10);const Je=e.decks.filter(st=>st.deletedAt&&new Date(st.deletedAt)<ze),Ee=e.deckSeries.filter(st=>st.deletedAt&&new Date(st.deletedAt)<ze);if(!(Je.length===0&&Ee.length===0))try{await Promise.all([...Je.map(Xe=>oc(Xe.id)),...Ee.map(Xe=>zp(Xe.id))]),Je.forEach(Xe=>t({type:"DELETE_DECK",payload:Xe.id})),Ee.forEach(Xe=>t({type:"DELETE_SERIES",payload:Xe.id}));const st=Je.length+Ee.length;O(`${st} item(s) permanently deleted from trash.`,"info")}catch(st){console.error("Failed to cleanup trash",st),O("Error during automatic trash cleanup.","error")}},[e.decks,e.deckSeries,t,O]),ot=B.useCallback(async()=>{try{"serviceWorker"in navigator&&window.addEventListener("load",()=>{navigator.serviceWorker.register("/sw.js").catch(Xe=>console.log("SW registration failed: ",Xe))});const ze=await ey(),Je=new Set(ze.map(Xe=>Xe.replace("session_deck_","")));let Ee=new Map;for(let Xe=0;Xe<localStorage.length;Xe++){const dt=localStorage.key(Xe);if(dt&&dt.startsWith("series-progress-")){const It=dt.replace("series-progress-","");try{Ee.set(It,new Set(JSON.parse(localStorage.getItem(dt)||"[]")))}catch{console.error(`Failed to parse progress for series ${It}`)}}}$(Je),t({type:"SET_SERIES_PROGRESS",payload:Ee});const st=localStorage.getItem("cogniflow-sortPreference");st&&["lastOpened","name","dueCount"].includes(st)&&le(st);try{const Xe=localStorage.getItem("cogniflow-openFolders");Xe&&pe(new Set(JSON.parse(Xe)))}catch(Xe){console.error("Could not load open folder state",Xe)}}catch(ze){console.error("Failed to load local settings from storage. This can happen if cookies/site data are disabled.",ze),O("Could not load saved settings.","error")}},[O,t]);B.useEffect(()=>{(async()=>{await Gt(!0),await ot()})()},[Gt,ot]),B.useEffect(()=>{!e.isLoading&&!se.current&&(qn(),pt.reconcileSeriesProgress(),se.current=!0)},[e.isLoading,qn,pt]),B.useEffect(()=>{const ze=Vg(()=>Gt(!1)),Je=()=>ot();return window.addEventListener("storage",Je),()=>{ze(),window.removeEventListener("storage",Je)}},[Gt,ot]),B.useEffect(()=>{const ze=window.launchQueue;ze&&ze.setConsumer(async Je=>{if(!Je.files||Je.files.length===0)return;const Ee=Je.files[0];try{const st=await Ee.getFile();if(st.name.toLowerCase().endsWith(".apkg")){O(`Importing ${st.name}...`,"info");const Xe=await st.arrayBuffer(),dt=await lc(Xe);dt.length>0?(await Qt(dt),O(`Successfully imported ${dt.length} deck(s) from ${st.name}.`,"success")):O("No valid decks found in the Anki package.","info")}}catch(st){console.error("Failed to process launched file:",st),O(`An error occurred: ${st instanceof Error?st.message:"Unknown error"}`,"error")}})},[Qt,O]);const ir=B.useCallback(ze=>{pe(Je=>{const Ee=new Set(Je);Ee.has(ze)?Ee.delete(ze):Ee.add(ze);try{localStorage.setItem("cogniflow-openFolders",JSON.stringify(Array.from(Ee)))}catch(st){console.error("Could not save open folder state",st)}return Ee})},[]),yn=B.useMemo(()=>{var dt;const Je=(It=>{var Zt;return((Zt=It.match(/^\/decks\/([^/?]+)/))==null?void 0:Zt[1])||null})(K);if(!Je)return null;const Ee=e.decks.find(It=>It.id===Je);if(!Ee)return null;const Xe=new URLSearchParams(window.location.hash.split("?")[1]).get("seriesId");if(Xe){const It=e.deckSeries.find(Zt=>Zt.id===Xe);if(It){const Tt=It.levels.flatMap(Bt=>Bt.deckIds).indexOf(Je);if(Tt>-1){const Bt=((dt=e.seriesProgress.get(It.id))==null?void 0:dt.size)||0,ht=Tt>Bt;return{...Ee,locked:ht}}}}return Ee},[K,e.decks,e.deckSeries,e.seriesProgress]),Kt=B.useMemo(()=>{const Je=(Ee=>{var st;return((st=Ee.match(/^\/series\/([^/?]+)/))==null?void 0:st[1])||null})(K);return Je?e.deckSeries.find(Ee=>Ee.id===Je):null},[K,e.deckSeries]),$t=B.useMemo(()=>{const ze=[{label:"Home",href:"/"}],Je=K.split("?")[0].split("/").filter(Boolean);if(Je[0]==="series")ze.push({label:"Series",href:"/series"}),Je[1]&&Kt&&ze.push({label:Kt.name,href:`/series/${Kt.id}`});else if(Je[0]==="decks"){const st=new URLSearchParams(window.location.hash.split("?")[1]).get("seriesId");if(st){const Xe=e.deckSeries.find(dt=>dt.id===st);Xe&&(ze.push({label:"Series",href:"/series"}),ze.push({label:Xe.name,href:`/series/${Xe.id}`}))}else ze.push({label:"Decks",href:"/decks"});Je[1]&&yn&&ze.push({label:yn.name})}else Je[0]==="archive"?ze.push({label:"Archive"}):Je[0]==="trash"?ze.push({label:"Trash"}):Je[0]==="settings"?ze.push({label:"Settings"}):Je[0]==="progress"?ze.push({label:"Progress"}):Je[0]==="instructions"&&Je[1]==="json"&&ze.push({label:"JSON Guide"});return ze},[K,yn,Kt,e.deckSeries]),Yn=B.useMemo(()=>{const ze=Ee=>{X("/settings"),setTimeout(()=>{var st;(st=document.getElementById(Ee))==null||st.scrollIntoView({behavior:"smooth",block:"center"})},100)},Je=[{id:"new-deck",label:"New / Import Deck",icon:"plus",action:Te},{id:"new-series",label:"Create New Series",icon:"layers",action:()=>kt("new")},{id:"go-decks",label:"Go to All Decks",icon:"folder",action:()=>X("/decks")},{id:"go-series",label:"Go to All Series",icon:"layers",action:()=>X("/series")},{id:"go-archive",label:"Go to Archive",icon:"archive",action:()=>X("/archive")},{id:"go-trash",label:"Go to Trash",icon:"trash-2",action:()=>X("/trash")},{id:"go-settings",label:"Go to Settings",icon:"settings",action:()=>X("/settings")},{id:"go-appearance-settings",label:"Go to Appearance Settings",icon:"sun",action:()=>ze("settings-appearance"),searchableOnly:!0,keywords:["theme","dark","light","animation","haptics"]},{id:"go-local-backup",label:"Go to Local Backup",icon:"download",action:()=>ze("settings-local-backup"),searchableOnly:!0,keywords:["export","import","json","file","download","data"]},{id:"go-cloud-backup",label:"Go to Cloud Backup",icon:"upload-cloud",action:()=>ze("google-drive-backup"),searchableOnly:!0,keywords:["google","drive","sync","data"]},{id:"go-cache-management",label:"Go to Cache Management",icon:"broom",action:()=>ze("settings-cache-management"),searchableOnly:!0,keywords:["clear","reload","refresh","storage","data","service worker"]},{id:"go-reset-progress",label:"Go to Reset Progress",icon:"refresh-ccw",action:()=>ze("settings-reset-progress"),searchableOnly:!0,keywords:["srs","spaced repetition","start over","danger"]},{id:"go-factory-reset",label:"Go to Factory Reset",icon:"trash-2",action:()=>ze("settings-factory-reset"),searchableOnly:!0,keywords:["delete all","wipe","clean","erase","danger"]}];return ae&&Je.unshift({id:"ai-generate",label:"Generate Series with AI",icon:"zap",action:me}),Je},[X,Te,kt,ae,me]);return e.isLoading?u.jsx("div",{className:"min-h-screen flex items-center justify-center",children:u.jsxs("h1",{className:"text-2xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-blue-400 to-teal-300",children:[u.jsx(Ln,{size:"lg"}),"Loading CogniFlow..."]})}):u.jsxs("div",{className:"min-h-screen text-text flex flex-col overflow-x-hidden",onTouchStart:Ae,onTouchMove:Ne,onTouchEnd:je,children:[be&&u.jsxs("div",{className:"fixed inset-0 bg-primary/20 backdrop-blur-sm flex flex-col items-center justify-center z-[100] border-4 border-dashed border-primary pointer-events-none",children:[u.jsx(de,{name:"upload-cloud",className:"w-24 h-24 text-primary drop-shadow-lg animate-pulse"}),u.jsx("p",{className:"mt-4 text-2xl font-bold text-white drop-shadow-lg",children:"Drop File Anywhere to Import"})]}),u.jsx(qy,{pullDistance:ke.pullDistance,isRefreshing:ke.isRefreshing,threshold:De}),u.jsx(py,{isOpen:R,onClose:W,onImport:()=>{Te(),W()},onCreateSeries:()=>{W(),kt("new")},onGenerateAI:()=>{me(),W()},onInstall:N?()=>{j(),W()}:null}),u.jsxs("div",{className:"flex-grow flex flex-col",children:[u.jsx(j_,{activeDeck:yn,onOpenMenu:ce,onOpenCommandPalette:H}),u.jsxs("main",{className:"flex-grow container mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[u.jsx(VE,{items:$t}),u.jsx(zE,{sessionsToResume:G,sortPreference:Z,setSortPreference:le,draggedDeckId:Q,setDraggedDeckId:Y,openFolderIds:M,onToggleFolder:ir,generalStudyDeck:oe,activeDeck:yn,activeSeries:Kt,setImportModalOpen:o,setRestoreModalOpen:m,setResetProgressModalOpen:p,openFolderModal:Nt,openConfirmModal:et,openCreateSeriesModal:()=>kt("new"),openAIGenerationModal:me,handleAiAddLevelsToSeries:pt.handleAiAddLevelsToSeries,handleAiAddDecksToLevel:pt.handleAiAddDecksToLevel,...pt})]})]}),u.jsx(ly,{}),u.jsx(OE,{isOpen:C,onClose:re,actions:Yn}),n&&u.jsx(Py,{isOpen:n,onClose:_e,onAddDecks:pt.handleAddDecks,onAddSeriesWithDecks:pt.handleAddSeriesWithDecks}),ae&&i&&u.jsx(GE,{isOpen:i,onClose:Le,onAddSeriesWithDecks:pt.handleAddSeriesWithDecks}),f&&u.jsx(Fy,{isOpen:f,onClose:Oe,onRestore:pt.handleRestoreData}),h&&u.jsx(Ly,{isOpen:h,onClose:Fe,onReset:pt.handleResetDeckProgress,decks:e.decks}),v&&u.jsx(Qa,{isOpen:v,onClose:at,...F}),b!==null&&u.jsx(Uy,{folder:b==="new"?null:b,onClose:()=>T(null),onSave:pt.handleSaveFolder}),A!==null&&u.jsx(jy,{series:A==="new"?null:A,onClose:()=>D(null),onSave:pt.handleSaveSeries}),xe&&u.jsx(BE,{isOpen:!!xe,onClose:()=>te(null),analysis:xe,onConfirm:wr})]})};class HE extends B.Component{constructor(){super(...arguments),this.state={hasError:!1},this.handleReload=()=>{window.location.reload()}}static getDerivedStateFromError(e){return{hasError:!0,error:e}}componentDidCatch(e,n){console.error("Uncaught error:",e,n)}render(){return this.state.hasError?u.jsx("div",{className:"min-h-screen flex items-center justify-center p-4",children:u.jsxs("div",{className:"text-center bg-surface p-8 rounded-lg shadow-xl max-w-md w-full",children:[u.jsx("h1",{className:"text-3xl font-bold text-red-600 dark:text-red-500 mb-4",children:"Oops! Something went wrong."}),u.jsx("p",{className:"text-text-muted mb-6",children:"The application encountered an unexpected error. Please try reloading the page to continue."}),this.state.error&&u.jsx("pre",{className:"bg-background text-left text-xs text-red-500 dark:text-red-400 p-4 rounded-md overflow-x-auto mb-6",children:u.jsx("code",{children:this.state.error.toString()})}),u.jsx(Se,{variant:"danger",onClick:this.handleReload,children:"Reload Page"})]})}):this.props.children}}console.log(window.location);const Eh=document.getElementById("root");if(!Eh)throw new Error("Could not find root element to mount to");const WE=Og.createRoot(Eh);WE.render(u.jsx(hi.StrictMode,{children:u.jsx(oE,{children:u.jsx(yy,{children:u.jsx(my,{children:u.jsx(dy,{children:u.jsx(HE,{children:u.jsx($E,{})})})})})})}))});export default JE();
